console.log("Last modification time: 7/5/2023, 2:37:27 PM"),(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[function(e,t,n){var r;
/*!
 * jQuery JavaScript Library v3.7.0
 * https://jquery.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2023-05-11T18:29Z
 */!function(t,n){"use strict";"object"==typeof e.exports?e.exports=t.document?n(t,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return n(e)}:n(t)}("undefined"!=typeof window?window:this,(function(n,i){"use strict";var o=[],a=Object.getPrototypeOf,s=o.slice,c=o.flat?function(e){return o.flat.call(e)}:function(e){return o.concat.apply([],e)},u=o.push,d=o.indexOf,l={},f=l.toString,p=l.hasOwnProperty,h=p.toString,m=h.call(Object),g={},v=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},y=function(e){return null!=e&&e===e.window},b=n.document,S={type:!0,src:!0,nonce:!0,noModule:!0};function E(e,t,n){var r,i,o=(n=n||b).createElement("script");if(o.text=e,t)for(r in S)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function _(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[f.call(e)]||"object":typeof e}var T=/HTML$/i,R=function(e,t){return new R.fn.init(e,t)};function I(e){var t=!!e&&"length"in e&&e.length,n=_(e);return!v(e)&&!y(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}function w(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}R.fn=R.prototype={jquery:"3.7.0",constructor:R,length:0,toArray:function(){return s.call(this)},get:function(e){return null==e?s.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=R.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return R.each(this,e)},map:function(e){return this.pushStack(R.map(this,(function(t,n){return e.call(t,n,t)})))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(R.grep(this,(function(e,t){return(t+1)%2})))},odd:function(){return this.pushStack(R.grep(this,(function(e,t){return t%2})))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:o.sort,splice:o.splice},R.extend=R.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,c=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[s]||{},s++),"object"==typeof a||v(a)||(a={}),s===c&&(a=this,s--);s<c;s++)if(null!=(e=arguments[s]))for(t in e)r=e[t],"__proto__"!==t&&a!==r&&(u&&r&&(R.isPlainObject(r)||(i=Array.isArray(r)))?(n=a[t],o=i&&!Array.isArray(n)?[]:i||R.isPlainObject(n)?n:{},i=!1,a[t]=R.extend(u,o,r)):void 0!==r&&(a[t]=r));return a},R.extend({expando:"jQuery"+("3.7.0"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==f.call(e))&&(!(t=a(e))||"function"==typeof(n=p.call(t,"constructor")&&t.constructor)&&h.call(n)===m)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){E(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(I(e))for(n=e.length;r<n&&!1!==t.call(e[r],r,e[r]);r++);else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},text:function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i)return e.textContent;if(3===i||4===i)return e.nodeValue}else for(;t=e[r++];)n+=R.text(t);return n},makeArray:function(e,t){var n=t||[];return null!=e&&(I(Object(e))?R.merge(n,"string"==typeof e?[e]:e):u.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:d.call(t,e,n)},isXMLDoc:function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!T.test(t||n&&n.nodeName||"HTML")},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,a=!n;i<o;i++)!t(e[i],i)!==a&&r.push(e[i]);return r},map:function(e,t,n){var r,i,o=0,a=[];if(I(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&a.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&a.push(i);return c(a)},guid:1,support:g}),"function"==typeof Symbol&&(R.fn[Symbol.iterator]=o[Symbol.iterator]),R.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(e,t){l["[object "+t+"]"]=t.toLowerCase()}));var C=o.pop,O=o.sort,A=o.splice,x="[\\x20\\t\\r\\n\\f]",k=new RegExp("^"+x+"+|((?:^|[^\\\\])(?:\\\\.)*)"+x+"+$","g");R.contains=function(e,t){var n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(e.contains?e.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))};var N=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function L(e,t){return t?"\0"===e?"ï¿½":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e}R.escapeSelector=function(e){return(e+"").replace(N,L)};var M=b,V=u;!function(){var e,t,r,i,a,c,u,l,f,h,m=V,v=R.expando,y=0,b=0,S=ee(),E=ee(),_=ee(),T=ee(),I=function(e,t){return e===t&&(a=!0),0},N="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",L="(?:\\\\[\\da-fA-F]{1,6}"+x+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",P="\\["+x+"*("+L+")(?:"+x+"*([*^$|!~]?=)"+x+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+L+"))|)"+x+"*\\]",D=":("+L+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+P+")*)|.*)\\)|)",Z=new RegExp(x+"+","g"),j=new RegExp("^"+x+"*,"+x+"*"),W=new RegExp("^"+x+"*([>+~]|"+x+")"+x+"*"),G=new RegExp(x+"|>"),F=new RegExp(D),U=new RegExp("^"+L+"$"),X={ID:new RegExp("^#("+L+")"),CLASS:new RegExp("^\\.("+L+")"),TAG:new RegExp("^("+L+"|[*])"),ATTR:new RegExp("^"+P),PSEUDO:new RegExp("^"+D),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+x+"*(even|odd|(([+-]|)(\\d*)n|)"+x+"*(?:([+-]|)"+x+"*(\\d+)|))"+x+"*\\)|)","i"),bool:new RegExp("^(?:"+N+")$","i"),needsContext:new RegExp("^"+x+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+x+"*((?:-\\d)?\\d*)"+x+"*\\)|)(?=[^-]|$)","i")},B=/^(?:input|select|textarea|button)$/i,H=/^h\d$/i,Y=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,J=/[+~]/,z=new RegExp("\\\\[\\da-fA-F]{1,6}"+x+"?|\\\\([^\\r\\n\\f])","g"),K=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},Q=function(){ce()},q=fe((function(e){return!0===e.disabled&&w(e,"fieldset")}),{dir:"parentNode",next:"legend"});try{m.apply(o=s.call(M.childNodes),M.childNodes),o[M.childNodes.length].nodeType}catch(e){m={apply:function(e,t){V.apply(e,s.call(t))},call:function(e){V.apply(e,s.call(arguments,1))}}}function $(e,t,n,r){var i,o,a,s,u,d,p,h=t&&t.ownerDocument,y=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==y&&9!==y&&11!==y)return n;if(!r&&(ce(t),t=t||c,l)){if(11!==y&&(u=Y.exec(e)))if(i=u[1]){if(9===y){if(!(a=t.getElementById(i)))return n;if(a.id===i)return m.call(n,a),n}else if(h&&(a=h.getElementById(i))&&$.contains(t,a)&&a.id===i)return m.call(n,a),n}else{if(u[2])return m.apply(n,t.getElementsByTagName(e)),n;if((i=u[3])&&t.getElementsByClassName)return m.apply(n,t.getElementsByClassName(i)),n}if(!(T[e+" "]||f&&f.test(e))){if(p=e,h=t,1===y&&(G.test(e)||W.test(e))){for((h=J.test(e)&&se(t.parentNode)||t)==t&&g.scope||((s=t.getAttribute("id"))?s=R.escapeSelector(s):t.setAttribute("id",s=v)),o=(d=de(e)).length;o--;)d[o]=(s?"#"+s:":scope")+" "+le(d[o]);p=d.join(",")}try{return m.apply(n,h.querySelectorAll(p)),n}catch(t){T(e,!0)}finally{s===v&&t.removeAttribute("id")}}}return ye(e.replace(k,"$1"),t,n,r)}function ee(){var e=[];return function n(r,i){return e.push(r+" ")>t.cacheLength&&delete n[e.shift()],n[r+" "]=i}}function te(e){return e[v]=!0,e}function ne(e){var t=c.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function re(e){return function(t){return w(t,"input")&&t.type===e}}function ie(e){return function(t){return(w(t,"input")||w(t,"button"))&&t.type===e}}function oe(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&q(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function ae(e){return te((function(t){return t=+t,te((function(n,r){for(var i,o=e([],n.length,t),a=o.length;a--;)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))}))}))}function se(e){return e&&void 0!==e.getElementsByTagName&&e}function ce(e){var n,r=e?e.ownerDocument||e:M;return r!=c&&9===r.nodeType&&r.documentElement?(u=(c=r).documentElement,l=!R.isXMLDoc(c),h=u.matches||u.webkitMatchesSelector||u.msMatchesSelector,M!=c&&(n=c.defaultView)&&n.top!==n&&n.addEventListener("unload",Q),g.getById=ne((function(e){return u.appendChild(e).id=R.expando,!c.getElementsByName||!c.getElementsByName(R.expando).length})),g.disconnectedMatch=ne((function(e){return h.call(e,"*")})),g.scope=ne((function(){return c.querySelectorAll(":scope")})),g.cssHas=ne((function(){try{return c.querySelector(":has(*,:jqfake)"),!1}catch(e){return!0}})),g.getById?(t.filter.ID=function(e){var t=e.replace(z,K);return function(e){return e.getAttribute("id")===t}},t.find.ID=function(e,t){if(void 0!==t.getElementById&&l){var n=t.getElementById(e);return n?[n]:[]}}):(t.filter.ID=function(e){var t=e.replace(z,K);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},t.find.ID=function(e,t){if(void 0!==t.getElementById&&l){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];for(i=t.getElementsByName(e),r=0;o=i[r++];)if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),t.find.TAG=function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):t.querySelectorAll(e)},t.find.CLASS=function(e,t){if(void 0!==t.getElementsByClassName&&l)return t.getElementsByClassName(e)},f=[],ne((function(e){var t;u.appendChild(e).innerHTML="<a id='"+v+"' href='' disabled='disabled'></a><select id='"+v+"-\r\\' disabled='disabled'><option selected=''></option></select>",e.querySelectorAll("[selected]").length||f.push("\\["+x+"*(?:value|"+N+")"),e.querySelectorAll("[id~="+v+"-]").length||f.push("~="),e.querySelectorAll("a#"+v+"+*").length||f.push(".#.+[+~]"),e.querySelectorAll(":checked").length||f.push(":checked"),(t=c.createElement("input")).setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),u.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&f.push(":enabled",":disabled"),(t=c.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||f.push("\\["+x+"*name"+x+"*="+x+"*(?:''|\"\")")})),g.cssHas||f.push(":has"),f=f.length&&new RegExp(f.join("|")),I=function(e,t){if(e===t)return a=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!g.sortDetached&&t.compareDocumentPosition(e)===n?e===c||e.ownerDocument==M&&$.contains(M,e)?-1:t===c||t.ownerDocument==M&&$.contains(M,t)?1:i?d.call(i,e)-d.call(i,t):0:4&n?-1:1)},c):c}for(e in $.matches=function(e,t){return $(e,null,null,t)},$.matchesSelector=function(e,t){if(ce(e),l&&!T[t+" "]&&(!f||!f.test(t)))try{var n=h.call(e,t);if(n||g.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){T(t,!0)}return $(t,c,null,[e]).length>0},$.contains=function(e,t){return(e.ownerDocument||e)!=c&&ce(e),R.contains(e,t)},$.attr=function(e,n){(e.ownerDocument||e)!=c&&ce(e);var r=t.attrHandle[n.toLowerCase()],i=r&&p.call(t.attrHandle,n.toLowerCase())?r(e,n,!l):void 0;return void 0!==i?i:e.getAttribute(n)},$.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},R.uniqueSort=function(e){var t,n=[],r=0,o=0;if(a=!g.sortStable,i=!g.sortStable&&s.call(e,0),O.call(e,I),a){for(;t=e[o++];)t===e[o]&&(r=n.push(o));for(;r--;)A.call(e,n[r],1)}return i=null,e},R.fn.uniqueSort=function(){return this.pushStack(R.uniqueSort(s.apply(this)))},(t=R.expr={cacheLength:50,createPseudo:te,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(z,K),e[3]=(e[3]||e[4]||e[5]||"").replace(z,K),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||$.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&$.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return X.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&F.test(n)&&(t=de(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(z,K).toLowerCase();return"*"===e?function(){return!0}:function(e){return w(e,t)}},CLASS:function(e){var t=S[e+" "];return t||(t=new RegExp("(^|"+x+")"+e+"("+x+"|$)"))&&S(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,n){return function(r){var i=$.attr(r,e);return null==i?"!="===t:!t||(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i.replace(Z," ")+" ").indexOf(n)>-1:"|="===t&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,c){var u,d,l,f,p,h=o!==a?"nextSibling":"previousSibling",m=t.parentNode,g=s&&t.nodeName.toLowerCase(),b=!c&&!s,S=!1;if(m){if(o){for(;h;){for(l=t;l=l[h];)if(s?w(l,g):1===l.nodeType)return!1;p=h="only"===e&&!p&&"nextSibling"}return!0}if(p=[a?m.firstChild:m.lastChild],a&&b){for(S=(f=(u=(d=m[v]||(m[v]={}))[e]||[])[0]===y&&u[1])&&u[2],l=f&&m.childNodes[f];l=++f&&l&&l[h]||(S=f=0)||p.pop();)if(1===l.nodeType&&++S&&l===t){d[e]=[y,f,S];break}}else if(b&&(S=f=(u=(d=t[v]||(t[v]={}))[e]||[])[0]===y&&u[1]),!1===S)for(;(l=++f&&l&&l[h]||(S=f=0)||p.pop())&&(!(s?w(l,g):1===l.nodeType)||!++S||(b&&((d=l[v]||(l[v]={}))[e]=[y,S]),l!==t)););return(S-=i)===r||S%r==0&&S/r>=0}}},PSEUDO:function(e,n){var r,i=t.pseudos[e]||t.setFilters[e.toLowerCase()]||$.error("unsupported pseudo: "+e);return i[v]?i(n):i.length>1?(r=[e,e,"",n],t.setFilters.hasOwnProperty(e.toLowerCase())?te((function(e,t){for(var r,o=i(e,n),a=o.length;a--;)e[r=d.call(e,o[a])]=!(t[r]=o[a])})):function(e){return i(e,0,r)}):i}},pseudos:{not:te((function(e){var t=[],n=[],r=ve(e.replace(k,"$1"));return r[v]?te((function(e,t,n,i){for(var o,a=r(e,null,i,[]),s=e.length;s--;)(o=a[s])&&(e[s]=!(t[s]=o))})):function(e,i,o){return t[0]=e,r(t,null,o,n),t[0]=null,!n.pop()}})),has:te((function(e){return function(t){return $(e,t).length>0}})),contains:te((function(e){return e=e.replace(z,K),function(t){return(t.textContent||R.text(t)).indexOf(e)>-1}})),lang:te((function(e){return U.test(e||"")||$.error("unsupported lang: "+e),e=e.replace(z,K).toLowerCase(),function(t){var n;do{if(n=l?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(e){var t=n.location&&n.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===u},focus:function(e){return e===function(){try{return c.activeElement}catch(e){}}()&&c.hasFocus()&&!!(e.type||e.href||~e.tabIndex)},enabled:oe(!1),disabled:oe(!0),checked:function(e){return w(e,"input")&&!!e.checked||w(e,"option")&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!t.pseudos.empty(e)},header:function(e){return H.test(e.nodeName)},input:function(e){return B.test(e.nodeName)},button:function(e){return w(e,"input")&&"button"===e.type||w(e,"button")},text:function(e){var t;return w(e,"input")&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ae((function(){return[0]})),last:ae((function(e,t){return[t-1]})),eq:ae((function(e,t,n){return[n<0?n+t:n]})),even:ae((function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e})),odd:ae((function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e})),lt:ae((function(e,t,n){var r;for(r=n<0?n+t:n>t?t:n;--r>=0;)e.push(r);return e})),gt:ae((function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e}))}}).pseudos.nth=t.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})t.pseudos[e]=re(e);for(e in{submit:!0,reset:!0})t.pseudos[e]=ie(e);function ue(){}function de(e,n){var r,i,o,a,s,c,u,d=E[e+" "];if(d)return n?0:d.slice(0);for(s=e,c=[],u=t.preFilter;s;){for(a in r&&!(i=j.exec(s))||(i&&(s=s.slice(i[0].length)||s),c.push(o=[])),r=!1,(i=W.exec(s))&&(r=i.shift(),o.push({value:r,type:i[0].replace(k," ")}),s=s.slice(r.length)),t.filter)!(i=X[a].exec(s))||u[a]&&!(i=u[a](i))||(r=i.shift(),o.push({value:r,type:a,matches:i}),s=s.slice(r.length));if(!r)break}return n?s.length:s?$.error(e):E(e,c).slice(0)}function le(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function fe(e,t,n){var r=t.dir,i=t.next,o=i||r,a=n&&"parentNode"===o,s=b++;return t.first?function(t,n,i){for(;t=t[r];)if(1===t.nodeType||a)return e(t,n,i);return!1}:function(t,n,c){var u,d,l=[y,s];if(c){for(;t=t[r];)if((1===t.nodeType||a)&&e(t,n,c))return!0}else for(;t=t[r];)if(1===t.nodeType||a)if(d=t[v]||(t[v]={}),i&&w(t,i))t=t[r]||t;else{if((u=d[o])&&u[0]===y&&u[1]===s)return l[2]=u[2];if(d[o]=l,l[2]=e(t,n,c))return!0}return!1}}function pe(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function he(e,t,n,r,i){for(var o,a=[],s=0,c=e.length,u=null!=t;s<c;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),u&&t.push(s)));return a}function me(e,t,n,r,i,o){return r&&!r[v]&&(r=me(r)),i&&!i[v]&&(i=me(i,o)),te((function(o,a,s,c){var u,l,f,p,h=[],g=[],v=a.length,y=o||function(e,t,n){for(var r=0,i=t.length;r<i;r++)$(e,t[r],n);return n}(t||"*",s.nodeType?[s]:s,[]),b=!e||!o&&t?y:he(y,h,e,s,c);if(n?n(b,p=i||(o?e:v||r)?[]:a,s,c):p=b,r)for(u=he(p,g),r(u,[],s,c),l=u.length;l--;)(f=u[l])&&(p[g[l]]=!(b[g[l]]=f));if(o){if(i||e){if(i){for(u=[],l=p.length;l--;)(f=p[l])&&u.push(b[l]=f);i(null,p=[],u,c)}for(l=p.length;l--;)(f=p[l])&&(u=i?d.call(o,f):h[l])>-1&&(o[u]=!(a[u]=f))}}else p=he(p===a?p.splice(v,p.length):p),i?i(null,a,p,c):m.apply(a,p)}))}function ge(e){for(var n,i,o,a=e.length,s=t.relative[e[0].type],c=s||t.relative[" "],u=s?1:0,l=fe((function(e){return e===n}),c,!0),f=fe((function(e){return d.call(n,e)>-1}),c,!0),p=[function(e,t,i){var o=!s&&(i||t!=r)||((n=t).nodeType?l(e,t,i):f(e,t,i));return n=null,o}];u<a;u++)if(i=t.relative[e[u].type])p=[fe(pe(p),i)];else{if((i=t.filter[e[u].type].apply(null,e[u].matches))[v]){for(o=++u;o<a&&!t.relative[e[o].type];o++);return me(u>1&&pe(p),u>1&&le(e.slice(0,u-1).concat({value:" "===e[u-2].type?"*":""})).replace(k,"$1"),i,u<o&&ge(e.slice(u,o)),o<a&&ge(e=e.slice(o)),o<a&&le(e))}p.push(i)}return pe(p)}function ve(e,n){var i,o=[],a=[],s=_[e+" "];if(!s){for(n||(n=de(e)),i=n.length;i--;)(s=ge(n[i]))[v]?o.push(s):a.push(s);(s=_(e,function(e,n){var i=n.length>0,o=e.length>0,a=function(a,s,u,d,f){var p,h,g,v=0,b="0",S=a&&[],E=[],_=r,T=a||o&&t.find.TAG("*",f),I=y+=null==_?1:Math.random()||.1,w=T.length;for(f&&(r=s==c||s||f);b!==w&&null!=(p=T[b]);b++){if(o&&p){for(h=0,s||p.ownerDocument==c||(ce(p),u=!l);g=e[h++];)if(g(p,s||c,u)){m.call(d,p);break}f&&(y=I)}i&&((p=!g&&p)&&v--,a&&S.push(p))}if(v+=b,i&&b!==v){for(h=0;g=n[h++];)g(S,E,s,u);if(a){if(v>0)for(;b--;)S[b]||E[b]||(E[b]=C.call(d));E=he(E)}m.apply(d,E),f&&!a&&E.length>0&&v+n.length>1&&R.uniqueSort(d)}return f&&(y=I,r=_),S};return i?te(a):a}(a,o))).selector=e}return s}function ye(e,n,r,i){var o,a,s,c,u,d="function"==typeof e&&e,f=!i&&de(e=d.selector||e);if(r=r||[],1===f.length){if((a=f[0]=f[0].slice(0)).length>2&&"ID"===(s=a[0]).type&&9===n.nodeType&&l&&t.relative[a[1].type]){if(!(n=(t.find.ID(s.matches[0].replace(z,K),n)||[])[0]))return r;d&&(n=n.parentNode),e=e.slice(a.shift().value.length)}for(o=X.needsContext.test(e)?0:a.length;o--&&(s=a[o],!t.relative[c=s.type]);)if((u=t.find[c])&&(i=u(s.matches[0].replace(z,K),J.test(a[0].type)&&se(n.parentNode)||n))){if(a.splice(o,1),!(e=i.length&&le(a)))return m.apply(r,i),r;break}}return(d||ve(e,f))(i,n,!l,r,!n||J.test(e)&&se(n.parentNode)||n),r}ue.prototype=t.filters=t.pseudos,t.setFilters=new ue,g.sortStable=v.split("").sort(I).join("")===v,ce(),g.sortDetached=ne((function(e){return 1&e.compareDocumentPosition(c.createElement("fieldset"))})),R.find=$,R.expr[":"]=R.expr.pseudos,R.unique=R.uniqueSort,$.compile=ve,$.select=ye,$.setDocument=ce,$.escape=R.escapeSelector,$.getText=R.text,$.isXML=R.isXMLDoc,$.selectors=R.expr,$.support=R.support,$.uniqueSort=R.uniqueSort}();var P=function(e,t,n){for(var r=[],i=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&R(e).is(n))break;r.push(e)}return r},D=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},Z=R.expr.match.needsContext,j=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function W(e,t,n){return v(t)?R.grep(e,(function(e,r){return!!t.call(e,r,e)!==n})):t.nodeType?R.grep(e,(function(e){return e===t!==n})):"string"!=typeof t?R.grep(e,(function(e){return d.call(t,e)>-1!==n})):R.filter(t,e,n)}R.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?R.find.matchesSelector(r,e)?[r]:[]:R.find.matches(e,R.grep(t,(function(e){return 1===e.nodeType})))},R.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(R(e).filter((function(){for(t=0;t<r;t++)if(R.contains(i[t],this))return!0})));for(n=this.pushStack([]),t=0;t<r;t++)R.find(e,i[t],n);return r>1?R.uniqueSort(n):n},filter:function(e){return this.pushStack(W(this,e||[],!1))},not:function(e){return this.pushStack(W(this,e||[],!0))},is:function(e){return!!W(this,"string"==typeof e&&Z.test(e)?R(e):e||[],!1).length}});var G,F=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(R.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||G,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:F.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof R?t[0]:t,R.merge(this,R.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:b,!0)),j.test(r[1])&&R.isPlainObject(t))for(r in t)v(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=b.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):v(e)?void 0!==n.ready?n.ready(e):e(R):R.makeArray(e,this)}).prototype=R.fn,G=R(b);var U=/^(?:parents|prev(?:Until|All))/,X={children:!0,contents:!0,next:!0,prev:!0};function B(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}R.fn.extend({has:function(e){var t=R(e,this),n=t.length;return this.filter((function(){for(var e=0;e<n;e++)if(R.contains(this,t[e]))return!0}))},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&R(e);if(!Z.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&R.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?R.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?d.call(R(e),this[0]):d.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(R.uniqueSort(R.merge(this.get(),R(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),R.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return P(e,"parentNode")},parentsUntil:function(e,t,n){return P(e,"parentNode",n)},next:function(e){return B(e,"nextSibling")},prev:function(e){return B(e,"previousSibling")},nextAll:function(e){return P(e,"nextSibling")},prevAll:function(e){return P(e,"previousSibling")},nextUntil:function(e,t,n){return P(e,"nextSibling",n)},prevUntil:function(e,t,n){return P(e,"previousSibling",n)},siblings:function(e){return D((e.parentNode||{}).firstChild,e)},children:function(e){return D(e.firstChild)},contents:function(e){return null!=e.contentDocument&&a(e.contentDocument)?e.contentDocument:(w(e,"template")&&(e=e.content||e),R.merge([],e.childNodes))}},(function(e,t){R.fn[e]=function(n,r){var i=R.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=R.filter(r,i)),this.length>1&&(X[e]||R.uniqueSort(i),U.test(e)&&i.reverse()),this.pushStack(i)}}));var H=/[^\x20\t\r\n\f]+/g;function Y(e){return e}function J(e){throw e}function z(e,t,n,r){var i;try{e&&v(i=e.promise)?i.call(e).done(t).fail(n):e&&v(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}R.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return R.each(e.match(H)||[],(function(e,n){t[n]=!0})),t}(e):R.extend({},e);var t,n,r,i,o=[],a=[],s=-1,c=function(){for(i=i||e.once,r=t=!0;a.length;s=-1)for(n=a.shift();++s<o.length;)!1===o[s].apply(n[0],n[1])&&e.stopOnFalse&&(s=o.length,n=!1);e.memory||(n=!1),t=!1,i&&(o=n?[]:"")},u={add:function(){return o&&(n&&!t&&(s=o.length-1,a.push(n)),function t(n){R.each(n,(function(n,r){v(r)?e.unique&&u.has(r)||o.push(r):r&&r.length&&"string"!==_(r)&&t(r)}))}(arguments),n&&!t&&c()),this},remove:function(){return R.each(arguments,(function(e,t){for(var n;(n=R.inArray(t,o,n))>-1;)o.splice(n,1),n<=s&&s--})),this},has:function(e){return e?R.inArray(e,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return i=a=[],o=n="",this},disabled:function(){return!o},lock:function(){return i=a=[],n||t||(o=n=""),this},locked:function(){return!!i},fireWith:function(e,n){return i||(n=[e,(n=n||[]).slice?n.slice():n],a.push(n),t||c()),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!r}};return u},R.extend({Deferred:function(e){var t=[["notify","progress",R.Callbacks("memory"),R.Callbacks("memory"),2],["resolve","done",R.Callbacks("once memory"),R.Callbacks("once memory"),0,"resolved"],["reject","fail",R.Callbacks("once memory"),R.Callbacks("once memory"),1,"rejected"]],r="pending",i={state:function(){return r},always:function(){return o.done(arguments).fail(arguments),this},catch:function(e){return i.then(null,e)},pipe:function(){var e=arguments;return R.Deferred((function(n){R.each(t,(function(t,r){var i=v(e[r[4]])&&e[r[4]];o[r[1]]((function(){var e=i&&i.apply(this,arguments);e&&v(e.promise)?e.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[r[0]+"With"](this,i?[e]:arguments)}))})),e=null})).promise()},then:function(e,r,i){var o=0;function a(e,t,r,i){return function(){var s=this,c=arguments,u=function(){var n,u;if(!(e<o)){if((n=r.apply(s,c))===t.promise())throw new TypeError("Thenable self-resolution");u=n&&("object"==typeof n||"function"==typeof n)&&n.then,v(u)?i?u.call(n,a(o,t,Y,i),a(o,t,J,i)):(o++,u.call(n,a(o,t,Y,i),a(o,t,J,i),a(o,t,Y,t.notifyWith))):(r!==Y&&(s=void 0,c=[n]),(i||t.resolveWith)(s,c))}},d=i?u:function(){try{u()}catch(n){R.Deferred.exceptionHook&&R.Deferred.exceptionHook(n,d.error),e+1>=o&&(r!==J&&(s=void 0,c=[n]),t.rejectWith(s,c))}};e?d():(R.Deferred.getErrorHook?d.error=R.Deferred.getErrorHook():R.Deferred.getStackHook&&(d.error=R.Deferred.getStackHook()),n.setTimeout(d))}}return R.Deferred((function(n){t[0][3].add(a(0,n,v(i)?i:Y,n.notifyWith)),t[1][3].add(a(0,n,v(e)?e:Y)),t[2][3].add(a(0,n,v(r)?r:J))})).promise()},promise:function(e){return null!=e?R.extend(e,i):i}},o={};return R.each(t,(function(e,n){var a=n[2],s=n[5];i[n[1]]=a.add,s&&a.add((function(){r=s}),t[3-e][2].disable,t[3-e][3].disable,t[0][2].lock,t[0][3].lock),a.add(n[3].fire),o[n[0]]=function(){return o[n[0]+"With"](this===o?void 0:this,arguments),this},o[n[0]+"With"]=a.fireWith})),i.promise(o),e&&e.call(o,o),o},when:function(e){var t=arguments.length,n=t,r=Array(n),i=s.call(arguments),o=R.Deferred(),a=function(e){return function(n){r[e]=this,i[e]=arguments.length>1?s.call(arguments):n,--t||o.resolveWith(r,i)}};if(t<=1&&(z(e,o.done(a(n)).resolve,o.reject,!t),"pending"===o.state()||v(i[n]&&i[n].then)))return o.then();for(;n--;)z(i[n],a(n),o.reject);return o.promise()}});var K=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;R.Deferred.exceptionHook=function(e,t){n.console&&n.console.warn&&e&&K.test(e.name)&&n.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},R.readyException=function(e){n.setTimeout((function(){throw e}))};var Q=R.Deferred();function q(){b.removeEventListener("DOMContentLoaded",q),n.removeEventListener("load",q),R.ready()}R.fn.ready=function(e){return Q.then(e).catch((function(e){R.readyException(e)})),this},R.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--R.readyWait:R.isReady)||(R.isReady=!0,!0!==e&&--R.readyWait>0||Q.resolveWith(b,[R]))}}),R.ready.then=Q.then,"complete"===b.readyState||"loading"!==b.readyState&&!b.documentElement.doScroll?n.setTimeout(R.ready):(b.addEventListener("DOMContentLoaded",q),n.addEventListener("load",q));var $=function(e,t,n,r,i,o,a){var s=0,c=e.length,u=null==n;if("object"===_(n))for(s in i=!0,n)$(e,t,s,n[s],!0,o,a);else if(void 0!==r&&(i=!0,v(r)||(a=!0),u&&(a?(t.call(e,r),t=null):(u=t,t=function(e,t,n){return u.call(R(e),n)})),t))for(;s<c;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:u?t.call(e):c?t(e[0],n):o},ee=/^-ms-/,te=/-([a-z])/g;function ne(e,t){return t.toUpperCase()}function re(e){return e.replace(ee,"ms-").replace(te,ne)}var ie=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function oe(){this.expando=R.expando+oe.uid++}oe.uid=1,oe.prototype={cache:function(e){var t=e[this.expando];return t||(t={},ie(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[re(t)]=n;else for(r in t)i[re(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][re(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(re):(t=re(t))in r?[t]:t.match(H)||[]).length;for(;n--;)delete r[t[n]]}(void 0===t||R.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!R.isEmptyObject(t)}};var ae=new oe,se=new oe,ce=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ue=/[A-Z]/g;function de(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(ue,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:ce.test(e)?JSON.parse(e):e)}(n)}catch(e){}se.set(e,t,n)}else n=void 0;return n}R.extend({hasData:function(e){return se.hasData(e)||ae.hasData(e)},data:function(e,t,n){return se.access(e,t,n)},removeData:function(e,t){se.remove(e,t)},_data:function(e,t,n){return ae.access(e,t,n)},_removeData:function(e,t){ae.remove(e,t)}}),R.fn.extend({data:function(e,t){var n,r,i,o=this[0],a=o&&o.attributes;if(void 0===e){if(this.length&&(i=se.get(o),1===o.nodeType&&!ae.get(o,"hasDataAttrs"))){for(n=a.length;n--;)a[n]&&0===(r=a[n].name).indexOf("data-")&&(r=re(r.slice(5)),de(o,r,i[r]));ae.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof e?this.each((function(){se.set(this,e)})):$(this,(function(t){var n;if(o&&void 0===t)return void 0!==(n=se.get(o,e))||void 0!==(n=de(o,e))?n:void 0;this.each((function(){se.set(this,e,t)}))}),null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each((function(){se.remove(this,e)}))}}),R.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=ae.get(e,t),n&&(!r||Array.isArray(n)?r=ae.access(e,t,R.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=R.queue(e,t),r=n.length,i=n.shift(),o=R._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,(function(){R.dequeue(e,t)}),o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return ae.get(e,n)||ae.access(e,n,{empty:R.Callbacks("once memory").add((function(){ae.remove(e,[t+"queue",n])}))})}}),R.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?R.queue(this[0],e):void 0===t?this:this.each((function(){var n=R.queue(this,e,t);R._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&R.dequeue(this,e)}))},dequeue:function(e){return this.each((function(){R.dequeue(this,e)}))},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=R.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)(n=ae.get(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var le=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,fe=new RegExp("^(?:([+-])=|)("+le+")([a-z%]*)$","i"),pe=["Top","Right","Bottom","Left"],he=b.documentElement,me=function(e){return R.contains(e.ownerDocument,e)},ge={composed:!0};he.getRootNode&&(me=function(e){return R.contains(e.ownerDocument,e)||e.getRootNode(ge)===e.ownerDocument});var ve=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&me(e)&&"none"===R.css(e,"display")};function ye(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return R.css(e,t,"")},c=s(),u=n&&n[3]||(R.cssNumber[t]?"":"px"),d=e.nodeType&&(R.cssNumber[t]||"px"!==u&&+c)&&fe.exec(R.css(e,t));if(d&&d[3]!==u){for(c/=2,u=u||d[3],d=+c||1;a--;)R.style(e,t,d+u),(1-o)*(1-(o=s()/c||.5))<=0&&(a=0),d/=o;d*=2,R.style(e,t,d+u),n=n||[]}return n&&(d=+d||+c||0,i=n[1]?d+(n[1]+1)*n[2]:+n[2],r&&(r.unit=u,r.start=d,r.end=i)),i}var be={};function Se(e){var t,n=e.ownerDocument,r=e.nodeName,i=be[r];return i||(t=n.body.appendChild(n.createElement(r)),i=R.css(t,"display"),t.parentNode.removeChild(t),"none"===i&&(i="block"),be[r]=i,i)}function Ee(e,t){for(var n,r,i=[],o=0,a=e.length;o<a;o++)(r=e[o]).style&&(n=r.style.display,t?("none"===n&&(i[o]=ae.get(r,"display")||null,i[o]||(r.style.display="")),""===r.style.display&&ve(r)&&(i[o]=Se(r))):"none"!==n&&(i[o]="none",ae.set(r,"display",n)));for(o=0;o<a;o++)null!=i[o]&&(e[o].style.display=i[o]);return e}R.fn.extend({show:function(){return Ee(this,!0)},hide:function(){return Ee(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each((function(){ve(this)?R(this).show():R(this).hide()}))}});var _e,Te,Re=/^(?:checkbox|radio)$/i,Ie=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,we=/^$|^module$|\/(?:java|ecma)script/i;_e=b.createDocumentFragment().appendChild(b.createElement("div")),(Te=b.createElement("input")).setAttribute("type","radio"),Te.setAttribute("checked","checked"),Te.setAttribute("name","t"),_e.appendChild(Te),g.checkClone=_e.cloneNode(!0).cloneNode(!0).lastChild.checked,_e.innerHTML="<textarea>x</textarea>",g.noCloneChecked=!!_e.cloneNode(!0).lastChild.defaultValue,_e.innerHTML="<option></option>",g.option=!!_e.lastChild;var Ce={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Oe(e,t){var n;return n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&w(e,t)?R.merge([e],n):n}function Ae(e,t){for(var n=0,r=e.length;n<r;n++)ae.set(e[n],"globalEval",!t||ae.get(t[n],"globalEval"))}Ce.tbody=Ce.tfoot=Ce.colgroup=Ce.caption=Ce.thead,Ce.th=Ce.td,g.option||(Ce.optgroup=Ce.option=[1,"<select multiple='multiple'>","</select>"]);var xe=/<|&#?\w+;/;function ke(e,t,n,r,i){for(var o,a,s,c,u,d,l=t.createDocumentFragment(),f=[],p=0,h=e.length;p<h;p++)if((o=e[p])||0===o)if("object"===_(o))R.merge(f,o.nodeType?[o]:o);else if(xe.test(o)){for(a=a||l.appendChild(t.createElement("div")),s=(Ie.exec(o)||["",""])[1].toLowerCase(),c=Ce[s]||Ce._default,a.innerHTML=c[1]+R.htmlPrefilter(o)+c[2],d=c[0];d--;)a=a.lastChild;R.merge(f,a.childNodes),(a=l.firstChild).textContent=""}else f.push(t.createTextNode(o));for(l.textContent="",p=0;o=f[p++];)if(r&&R.inArray(o,r)>-1)i&&i.push(o);else if(u=me(o),a=Oe(l.appendChild(o),"script"),u&&Ae(a),n)for(d=0;o=a[d++];)we.test(o.type||"")&&n.push(o);return l}var Ne=/^([^.]*)(?:\.(.+)|)/;function Le(){return!0}function Me(){return!1}function Ve(e,t,n,r,i,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(r=r||n,n=void 0),t)Ve(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=Me;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return R().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=R.guid++)),e.each((function(){R.event.add(this,t,i,r,n)}))}function Pe(e,t,n){n?(ae.set(e,t,!1),R.event.add(e,t,{namespace:!1,handler:function(e){var n,r=ae.get(this,t);if(1&e.isTrigger&&this[t]){if(r)(R.event.special[t]||{}).delegateType&&e.stopPropagation();else if(r=s.call(arguments),ae.set(this,t,r),this[t](),n=ae.get(this,t),ae.set(this,t,!1),r!==n)return e.stopImmediatePropagation(),e.preventDefault(),n}else r&&(ae.set(this,t,R.event.trigger(r[0],r.slice(1),this)),e.stopPropagation(),e.isImmediatePropagationStopped=Le)}})):void 0===ae.get(e,t)&&R.event.add(e,t,Le)}R.event={global:{},add:function(e,t,n,r,i){var o,a,s,c,u,d,l,f,p,h,m,g=ae.get(e);if(ie(e))for(n.handler&&(n=(o=n).handler,i=o.selector),i&&R.find.matchesSelector(he,i),n.guid||(n.guid=R.guid++),(c=g.events)||(c=g.events=Object.create(null)),(a=g.handle)||(a=g.handle=function(t){return void 0!==R&&R.event.triggered!==t.type?R.event.dispatch.apply(e,arguments):void 0}),u=(t=(t||"").match(H)||[""]).length;u--;)p=m=(s=Ne.exec(t[u])||[])[1],h=(s[2]||"").split(".").sort(),p&&(l=R.event.special[p]||{},p=(i?l.delegateType:l.bindType)||p,l=R.event.special[p]||{},d=R.extend({type:p,origType:m,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&R.expr.match.needsContext.test(i),namespace:h.join(".")},o),(f=c[p])||((f=c[p]=[]).delegateCount=0,l.setup&&!1!==l.setup.call(e,r,h,a)||e.addEventListener&&e.addEventListener(p,a)),l.add&&(l.add.call(e,d),d.handler.guid||(d.handler.guid=n.guid)),i?f.splice(f.delegateCount++,0,d):f.push(d),R.event.global[p]=!0)},remove:function(e,t,n,r,i){var o,a,s,c,u,d,l,f,p,h,m,g=ae.hasData(e)&&ae.get(e);if(g&&(c=g.events)){for(u=(t=(t||"").match(H)||[""]).length;u--;)if(p=m=(s=Ne.exec(t[u])||[])[1],h=(s[2]||"").split(".").sort(),p){for(l=R.event.special[p]||{},f=c[p=(r?l.delegateType:l.bindType)||p]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=f.length;o--;)d=f[o],!i&&m!==d.origType||n&&n.guid!==d.guid||s&&!s.test(d.namespace)||r&&r!==d.selector&&("**"!==r||!d.selector)||(f.splice(o,1),d.selector&&f.delegateCount--,l.remove&&l.remove.call(e,d));a&&!f.length&&(l.teardown&&!1!==l.teardown.call(e,h,g.handle)||R.removeEvent(e,p,g.handle),delete c[p])}else for(p in c)R.event.remove(e,p+t[u],n,r,!0);R.isEmptyObject(c)&&ae.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,a,s=new Array(arguments.length),c=R.event.fix(e),u=(ae.get(this,"events")||Object.create(null))[c.type]||[],d=R.event.special[c.type]||{};for(s[0]=c,t=1;t<arguments.length;t++)s[t]=arguments[t];if(c.delegateTarget=this,!d.preDispatch||!1!==d.preDispatch.call(this,c)){for(a=R.event.handlers.call(this,c,u),t=0;(i=a[t++])&&!c.isPropagationStopped();)for(c.currentTarget=i.elem,n=0;(o=i.handlers[n++])&&!c.isImmediatePropagationStopped();)c.rnamespace&&!1!==o.namespace&&!c.rnamespace.test(o.namespace)||(c.handleObj=o,c.data=o.data,void 0!==(r=((R.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s))&&!1===(c.result=r)&&(c.preventDefault(),c.stopPropagation()));return d.postDispatch&&d.postDispatch.call(this,c),c.result}},handlers:function(e,t){var n,r,i,o,a,s=[],c=t.delegateCount,u=e.target;if(c&&u.nodeType&&!("click"===e.type&&e.button>=1))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&("click"!==e.type||!0!==u.disabled)){for(o=[],a={},n=0;n<c;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?R(i,this).index(u)>-1:R.find(i,this,null,[u]).length),a[i]&&o.push(r);o.length&&s.push({elem:u,handlers:o})}return u=this,c<t.length&&s.push({elem:u,handlers:t.slice(c)}),s},addProp:function(e,t){Object.defineProperty(R.Event.prototype,e,{enumerable:!0,configurable:!0,get:v(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[R.expando]?e:new R.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return Re.test(t.type)&&t.click&&w(t,"input")&&Pe(t,"click",!0),!1},trigger:function(e){var t=this||e;return Re.test(t.type)&&t.click&&w(t,"input")&&Pe(t,"click"),!0},_default:function(e){var t=e.target;return Re.test(t.type)&&t.click&&w(t,"input")&&ae.get(t,"click")||w(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},R.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},R.Event=function(e,t){if(!(this instanceof R.Event))return new R.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Le:Me,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&R.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[R.expando]=!0},R.Event.prototype={constructor:R.Event,isDefaultPrevented:Me,isPropagationStopped:Me,isImmediatePropagationStopped:Me,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Le,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Le,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Le,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},R.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},R.event.addProp),R.each({focus:"focusin",blur:"focusout"},(function(e,t){function n(e){if(b.documentMode){var n=ae.get(this,"handle"),r=R.event.fix(e);r.type="focusin"===e.type?"focus":"blur",r.isSimulated=!0,n(e),r.target===r.currentTarget&&n(r)}else R.event.simulate(t,e.target,R.event.fix(e))}R.event.special[e]={setup:function(){var r;if(Pe(this,e,!0),!b.documentMode)return!1;(r=ae.get(this,t))||this.addEventListener(t,n),ae.set(this,t,(r||0)+1)},trigger:function(){return Pe(this,e),!0},teardown:function(){var e;if(!b.documentMode)return!1;(e=ae.get(this,t)-1)?ae.set(this,t,e):(this.removeEventListener(t,n),ae.remove(this,t))},_default:function(t){return ae.get(t.target,e)},delegateType:t},R.event.special[t]={setup:function(){var r=this.ownerDocument||this.document||this,i=b.documentMode?this:r,o=ae.get(i,t);o||(b.documentMode?this.addEventListener(t,n):r.addEventListener(e,n,!0)),ae.set(i,t,(o||0)+1)},teardown:function(){var r=this.ownerDocument||this.document||this,i=b.documentMode?this:r,o=ae.get(i,t)-1;o?ae.set(i,t,o):(b.documentMode?this.removeEventListener(t,n):r.removeEventListener(e,n,!0),ae.remove(i,t))}}})),R.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(e,t){R.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return i&&(i===r||R.contains(r,i))||(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}})),R.fn.extend({on:function(e,t,n,r){return Ve(this,e,t,n,r)},one:function(e,t,n,r){return Ve(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,R(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Me),this.each((function(){R.event.remove(this,e,n,t)}))}});var De=/<script|<style|<link/i,Ze=/checked\s*(?:[^=]|=\s*.checked.)/i,je=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function We(e,t){return w(e,"table")&&w(11!==t.nodeType?t:t.firstChild,"tr")&&R(e).children("tbody")[0]||e}function Ge(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function Fe(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Ue(e,t){var n,r,i,o,a,s;if(1===t.nodeType){if(ae.hasData(e)&&(s=ae.get(e).events))for(i in ae.remove(t,"handle events"),s)for(n=0,r=s[i].length;n<r;n++)R.event.add(t,i,s[i][n]);se.hasData(e)&&(o=se.access(e),a=R.extend({},o),se.set(t,a))}}function Xe(e,t){var n=t.nodeName.toLowerCase();"input"===n&&Re.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}function Be(e,t,n,r){t=c(t);var i,o,a,s,u,d,l=0,f=e.length,p=f-1,h=t[0],m=v(h);if(m||f>1&&"string"==typeof h&&!g.checkClone&&Ze.test(h))return e.each((function(i){var o=e.eq(i);m&&(t[0]=h.call(this,i,o.html())),Be(o,t,n,r)}));if(f&&(o=(i=ke(t,e[0].ownerDocument,!1,e,r)).firstChild,1===i.childNodes.length&&(i=o),o||r)){for(s=(a=R.map(Oe(i,"script"),Ge)).length;l<f;l++)u=i,l!==p&&(u=R.clone(u,!0,!0),s&&R.merge(a,Oe(u,"script"))),n.call(e[l],u,l);if(s)for(d=a[a.length-1].ownerDocument,R.map(a,Fe),l=0;l<s;l++)u=a[l],we.test(u.type||"")&&!ae.access(u,"globalEval")&&R.contains(d,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?R._evalUrl&&!u.noModule&&R._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},d):E(u.textContent.replace(je,""),u,d))}return e}function He(e,t,n){for(var r,i=t?R.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||R.cleanData(Oe(r)),r.parentNode&&(n&&me(r)&&Ae(Oe(r,"script")),r.parentNode.removeChild(r));return e}R.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,o,a,s=e.cloneNode(!0),c=me(e);if(!(g.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||R.isXMLDoc(e)))for(a=Oe(s),r=0,i=(o=Oe(e)).length;r<i;r++)Xe(o[r],a[r]);if(t)if(n)for(o=o||Oe(e),a=a||Oe(s),r=0,i=o.length;r<i;r++)Ue(o[r],a[r]);else Ue(e,s);return(a=Oe(s,"script")).length>0&&Ae(a,!c&&Oe(e,"script")),s},cleanData:function(e){for(var t,n,r,i=R.event.special,o=0;void 0!==(n=e[o]);o++)if(ie(n)){if(t=n[ae.expando]){if(t.events)for(r in t.events)i[r]?R.event.remove(n,r):R.removeEvent(n,r,t.handle);n[ae.expando]=void 0}n[se.expando]&&(n[se.expando]=void 0)}}}),R.fn.extend({detach:function(e){return He(this,e,!0)},remove:function(e){return He(this,e)},text:function(e){return $(this,(function(e){return void 0===e?R.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)}))}),null,e,arguments.length)},append:function(){return Be(this,arguments,(function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||We(this,e).appendChild(e)}))},prepend:function(){return Be(this,arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=We(this,e);t.insertBefore(e,t.firstChild)}}))},before:function(){return Be(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this)}))},after:function(){return Be(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)}))},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(R.cleanData(Oe(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map((function(){return R.clone(this,e,t)}))},html:function(e){return $(this,(function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!De.test(e)&&!Ce[(Ie.exec(e)||["",""])[1].toLowerCase()]){e=R.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(R.cleanData(Oe(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)}),null,e,arguments.length)},replaceWith:function(){var e=[];return Be(this,arguments,(function(t){var n=this.parentNode;R.inArray(this,e)<0&&(R.cleanData(Oe(this)),n&&n.replaceChild(t,this))}),e)}}),R.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(e,t){R.fn[e]=function(e){for(var n,r=[],i=R(e),o=i.length-1,a=0;a<=o;a++)n=a===o?this:this.clone(!0),R(i[a])[t](n),u.apply(r,n.get());return this.pushStack(r)}}));var Ye=new RegExp("^("+le+")(?!px)[a-z%]+$","i"),Je=/^--/,ze=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=n),t.getComputedStyle(e)},Ke=function(e,t,n){var r,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=o[i];return r},Qe=new RegExp(pe.join("|"),"i");function qe(e,t,n){var r,i,o,a,s=Je.test(t),c=e.style;return(n=n||ze(e))&&(a=n.getPropertyValue(t)||n[t],s&&a&&(a=a.replace(k,"$1")||void 0),""!==a||me(e)||(a=R.style(e,t)),!g.pixelBoxStyles()&&Ye.test(a)&&Qe.test(t)&&(r=c.width,i=c.minWidth,o=c.maxWidth,c.minWidth=c.maxWidth=c.width=a,a=n.width,c.width=r,c.minWidth=i,c.maxWidth=o)),void 0!==a?a+"":a}function $e(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(d){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",d.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",he.appendChild(u).appendChild(d);var e=n.getComputedStyle(d);r="1%"!==e.top,c=12===t(e.marginLeft),d.style.right="60%",a=36===t(e.right),i=36===t(e.width),d.style.position="absolute",o=12===t(d.offsetWidth/3),he.removeChild(u),d=null}}function t(e){return Math.round(parseFloat(e))}var r,i,o,a,s,c,u=b.createElement("div"),d=b.createElement("div");d.style&&(d.style.backgroundClip="content-box",d.cloneNode(!0).style.backgroundClip="",g.clearCloneStyle="content-box"===d.style.backgroundClip,R.extend(g,{boxSizingReliable:function(){return e(),i},pixelBoxStyles:function(){return e(),a},pixelPosition:function(){return e(),r},reliableMarginLeft:function(){return e(),c},scrollboxSize:function(){return e(),o},reliableTrDimensions:function(){var e,t,r,i;return null==s&&(e=b.createElement("table"),t=b.createElement("tr"),r=b.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="border:1px solid",t.style.height="1px",r.style.height="9px",r.style.display="block",he.appendChild(e).appendChild(t).appendChild(r),i=n.getComputedStyle(t),s=parseInt(i.height,10)+parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10)===t.offsetHeight,he.removeChild(e)),s}}))}();var et=["Webkit","Moz","ms"],tt=b.createElement("div").style,nt={};function rt(e){var t=R.cssProps[e]||nt[e];return t||(e in tt?e:nt[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),n=et.length;n--;)if((e=et[n]+t)in tt)return e}(e)||e)}var it=/^(none|table(?!-c[ea]).+)/,ot={position:"absolute",visibility:"hidden",display:"block"},at={letterSpacing:"0",fontWeight:"400"};function st(e,t,n){var r=fe.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function ct(e,t,n,r,i,o){var a="width"===t?1:0,s=0,c=0,u=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(u+=R.css(e,n+pe[a],!0,i)),r?("content"===n&&(c-=R.css(e,"padding"+pe[a],!0,i)),"margin"!==n&&(c-=R.css(e,"border"+pe[a]+"Width",!0,i))):(c+=R.css(e,"padding"+pe[a],!0,i),"padding"!==n?c+=R.css(e,"border"+pe[a]+"Width",!0,i):s+=R.css(e,"border"+pe[a]+"Width",!0,i));return!r&&o>=0&&(c+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-c-s-.5))||0),c+u}function ut(e,t,n){var r=ze(e),i=(!g.boxSizingReliable()||n)&&"border-box"===R.css(e,"boxSizing",!1,r),o=i,a=qe(e,t,r),s="offset"+t[0].toUpperCase()+t.slice(1);if(Ye.test(a)){if(!n)return a;a="auto"}return(!g.boxSizingReliable()&&i||!g.reliableTrDimensions()&&w(e,"tr")||"auto"===a||!parseFloat(a)&&"inline"===R.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===R.css(e,"boxSizing",!1,r),(o=s in e)&&(a=e[s])),(a=parseFloat(a)||0)+ct(e,t,n||(i?"border":"content"),o,r,a)+"px"}function dt(e,t,n,r,i){return new dt.prototype.init(e,t,n,r,i)}R.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=qe(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=re(t),c=Je.test(t),u=e.style;if(c||(t=rt(s)),a=R.cssHooks[t]||R.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:u[t];"string"===(o=typeof n)&&(i=fe.exec(n))&&i[1]&&(n=ye(e,t,i),o="number"),null!=n&&n==n&&("number"!==o||c||(n+=i&&i[3]||(R.cssNumber[s]?"":"px")),g.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(c?u.setProperty(t,n):u[t]=n))}},css:function(e,t,n,r){var i,o,a,s=re(t);return Je.test(t)||(t=rt(s)),(a=R.cssHooks[t]||R.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=qe(e,t,r)),"normal"===i&&t in at&&(i=at[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),R.each(["height","width"],(function(e,t){R.cssHooks[t]={get:function(e,n,r){if(n)return!it.test(R.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?ut(e,t,r):Ke(e,ot,(function(){return ut(e,t,r)}))},set:function(e,n,r){var i,o=ze(e),a=!g.scrollboxSize()&&"absolute"===o.position,s=(a||r)&&"border-box"===R.css(e,"boxSizing",!1,o),c=r?ct(e,t,r,s,o):0;return s&&a&&(c-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(o[t])-ct(e,t,"border",!1,o)-.5)),c&&(i=fe.exec(n))&&"px"!==(i[3]||"px")&&(e.style[t]=n,n=R.css(e,t)),st(0,n,c)}}})),R.cssHooks.marginLeft=$e(g.reliableMarginLeft,(function(e,t){if(t)return(parseFloat(qe(e,"marginLeft"))||e.getBoundingClientRect().left-Ke(e,{marginLeft:0},(function(){return e.getBoundingClientRect().left})))+"px"})),R.each({margin:"",padding:"",border:"Width"},(function(e,t){R.cssHooks[e+t]={expand:function(n){for(var r=0,i={},o="string"==typeof n?n.split(" "):[n];r<4;r++)i[e+pe[r]+t]=o[r]||o[r-2]||o[0];return i}},"margin"!==e&&(R.cssHooks[e+t].set=st)})),R.fn.extend({css:function(e,t){return $(this,(function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=ze(e),i=t.length;a<i;a++)o[t[a]]=R.css(e,t[a],!1,r);return o}return void 0!==n?R.style(e,t,n):R.css(e,t)}),e,t,arguments.length>1)}}),R.Tween=dt,dt.prototype={constructor:dt,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||R.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(R.cssNumber[n]?"":"px")},cur:function(){var e=dt.propHooks[this.prop];return e&&e.get?e.get(this):dt.propHooks._default.get(this)},run:function(e){var t,n=dt.propHooks[this.prop];return this.options.duration?this.pos=t=R.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):dt.propHooks._default.set(this),this}},dt.prototype.init.prototype=dt.prototype,dt.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=R.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){R.fx.step[e.prop]?R.fx.step[e.prop](e):1!==e.elem.nodeType||!R.cssHooks[e.prop]&&null==e.elem.style[rt(e.prop)]?e.elem[e.prop]=e.now:R.style(e.elem,e.prop,e.now+e.unit)}}},dt.propHooks.scrollTop=dt.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},R.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},R.fx=dt.prototype.init,R.fx.step={};var lt,ft,pt=/^(?:toggle|show|hide)$/,ht=/queueHooks$/;function mt(){ft&&(!1===b.hidden&&n.requestAnimationFrame?n.requestAnimationFrame(mt):n.setTimeout(mt,R.fx.interval),R.fx.tick())}function gt(){return n.setTimeout((function(){lt=void 0})),lt=Date.now()}function vt(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=pe[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function yt(e,t,n){for(var r,i=(bt.tweeners[t]||[]).concat(bt.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function bt(e,t,n){var r,i,o=0,a=bt.prefilters.length,s=R.Deferred().always((function(){delete c.elem})),c=function(){if(i)return!1;for(var t=lt||gt(),n=Math.max(0,u.startTime+u.duration-t),r=1-(n/u.duration||0),o=0,a=u.tweens.length;o<a;o++)u.tweens[o].run(r);return s.notifyWith(e,[u,r,n]),r<1&&a?n:(a||s.notifyWith(e,[u,1,0]),s.resolveWith(e,[u]),!1)},u=s.promise({elem:e,props:R.extend({},t),opts:R.extend(!0,{specialEasing:{},easing:R.easing._default},n),originalProperties:t,originalOptions:n,startTime:lt||gt(),duration:n.duration,tweens:[],createTween:function(t,n){var r=R.Tween(e,u.opts,t,n,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(r),r},stop:function(t){var n=0,r=t?u.tweens.length:0;if(i)return this;for(i=!0;n<r;n++)u.tweens[n].run(1);return t?(s.notifyWith(e,[u,1,0]),s.resolveWith(e,[u,t])):s.rejectWith(e,[u,t]),this}}),d=u.props;for(!function(e,t){var n,r,i,o,a;for(n in e)if(i=t[r=re(n)],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=R.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(d,u.opts.specialEasing);o<a;o++)if(r=bt.prefilters[o].call(u,e,d,u.opts))return v(r.stop)&&(R._queueHooks(u.elem,u.opts.queue).stop=r.stop.bind(r)),r;return R.map(d,yt,u),v(u.opts.start)&&u.opts.start.call(e,u),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always),R.fx.timer(R.extend(c,{elem:e,anim:u,queue:u.opts.queue})),u}R.Animation=R.extend(bt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return ye(n.elem,e,fe.exec(t),n),n}]},tweener:function(e,t){v(e)?(t=e,e=["*"]):e=e.match(H);for(var n,r=0,i=e.length;r<i;r++)n=e[r],bt.tweeners[n]=bt.tweeners[n]||[],bt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,a,s,c,u,d,l="width"in t||"height"in t,f=this,p={},h=e.style,m=e.nodeType&&ve(e),g=ae.get(e,"fxshow");for(r in n.queue||(null==(a=R._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,f.always((function(){f.always((function(){a.unqueued--,R.queue(e,"fx").length||a.empty.fire()}))}))),t)if(i=t[r],pt.test(i)){if(delete t[r],o=o||"toggle"===i,i===(m?"hide":"show")){if("show"!==i||!g||void 0===g[r])continue;m=!0}p[r]=g&&g[r]||R.style(e,r)}if((c=!R.isEmptyObject(t))||!R.isEmptyObject(p))for(r in l&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(u=g&&g.display)&&(u=ae.get(e,"display")),"none"===(d=R.css(e,"display"))&&(u?d=u:(Ee([e],!0),u=e.style.display||u,d=R.css(e,"display"),Ee([e]))),("inline"===d||"inline-block"===d&&null!=u)&&"none"===R.css(e,"float")&&(c||(f.done((function(){h.display=u})),null==u&&(d=h.display,u="none"===d?"":d)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",f.always((function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]}))),c=!1,p)c||(g?"hidden"in g&&(m=g.hidden):g=ae.access(e,"fxshow",{display:u}),o&&(g.hidden=!m),m&&Ee([e],!0),f.done((function(){for(r in m||Ee([e]),ae.remove(e,"fxshow"),p)R.style(e,r,p[r])}))),c=yt(m?g[r]:0,r,f),r in g||(g[r]=c.start,m&&(c.end=c.start,c.start=0))}],prefilter:function(e,t){t?bt.prefilters.unshift(e):bt.prefilters.push(e)}}),R.speed=function(e,t,n){var r=e&&"object"==typeof e?R.extend({},e):{complete:n||!n&&t||v(e)&&e,duration:e,easing:n&&t||t&&!v(t)&&t};return R.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in R.fx.speeds?r.duration=R.fx.speeds[r.duration]:r.duration=R.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){v(r.old)&&r.old.call(this),r.queue&&R.dequeue(this,r.queue)},r},R.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ve).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=R.isEmptyObject(e),o=R.speed(t,n,r),a=function(){var t=bt(this,R.extend({},e),o);(i||ae.get(this,"finish"))&&t.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&this.queue(e||"fx",[]),this.each((function(){var t=!0,i=null!=e&&e+"queueHooks",o=R.timers,a=ae.get(this);if(i)a[i]&&a[i].stop&&r(a[i]);else for(i in a)a[i]&&a[i].stop&&ht.test(i)&&r(a[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));!t&&n||R.dequeue(this,e)}))},finish:function(e){return!1!==e&&(e=e||"fx"),this.each((function(){var t,n=ae.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=R.timers,a=r?r.length:0;for(n.finish=!0,R.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<a;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish}))}}),R.each(["toggle","show","hide"],(function(e,t){var n=R.fn[t];R.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(vt(t,!0),e,r,i)}})),R.each({slideDown:vt("show"),slideUp:vt("hide"),slideToggle:vt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(e,t){R.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}})),R.timers=[],R.fx.tick=function(){var e,t=0,n=R.timers;for(lt=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||R.fx.stop(),lt=void 0},R.fx.timer=function(e){R.timers.push(e),R.fx.start()},R.fx.interval=13,R.fx.start=function(){ft||(ft=!0,mt())},R.fx.stop=function(){ft=null},R.fx.speeds={slow:600,fast:200,_default:400},R.fn.delay=function(e,t){return e=R.fx&&R.fx.speeds[e]||e,t=t||"fx",this.queue(t,(function(t,r){var i=n.setTimeout(t,e);r.stop=function(){n.clearTimeout(i)}}))},function(){var e=b.createElement("input"),t=b.createElement("select").appendChild(b.createElement("option"));e.type="checkbox",g.checkOn=""!==e.value,g.optSelected=t.selected,(e=b.createElement("input")).value="t",e.type="radio",g.radioValue="t"===e.value}();var St,Et=R.expr.attrHandle;R.fn.extend({attr:function(e,t){return $(this,R.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each((function(){R.removeAttr(this,e)}))}}),R.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?R.prop(e,t,n):(1===o&&R.isXMLDoc(e)||(i=R.attrHooks[t.toLowerCase()]||(R.expr.match.bool.test(t)?St:void 0)),void 0!==n?null===n?void R.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=R.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!g.radioValue&&"radio"===t&&w(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(H);if(i&&1===e.nodeType)for(;n=i[r++];)e.removeAttribute(n)}}),St={set:function(e,t,n){return!1===t?R.removeAttr(e,n):e.setAttribute(n,n),n}},R.each(R.expr.match.bool.source.match(/\w+/g),(function(e,t){var n=Et[t]||R.find.attr;Et[t]=function(e,t,r){var i,o,a=t.toLowerCase();return r||(o=Et[a],Et[a]=i,i=null!=n(e,t,r)?a:null,Et[a]=o),i}}));var _t=/^(?:input|select|textarea|button)$/i,Tt=/^(?:a|area)$/i;function Rt(e){return(e.match(H)||[]).join(" ")}function It(e){return e.getAttribute&&e.getAttribute("class")||""}function wt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(H)||[]}R.fn.extend({prop:function(e,t){return $(this,R.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each((function(){delete this[R.propFix[e]||e]}))}}),R.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&R.isXMLDoc(e)||(t=R.propFix[t]||t,i=R.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=R.find.attr(e,"tabindex");return t?parseInt(t,10):_t.test(e.nodeName)||Tt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),g.optSelected||(R.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),R.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){R.propFix[this.toLowerCase()]=this})),R.fn.extend({addClass:function(e){var t,n,r,i,o,a;return v(e)?this.each((function(t){R(this).addClass(e.call(this,t,It(this)))})):(t=wt(e)).length?this.each((function(){if(r=It(this),n=1===this.nodeType&&" "+Rt(r)+" "){for(o=0;o<t.length;o++)i=t[o],n.indexOf(" "+i+" ")<0&&(n+=i+" ");a=Rt(n),r!==a&&this.setAttribute("class",a)}})):this},removeClass:function(e){var t,n,r,i,o,a;return v(e)?this.each((function(t){R(this).removeClass(e.call(this,t,It(this)))})):arguments.length?(t=wt(e)).length?this.each((function(){if(r=It(this),n=1===this.nodeType&&" "+Rt(r)+" "){for(o=0;o<t.length;o++)for(i=t[o];n.indexOf(" "+i+" ")>-1;)n=n.replace(" "+i+" "," ");a=Rt(n),r!==a&&this.setAttribute("class",a)}})):this:this.attr("class","")},toggleClass:function(e,t){var n,r,i,o,a=typeof e,s="string"===a||Array.isArray(e);return v(e)?this.each((function(n){R(this).toggleClass(e.call(this,n,It(this),t),t)})):"boolean"==typeof t&&s?t?this.addClass(e):this.removeClass(e):(n=wt(e),this.each((function(){if(s)for(o=R(this),i=0;i<n.length;i++)r=n[i],o.hasClass(r)?o.removeClass(r):o.addClass(r);else void 0!==e&&"boolean"!==a||((r=It(this))&&ae.set(this,"__className__",r),this.setAttribute&&this.setAttribute("class",r||!1===e?"":ae.get(this,"__className__")||""))})))},hasClass:function(e){var t,n,r=0;for(t=" "+e+" ";n=this[r++];)if(1===n.nodeType&&(" "+Rt(It(n))+" ").indexOf(t)>-1)return!0;return!1}});var Ct=/\r/g;R.fn.extend({val:function(e){var t,n,r,i=this[0];return arguments.length?(r=v(e),this.each((function(n){var i;1===this.nodeType&&(null==(i=r?e.call(this,n,R(this).val()):e)?i="":"number"==typeof i?i+="":Array.isArray(i)&&(i=R.map(i,(function(e){return null==e?"":e+""}))),(t=R.valHooks[this.type]||R.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,i,"value")||(this.value=i))}))):i?(t=R.valHooks[i.type]||R.valHooks[i.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(i,"value"))?n:"string"==typeof(n=i.value)?n.replace(Ct,""):null==n?"":n:void 0}}),R.extend({valHooks:{option:{get:function(e){var t=R.find.attr(e,"value");return null!=t?t:Rt(R.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],c=a?o+1:i.length;for(r=o<0?c:a?o:0;r<c;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!w(n.parentNode,"optgroup"))){if(t=R(n).val(),a)return t;s.push(t)}return s},set:function(e,t){for(var n,r,i=e.options,o=R.makeArray(t),a=i.length;a--;)((r=i[a]).selected=R.inArray(R.valHooks.option.get(r),o)>-1)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),R.each(["radio","checkbox"],(function(){R.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=R.inArray(R(e).val(),t)>-1}},g.checkOn||(R.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}));var Ot=n.location,At={guid:Date.now()},xt=/\?/;R.parseXML=function(e){var t,r;if(!e||"string"!=typeof e)return null;try{t=(new n.DOMParser).parseFromString(e,"text/xml")}catch(e){}return r=t&&t.getElementsByTagName("parsererror")[0],t&&!r||R.error("Invalid XML: "+(r?R.map(r.childNodes,(function(e){return e.textContent})).join("\n"):e)),t};var kt=/^(?:focusinfocus|focusoutblur)$/,Nt=function(e){e.stopPropagation()};R.extend(R.event,{trigger:function(e,t,r,i){var o,a,s,c,u,d,l,f,h=[r||b],m=p.call(e,"type")?e.type:e,g=p.call(e,"namespace")?e.namespace.split("."):[];if(a=f=s=r=r||b,3!==r.nodeType&&8!==r.nodeType&&!kt.test(m+R.event.triggered)&&(m.indexOf(".")>-1&&(g=m.split("."),m=g.shift(),g.sort()),u=m.indexOf(":")<0&&"on"+m,(e=e[R.expando]?e:new R.Event(m,"object"==typeof e&&e)).isTrigger=i?2:3,e.namespace=g.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=r),t=null==t?[e]:R.makeArray(t,[e]),l=R.event.special[m]||{},i||!l.trigger||!1!==l.trigger.apply(r,t))){if(!i&&!l.noBubble&&!y(r)){for(c=l.delegateType||m,kt.test(c+m)||(a=a.parentNode);a;a=a.parentNode)h.push(a),s=a;s===(r.ownerDocument||b)&&h.push(s.defaultView||s.parentWindow||n)}for(o=0;(a=h[o++])&&!e.isPropagationStopped();)f=a,e.type=o>1?c:l.bindType||m,(d=(ae.get(a,"events")||Object.create(null))[e.type]&&ae.get(a,"handle"))&&d.apply(a,t),(d=u&&a[u])&&d.apply&&ie(a)&&(e.result=d.apply(a,t),!1===e.result&&e.preventDefault());return e.type=m,i||e.isDefaultPrevented()||l._default&&!1!==l._default.apply(h.pop(),t)||!ie(r)||u&&v(r[m])&&!y(r)&&((s=r[u])&&(r[u]=null),R.event.triggered=m,e.isPropagationStopped()&&f.addEventListener(m,Nt),r[m](),e.isPropagationStopped()&&f.removeEventListener(m,Nt),R.event.triggered=void 0,s&&(r[u]=s)),e.result}},simulate:function(e,t,n){var r=R.extend(new R.Event,n,{type:e,isSimulated:!0});R.event.trigger(r,null,t)}}),R.fn.extend({trigger:function(e,t){return this.each((function(){R.event.trigger(e,t,this)}))},triggerHandler:function(e,t){var n=this[0];if(n)return R.event.trigger(e,t,n,!0)}});var Lt=/\[\]$/,Mt=/\r?\n/g,Vt=/^(?:submit|button|image|reset|file)$/i,Pt=/^(?:input|select|textarea|keygen)/i;function Dt(e,t,n,r){var i;if(Array.isArray(t))R.each(t,(function(t,i){n||Lt.test(e)?r(e,i):Dt(e+"["+("object"==typeof i&&null!=i?t:"")+"]",i,n,r)}));else if(n||"object"!==_(t))r(e,t);else for(i in t)Dt(e+"["+i+"]",t[i],n,r)}R.param=function(e,t){var n,r=[],i=function(e,t){var n=v(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!R.isPlainObject(e))R.each(e,(function(){i(this.name,this.value)}));else for(n in e)Dt(n,e[n],t,i);return r.join("&")},R.fn.extend({serialize:function(){return R.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var e=R.prop(this,"elements");return e?R.makeArray(e):this})).filter((function(){var e=this.type;return this.name&&!R(this).is(":disabled")&&Pt.test(this.nodeName)&&!Vt.test(e)&&(this.checked||!Re.test(e))})).map((function(e,t){var n=R(this).val();return null==n?null:Array.isArray(n)?R.map(n,(function(e){return{name:t.name,value:e.replace(Mt,"\r\n")}})):{name:t.name,value:n.replace(Mt,"\r\n")}})).get()}});var Zt=/%20/g,jt=/#.*$/,Wt=/([?&])_=[^&]*/,Gt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ft=/^(?:GET|HEAD)$/,Ut=/^\/\//,Xt={},Bt={},Ht="*/".concat("*"),Yt=b.createElement("a");function Jt(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(H)||[];if(v(n))for(;r=o[i++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function zt(e,t,n,r){var i={},o=e===Bt;function a(s){var c;return i[s]=!0,R.each(e[s]||[],(function(e,s){var u=s(t,n,r);return"string"!=typeof u||o||i[u]?o?!(c=u):void 0:(t.dataTypes.unshift(u),a(u),!1)})),c}return a(t.dataTypes[0])||!i["*"]&&a("*")}function Kt(e,t){var n,r,i=R.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&R.extend(!0,e,r),e}Yt.href=Ot.href,R.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ot.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Ot.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ht,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":R.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Kt(Kt(e,R.ajaxSettings),t):Kt(R.ajaxSettings,e)},ajaxPrefilter:Jt(Xt),ajaxTransport:Jt(Bt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var r,i,o,a,s,c,u,d,l,f,p=R.ajaxSetup({},t),h=p.context||p,m=p.context&&(h.nodeType||h.jquery)?R(h):R.event,g=R.Deferred(),v=R.Callbacks("once memory"),y=p.statusCode||{},S={},E={},_="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(u){if(!a)for(a={};t=Gt.exec(o);)a[t[1].toLowerCase()+" "]=(a[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=a[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return u?o:null},setRequestHeader:function(e,t){return null==u&&(e=E[e.toLowerCase()]=E[e.toLowerCase()]||e,S[e]=t),this},overrideMimeType:function(e){return null==u&&(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(u)T.always(e[T.status]);else for(t in e)y[t]=[y[t],e[t]];return this},abort:function(e){var t=e||_;return r&&r.abort(t),I(0,t),this}};if(g.promise(T),p.url=((e||p.url||Ot.href)+"").replace(Ut,Ot.protocol+"//"),p.type=t.method||t.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(H)||[""],null==p.crossDomain){c=b.createElement("a");try{c.href=p.url,c.href=c.href,p.crossDomain=Yt.protocol+"//"+Yt.host!=c.protocol+"//"+c.host}catch(e){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=R.param(p.data,p.traditional)),zt(Xt,p,t,T),u)return T;for(l in(d=R.event&&p.global)&&0==R.active++&&R.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Ft.test(p.type),i=p.url.replace(jt,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(Zt,"+")):(f=p.url.slice(i.length),p.data&&(p.processData||"string"==typeof p.data)&&(i+=(xt.test(i)?"&":"?")+p.data,delete p.data),!1===p.cache&&(i=i.replace(Wt,"$1"),f=(xt.test(i)?"&":"?")+"_="+At.guid+++f),p.url=i+f),p.ifModified&&(R.lastModified[i]&&T.setRequestHeader("If-Modified-Since",R.lastModified[i]),R.etag[i]&&T.setRequestHeader("If-None-Match",R.etag[i])),(p.data&&p.hasContent&&!1!==p.contentType||t.contentType)&&T.setRequestHeader("Content-Type",p.contentType),T.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Ht+"; q=0.01":""):p.accepts["*"]),p.headers)T.setRequestHeader(l,p.headers[l]);if(p.beforeSend&&(!1===p.beforeSend.call(h,T,p)||u))return T.abort();if(_="abort",v.add(p.complete),T.done(p.success),T.fail(p.error),r=zt(Bt,p,t,T)){if(T.readyState=1,d&&m.trigger("ajaxSend",[T,p]),u)return T;p.async&&p.timeout>0&&(s=n.setTimeout((function(){T.abort("timeout")}),p.timeout));try{u=!1,r.send(S,I)}catch(e){if(u)throw e;I(-1,e)}}else I(-1,"No Transport");function I(e,t,a,c){var l,f,b,S,E,_=t;u||(u=!0,s&&n.clearTimeout(s),r=void 0,o=c||"",T.readyState=e>0?4:0,l=e>=200&&e<300||304===e,a&&(S=function(e,t,n){for(var r,i,o,a,s=e.contents,c=e.dataTypes;"*"===c[0];)c.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){c.unshift(i);break}if(c[0]in n)o=c[0];else{for(i in n){if(!c[0]||e.converters[i+" "+c[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==c[0]&&c.unshift(o),n[o]}(p,T,a)),!l&&R.inArray("script",p.dataTypes)>-1&&R.inArray("json",p.dataTypes)<0&&(p.converters["text script"]=function(){}),S=function(e,t,n,r){var i,o,a,s,c,u={},d=e.dataTypes.slice();if(d[1])for(a in e.converters)u[a.toLowerCase()]=e.converters[a];for(o=d.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!c&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),c=o,o=d.shift())if("*"===o)o=c;else if("*"!==c&&c!==o){if(!(a=u[c+" "+o]||u["* "+o]))for(i in u)if((s=i.split(" "))[1]===o&&(a=u[c+" "+s[0]]||u["* "+s[0]])){!0===a?a=u[i]:!0!==u[i]&&(o=s[0],d.unshift(s[1]));break}if(!0!==a)if(a&&e.throws)t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+c+" to "+o}}}return{state:"success",data:t}}(p,S,T,l),l?(p.ifModified&&((E=T.getResponseHeader("Last-Modified"))&&(R.lastModified[i]=E),(E=T.getResponseHeader("etag"))&&(R.etag[i]=E)),204===e||"HEAD"===p.type?_="nocontent":304===e?_="notmodified":(_=S.state,f=S.data,l=!(b=S.error))):(b=_,!e&&_||(_="error",e<0&&(e=0))),T.status=e,T.statusText=(t||_)+"",l?g.resolveWith(h,[f,_,T]):g.rejectWith(h,[T,_,b]),T.statusCode(y),y=void 0,d&&m.trigger(l?"ajaxSuccess":"ajaxError",[T,p,l?f:b]),v.fireWith(h,[T,_]),d&&(m.trigger("ajaxComplete",[T,p]),--R.active||R.event.trigger("ajaxStop")))}return T},getJSON:function(e,t,n){return R.get(e,t,n,"json")},getScript:function(e,t){return R.get(e,void 0,t,"script")}}),R.each(["get","post"],(function(e,t){R[t]=function(e,n,r,i){return v(n)&&(i=i||r,r=n,n=void 0),R.ajax(R.extend({url:e,type:t,dataType:i,data:n,success:r},R.isPlainObject(e)&&e))}})),R.ajaxPrefilter((function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")})),R._evalUrl=function(e,t,n){return R.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){R.globalEval(e,t,n)}})},R.fn.extend({wrapAll:function(e){var t;return this[0]&&(v(e)&&(e=e.call(this[0])),t=R(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map((function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e})).append(this)),this},wrapInner:function(e){return v(e)?this.each((function(t){R(this).wrapInner(e.call(this,t))})):this.each((function(){var t=R(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)}))},wrap:function(e){var t=v(e);return this.each((function(n){R(this).wrapAll(t?e.call(this,n):e)}))},unwrap:function(e){return this.parent(e).not("body").each((function(){R(this).replaceWith(this.childNodes)})),this}}),R.expr.pseudos.hidden=function(e){return!R.expr.pseudos.visible(e)},R.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},R.ajaxSettings.xhr=function(){try{return new n.XMLHttpRequest}catch(e){}};var Qt={0:200,1223:204},qt=R.ajaxSettings.xhr();g.cors=!!qt&&"withCredentials"in qt,g.ajax=qt=!!qt,R.ajaxTransport((function(e){var t,r;if(g.cors||qt&&!e.crossDomain)return{send:function(i,o){var a,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(a in e.xhrFields)s[a]=e.xhrFields[a];for(a in e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),i)s.setRequestHeader(a,i[a]);t=function(e){return function(){t&&(t=r=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,"abort"===e?s.abort():"error"===e?"number"!=typeof s.status?o(0,"error"):o(s.status,s.statusText):o(Qt[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=t(),r=s.onerror=s.ontimeout=t("error"),void 0!==s.onabort?s.onabort=r:s.onreadystatechange=function(){4===s.readyState&&n.setTimeout((function(){t&&r()}))},t=t("abort");try{s.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort:function(){t&&t()}}})),R.ajaxPrefilter((function(e){e.crossDomain&&(e.contents.script=!1)})),R.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return R.globalEval(e),e}}}),R.ajaxPrefilter("script",(function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")})),R.ajaxTransport("script",(function(e){var t,n;if(e.crossDomain||e.scriptAttrs)return{send:function(r,i){t=R("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),b.head.appendChild(t[0])},abort:function(){n&&n()}}}));var $t,en=[],tn=/(=)\?(?=&|$)|\?\?/;R.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=en.pop()||R.expando+"_"+At.guid++;return this[e]=!0,e}}),R.ajaxPrefilter("json jsonp",(function(e,t,r){var i,o,a,s=!1!==e.jsonp&&(tn.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&tn.test(e.data)&&"data");if(s||"jsonp"===e.dataTypes[0])return i=e.jsonpCallback=v(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(tn,"$1"+i):!1!==e.jsonp&&(e.url+=(xt.test(e.url)?"&":"?")+e.jsonp+"="+i),e.converters["script json"]=function(){return a||R.error(i+" was not called"),a[0]},e.dataTypes[0]="json",o=n[i],n[i]=function(){a=arguments},r.always((function(){void 0===o?R(n).removeProp(i):n[i]=o,e[i]&&(e.jsonpCallback=t.jsonpCallback,en.push(i)),a&&v(o)&&o(a[0]),a=o=void 0})),"script"})),g.createHTMLDocument=(($t=b.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===$t.childNodes.length),R.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(g.createHTMLDocument?((r=(t=b.implementation.createHTMLDocument("")).createElement("base")).href=b.location.href,t.head.appendChild(r)):t=b),o=!n&&[],(i=j.exec(e))?[t.createElement(i[1])]:(i=ke([e],t,o),o&&o.length&&R(o).remove(),R.merge([],i.childNodes)));var r,i,o},R.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return s>-1&&(r=Rt(e.slice(s)),e=e.slice(0,s)),v(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),a.length>0&&R.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done((function(e){o=arguments,a.html(r?R("<div>").append(R.parseHTML(e)).find(r):e)})).always(n&&function(e,t){a.each((function(){n.apply(this,o||[e.responseText,t,e])}))}),this},R.expr.pseudos.animated=function(e){return R.grep(R.timers,(function(t){return e===t.elem})).length},R.offset={setOffset:function(e,t,n){var r,i,o,a,s,c,u=R.css(e,"position"),d=R(e),l={};"static"===u&&(e.style.position="relative"),s=d.offset(),o=R.css(e,"top"),c=R.css(e,"left"),("absolute"===u||"fixed"===u)&&(o+c).indexOf("auto")>-1?(a=(r=d.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(c)||0),v(t)&&(t=t.call(e,n,R.extend({},s))),null!=t.top&&(l.top=t.top-s.top+a),null!=t.left&&(l.left=t.left-s.left+i),"using"in t?t.using.call(e,l):d.css(l)}},R.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each((function(t){R.offset.setOffset(this,e,t)}));var t,n,r=this[0];return r?r.getClientRects().length?(t=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===R.css(r,"position"))t=r.getBoundingClientRect();else{for(t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===R.css(e,"position");)e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=R(e).offset()).top+=R.css(e,"borderTopWidth",!0),i.left+=R.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-R.css(r,"marginTop",!0),left:t.left-i.left-R.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent;e&&"static"===R.css(e,"position");)e=e.offsetParent;return e||he}))}}),R.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(e,t){var n="pageYOffset"===t;R.fn[e]=function(r){return $(this,(function(e,r,i){var o;if(y(e)?o=e:9===e.nodeType&&(o=e.defaultView),void 0===i)return o?o[t]:e[r];o?o.scrollTo(n?o.pageXOffset:i,n?i:o.pageYOffset):e[r]=i}),e,r,arguments.length)}})),R.each(["top","left"],(function(e,t){R.cssHooks[t]=$e(g.pixelPosition,(function(e,n){if(n)return n=qe(e,t),Ye.test(n)?R(e).position()[t]+"px":n}))})),R.each({Height:"height",Width:"width"},(function(e,t){R.each({padding:"inner"+e,content:t,"":"outer"+e},(function(n,r){R.fn[r]=function(i,o){var a=arguments.length&&(n||"boolean"!=typeof i),s=n||(!0===i||!0===o?"margin":"border");return $(this,(function(t,n,i){var o;return y(t)?0===r.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===i?R.css(t,n,s):R.style(t,n,i,s)}),t,a?i:void 0,a)}}))})),R.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(e,t){R.fn[t]=function(e){return this.on(t,e)}})),R.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),R.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(e,t){R.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}));var nn=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;R.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),v(e))return r=s.call(arguments,2),(i=function(){return e.apply(t||this,r.concat(s.call(arguments)))}).guid=e.guid=e.guid||R.guid++,i},R.holdReady=function(e){e?R.readyWait++:R.ready(!0)},R.isArray=Array.isArray,R.parseJSON=JSON.parse,R.nodeName=w,R.isFunction=v,R.isWindow=y,R.camelCase=re,R.type=_,R.now=Date.now,R.isNumeric=function(e){var t=R.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},R.trim=function(e){return null==e?"":(e+"").replace(nn,"$1")},void 0===(r=function(){return R}.apply(t,[]))||(e.exports=r);var rn=n.jQuery,on=n.$;return R.noConflict=function(e){return n.$===R&&(n.$=on),e&&n.jQuery===R&&(n.jQuery=rn),R},void 0===i&&(n.jQuery=n.$=R),R}))},function(e,t,n){var r,i;
/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */!function(o){if(void 0===(i="function"==typeof(r=o)?r.call(t,n,t,e):r)||(e.exports=i),!0,e.exports=o(),!!0){var a=window.Cookies,s=window.Cookies=o();s.noConflict=function(){return window.Cookies=a,s}}}((function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(r){function i(){}function o(t,n,o){if("undefined"!=typeof document){"number"==typeof(o=e({path:"/"},i.defaults,o)).expires&&(o.expires=new Date(1*new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var a=JSON.stringify(n);/^[\{\[]/.test(a)&&(n=a)}catch(e){}n=r.write?r.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var c in o)o[c]&&(s+="; "+c,!0!==o[c]&&(s+="="+o[c].split(";")[0]));return document.cookie=t+"="+n+s}}function a(e,n){if("undefined"!=typeof document){for(var i={},o=document.cookie?document.cookie.split("; "):[],a=0;a<o.length;a++){var s=o[a].split("="),c=s.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var u=t(s[0]);if(c=(r.read||r)(c,u)||t(c),n)try{c=JSON.parse(c)}catch(e){}if(i[u]=c,e===u)break}catch(e){}}return e?i[e]:i}}return i.set=o,i.get=function(e){return a(e,!1)},i.getJSON=function(e){return a(e,!0)},i.remove=function(t,n){o(t,"",e(n,{expires:-1}))},i.defaults={},i.withConverter=n,i}((function(){}))}))},,,function(module,exports,__webpack_require__){var t;window,t=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=96)}([function(e,t,n){"use strict";n.r(t);var r,i=n(11),o=n.n(i),a=function(){var e=new Date;return e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()},s=n(14),c=n(2),u=n(1),d=n(48),l=n.n(d),f=n(49),p=n.n(f),h=new Array(32).fill(void 0);function m(e){return h[e]}h.push(void 0,null,!0,!1);var g=h.length;function v(e){var t=m(e);return function(e){e<36||(h[e]=g,g=e)}(e),t}var y=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});y.decode();var b=null;function S(){return null!==b&&b.buffer===r.memory.buffer||(b=new Uint8Array(r.memory.buffer)),b}function E(e,t){return y.decode(S().subarray(e,e+t))}function _(e){g===h.length&&h.push(h.length+1);var t=g;return g=h[t],h[t]=e,t}var T=0,R=new TextEncoder("utf-8"),I="function"==typeof R.encodeInto?function(e,t){return R.encodeInto(e,t)}:function(e,t){var n=R.encode(e);return t.set(n),{read:e.length,written:n.length}},w=null;function C(){return null!==w&&w.buffer===r.memory.buffer||(w=new Int32Array(r.memory.buffer)),w}var O,A=function(){function e(){l()(this,e)}return p()(e,[{key:"free",value:function(){var e=this.ptr;this.ptr=0,r.__wbg_signmanager_free(e)}},{key:"get_digest",value:function(e){return v(r.signmanager_get_digest(this.ptr,_(e)))}}],[{key:"__wrap",value:function(t){var n=Object.create(e.prototype);return n.ptr=t,n}},{key:"new",value:function(){var t=r.signmanager_new();return e.__wrap(t)}}]),e}(),x=!1,k=null,N=0,L="free",M=[],V=[],P=0;(k?Promise.resolve(k):new Promise((function(e){x||r||function e(){var t={wbg:{}};t.wbg.__wbindgen_object_drop_ref=function(e){v(e)},t.wbg.__wbindgen_string_new=function(e,t){return _(E(e,t))},t.wbg.__wbindgen_string_get=function(e,t){var n=m(t),i="string"==typeof n?n:void 0,o=null==i?0:function(e,t,n){if(void 0===n){var r=R.encode(e),i=t(r.length);return S().subarray(i,i+r.length).set(r),T=r.length,i}for(var o=e.length,a=(i=t(o),S()),s=0;s<o;s++){var c=e.charCodeAt(s);if(c>127)break;a[i+s]=c}if(s!==o){0!==s&&(e=e.slice(s)),i=n(i,o,o=s+3*e.length);var u=S().subarray(i+s,i+o);s+=I(e,u).written}return T=s,i}(i,r.__wbindgen_malloc,r.__wbindgen_realloc),a=T;C()[e/4+1]=a,C()[e/4+0]=o},t.wbg.__wbindgen_throw=function(e,t){throw new Error(E(e,t))};for(var n=Uint8Array.from(atob("55ZBgM/2Bzm2JGhNn//ljJsSorhWUYE66a1Hf8O7pfQGR2zfol8qRP6CDhsi3iG7nFZu9stSyPq/qu2Rr2w8QkTGP6Gm2cg3J5qsQgq5bcHA9mDpGv/b24uEwsixZVl1eGkdV4SB/6ayw2v48hLmNA+w5UlnTCiWwerzESQPidpSUMbamXL3pU815EQm12GhhZ9aWzo568gdZvXevBc/WHfFKQSuTgWva4e4eSmW7UxpH8sY4HlDsCTMu0WwEB8B95XsZwOp3GLgfOQmJBw036DgIKU+XGn4KpIEq77WE/h6R7sZKsFUp+u+2cDnW7IPNe7xfd9areFo0EUh0/9K9CqxUkLqMB5hlgS1fwQHRzKPhQ7gALyc6HwMCPooS0M1NrzjdfH3vUn0PeQ1GBlnrnXgiu8TunfHg5TcbBfPEbxbyiiow1Np+VEBlHNh00PiAWyu024NHaPbDGfMtzu4WF02fgkh8Pxb7bCSpCZndjTytQgAzfZxk2bbe6NoHHFnsviqYzHVpxoPEk7icHRWcZC28d2muthq673KCMQay1fJcPqSTuYhWUZS5eylIguT33lP+TBbOWQI8KtCzBN5FzqILfKzRkzrJ3L192BUF8SILdwmriv10HU9ZlQAyQA1VdegnzOl/dYk2GGsB3724y7w/7aJLHJzEfwrfIzFd5CoAft7ct+zQW2G4Wm2kpoz6uJfgrNyykQgwCO6pkPy1ADrBUuJon9ySjhgcFru6AKa99wTlIhzBw3FKFt9Aa1/1KWWy7W1wAIGzRTs/7rLXRkKFjNqGVXBdoVNTpHFtfEFsuX0X98ISr0Bennlx0h2Yl/CGNb5Kc7i3bio1XJHX24avcMsEAwfdfskCki4/dkStn7QC97YJC3z+7gD84IiEEeGcnn7gHJyeALr0ssbqDUcKqxEyheyFs9FToJziLB+eYw6nMQLmYTrQyrg3b+3YBdgx7pzNEDSyz3tmaPaikwcLSyB/Igo6U/oP/fS2TZLtmN03m4iS76YrDJAgI+2W1GboabuixVcLdxm6SQ4CzUnHSPl1knhcGhW/+OcKa53tB5j5C4wEpiENv6T9PUu4K0YwtEAqFbd/eN2wVAYCKn/nlVA8uiESxCfgs0411mRFk4i1pixJLPP5AFPG9QFZnj6X19TqmhmIhl8D6Q1rOvPCqPZV/z04HjayX4qPzPzP/5NVilN/sHhQe7ulriGmU/3rj5QEuiOymsL7EdCQMc/4mXDPdVrDBfbt6dnv11oLYGmqOP1oSBj02FtsmYrMn9pRg7HJoCh86jAnzuOYn4tGnQ4gw/89sb64NAXcoIbTIjyiHBAQCCK2Yn4I/fNF10rkQlvSvkpqLG2eYpJmpWrcouNDEUtJFR607oNraLdmUKyLc1g7SNpS+ofp1FL6rua/HFSrb5kTF2Vcy2gl+6MACbFRChKoP/un7IbYJuOima/JWFZcs/MXokIx+ijuqjMtVKaYRTzNI5ncPa2y/EXTNdUUFpMhbE7sa39Uoh6Hci/viXy2KFTNbiw+BkWOPnyOr04LjIYKlJ8ud/KvjuvNUGQOHJvj6tpZJxj97tr0OrgZCAxSHGU5JQfqEd/U0QfzGM8Wh3zdsnd9LhoIIRJAtyA2PmjwJk4zTxeYlgwPqAVTU3+9bA1QD+jLZZ3Ffk3MRq+Ar2RT8YN6ASR4bItt3omBj0LJe0zeGY3OzfhljL6LA1m4+IUp+CzeWo0aEjnvRk3iCJeajgdC+NUGB5qh8PWKtBeC58woavnRjvRNphXS4b9M7Aymcfq26B2YY2lS+wLf763OnGJlVdV/srgyAUJJZjarxom4zrYy23kLFB8zFzWuwSMue5Xm1YWape91JGDuRLIctrJWU47/XfLm6Zgei4xOwq1RcjikGuaZtDwcFg9aKtO+JOGJsCjy9AiPnmt+rmdX83GsT3KtTETnLv6ZQcnGtmt4H8AjFgGYePdQc40cj8VAOV8NCLspyW5w63b3g37GXJrzjm9Fym3fh27psjo5RuTs7XCSrNENxKm9jCcXPqWxyuXJSn6dhdWnw5SAnUjixXviWS4HsnYjw4Xt4cSwkqCB9naLstVXt5D2HgG4fzHFNHvnETft0mrhU81IBDTSyNFdDvFEX8cifoc6FcNq7pzXlotl2ZS1FIzNXddZrdXpBNYZPV52gtCok6ePpUR/Y8jyJpE9P3q8dmFVivVGgmKTcBKMDDbzeOfl4MpOGBtBX/Lab/kzqG42sTyOyGUyOoFXYGMUWJ33GPI2KNa/mW8zVl+imshfbj7PiK1qRUn74KjAkH4wjKnu50AONYUaiveSdwnEc1zCjZSJ3dmBKSxhWAcO2PdHBg5m9+JCiPGCVfK9dzoM8Bm7xx9noJiqt4hNiVa5di1Fd1JRN4rnd1DbKglKpAVSoqvJPxmuyH56TFE4BQjhfKbDMZezQJqx+KXDiW1JWGeDYaPVBWPYeZX6STIzC/DjS7UFlqoKgGGAGP17x8wmMRE6O/axG5jDzloCGxCmrymT0ZGCh4g54O1iDYUtmJr7Bo1d+H9RQj2Y10BxcMkLFTIZVjm9e3vtIbeRx0OdXE1Ou37J/WeJZyPXn1fszvp/KonCqVnt862LrxfoB/0sF5gk4Y/f6LVneU5hun9/V1OVre9XrnDBhcVaQa9Ye6gs8sHW9HCNchaFbkUpxSiyxVEFZIlbejbjSPFlkYOLhtQHduwZWRHWA9akqykJNG3PKvOZAaJG5nWQq8+e4K0JF/AXTKIIr4J7zDt8ZR4xb9T2gxjl1nfqzidMRIY5B4rkw0oetta+j8rqkFpTEGA+hU/tw7bDtpkPYvCguwncnCjwULNFT9I9jXx3H4Ws3WWMCit29F7kGq2Ka+rU/MjnuP0lsXkoB1rr8LawHH5gaf8rajq/BhKrGTIfjDiZG5qz+L7SZBZsMSZZ9pM1QhKju+GTD9iC+9HlhfXMtj94gz8U4h7eGXziEO7lo7LwLL6/DVMrGbkv68JYUYhGz2yBm/8cbQEh5vhakbhmpv1K6XYM9rzdsd9bwYcYt3cfKE3m+/NrUa42+RpJBdFg7cAmxsZ7/0TMyVw6Aqu2gzldb2ag4iLrPNEyW1ywaJ2DXMgPi/sjnDzhuo+vIUrc86j4ZLhT4GAN6uqwbnXq5UDzX7TfuB48oMvvE1sK5q6owkdWfklgnC6pSBpK7wl+e3kuvaYnGRGJJMBQuVgWL1awHrVtfOTsSE1vc0ZdG+a/Jbza6pHbyfi5L7FXJAGdQTk0EP3VT54+F7RZ/MJ9fj56aMxzhJRwQJ6df3cM26qSc5bW/zP3PFXypTOBwzCvVtwGQzkGvDW7XGwgLbTNHDpQXOd2BQ5Zd9bjQqGg+S+kIqWZVZCqVLfyFPF9bEOHfPepL6nRDJUD2l5uRnXqeTvidaSIoqS1Fbc6mLPtYnbp6uuts6Qo8TbMzFuI7NuaPuKnQIyVu7vUGJ8jg1uVOjlMNKdVtLPr9/ZEKVZVj7lsFA+nm3zRjjr1DRKhr/wY1CI1iXKVTeQZ0i2PSnN99j4iVTSwNAYQLWWD+KyZ/xRLVxmZQPuSkLeKBRAkavxjWnIFQb1dn72wMSUdcB9cNCNJNdyTkrl44MRR+pUuiVrTAnTlzL33X32eEYwT+vn564yxFJLUDyIMNjJ0nx+GreKSOglI2et0kAwRHKYFclH9GVTiVlB0TWeUJGD+7JYogF7BizjTGyPOUEWQCguIEmtC4fHD5461T80Z3Mp7rhNTI+Cswuknr9hrIZmpRyFSrSrP8R4S1Cf34Tu4RNrDxpofVK9nGTklZPsYM6eiP29Lx264fsX9oLdYhq7vCwcrRMJ1a5d0QHXUYRV5IqTFBoUSpxkQ6IHHL8ckM4NCzwk8K0CA3pj5Jp2a9wZjfKq7R/eukzQFuhMxV2qgHf2E3t7/SA8N7sMvsmF0p3J96QRE3rA85ekH1q8nrBVujlIqahmL0Qto3+JxdqAfnKMCblQGSKVWZgWLMm82MG/9pjhdkMzG7C2GRLGMty2y8NhX1pZWHNbLOmvaC424LNz/Nl5tkPv7fVbCT2ItB+/dx3ZhVhmgSLd1zL+2PsNFmj7VGBruTttezlo1mDKErjY27nTswjf2fY/Uq8lPcVAgRpJM+m7jS/8dk8cdl7fkY7Tuj4TfiSe0tiNSoJgZwom4+9haoBQ65AifaB7pUiTc0MAXCvG+nDydkRIbKx5fL6gAlyMAnBbQf+Qh1naLfzzwLVTP0EEyoenW2W1zKqfMql5rwGlyCB9mSa2s25yHf4SDSBlgEVMJtplpRgegZvDakpWDKgx3UR4W7yKW+RD7bd7rEa/GQmA/q0RYAOIaXfO/2CgEUPtNhPS2uqy29lBYFPPv5SHQ0t/jRxQLBpe09ateAWKypt9TWS7Z5gynOePS5M2NC16AhF0Xz6s7DUjtI0xNho9Y6GK16J5V8HqHypV/OAz7+VBzTaiR57XGH4r62GoAiJqfWOM7okzKCeeSBnOIKPHtwgM0SQbvCvv7rmS6ZAacu4BbXZ5R9gOhdR9H3bi7lWLBNnqqLPIy0k6m4XBhtl40B6z/5AcJxjtKfwvIExl7VsQRqbW8gpPMsmJZfSp3uC35g1AkP+BJlju3RVoFZNo3JR18A5uc60NGD4zvzIdGTAOth4ZAZx0ZGQItHuNcLz/0CiavJdkjD65h4avf1vf7LFZ1uogJz6vLK3uDisXIBIGkXOlIpxTdjjjTQt6Khy50bYbXsG9JBrSUGhsBWpeRUnq2cZWOifhfueY95gFIDAu37oKR3FQ1YxGMg3UMq+L2VN2rtqodelSHof8SyYZVQWs7L0bjtgolId1tAAjHI7J1/+JIRXeUBjjaGGQAU+az9XFfiqn+VRAGG8JDdP/WmEqjhYpcy00LIBIBzCF9I9mbXCv8IX9fhPlI5NqWGO/v0ikpfn+hb5U16FcPYsx+xLb4la6nSbvrTDP5MthPyeLIIY7ZE/rNU4ajgPmI0/3RvD7WtEbo8UGPjnev55N2ELuFpEPzkNu9MzXqq8K0cWxk4lT2DQPi3rDO8x8i5jX7wWQi8e0neCMb0SUO67zRfaekZONGfaFl47LByciUuy5dhqxMPokhTE2WbzxqCyt/s2TqG66R0ocYHmzv9f7tJ+TES8NFyzL3fhNoZoW5IxWNE+stYWutd3LPwa7HKhhRAbl5uCEbEGjrUzTXwbzG0qvpmNtpnYnmKjzTaSAFNCxfw9edcjaxCiRKKIDd6GS/eDsGBgTvJexDfwGmVWm9jadZhee9jRFiZFtL6m7sY1oQa8F9ycxSuPANXCqWkApcaEfQLkt1yyfeRs5yC5O/6XGJ4TEtJmCTPJFRr95au20STIPgkoEF1mzZ+5ZRtWKUYuWJVZDwcA/lTy6oYp0/d0LGPRUXnXRm0qtIXQVdnoVhKZPeWACt9rujRL57MEDi2kHtfV/ucu+k03bN0fQlbalUJ0faY99GC6L8MO8MXTSmqDAxNSpqpIFPhgHgAg0YK/GZhlQjbQXE4tMDEDO9obNfp4W6m8fdznMesSSRINBG5FDf//DkT9pSRQsIdSg4VK7W7j2d2jsQUIyjJmbd/2zCTaqh0Yq0cH6mS/5g/cq3eGOiJbaCNo6oVwGURzXVAeVaGIfJFhd2A59sVp+rVfe1f8B6bVbCLIKgGUgpUokO0vTg6ouAxXGQKtveMhhBT83ukPIRZ02+qF1kvM+nNCVy8uzrB0+W9QIKbMio2m/7zW78xd5Tf9itocpLbRuNC5cuS/GyRGXw6fzFzjM1UITlQ5dlvoyYxuvb7ol4S1MyhkfMNZbif6/xic0wB3uSScez3oFTRbCHBd0cbJL3cLwfQjCBpGBrRVC7174qW4XWnw0eYGSSzTVSEDOlMaTUIGJO+s7/z8JxaZprcEsoB4+vt9/+uwtM/iyqLVPidu8ZTh+F1rsEWKwZhDAg/giVc6VzRq+DJCrhn81b/LYlLJOdgoAjID2VnwgU+mQhCL6KhgIqqiVraD25UIYEqxMcZ1aRcZvHa8x5gh5onPtsVcl53Xek9BOYqkyj64acX921zwqoY0lmNA81NE7BzVts3cwWDZ4Dk6uuzwtfJuJc7vVS+fdVDEg3ATwC9oG5/Vb1swTyzTsl2V4m+93bSQo5STFG5AruTDWTym6Lxtt4OrAeIVgdoyTJL+keHiHTNiL0/nO5oYwftSQK1aYBuA0e12t/FVN+LsCk0L/hfCCcke89LuP4d46qnFo3NLpHb+NFrvekXVT4GiZgMW2H0orIY0TpS15wlxVUaGCUo7YSN0yWDRU5+p41dCOs5/vXq1do7K+Byjj35/mPlQ+VEDqqF7OIBQrXfHgCXYPy8ye3Ih3io+tYA6nK0/2clIERrpA0AMHKLTGEO7q/IzIcOCwYN9W/ISH4v4uk9MhzNu7Fg2IPCq5CQF1GLuzQu+wNv2h94NIA2UJydawv5X2bHkZjv+kB/WQCYjxUNEU8ssUdxDZstpv2qNAHmI6BMD84olxMiwFdK5J80zc9x7de/cz3ZNIkkGIpMCZJqKKkaLVo1MLnR/h/hQeUvfqJmvkPeIre3EjnliNkKJKL0KNaupHzY7Eoztaj0cNOhJ5dxIRB2is3kLcSK1FZswRJR0B5OXX+Q4UlFIrhR10lIge3Fg5DnaGoZoOyFaaHztrdF251JubDsCZRDSWA0y6ysykO+h4jhXtuWF7D5Wp7B4Hx3EQvKsmPPZYcLevowjlWghHbRBEhwPI3bzjhNWXlqtym5ObYAeYxuHyvyYue2X4651f7Om3+m8KT7Y/JqLWXwgayCdzxHuJidti1ITuf/oXzeCfTRbG5ytXlDk/epX061W6BO074jI7nV518OkYtRJDnPqdDFAf0uWcATfk0h17+gP7GHjy0Rc0Ive9XmvA6gCkoMjNjMEA7GQ3xy7e12DzfNpIfND7GKKojMifTrvkDXrfa3o4wNYktY6/VlBdHtrcH9F7uMWICej/BjZXVX83WFGcVHx3nOXxSL59kE9bSmHc3Xp8iDbPuSG5GIRp3fTFHnmTzzGedl6al2gUbGFKtkC0jFNtKTk2rr8LEObiGgfCoSpTWknvAYDQBoj93s0KiRNPOqgY++Xka2cQiDwqUsLl8/i57YC/V6sy5/NvhViRRZgCzcyjNHGzZsYA5YMtUntyfC1gNFP7cL3AwVA+326NJI7MQJoxTqcHL/YhntsnYTR5R6GVVvFYIlW8Nv9qn3daoGXMz0MoAsXpCzbiHZ0XWkfw2qlJkmZjgQtMAEhHXNgokGRPfOprmtlvNZaNlGB1EjQTVX1Y4tCyJFZhdhID4CowB23uQF16NifyxH+DGnQrnxeklnG7UQV2BRVdr6ZEKZYv7Gj+PbpojzAskvbdtaFsataqPrLDoejjc6ZfPA5zA0iYcCvcNjzuy9SuT0uG8NWMTLv2OsImL++PQV1sifUENAwi4O3yBvzTy4J77B7mMBpjCYGXAyjFGFZL4eAazSmvZ8thJ0FFW+keLHL+ft1dQBKmXY6JatelGebcIC/PyLBHdfX9bRcauGg4xEO7mMl8AjlcPMczkPniNQpiQFqcDJYrFGoxMV2hskxMn0bRQT8Ajc6w6sQYkGl0CQUImPrGfie9dsk4mrCLMIFOqcm0WT8O8AiREEGmooBTO7WI0qk506NsV7ffvc0rVJERJKcyRyCmFZdTSn/SrBfjV7SXT3pQlgluoY4FBUCDDkzwBgjkrE1oFUA3ls+xVP10w5jjBIMwKBSQqRVAEDXw+Dyj+jH3ila8czULWsCKhWd4qGsMFN7++OGBAz9eXHjAO9m++mTXF6qiyG35Q+61yjYQKsBrjR4NNexrwVGqBwAZA6cr5mp8AhoyzPomJ6TLfWEJjEeRI3QsX5oQkNuyF7u650QFka+VjFeNRY6ALklleTW9I0v4ABKDCXTGkjv80vqVNk+FTL0bJK7ndSjjMJD7OBFIEywBPJFrxTdyzocmxEgG0zu1VDgsQuXITYCx1RRty89A/F+CdSAlbMlIkptCC0GrF/jFS8PAU+6TNV1eBqJrCr9BgH1mth8FtdfE7druR+xyZKn5idfUKzGW6ACGF4M61IRoSs9o6xmaj3dnAVQvFWUsMcR6MI3xTKJNyMxkhXhhvT0IxialnG7i/BBzXfMXYh5jl4BXzCSNlxU4+aboEgIDr48/+pfj8J3WcNccFfzV6eiX05qkNktmafoBcxrEsrM8WQV0VVSRybQyXPOqJ1yndwBI6BOGO9oGxGDAd+HcKaZlptCMJsR1Cp3m7F9HpBFSu/NYVj+WSDY7jWSFBlTBSCFyyPEUn8S9NmBVa+mwGVsz0Q+fxe23w1w6wVO7sVnZqRpmXJeXg72QFkl7Qda1lBzn/FW+rRwLvFxCsuad67Wmzab1RJdzPGsuq8AzW6tL+JiwW/VPUSBbBmV1+EjqQ28x1u9W5Eoy7zhsU8NT87CtNbZ0lPEpsoWMewxC80kPanfWPrQXmixWDXXz7uf1kBTr1J/iYuls7fUsyAChXjKcKOaCF4ySqkhMTGmjNqYiG5joBUi/SZpWvgxk28pyIPhf28YULINiqmbWPBKuTCLFruV7JfRgGM87XfNEFc7tgnYx503k/0UXJfpmjx6wKbKcvV5fqrctx+OrIn++TxRxSKlTScEIwd2vG5mg/p5wsQDpiD+X91XbkReKLB25Jvp/IJaJh715RXqBzwCwlY3URonyy+oZoTD8Ym8XMMv/dMllh0LCFZkZFn2gYcLG9iO+I5S/GyxwjajQLQtwH7o+n50vimC+ES8ePOpPDwlu4oG8KhS7NL/OTdIWPIHbSa6/9DfjOq9W66EpaK57R78PpEzVNLkTP2L6lllqDT6SDhIDIvQS3SQbxG96khXgvW/rME+tiXFXi+BC0udi9keyGlc3sLBN3CP3QXzswhBGTxvz2LmRMkU3rLuSkYR1Gzr7vj1VxTN1y1iciA0DswsPZ38eB6X10Uzk6HZqjzBK+EJ5osJJJ/s3b0MFRIWYlM15TPm1uzeOk1zQ96quClQLEZbpxmV/eAduIotXUYQZjWAkTulBJt7kw9uEnLo7OpZrf8k+0ZQP0agcOTLbfrekHji86Mxr7rTwve82mePKoAkkEthE45VI+f1VqpyWNW1kbBbVVfuatKt6MEKqyTUyxSFGHk81kY7CxkgMNexiikN0+IeiUNsfuktjfOAiMfDhbTe4rtxSEPvO4CCUGaktA58TGnSO8rHdCicmGkNrwWsnXgUWjhp8bllNcnQN10TbwxYPAwQKW/JJiYQadr4THXO+vWudiq3I47vqmEM/Ab3Dlq11Q7RmRWntYOEyESbTI8PZYwbtsmjcSwBtTAIHQ5h3I633h3FpOkT2c0PlMjzj0Q/OuqaTVt639fowVppqvSlNcK5KupBnrxfKHQK+SoKSuaO8PNMkYkbcEAc9F0I4uzPfRVP/q5QkvJVsVoJ8BEWW/q1+kivHEMQfb+J2NfJjSTG+WhjHjL8eqi7FgfVewxwmqG9IOnTkwDjAHUaJMIyhVkadW/+GQjLyNP4zyHcLAdWcB5zQ2kc/blAx2RKfG+ON3RfC+iQ5Th7V2i5abkoy0pjfyOwTjIvaq9slSCtoNGBZggBDOiWwau0CX4NAIThFyqu9VWCLr8TsqhQZvQP+xrywovGs6A079U7YBjhEXyQw4Q3rbQY1EQnxTPXNlHfn9vQnuhsJnzx6PZrCqry8fidPz2U1scmAMVPHxa/injIf+hDziEU02xWm9ou67OgebktON9V6wwVotoNOzVNJhiDBlHbktBwOjX1BlJHybLox5y/7NhR7uc8f85O6xdxueabhwtJjYcBzac56v6RbuI9IRvPzOnNbltj8Hh0ftwwhWyHAyiEat0oDSEVZ925jmxJKAqTo4/uHnkozgMDsnkzXPXBDJ1sDTawXy23mXuTJOYV6ZVWrervMaGGGQpgQjAnfP7KPZro+OKt/MpnoM0NeGQgIFAiH7dU7Nl1QbcMiwO6/5nIosJtrFB8w1kpqb6OjI9BgZHG1nzTMGA++HNrl4WQNcq3SajD4C9utQYAu/fETPFMMJeCDwHRCnPuRAlqJ5t0E5h3Wlh1Nw57LQ36kDjC3lS9w0a89eI8ym6BzEA25Cdz3LQAyz94Fvjqp7MyHrpm3PzmsV/tbSLF9NJBjFmzWPQ8Tfgvj3fi8dg78tXvEatqtUhLxsNp2VCU6IzSqafxWw93+Wk47skJv5qxM+tv7CrpYKvWLEylJNEXlh7GHm9UenNf2/szZOl+54P4ZWksh1r6+rphL68QYhmqW7DqKVrc2rjzPYcvFDmKtCGL/F62i3riMV9z+LoLnuVaMn4dtpNNFmQEQ4uEhDfLYU4x8G2OHCz7gnxLCa4zE4CFo9m/+ECmdzziVumHM/P00/BESH2rxUYMBL8/9NRG5fiskFJr4AO0qNUKUCgTRgEiFsTbGXtP4DTTzc8ZAmfNJuJQE5Kp7W7U7QZnBXKepfSHkYTEqgOhqo95Jw9i56kYGt4BWwX50mC27CCW92SVMl4tbUEhBDSB36zgztz5Zts0563Kjc34B+6ZUnMIk+BiQNvqSkZHnk3rHNSaYthO72IWLIxij0hcv7n228yc82FsQLK9jmptjY6estDfH3OSMaAj+poCLKwRFXvXWb6jwM9mG4nu1yug0Cc4L89w4EYek6dnV17VBfIxB2dmFFQdp0kqx3BM9gdMAr0KS7WLOSf3cn5eDItDLP2UW7MWaIR+GJ0EGcEL3ejBdu0to6vDh04JcRMNU55usmSn3jp74myzWE3azMIT96wr39F62c3G/ldGskbqTIMTk3gMg61vNBQ0cJSIxVdcgNb3xFDowwVyIqYz54F8Rqg0uQE4FIiUGZxJhND/AWhkukqIqLLZEpxj07kPBN6Zb2pWht/X5JrC8yJzPlvFhfJndQ4jcgjFyhvymr/a17uxTKHpKNWDEoL4nNa9/Prf7TYRw6Gyo6vcwYcUHk17SMb9aEdVnx24msNCDEKbj0OVzRaA3gFJeXZPObqJKvWqFlavGpxXnP+4ZYTl0Dmcri6vMdwX687ApG+ygiGHZDwNzU68F4JMPQ9JB45vLkCsE2w50QNP1kJZlI56dVGzfK1MyRqP4J6VshesfOT4hzR6MYq373IoONlLvENdYXN6pTxo5eRzQkwk2tZ1zmZqczCytqTEhpweKcBCCZ/FhizgLm8/x5ScBlO0wEXHZm90mpmL1gR/J2CUnz3wDU99YFFKqm01AZ8q2S5Fnh81CbD687c7K2OjWlZgdvEJA9M0JT3eKdIRd9GCx6g1TO5PWTE8OOphUDKdazyYnmMqFhFxfJ//cWJTsgYbol2a7Ob/Q69Fy3kb9K7aZLzH+Kl/uCzWnqTOrQonVL7LTFPr7wbTaepfAl5zSgMInjrGXY+Gspw+fCNgEU1zyC0Suum6VFyHBjdKWft7strrOXqOSQwxsYXp4F013mN9gZyu4Hc84A4dzIHN5UNXmxNn+vPjS82JM6klySWB9pLCzLBUgXiMDllaG6fT2PSBv/b+yaruyWBVcpsOKuEaQ37W3A3t9YFRcgB5rFMDjwOn3c0lfsg+5V+dBX2EmWLTSelNZkeq67CFnxaKtnlsAJRPBqYvoWVZcJKn0zSelrO2TwnailO7zgAHaMRmQYbXo9beBs16JWf7V8LjYGS/DYUKTTE1zKECC/pK1EKf6mxIgmV+mJ+Mc8h04qep+okIIEXaN351J3N0VUk7cEEaOLE1rFF3W4vqRcodPfbLqINF6QtTsfny1+O46J5ahlamZEyxglZtpjEkKd9yKDsgwnzqoAPN5o76IsI+FRaBc8u1qLBWxpKU615chTVegNFR5V4o1T2JGwVkueD6CjAhOplPnRyv8sauMnMy2wEMARR6AmCQ8S5ebL0nCEqjSztMoUyAEjQ6FDYqkGweu48DkBR5HjwlBloKVawYcDezxKBH8WWnMpJKZj1Ol+OHMmg5iq9xDswLx0iTNkujgatOkeRU0c/GmSSH+7GTTMLQJdj51l3EkojjEwWOjw8XBOm88GqC4bWPEE+U/5XYtZNJG/X4FYjgIvVd69RYVbMEMfPSKJ825e3XQ6RBesp/G+lkMk4VIxRakyUBPLO1u0UYnNG9ExAnPdOO0OfFvcPOL9rBJO8bR+q9Lp9/i+fH32KkaNR2WgoxQY3FY+rS2NUvtCOgZAaF9vny16WG/3zeUtRP9V28PcGivAHAwwCcRk0D0iohjAfgL/EKXJkr8gIFqbNq7lXUFRKqMbpBa182ol77SqJq1M5setGUJuSBKqYBYKdDZv3XdT/u6J5aKKkLvA5ez6PuWX0RT7kELSKDKfg9w9nwSmMmJHjbnr0blM2WvpiirR/nLid6SRN9+5KoLUb+pLw3QzD8JlS3X2q0m4BNRxfltr5KWqryOuuGDt6IOHSE8/zqGXMiTqgrUOfDH58NoWe0te4mFc1GxswvhZXWJZmaWaMJo2SBnuXa7+jIfFbnhNH74Z6jygwcqXsldYfI/Zh8BZbqTh2I7Hu44dilfbX8Uh18NVB3phRnTwpUonKquUs/iZXRnDFjtEmKg2YRQm2CP1FWRb/B92HqJlHT7Hs/Tpl3RrlxvkoskpNlW53/6Ujse0fkHLNeUm97TlDsaRXpfZkR1uWMTwhPv4oYM2Bv941R+c7nQ0yBdFNVQpZRkpejmIfjFrdQUA7DPwR69aq6Pzmk3IXarIMKG6R4MBdkB3j3HWxohnZLWpaNy/BMxS+84e4vPPfO/7+nLWVZsdpUY/nGDkQts0NGnRpZK/lW60tmncMoTepY5fMbow1GyKhqSXLbOZkz59l8DG9v9ZHPwA1roKz3MW/j2tN/U+lPQVYXTa6h1ePQkSWR2bp9OHmCCvT6s8v9PVG2ufK7dkbpY500gNx7fdArzH3yCjY33Fa5TbOuybLNdW8juJyJtikDn+5jMnMzIWP/+v12XkaXj195xk6eOKuvA5zeKk1i1PrSnmWA46Ca2ldgNqJ0rvLqM9X2EPn/QuMjLnLg0iVJ4H4r5S2PgpGdSdfVoiX/rBAq6yVDc30v8DOUae4oquSM0YDCIafLQ+hvEmB5b/f+QsTFtAR0zIVWeLyYbmrx3g9gHhVRfelCz9/exh19AGsyXcwuSaBiCzQIoctYvyhhkdCsC/cdZDce/1Fav35JQt+RJFAjiMRQhCdE4eS3SmfsREHe9LZa0ElOLhxxvs5uS/SnMYssyK9FxiucRjjOqfaIp2N8CmuNJqg3WvtMk+MlbAYeji9K94rx6U7nj9L1TGhVcAyz+Gb4sib21AW94HRzWbTrRKEkx5+KLE69Vc+8Cj1Vu2GkZ1AA2E4kaJ2aTjsEL2C0srAINXRAjnxwI3p5ED0NRYn9sT1iY9GPBJwhhd6WXEJ/Z44D0rufaDOA8dUj1SIqywRs2b7SjYcCYS8eefkwdWlpN0DvnecdwHVc3TqyCcUy7K2PMS2l2KZHzZfLCTCPaPq/NVc/Nlc5hVJoFvnNUpKWZcTsxVeHfH1mnELREECq9YES9v6FcvONCxXLQmf0k3S2dyNmsxbvlXM0u7lSqkx81md0rad3E33PPuPpDGM9UiBhSeJn3Sejmx+LdLCiZYcVxow59nCqrUmXGAbsR4O7wVQzyHdL6DX5s8k5BjHXlONz0PaIqS89xMhkYetMw6w7JZ5c/oJBH2jdZPbS6KbR0RpEe16BATLzU4QiHybxArrjBM8MKKP8Zz6MVbg/d8yb76U8nQzCK4Eqa5ombBm7/6xo2dR9O/ByfcU6qDu+efdLFAP4LiCr6C3aihDPjigUYuy0voLuX3Flevl7xXRtRZ4Vc48j2tgA7tK0wqv4OjLwCzZJn9lYIQuScQBEFMBjA6Vj8FTp4h3OphB6g0uA13nTnVLmKQ+zfELl+6znWX5nCWvbwak0t3q4qwWK3MAPKE2vqDEeCsFKvmJ2Ws+VOqnrA+ekCk9jaszBsZd71InADWijT4SHnyVmc55dv5ivXl1fED4vwNrxbiZHWeGinS3ImcoDAT1vGiLpP/D3NaiIPq9A2h5DT5SgaCVCh0JKu7DKsHjW9ZAACRxHgTSo5jrVWUJfGKweg2auQuittVidB+JaCdwYd0x9oJ4jyI5UygrB9Nzi2gbLVcCnpu+1ytsiWCbJb1Xxas8FhG/EX86taG6flZZauhaGnpRyfBB5ojGdsdPBVHEtb8R951oaNTvKXK7CddSeWaeOi2FIDPEhWhAk19RzuR9wSKEwvvi8nQFz649+fUlBMuDL7VmUBSsC1ExWwqY+uSdNKowEkpsBb+/KpWl6oGxymyR/e4uKjipBJrVPXg0nE2j6HL2JbCHNh01lV+/+6FUglhV8GTypzdvdfhYc7t0ZYtkyH/17wDakU7r1GAdUIXXmtxamhK2FdelBa4BPryblCC9gJG9htJue9LMrNS7mM6gbRA1xSFnWNsziDuGZeS3Dcu4bjsWaIebrgNnxpl/pLGxV5EtkFwDeh8fPyfPU8CZAM/Ljk3+Vi7jUtNZmZM8+f7d4wlUIkTHiAULRUKu0ODFIeyk20BiqLB7vvAT342SIDP+z5FPaa6Tjyqh/AsX2jFhbeIXKxDMb8fid0jHAWk6JKhswbtvtP6bDz+lYjvXIPwV1Y+nyft2uM8c1aUxmDHAUmZnJBvZXT43mxjXDHP05R1/dKfoExcgcYzv3wO5mazi7ugS01z6oUmByKtfQ6fA2+MQynPCoDHcp1eDtag/E3HQpHMWAgGkNh9wWR5Y48YG0W4CgvOrngI111j/x+MIuH5xFlVkxqptSjW+hnVbt9qxtXndEH5RtnxWfd9eP+kli/x3LU1WGsZVAkVElXD274LBGK0bMveEUbj/6EpnocEnvRSlglpE4GiAO5S4JdYb4uYd6oeK8vuZvTQaWMS3dEIJ2ssCxWz8DqYmc/b38ynz0DWCCeF1gCyipaLG2Kq9wqfHz3S6m7CS+H42nmDYAz2dYcx77M8purGOS5tQ4aykJXIDQBwHjIGSU+52M+1OV53rp4B3JbIXecQWEjfk9gkVoz8T6HJbIhFgm3quNMk+cIyRHlj/BdURXY8o7H7dBQfsdpLJhAsxS/1JtMkY8JoP4YdyOxzJY5x/+A9scOTXvPVoQAMqgmP899s6GvRtzNFGXLX7VHSnUj7VPO8K1qxaS/a/6v/YhRlUtNgnqnth3Jo/DKbdhdPn6HgB9YjU5GuN1uPyUXZJDZYfFwMfdqNPVoI8d1csoHMK5tquGoK060mIwBHMk3pFGqBosajr9g/5kBPrrtuIIEPFZnaAKSCQqLdeQq2B6Bs8WxD8+DfzGJ2nu0Xeb58spPoiHZAVV+I5lRUseUE0IA4E844UzFYADNYcLBW3zsP7aWzLnUZoQPuIDR3FX3bkM5mCunvXaPSi4PRkKnItEv8/OYiq8RSKQcaTwxX9YgdNbgPuXLwb5ARofv0Zj3WpHhNnlTq2Qu/lwvM3PUaqv8L7kpFqQR9aRaXfFanbLgbyxJ2kAx9oA1kRMyH3JXI06oQhRiZQ1LtWz+QKKxme0zAgI2q6/dmYApsA7WGeBae5+Y3eqkqDjXyS7Q+LzYgrM3EiqGHsibaKZKgFecxpGiMLXY5+kkuDKBdMkj2Bd8uTKI+aTWpu97gNp78fm891zYuT68sIEzE5JggpWjlWFSpzYayxvnOxJ3JYK/q8WbCy14KhtCFhdLOxCEAvyqXN3K+oP52ZzdxHiCAac5LX2TO5CTmkxp6zCT5JZDIBgnnmQU8GBowEvogfPni17fE1sljd55P2C4mWCNDr8l3hMH+4zpyZqp3iFbJx20nGtU+9LJozl0OxNrk/c0C9chEe+k4vUECnUaXbS8JqdnymqbZ1SCI+4+1BYMW4nzYKDLaqL3Nm08C/Ug7zNg2BuwhWepXrkqaRX58LCWLPDQyUzn369E1drtekeuNcI4SgdmyQZ/7xhXZ6sOKg9G/HEiJQsriRQThvHz4BhaFaXic4nlrz4LhUthGBLbnnB6tufJizYx4c6b2rY1E63pLDA8QdZsTOD7euNMku1a0T2nNQ9rOPBYPDyksaP+EmKTvqcgRycKMtzhHh37mAqVERuzIIMs/zXE9jGBpJBBWb8KCPZne6Sxw0+UFlY6/VeXJUHunHXY1csfc40Tw95XrkpLzxqX/LrsaYM7Y0UQ/Qe6PTjMQUXDseSMhYwHTXCohySQ+1fIjz/yjZWRFI1/a4d9eQzWLoGjz8O8ldPhzhpWFwwlaR0T1gpMP3VeHvDOx4RJocHJOSRQ+H4/nHJsiuXWDKowYZZW8Jk9vUiw2jExedn7glAsC/bgN1NrgIp1y+y3tmLd2V9x7yKVC+QK6MOFq19dlQflj350qUavBULMCTn0BvCRQY4q6VjniU6XHISUsaApCVoQeevAOuCUFcnwWfK+44XDo1qSpPF1wcnbH7N9aO+AzD212PgFlGkXlaQ3Gbfz9XIUMjulgGUREelr6IX+tR2K9H/yep959z5WLXlZ81Z8HCIV8CyU0JKYzkIeFqf6o2ywb2O73oRi7i8F6Vcn2zU1VWZpLfSXgTNkRtqM7r5s13UimLWtAVZs97rLcMRlwXzYp98ZnKvQLj/dpKn8nfNnU9V2Bp90frlQedeKt6zd4mPR53FKQ1J4r95n1G8ph0XG37DC9b185sWbnoyC4Q1iUvyy5IOxBrIqbqn/JSUWzdrlOiZGDJrU5IGuzUl5TaupUTIgFeLfT6uh0gIEJ5nZQ/8XjB0mmEZxTvocrU/BFoOaUvV/N48W3W/aQu5nR3KwsSByfSDAEq6qBqTVTkZtkaAd/1Rie2jkdRlZvxFMu0MGnLc0SHPII8eOz/bjfIhSQhAb38dSRcFmfRb+fpDrDHeazED6EHNayy0kESoRG+XFbJa6xWB6OlbwHVDwdO9Ka7bIOqLRHpZjwXmv/2DR9nu+2xwxE39cBHq/7Vv99HcvH8ZJeGmgHr8mBKQmOCTkvLkxf5k4FrqZuNpaRNhCB3puFuF5d2nnQbhgAaANLMCYAiGsJhX2bFM/r3BGhR/dkGPXeBQUJ4tTARQnVqA07mW/42Dv2k7Wa7hWU/wv7FTIWLwWyHX0Vqdg4BHrlJ7zh+b+T6fH+W3d53LS5rkXK5GIctMIttK+osfGYIvOD0BkkXBJR0EYUmteToIxpoaMVKZmCRC2BbmBLdUTIZiI1kVYKYnq9Q5xMGODu+6vCT2ofvYE0pmGbQ9Ln6wnBDYZUD/BL9rmiPn3n28Zs33OsHUQcLp2vjUEV5sOBLO2ScyescGu0N58y1q1NSNJuXCzI4fu4RWJtSIn3P3+9eAsMo/2NupFeaf70/usLGd2Z0F27EjLoIj+nmJ4/Q5edPFhVNpPURQrUzPALNNzEvx3e82rDtPpbZjugv7Abm2q2vMGwz5W+hGH0hkCzXdZhPFbLk0sR5vVhScLgAPdZIVZIjTuzwIKVuWmvpMr7Gwxgiglpy8ecfOAZcCpXRzG6lNuRB64D4G9AWD9vQi/crWV4Xq5VjJnRjQc3g4bJe+MmksjEctghn27n5i5PHZvW/gM0BsXzo8Pou6yOLnp49dGXpK/oLAbOdOel9h+kDqEtZunvsXa9EFomdl0QbDvk+H58SjszCVqVOXSgDpOdZjXWfZpFL6S/fd1Lq8FQS3LklgiNhdvE5GzgSO8uq3gtj8I2o+JzucnrUSrtoxa6IejmVQLGzF3rSCy3fdhBPhZnDdgctC89dRJ+PTfW4ga5WWAyaWspzFg5251FoByB8LUbD3AxhvV6M1ARNXRJ4NhPe2j9WOlu5I2KmCMGvGP5CbHAyZk3YhiuIdtDgOvre9Cz0yOWvHH5FpZQzqzyHE5XkTTFMU2JhG1nvne9SCi9zNvPnGj9h/bQXgpue78rpogXJl8oDSfMwz9fp4ocyOxEV1JCEslSsRvodEzPbUsMUYWDERNzR6f45Ku6EmW3qdD48dcFQtc9rr2wF3o85edZ/2SY0BSkOdQX1ahwPVBP554Q1Z4lbd0d/vrRCO5k3QBWOb3iML0vI4MRkiKwqt735Q2fkq0Xl1pI3nk4ll51cSEHOrFTctkxwLOiQl6HJh2q3iqHFmtOCSo0A4YLl+mllolm7FLpe/79gMoe7A5cbFPCbX9Z3GhI43FgBbWoq8pwaIoDlklRimVauOx355pv7v26P0MLrgiqWTOxJaIGO/UhHf7GSOm0r1O5m1sPYYn1bathmEkYfrQLiEWQ2/3IjunsIxgAmi6t4JsxalYxE4YyvD59EpzvswOjZUvSgkHwPZonVtaiMTLXnV3p0dKpCSSz38Kv8QbNFzqLbwbBBRUHw/nHSxNipNm5vtjfkuf06jWRwkctgu8wZqKwS/7IcGnFtmwnbJFPhpGcyV9GVFzCCG+TOeNgAWxOUPgmtLdD8JawVVDV+e3iR8kHuaZXIknncI/3uFnblTd2P/OdWvxl+9CXbqJb1CS8osg2fg/qaA9KvM3FQoZQ79JRZC/Upm90ABPCGzksTWJ7Xy9VHpnPZCgGzAVbJhmurq8tm24BjBvnm1GOKfotvCqXyIXFE1bYTRS1WtzgZrGWgR/oOUDnNgDPXqUfTmyFPfNCD9MX22hvuBans/Kl1DustiTunl9Kravj0NG1Ds5nkTqlQSYOfhgvRIowimmWAYWma55eqvaQL9GvHmuH/hIVB/tiN6s7yOW2iahReL8dNddIbMJ6BLVguJ4n1dnquV3ZNqi6V0H/Vn00j0cE80ERsZTgsHPJ0eUjxYik+eDtaEHnyAsYeR2AjRcGw=="),(function(e){return e.charCodeAt(0)})),i=new Uint8Array([177,156,215,89,13,111,230,1]),o=new Uint8Array(n.length),a=new Uint8Array(256),s=0;s<256;s++)a[s]=s;var c,u=0;for(s=0;s<256;s++){var d=[a[u=(u+a[s]+i[s%i.length])%256],a[s]];a[s]=d[0],a[u]=d[1]}s=0,u=0;for(var l=0;l<0+n.length;l++){var f=[a[u=(u+a[s=(s+1)%256])%256],a[s]];a[s]=f[0],a[u]=f[1],c=a[(a[s]+a[u])%256],l>=0&&(o[l-0]=n[l-0]^c)}return x=!0,new Promise((function(n){(function(e,t){return WebAssembly.instantiate(e,t)})(o.buffer,t).then((function(t){x=!1,r=t.instance.exports,e.__wbindgen_wasm_module=t.module,n()}))}))}().then((function(){k=A.new(),e(k)}))}))).then((function(e){O=e}));var D=!0;setInterval((function(){Object(c.getParameter)("UPLOAD_LOG")&&Z.info("console log upload")}),9e5);var Z=function(){var e,t,n,r,i,d,l=null,f=["DEBUG","INFO","WARNING","ERROR","NONE"],p=0,h=function(e,t){if(Object(c.getParameter)("UPLOAD_LOG"))try{t=Array.prototype.slice.call(t);var n="";if(t.forEach((function(e){"object"===o()(e)&&(e=JSON.stringify(e)),n=n+e+" "})),M.push({payload:n,log_level:e}),D)return;"free"===L&&function e(t){L="uploading",setTimeout((function(){!function(e,t,n){var r={};Array.isArray(e)||(e=[e]),e=e.map((function(e){return{log_item_id:N++,log_level:e.log_level,payload_str:e.payload}})),r={timestamp:Date.now(),sdk_version:c.VERSION,process_id:Object(u.getProcessId)(),payload:JSON.stringify(e)},O?r.hash=O.get_digest("".concat(r.payload).concat(r.process_id).concat(r.timestamp)):n&&n();try{var i=l,o=l||"https://".concat(Object(c.getParameter)("LOG_UPLOAD_SERVER"),"/upload/v2");Object(s.post)(o,r,(function(e){"OK"===e?t&&t(e):n&&n(e)}),(function(e){n&&n(e)}),i?{withCredentials:!0}:{withCredentials:!0,"Cache-Control":"no-cache, no-store",Pragma:"no-cache",Expires:"0"})}catch(e){n&&n(e)}}(t,(function(){P=0,0!==M.length?(V=M.length<10?M.splice(0,M.length):M.splice(0,10),e(V)):L="free"}),(function(){setTimeout((function(){e(V)}),P++<2?200:1e4)}))}),3e3)}(V=M.length<10?M.splice(0,M.length):M.splice(0,10))}catch(e){}};t=function(){for(var t=[0],n=0;n<arguments.length;n++)t.push(arguments[n]);e.apply(this,t)},n=function(){for(var t=[1],n=0;n<arguments.length;n++)t.push(arguments[n]);e.apply(this,t)},r=function(){for(var t=[2],n=0;n<arguments.length;n++)t.push(arguments[n]);e.apply(this,t)},i=function(){for(var t=[3],n=0;n<arguments.length;n++)t.push(arguments[n]);e.apply(this,t)};var m={};return d=function(e){m[e]||(r.apply(void 0,arguments),m[e]=!0)},{DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4,stopWaitJoin:function(){D=!1},enableLogUpload:function(){Object(c.setParameter)("UPLOAD_LOG",!0)},disableLogUpload:function(){Object(c.setParameter)("UPLOAD_LOG",!1)},setProxyServer:function(e){l=e?"https://".concat(e,"/ls/?h=").concat(Object(c.getParameter)("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v2"):"https://".concat(Object(c.getParameter)("LOG_UPLOAD_SERVER"),"/upload/v2")},setLogLevel:function(e){e>4?e=4:e<0&&(e=0),p=e},log:e=function(){var e=arguments[0],t=arguments;if(t[0]=a()+" Agora-SDK ["+(f[e]||"DEFAULT")+"]:",h(e,t),!(e<p))switch(e){case 0:case 1:console.log.apply(console,t);break;case 2:console.warn.apply(console,t);break;case 3:console.log.apply(console,t);break;default:return void console.log.apply(console,t)}},debug:t,info:n,warning:r,deprecate:d,error:i}}();t.default=Z},function(e,t,n){"use strict";n.r(t),n.d(t,"report",(function(){return w})),n.d(t,"SESSION_INIT",(function(){return v})),n.d(t,"JOIN_CHOOSE_SERVER",(function(){return y})),n.d(t,"JOIN_GATEWAY",(function(){return b})),n.d(t,"PUBLISH",(function(){return S})),n.d(t,"SUBSCRIBE",(function(){return E})),n.d(t,"getProcessId",(function(){return I}));var r=n(46),i=n.n(r),o=n(7),a=n.n(o),s=n(2),c=n(0),u=n(14),d=n(28),l=n.n(d),f=n(47);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m,g,v="session_init",y="join_choose_server",b="join_gateway",S="publish",E="subscribe",_=new(n.n(f).a),T={eventType:null,sid:null,lts:null,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0},R=null,I=function(){return R||(R="process-"+l()(),c.default.info("processId: "+R)),R},w=(g=0,(m={list:{},setProxyServer:function(e){_.setProxy(e),m.proxyServerURL=e},getUrl:function(){return m.proxyServerURL?"https://".concat(m.proxyServerURL,"/rs/?h=").concat(Object(s.getParameter)("EVENT_REPORT_DOMAIN"),"&p=6443&d=events/message"):"https://".concat(Object(s.getParameter)("EVENT_REPORT_DOMAIN"),":6443/events/message")},getBackUrl:function(){return m.proxyServerURL?"https://".concat(m.proxyServerURL,"/rs/?h=").concat(Object(s.getParameter)("EVENT_REPORT_BACKUP_DOMAIN"),"&p=6443&d=events/message"):"https://".concat(Object(s.getParameter)("EVENT_REPORT_BACKUP_DOMAIN"),":6443/events/message")},getSessionStartTime:function(e){return m.list[e]?m.list[e].startTime:(c.default.DEBUG("[getSessionStartTime]: session ".concat(e," no exit")),0)},sessionInit:function(e,t){var n=a()({},T);n.startTime=+new Date,n.sid=e,n.cname=t.cname,m.list[e]=n;var r=a()({},{willUploadConsoleLog:Object(s.getParameter)("UPLOAD_LOG"),areaVersion:"global"},t.extend),i=a()({},n);i.eventType=v,i.appid=t.appid,i.browser=navigator.userAgent,i.build=s.BUILD,i.lts=+new Date,i.elapse=i.lts-i.startTime,i.extend=JSON.stringify(r),i.mode=t.mode,i.process=I(),i.success=t.succ,i.version=s.VERSION,delete i.startTime,m.send({type:"Session",data:i}),m._flushInvokeReport(e)},joinChooseServer2:function(e,t,n){if(m.list[e]){m.list[e].uid||(t.uid&&(m.list[e].uid=parseInt(t.uid)),t.cid&&(m.list[e].cid=parseInt(t.cid)),t.vid&&(m.list[e].vid=parseInt(t.vid)));var r=a()({},m.list[e]);r.eventType=y;var i=t.lts;r.lts=Date.now(),r.eventElapse=r.lts-i,r.chooseServerAddr=t.csAddr,r.errorCode=t.ec,r.elapse=r.lts-r.startTime,r.success=t.succ,r.chooseServerIp=t.chooseServerIp||"",r.chooseServerAddrList=JSON.stringify(t.serverList),delete r.startTime,m.send({type:"JoinChooseServer",data:r})}},joinChooseServer:function(e,t,n){if(m.list[e]){n&&(t.uid&&(m.list[e].uid=parseInt(t.uid)),t.cid&&(m.list[e].cid=parseInt(t.cid)),t.vid&&(m.list[e].vid=parseInt(t.vid)));var r=a()({},m.list[e]);r.eventType=y;var i=t.lts;r.lts=Date.now(),r.eventElapse=r.lts-i,r.chooseServerAddr=t.csAddr,r.errorCode=t.ec,r.elapse=r.lts-r.startTime,r.success=t.succ,r.chooseServerIp=t.chooseServerIp||"",r.chooseServerAddrList=JSON.stringify(t.serverList),delete r.startTime,m.send({type:"JoinChooseServer",data:r})}},reqUserAccount:function(e,t){t.vid&&(m.list[e].vid=parseInt(t.vid));var n=a()({},m.list[e]),r=t.lts;n.eventType="req_user_account",n.lts=Date.now(),n.success=t.success,n.serverAddress=t.serverAddress,n.stringUid=t.stringUid,n.uid=t.uid,n.errorCode=t.errorCode,n.elapse=n.lts-n.startTime,n.eventElapse=n.lts-r,n.extend="string"==typeof t.extend?t.extend:JSON.stringify(t.extend),delete n.startTime,m.send({type:"ReqUserAccount",data:n})},joinGateway:function(e,t){t.vid&&(m.list[e].vid=parseInt(t.vid)),t.uid&&(m.list[e].uid=parseInt(t.uid));var n=a()({},m.list[e]),r=t.lts;n.eventType=b,n.firstSuccess=t.firstSuccess,n.lts=Date.now(),n.gatewayAddr=t.addr,n.success=t.succ,n.errorCode=t.ec,n.elapse=n.lts-n.startTime,n.eventElapse=n.lts-r,delete n.startTime,m.send({type:"JoinGateway",data:n})},publish:function(e,t){var n=a()({},m.list[e]);n.eventType=S;var r=t.lts;n.lts=Date.now(),n.eventElapse=n.lts-r,n.elapse=n.lts-n.startTime,n.success=t.succ,n.errorCode=t.ec,n.audio=t.audio,n.video=t.video,n.screenshare=t.screenshare,n.publishRequestid=t.publishRequestid,n.p2pid=t.p2pid,t.videoName&&(n.videoName=t.videoName),t.audioName&&(n.audioName=t.audioName),t.screenName&&(n.screenName=t.screenName),delete n.startTime,m.send({type:"Publish",data:n}),m._flushInvokeReport(e)},subscribe:function(e,t){var n=a()({},m.list[e]);n.eventType=E;var r=t.lts;n.lts=Date.now(),n.eventElapse=n.lts-r,n.elapse=n.lts-n.startTime,n.errorCode=t.ec,n.success=t.succ,n.subscribeRequestid=t.subscribeRequestid,n.p2pid=t.p2pid,isFinite(t.peerid)?n.peer=t.peerid:n.peerSuid=""+t.peerid,"boolean"==typeof t.video&&(n.video=t.video),"boolean"==typeof t.audio&&(n.audio=t.audio),delete n.startTime,m.send({type:"Subscribe",data:n}),m._flushInvokeReport(e)},firstRemoteFrame:function(e,t){var n=a()({},m.list[e]);n.eventType="first_remote_frame";var r=t.lts;n.lts=Date.now(),n.eventElapse=n.lts-r,n.elapse=n.lts-n.startTime,n.width=t.width,n.height=t.height,n.success=t.succ,n.errorCode=t.ec,isFinite(t.peerid)?n.peer=t.peerid:n.peerSuid=""+t.peerid,delete n.startTime,m.send({type:"FirstFrame",data:n})},firstVideoReceived:function(e,t){var n=a()({},m.list[e]);n.eventType="first_video_received",n.lts=Date.now(),n.peer=t.peerid,n.uid=t.uid,n.elapse=t.elapse,n.subscribeElapse=t.subscribeElapse,n.subscribeRequestid=t.subscribeRequestid,n.p2pid=t.p2pid,m.send({type:"FirstVideoReceived",data:n})},firstAudioReceived:function(e,t){var n=a()({},m.list[e]);n.eventType="first_audio_received",n.lts=Date.now(),n.peer=t.peerid,n.uid=t.uid,n.elapse=t.elapse,n.subscribeElapse=t.subscribeElapse,n.subscribeRequestid=t.subscribeRequestid,n.p2pid=t.p2pid,m.send({type:"FirstAudioReceived",data:n})},firstVideoDecode:function(e,t){var n=a()({},m.list[e]);n.eventType="first_video_decode",n.lts=Date.now(),n.peer=t.peerid,n.uid=t.uid,n.elapse=t.elapse,n.videowidth=t.width,n.videoheight=t.height,n.subscribeElapse=t.subscribeElapse,n.subscribeRequestid=t.subscribeRequestid,n.p2pid=t.p2pid,m.send({type:"FirstVideoDecode",data:n})},firstAudioDecode:function(e,t){var n=a()({},m.list[e]);n.eventType="first_audio_decode",n.lts=Date.now(),n.uid=t.uid,n.peer=t.peerid,n.elapse=t.elapse,n.subscribeElapse=t.subscribeElapse,n.subscribeRequestid=t.subscribeRequestid,n.p2pid=t.p2pid,m.send({type:"FirstAudioDecode",data:n})},onAddAudioStream:function(e,t){var n=a()({},m.list[e]);n.eventType="on_add_audio_stream",n.lts=Date.now(),n.uid=t.uid,n.peer=t.peerid,m.send({type:"OnAddAudioStream",data:n})},onAddVideoStream:function(e,t){var n=a()({},m.list[e]);n.eventType="on_add_video_stream",n.lts=Date.now(),n.uid=t.uid,n.peer=t.peerid,m.send({type:"OnAddVideoStream",data:n})},onUpdateStream:function(e,t){var n=a()({},m.list[e]);n.eventType="on_update_stream",n.lts=Date.now(),n.uid=t.uid,n.peer=t.peerid,n.audio=t.audio,n.video=t.video,m.send({type:"OnUpdateStream",data:n})},onRemoveStream:function(e,t){var n=a()({},m.list[e]);n.eventType="on_remove_stream",n.lts=Date.now(),n.uid=t.uid,n.peer=t.peerid,m.send({type:"OnRemoveStream",data:n})},streamSwitch:function(e,t){var n=a()({},m.list[e]);n.eventType="stream_switch",n.lts=Date.now(),n.isDual=t.isdual,n.elapse=n.lts-n.startTime,n.success=n.succ,delete n.startTime,m.send({type:"StreamSwitch",data:n})},audioSendingStopped:function(e,t){var n=a()({},m.list[e]);n.eventType="audio_sending_stopped",n.lts=Date.now(),n.elapse=n.lts-n.startTime,n.reason=t.reason,n.success=t.succ,delete n.startTime,m.send({type:"AudioSendingStopped",data:n})},videoSendingStopped:function(e,t){var n=a()({},m.list[e]);n.eventType="video_sending_stopped",n.lts=Date.now(),n.elapse=n.lts-n.startTime,n.reson=t.reason,n.success=t.succ,delete n.startTime,m.send({type:"VideoSendingStopped",data:n})},requestProxyAppCenter:function(e,t){var n=a()({},m.list[e]),r=t.lts;n.eventType="request_proxy_appcenter",n.lts=Date.now(),n.eventElapse=n.lts-r,n.elapse=n.lts-n.startTime,n.extend=t.extend+"",n.APAddr=t.APAddr,n.workerManagerList=t.workerManagerList,n.response=t.response,n.errorCode=t.ec,n.success=t.succ,delete n.startTime,m.send({type:"RequestProxyAppCenter",data:n})},requestProxyWorkerManager:function(e,t){var n=a()({},m.list[e]),r=t.lts;n.eventType="request_proxy_worker_manager",n.lts=Date.now(),n.eventElapse=n.lts-r,n.elapse=n.lts-n.startTime,n.extend=t.extend,n.workerManagerAddr=t.workerManagerAddr,n.response=t.response,n.errorCode=t.ec,n.success=t.succ,delete n.startTime,m.send({type:"RequestProxyWorkerManager",data:n})},requestWorkerEvent:function(e,t){var n=a()({},m.list[e]),r=n.startTime,i=Date.now();delete(n=h({},n,{},t,{elapse:i-r,lts:i,productType:"WebRTC"})).startTime,m.send({type:"WorkerEvent",data:n})},requestApWorkerEvent:function(e,t){var n=a()({},m.list[e]),r=n.startTime,i=Date.now();n=h({},n,{},t,{elapse:i-r,lts:i}),m.send({type:"APWorkerEvent",data:n})},sendCustomReportMessage:function(e,t,n){var r={type:"UserAnalytics",data:h({sid:e},t)},i=m.getUrl(),o=!!m.proxyServerURL;Object(u.post)(i,r,(function(e){n&&n()}),(function(e){var t=m.getBackUrl();Object(u.post)(t,r,(function(e){n&&n()}),(function(e){n&&n("Failed")}),o?{timeout:Object(s.getParameter)("CUSTOMER_REPORT_TIMEOUT")}:{timeout:Object(s.getParameter)("CUSTOMER_REPORT_TIMEOUT"),"Cache-Control":"no-cache, no-store",Pragma:"no-cache",Expires:"0"})}),o?{timeout:Object(s.getParameter)("CUSTOMER_REPORT_TIMEOUT")}:{timeout:Object(s.getParameter)("CUSTOMER_REPORT_TIMEOUT"),"Cache-Control":"no-cache, no-store",Pragma:"no-cache",Expires:"0"})},joinChannelTimeOut:function(e){m.send({type:"JoinChannelTimeout",data:h({},e)})},peerPublishStatus:function(e){m.send({type:"PeerPublishStatus",data:h({},e)})},joinWebProxyAP:function(e){m.send({type:"JoinWebProxyAP",data:h({},e)})},webSocketQuit:function(e){m.send({type:"WebSocketQuit",data:h({},e)})}}).reportApiInvoke=function(e,t){var n=t.tag,r=t.name,i=t.getStates,o=t.options,a=t.timeout,u=void 0===a?6e4:a,d=t.callback,l=t.reportResult,f=void 0===l||l,p=Date.now(),m=0,v=g++,y=function(){return h({tag:n,invokeId:v,sid:e,name:r,apiInvokeTime:p,options:o},i&&{states:(t=i(),Object.keys(t).reduce((function(e,n){var r=e;return null!=t[n]&&(r[n]=t[n]),r}),{}))});var t},b=!!Object(s.getParameter)("SHOW_REPORT_INVOKER_LOG");b&&c.default.info("".concat(r," start"));var S=setTimeout((function(){w._sendApiInvoke(h({},y(),{error:"API_INVOKE_TIMEOUT",success:!1}))}),u);return function(e,t){if(clearTimeout(S),++m>1&&(e="EXECUTOR_INVOKE_".concat(m)),e)return w._sendApiInvoke(h({},y(),{success:!1,error:e},i&&{states:i()})),b&&c.default.info("".concat(r," onFailure"),e),d&&d(e);w._sendApiInvoke(h({},y(),{success:!0},f&&{result:t},{},i&&{states:i()})),b&&c.default.info("".concat(r," onSuccess")),d&&d(null,t)}},m._cachedItems=[],m._cacheInvokeReport=function(e){e.lts||(e.lts=Date.now()),m._cachedItems.push(e),m._cachedItems.length>50&&m._cachedItems.shift()},m._flushInvokeReport=function(e){if(m._cachedItems.length){var t=m._cachedItems;m._cachedItems=[],c.default.debug("Flush cached event reporting:",t.length),t.forEach((function(t,n){t.sid=e,setTimeout((function(){m._sendApiInvoke(t)}),5e3+500*n)}))}},m._sendApiInvoke=function(e){var t=e.tag,n=e.invokeId,r=e.sid,i=e.name,o=e.result,a=e.states,c=e.options,u=e.error,d=e.success,l=e.apiInvokeTime,f=e.lts,p=Object(s.getParameter)("NOT_REPORT_EVENT");if(!(t&&p instanceof Array&&-1!==p.indexOf(t)))if(m.list[r]){var g=m.list[r],v=g.startTime,y=g.cname,b=g.uid,S=g.cid,E=(f=f||Date.now())-v,_=f-l,T="";if(c)try{T=JSON.stringify(c)}catch(e){T=c.toString()}var R=h({invokeId:n,sid:r,cname:y,cid:S,lts:f,uid:b,success:d,elapse:E,apiName:i,execElapse:_},void 0!==c&&{options:T},{},void 0!==a&&{execStates:JSON.stringify(a)},{},void 0!==u&&{errorCode:JSON.stringify(u)},{},void 0!==o&&{execResult:JSON.stringify(o)});m.send({type:"ApiInvoke",data:R})}else m._cacheInvokeReport(arguments[0])},m.sendCache=[],m.sendTimer=null,m.send=function(e){if(e.data){var t=e.data;m._lastLts&&m._lastLts>=t.lts&&(t.lts=m._lastLts+1),m._lastLts=t.lts}if(m.sendCache.push(e),null===m.sendTimer)return function e(){m.sendTimer=setTimeout((function(){if(0!==m.sendCache.length){var t=m.sendCache.length<10?m.sendCache.splice(0,m.sendCache.length):m.sendCache.splice(0,10),n=m.list[t[0].data.sid].vid;return _.sendReportList(t,n),e()}m.sendTimer=null}),Object(s.getParameter)("EVENT_REPORT_SEND_INTERVAL"))}()},m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BUILD="v3.6.11-0-gbdacc5f-dirty",t.VERSION="3.6.11";var r=0*Date.now()+11499+86604+5615+6547+846;t.SUPPORT_RESOLUTION_LIST={"90p_1":[160,90,null,null,null,null],"120p_1":[160,120,15,15,30,65],"120p_3":[120,120,15,15,30,50],"120p_4":[212,120,null,null,null,null],"180p_1":[320,180,15,15,30,140],"180p_3":[180,180,15,15,30,100],"180p_4":[240,180,15,15,30,120],"240p_1":[320,240,15,15,40,200],"240p_3":[240,240,15,15,40,140],"240p_4":[424,240,15,15,40,220],"360p_1":[640,360,15,15,80,400],"360p_3":[360,360,15,15,80,260],"360p_4":[640,360,30,30,80,600],"360p_6":[360,360,30,30,80,400],"360p_7":[480,360,15,15,80,320],"360p_8":[480,360,30,30,80,490],"360p_9":[640,360,15,15,80,800],"360p_10":[640,360,24,24,80,800],"360p_11":[640,360,24,24,80,1e3],"480p_1":[640,480,15,15,100,500,1,5],"480p_2":[640,480,30,30,100,1e3,25,30],"480p_3":[480,480,15,15,100,400],"480p_4":[640,480,30,30,100,750],"480p_6":[480,480,30,30,100,600],"480p_8":[848,480,15,15,100,610],"480p_9":[848,480,30,30,100,930],"480p_10":[640,480,10,10,100,400],"720p_1":[1280,720,15,15,120,1130,1,5],"720p_2":[1280,720,30,30,120,2e3,25,30],"720p_3":[1280,720,30,30,120,1710],"720p_5":[960,720,15,15,120,910],"720p_6":[960,720,30,30,120,1380],"1080p_1":[1920,1080,15,15,120,2080,1,5],"1080p_2":[1920,1080,30,30,120,3e3,25,30],"1080p_3":[1920,1080,30,30,120,3150],"1080p_5":[1920,1080,60,60,120,4780],"1440p_1":[2560,1440,30,30,120,4850],"1440p_2":[2560,1440,60,60,120,7350],"4k_1":[3840,2160,30,30,120,8910],"4k_3":[3840,2160,60,60,120,13500]},t.AUDIO_PROFILE_SETTINGS={speech_low_quality:[!1,!1,!0,!0],speech_standard:[!1,!1,!0,!1],music_standard:[!1,!1,!1,!1],standard_stereo:[!1,!0,!1,!1],high_quality:[!0,!1,!1,!1],high_quality_stereo:[!0,!0,!1,!1],default:[!1,!1,!1,!1]};var i={AREA_SETTING:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"web-2.statscollector.sd-rtn.com",EVENT_REPORT_BACKUP_DOMAIN:"web-3.statscollector.sd-rtn.com",ENABLE_LIVE_SERVER_LIST:!1,LIVE_SERVER_LIST:[],ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,LIVESTREAMING_ALIGN:!0,HTTP_CONNECT_TIMEOUT:5e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_TIMEOUT:1e7,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,REPORT_STATS:!0,REPORT_STATS_TIMEOUT:3e3,UPLOAD_LOG:!1,NOT_REPORT_EVENT:[],FILEPATH_LENMAX:255,SUBSCRIBE_TCC:!1,PING_PONG_TIME_OUT:10,DUALSTREAM_OPERATION_CHECK:!0,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:1e3,MEDIA_ELEMENT_EXISTS_DEPTH:3,CANDIDATE_TIMEOUT:2e3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,TICKET_RENEW_TIMEOUT:828e5,LIVE_STREAMING_TIMEOUT:12e4,SHOW_REPORT_INVOKER_LOG:!1,STATS_FILTER:{transportId:!0,googTrackId:!0},FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,FORCE_CHANGED_GATEWAY_FLAG:!1,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",CHROME_NEW_STATS:!1,AP_BACKOFF_MAX_TIME:8,SET_DEFAULT_TURNSERVER:!0,TURN_SERVER_PASSWORD:r.toString(),PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",NGINX:"webrtc-cloud-proxy.sd-rtn.com",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CR:!0,CRL:10,CRI:6,CUSTOMER_REPORT_TIMEOUT:5e3,LIVE_STREAMING_ADDRESS:"",CHOOSE_SERVER_FRAGEMENT_LENGTH:4,PLAN:"plan-b"};t.setParameter=function(e,t){return void 0!==i[e]&&(i[e]=t,!0)},t.getParameter=function(e){return void 0!==i[e]?i[e]:null}},function(e,t,n){"use strict";n.r(t),n.d(t,"checkValidObject",(function(){return c})),n.d(t,"checkValidString",(function(){return u})),n.d(t,"checkValidNumber",(function(){return d})),n.d(t,"checkValidArray",(function(){return l})),n.d(t,"checkValidFloatNumber",(function(){return f})),n.d(t,"checkValidBoolean",(function(){return p})),n.d(t,"checkValidEnum",(function(){return s})),n.d(t,"checkValidUID",(function(){return h})),n.d(t,"isValidString",(function(){return m})),n.d(t,"isValidNumber",(function(){return g})),n.d(t,"isValidBoolean",(function(){return y})),n.d(t,"isASCII",(function(){return E})),n.d(t,"isInteger",(function(){return _})),n.d(t,"isNumber",(function(){return T})),n.d(t,"isString",(function(){return R})),n.d(t,"isArray",(function(){return I})),n.d(t,"isEmpty",(function(){return w})),n.d(t,"isValidToken",(function(){return b})),n.d(t,"isValidChannelName",(function(){return S}));var r=n(11),i=n.n(r),o=n(10),a=n(0),s=function(e,t,n){for(var r=0;r<n.length;r++)if(e===n[r])return!0;throw new Error("".concat(t," can only be set as ").concat(JSON.stringify(n)))},c=function(e,t){if(!e)throw new Error("Invalid param: ".concat(t||"param"," cannot be empty"));if("object"!==i()(e))throw new Error("".concat(t||"This paramter"," is of the object type"));return!0},u=function(e,t,n,r,i){if(w(n)&&(n=1),r=r||255,w(i)&&(i=!0),w(e))throw new Error("".concat(t||"param"," cannot be empty"));if(!m(e,n,r,i))throw new Error("Invalid ".concat(t||"string param",": Length of the string: [").concat(n,",").concat(r,"].").concat(i?" ASCII characters only.":""))},d=function(e,t,n,r){if(w(n)&&(n=1),r=r||1e4,w(e))throw new Error("".concat(t||"param"," cannot be empty"));if(!g(e,n,r))throw new Error("Invalid ".concat(t||"number param",": The value range is [").concat(n,",").concat(r,"]. integer only"))},l=function(e,t){if(!Array.isArray(e))throw new Error("".concat(t," should be an array"))},f=function(e,t,n,r){if(null==e)throw new Error("".concat(t||"param"," cannot be null"));if(w(n)&&(n=0),r=r||1e4,w(e))throw new Error("".concat(t||"param"," cannot be empty"));if(!v(e,n,r))throw new Error("Invalid ".concat(t||"number param",": The value range is [").concat(n,",").concat(r,"]."))},p=function(e,t){if(w(e))throw new Error("".concat(t||"param"," cannot be empty"));if(!y(e))throw new Error("Invalid ".concat(t||"boolean param",": The value is of the boolean type."))},h=function(e){if(!Object(o.is32Uint)(e)&&!m(e,1,255))throw a.default.error("Invalid UID ".concat(e," ").concat(i()(e))),new Error("[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]")},m=function(e,t,n,r){return t||(t=0),n||(n=Number.MAX_SAFE_INTEGER),w(r)&&(r=!0),R(e)&&(!r||E(e))&&e.length>=t&&e.length<=n},g=function(e,t,n){return _(e)&&e>=t&&e<=n},v=function(e,t,n){return T(e)&&e>=t&&e<=n},y=function(e){return"boolean"==typeof e},b=function(e){return m(e,1,2047)},S=function(e){return R(e)&&/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(e)},E=function(e){if("string"==typeof e){for(var t=0;t<e.length;t++){var n=e.charCodeAt(t);if(n<0||n>255)return!1}return!0}},_=function(e){return"number"==typeof e&&e%1==0},T=function(e){return"number"==typeof e},R=function(e){return"string"==typeof e},I=function(e){return e instanceof Array},w=function(e){return null==e}},function(e,t,n){"use strict";n.r(t),n.d(t,"getBrowserInfo",(function(){return y})),n.d(t,"getBrowserVersion",(function(){return f})),n.d(t,"getBrowserOS",(function(){return p})),n.d(t,"isChrome",(function(){return r})),n.d(t,"isSafari",(function(){return i})),n.d(t,"isFireFox",(function(){return a})),n.d(t,"isOpera",(function(){return s})),n.d(t,"isEdge",(function(){return o})),n.d(t,"isQQBrowser",(function(){return c})),n.d(t,"isWeChatBrowser",(function(){return u})),n.d(t,"isLegacyChrome",(function(){return m})),n.d(t,"isSupportedPC",(function(){return d})),n.d(t,"isSupportedMobile",(function(){return l})),n.d(t,"getChromeKernelVersion",(function(){return v})),n.d(t,"isChromeKernel",(function(){return h}));var r=function(){var e=y();return e.name&&"Chrome"===e.name},i=function(){var e=y();return e.name&&"Safari"===e.name},o=function(){var e=y();return e.name&&"Edge"===e.name},a=function(){var e=y();return e.name&&"Firefox"===e.name},s=function(){var e=y();return e.name&&"OPR"===e.name},c=function(){var e=y();return e.name&&"QQBrowser"===e.name},u=function(){var e=y();return e.name&&"MicroMessenger"===e.name},d=function(){var e=p();return"Linux"===e||"Mac OS X"===e||"Mac OS"===e||-1!==e.indexOf("Windows")},l=function(){var e=p();return"Android"===e||"iOS"===e},f=function(){return y().version},p=function(){return y().os},h=function(){return!!navigator.userAgent.match(/chrome\/[\d]+/i)};function m(){return window.navigator.appVersion&&null!==window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}var g,v=function(){var e=navigator.userAgent.match(/chrome\/[\d]+/i);return e&&e[0]&&e[0].split("/")[1]},y=(g=function(){var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];"Chrome"===n[1]&&null!=(e=t.match(/(OPR(?=\/))\/?(\d+)/i))&&(n=e),"Safari"===n[1]&&null!=(e=t.match(/version\/(\d+)/i))&&(n[2]=e[1]),~t.toLowerCase().indexOf("qqbrowser")&&null!=(e=t.match(/(qqbrowser(?=\/))\/?(\d+)/i))&&(n=e),~t.toLowerCase().indexOf("micromessenger")&&null!=(e=t.match(/(micromessenger(?=\/))\/?(\d+)/i))&&(n=e),~t.toLowerCase().indexOf("edge")&&null!=(e=t.match(/(edge(?=\/))\/?(\d+)/i))&&(n=e),~t.toLowerCase().indexOf("trident")&&null!=(e=/\brv[ :]+(\d+)/g.exec(t)||[])&&(n=[null,"IE",e[1]]);var r=void 0,i=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(var o in i){var a=i[o];if(a.r.test(navigator.userAgent)){r=a.s;break}}return{name:n[1],version:n[2],os:r}}(),function(){return g})},function(e,t,n){"use strict";n.r(t),n.d(t,"APErrorCode",(function(){return r})),n.d(t,"GatewayErrorCode",(function(){return i})),n.d(t,"StringUidErrorCode",(function(){return o})),n.d(t,"JOIN_GS_TRYNEXT_LIST",(function(){return a})),n.d(t,"JOIN_CS_RETRY_LIST",(function(){return s})),n.d(t,"JOIN_PROXY_RETRY_LIST",(function(){return c})),n.d(t,"INJECT_STREAM_STATUS",(function(){return u})),n.d(t,"WEBSOCKET_CLOSE_REASON",(function(){return d}));var r={1010100:"NO_FLAG_SET",1010101:"FLAG_SET_BUT_EMPTY",1010102:"INVALID_FALG_SET",2010005:"INVALID_VENDOR_KEY",2010007:"INVALID_CHANNEL_NAME",2010008:"INTERNAL_ERROR",2010009:"NO_AUTHORIZED",2010010:"DYNAMIC_KEY_TIMEOUT",2010011:"NO_ACTIVE_STATUS",2010013:"DYNAMIC_KEY_EXPIRED",2010014:"STATIC_USE_DYANMIC_KEY",2010015:"DYNAMIC_USE_STATIC_KEY",2010016:"USER_OVERLOAD",2010018:"FORBIDDEN_REGION",2010019:"CANNOT_MEET_AREA_DEMAND"},i={2e3:"ERR_NO_VOCS_AVAILABLE",2001:"ERR_NO_VOS_AVAILABLE",2002:"ERR_JOIN_CHANNEL_TIMEOUT",2003:"WARN_REPEAT_JOIN",2004:"ERR_JOIN_BY_MULTI_IP",2011:"ERR_NOT_JOINED",2012:"WARN_REPEAT_JOIN",2013:"ERR_INVALID_VENDOR_KEY",2014:"ERR_INVALID_CHANNEL_NAME",2015:"ERR_INVALID_STRINGUID",2016:"ERR_TOO_MANY_USERS",2017:"ERR_SET_CLIENT_ROLE_TIMEOUT",2018:"ERR_SET_CLIENT_ROLE_NO_PERMISSION",2019:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",2020:"ERR_PUBLISH_REQUEST_INVALID",2021:"ERR_SUBSCRIBE_REQUEST_INVALID",2022:"ERR_NOT_SUPPORTED_MESSAGE",2023:"ERR_ILLEAGAL_PLUGIN",2028:"ILLEGAL_AES_PASSWORD",101:"ERR_INVALID_VENDOR_KEY",102:"ERR_INVALID_CHANNEL_NAME",103:"WARN_NO_AVAILABLE_CHANNEL",104:"WARN_LOOKUP_CHANNEL_TIMEOUT",105:"WARN_LOOKUP_CHANNEL_REJECTED",106:"WARN_OPEN_CHANNEL_TIMEOUT",107:"WARN_OPEN_CHANNEL_REJECTED",108:"WARN_REQUEST_DEFERRED",109:"ERR_DYNAMIC_KEY_TIMEOUT",110:"ERR_NO_AUTHORIZED",111:"ERR_VOM_SERVICE_UNAVAILABLE",112:"ERR_NO_CHANNEL_AVAILABLE_CODE",113:"ERR_TOO_MANY_USERS",114:"ERR_MASTER_VOCS_UNAVAILABLE",115:"ERR_INTERNAL_ERROR",116:"ERR_NO_ACTIVE_STATUS",117:"ERR_INVALID_UID",118:"ERR_DYNAMIC_KEY_EXPIRED",119:"ERR_STATIC_USE_DYANMIC_KE",120:"ERR_DYNAMIC_USE_STATIC_KE",2:"K_TIMESTAMP_EXPIRED",3:"K_CHANNEL_PERMISSION_INVALID",4:"K_CERTIFICATE_INVALID",5:"K_CHANNEL_NAME_EMPTY",6:"K_CHANNEL_NOT_FOUND",7:"K_TICKET_INVALID",8:"K_CHANNEL_CONFLICTED",9:"K_SERVICE_NOT_READY",10:"K_SERVICE_TOO_HEAVY",14:"K_UID_BANNED",15:"K_IP_BANNED",16:"K_CHANNEL_BANNED"},o={1:"ERROR_ILLEAGAL_APPID",2:"ERROR_ILLEAGAL_UID",3:"INTERNAL_SERVER_ERROR"},a=["ERR_NO_VOCS_AVAILABLE","ERR_NO_VOS_AVAILABLE","ERR_JOIN_CHANNEL_TIMEOUT","WARN_LOOKUP_CHANNEL_TIMEOUT","WARN_OPEN_CHANNEL_TIMEOUT","ERR_VOM_SERVICE_UNAVAILABLE","ERR_TOO_MANY_USERS","ERR_MASTER_VOCS_UNAVAILABLE","ERR_INTERNAL_ERROR"],s=["NO_SERVICE_AVAILABLE"],c=["NO_SERVICE_AVAILABLE","REQUEST_PROXY_SERVER_FAILED","REQUEST_PROXY_SERVER_TIME_OUT"],u={INJECT_STREAM_STATUS_START_SUCCESS:0,INJECT_STREAM_STATUS_START_ALREADY_EXISTS:1,INJECT_STREAM_STATUS_START_UNAUTHORIZED:2,INJECT_STREAM_STATUS_START_TIMEDOUT:3,INJECT_STREAM_STATUS_START_FAILED:4,INJECT_STREAM_STATUS_STOP_SUCCESS:5,INJECT_STREAM_STATUS_STOP_NOT_FOUND:6,INJECT_STREAM_STATUS_STOP_UNAUTHORIZED:7,INJECT_STREAM_STATUS_STOP_TIMEDOUT:8,INJECT_STREAM_STATUS_STOP_FAILED:9,INJECT_STREAM_STATUS_BROKEN:10},d={WS_DISCONNECT:"WS_DISCONNECT"};t.default={FAILED:"FAILED",INVALID_KEY:"INVALID_KEY",INVALID_CLIENT_MODE:"INVALID_CLIENT_MODE",INVALID_CLIENT_CODEC:"INVALID_CLIENT_CODEC",CLIENT_MODE_CODEC_MISMATCH:"CLIENT_MODE_CODEC_MISMATCH",WEB_API_NOT_SUPPORTED:"WEB_API_NOT_SUPPORTED",INVALID_PARAMETER:"INVALID_PARAMETER",NO_TRACK_IN_STREAM:"NO_TRACK_IN_STREAM",INVALID_OPERATION:"INVALID_OPERATION",INVALID_LOCAL_STREAM:"INVALID_LOCAL_STREAM",INVALID_REMOTE_STREAM:"INVALID_REMOTE_STREAM",INVALID_DYNAMIC_KEY:"INVALID_DYNAMIC_KEY",DYNAMIC_KEY_TIMEOUT:"DYNAMIC_KEY_TIMEOUT",NO_VOCS_AVAILABLE:"NO_VOCS_AVAILABLE",NO_VOS_AVAILABLE:"ERR_NO_VOS_AVAILABLE",JOIN_CHANNEL_TIMEOUT:"ERR_JOIN_CHANNEL_TIMEOUT",NO_AVAILABLE_CHANNEL:"NO_AVAILABLE_CHANNEL",LOOKUP_CHANNEL_TIMEOUT:"LOOKUP_CHANNEL_TIMEOUT",LOOKUP_CHANNEL_REJECTED:"LOOKUP_CHANNEL_REJECTED",OPEN_CHANNEL_TIMEOUT:"OPEN_CHANNEL_TIMEOUT",OPEN_CHANNEL_REJECTED:"OPEN_CHANNEL_REJECTED",REQUEST_DEFERRED:"REQUEST_DEFERRED",STREAM_ALREADY_PUBLISHED:"STREAM_ALREADY_PUBLISHED",STREAM_NOT_YET_PUBLISHED:"STREAM_NOT_YET_PUBLISHED",JOIN_TOO_FREQUENT:"JOIN_TOO_FREQUENT",SOCKET_ERROR:"SOCKET_ERROR",SOCKET_DISCONNECTED:"SOCKET_DISCONNECTED",PEERCONNECTION_FAILED:"PEERCONNECTION_FAILED",CONNECT_GATEWAY_ERROR:"CONNECT_GATEWAY_ERROR",SERVICE_NOT_AVAILABLE:"SERVICE_NOT_AVAILABLE",JOIN_CHANNEL_FAILED:"JOIN_CHANNEL_FAILED",PUBLISH_STREAM_FAILED:"PUBLISH_STREAM_FAILED",UNPUBLISH_STREAM_FAILED:"UNPUBLISH_STREAM_FAILED",SUBSCRIBE_STREAM_FAILED:"SUBSCRIBE_STREAM_FAILED",UNSUBSCRIBE_STREAM_FAILED:"UNSUBSCRIBE_STREAM_FAILED",NO_SUCH_REMOTE_STREAM:"NO_SUCH_REMOTE_STREAM",ERR_FAILED:"1",ERR_INVALID_VENDOR_KEY:"101",ERR_INVALID_CHANNEL_NAME:"102",WARN_NO_AVAILABLE_CHANNEL:"103",WARN_LOOKUP_CHANNEL_TIMEOUT:"104",WARN_LOOKUP_CHANNEL_REJECTED:"105",WARN_OPEN_CHANNEL_TIMEOUT:"106",WARN_OPEN_CHANNEL_REJECTED:"107",WARN_REQUEST_DEFERRED:"108",ERR_DYNAMIC_KEY_TIMEOUT:"109",ERR_INVALID_DYNAMIC_KEY:"110",ERR_NO_VOCS_AVAILABLE:"2000",ERR_NO_VOS_AVAILABLE:"2001",ERR_JOIN_CHANNEL_TIMEOUT:"2002",IOS_NOT_SUPPORT:"IOS_NOT_SUPPORT",WECHAT_NOT_SUPPORT:"WECHAT_NOT_SUPPORT",SHARING_SCREEN_NOT_SUPPORT:"SHARING_SCREEN_NOT_SUPPORT",STILL_ON_PUBLISHING:"STILL_ON_PUBLISHING",LOW_STREAM_ALREADY_PUBLISHED:"LOW_STREAM_ALREADY_PUBLISHED",LOW_STREAM_NOT_YET_PUBLISHED:"LOW_STREAM_ALREADY_PUBLISHED",HIGH_STREAM_NOT_VIDEO_TRACE:"HIGH_STREAM_NOT_VIDEO_TRACE",NOT_FIND_DEVICE_BY_LABEL:"NOT_FIND_DEVICE_BY_LABEL",ENABLE_DUALSTREAM_FAILED:"ENABLE_DUALSTREAM_FAILED",DISABLE_DUALSTREAM_FAILED:"DISABLE_DUALSTREAM_FAILED",PLAYER_NOT_FOUND:"PLAYER_NOT_FOUND",ELECTRON_NOT_SUPPORT_SHARING_SCREEN:"ELECTRON_NOT_SUPPORT_SHARING_SCREEN",BAD_ENVIRONMENT:"BAD_ENVIRONMENT",LOAD_AUDIO_FAILED:"LOAD_AUDIO_FAILED"}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n(0);var r=function(e,t,n){if(["End2EndDelay","TransportDelay","PacketLossRate","RecvLevel","RecvBitrate","CodecType","MuteState","TotalFreezeTime","TotalPlayDuration","RecordingLevel","SendLevel","SamplingRate","SendBitrate","CodecType","MuteState","End2EndDelay","TransportDelay","PacketLossRate","RecvBitrate","RecvResolutionWidth","RecvResolutionHeight","RenderResolutionHeight","RenderResolutionWidth","RenderFrameRate","TotalFreezeTime","TotalPlayDuration","TargetSendBitrate","SendFrameRate","SendFrameRate","SendBitrate","SendResolutionWidth","SendResolutionHeight","CaptureResolutionHeight","CaptureResolutionWidth","EncodeDelay","MuteState","TotalFreezeTime","TotalDuration","CaptureFrameRate","RTT","OutgoingAvailableBandwidth","Duration","UserCount","SendBytes","RecvBytes","SendBitrate","RecvBitrate","accessDelay","audioSendBytes","audioSendPackets","videoSendBytes","videoSendPackets","videoSendPacketsLost","videoSendFrameRate","audioSendPacketsLost","videoSendResolutionWidth","videoSendResolutionHeight","accessDelay","audioReceiveBytes","audioReceivePackets","audioReceivePacketsLost","videoReceiveBytes","videoReceivePackets","videoReceivePacketsLost","videoReceiveFrameRate","videoReceiveDecodeFrameRate","videoReceiveResolutionWidth","videoReceiveResolutionHeight","endToEndDelay","videoReceiveDelay","audioReceiveDelay","FirstFrameTime","VideoFreezeRate","AudioFreezeRate","RenderResolutionWidth","RenderResolutionHeight","VideoPublishDuration","AudioPublishDuration"].indexOf(t)>-1&&("string"==typeof n||isFinite(n)))return e[t]=""+n},i=function(e){var t={};return e.forEach((function(e){e.id&&e.type&&(-1===e.id.indexOf("send")&&-1===e.type.toLowerCase().indexOf("outbound")&&-1===e.id.indexOf("outbound_rtp")&&-1===e.id.indexOf("OutboundRTP")||("audio"===e.mediaType?(r(t,"audioSendBytes",e.bytesSent),r(t,"audioSendPackets",e.packetsSent),r(t,"audioSendPacketsLost",e.packetsLost)):(r(t,"videoSendBytes",e.bytesSent),r(t,"videoSendPackets",e.packetsSent),r(t,"videoSendPacketsLost",e.packetsLost),r(t,"videoSendFrameRate",e.googFrameRateSent),r(t,"videoSendResolutionWidth",e.googFrameWidthSent),r(t,"videoSendResolutionHeight",e.googFrameHeightSent))))})),t},o=function(e){var t={};return e.forEach((function(e){e.id&&e.type&&(-1===e.id.indexOf("recv")&&-1===e.type.toLowerCase().indexOf("inbound")&&-1===e.id.indexOf("inbound_rtp")&&-1===e.id.indexOf("inbound-rtp")&&-1===e.id.indexOf("InboundRTP")||("audio"===e.mediaType?(r(t,"audioReceiveBytes",e.bytesReceived),r(t,"audioReceivePackets",e.packetsReceived),r(t,"audioReceivePacketsLost",e.packetsLost)):(r(t,"videoReceiveBytes",e.bytesReceived),r(t,"videoReceivePacketsLost",e.packetsLost),r(t,"videoReceivePackets",e.packetsReceived),r(t,"videoReceiveFrameRate",e.googFrameRateReceived),r(t,"videoReceiveDecodeFrameRate",e.googFrameRateDecoded),r(t,"videoReceiveResolutionWidth",e.googFrameWidthReceived),r(t,"videoReceiveResolutionHeight",e.googFrameHeightReceived))))})),t}},function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n.apply(this,arguments)}e.exports=n},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return u}));var r=n(0),i=function(){var e={dispatcher:{}};return e.dispatcher.eventListeners={},e.addEventListener=function(t,n){void 0===e.dispatcher.eventListeners[t]&&(e.dispatcher.eventListeners[t]=[]),e.dispatcher.eventListeners[t].push(n)},e.hasListeners=function(t){return!(!e.dispatcher.eventListeners[t]||!e.dispatcher.eventListeners[t].length)},e.on=e.addEventListener,e.removeEventListener=function(t,n){var r;e.dispatcher.eventListeners[t]&&-1!==(r=e.dispatcher.eventListeners[t].indexOf(n))&&e.dispatcher.eventListeners[t].splice(r,1)},e.dispatchEvent=function(t){var n;for(n in e.dispatcher.eventListeners[t.type])if(e.dispatcher.eventListeners[t.type]&&e.dispatcher.eventListeners[t.type].hasOwnProperty(n)&&"function"==typeof e.dispatcher.eventListeners[t.type][n])try{e.dispatcher.eventListeners[t.type][n](t)}catch(n){r.default.debug("[".concat(e.clientId,"] Error in ").concat(t.type," event"),n)}},e.dispatchSocketEvent=function(t){var n;for(n in e.dispatcher.eventListeners[t.type])e.dispatcher.eventListeners[t.type]&&e.dispatcher.eventListeners[t.type].hasOwnProperty(n)&&"function"==typeof e.dispatcher.eventListeners[t.type][n]&&e.dispatcher.eventListeners[t.type][n](t.msg)},e},o=function(e){var t={};return t.type=e.type,t},a=function(e){var t=o(e);return t.stream=e.stream,t.reason=e.reason,t.msg=e.msg,t},s=function(e){var t=o(e);return t.uid=e.uid,t.attr=e.attr,t.stream=e.stream,t},c=function(e){var t=o(e);return t.msg=e.msg,t},u=function(e){var t=o(e);return t.url=e.url,t.uid=e.uid,t.status=e.status,t.reason=e.reason,t}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=s(n(69)),u=n(2),d=s(n(0)),l=n(3),f=n(14),p=n(10),h=function(e){function t(t,n){var r=e.call(this)||this;return r._state=b.RELAY_STATE_IDLE,r._onStatus=function(e){d.default.debug("["+r.clientId+"] ChannelMediaStatus: "+JSON.stringify(e)),e&&e.command&&("onAudioPacketReceived"===e.command&&r.emit("event",y.PACKET_RECEIVED_AUDIO_FROM_SRC),"onVideoPacketReceived"===e.command&&r.emit("event",y.PACKET_RECEIVED_VIDEO_FROM_SRC),"onSrcTokenPrivilegeDidExpire"===e.command&&(r._state=b.RELAY_STATE_FAILURE,r.emit("state",b.RELAY_STATE_FAILURE,S.SRC_TOKEN_EXPIRED)),"onDestTokenPrivilegeDidExpire"===e.command&&(r._state=b.RELAY_STATE_FAILURE,r.emit("state",b.RELAY_STATE_FAILURE,S.DEST_TOKEN_EXPIRED,e.channelName?{came:e.channelName}:null)))},r._onClose=function(){return o(r,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:if(d.default.debug("["+this.clientId+"] ChannelMediaSocket onClose"),this.emit("event",y.NETWORK_DISCONNECTED),this.state=b.RELAY_STATE_IDLE,!this._prevChannelMediaConfig)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.startChannelMediaRelay(this._prevChannelMediaConfig)];case 2:return t.sent(),[3,4];case 3:return(e=t.sent())instanceof _&&(e.message===g.WS_ABORT||e.message===g.AP_REQUEST_ABORT)?[2]:(this.emit("state",b.RELAY_STATE_FAILURE,S.SERVER_CONNECTION_LOST),[3,4]);case 4:return[2]}}))}))},r.token=t.appId,r.appId=t.appId,r.cname=t.cname,r.uid=t.uid,r.sid=t.sid,r.clientId=n,r}return i(t,e),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(e){var t=this._state;this._state=e,t!==e&&this.emit("state",e)},enumerable:!0,configurable:!0}),t.prototype.startChannelMediaRelay=function(e){return o(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:if(this.state!==b.RELAY_STATE_IDLE)throw new _(g.BAD_STATE);return this.state=b.RELAY_STATE_CONNECTING,[4,this._connect()];case 1:return t.sent(),d.default.debug("["+this.clientId+"] startChannelMediaRelay: connect success"),[4,this._sendStartRelayMessage(e)];case 2:return t.sent(),this._prevChannelMediaConfig=e,[2]}}))}))},t.prototype.updateChannelMediaRelay=function(e){return o(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:if(this.state!==b.RELAY_STATE_RUNNING)throw new _(g.BAD_STATE);return[4,this._sendUpdateMessage(e)];case 1:return t.sent(),this._prevChannelMediaConfig=e,[2]}}))}))},t.prototype.stopChannelMediaRelay=function(){return o(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this._sendStopRelayMessage()];case 1:return e.sent(),d.default.debug("["+this.clientId+"] stopChannelMediaRelay: send stop message success"),this.state=b.RELAY_STATE_IDLE,this.dispose(),[2]}}))}))},t.prototype.dispose=function(){d.default.debug("["+this.clientId+"] disposeChannelMediaRelay"),this.state=b.RELAY_STATE_IDLE,this.emit("dispose"),this._signal&&this._signal.dispose(),this._prevChannelMediaConfig=null,this.removeEvent()},t.prototype._requestOneAP=function(e){var t=this;return new Promise((function(n,r){var i={command:"convergeAllocateEdge",sid:t.sid,appId:t.appId,token:"",ts:+new Date,version:u.VERSION,cname:t.cname,uid:t.uid+"",seq:1,requestId:1},o={service_name:"tele_channel",json_body:JSON.stringify(i)},a="https://"+e;f.post(a,o,(function(e){var t=null,i=null;try{t=JSON.parse(e)}catch(e){r(new _(g.AP_JSON_PARSE_ERROR,e))}0!==t.code&&r(new _(g.AP_REQUEST_ERROR,t));try{i=JSON.parse(t.json_body)}catch(e){r(new _(g.AP_JSON_PARSE_ERROR,e))}200!==i.code&&r(new _(g.AP_REQUEST_ERROR,i)),i.servers?n(i.servers):r(new _(g.AP_JSON_PARSE_ERROR,i))}),(function(e){return r(e)}),{"X-Packet-Service-Type":0,"X-Packet-URI":61})}))},t.prototype._requestAP=function(){var e=this,t=u.getParameter("UAP_AP");return new Promise((function(n,r){setTimeout((function(){r(new _(g.AP_REQUEST_TIMEOUT))}),5e3),e.on("dispose",(function(){r(new _(g.AP_REQUEST_ABORT))})),t.forEach((function(t){t+="/api/v1",e._requestOneAP(t).then((function(r){d.default.debug("["+e.clientId+"] startChannelMediaRelay request AP "+t+" success: "+JSON.stringify(r));var i=r[0],o="wss://"+i.address.replace(/\./g,"-")+".edge.agora.io:"+i.wss;n(o)})).catch((function(n){d.default.debug("["+e.clientId+"] startChannelMediaRelay request AP "+t+" failed: "+JSON.stringify(n))}))}))}))},t.prototype._connectWebsocket=function(e){return this._signal=new E(this.appId,this.cname,this.uid,this.sid),this._signal.connect(e)},t.prototype._connect=function(){return o(this,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return[4,this._requestAP()];case 1:return e=t.sent(),[4,this._connectWebsocket(e)];case 2:return t.sent(),this._signal.on("close",this._onClose.bind(this)),this._signal.on("status",this._onStatus.bind(this)),this.emit("event",y.NETWORK_CONNECTED),[2]}}))}))},t.prototype._sendStartRelayMessage=function(e){return o(this,void 0,void 0,(function(){var t,n,r,i,o,s;return a(this,(function(a){switch(a.label){case 0:return this._checkSignal(),t=this._genMessage(v.StopPacketTransfer),[4,this._signal.request(t)];case 1:return a.sent(),[4,this._signal.waitStatus("Normal Quit")];case 2:return a.sent(),d.default.debug("["+this.clientId+"] startChannelMediaRelay: StopPacketTransfer success"),n=this._genMessage(v.SetSdkProfile,e),[4,this._signal.request(n)];case 3:return a.sent(),d.default.debug("["+this.clientId+"] startChannelMediaRelay: SetSdkProfile success"),r=this._genMessage(v.SetSourceChannel,e),[4,this._signal.request(r)];case 4:return a.sent(),[4,this._signal.waitStatus("SetSourceChannelStatus")];case 5:return a.sent(),this.emit("event",y.PACKET_JOINED_SRC_CHANNEL),d.default.debug("["+this.clientId+"] startChannelMediaRelay: SetSourceChannel success"),i=this._genMessage(v.SetSourceUserId,e),[4,this._signal.request(i)];case 6:return a.sent(),d.default.debug("["+this.clientId+"] startChannelMediaRelay: SetSourceUserId success"),o=this._genMessage(v.SetDestChannel,e),[4,this._signal.request(o)];case 7:return a.sent(),[4,this._signal.waitStatus("SetDestChannelStatus")];case 8:return a.sent(),this.emit("event",y.PACKET_JOINED_DEST_CHANNEL),d.default.debug("["+this.clientId+"] startChannelMediaRelay: SetDestChannel success"),s=this._genMessage(v.StartPacketTransfer,e),[4,this._signal.request(s)];case 9:return a.sent(),this.emit("event",y.PACKET_SENT_TO_DEST_CHANNEL),this.state=b.RELAY_STATE_RUNNING,d.default.debug("["+this.clientId+"] startChannelMediaRelay: StartPacketTransfer success"),[2]}}))}))},t.prototype._sendReconnectMessage=function(e){return o(this,void 0,void 0,(function(){var t;return a(this,(function(n){switch(n.label){case 0:return this._checkSignal(),t=this._genMessage(v.Reconnect,e),[4,this._signal.request(t)];case 1:return n.sent(),[2]}}))}))},t.prototype._sendUpdateMessage=function(e){return o(this,void 0,void 0,(function(){var t;return a(this,(function(n){switch(n.label){case 0:return this._checkSignal(),t=this._genMessage(v.UpdateDestChannel,e),[4,this._signal.request(t)];case 1:return n.sent(),this.emit("event",y.PACKET_UPDATE_DEST_CHANNEL),d.default.debug("["+this.clientId+"] sendUpdateMessage: UpdateDestChannel success"),[2]}}))}))},t.prototype._sendStopRelayMessage=function(){return o(this,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return this._checkSignal(),e=this._genMessage(v.StopPacketTransfer),[4,this._signal.request(e)];case 1:return t.sent(),d.default.debug("["+this.clientId+"] sendStopRelayMessage: StopPacketTransfer success"),[2]}}))}))},t.prototype._genMessage=function(e,t){var n=this,r=[],i=[],o=[],a={appId:this.appId,cname:this.cname,uid:this.uid+"",sdkVersion:u.VERSION,sid:this.sid,ts:+new Date,requestId:0,seq:0,allocate:!0,clientRequest:{}},s=null;switch(e){case v.SetSdkProfile:return a.clientRequest={command:"SetSdkProfile",type:"multi_channel"},a;case v.SetSourceChannel:return s=t.getSrcChannelMediaInfo(),a.clientRequest={command:"SetSourceChannel",uid:s.uid+"",channelName:s.channelName,token:s.token||this.appId},a;case v.SetSourceUserId:return s=t.getSrcChannelMediaInfo(),a.clientRequest={command:"SetSourceUserId",uid:this.uid+""},a;case v.SetDestChannel:return t.getDestChannelMediaInfos().forEach((function(e){r.push(e.channelName),i.push(e.uid+""),o.push(e.token||n.appId)})),a.clientRequest={command:"SetDestChannel",channelName:r,uid:i,token:o},a;case v.StartPacketTransfer:return a.clientRequest={command:"StartPacketTransfer"},a;case v.Reconnect:return a.clientRequest={command:"Reconnect"},a;case v.StopPacketTransfer:return a.clientRequest={command:"StopPacketTransfer"},a;case v.UpdateDestChannel:return t.getDestChannelMediaInfos().forEach((function(e){r.push(e.channelName),i.push(e.uid+""),o.push(e.token||n.appId)})),a.clientRequest={command:"UpdateDestChannel",channelName:r,uid:i,token:o},a}},t.prototype._checkSignal=function(){if(!this._signal||!this._signal.isConnect())throw new _(g.WS_DISCONNECTED)},t}(c.default);t.default=h;var m=function(){function e(){this.destChannelMediaInfos=new Map}return e.prototype.setSrcChannelInfo=function(e){l.checkValidObject(e,"srcInfo");var t=e.uid,n=e.channelName,r=e.token;if(r&&!l.isValidToken(r))throw new Error("Invalid token in SrcChannelInfo");if(!l.isValidChannelName(n))throw new Error("Invalid channelName in SrcChannelInfo");if(!p.is32Uint(t))throw new Error("Invalid uid in SrcChannelInfo");this.srcChannelMediaInfo=e},e.prototype.setDestChannelInfo=function(e,t){if(!l.isValidChannelName(e))throw new Error("Invalid channelName in DestChannelInfo");l.checkValidObject(t,"destInfo");var n=t.uid,r=t.token,i=t.channelName;if(r&&!l.isValidToken(r))throw new Error("Invalid token in DestChannelInfo");if(!l.isValidChannelName(i))throw new Error("Invalid channelName in DestChannelInfo");if(!p.is32Uint(n))throw new Error("Invalid uid in DestChannelInfo");this.destChannelMediaInfos.set(e,t)},e.prototype.removeDestChannelInfo=function(e){if(!l.isValidChannelName(e))throw new Error("Invalid channelName when invoke removeDestChannelInfo");this.destChannelMediaInfos.delete(e)},e.prototype.getSrcChannelMediaInfo=function(){return this.srcChannelMediaInfo},e.prototype.getDestChannelMediaInfos=function(){return this.destChannelMediaInfos},e}();t.ChannelMediaRelayConfiguration=m;var g,v,y,b,S,E=function(e){function t(t,n,r,i){var o=e.call(this)||this;return o._onOpen=function(){o.emit("open")},o._onClose=function(e){o.emit("close"),o.dispose()},o._onMessage=function(e){var t=JSON.parse(e.data);if(!t||"serverResponse"!==t.command||!t.requestId)return t&&"serverStatus"===t.command&&t.serverStatus&&t.serverStatus.command?(o.emit("status",t.serverStatus),void o.emit(t.serverStatus.command,t.serverStatus)):void 0;o.emit("req_"+t.requestId,t)},o._requestId=1,o.appId=t,o.cname=n,o.uid=r,o.sid=i,o}return i(t,e),t.prototype.isConnect=function(){return this._ws&&this._ws.readyState===WebSocket.OPEN},t.prototype.sendMessage=function(e){if(!this._ws||this._ws.readyState!==WebSocket.OPEN)throw new _(g.WS_DISCONNECTED);var t=this._requestId++;return e.requestId=t,e.seq=t,this._ws.send(JSON.stringify(e)),t},t.prototype.waitStatus=function(e){var t=this;return new Promise((function(n,r){var i=window.setTimeout((function(){r(new _(g.WAIT_STATUS_TIMEOUT,e))}),5e3);t.once(e,(function(t){clearTimeout(i),t.state&&0!==t.state?r(new _(g.WAIT_STATUS_ERROR,e)):n()})),t.once("dispose",(function(){clearTimeout(i),r(new _(g.WS_ABORT))}))}))},t.prototype.request=function(e){var t=this;return new Promise((function(n,r){var i=t.sendMessage(e),o=window.setTimeout((function(){t.removeAllListeners("req_"+i),r(new _(g.REQUEST_TIMEOUT))}),3e3);t.once("req_"+i,(function(e){clearTimeout(o),e&&200===e.code?n(e):r(new _(g.REQUEST_FAILED,e))})),t.once("dispose",(function(){clearTimeout(o),r(new _(g.WS_ABORT))}))}))},t.prototype.connect=function(e){var t=this;return new Promise((function(n,r){t._ws=new WebSocket(e),t._ws.onopen=function(){t._onOpen(),t._prvUrl=e,t._ws.onmessage=t._onMessage,t._ws.onclose=t._onClose,t._startHeartBeatCheck(),n()},t._ws.onclose=function(e){t._ws=null,r(new _(g.CONNECT_FAILED,"websocket error code: "+e.code))},setTimeout((function(){t._ws&&t._ws.readyState!==WebSocket.OPEN&&(t._ws.onopen=null,t._ws.onclose=null,t._ws.close(),t._ws=null,r(new _(g.CONNECT_TIMEOUT)))}),5e3),t.once("dispose",(function(){r(new _(g.WS_ABORT))}))}))},t.prototype.dispose=function(){this._clearHeartBeatCheck(),this.emit("dispose"),this.removeEvent(),this._ws&&(this._ws.onopen=null,this._ws.onclose=null,this._ws.onmessage=null,this._ws.close()),this._ws=null},t.prototype._sendPing=function(e){if(!this._ws||this._ws.readyState!==WebSocket.OPEN)throw new _(g.WS_DISCONNECTED);var t=this._requestId++;return e.requestId=t,this._ws.send(JSON.stringify(e)),t},t.prototype._startHeartBeatCheck=function(){var e=this;this._heartBeatTimer=window.setInterval((function(){e._sendPing({command:"ping",appId:e.appId,cname:e.cname,uid:e.uid+"",sid:e.sid,ts:+new Date,requestId:0})}),3e3)},t.prototype._clearHeartBeatCheck=function(){window.clearInterval(this._heartBeatTimer)},t}(c.default),_=function(e,t,n){void 0===e&&(e=""),this.code=n,this.data=t,this.message=e};t.ChannelMediaError=_,function(e){e.CONNECT_FAILED="connect failed",e.CONNECT_TIMEOUT="connect timeout",e.WS_DISCONNECTED="websocket disconnected",e.REQUEST_TIMEOUT="request timeout",e.REQUEST_FAILED="request failed",e.WAIT_STATUS_TIMEOUT="wait status timeout",e.WAIT_STATUS_ERROR="wait status error",e.BAD_STATE="bad state",e.WS_ABORT="ws abort",e.AP_REQUEST_TIMEOUT="AP request timeout",e.AP_JSON_PARSE_ERROR="AP json parse error",e.AP_REQUEST_ERROR="AP request error",e.AP_REQUEST_ABORT="AP request abort"}(g=t.CHANNEL_MEDIA_ERROR||(t.CHANNEL_MEDIA_ERROR={})),function(e){e[e.SetSdkProfile=0]="SetSdkProfile",e[e.SetSourceChannel=1]="SetSourceChannel",e[e.SetSourceUserId=2]="SetSourceUserId",e[e.SetDestChannel=3]="SetDestChannel",e[e.StartPacketTransfer=4]="StartPacketTransfer",e[e.StopPacketTransfer=5]="StopPacketTransfer",e[e.UpdateDestChannel=6]="UpdateDestChannel",e[e.Reconnect=7]="Reconnect",e[e.SetVideoProfile=8]="SetVideoProfile"}(v||(v={})),function(e){e[e.NETWORK_DISCONNECTED=0]="NETWORK_DISCONNECTED",e[e.NETWORK_CONNECTED=1]="NETWORK_CONNECTED",e[e.PACKET_JOINED_SRC_CHANNEL=2]="PACKET_JOINED_SRC_CHANNEL",e[e.PACKET_JOINED_DEST_CHANNEL=3]="PACKET_JOINED_DEST_CHANNEL",e[e.PACKET_SENT_TO_DEST_CHANNEL=4]="PACKET_SENT_TO_DEST_CHANNEL",e[e.PACKET_RECEIVED_VIDEO_FROM_SRC=5]="PACKET_RECEIVED_VIDEO_FROM_SRC",e[e.PACKET_RECEIVED_AUDIO_FROM_SRC=6]="PACKET_RECEIVED_AUDIO_FROM_SRC",e[e.PACKET_UPDATE_DEST_CHANNEL=7]="PACKET_UPDATE_DEST_CHANNEL",e[e.PACKET_UPDATE_DEST_CHANNEL_REFUSED=8]="PACKET_UPDATE_DEST_CHANNEL_REFUSED",e[e.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE=9]="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE"}(y=t.CHANNEL_MEDIA_RELAY_EVENT||(t.CHANNEL_MEDIA_RELAY_EVENT={})),function(e){e[e.RELAY_STATE_IDLE=0]="RELAY_STATE_IDLE",e[e.RELAY_STATE_CONNECTING=1]="RELAY_STATE_CONNECTING",e[e.RELAY_STATE_RUNNING=2]="RELAY_STATE_RUNNING",e[e.RELAY_STATE_FAILURE=3]="RELAY_STATE_FAILURE"}(b=t.CHANNEL_MEDIA_RELAY_STATE||(t.CHANNEL_MEDIA_RELAY_STATE={})),function(e){e[e.RELAY_OK=0]="RELAY_OK",e[e.SERVER_ERROR_RESPONSE=1]="SERVER_ERROR_RESPONSE",e[e.SERVER_NO_RESPONSE=2]="SERVER_NO_RESPONSE",e[e.NO_RESOURCE_AVAILABLE=3]="NO_RESOURCE_AVAILABLE",e[e.FAILED_JOIN_SRC=4]="FAILED_JOIN_SRC",e[e.FAILED_JOIN_DEST=5]="FAILED_JOIN_DEST",e[e.FAILED_PACKET_RECEIVED_FROM_SRC=6]="FAILED_PACKET_RECEIVED_FROM_SRC",e[e.FAILED_PACKET_SENT_TO_DEST=7]="FAILED_PACKET_SENT_TO_DEST",e[e.SERVER_CONNECTION_LOST=8]="SERVER_CONNECTION_LOST",e[e.INTERNAL_ERROR=9]="INTERNAL_ERROR",e[e.SRC_TOKEN_EXPIRED=10]="SRC_TOKEN_EXPIRED",e[e.DEST_TOKEN_EXPIRED=11]="DEST_TOKEN_EXPIRED",e[e.RELAY_ALREADY_START=12]="RELAY_ALREADY_START",e[e.RELAY_NOT_START=13]="RELAY_NOT_START",e[e.OPERATION_ABORT=14]="OPERATION_ABORT"}(S=t.CHANNEL_MEDIA_RELAY_ERROR||(t.CHANNEL_MEDIA_RELAY_ERROR={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"isLiveTranscodingValid",(function(){return S})),n.d(t,"generateSessionId",(function(){return v})),n.d(t,"audioLevelHelper",(function(){return h})),n.d(t,"vsResHack",(function(){return y})),n.d(t,"is32Uint",(function(){return b})),n.d(t,"safeCall",(function(){return l})),n.d(t,"random",(function(){return _})),n.d(t,"popBanTip",(function(){return I})),n.d(t,"lengthInUtf8Bytes",(function(){return T})),n.d(t,"audioTimerLoop",(function(){return R})),n.d(t,"generateId",(function(){return g})),n.d(t,"uint8ArrayToBase64",(function(){return f})),n.d(t,"base64ToUint8Array",(function(){return p}));var r=n(11),i=n.n(r),o=n(4),a=n(0),s=n(28),c=n.n(s),u=n(25),d=n(15),l=function(){var e=arguments[0];if("function"==typeof e){var t=Array.prototype.slice.call(arguments,1);e.apply(null,t)}},f=function(e){for(var t="",n=0;n<e.length;n+=1)t+=String.fromCharCode(e[n]);return window.btoa(t)},p=function(e){for(var t=window.atob(e),n=new Uint8Array(new ArrayBuffer(t.length)),r=0;r<t.length;r+=1)n[r]=t.charCodeAt(r);return n},h=function(e){return this.audioContext=Object(u.a)(),this.sourceNode=e.otWebkitAudioSource||this.audioContext.createMediaStreamSource(e),this.analyser=this.audioContext.createAnalyser(),this.timeDomainData=new Uint8Array(this.analyser.frequencyBinCount),this.sourceNode.connect(this.analyser),this.getAudioLevel=function(){if(this.analyser){this.analyser.getByteTimeDomainData(this.timeDomainData);for(var e=0,t=0;t<this.timeDomainData.length;t++)e=Math.max(e,Math.abs(this.timeDomainData[t]-128));return e/128}return a.default.warning("can't find analyser in audioLevelHelper"),0},this},m=1e4;function g(){return++m}function v(){return c()().replace(/-/g,"").toUpperCase()}var y=function(e,t,n){try{a.default.debug("start vsResHack",e);var r=document.createElement("video");r.setAttribute("autoplay",""),r.setAttribute("muted",""),r.muted=!0,r.setAttribute("playsinline",""),r.setAttribute("style","position: absolute; top: 0; left: 0; width:1px; high:1px;"),document.body.appendChild(r);var i=!1;r.addEventListener("playing",(function(n){o.isFireFox()?r.videoWidth&&(i=!0,a.default.debug("[vsResHack] get stream resolution: ","".concat(r.videoWidth," x ").concat(r.videoHeight),e),t(r.videoWidth,r.videoHeight),r.srcObject=null,r.remove()):(i=!0,a.default.debug("[vsResHack] get stream resolution: ","".concat(r.videoWidth," x ").concat(r.videoHeight),e),t(r.videoWidth,r.videoHeight),r.srcObject=null,r.remove())})),Object(d.setSrcObject)(r,e),r.play().catch((function(){})),setTimeout((function(){!i&&r&&(t(r.videoWidth,r.videoHeight),r.srcObject=null,r.remove())}),4e3)}catch(e){n(e)}},b=function(e){return"number"==typeof e&&0<=e&&e<=4294967295},S=function(e){var t=["lowLatency","userConfigExtraInfo","transcodingUsers"];for(var n in e)if("lowLatency"===n&&"boolean"!=typeof e[n]||"userConfigExtraInfo"===n&&"object"!==i()(e[n])||"transcodingUsers"===n&&!E(e[n])||!~t.indexOf(n)&&"number"!=typeof e[n])throw new Error("Param ["+n+"] is inValid");return!0},E=function(e){for(var t=0;t<e.length;t++)for(var n in e[t])if("number"!=typeof e[t][n])throw new Error("Param user["+t+"] - ["+n+"] is inValid");return!0},_=function(e){isNaN(e)&&(e=1e3);var t=+new Date,n=(t=(9301*t+49297)%233280)/233280;return Math.ceil(n*e)},T=function(e){var t=encodeURIComponent(e).match(/%[89ABab]/g);return e.length+(t?t.length:0)},R=function(e,t){var n=1/t,r=Object(u.a)(),i=r.createGain();i.gain.value=0,i.connect(r.destination);var o=!1;return function t(){var a=r.createOscillator();a.onended=t,a.connect(i),a.start(0),a.stop(r.currentTime+n),e(r.currentTime),o&&(a.onended=function(){})}(),function(){o=!0}},I=function(){if(!document.getElementById("agora-ban-tip")){var e=document.createElement("div");e.id="agora-ban-tip",e.style="position: absolute; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; color: #fff;",document.querySelector("body").prepend(e);var t=document.createElement("div");t.style="background: #000; width: 346px; height: 116px; z-index: 100000; opacity: 0.6; border-radius: 10px; box-shadow: 0 2px 4px #000;",e.append(t);var n=document.createElement("div");n.style="height: 76px; display: flex; justify-content: center; align-items: center;";var r=document.createElement("span");r.style="height: 28px; width: 28px; color: #000; text-align: center; line-height: 30px; background: #fff; border-radius: 50%; font-weight: 600; font-size: 20px;margin-right: 5px;",r.innerText="!";var i=document.createElement("span");i.innerText="This browser does not support webRTC",n.append(r),n.append(i);var o=document.createElement("div");o.style="height: 38px; display: flex; border-top: #fff 1px solid; justify-content: center; align-items: center;",o.innerText="OK",t.append(n),t.append(o),o.onclick=function(){var e=document.getElementById("agora-ban-tip");e.parentNode.removeChild(e)}}}},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(e,t,n){e.exports=n(64)},function(t,n,r){"use strict";var i=r(12),o=r.n(i),a=r(17),s=r.n(a),c=r(11),u=r.n(c),d=r(32),l=r.n(d),f=r(7),p=r.n(f),h=r(22),m=r(8),g=function(e){e&&e.apply(this,[].slice.call(arguments,1))},v=r(0),y=r(1),b=r(10),S=r(14),E=r(2),_=function(e){var t=Object(m.b)(e);t.needReconnect=!0,t.isTimeout=!1,t.isInit=!0,t.sendbytes=0,t.recvbytes=0,t.startTime=Date.now(),t.lastMsgTime=null,t.clientId=e.clientId,t.hostIndex=0,t.requestID=0,e.host instanceof Array?t.host=e.host:t.host=[e.host],t.getSendBytes=function(){return t.sendbytes},t.getRecvBytes=function(){return t.recvbytes},t.getDuration=function(){return Math.ceil((Date.now()-t.startTime)/1e3)},t.getURL=function(){return t.connection.url},t.reconnect=function(){t.isInit=!0,t.creatConnection()},t.connectNext=function(){t.isInit=!0,++t.hostIndex,v.default.debug("["+t.clientId+"] Gateway length:"+t.host.length+" current index:"+t.hostIndex),t.hostIndex>=t.host.length?t.dispatchEvent(Object(m.d)({type:"recover"})):t.creatConnection()},t.replaceHost=function(e){t.host=e||t.host,t.hostIndex=0,t.creatConnection()},t.creatConnection=function(){t.needReconnect=!0,t.lts=(new Date).getTime(),t.connection=new WebSocket("wss://"+t.host[t.hostIndex]),t.connection.binaryType="arraybuffer",t.turnConfig={};var n=e.proxyServerType;if(t.connection.url&&3!==n&&4!==n&&5!==n){var r=t.connection.url.match(/wss\:\/\/([^:]+):(\d+)/),i=t.host[t.hostIndex].split(":"),o=t.connection.url.match(/h=([^:]+)&p=(\d+)/);r?(t.turnConfig.url=r[1],Object(E.getParameter)("TURN_ENABLE_TCP")&&(t.turnConfig.tcpport=parseInt(r[2])+30),Object(E.getParameter)("TURN_ENABLE_UDP")&&(t.turnConfig.udpport=parseInt(r[2])+30)):o?(t.turnConfig.url=o[1],Object(E.getParameter)("TURN_ENABLE_TCP")&&(t.turnConfig.tcpport=parseInt(o[2])+30),Object(E.getParameter)("TURN_ENABLE_UDP")&&(t.turnConfig.udpport=parseInt(o[2])+30)):i&&(t.turnConfig.url=i[0],Object(E.getParameter)("TURN_ENABLE_TCP")&&(t.turnConfig.tcpport=parseInt(i[1])+30),Object(E.getParameter)("TURN_ENABLE_UDP")&&(t.turnConfig.udpport=parseInt(i[1])+30))}t.connection.onopen=function(e){t.needReconnect=!0,t.isTimeout=!1,t.isInit=!1,t.sendbytes=0,t.recvbytes=0,t.startTime=Date.now(),Object(S.resetHTTPByetsCount)(),clearTimeout(t.timeoutCheck),t.dispatchEvent(Object(m.d)({type:"onopen",event:e,socket:t}))},t.connection.onmessage=function(e){if(e.data instanceof ArrayBuffer)t.dispatchEvent({type:"onBinaryData",data:e.data});else{t.recvbytes+=Object(b.lengthInUtf8Bytes)(e.data);var n=JSON.parse(e.data);t.lastMsgTime=Date.now(),n.hasOwnProperty("_id")?t.dispatchEvent(Object(m.d)({type:n._id,msg:n})):n.hasOwnProperty("_type")&&t.dispatchSocketEvent(Object(m.d)({type:n._type,msg:n._message}))}},t.connection.onclose=function(n){t.needReconnect?t.isTimeout||t.isInit?(v.default.debug("["+t.clientId+"] websockect connect timeout"),y.report.joinGateway(e.sid,{lts:t.lts,succ:!1,ec:"timeout",addr:t.connection.url}),t.connectNext()):(t.dispatchEvent(Object(m.d)({type:"disconnect",event:n})),t.requests&&t.requests instanceof Array&&(t.requests.map((function(e){e.callback("REQUEST_ABORT")})),t.requests=[])):(v.default.debug("["+t.clientId+"] websockect closeed"),g(e.onFailure,n),clearTimeout(t.timeoutCheck),t.dispatchEvent(Object(m.d)({type:"close",event:n})),t.connection.onopen=void 0,t.connection.onclose=void 0,t.connection.onerror=void 0,t.connection.onmessage=void 0,t.connection=void 0)},t.connection.onerror=function(e){},setTimeout((function(){t.connection&&t.connection.readyState!=WebSocket.OPEN&&(t.isTimeout=!0,t.connection.close())}),5e3)},t.creatConnection(),t.sendMessage=function(e,n){if(t.connection&&t.connection.readyState==WebSocket.OPEN){var r=JSON.stringify(e);t.sendbytes+=Object(b.lengthInUtf8Bytes)(r),t.connection.send(r)}else n({error:"Gateway not connected"})},t.disconnect=function(){t.needReconnect=!0,t.connection.close()},t.close=function(){t.needReconnect=!1,t.connection.onclose=void 0,t.connection.close(),clearInterval(t.requestTimer),t.requests&&t.requests instanceof Array&&(t.requests.map((function(e){e.callback("REQUEST_ABORT")})),t.requests=[])},t.sendSignalCommand=function(e,n){e._id="_request_"+t.requestID,t.requestID+=1,"publish_stats"!==e._type&&"subscribe_stats"!==e._type&&"publish_stats_low"!==e._type&&t.on(e._id,(function(r){r.msg&&n&&n(r.msg._result,r.msg.message),delete t.dispatcher.eventListeners[e._id]})),t.sendMessage(e,(function(e){e.reason="NOT_CONNECTED",n&&n(e.reason,e)}))},t.requests=[];var n=function(e){var n=t.requests.findIndex((function(t){return t.id===e.type}));if(n>=0)var r=t.requests.splice(n,1)[0];r&&t.dispatcher.eventListeners[e.type]?(delete t.dispatcher.eventListeners[e.type],e.msg&&r.callback&&r.callback(e.msg._result,e.msg._message)):v.default.warning("Detached Response",e.type,e.msg)},r=function(e){var n=this,r=t.requests.findIndex((function(e){return e.id===n.id}));r>=0&&(n=t.requests.splice(r,1)[0]),n&&t.dispatcher.eventListeners[e.type]?(delete t.dispatcher.eventListeners[e.type],e.reason="NOT_CONNECTED",n.callback&&n.callback(e.reason,e)):v.default.warning("handleSendError",n)};return t.sendRequest=function(e,i){e=p()({_id:"_request_"+t.requestID},e),t.requestID+=1;var o={id:e._id,timeoutCounter:0,stalledAt:Date.now(),message:e,callback:i};t.requests.push(o),t.addEventListener(e._id,n),t.sendMessage(e,r.bind(o))},t.checkRequestTimeout=function(){for(var e=Math.ceil(Object(E.getParameter)("SIGNAL_REQUEST_TIMEOUT")/Object(E.getParameter)("SIGNAL_REQUEST_WATCH_INTERVAL")),n=t.requests.length-1;n>=0;n--){var r=t.requests[n];r.timeoutCounter>=e?(t.requests.splice(n,1),v.default.error("Request Timeout",r.timeoutCounter,r.message),r.callback&&r.callback("TIMEOUT")):r.timeoutCounter++}},clearInterval(t.requestTimer),t.requestTimer=setInterval(t.checkRequestTimeout,Object(E.getParameter)("SIGNAL_REQUEST_WATCH_INTERVAL")),t.sendReport=function(e){t.sendMessage(e,(function(){}))},t},T=function(e,t){var n={connect:function(){t.host=e,n.signal=_(t),n.on=n.signal.on,n.dispatchEvent=n.signal.dispatchEvent,n.signal.on("onopen",(function(e){n.signal.onEvent=function(e){n.dispatchEvent(Object(m.d)({type:e.event,msg:e}))},n.dispatchEvent(Object(m.d)({type:"connect",msg:e}))})),n.signal.on("onError",(function(e){var t=e.msg;onError(t.code,"error")}))},getLastMsgTime:function(){return n.signal&&n.signal.lastMsgTime},getSendBytes:function(){return n.signal.getSendBytes()},getRecvBytes:function(){return n.signal.getRecvBytes()},getDuration:function(){return n.signal.getDuration()},disconnect:function(){n.signal.disconnect()},close:function(){n.signal.close()},getURL:function(){return n.signal.getURL()},reconnect:function(){n.signal.reconnect()},connectNext:function(){n.signal.connectNext()},replaceHost:function(e){n.signal.replaceHost(e)},emitSimpleMessage:function(e,t){n.signal.sendSignalCommand(e,t)},emitRequest:function(e,t){n.signal.sendRequest(e,t)},emitReport:function(e){n.signal.sendReport(e)}};return n.connect(),n},R=r(23),I=r(5),w=r(20),C=r(4),O={ERR_NO_VOCS_AVAILABLE:"tryNext",ERR_NO_VOS_AVAILABLE:"tryNext",ERR_JOIN_CHANNEL_TIMEOUT:"tryNext",WARN_REPEAT_JOIN:"quit",ERR_JOIN_BY_MULTI_IP:"recover",WARN_LOOKUP_CHANNEL_TIMEOUT:"tryNext",WARN_OPEN_CHANNEL_TIMEOUT:"tryNext",ERR_VOM_SERVICE_UNAVAILABLE:"tryNext",ERR_TOO_MANY_USERS:"tryNext",ERR_MASTER_VOCS_UNAVAILABLE:"tryNext",ERR_INTERNAL_ERROR:"tryNext",K_SERVICE_NOT_READY:"tryNext",K_SERVICE_TOO_HEAVY:"tryNext",notification_test_recover:"recover",notification_test_tryNext:"tryNext",notification_test_retry:"retry"},A={googActualEncBitrate:"A_aeb",googAvailableSendBandwidth:"A_asb",googRetransmitBitrate:"A_rb",googAvailableReceiveBandwidth:"A_arb",googTargetEncBitrate:"A_teb",googBucketDelay:"A_bd",googTransmitBitrate:"A_tb",googCodecName:"A_cn",bytesSent:"bytesSent",packetsLost:"packetsLost",packetsSent:"packetsSent",googAdaptationChanges:"A_ac",googAvgEncodeMs:"A_aem",googEncodeUsagePercent:"A_eup",googFirsReceived:"A_fr",googFrameHeightInput:"A_fhi",googFrameHeightSent:"A_fhs",googFrameRateInput:"A_fri",googFrameRateSent:"A_frs",googFrameWidthInput:"A_fwi",googFrameWidthSent:"A_fws",googNacksReceived:"A_nr",googPlisReceived:"A_pr",googRtt:"A_rtt",aecDivergentFilterFraction:"A_adff",audioInputLevel:"A_ail",googEchoCancellationReturnLoss:"A_ecrl",googEchoCancellationReturnLossEnhancement:"A_ecrle",googResidualEchoLikelihood:"A_rel",googResidualEchoLikelihoodRecentMax:"A_relrm",googTargetDelayMs:"A_tdm",bytesReceived:"bytesReceived",packetsReceived:"packetsReceived",googDecodeMs:"A_dm",googMaxDecodeMs:"A_mdm",googRenderDelayMs:"A_rdm",googFrameWidthReceived:"A_fwr",googFrameHeightReceived:"A_fhr",googFrameRateReceived:"A_frr",googFrameRateDecoded:"A_frd",googFrameRateOutput:"A_fro",googJitterBufferMs:"A_jbm",googCurrentDelayMs:"A_cdm",googMinPlayoutDelayMs:"A_mpdm",googNacksSent:"A_ns",googPlisSent:"A_ps",googFirsSent:"A_fs",audioOutputLevel:"A_aol",googAccelerateRate:"A_ar",googDecodingCNG:"A_dcng",googDecodingCTN:"A_dctn",googDecodingCTSG:"A_dctsg",googDecodingNormal:"A_dn",googDecodingPLC:"A_dplc",googDecodingPLCCNG:"A_dplccng",googExpandRate:"A_er",googJitterReceived:"A_jr",googPreemptiveExpandRate:"A_per",googPreferredJitterBufferMs:"A_pjbm",googSecondaryDecodedRate:"A_sdr",googSpeechExpandRate:"A_ser",uplink_fraction_lost:"B_ufl",uplink_cumulative_lost:"B_ucl",uplink_available_bandwidth:"B_uab",period_fir:"B_fir",access_delay:"B_acd",uplink_network_quality:"B_unq",downlink_network_quality:"B_dnq",pub_audio_lost_ratio_400ms:"B_palr4",pub_video_lost_ratio_400ms:"B_pvlr4",e2e_delay:"B_ed",audio_delay:"B_ad",video_delay:"B_vd",stream_type:"B_st",e2e_audio_lost_ratio_400ms:"B_ealr4",e2e_video_lost_ratio_400ms:"B_evlr4",downlink_estimate_bandwidth:"B_deb",peer_publish_audio_duration:"B_ppad",peer_publish_video_duration:"B_ppvd"},x={};for(var k in A){var N=A[k];x[N]&&v.default.error("Key Conflict: ".concat(N,": ").concat(A[N],"| ").concat(k)),x[N]=k}var L=function(e){return A[e]||e},M=function(e){return x[e]||e},V=r(9),P=r.n(V),D=r(54),Z=function t(n){var r=!1,i=function(e){return{_type:"control",_message:e}},a=function(e,t){var n={};return Object.keys(t).forEach((function(e){Object(E.getParameter)("STATS_FILTER")[e]||(n[L(e)]=t[e])})),{_type:"subscribe_related_stats",_message:{stream_type:"high",stream_id:e,stats:n}}},c=function(e){return{_type:"publish",_message:e}},d=function(e,t){var n={};return Object.keys(t).forEach((function(e){Object(E.getParameter)("STATS_FILTER")[e]||(n[L(e)]=t[e])})),{_type:"subscribe_stats",_message:{stream_id:e,stats:n}}},f=t.DISCONNECTED,S=t.CONNECTING,_=t.CONNECTED,A=t.DISCONNECTING,x=f,k=Object(m.b)(n);Object.defineProperty(k,"state",{set:function(e){var n=x;x=e,Object(w._setClientConnectionStateRecord)(k.clientId,e),e!==t.CONNECTED&&e!==t.DISCONNECTING&&(k.hasJoined=!1),n!==e&&k.dispatchEvent({type:"connection-state-change",prevState:t.connetionStateMap[n],curState:t.connetionStateMap[e]})},get:function(){return x}}),k.socket=void 0,k.state=f,k.mode=n.mode,k.role=n.role,k.codec=n.codec,k.config={},k.timers={},k.timer_counter={},k.localStreams={},k.remoteStreams={},k.remoteMuteState={},k.attemps=1,k.p2p_attemps=1,k.audioLevel={},k.activeSpeaker=void 0,k.reconnectMode="tryNext",k.rejoinAttempt=0,k.hasChangeBGPAddress=!1,k.traffic_stats={},k.clientId=n.clientId,k.pingpongCounter=0,k.hasInvokeLeave=!1,k.p2ps=new Map,k.liveStreams=new Map,k.injectLiveStreams=new Map,k.remoteStreamsInChannel=new Set,k.subscribeRequestId=new Map,k.publishRequestId=0,k.hasJoined=!1,k.isFirstSuccess=!0,k.peerPublishDurationMap=new Map,function(e){var t=g;e.makeRequest=function(n,r,i){if(void 0===e.socket)return v.default.debug("[".concat(e.clientId,"] No socket available")),void t(i,I.default.INVALID_OPERATION);try{e.socket.emitRequest(n,(function(e,t){var n;"success"===e?"function"==typeof r&&r(t):"function"==typeof i&&(n=t&&t.error_code&&I.GatewayErrorCode[t.error_code]?I.GatewayErrorCode[t.error_code]:t&&t.error_str?t.error_str:t&&t.error_code?"UNKNOW_ERROR_".concat(t.error_code):e,i(n,t))}))}catch(r){v.default.debug("[".concat(e.clientId,"] Socket emit message failed ").concat(JSON.stringify(n))),v.default.debug("[".concat(e.clientId,"] "),r),t(i,I.default.SOCKET_ERROR)}},e.makeReport=function(t){void 0===e.socket&&v.default.debug("[".concat(e.clientId,"] No socket available"));try{e.socket.emitReport(t)}catch(n){v.default.debug("[".concat(e.clientId,"] Socket emit report failed ").concat(JSON.stringify(t)))}}}(k),k.inChannelInfo={joinAt:null,duration:0},k._sendMessage=function(e,t){switch(e){case"SubscribeStats":k.makeReport(d.apply(void 0,l()(t)));break;case"SubscribeRelatedStats":k.makeReport(a.apply(void 0,l()(t)))}};var N=g;k.p2pCounter=Object(b.random)(1e5),k.generateP2PId=function(){return++k.p2pCounter},k.audioVolumeIndication={enabled:!1,sortedAudioVolumes:[],smooth:3,interval:2e3},k.remoteVideoStreamTypes={REMOTE_VIDEO_STREAM_HIGH:0,REMOTE_VIDEO_STREAM_LOW:1,REMOTE_VIDEO_STREAM_MEDIUM:2},k.streamFallbackTypes={STREAM_FALLBACK_OPTION_DISABLED:0,STREAM_FALLBACK_OPTION_VIDEO_STREAM_LOW:1,STREAM_FALLBACK_OPTION_AUDIO_ONLY:2},k.configPublisher=function(e){k.config=e},k.getGatewayInfo=function(e,t){k.makeRequest({_type:"gateway_info"},e,t)},k.setClientRole=function(e,t){v.default.debug("[".concat(k.clientId,"] setClientRole to ").concat(e));var n=y.report.reportApiInvoke(k.joinInfo.sid,{name:"_setClientRole",callback:t});k.makeRequest({_type:"set_client_role",_message:{role:e}},(function(){k.role=e,k.dispatchEvent({type:"client-role-changed",role:e}),n&&n(null,{role:e})}),(function(t,r){if(r&&r.code&&(t=I.GatewayErrorCode[r.code]||"UNKNOW_ERROR_"+r.code),"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE"===t)return n&&n(null);v.default.error("set Client role error to "+e+": "+t),n&&n(t)}))},k.join=function(e,t,r,i){k.hasInvokeLeave=!1,e.useProxyServer&&(k.hasChangeBGPAddress=!0);var o=(new Date).getTime(),a=e.uid;if(k.inChannelInfo.joinAt&&(k.inChannelInfo.duration+=o-k.inChannelInfo.joinAt),k.inChannelInfo.joinAt=o,k.state!==S)return v.default.error("[".concat(k.clientId,"] GatewayClient.join Failed: state "),k.state),i&&i(I.default.INVALID_OPERATION),void y.report.joinGateway(e.sid,{lts:o,succ:!1,ec:I.default.INVALID_OPERATION,addr:null});if(null!=a&&parseInt(a)!==a)return v.default.error("[".concat(k.clientId,"] Input uid is invalid")),k.state=f,i&&i(I.default.INVALID_PARAMETER),void y.report.joinGateway(e.sid,{lts:o,succ:!1,ec:I.default.INVALID_PARAMETER,addr:null});var s=j.register(k,{uid:a,cname:e&&e.cname});if(s)return k.state=f,i&&i(s),void y.report.joinGateway(e.sid,{lts:o,succ:!1,ec:s,addr:null});k.joinInfo=p()({},e),k.uid=a,k.key=t,k.pingpongCounter=0,F(e,(function(t){if(e.useLocalAccessPoint)try{var s=k.socket.signal.connection.url.match(/wss\:\/\/([^:]+):(\d+)/)[1];Object(E.setParameter)("EVENT_REPORT_DOMAIN",s),Object(E.setParameter)("EVENT_REPORT_BACKUP_DOMAIN",s),Object(E.setParameter)("LOG_UPLOAD_SERVER","".concat(s,":6444"))}catch(e){v.default.debug("[".concat(k.clientId,"] LocalAccessPoint error: ").concat(e))}if(k.state===A||k.state===f)return i&&i("LEAVE_BEFORE_JOIN_SUCCESS");k.state=_,v.default.debug("[".concat(k.clientId,"] Connected to gateway server")),clearInterval(k.pingTimer),k.pingTimer=setInterval((function(){var e=Object(E.getParameter)("PING_PONG_TIME_OUT");if(++k.pingpongCounter>=e){var t=Date.now();k.socket&&v.default.warning("PINGPONG Timeout. Last Socket Message: ".concat(t-k.socket.getLastMsgTime(),"ms")),k.socket&&k.socket.getLastMsgTime()&&t-k.socket.getLastMsgTime()>Object(E.getParameter)("WEBSOCKET_TIMEOUT_MIN")&&(k.pingpongCounter=0,k.socket.close(),k.socket.dispatchEvent(Object(m.d)({type:"disconnect",event:{msg:"PING_PONG_TIME_OUT"}})))}var n=Date.now();k.makeRequest({_type:"ping"},(function(){k.pingpongCounter=0;var e=Date.now()-n;Object(E.getParameter)("REPORT_STATS")&&k.makeRequest({_type:"ping_back",_message:{pingpongElapse:e}})}),(function(e,t){"TIMEOUT"!==e&&(v.default.error("Ping Error ".concat(e," ").concat(JSON.stringify(t))),t&&t.error_code&&k.socket&&k.socket.signal&&k.socket.signal.connection&&k.socket.signal.connection.readyState===WebSocket.OPEN&&(v.default.info("Disconnecting websocket connection"),k.socket.signal.connection.close()))}))}),3e3),function(e,t){var r=e.role,i=p()({},k.joinInfo.apResponse),o={session_id:k.joinInfo.sid,app_id:n.appId,channel_key:k.key,channel_name:k.joinInfo.cname,sdk_version:E.VERSION,browser:navigator.userAgent,process_id:Object(y.getProcessId)(),mode:k.mode,codec:k.codec,role:r,has_changed_gateway:Object(E.getParameter)("FORCE_CHANGED_GATEWAY_FLAG")||k.hasChangeBGPAddress,ap_response:i,optionalInfo:k.joinInfo.optionalInfo,extend:Object(E.getParameter)("JOIN_EXTEND"),details:{}};if(k.joinInfo.hasOwnProperty("stringUid")&&(o.string_uid=k.joinInfo.stringUid),k.socket&&k.socket.signal&&k.socket.signal&&(i.addresses&&i.addresses[k.socket.signal.hostIndex]&&(o.ap_response.ticket=i.addresses[k.socket.signal.hostIndex].ticket,delete i.addresses),Object(E.getParameter)("SET_DEFAULT_TURNSERVER")&&k.socket.signal.turnConfig)){var a={username:k.joinInfo.uid.toString(),credential:k.joinInfo.token,forceturn:Object(E.getParameter)("FORCE_TURN")};a.url=k.socket.signal.turnConfig.url,k.socket.signal.turnConfig.tcpport&&(a.tcpport=""+k.socket.signal.turnConfig.tcpport),k.socket.signal.turnConfig.udpport&&(a.udpport=""+k.socket.signal.turnConfig.udpport),k.joinInfo.turnServers.find((function(e){if(e.url===a.url)return!0}))||k.joinInfo.turnServers.push(a)}3===k.joinInfo.proxyServerType&&(o.plugin="web_cloud_proxy",o.details.cservice_map="1"),k.joinInfo.aesmode&&k.joinInfo.aespassword?(o.aes_mode=k.joinInfo.aesmode,o.aes_encrypt=!0,k.joinInfo.aes_salt&&(o.aes_salt=k.joinInfo.aes_salt),Object(D.encryptRSA)(k.joinInfo.aespassword).then((function(e){o.aes_secret=e,k.dispatchEvent({type:"join-message-hook",joinMessage:o}),t(null,{_type:"join",_message:o})})).catch((function(e){v.default.error("[".concat(k.clientId,"] encrypt password failed "),e),t("ENCRYPT_PASSWORD_FAILED")}))):(k.dispatchEvent({type:"join-message-hook",joinMessage:o}),t(null,{_type:"join",_message:o}))}({role:k.role},(function(t,n){if(t)return i&&i(t);k.makeRequest(n,(function(t){if(y.report.joinGateway(e.sid,{lts:o,succ:!0,ec:null,vid:e.vid,uid:e.uid,addr:k.socket.getURL(),firstSuccess:k.isFirstSuccess}),k.joinSuccessLts=Date.now(),k.isFirstSuccess=!1,k.rejoinAttempt=0,k.hasJoined=!0,r&&r(t.uid),!0===t.return_vosip||!0===Object(E.getParameter)("ENABLE_LIVE_SERVER_LIST")){var n=null;try{n=k.socket.signal.connection.url}catch(e){v.default.debug("[".concat(k.clientId,"] Can not get gateway ip: ").concat(e))}n?Object(E.setParameter)("LIVE_SERVER_LIST",[n]):Object(E.setParameter)("LIVE_SERVER_LIST",[])}k.dispatchEvent({type:"join"}),clearInterval(k.timers.trafficStats),k.timers.trafficStats=setInterval((function(){k.makeRequest({_type:"traffic_stats"},(function(e){var t={};for(var n in e)t[M(n)]=e[n];if(t.peer_delay&&t.peer_delay.length){var r=[];t.peer_delay.forEach((function(e){var t={};for(var n in e)t[M(n)]=e[n];r.push(t)})),t.peer_delay=r}k.traffic_stats=t,k.traffic_stats.timestamp=Date.now();var i=k.joinInfo.stringUid,o=k.localStreams[a]||k.localStreams[i];o&&(o.traffic_stats={access_delay:t.access_delay}),t.peer_delay&&t.peer_delay.forEach((function(e){var n=k.remoteStreams[e.peer_uid];n&&(n.traffic_stats={access_delay:t.access_delay,e2e_delay:e.e2e_delay,audio_delay:e.audio_delay,video_delay:e.video_delay})})),k.dispatchEvent({type:"after-getTrafficStats",trafficStats:t})}))}),3e3)}),(function(t,n){if(v.default.error("[".concat(k.clientId,"] User join failed [").concat(t,"]")),"ERR_JOIN_BY_MULTI_IP"===t){try{y.report.joinGateway(e.sid,{lts:o,succ:!1,ec:"ERR_JOIN_BY_MULTI_IP",addr:k.socket.getURL()})}catch(e){}return k.dispatchEvent({type:"onMultiIP",option:n.option})}O[t]&&k.rejoinAttempt<4?k._doWithAction(O[t],r,i):i&&i(t),y.report.joinGateway(e.sid,{lts:o,succ:!1,ec:t,addr:k.socket&&k.socket.getURL()})}))}))}),(function(t){v.default.error("[".concat(k.clientId,"] User join failed [").concat(t,"]")),i&&i(t),y.report.joinGateway(e.sid,{lts:o,succ:!1,ec:t,addr:k.socket.getURL()})})),this.remoteMuteState={},k.resetAudioVolumeIndication()},k.leave=function(e,t){var n=j.unregister(k);switch(n&&v.default.debug("[".concat(k.clientId,"] "),n),k.p2ps.clear(),k.state){case f:return v.default.debug("[".concat(k.clientId,"] Client Already in DISCONNECTED status")),void N(e);case A:return v.default.debug("[".concat(k.clientId,"] Client Already in DISCONNECTING status")),void N(t,I.default.INVALID_OPERATION);case S:return k.socket&&k.socket.close(),k.socket=void 0,v.default.info("[".concat(k.clientId,"] Client connecting, Leave channel success")),k.state=f,e&&e()}for(var r in k.state=A,k.channelMediaConfig&&(k.channelMediaRelayController&&k.channelMediaRelayController.dispose(),k.channelMediaConfig,k.channelMediaRelayController=null),clearInterval(k.pingTimer),k.timers)k.timers.hasOwnProperty(r)&&clearInterval(k.timers[r]);for(var r in k.inChannelInfo.joinAt&&(k.inChannelInfo.duration+=Date.now()-k.inChannelInfo.joinAt,k.inChannelInfo.joinAt=null),k.hasJoined?k.makeRequest({_type:"leave"},(function(t){k.socket.close(),k.socket=void 0,v.default.info("[".concat(k.clientId,"] Leave channel success")),k.state=f,e&&e(t)}),(function(e){"TIMEOUT"!==e&&"REQUEST_ABORT"!==e&&(v.default.error("[".concat(k.clientId,"] Leave Channel Failed"),e),k.state=_,t&&t(e))})):(k.socket&&(k.socket.close(),k.socket=void 0),v.default.info("[".concat(k.clientId,"] Leave channel before joined")),k.state=f,e&&e()),k.localStreams)if(k.localStreams.hasOwnProperty(r)){var i=k.localStreams[r];delete k.localStreams[r],void 0!==i.pc&&(i.pc.close(),i.pc=void 0)}B()},k.publish=function(e,t,n,r){var o=(new Date).getTime(),a=!1;if(e.publishLTS=o,"object"!==u()(e)||null===e)return v.default.error("[".concat(k.clientId,"] Invalid local stream")),r&&r(I.default.INVALID_LOCAL_STREAM),void y.report.publish(k.joinInfo.sid,{lts:o,succ:!1,audio:!1,video:!1,screenshare:!1,audioName:"",videoName:"",screenName:"",ec:I.default.INVALID_LOCAL_STREAM});if(!e.stream&&void 0===e.url)return v.default.error("[".concat(k.clientId,"] Invalid local media stream")),r&&r(I.default.INVALID_LOCAL_STREAM),void y.report.publish(k.joinInfo.sid,{lts:o,succ:!1,audio:!1,video:!1,screenshare:!1,audioName:"",videoName:"",screenName:"",ec:I.default.INVALID_LOCAL_STREAM});if(k.state!==_)return v.default.error("[".concat(k.clientId,"] User is not in the session")),r&&r(I.default.INVALID_OPERATION),void y.report.publish(k.joinInfo.sid,{lts:o,succ:!1,audio:e.hasAudio(),video:e.hasVideo(),screenshare:e.hasScreen(),audioName:e.hasAudio()&&e.audioName,videoName:e.hasVideo()&&e.videoName,screenName:e.hasScreen()&&e.screenName,ec:I.default.INVALID_OPERATION});var s=e.getAttributes()||{};if(e.local&&void 0===k.localStreams[e.getId()]&&(e.hasAudio()||e.hasVideo()||e.hasScreen())){var d=k.generateP2PId();if(k.p2ps.set(d,e),e.p2pId=d,void 0!==e.url)U(c({state:"url",audio:e.hasAudio(),video:e.hasVideo(),attributes:e.getAttributes()},e.url),(function(t,n){"success"===t?(e.getUserId()!==n&&e.setUserId(n),k.localStreams[n]=e,e.onClose=function(){k.unpublish(e)}):v.default.error("[".concat(k.clientId,"] Publish local stream failed"),t)}));else{k.localStreams[e.getId()]=e,e.connectionSpec={callback:function(s){s||r&&r("CANNOT_GET_OFFER"),"motion"===e.optimizationMode&&e.pc.setRtpSenderParameters("maintain-framerate"),"detail"===e.optimizationMode&&e.pc.setRtpSenderParameters("maintain-resolution"),k.makeRequest(c({state:"offer",stream_type:1==t.streamType?"low":"high",p2p_id:d,sdp:s,audio:e.audio||e.screenAudio,video:e.screen||e.video,screen:e.screen,attributes:e.getAttributes(),dtx:e.DTX,hq:e.highQuality,lq:e.lowQuality,stereo:e.stereo,speech:e.speech,codec:k.codec,extend:Object(E.getParameter)("PUB_EXTEND")}),(function(t){e.getUserId()!==t.uid&&e.setUserId(t.uid),v.default.info("[".concat(k.clientId,"] Local stream published with uid"),t.uid),e.onClose=function(){k.unpublish(e)},e._onAudioUnmute=function(){k.makeReport(i({action:"unmute_local_audio",stream_id:e.getId()}))},e._onVideoUnmute=function(){k.makeReport(i({action:"unmute_local_video",stream_id:e.getId()}))},e._onAudioMute=function(){k.makeReport(i({action:"mute_local_audio",stream_id:e.getId()}))},e._onVideoMute=function(){k.makeReport(i({action:"mute_local_video",stream_id:e.getId()}))},e.getId()===e.getUserId()&&(e.isAudioOn()||e.hasAudio()&&(v.default.debug("[".concat(k.clientId,"] local stream audio mute")),e._onAudioMute()),e.isVideoOn()||(e.hasVideo()||e.hasScreen())&&(v.default.debug("[".concat(k.clientId,"] local stream video mute")),e._onVideoMute())),e.pc.oniceconnectionstatechange=function(t){if("failed"===t){if(null!=k.timers[e.getId()]&&(clearInterval(k.timers[e.getId()]),clearInterval(k.timers[e.getId()]+"_RelatedStats")),v.default.error("[".concat(k.clientId,"] Publisher connection is lost -- streamId: ").concat(e.getId(),", p2pId: ").concat(d)),k.p2ps.delete(d),v.default.debug("[".concat(k.clientId,"] publish p2p failed: "),k.p2ps),!a)return a=!0,y.report.publish(k.joinInfo.sid,{lts:o,succ:!1,audio:e.hasAudio(),video:e.hasVideo(),screenshare:e.hasScreen(),audioName:e.hasAudio()&&e.audioName,videoName:e.hasVideo()&&e.videoName,screenName:e.hasScreen()&&e.screenName,ec:I.default.PEERCONNECTION_FAILED,publishRequestid:k.publishRequestId||0,p2pid:d}),k.dispatchEvent(Object(m.a)({type:"pubP2PLost",stream:e})),r&&r(I.default.PEERCONNECTION_FAILED);k.dispatchEvent(Object(m.a)({type:"pubP2PLost",stream:e}))}else if("connected"===t&&(v.default.debug("[".concat(k.clientId,"] publish p2p connected: "),k.p2ps),e.getId()===e.getUserId()&&(e._isAudioMuted()?k.makeReport(i({action:"mute_local_audio",stream_id:e.getId()})):k.makeReport(i({action:"unmute_local_audio",stream_id:e.getId()})),e._isVideoMuted()?k.makeReport(i({action:"mute_local_video",stream_id:e.getId()})):k.makeReport(i({action:"unmute_local_video",stream_id:e.getId()}))),!a))return a=!0,y.report.publish(k.joinInfo.sid,{lts:o,succ:!0,audio:e.hasAudio(),video:e.hasVideo(),screenshare:e.hasScreen(),audioName:e.hasAudio()&&e.audioName,videoName:e.hasVideo()&&e.videoName,screenName:e.hasScreen()&&e.screenName,ec:null,publishRequestid:k.publishRequestId||0,p2pid:d}),n&&n()},e.pc.processSignalingMessage(t.sdp)}),(function(t,n){v.default.error("Publish Failed: ".concat(t)),y.report.publish(k.joinInfo.sid,{lts:o,succ:!1,audio:e.hasAudio(),video:e.hasVideo(),screenshare:e.hasScreen(),audioName:e.hasAudio()&&e.audioName,videoName:e.hasVideo()&&e.videoName,screenName:e.hasScreen()&&e.screenName,ec:t,publishRequestid:k.publishRequestId||0,p2pid:d}),"TIMEOUT"!=t&&(k.processPublishFailure(e),r&&r(t))}))},audio:e.hasAudio(),video:e.hasVideo(),screen:e.hasScreen(),optimizationMode:e.optimizationMode,isSubscriber:!1,stunServerUrl:k.stunServerUrl,turnServers:k.joinInfo.turnServers,maxAudioBW:s.maxAudioBW,minVideoBW:s.minVideoBW,maxVideoBW:s.maxVideoBW,mode:k.mode,codec:k.codec,isVideoMute:e.userMuteVideo||e.peerMuteVideo,isAudioMute:e.userMuteAudio||e.peerMuteAudio,maxFrameRate:e.attributes.maxFrameRate,agoraStream:e,clientId:k.clientId,isCloudProxy3:3===k.joinInfo.proxyServerType,onNoIceCandidate:function(){k.dispatchEvent({type:"no_ice_candidate",stream:e})}},e.pc=Object(R.a)(e.connectionSpec),e.pc.addStream(e.stream),v.default.debug("[".concat(k.clientId,"] PeerConnection add stream :"),e.stream),e.pc.onnegotiationneeded=function(n){"motion"===e.optimizationMode&&e.pc.setRtpSenderParameters("maintain-framerate"),"detail"===e.optimizationMode&&e.pc.setRtpSenderParameters("maintain-resolution");var r={state:"negotiation",stream_type:1===t.streamType?"low":"high",p2p_id:d,sdp:n};k.makeRequest(c(r),(function(t){v.default.debug("Negotating Stream ".concat(e.getId())),e.pc.processSignalingMessage(t.sdp)}),(function(e,t){v.default.error("Negotiation failed ".concat(e),t,r)}))},clearInterval(k.timers[e.getId()]),k.timers[e.getId()]=setInterval((function(){if(Object(E.getParameter)("REPORT_STATS")){var t=0;e&&e.pc&&e.pc.getStats&&e.pc.getStatsRate((function(n){n.forEach((function(n){if(n&&n.id&&!(/_recv$/.test(n.id)||/^time$/.test(n.id)||~n.type.toLowerCase().indexOf("inbound"))&&e.getUserId()){if(-1===n.id.indexOf("outbound_rtp")&&-1===n.id.indexOf("OutboundRTP")&&-1===n.type.toLowerCase().indexOf("outbound")||"video"!==n.mediaType||(n.googFrameWidthSent=e.videoWidth+"",n.googFrameHeightSent=e.videoHeight+""),"video"===n.mediaType)try{var r=e.stream.getVideoTracks()[0];n.A_vstd=r.enabled?"0":"1"}catch(e){}if("audio"===n.mediaType)try{var i=e.stream.getAudioTracks()[0];n.A_astd=i.enabled?"0":"1"}catch(e){}if(e.getId()==e.getUserId()){var o=200*t;t++,setTimeout((function(){var e=k.socket&&k.socket.getLastMsgTime()&&Date.now()-k.socket.getLastMsgTime();e>Object(E.getParameter)("REPORT_STATS_TIMEOUT")?v.default.debug("PublishStats report blocked by REPORT_STATS_TIMEOUT ".concat(e)):k.makeReport(function(e){var t={};return Object.keys(e).forEach((function(n){Object(E.getParameter)("STATS_FILTER")[n]||(t[L(n)]=e[n])})),{_type:"publish_stats",_message:{stream_type:"high",stats:t}}}(n))}),o)}else o=200*t,t++,setTimeout((function(){var e=k.socket&&k.socket.getLastMsgTime()&&Date.now()-k.socket.getLastMsgTime();e>Object(E.getParameter)("REPORT_STATS_TIMEOUT")?v.default.debug("PublishStatsLow report blocked by REPORT_STATS_TIMEOUT ".concat(e)):k.makeReport(function(e){var t={};return Object.keys(e).forEach((function(n){Object(E.getParameter)("STATS_FILTER")[n]||(t[L(n)]=e[n])})),{_type:"publish_stats",_message:{stream_type:"low",stats:t}}}(n))}),o)}}))}))}}),3e3);var l=function(){Object(E.getParameter)("REPORT_STATS")&&e&&e.pc&&e.pc.getVideoRelatedStats&&e.pc.getVideoRelatedStats((function(t){var n,r,i=k.socket&&k.socket.getLastMsgTime()&&Date.now()-k.socket.getLastMsgTime();i>Object(E.getParameter)("REPORT_STATS_TIMEOUT")?v.default.debug("PublishRelatedStats report blocked by REPORT_STATS_TIMEOUT ".concat(i)):e.getId()===e.getUserId()?k.makeReport((n=t,r={},Object.keys(n).forEach((function(e){Object(E.getParameter)("STATS_FILTER")[e]||(r[L(e)]=n[e])})),{_type:"publish_related_stats",_message:{stream_type:"high",stats:r}})):k.makeReport(function(e){var t={};return Object.keys(e).forEach((function(n){Object(E.getParameter)("STATS_FILTER")[n]||(t[L(n)]=e[n])})),{_type:"publish_related_stats",_message:{stream_type:"low",stats:t}}}(t))}))};l(),clearInterval(k.timers[e.getId()+"_RelatedStats"]),k.timers[e.getId()+"_RelatedStats"]=setInterval(l,1e3)}}},k.unpublish=function(e,t,n,r){if("object"!==u()(e)||null===e)return v.default.error("[".concat(k.clientId,"] Invalid local stream")),void N(r,I.default.INVALID_LOCAL_STREAM);if(k.state!==_)return v.default.error("[".concat(k.clientId,"] User not in the session")),void N(r,I.default.INVALID_OPERATION);if(null!=k.timers[e.getId()]&&(clearInterval(k.timers[e.getId()]),clearInterval(k.timers[e.getId()+"_RelatedStats"])),void 0!==k.socket)if(e.local&&void 0!==k.localStreams[e.getId()]){delete k.localStreams[e.getId()];var i={stream_id:e.getUserId(),stream_type:1===t.streamType?"low":"high"};k.makeRequest({_type:"unpublish",_message:i}),(e.hasAudio()||e.hasVideo()||e.hasScreen())&&void 0===e.url&&void 0!==e.pc&&(e.pc.close(),e.pc=void 0),e.onClose=void 0,e._onAudioMute=void 0,e._onAudioUnute=void 0,e._onVideoMute=void 0,e._onVideoUnmute=void 0,k.p2ps.delete(e.p2pId),n&&n()}else v.default.error("[".concat(k.clientId,"] Invalid local stream")),N(r,I.default.INVALID_LOCAL_STREAM);else v.default.error("[".concat(k.clientId,"] User not in the session")),N(r,I.default.INVALID_OPERATION)},k.subscribe=function(e,t,n){var r=(new Date).getTime();e.subscribeLTS=r;var o=!1;if(v.default.info("[".concat(k.clientId,"] Gatewayclient ").concat(k.uid," Subscribe ").concat(e.getId(),": ").concat(JSON.stringify(e.subscribeOptions))),"object"!==u()(e)||null===e)return v.default.error("[".concat(k.clientId,"] Invalid remote stream")),n&&n(I.default.INVALID_REMOTE_STREAM),void y.report.subscribe(k.joinInfo.sid,{lts:r,succ:!1,video:e.subscribeOptions&&e.subscribeOptions.video,audio:e.subscribeOptions&&e.subscribeOptions.audio,peerid:e.getId(),ec:I.default.INVALID_REMOTE_STREAM});if(k.state!==_&&(v.default.error("[".concat(k.clientId,"] User is not in the session")),!o))return o=!0,y.report.subscribe(k.joinInfo.sid,{lts:r,succ:!1,video:e.subscribeOptions&&e.subscribeOptions.video,audio:e.subscribeOptions&&e.subscribeOptions.audio,peerid:e.getId(),ec:I.default.INVALID_OPERATION}),n&&n(I.default.INVALID_OPERATION);if(!e.local&&k.remoteStreams.hasOwnProperty(e.getId()))if(e.hasAudio()||e.hasVideo()||e.hasScreen()){var s=k.generateP2PId();k.p2ps.set(s,e),e.p2pId=s,e.pc=Object(R.a)({callback:function(t){t||n&&n("CANNOT_GET_OFFER");var i={stream_id:e.getId(),audio:!e.subscribeOptions||e.subscribeOptions.audio,video:!e.subscribeOptions||e.subscribeOptions.video,codec:k.codec,p2p_id:s,sdp:t,tcc:Object(E.getParameter)("SUBSCRIBE_TCC"),extend:Object(E.getParameter)("SUB_EXTEND")};k.makeRequest({_type:"subscribe",_message:i},(function(t){e.pc.processSignalingMessage(t.sdp)}),(function(t,i){v.default.error("[".concat(k.clientId,"] Subscribe remote stream Failed: ").concat(t,", closing stream "),e.getId(),i),y.report.subscribe(k.joinInfo.sid,{lts:r,succ:!1,video:e.subscribeOptions&&e.subscribeOptions.video,audio:e.subscribeOptions&&e.subscribeOptions.audio,peerid:e.getId(),ec:t}),"TIMEOUT"!=t&&(k.processSubscribeFailure(e),n&&n(t))}))},nop2p:!0,audio:!0,video:!0,screen:e.hasScreen(),isSubscriber:!0,stunServerUrl:k.stunServerUrl,turnServers:k.joinInfo.turnServers,isVideoMute:e.userMuteVideo,isAudioMute:e.userMuteAudio,uid:e.getId(),agoraStream:e,clientId:k.clientId}),e.pc.onaddstream=function(t,n){if(e._onAudioUnmute=function(){k.makeReport(i({action:"unmute_remote_audio",stream_id:e.getId()}),(function(){}),(function(){}))},e._onAudioMute=function(){k.makeReport(i({action:"mute_remote_audio",stream_id:e.getId()}),(function(){}),(function(){}))},e._onVideoUnmute=function(){k.makeReport(i({action:"unmute_remote_video",stream_id:e.getId()}),(function(){}),(function(){}))},e._onVideoMute=function(){k.makeReport(i({action:"mute_remote_video",stream_id:e.getId()}),(function(){}),(function(){}))},"ontrack"===n&&"video"===t.track.kind||"onaddstream"===n){v.default.info("[".concat(k.clientId,"] Remote stream subscribed with uid "),e.getId());var r=k.remoteStreams[e.getId()];if(k.remoteStreams[e.getId()].stream="onaddstream"===n?t.stream:t.streams[0],k.remoteStreams[e.getId()].hasVideo()){if(Object(C.isFireFox)()||Object(C.isSafari)()){var o=k.remoteStreams[e.getId()].stream;Object(b.vsResHack)(o,(function(t,n){e.videoWidth=t,e.videoHeight=n}),(function(e){return v.default.warning("[".concat(k.clientId,"] vsResHack failed: ")+e)}))}}else{var a=k.remoteStreams[e.getId()];a.peerMuteVideo=!0,k._adjustPCMuteStatus(a)}r&&r.isPlaying()&&r.elementID&&(v.default.debug("[".concat(k.clientId,"] Reload Player ").concat(r.elementID," StreamId ").concat(r.getId())),e.audioOutput=r.audioOutput,r.stop(),e.play(r.elementID,r.playOptions)),delete e.audioLevelHelper;var s=Object(m.e)({type:"stream-subscribed",stream:k.remoteStreams[e.getId()]});k.dispatchEvent(s)}},clearInterval(k.timers[e.getId()]),k.timers[e.getId()]=setInterval((function(){if(Object(E.getParameter)("REPORT_STATS")){var t=0;e&&e.pc&&e.pc.getStats&&e.pc.getStatsRate((function(n){n.forEach((function(n){if(n&&n.id){if(/_send$/.test(n.id)||/^time$/.test(n.id)||/^bweforvideo$/.test(n.id))return;-1===n.id.indexOf("inbound_rtp")&&-1===n.id.indexOf("inbound-rtp")&&-1===n.type.toLowerCase().indexOf("inbound")||"video"!==n.mediaType||(n.googFrameWidthReceived=e.videoWidth+"",n.googFrameHeightReceived=e.videoHeight+"");var r=200*t;t++;var i=e.getId();setTimeout((function(){var t=k.socket&&k.socket.getLastMsgTime()&&Date.now()-k.socket.getLastMsgTime();if(t>Object(E.getParameter)("REPORT_STATS_TIMEOUT"))v.default.debug("SubscribeStats report blocked by REPORT_STATS_TIMEOUT ".concat(t));else{if("video"===n.mediaType)try{var r=e.stream.getVideoTracks()[0];n.A_vrtd=r.enabled?"0":"1",e.player&&e.player.freezeTimeCounterList.length>0&&(n.A_vrft=e.player.freezeTimeCounterList.splice(0,1)[0].toString())}catch(e){}if("audio"===n.mediaType)try{var o=e.stream.getAudioTracks()[0];n.A_artd=o.enabled?"0":"1"}catch(e){}k.makeReport(d(i,n))}}),r)}}))}))}}),3e3),clearInterval(k.timers[e.getId()+"_RelatedStats"]),k.timers[e.getId()+"_RelatedStats"]=setInterval((function(){if(Object(E.getParameter)("REPORT_STATS")&&e&&e.pc){var t=k.socket&&k.socket.getLastMsgTime()&&Date.now()-k.socket.getLastMsgTime();if(t>Object(E.getParameter)("REPORT_STATS_TIMEOUT"))return void v.default.debug("SubscribeRelatedStats report blocked by REPORT_STATS_TIMEOUT ".concat(t));e.pc.getVideoRelatedStats&&e.pc.getVideoRelatedStats((function(t){e.player&&(e.hasVideo()&&!e.peerMuteVideo&&(t.isFreeze=e.player.freezeCount>e.player.lastFreezeCount),e.player.lastFreezeCount=e.player.freezeCount),k.makeReport(a(e.getId(),t))})),e.pc.getAudioRelatedStats&&e.pc.getAudioRelatedStats((function(t){k.makeReport(a(e.getId(),t))}))}}),1e3),k.audioLevel[e.getId()]=0,clearInterval(k.timers[e.getId()+"audio"]),k.timers[e.getId()+"audio"]=setInterval((function(){k.hasListeners("active-speaker")&&e&&e.pc&&"established"===e.pc.state&&e.pc.getStats&&e.pc.getStats((function(t){t.forEach((function(t){if("audio"===t.mediaType){if(t.audioOutputLevel>5e3)for(var n in k.audioLevel[e.getId()]<20&&(k.audioLevel[e.getId()]+=1),k.audioLevel)n!==""+e.getId()&&k.audioLevel[n]>0&&(k.audioLevel[n]-=1);var r=Object.keys(k.audioLevel).sort((function(e,t){return k.audioLevel[t]-k.audioLevel[e]}));if(k.activeSpeaker!==r[0]){var i=Object(m.a)({type:"active-speaker",uid:r[0]});k.dispatchEvent(i),k.activeSpeaker=r[0],v.default.debug("[".concat(k.clientId,"] Update active speaker: ").concat(k.activeSpeaker))}}}))}),50)}),50),e.pc.oniceconnectionstatechange=function(i){if("failed"===i)null!=k.timers[e.getId()]&&(clearInterval(k.timers[e.getId()]),clearInterval(k.timers[e.getId()]+"audio")),v.default.error("[".concat(k.clientId,"] Subscriber connection is lost -- streamId: ").concat(e.getId(),", p2pId: ").concat(s)),v.default.debug("[".concat(k.clientId,"] subscribe p2p failed: "),k.p2ps),o||(o=!0,n&&n(I.default.PEERCONNECTION_FAILED),y.report.subscribe(k.joinInfo.sid,{lts:r,succ:!1,video:e.subscribeOptions&&e.subscribeOptions.video,audio:e.subscribeOptions&&e.subscribeOptions.audio,peerid:e.getId(),ec:I.default.PEERCONNECTION_FAILED,subscribeRequestid:k.subscribeRequestId.get(e.getId())||0,p2pid:s})),k.remoteStreams[e.getId()]&&k.p2ps.has(s)&&(k.p2ps.delete(s),k.dispatchEvent(Object(m.a)({type:"subP2PLost",stream:e})));else if("connected"===i&&(v.default.debug("[".concat(k.clientId,"] subscribe p2p connected: "),k.p2ps),!o)){o=!0,y.report.subscribe(k.joinInfo.sid,{lts:r,succ:!0,video:e.subscribeOptions&&e.subscribeOptions.video,audio:e.subscribeOptions&&e.subscribeOptions.audio,peerid:e.getId(),ec:null,subscribeRequestid:k.subscribeRequestId.get(e.getId())||0,p2pid:s}),k._adjustPCMuteStatus(e);var a=!1,c=!1,u=!1,d=setInterval((function(){a&&c||(e.pc?e.pc.getStats((function(t){t.forEach((function(t){if((-1!==t.id.indexOf("recv")||t.type&&-1!==t.type.toLowerCase().indexOf("inbound")||-1!==t.id.indexOf("inbound_rtp")||-1!==t.id.indexOf("inbound-rtp")||-1!==t.id.indexOf("InboundRTP"))&&"audio"===t.mediaType){if((t.googDecodingNormal>0||t.audioOutputLevel>0)&&!a){a=!0,k.dispatchEvent({type:"first-audio-frame-decode",stream:e}),a&&c&&clearInterval(d);var n=Date.now(),r=y.report.getSessionStartTime(k.joinInfo.sid);y.report.firstAudioDecode(k.joinInfo.sid,{peerid:e.uintId,uid:k.uid,elapse:n-r,subscribeElapse:n-e.subscribeLTS,subscribeRequestid:k.subscribeRequestId.get(e.getId())||0,p2pid:s})}parseInt(t.packetsReceived)>0&&!c&&(c=!0,k.dispatchEvent({type:"first-audio-packet-received",stream:e}),a&&c&&clearInterval(d),n=Date.now(),r=y.report.getSessionStartTime(k.joinInfo.sid),y.report.firstAudioReceived(k.joinInfo.sid,{peerid:e.uintId,uid:k.uid,elapse:n-r,subscribeElapse:n-e.subscribeLTS,subscribeRequestid:k.subscribeRequestId.get(e.getId())||0,p2pid:s}))}}))}),100):clearInterval(d))}),100),l=!1,f=!1,p=setInterval((function(){l&&f||(e.pc?e.pc.getStats((function(t){t.forEach((function(t){if((-1!==t.id.indexOf("recv")||t.type&&-1!==t.type.toLowerCase().indexOf("inbound")||-1!==t.id.indexOf("inbound_rtp")||-1!==t.id.indexOf("inbound-rtp")||-1!==t.id.indexOf("InboundRTP"))&&"video"===t.mediaType){if((t.framesDecoded>0||t.googFramesDecoded>0)&&!l){l=!0,k.dispatchEvent({type:"first-video-frame-decode",stream:e}),l&&f&&clearInterval(p);var n=Date.now(),r=y.report.getSessionStartTime(k.joinInfo.sid);e.firstFrameTime=(new Date).getTime()-e.subscribeLTS,y.report.firstVideoDecode(k.joinInfo.sid,{peerid:e.uintId,width:parseInt(t.googFrameWidthReceived)||0,height:parseInt(t.googFrameHeightReceived)||0,uid:k.uid,elapse:n-r,subscribeElapse:n-e.subscribeLTS,subscribeRequestid:k.subscribeRequestId.get(e.getId())||0,p2pid:s})}t.packetsReceived>0&&!f&&(f=!0,k.dispatchEvent({type:"first-video-packet-received",stream:e}),l&&f&&clearInterval(p),n=Date.now(),r=y.report.getSessionStartTime(k.joinInfo.sid),y.report.firstVideoReceived(k.joinInfo.sid,{peerid:e.uintId,uid:k.uid,elapse:n-r,subscribeElapse:n-e.subscribeLTS,subscribeRequestid:k.subscribeRequestId.get(e.getId())||0,p2pid:s}))}}))}),100):clearInterval(p))}),100),h=setInterval((function(){if(!u){var t=e.getId(),n=k.traffic_stats;if(n&&n.peer_delay){var r=n.peer_delay.find((function(e){return e.peer_uid==t}));if(r){if(u=!0,k.peerPublishDurationMap.get(e.getId()))return void clearInterval(h);var i=r.peer_publish_audio_duration,o=r.peer_publish_video_duration;if(void 0===i||void 0===o)return;k.peerPublishDurationMap.set(e.getId(),!0);var a=y.report.getSessionStartTime(k.joinInfo.sid),s=(i||o)+(Date.now()-n.timestamp),c=Date.now();y.report.peerPublishStatus({audiotag:i?1:-1,videotag:o?1:-1,lts:c,sid:k.joinInfo.sid,cname:k.joinInfo.cname,cid:k.joinInfo.cid,uid:k.joinInfo.uid,elapse:c-a,peer:e.uintId,peerPublishDuration:s,joinChannelSuccessElapse:c-k.joinSuccessLts,subscribeElapse:c-e.subscribeLTS}),clearInterval(h)}}}}),1e3);return e.sid=k.joinInfo.sid,t&&t()}}}else v.default.error("[".concat(k.clientId,"] Invalid remote stream")),o||(o=!0,n&&n(I.default.INVALID_REMOTE_STREAM),y.report.subscribe(k.joinInfo.sid,{lts:r,succ:!1,video:e.subscribeOptions&&e.subscribeOptions.video,audio:e.subscribeOptions&&e.subscribeOptions.audio,peerid:e.getId(),ec:I.default.INVALID_REMOTE_STREAM}));else v.default.error("[".concat(k.clientId,"] No such remote stream")),o||(o=!0,n&&n(I.default.NO_SUCH_REMOTE_STREAM),y.report.subscribe(k.joinInfo.sid,{lts:r,succ:!1,video:e.subscribeOptions&&e.subscribeOptions.video,audio:e.subscribeOptions&&e.subscribeOptions.audio,peerid:e.getId(),ec:I.default.NO_SUCH_REMOTE_STREAM}))},k.subscribeChange=function(e,t,n){var r=Date.now();v.default.info("[".concat(k.clientId,"] Gatewayclient ").concat(k.uid," SubscribeChange ").concat(e.getId(),": ").concat(JSON.stringify(e.subscribeOptions))),k._adjustPCMuteStatus(e);var i={stream_id:e.getId(),audio:e.subscribeOptions.audio,video:e.subscribeOptions.video};k.makeRequest({_type:"subscribe_change",_message:i},(function(n){var i=Object(m.e)({type:"stream-subscribe-changed",stream:k.remoteStreams[e.getId()]});y.report.subscribe(k.joinInfo.sid,{lts:r,succ:!0,video:e.subscribeOptions&&e.subscribeOptions.video,audio:e.subscribeOptions&&e.subscribeOptions.audio,peerid:e.getId(),ec:null,subscribeRequestid:k.subscribeRequestId.get(e.getId())||0,p2pid:k.p2ps.get(e.getId())}),k.dispatchEvent(i),t&&t()}),(function(t,r){v.default.error("[".concat(k.clientId,"] Subscribe Change Failed ").concat(e.getId()),t,r),n&&n(t,r)}))},k.processPublishFailure=function(e){e.publishLTS=null,e.p2pId&&k.p2ps.get(e.p2pId)===e&&k.p2ps.delete(e.p2pId),k.localStreams[e.getUserId()]===e&&delete k.localStreams[e.getUserId()],k.localStreams[e.getId()]===e&&delete k.localStreams[e.getId()],e.pc&&(e.pc.processSignalingMessage=function(){},e.pc.oniceconnectionstatechange=function(){},e.pc.close(),delete e.pc),delete e.onClose,delete e._onAudioUnmute,delete e._onVideoUnmute,delete e._onAudioMute,delete e._onVideoMute,delete e._onAudioUnmute},k.processSubscribeFailure=function(e){e.p2pId&&k.p2ps.get(e.p2pId)===e&&k.p2ps.delete(e.p2pId),e.pc&&(e.pc.onaddstream=function(){},e.pc.processSignalingMessage=function(){},e.pc.oniceconnectionstatechange=function(){},e.pc.close(),delete e.pc),delete e.onClose,delete e._onAudioUnmute,delete e._onVideoUnmute,delete e._onAudioMute,delete e._onVideoMute,delete e._onAudioUnmute},k._adjustPCMuteStatus=function(e){v.default.debug("[".concat(k.clientId,"]: use _adjustPCMuteStatus: ").concat(e.getId())),v.default.debug("[".concat(k.clientId,"]: video: ").concat(e.video,", audio: ").concat(e.audio,", suboption: ").concat(JSON.stringify(e.subscribeOptions),",userMuteVideo: ").concat(e.userMuteVideo,", peerMuteVideo: ").concat(e.peerMuteVideo,", userMuteAudio: ").concat(e.userMuteAudio,", peerMuteAudio: ").concat(e.peerMuteAudio)),!e.local&&e.pc&&e.pc.peerConnection.getReceivers&&e.pc.peerConnection.getReceivers().forEach((function(t){if(t&&t.track&&"audio"===t.track.kind){var n=!e.userMuteAudio&&!e.peerMuteAudio;e.subscribeOptions&&!e.subscribeOptions.audio&&(n=!1),v.default.debug("[".concat(k.clientId,"]: set receiver audio track: ").concat(n)),t.track.enabled=!!n}else if(t&&t.track&&"video"===t.track.kind){var r=!e.userMuteVideo&&!e.peerMuteVideo;e.subscribeOptions&&!e.subscribeOptions.video&&(r=!1),v.default.debug("[".concat(k.clientId,"]: set receiver video track: ").concat(r)),t.track.enabled=!!r}}))},k.unsubscribe=function(e,t,n){if("object"!==u()(e)||null===e)return v.default.error("[".concat(k.clientId,"] Invalid remote stream")),void N(n,I.default.INVALID_REMOTE_STREAM);if(k.state!==_)return v.default.error("[".concat(k.clientId,"] User is not in the session")),void N(n,I.default.INVALID_OPERATION);if(null!=k.timers[e.getId()]&&(clearInterval(k.timers[e.getId()]),clearInterval(k.timers[e.getId()]+"audio")),null!=k.audioLevel[e.getId()]&&delete k.audioLevel[e.getId()],null!=k.timer_counter[e.getId()]&&delete k.timer_counter[e.getId()],k.remoteStreams.hasOwnProperty(e.getId())){if(!k.socket)return v.default.error("[".concat(k.clientId,"] User is not in the session")),void N(n,I.default.INVALID_OPERATION);if(e.local)return v.default.error("[".concat(k.clientId,"] Invalid remote stream")),void N(n,I.default.INVALID_REMOTE_STREAM);e.close(),e.stop();var r={stream_id:e.getId()};k.makeRequest({_type:"unsubscribe",_message:r}),void 0!==e.pc&&(e.pc.close(),e.pc=void 0),e.onClose=void 0,e._onAudioMute=void 0,e._onAudioUnute=void 0,e._onVideoMute=void 0,e._onVideoUnmute=void 0,delete e.subscribeOptions,k.p2ps.delete(e.p2pId),v.default.info("[".concat(k.clientId,"] Unsubscribe stream success")),t&&t()}else N(n,I.default.NO_SUCH_REMOTE_STREAM)},k.setRemoteVideoStreamType=function(e,t){if(v.default.debug("[".concat(k.clientId,"] Switching remote video stream ").concat(e.getId()," to ").concat(t)),"object"===u()(e)&&null!==e)if(k.state===_){if(!e.local){switch(t){case k.remoteVideoStreamTypes.REMOTE_VIDEO_STREAM_HIGH:case k.remoteVideoStreamTypes.REMOTE_VIDEO_STREAM_LOW:case k.remoteVideoStreamTypes.REMOTE_VIDEO_STREAM_MEDIUM:break;default:return}var n={stream_id:e.getId(),stream_type:t};k.makeRequest({_type:"switch_video_stream",_message:n},(function(){v.default.debug("SwitchVideoStream Success ".concat(n.stream_id," ").concat(n.stream_type))}),(function(e,t){v.default.error("SwitchVideoStream Error ".concat(e," ").concat(n.stream_id," ").concat(n.stream_type),t)}))}}else v.default.error("[".concat(k.clientId,"] User is not in the session"));else v.default.error("[".concat(k.clientId,"] Invalid remote stream"))},k.renewToken=function(e,t,n){e?k.key?k.state!==_?(v.default.debug("[".concat(k.clientId,"] Client is not connected. Trying to rejoin")),k.key=e,k.rejoin(),t&&t()):(v.default.debug("[".concat(k.clientId,"] renewToken from ").concat(k.key," to ").concat(e)),k.key=e,k.makeRequest({_type:"renew_token",_message:{token:e}},t,n)):(v.default.error("[".concat(k.clientId,"] Client is previously joined without token")),n&&n(I.default.INVALID_PARAMETER)):(v.default.error("[".concat(k.clientId,"] Invalid Token ").concat(e)),n&&n(I.default.INVALID_PARAMETER))},k.setStreamFallbackOption=function(e,t){if(v.default.debug("[".concat(k.clientId,"] Set stream fallback option ").concat(e.getId()," to ").concat(t)),"object"===u()(e)&&null!==e)if(k.state===_){if(!e.local){switch(t){case k.streamFallbackTypes.STREAM_FALLBACK_OPTION_DISABLED:case k.streamFallbackTypes.STREAM_FALLBACK_OPTION_VIDEO_STREAM_LOW:case k.streamFallbackTypes.STREAM_FALLBACK_OPTION_AUDIO_ONLY:break;default:return}var n={stream_id:e.getId(),fallback_type:t};k.makeRequest({_type:"set_fallback_option",_message:n},(function(){v.default.debug("SetStreamFallbackOption success ".concat(n.stream_id," ").concat(t))}),(function(e,r){v.default.error("Failed to SetStreamFallbackOption ".concat(n.stream_id," ").concat(t," ").concat(e),r)}))}}else v.default.error("[".concat(k.clientId,"] User is not in the session"));else v.default.error("[".concat(k.clientId,"] Invalid remote stream"))},k.enableAudioVolumeIndicator=function(e,t){k.audioVolumeIndication.enabled=!0,k.audioVolumeIndication.interval=e,k.audioVolumeIndication.smooth=t,k.resetAudioVolumeIndication()},k.resetAudioVolumeIndication=function(){if(clearInterval(k.timers.audioVolumeIndication),clearInterval(k.timers.audioVolumeSampling),k.audioVolumeIndication.enabled&&k.audioVolumeIndication.interval){var e=Math.floor(1e3*k.audioVolumeIndication.smooth/100);clearInterval(k.timers.audioVolumeSampling),k.timers.audioVolumeSampling=setInterval((function(){k.audioVolumeSampling||(k.audioVolumeSampling={});var t={};for(var n in k.remoteStreams){var r=k.remoteStreams[n];if(r.stream&&r.hasAudio()){var i=r.getAudioLevel();i>0&&i<1&&(i*=100);var o=k.audioVolumeSampling[n]||[];for(o.push(i);o.length>e;)o.shift();t[n]=o}}k.audioVolumeSampling=t}),100),clearInterval(k.timers.audioVolumeIndication),k.timers.audioVolumeIndication=setInterval((function(){if(k.socket&&k.socket.signal&&k.socket.signal.connection&&k.socket.signal.connection.readyState===WebSocket.OPEN){var e=[];for(var t in k.remoteStreams)if(k.audioVolumeSampling&&k.audioVolumeSampling[t]){var n=k.audioVolumeSampling[t],r=0;n.forEach((function(e){r+=e}));var i={uid:t,level:Math.floor(r/n.length)};i.level&&e.push(i)}var o=e.sort((function(e,t){return e.level-t.level}));v.default.debug("[".concat(k.clientId,"] volume-indicator "),JSON.stringify(o)),k.audioVolumeIndication.sortedAudioVolumes=o;var a=Object(m.a)({type:"volume-indicator",attr:o});k.dispatchEvent(a)}}),k.audioVolumeIndication.interval)}},k.closeGateway=function(){v.default.debug("[".concat(k.clientId,"] close gateway")),k.state=f,k.socket.close(),W()},k.startChannelMediaRelay=function(){var e=s()(o.a.mark((function e(t){var n,r,i,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!k.channelMediaRelayController){e.next=2;break}throw new V.ChannelMediaError("RELAY_ALREADY_START","",V.CHANNEL_MEDIA_RELAY_ERROR.RELAY_ALREADY_START);case 2:return n=function(e){k.dispatchEvent({type:"channel-media-relay-event",code:e})},r=function(e,t,n){e===V.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_FAILURE&&t===V.CHANNEL_MEDIA_RELAY_ERROR.SERVER_CONNECTION_LOST&&(k.channelMediaRelayController.dispose(),k.channelMediaRelayController=null),k.dispatchEvent({type:"channel-media-relay-state",state:e,code:t,data:n})},k.channelMediaRelayController=new P.a(k.joinInfo,k.clientId),k.channelMediaRelayController.on("event",n),k.channelMediaRelayController.on("state",r),e.prev=7,e.next=10,k.channelMediaRelayController.startChannelMediaRelay(t);case 10:e.next=22;break;case 12:throw e.prev=12,e.t0=e.catch(7),v.default.debug("[".concat(k.clientId,"] startChannelMediaRelay exception: ").concat(JSON.stringify(e.t0))),i=V.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_FAILURE,a=e.t0 instanceof V.ChannelMediaError?"SetSourceChannelStatus"===e.t0.data||e.t0.data&&e.t0.data.serverResponse&&"SetSourceChannel"===e.t0.data.serverResponse.command?"FAILED_JOIN_SRC":"SetDestChannelStatus"===e.t0.data||e.t0.data&&e.t0.data.serverResponse&&"SetDestChannel"===e.t0.data.serverResponse.command?"FAILED_JOIN_DEST":e.t0.data&&e.t0.data.serverResponse&&"StartPacketTransfer"===e.t0.data.serverResponse.command?"FAILED_PACKET_SENT_TO_DEST":e.t0.message===V.CHANNEL_MEDIA_ERROR.REQUEST_TIMEOUT||e.t0.message===V.CHANNEL_MEDIA_ERROR.WAIT_STATUS_TIMEOUT?"SERVER_NO_RESPONSE":e.t0.message===V.CHANNEL_MEDIA_ERROR.REQUEST_FAILED||e.t0.message===V.CHANNEL_MEDIA_ERROR.WAIT_STATUS_ERROR?"SERVER_ERROR_RESPONSE":e.t0.message===V.CHANNEL_MEDIA_ERROR.AP_REQUEST_TIMEOUT?"NO_RESOURCE_AVAILABLE":e.t0.message===V.CHANNEL_MEDIA_ERROR.WS_ABORT||e.t0.message===V.CHANNEL_MEDIA_ERROR.AP_REQUEST_ABORT?"OPERATION_ABORT":"INTERNAL_ERROR":"INTERNAL_ERROR",k.dispatchEvent({type:"channel-media-relay-state",state:i,code:V.CHANNEL_MEDIA_RELAY_ERROR[a]}),k.channelMediaRelayController&&(k.channelMediaRelayController.dispose(),k.channelMediaConfig=null,k.channelMediaRelayController=null),k.dispatchEvent({type:"channel-media-relay-state",state:V.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_IDLE}),new V.ChannelMediaError(a,null,V.CHANNEL_MEDIA_RELAY_ERROR[a]);case 22:k.dispatchEvent({type:"channel-media-relay-state",state:V.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_RUNNING,code:V.CHANNEL_MEDIA_RELAY_ERROR.RELAY_OK}),k.channelMediaConfig=t;case 24:case"end":return e.stop()}}),e,null,[[7,12]])})));return function(t){return e.apply(this,arguments)}}(),k.updateChannelMediaRelay=function(){var t=s()(o.a.mark((function t(n){var r,i;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(k.channelMediaRelayController){t.next=2;break}throw new V.ChannelMediaError("RELAY_NOT_START",null,V.CHANNEL_MEDIA_RELAY_ERROR.RELAY_NOT_START);case 2:return t.prev=2,t.next=5,k.channelMediaRelayController.updateChannelMediaRelay(n);case 5:t.next=18;break;case 7:throw t.prev=7,t.t0=t.catch(2),v.default.debug("[".concat(k.clientId,"] updateChannelMediaRelay exception: ").concat(JSON.stringify(e))),r=V.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_FAILURE,i=e instanceof V.ChannelMediaError?e.message===V.CHANNEL_MEDIA_ERROR.REQUEST_TIMEOUT||e.message===V.CHANNEL_MEDIA_ERROR.WAIT_STATUS_TIMEOUT?"SERVER_NO_RESPONSE":e.message===V.CHANNEL_MEDIA_ERROR.REQUEST_FAILED||e.message===V.CHANNEL_MEDIA_ERROR.WAIT_STATUS_ERROR?"SERVER_ERROR_RESPONSE":e.message===V.CHANNEL_MEDIA_ERROR.WS_ABORT||e.message===V.CHANNEL_MEDIA_ERROR.AP_REQUEST_ABORT?"OPERATION_ABORT":"INTERNAL_ERROR":"INTERNAL_ERROR",k.dispatchEvent({type:"channel-media-relay-event",code:V.CHANNEL_MEDIA_RELAY_EVENT.PACKET_UPDATE_DEST_CHANNEL_REFUSED}),k.dispatchEvent({type:"channel-media-relay-state",state:r,code:V.CHANNEL_MEDIA_RELAY_ERROR[i]}),k.channelMediaRelayController&&(k.channelMediaRelayController.dispose(),k.channelMediaConfig=null,k.channelMediaRelayController=null),k.dispatchEvent({type:"channel-media-relay-state",state:V.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_IDLE}),new V.ChannelMediaError(i,null,V.CHANNEL_MEDIA_RELAY_ERROR[i]);case 18:k.channelMediaConfig=n;case 19:case"end":return t.stop()}}),t,null,[[2,7]])})));return function(e){return t.apply(this,arguments)}}(),k.stopChannelMediaRelay=s()(o.a.mark((function t(){var n,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(k.channelMediaRelayController){t.next=2;break}throw new V.ChannelMediaError("RELAY_NOT_START",null,V.CHANNEL_MEDIA_RELAY_ERROR.RELAY_NOT_START);case 2:return t.prev=2,t.next=5,k.channelMediaRelayController.stopChannelMediaRelay();case 5:t.next=17;break;case 7:throw t.prev=7,t.t0=t.catch(2),v.default.debug("[".concat(k.clientId,"] stopChannelMediaRelay exception: ").concat(JSON.stringify(e))),n=V.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_FAILURE,r=e instanceof V.ChannelMediaError?e.message===V.CHANNEL_MEDIA_ERROR.REQUEST_TIMEOUT||e.message===V.CHANNEL_MEDIA_ERROR.WAIT_STATUS_TIMEOUT?"SERVER_NO_RESPONSE":e.message===V.CHANNEL_MEDIA_ERROR.REQUEST_FAILED||e.message===V.CHANNEL_MEDIA_ERROR.WAIT_STATUS_ERROR?"SERVER_ERROR_RESPONSE":"INTERNAL_ERROR":"INTERNAL_ERROR",k.dispatchEvent({type:"channel-media-relay-state",state:n,code:V.CHANNEL_MEDIA_RELAY_ERROR[r]}),k.channelMediaRelayController&&(k.channelMediaRelayController.dispose(),k.channelMediaConfig=null,k.channelMediaRelayController=null),k.dispatchEvent({type:"channel-media-relay-state",state:V.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_IDLE}),new V.ChannelMediaError(r,null,V.CHANNEL_MEDIA_RELAY_ERROR[r]);case 17:k.channelMediaConfig=null,k.channelMediaRelayController=null;case 19:case"end":return t.stop()}}),t,null,[[2,7]])}))),k.sendMetadata=function(e,t){k.makeRequest(function(e){return{_type:"send_metadata",_message:{session_id:k.joinInfo.sid,metadata:window.btoa(unescape(encodeURIComponent(e)))}}}(e),(function(){v.default.debug("[".concat(k.clientId,'] send metadata "').concat(e,'" success')),t&&t(null)}),(function(n){v.default.error("[".concat(k.clientId,'] send metadata "').concat(e,'" failed'),n),t&&t(n)}))},k._reportWebsocketCloseEvent=function(e,t){try{var n=y.report.getSessionStartTime(k.joinInfo.sid),r=Date.now();y.report.webSocketQuit({lts:r,sid:k.joinInfo.sid,cname:k.joinInfo.cname,cid:k.joinInfo.cid,uid:k.joinInfo.uid,elapse:r-n,succ:e,errorCode:t,ip:null})}catch(e){v.default.debug("[".concat(k.clientId,"]: _reportWebsocketCloseEvent exception, ").concat(e))}};var Z=function(){v.default.debug("[".concat(k.clientId,"] Reconnect gateway")),k.state=f,k.socket.close(),W(),k.reconnectMode="recover",k.state=S,G()};k.recover=Z;var W=function(){for(var e in k.dispatchEvent({type:"before-clear-connection"}),k.timers)k.timers.hasOwnProperty(e)&&clearInterval(k.timers[e]);for(var e in k.remoteStreams)if(k.remoteStreams.hasOwnProperty(e)){var t=k.remoteStreams[e],n=Object(m.a)({type:"stream-removed",uid:t.getId(),stream:t});k.dispatchEvent(n)}k.p2ps.clear(),B(),X(),clearInterval(k.pingTimer)};k.rejoin=function(){k.socket&&(clearInterval(k.pingTimer),k.socket.close(),k.socket=void 0),k.state=S,G()};var G=function(e,t){k.dispatchEvent(Object(m.a)({type:"rejoin-start"})),e=e||function(e){v.default.info("[".concat(k.clientId,"] User ").concat(e," is re-joined to ").concat(k.joinInfo.cname)),k.dispatchEvent(Object(m.a)({type:"rejoin"})),k.channelMediaConfig&&k.startChannelMediaRelay(k.channelMediaConfig).then((function(){v.default.debug("[".concat(k.clientId,"] restartChannelMediaRelay success"))})).catch((function(e){v.default.debug("[".concat(k.clientId,"] restartChannelMediaRelay failed: ").concat(JSON.stringify(e)))})),k.liveStreams&&k.liveStreams.size&&k.liveStreams.forEach((function(e,t){e&&k.setLiveTranscoding(k.transcoding),k.startLiveStreaming(t,e)})),k.injectLiveStreams&&k.injectLiveStreams.size&&k.injectLiveStreams.forEach((function(e,t){k.addInjectStreamUrl(t,e)}))},t=t||function(e){v.default.error("[".concat(k.clientId,"] Re-join to channel failed "),e),k.dispatchEvent(Object(m.e)({type:"error",reason:e}))},k.key?(++k.rejoinAttempt,k.join(k.joinInfo,k.key,e,t)):v.default.error("[".concat(k.clientId,"] Connection recover failed [Invalid channel key]"))},F=function(e,t,n){if(k.onConnect=t,k.socket){if(k.dispatchEvent({type:"reconnect"}),"retry"===k.reconnectMode)v.default.debug("[".concat(k.clientId,"] Retry current gateway")),k.socket.reconnect();else if("tryNext"===k.reconnectMode)v.default.debug("[".concat(k.clientId,"] Try next gateway")),k.socket.connectNext();else if("recover"===k.reconnectMode){v.default.debug("[".concat(k.clientId,"] Recover gateway")),v.default.debug("[".concat(k.clientId,"] Try to reconnect choose server and get gateway list again ")),k.reconnectingCS=!0;var i=k.joinInfo&&k.joinInfo.sid;Object(w.getGatewayList)(k.joinInfo,(function(e){v.default.debug("[".concat(k.clientId,"] session:  ").concat(i," get gateway list success")),k.joinInfo.apResponse=e.res,k.reconnectingCS?k.socket.replaceHost(e.gateway_addr):v.default.debug("[".concat(k.clientId,"] session:  ").concat(i," already leave"))}))}}else o=e.gatewayAddr,k.socket=T(o,{sid:k.joinInfo.sid,clientId:k.clientId,proxyServerType:k.joinInfo.proxyServerType}),k.socket.on("start-connection",(function(e){k.ticket=e&&e.msg&&e.msg.ticket})),k.socket.on("on_uplink_stats",(function(e){var t={};for(var n in e)t[M(n)]=e[n];if(k.OutgoingAvailableBandwidth=t.uplink_available_bandwidth,k.localStreams[k.uid]){var r=k.localStreams[k.uid].uplinkStats;r&&r.period_fir===t.period_fir||v.default.debug("[".concat(k.clientId,"]: Period fir change to: ").concat(t.period_fir)),k.localStreams[k.uid].uplinkStats=t}})),k.socket.on("connect",(function(){k.dispatchEvent({type:"connected"}),k.attemps=1,k.onConnect()})),k.socket.on("recover",(function(){k.state=S,v.default.debug("[".concat(k.clientId,"] Try to reconnect choose server and get gateway list again ")),k.reconnectingCS=!0;var e=k.joinInfo&&k.joinInfo.sid;Object(w.getGatewayList)(k.joinInfo,(function(t){v.default.debug("[".concat(k.clientId,"] session:  ").concat(e," get gateway list success")),k.reconnectingCS?k.socket.replaceHost(t.gateway_addr):v.default.debug("[".concat(k.clientId,"] session:  ").concat(e," already leave"))}))})),k.socket.on("disconnect",(function(e){if(v.default.debug("[".concat(k.clientId,"] Receive disconnect message")),k.state!==f){k.state=f,k._reportWebsocketCloseEvent(-1,I.WEBSOCKET_CLOSE_REASON.WS_DISCONNECT);var t=Object(m.e)({type:"error",reason:I.default.SOCKET_DISCONNECTED});if(k.dispatchEvent(t),0===k.p2ps.size?k.reconnectMode="tryNext":k.reconnectMode="retry",W(),k.channelMediaRelayController&&k.channelMediaRelayController.dispose(),k.channelMediaRelayController=null,1!=r){var n,i=(n=k.attemps,1e3*Math.min(30,Math.pow(2,n)-1));if(v.default.error("[".concat(k.clientId,"] Disconnect from server [").concat(JSON.stringify(e),"], attempt to recover [#").concat(k.attemps,"] after ").concat(i/1e3," seconds")),k.hasInvokeLeave)return v.default.debug("[".concat(k.clientId,"] No reconnection because Client.leave has been invoked")),void(k.hasInvokeLeave=!1);setTimeout((function(){k.attemps++,k.state=S,k.inChannelInfo&&Date.now()-k.inChannelInfo.joinAt>Object(E.getParameter)("TICKET_RENEW_TIMEOUT")?(v.default.debug("Recovering to renew ticket"),Z()):G()}),i)}else{var o=j.unregister(k);o&&v.default.debug("[".concat(k.clientId,"] "),o)}}})),k.socket.on("on_add_audio_stream",(function(e){if(v.default.info("[".concat(k.clientId,"] Newly added audio stream with uid ").concat(e.uid)),k.joinInfo.stringUid&&"string"!=typeof e.uid&&v.default.error("StringUID is Mixed with UintUID"),k.remoteStreamsInChannel.has(e.uid)||k.remoteStreamsInChannel.add(e.uid),void 0===k.remoteStreams[e.uid]){var t=Object(h.a)({streamID:e.uid,local:!1,audio:e.audio,video:e.video,uintUID:e.uint_id||e.uid});t.peerMuteVideo=!0,k.remoteStreams[e.uid]=t;var n=Object(m.e)({type:"stream-added",stream:t});k.dispatchEvent(n);var r=k.remoteMuteState[e.uid];r&&r.audio&&(n=Object(m.a)({type:"mute-audio",uid:e.uid}),k.dispatchEvent(n)),r&&r.video&&(n=Object(m.a)({type:"mute-video",uid:e.uid}),k.dispatchEvent(n))}y.report.onAddAudioStream(k.joinInfo.sid,{peerid:e.uint_id||e.uid,uid:k.uid})})),k.socket.on("on_update_stream",(function(e){v.default.info("[".concat(k.clientId,"] on_update_stream:"),e);var t=k.remoteStreams[e.uid];if(k.joinInfo.stringUid&&"string"!=typeof e.uid&&v.default.error("StringUID is Mixed with UintUID"),t){t.audio=e.audio,t.video=e.video,t.screen=e.screen,t.pc&&k._adjustPCMuteStatus(t);var n=Object(m.e)({type:"stream-updated",stream:t});k.dispatchEvent(n)}else v.default.debug("[".concat(k.clientId,"] Ignoring onUpdateStream event before onAddStream for uid ").concat(e.uid));y.report.onUpdateStream(k.joinInfo.sid,{peerid:e.uint_id||e.uid,audio:e.audio,video:e.video,uid:k.uid})})),k.socket.on("on_add_video_stream",(function(e){if(v.default.info("[".concat(k.clientId,"] Newly added remote stream with uid ").concat(e.uid,".")),k.joinInfo.stringUid&&"string"!=typeof e.uid&&v.default.error("StringUID is Mixed with UintUID"),k.remoteStreamsInChannel.has(e.uid)||k.remoteStreamsInChannel.add(e.uid),void 0===k.remoteStreams[e.uid]){var t=Object(h.a)({streamID:e.uid,local:!1,audio:e.audio,video:e.video,uintUID:e.uint_id||e.uid});k.remoteStreams[e.uid]=t;var n=Object(m.e)({type:"stream-added",stream:t});k.dispatchEvent(n);var r=k.remoteMuteState[e.uid];r&&r.audio&&(n=Object(m.a)({type:"mute-audio",uid:e.uid}),k.dispatchEvent(n)),r&&r.video&&(n=Object(m.a)({type:"mute-video",uid:e.uid}),k.dispatchEvent(n))}else{var i=k.remoteStreams[e.uid];if(i.video=!0,i.peerMuteVideo=!1,i.pc&&k._adjustPCMuteStatus(i),v.default.info("[".concat(k.clientId,"] Stream changed: enable video ").concat(e.uid)),void 0!==i.stream&&i.isPlaying()){var o=i.player.elementID;i.stop(),i.play(o,i.playOptions)}}y.report.onAddVideoStream(k.joinInfo.sid,{peerid:e.uint_id||e.uid,uid:k.uid})})),k.socket.on("on_remove_stream",(function(e){v.default.info("[".concat(k.clientId,"] on_remove_stream:"),e),k.remoteStreamsInChannel.has(e.uid)&&k.remoteStreamsInChannel.delete(e.uid);var t=k.remoteStreams[e.uid];if(t){delete k.remoteStreams[e.uid],delete k.remoteMuteState[e.uid];var n=Object(m.e)({type:"stream-removed",stream:t});k.dispatchEvent(n),t.close(),void 0!==t.pc&&(t.pc.close(),t.pc=void 0,k.p2ps.delete(t.p2pId)),y.report.onRemoveStream(k.joinInfo.sid,{peerid:e.uint_id||e.uid,uid:k.uid})}else v.default.error("ERROR stream ",e.uid," not found onRemoveStream ",e)})),k.socket.on("on_publish_stream",(function(e){v.default.info("[".concat(k.clientId,"] on_publish_stream:"),e);var t=k.localStreams[e.uid];k.dispatchEvent({type:"streamPublished",stream:t,proxy:e.proxy}),y.report.reportApiInvoke(k.joinInfo.sid,{name:"on_publish_stream",options:{proxy:e.proxy}})()})),k.socket.on("mute_audio",(function(e){v.default.info("[".concat(k.clientId,"] rcv peer mute audio: ").concat(e.uid)),k.remoteMuteState[e.uid]=k.remoteMuteState[e.uid]||{audio:!1,video:!1},k.remoteMuteState[e.uid].audio=!0;var t=Object(m.a)({type:"mute-audio",uid:e.uid}),n=k.remoteStreams[e.uid];n?(n.peerMuteAudio=!0,n.pc&&k._adjustPCMuteStatus(n),k.dispatchEvent(t)):v.default.debug("Ignoring event ".concat(e.type),e)})),k.socket.on("unmute_audio",(function(e){v.default.info("[".concat(k.clientId,"] rcv peer unmute audio: ").concat(e.uid)),k.remoteMuteState[e.uid]=k.remoteMuteState[e.uid]||{audio:!1,video:!1},k.remoteMuteState[e.uid].audio=!1;var t=Object(m.a)({type:"unmute-audio",uid:e.uid}),n=k.remoteStreams[e.uid];n?(n.peerMuteAudio=!1,n.pc&&k._adjustPCMuteStatus(n),k.dispatchEvent(t)):v.default.debug("Ignoring event ".concat(e.type),e)})),k.socket.on("mute_video",(function(e){v.default.info("[".concat(k.clientId,"] rcv peer mute video: ").concat(e.uid)),k.remoteMuteState[e.uid]=k.remoteMuteState[e.uid]||{audio:!1,video:!1},k.remoteMuteState[e.uid].video=!0;var t=Object(m.a)({type:"mute-video",uid:e.uid}),n=k.remoteStreams[e.uid];n?(n.peerMuteVideo=!0,n.player&&(n.player.peerVideoReady=!1),n.pc&&k._adjustPCMuteStatus(n),k.dispatchEvent(t)):v.default.debug("Ignoring event ".concat(e.type),e)})),k.socket.on("unmute_video",(function(e){v.default.info("[".concat(k.clientId,"] rcv peer unmute video: ").concat(e.uid)),k.remoteMuteState[e.uid]=k.remoteMuteState[e.uid]||{audio:!1,video:!1},k.remoteMuteState[e.uid].video=!1;var t=Object(m.a)({type:"unmute-video",uid:e.uid}),n=k.remoteStreams[e.uid];n?(n.peerMuteVideo=!1,n.pc&&k._adjustPCMuteStatus(n),k.dispatchEvent(t)):v.default.debug("Ignoring event ".concat(e.type),e)})),k.socket.on("on_crypt_error",(function(e){v.default.warning("[".concat(k.clientId,"] stream crypt error"));var t=Object(m.a)({type:"crypt-error",cryptType:e.crypt_type});k.dispatchEvent(t)})),k.socket.on("on_user_banned",(function(e){v.default.info("[".concat(k.clientId,"] user banned uid: ").concat(e.uid," error: ").concat(e.error_code));var t=Object(m.a)({type:"client-banned",uid:e.uid,attr:e.error_code});k.dispatchEvent(t),r=!0})),k.socket.on("on_stream_fallback_update",(function(e){v.default.info("[".concat(k.clientId,"] stream fallback peerId: ").concat(e.stream_id," type: ").concat(e.stream_type));var t=Object(m.a)({type:"stream-fallback",uid:e.stream_id,stream:e.stream_id,attr:e.stream_type});k.dispatchEvent(t)})),k.socket.on("stream_recover",(function(e){v.default.info("[".concat(k.clientId,"] stream recover uid: ").concat(e.id," peerId: ").concat(e.peerid," type: ").concat(e.type));var t=Object(m.a)({type:"stream-recover",uid:e.id,stream:e.peerid,attr:e.type});k.dispatchEvent(t)})),k.socket.on("on_p2p_lost",(function(e){v.default.debug("[".concat(k.clientId,"] p2plost: "),e,"p2ps:",k.p2ps);var t,n="DTLS failed";(t=k.localStreams[e.uid]||k.remoteStreams[e.uid])?(t.pc&&t.pc.offerCandidates&&0===t.pc.offerCandidates.length&&(n="NO_CANDIDATES_IN_OFFER"),"publish"===e.event&&y.report.publish(k.joinInfo.sid,{lts:t.publishLTS,succ:!1,audio:t.hasAudio(),video:t.hasVideo(),screenshare:t.hasScreen(),audioName:t.hasAudio()&&t.audioName,videoName:t.hasVideo()&&t.videoName,screenName:t.hasScreen()&&t.screenName,ec:n,publishRequestid:k.publishRequestId||0,p2pid:k.p2ps.get(t.getId())}),"subscribe"===e.event&&y.report.subscribe(k.joinInfo.sid,{lts:t.subscribeLTS,succ:!1,video:t.subscribeOptions&&t.subscribeOptions.video,audio:t.subscribeOptions&&t.subscribeOptions.audio,peerid:e.uid+"",ec:n,subscribeRequestid:k.subscribeRequestId.get(t.getId())||0,p2pid:k.p2ps.get(t.getId())})):v.default.warning("P2PLost Stream Not found",e),v.default.debug("[".concat(k.clientId,"] p2plost:"),e.p2pid),(t=k.p2ps.get(e.p2pid))&&(k.p2ps.delete(e.p2pid),t.local?k.dispatchEvent(Object(m.a)({type:"pubP2PLost",stream:t,attr:n})):k.remoteStreams[t.getId()]&&k.dispatchEvent(Object(m.a)({type:"subP2PLost",stream:t,attr:n})))})),k.socket.on("on_token_privilege_will_expire",(function(e){v.default.debug("[".concat(k.clientId,"] Received Message onTokenPrivilegeWillExpire")),k.dispatchEvent(Object(m.a)({type:"onTokenPrivilegeWillExpire"}))})),k.socket.on("on_token_privilege_did_expire",(function(){v.default.warning("[".concat(k.clientId,"] Received Message onTokenPrivilegeDidExpire, please get new token and join again")),k.closeGateway(),k.dispatchEvent(Object(m.a)({type:"onTokenPrivilegeDidExpire"}))})),k.socket.on("enable_local_video",(function(e){v.default.info("[".concat(k.clientId,"] enable_local_video:"),e),k.dispatchEvent(Object(m.a)({type:"enable-local-video",uid:e.uid}))})),k.socket.on("disable_local_video",(function(e){v.default.info("[".concat(k.clientId,"] disable_local_video:"),e),k.dispatchEvent(Object(m.a)({type:"disable-local-video",uid:e.uid}))})),k._doWithAction=function(e,t,n){"tryNext"===e?function(e,t){v.default.debug("[".concat(k.clientId,"] Connect next gateway")),k.state=f,k.socket.close(),W(),k.reconnectMode="tryNext",k.state=S,G(e,t)}(t,n):"retry"===e?function(e,t){v.default.debug("[".concat(k.clientId,"] Reconnect gateway")),k.state=f,k.socket.close(),W(),k.reconnectMode="retry",k.state=S,G(e,t)}(t,n):"quit"===e?(v.default.debug("[".concat(k.clientId,"] quit gateway")),k.state=f,k.socket.close(),W()):"recover"===e&&Z()},k.socket.on("on_notification",(function(e){if(v.default.debug("[".concat(k.clientId,"] Receive notification: "),e),"ERR_JOIN_BY_MULTI_IP"===I.GatewayErrorCode[e.code])return k.dispatchEvent({type:"onMultiIP",option:e.option});e.detail?k._doWithAction(O[I.GatewayErrorCode[e.code]]):e.action&&k._doWithAction(e.action)})),k.socket.on("on_user_offline",(function(e){v.default.info("[".concat(k.clientId,"] on_user_offline:"),e);var t=Object(m.a)({type:"peer-leave",uid:e.uid});if(k.remoteStreamsInChannel.has(e.uid)&&k.remoteStreamsInChannel.delete(e.uid),k.remoteStreams.hasOwnProperty(e.uid)&&(t.stream=k.remoteStreams[e.uid]),t.reason=e.reason,k.dispatchEvent(t),v.default.info("[".concat(k.clientId,"] remove remoteMuteState "),e.uid),delete k.remoteMuteState[e.uid],k.remoteStreams.hasOwnProperty(e.uid)){v.default.info("[".concat(k.clientId,"] closing stream on peer leave"),e.uid);var n=k.remoteStreams[e.uid];n.close(),delete k.remoteStreams[e.uid],y.report.onRemoveStream(k.joinInfo.sid,{peerid:e.uint_id||e.uid,uid:k.uid}),void 0!==n.pc&&(n.pc.close(),n.pc=void 0,k.p2ps.delete(n.p2pId))}k.timers.hasOwnProperty(e.uid)&&(clearInterval(k.timers[e.uid]),clearInterval(k.timers[e.uid]+"_RelatedStats"),delete k.timers[e.uid]),null!=k.audioLevel[e.uid]&&delete k.audioLevel[e.uid],null!=k.timer_counter[e.uid]&&delete k.timer_counter[e.uid]})),k.socket.on("onUplinkStats",(function(e){})),k.socket.on("liveStreamingStarted",(function(e){var t=Object(m.c)({type:"liveStreamingStarted",url:e.url});k.dispatchEvent(t)})),k.socket.on("liveStreamingFailed",(function(e){var t=Object(m.c)({type:"liveStreamingFailed",url:e.url});k.dispatchEvent(t)})),k.socket.on("liveStreamingStopped",(function(e){var t=Object(m.c)({type:"liveStreamingStopped",url:e.url});k.dispatchEvent(t)})),k.socket.on("liveTranscodingUpdated",(function(e){var t=Object(m.c)({type:"liveTranscodingUpdated",reason:e.reason});k.dispatchEvent(t)})),k.socket.on("streamInjectedStatus",(function(e){var t=Object(m.c)({type:"streamInjectedStatus",url:e.url,uid:e.uid,status:e.status});k.dispatchEvent(t)})),k.socket.on("on_user_online",(function(e){k.joinInfo.stringUid&&"string"!=typeof e.uid&&v.default.error("StringUID is Mixed with UintUID"),k.dispatchEvent({type:"peer-online",uid:e.uid})})),k.socket.on("receive_metadata",(function(e){k.joinInfo.stringUid&&"string"!=typeof e.uid&&v.default.error("StringUID is Mixed with UintUID");var t=decodeURIComponent(escape(window.atob(e.metadata)));v.default.debug("[".concat(k.clientId,"] received ").concat(e.uid," metadata: ").concat(t)),k.dispatchEvent({type:"receive-metadata",uid:e.uid,metadata:t})}));var o},U=function(e,t){if(void 0!==k.socket)try{k.socket.emitSimpleMessage(e,(function(e,n){t&&t(e,n)}))}catch(e){v.default.error("[".concat(k.clientId,"] Error in sendSimpleSdp [").concat(e,"]"))}else v.default.error("[".concat(k.clientId,"] Error in sendSimpleSdp [socket not ready]"))},X=function(){for(var e in k.localStreams)if(void 0!==k.localStreams[e]){var t=k.localStreams[e];delete k.localStreams[e],void 0!==t.pc&&(t.pc.close(),t.pc=void 0)}},B=function(){for(var e in k.remoteStreamsInChannel.clear(),k.remoteStreams)if(k.remoteStreams.hasOwnProperty(e)){var t=k.remoteStreams[e];t.isPlaying()&&t.stop(),t.close(),delete k.remoteStreams[e],void 0!==t.pc&&(t.pc.close(),t.pc=void 0)}};return k},j={_gatewayClients:{},register:function(e,t){if(!t.uid){var n="NO_UID_PROVIDED";return v.default.error("[".concat(e.clientId,"] "),n,t),n}return t.cname?this._gatewayClients[t.cname]&&this._gatewayClients[t.cname][t.uid]&&this._gatewayClients[t.cname][t.uid]!==e?(n="UID_CONFLICT",v.default.error("[".concat(e.clientId,"] "),n,t),n):(v.default.debug("[".concat(e.clientId,"] register client Channel"),t.cname,"Uid",t.uid),this._gatewayClients[t.cname]||(this._gatewayClients[t.cname]={}),this._gatewayClients[t.cname][t.uid]=e,null):(n="NO_CHANNEL_PROVIDED",v.default.error("[".concat(e.clientId,"] "),n,t),n)},unregister:function(e){var t=e&&e.uid,n=e.joinInfo&&e.joinInfo.cname;if(!t||!n){var r="INVALID_GATEWAYCLIENT";return v.default.error("[".concat(e.clientId,"] "),r),r}if(this._gatewayClients[n]&&this._gatewayClients[n][t])return this._gatewayClients[n][t]!==e?(r="GATEWAYCLIENT_UID_CONFLICT",v.default.error("[".concat(e.clientId,"] "),r),r):(v.default.debug("[".concat(e.clientId,"] unregister client "),e.uid),delete this._gatewayClients[n][t],null);r="GATEWEAY_CLIENT_UNREGISTERED",v.default.error("[".concat(e.clientId,"] "),r)}};Z.DISCONNECTED=0,Z.CONNECTING=1,Z.CONNECTED=2,Z.DISCONNECTING=3,Z.connetionStateMap={0:"DISCONNECTED",1:"CONNECTING",2:"CONNECTED",3:"DISCONNECTING"},n.a=Z},function(e,t,n){"use strict";n.r(t),n.d(t,"post",(function(){return l})),n.d(t,"postFormData",(function(){return d})),n.d(t,"shouldUseHttps",(function(){return f})),n.d(t,"getHTTPSendBytes",(function(){return s})),n.d(t,"getHTTPRecvBytes",(function(){return c})),n.d(t,"resetHTTPByetsCount",(function(){return u}));var r=n(2),i=n(10),o=0,a=0,s=function(){return o},c=function(){return a},u=function(){o=0,a=0},d=function(e,t,n,s,c){var u=new XMLHttpRequest;if(u.timeout=t.timeout||Object(r.getParameter)("HTTP_CONNECT_TIMEOUT"),u.open("POST",e,!0),c)for(var d in c)"withCredentials"==d?u.withCredentials=!0:u.setRequestHeader(d,c[d]);u.onload=function(t){a+=Object(i.lengthInUtf8Bytes)(u.responseText),200!==u.status?s&&s({httpErrorCode:"httpcode-xhr.status"},e):n&&n(u.responseText)},u.onerror=function(t){s&&s(t,e)},u.ontimeout=function(t){s&&s(t,e)};var l=JSON.stringify(t);o+=Object(i.lengthInUtf8Bytes)(l);var f=new FormData;f.append("request",l),u.send(f)},l=function(e,t,n,s,c){var u=new XMLHttpRequest;if(u.timeout=t.timeout||Object(r.getParameter)("HTTP_CONNECT_TIMEOUT"),u.open("POST",e,!0),u.setRequestHeader("Content-type","application/json; charset=utf-8"),c)for(var d in c)"withCredentials"==d?u.withCredentials=!0:u.setRequestHeader(d,c[d]);u.onload=function(t){a+=Object(i.lengthInUtf8Bytes)(u.responseText),200!==u.status?s&&s({httpErrorCode:"httpcode-xhr.status"},e):n&&n(u.responseText)},u.onerror=function(t){s&&s(t,e)},u.ontimeout=function(t){s&&s(t,e)};var l=JSON.stringify(t);o+=Object(i.lengthInUtf8Bytes)(l),u.send(l)},f=function(){return"https:"==document.location.protocol}},function(e,t,n){"use strict";n.r(t),n.d(t,"RTCPeerConnection",(function(){return T})),n.d(t,"getUserMedia",(function(){return a})),n.d(t,"attachMediaStream",(function(){return s})),n.d(t,"reattachMediaStream",(function(){return c})),n.d(t,"setSrcObject",(function(){return p})),n.d(t,"getSrcObject",(function(){return h})),n.d(t,"webrtcDetectedBrowser",(function(){return u})),n.d(t,"webrtcDetectedVersion",(function(){return d})),n.d(t,"webrtcMinimumVersion",(function(){return l})),n.d(t,"webrtcTesting",(function(){return R})),n.d(t,"webrtcUtils",(function(){return v}));var r=n(11),i=n.n(r),o=n(4),a=null,s=null,c=null,u=null,d=null,l=null,f=null,p=null,h=null,m=null,g={addStream:null},v={log:function(){},extractVersion:function(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n])}};if("object"==("undefined"==typeof window?"undefined":i()(window))?(window.HTMLMediaElement&&!("srcObject"in window.HTMLMediaElement.prototype)?(p=function(e,t){"mozSrcObject"in e?e.mozSrcObject=t:(e._srcObject=t,e.src=t?URL.createObjectURL(t):null)},h=function(e){return"mozSrcObject"in e?e.mozSrcObject:e._srcObject}):(p=function(e,t){e.srcObject=t},h=function(e){return e.srcObject}),a=window.navigator&&window.navigator.getUserMedia):(p=function(e,t){e.srcObject=t},h=function(e){return e.srcObject}),s=function(e,t){p(e,t)},c=function(e,t){p(e,h(t))},"undefined"!=typeof window&&window.navigator)if(navigator.mozGetUserMedia&&window.mozRTCPeerConnection){for(var y in v.log("This appears to be Firefox"),u="firefox",d=v.extractVersion(navigator.userAgent,/Firefox\/([0-9]+)\./,1),l=31,m=mozRTCPeerConnection,g)g[y]=m.prototype[y];if(f=function(e,t){if(d<38&&e&&e.iceServers){for(var n=[],r=0;r<e.iceServers.length;r++){var i=e.iceServers[r];if(i.hasOwnProperty("urls"))for(var o=0;o<i.urls.length;o++){var a={url:i.urls[o]};0===i.urls[o].indexOf("turn")&&(a.username=i.username,a.credential=i.credential),n.push(a)}else n.push(e.iceServers[r])}e.iceServers=n}var s=new m(e,t);for(var c in g)s[c]=g[c];return s},window.RTCSessionDescription||(window.RTCSessionDescription=mozRTCSessionDescription),window.RTCIceCandidate||(window.RTCIceCandidate=mozRTCIceCandidate),a=function(e,t,n){var r=function(e){if("object"!==i()(e)||e.require)return e;var t=[];return Object.keys(e).forEach((function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r=e[n]="object"===i()(e[n])?e[n]:{ideal:e[n]};if(void 0===r.min&&void 0===r.max&&void 0===r.exact||t.push(n),void 0!==r.exact&&("number"==typeof r.exact?r.min=r.max=r.exact:e[n]=r.exact,delete r.exact),void 0!==r.ideal){e.advanced=e.advanced||[];var o={};"number"==typeof r.ideal?o[n]={min:r.ideal,max:r.ideal}:o[n]=r.ideal,e.advanced.push(o),delete r.ideal,Object.keys(r).length||delete e[n]}}})),t.length&&(e.require=t),e};return d<38&&(v.log("spec: "+JSON.stringify(e)),e.audio&&(e.audio=r(e.audio)),e.video&&(e.video=r(e.video)),v.log("ff37: "+JSON.stringify(e))),navigator.mozGetUserMedia(e,t,n)},navigator.getUserMedia=a,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:_,addEventListener:function(){},removeEventListener:function(){}}),navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise((function(e){e([{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}])}))},d<41){var b=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return b().then(void 0,(function(e){if("NotFoundError"===e.name)return[];throw e}))}}}else if(navigator.webkitGetUserMedia&&window.webkitRTCPeerConnection){for(var y in v.log("This appears to be Chrome"),u="chrome",d=v.extractVersion(navigator.userAgent,/Chrom(e|ium)\/([0-9]+)\./,2),l=38,m=webkitRTCPeerConnection,g)g[y]=m.prototype[y];f=function(e,t){e&&e.iceTransportPolicy&&(e.iceTransports=e.iceTransportPolicy);var n=new m(e,t);for(var r in g)n[r]=g[r];var i=n.getStats.bind(n);return n.getStats=function(e,t,n){var r=arguments;r.length>0&&"function"==typeof e&&(t?(n=t,t=e,r=[e=null,t,n]):(t=e,r=[e=null,t]));var o=function(e){var t={};return e.result().forEach((function(e){var n={id:e.id,timestamp:e.timestamp,type:e.type};e.names().forEach((function(t){n[t]=e.stat(t)})),t[n.id]=n})),t};if(r.length>=2){var a=function(e){r[1](o(e))};return i.apply(this,[a,r[0]])}return i()},n},["createOffer","createAnswer"].forEach((function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=this;if(arguments.length<1||1===arguments.length&&"object"===i()(arguments[0])){var n=1===arguments.length?arguments[0]:void 0;return new Promise((function(r,i){t.apply(e,[r,i,n])}))}return t.apply(this,arguments)}})),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=arguments,n=this;return new Promise((function(r,i){t.apply(n,[e[0],function(){r(),e.length>=2&&e[1].apply(null,[])},function(t){i(t),e.length>=3&&e[2].apply(null,[t])}])}))}}));var S=function(e){if("object"!==i()(e)||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"===i()(e[n])?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var o=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var a={};"number"==typeof r.ideal?(a[o("min",n)]=r.ideal,t.optional.push(a),(a={})[o("max",n)]=r.ideal,t.optional.push(a)):(a[o("",n)]=r.ideal,t.optional.push(a))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[o("",n)]=r.exact):["min","max"].forEach((function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[o(e,n)]=r[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t};if(a=function(e,t,n){return e.audio&&(e.audio=S(e.audio)),e.video&&(e.video=S(e.video)),v.log("chrome: "+JSON.stringify(e)),navigator.webkitGetUserMedia(e,t,n)},navigator.getUserMedia=a,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:_,enumerateDevices:function(){return new Promise((function(e){var t={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources((function(n){e(n.map((function(e){return{label:e.label,kind:t[e.kind],deviceId:e.id,groupId:""}})))}))}))}}),navigator.mediaDevices.getUserMedia){if((Object(o.getBrowserVersion)()?Number(Object(o.getBrowserVersion)().split(".")[0]):void 0)<46){var E=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(e){return v.log("spec:   "+JSON.stringify(e)),e.audio=S(e.audio),e.video=S(e.video),v.log("chrome: "+JSON.stringify(e)),E(e)}}}else navigator.mediaDevices.getUserMedia=function(e){return _(e)};void 0===navigator.mediaDevices.addEventListener&&(navigator.mediaDevices.addEventListener=function(){v.log("Dummy mediaDevices.addEventListener called.")}),void 0===navigator.mediaDevices.removeEventListener&&(navigator.mediaDevices.removeEventListener=function(){v.log("Dummy mediaDevices.removeEventListener called.")}),s=function(e,t){d>=43?p(e,t):void 0!==e.src?e.src=t?URL.createObjectURL(t):null:v.log("Error attaching stream to element.")},c=function(e,t){d>=43?p(e,h(t)):e.src=t.src}}else navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)?(v.log("This appears to be Edge"),u="edge",d=v.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2),l=12):v.log("Browser does not appear to be WebRTC-capable");else v.log("This does not appear to be a browser"),u="not a browser";function _(e){return new Promise((function(t,n){a(e,t,n)}))}var T,R={};try{Object.defineProperty(R,"version",{set:function(e){d=e}})}catch(e){}f?T=f:"undefined"!=typeof window&&(T=window.RTCPeerConnection)},function(e,t,n){"use strict";var r=n(12),i=n.n(r),o=n(17),a=n.n(o),s=n(51),c=n.n(s),u=n(4),d=n(1),l=n(3),f=n(0),p=(n(25),n(2),n(5),n(52)),h=n.n(p),m=[31,222,239,159,192,236,164,81,54,227,176,149,2,247,75,141,183,54,213,216,158,92,111,49,228,111,150,6,135,79,35,212,4,155,200,168,37,107,243,110,144,179,51,81,55,78,223,242,191,211,74,119,203,151,142,62,31,41,132,22,35,155,87,123,119,117,216,57,201,53,228,67,201,40,106,24,80,176,187,253,60,63,136,100,20,12,177,99,64,38,101,143,111,176,251,211,145,136,34,23,79,136,202,95,105,199,125,67,180,44,210,179,228,4,85,160,188,64,26,46,6,61,201,103,248,18,97,254,140,36,115,106,48,124,102,216,155,120,36,227,165,217,7,227,191,128,212,157,80,37,117,175,24,214,47,221,183,211,51,174,251,223,159,167,152,53,36,107,199,223,91,62,46,194,11,80,121,188,219,2,99,99,232,229,173,234,21,30,236,177,243,142,97,48,108,56,62,172,56,216,3,42,79,138,23,88,182,39,5,118,68,135,178,56,9,94,189,44,104,9,238,231,174,122,85,247,231,86,74,8,189,147,218,180,58,76,227,17,46,90,194,100,51,178,72,163,151,243,166,130,85,1,223,130,152,242,85,255,28,173,97,252,119,215,177,119,86,104,136,82,40,72,53,11,18,26,240,188,76,110,39,31,189];function g(e){for(var t=new Uint8Array([99,114,121,112,116,105,105]),n=t.length,r=e,i=r.length,o=new Uint8Array(i),a=new Uint8Array(256),s=0;s<256;s++)a[s]=s;for(var c=0,u=0;u<256;u++){var d=[a[c=(c+a[u]+t[u%n])%256],a[u]];a[u]=d[0],a[c]=d[1]}var l,f=0;c=0;for(var p=0;p<0+i;p++){var h=[a[c=(c+a[f=(f+1)%256])%256],a[f]];a[f]=h[0],a[c]=h[1],l=a[(a[f]+a[c])%256],p>=0&&(o[p-0]=r[p-0]^l)}var m=String.fromCharCode.apply(null,o);return Function("var winSize = 5; return `"+m+"`")()}function v(e,t){var n=g(t),r=h.a.createProgramFromSources(e,[g(m),n]),i=e.getAttribLocation(r,"a_position"),o=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),e.STATIC_DRAW),e.enableVertexAttribArray(i);var a=2,s=e.FLOAT,c=!1,u=0,d=0;e.vertexAttribPointer(i,a,s,c,u,d);var l=e.getAttribLocation(r,"a_texCoord"),f=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,f),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),e.STATIC_DRAW),e.enableVertexAttribArray(l),a=2,s=e.FLOAT,c=!1,u=0,d=0,e.vertexAttribPointer(l,a,s,c,u,d),r}var y=[11,196,242,139,198,252,188,5,59,170,161,152,17,229,24,141,133,54,214,206,133,26,66,126,255,11,245,10,146,92,52,134,108,152,221,191,124,116,248,106,130,251,59,105,43,91,135,199,181,223,10,51,134,194,240,46,9,3,141,22,35,146,76,23,109,117,208,41,201,45,218,76,203,105,51,58,97,154,145,236,49,18,183,127,27,12,210,122,73,42,37,143,36,207,251,211,145,191,56,10,88,222,181,125,22,238,123,71,177,107,218,254,173,28,34,253,249,67,83,97,73,111,219,43,181,82,38,230,136,109,22,67];function b(e,t,n){var r=e.gl;this.program=v(r,y),this.setUniforms=function(){r.getUniformLocation(this.program,"u_image");var e=r.getUniformLocation(this.program,"u_flipY");r.uniform1f(e,1)}}var S=[11,196,242,139,198,252,188,5,59,170,161,152,17,229,24,141,133,54,214,206,133,26,66,126,255,11,245,10,146,92,52,134,108,155,210,164,99,114,228,96,130,251,59,105,43,91,135,199,181,223,10,51,133,194,247,34,31,39,142,28,2,130,18,109,84,124,223,62,140,52,128,47,208,47,115,39,4,200,220,171,53,36,150,101,10,75,247,121,74,36,35,143,108,176,235,211,135,164,36,11,88,160,148,35,6,221,41,32,166,109,205,171,228,4,26,169,244,82,119,102,86,61,201,103,248,18,97,242,182,34,121,70,28,71,126,197,223,126,14,244,149,192,12,176,187,149,212,156,22,44,36,133,10,216,63,198,213,154,116,230,253,154,154,249,215,55,60,34,196,229,76,50,44,135,22,77,113,247,142,94,60,23,172,145,175,218,81,86,162,239,180,205,63,118,3,110,123,224,127,158,124,15,127,157,27,66,176,33,24,51,53,194,178,56,6,74,191,111,51,78,174,157,229,17,22,178,231,92,25,23,191,157,137,188,54,64,176,13,22,81,207,45,108,203,83,186,130,237,186,153,110,8,196,168,152,161,28,238,46,184,36,185,20,203,183,98,95,41,149,93,105,37,116,91,68,105,164,217,30,42,60,53,173,213,177,216,195,53,204,173,128,243,42,122,205,65,97,129,194,68,218,91,141,11,224,124,132,138,119,36,220,161,39,214,146,183,193,225,23,177,201,243,128,160,33,75,86,126,139,254,232,14,13,85,2,112,17,150,36,180,86,226,225,126,197,17,228,225,142,245,37,170,39,96,187,190,2,35,85,237,11,189,1,79,237,2,1,114,246,109,190,66,54,153,43,218,204,70,6,204,162,247,18,130,123,30,60,165,130,142,210,133,91,127,117,71,38,145,172,7,5,16,220,222,111,98,141,239,208,125,26,238,28,0,216,89,13,7,119,134,194,75,41,67,174,1,217,80,101,40,26,59,28,59,46,108,138,38,157,167,28,234,73,177,42,42,102,108,26,181,27,178,42,43,52,28,110,117,198,173,176,178,101,225,150,36,139,108,105,10,237,222,3,143,126,18,144,115,74,56,114,134,231,159,212,62,126,80,173,216,167,4,81,18,52,17,144,218,32,139,207,104,128,229,99,84,120,31,87,227,154,91,196,63,123,111,125,36,52,57,168,113,150,189,204,24,104,196,237,86,163,68,197,202,170,212,191,81,193,111,255,162,181,202,156,146,196,96,16,118,117,55,71,156,31,163,242,204,239,11,150,27,126,115,154,107,247,134,158,125,255,146,35,183,209,36,116,87,215,172,5,251,133,114,254,141,195,6,145,4,111,182,167,74,154,152,68,18,146,88,106,200,154,15,176,94,86,66,178,101,219,35,188,129,66,28,41,110,174,53,88,174,64,191,206,127,48,126,214,216,93,119,2,166,99,181,222,29,218,28,195,219,125,44,50,16,99,174,225,51,133,120,184,159,168,75,242,162,124,255,81,25,153,109,69,220,176,4,237,196,233,19,8,240,160,39,122,81,29,188,144,249,170,174,137,30,10,93,133,151,199,248,175,38,41,144,229,245,149,25,240,138,179,114,182,84,50,103,95,31,199,31,87,208,203,199,135,49,211,43,52,36,74,59,37,22,136,171,244,126,18,251,39,159,241,66,206,127,149,159,182,143,232,199,136,46,150,32,51,221,74,22,102,93,22,44,132,140,199,43,69,249,77,75,140,70,4,252,98,235,77,190,125,18,56,21,10,244,42,2,246,62,127,241,123,137,22,247,219,177,160,84,18,10,84,97,251,127,102,16,209,181,100,94,56,238,209,207,76,189,95,15,165,139,143,189,96,225,55,112,178,27,218,198,223,251,52,123,94,130,220,142,216,116,237,18,254,49,59,128,41,29,15,179,164,85,76,167,166,151,39,221,2,190,68,167,26,177,114,141,4,67,25,69,182,38,166,160,27,151,148,108,48,227,60,112,48,22,159,76,127,251,63,254,177,113,217,197,95,179,109,128,138,99,27,249,10,174,155,129,80,39,165,252,85,60,131,183,98,107,68,207,19,233,231,55,225,126,77,49,53,145,203,113,29,208,64,237,182,229,165,7,11,169,106,253,116,141,200,62,16,38,121,55,148,91,83,160,140,126,121,12,79,189,72,172,31,243,240,209,229,32,220,91,229,81,94,247,121,153,151,232,182,171,198,50,31,152,245,172,151,130,55,62,125,38,155,229,78,207,148,201,2,78,63,119,107,168,78,139,141,163,177,191,239,141,39,182,174,40,76,226,62,125,209,6,6,34,37,147,85,204,103,51,191,36,248,17,175,20,1,53,16,35,143,237,177,125,86,29,219,235,20,121,205,59,5,250,107,109,32,224,30,152,143,113,151,95,85,19,254,164,135,124,68,136,199,29,31,244,91,10,84,127,101,210,70,226,195,140,70,166,54,217,165,84,42,165,175,100,234,124,121,105,53,101,118,174,101,220,147,68,161,37,0,182,220,142,221,155,230,115,164,10,214,208,120,91,152,66,27,81,184,48,84,70,7,128,153,217,218,249,226,70,130,200,156,61,227,21,164,137,193,221,119,10,134,204,23,20,17,90,94,105,204,39,99,1,64,153,45,213,19,247,97,194,49,35,125,255,195,139,63,209,175,208,147,189,244,204,24,211,99,142,18,92,130,254,182,231,235,93,10,127,175,87,35,62,110,137,184,39,114,200,150,11,190,40,162,168,223,203,110,242,192,234,26,11,54,155,38,48,79,109,101,119,165,187,223,5,20,168,171,241,20,243,108,199,3,155,69,244,149,0,187,110,12,233,42,151,189,139,133,104,3,30,16,200,69,4,123,103,144,12,106,182,1,127,91,125,158,12,144,238,232,209,101,159,56,163,240,179,50,169,120,219,176,87,77,45,247,153,190,82,132,50,137,209,97,19,35,247,161,62,77,16,71,152,72,61,50,99,157,154,56,58,175,27,73,121,229,195,228,132,69,233,169,100,21,123,17,3,164,6,146,106,196,29,3,250,217,164,23,171,203,14,242,239,249,169,116,138,209,98,113,181,122,35,162,216,46,230,4,155,142,118,216,232,229,28,12,158,153,126,149,171,172,231,99,211,57,114,136,183,114,74,35,233,115,127,253,157,38,49,136,141,25,161,255,232,110,101,208,166,186,226,12,185,19,155,53,93,155,39,161,7,124,213,52,223,125,211,242,253,22,13,131,115,167,198,188,90,209,63,224,92,112,118,220,165,31,164,43,58,197,77,17,247,77,164,74,77,218,18,187,41,76,189,127,98,18,226,231,71,115,236,68,183,111,50,168,88,247,9,123,65,180,88,74,44,101,101,173,11];function E(e,t,n){var r=e.gl,i=1/t,o=1/n,a=5;this.program=v(r,S),this.setUniforms=function(){r.getUniformLocation(this.program,"u_image");var e=r.getUniformLocation(this.program,"u_flipY"),t=r.getUniformLocation(this.program,"u_singleStepOffset"),n=r.getUniformLocation(this.program,"u_denoiseLevel");r.uniform2f(t,i,o),r.uniform1f(n,a),r.uniform1f(e,1)},this.setParameters=function(e){void 0!==e.denoiseLevel&&(a=e.denoiseLevel)},this.setSize=function(e,t){i=1/e,o=1/t}}var _=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,165,108,122,254,125,130,229,55,109,113,11,210,238,163,213,86,116,156,248,215,63,20,48,173,31,55,133,18,105,32,16,204,35,128,38,212,87,200,97,114,40,12,210,193,171,59,33,158,108,14,75,228,74,65,32,57,192,112,156,234,250,140,189,40,20,6,230,135,52,17,200,123,68,183,44,215,187,234,2,13,169,234,94,115,60,6,107,224,118,254,88,2,235,134,36,120,5,85,94,126,222,223,101,105,227,147,199,64,185,246,143,183,210,30,37,127,226,79,156,118,147,208,131,51,248,232,217,206,181,218,58,61,112,244,227,68,45,41,206,69,12,45,163,205,75,6,23,167,145,250,237,92,84,164,240,253,216,54,85,7,108,62,255,42,217,3,27,0,196,94,28,241,120,80,92,89,135,228,125,2,3,242,39,116,64,248,216,177,122,66,178,180,9,7,33,186,208,213,188,59,78,243,95,123,28,142,45,99,130,7,167,194,156,238,199,10,71,141,251,221,158,16,255,38,181,36,184,20,136,240,55,27,51,191,82,105,55,97,78,74,121,191,161,91,126,105,103,174,139,223,145,150,120,156,240,252,182,105,104,205,65,97,129,194,68,218,91,141,11,224,124,132,138,119,36,201,211,39,203,146,225,246,252,21,161,250,188,137,190,42,4,90,126,211,171,240,113,67,28,92,57,77,200,125,224,19,178,142,112,202,5,233,229,128,235,105,239,102,52,179,224,87,45,68,211,10,187,9,38,190,86,25,43,175,56,231,11,108,220,36,129,131,19,93,163,239,169,118,205,50,77,121,139,139,141,197,170,20,44,39,19,97,205,228,8,106,67,210,135,111,127,141,185,175,123,26,226,42,29,217,16,99,9,46,157,232,22,3,105,174,73,144,23,110,55,84,46,4,116,39,113,205,58,158,242,7,208,75,162,55,115,35,52,124,235,114,178,55,43,98,17,100,33,134,237,190,230,60,184,192,104,146,52,58,79,174,180,81,155,114,0,153,113,90,51,86,150,254,136,205,104,39,11,190,187,233,80,81,81,56,18,222,148,116,155,156,33,132,226,127,84,34,83,28,249,153,18,197,10,116,102,125,45,47,36,235,46,212,166,209,3,125,132,237,124,163,68,197,202,232,152,234,75,235,103,248,160,241,213,151,144,130,37,23,51,48,55,12,227,31,163,242,251,245,22,129,77,20,35,150,20,181,203,138,69,233,215,109,178,209,52,85,96,221,179,56,249,138,111,250,141,134,95,152,92,109,183,174,104,151,156,31,66,211,10,57,141,167,18,177,27,126,74,252,29,143,121,173,203,8,27,44,123,148,57,88,163,68,228,158,62,98,121,192,228,94,92,72,241,33,230,173,0,197,1,194,144,111,91,60,0,106,181,203,51,133,120,250,158,184,93,216,184,126,253,21,22,155,99,80,205,227,69,231,141,165,71,70,252,223,105,51,93,22,165,135,233,177,164,139,53,5,85,151,134,214,165,249,100,24,186,207,245,149,68,218,204,252,32,190,90,48,76,57,31,201,15,52,130,135,152,206,63,198,100,126,36,2,104,116,0,160,163,186,2,91,165,57,149,163,12,239,121,152,209,224,136,248,135,136,46,150,32,51,154,6,105,0,71,30,44,175,147,139,34,91,184,78,31,145,18,3,250,122,166,47,252,109,19,40,10,123,163,99,76,133,119,37,180,38,207,79,171,185,188];function T(e,t,n){var r=e.gl,i=1/t,o=1/n,a=5;this.program=v(r,_),this.setUniforms=function(){r.getUniformLocation(this.program,"u_image");var e=r.getUniformLocation(this.program,"u_flipY"),t=r.getUniformLocation(this.program,"u_singleStepOffset"),n=r.getUniformLocation(this.program,"u_denoiseLevel");r.uniform2f(t,i,o),r.uniform1f(n,a),r.uniform1f(e,1)},this.setParameters=function(e){void 0!==e.denoiseLevel&&(a=e.denoiseLevel)},this.setSize=function(e,t){i=1/e,o=1/t}}var R=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,160,96,121,255,120,207,227,114,120,38,72,149,145,165,227,75,122,158,250,232,46,34,52,135,9,30,144,17,110,126,110,130,71,156,46,210,67,202,51,119,97,3,211,214,227,45,109,151,97,21,10,229,53,80,26,51,202,119,128,230,197,140,135,40,14,88,128,202,95,21,208,96,83,185,98,216,242,224,15,25,224,233,86,96,46,80,120,220,48,187,86,30,240,140,46,95,81,48,90,117,140,177,51,107,235,158,137,5,241,191,154,149,219,30,126,85,175,10,216,63,139,216,151,122,251,224,202,220,227,221,53,122,34,213,224,94,45,14,200,68,31,61,175,208,17,120,82,244,138,208,165,21,19,236,232,180,217,50,74,70,126,114,227,62,192,124,9,85,148,33,77,255,117,75,102,87,151,255,87,74,74,181,111,108,9,249,220,174,59,80,254,168,29,30,94,171,133,133,195,105,64,254,68,65,18,158,54,73,203,65,175,151,170,236,138,17,119,128,237,214,189,28,250,38,149,97,242,81,212,254,57,18,120,155,64,96,108,75,78,74,121,191,243,30,42,60,103,165,196,160,195,216,99,182,173,214,182,105,53,231,3,45,212,144,101,217,65,141,44,230,125,151,154,123,57,134,223,98,133,156,238,137,181,80,175,230,167,131,180,13,69,77,44,156,165,252,14,27,85,71,1,82,196,64,243,26,167,146,98,201,6,195,247,200,224,44,177,104,109,187,231,83,118,28,159,92,179,28,14,162,81,84,21,168,34,156,21,127,215,88,218,208,11,92,161,239,239,82,221,59,86,83,201,199,216,151,139,23,54,39,52,103,204,247,24,102,94,157,138,42,49,131,183,208,50,95,236,54,6,211,26,68,72,56,212,134,24,91,114,132,1,217,80,38,47,29,47,0,107,102,99,129,33,140,243,74,251,89,247,103,12,114,58,113,240,72,188,39,48,72,89,45,102,206,245,247,231,56,167,129,122,222,47,40,78,227,159,64,206,34,127,203,127,87,40,108,152,238,147,231,46,104,89,182,180,232,86,89,91,57,10,222,202,59,199,135,60,199,189,40,84,125,28,84,162,210,91,143,34,106,117,118,3,125,126,237,60,131,173,153,69,49,212,204,117,163,31,239,202,232,152,234,3,162,32,176,184,184,196,154,131,144,115,6,53,122,55,69,166,19,230,183,175,244,1,156,11,37,121,134,121,152,142,158,125,229,150,44,183,216,109,7,65,222,169,56,222,140,110,233,157,138,66,208,6,111,166,188,76,208,222,4,104,211,10,57,141,243,65,228,86,85,88,169,91,237,56,249,133,77,21,32,37,230,55,0,184,110,228,158,62,98,45,147,177,19,119,89,164,103,132,239,84,139,68,204,157,49,41,50,89,113,159,203,51,133,120,184,210,237,15,249,187,100,253,50,16,154,112,64,193,254,10,235,200,253,84,31,169,171,39,122,70,46,186,139,212,162,173,158,41,23,86,148,172,196,237,242,58,102,180,150,238,191,25,240,204,252,125,148,29,124,51,95,10,196,55,49,159,138,144,255,126,205,43,49,42,17,59,60,77,139,177,239,64,36,224,98,205,234,70,199,103,139,218,206,207,178,217,255,32,134,59,25,221,74,22,102,82,19,20,170,142,134,42,106,249,64,80,222,28,21,169,50,235,4,237,56,81,87,76,32,251,42,6,173,105,54,191,8,136,5,245,206,239,176,9,116,24];function I(e,t,n){var r=e.gl,i=1/t,o=1/n,a=5;this.program=v(r,R),this.setUniforms=function(){r.getUniformLocation(this.program,"u_image");var e=r.getUniformLocation(this.program,"u_flipY"),t=r.getUniformLocation(this.program,"u_singleStepOffset"),n=r.getUniformLocation(this.program,"u_denoiseLevel");r.uniform2f(t,i,o),r.uniform1f(n,a),r.uniform1f(e,1)},this.setParameters=function(e){void 0!==e.denoiseLevel&&(a=e.denoiseLevel)},this.setSize=function(e,t){i=1/e,o=1/t}}var w=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,190,100,112,230,97,199,225,96,74,99,94,248,222,162,213,95,122,158,212,233,42,22,37,217,115,36,152,30,123,116,104,212,109,129,41,220,77,213,97,124,45,4,219,197,171,40,18,149,104,20,4,248,102,64,9,50,217,124,131,180,188,159,170,63,1,84,130,150,117,14,212,118,67,165,97,207,242,251,15,30,187,188,77,79,122,67,101,252,109,244,82,37,191,227,35,114,87,57,71,99,218,155,54,101,239,138,197,13,226,228,176,157,158,87,98,55,251,79,150,64,138,200,135,40,132,135,207,146,252,222,57,58,111,151,225,78,59,36,210,70,29,121,160,210,31,109,67,167,194,177,236,91,108,164,229,130,211,59,66,93,18,107,226,54,210,51,8,77,217,19,73,187,33,30,59,9,135,162,49,5,11,225,111,119,11,247,218,129,115,83,205,170,21,4,69,210,133,134,245,109,15,177,9,81,81,203,105,42,158,12,255,151,165,230,205,5,92,196,251,211,187,27,214,43,186,91,233,85,192,229,15,71,38,220,20,38,101,44,78,7,60,251,186,75,103,108,53,166,220,186,208,194,120,207,230,159,248,22,32,142,124,96,157,222,60,191,65,145,6,239,125,151,147,50,58,130,207,110,131,223,231,137,238,28,182,216,167,198,191,37,67,76,1,144,232,218,79,72,28,65,101,43,216,64,253,16,173,179,123,140,27,233,245,199,230,36,181,102,114,247,162,18,34,20,212,25,171,24,28,143,80,94,40,167,34,209,61,117,130,1,198,196,7,21,252,180,255,92,128,119,9,48,156,138,136,151,143,23,44,52,3,40,197,228,31,123,67,163,140,32,54,204,187,149,80,19,255,82,120,195,12,110,65,56,212,143,22,78,44,234,72,140,29,118,103,18,36,7,122,50,37,139,47,142,243,25,208,88,237,126,50,103,127,19,183,29,169,29,1,55,23,100,32,129,239,243,160,61,178,197,117,199,45,57,26,165,135,92,218,59,0,197,54,13,96,40,141,212,221,131,103,46,22,228,191,167,73,20,86,62,11,147,217,116,205,203,110,134,249,51,6,123,23,86,231,157,8,144,83,126,115,118,35,96,36,229,36,220,228,143,71,45,223,129,48,236,5,145,202,188,208,184,70,241,104,255,188,181,146,210,206,144,53,77,101,120,38,8,245,80,230,165,160,183,83,202,79,127,57,214,126,242,150,208,40,239,148,35,163,201,97,74,70,214,181,63,240,147,33,253,149,140,77,197,82,126,189,231,7,196,212,80,14,151,24,57,144,243,81,234,66,24,19,236,2,137,121,246,129,65,7,99,110,174,54,74,182,81,234,142,37,72,110,220,255,64,119,10,188,111,191,228,1,205,9,204,143,56,62,125,84,106,225,131,97,192,43,240,157,161,75,168,247,44,175,65,81,192,48,21,157,167,80,191,130,161,75,85,186,174,42,117,1,68,252,204,138,254,203,152,21,13,64,144,195,207,238,229,54,103,247,159,245,211,85,191,141,168,32,234,85,46,118,12,5,199,4,19,217,203,202,156,33,143,114,116,60,66,40,58,77,208,237,171,26,72,175,114,205,248,87,137,62,210,143,151,197,167,210,241,122,150,104,122,154,2,70,102,83,19,36,141,136,199,42,79,229,71,86,194,109,31,236,80,166,17,230,109,1,40,28,46,224,56,20,230,47,100,254,116,208,76,169,157,241,175,3,70,85,31,38,245,58,33,80,145,237,8,22,71,224,158,156,31,249,81,87,247,230,199,237,96,167,123,63,243,79,156,206,203,160,54,124,68,253,215,132,235,57,185,92,238,55,59,210,104,71,26,183,180,71,12,255,224,192,65,154,72,244,8,164,10,248,46,207,30,92,1,80,244,31,189,138,88,216,218,63,100,227,116,57,119,94,135,5,126,255,32,191,163,61,209,194,88,248,112,139,173,43,69,134,3,160,151,137,25,98,239,166,19,123,208,180,31,120,30,191,75,183,179,126,180,125,92,107,105,206,138,28,67,139,3,188,230,184,255,121,13,181,45,160,114,202,194,123,87,55,124,97,164,82,95,232,216,117,62,5,90,176,82,167,52,160,153,174,168,105,146,91,248,81,79,249,97,138,133,170,245,229,132,61,5,149,224,246,194,213,61,12,109,44,136,235,95,219,133,220,27,93,36,93,124,180,81,141,152,220,170,163,229,197,124,171,232,48,70,251,106,119,150,20,16,49,119,247,42,132,36,76,254,124,177,66,175,9,1,39,92,127,195,171,198,34,2,64,144,179,72,40,151,110,89,229,42,125,33,238,16,220,228,51,203,8,1,68,145,253,133,118,93,163,129,22,13,248,65,12,4,63,101,210,70,170,138,203,14,246,54,194,195,27,107,241,175,35,171,49,52,106,121,45,36,152,85,215,132,78,167,34,18,167,245,152,133,134,170,120,182,10,146,191,37,2,205,47,125,20,203,44,88,81,32,150,223,220,218,238,254,30,212,167,221,115,156,82,226,137,220,221,97,3,139,202,33,9,27,26,126,40,215,25,126,9,82,208,49,217,14,161,81,196,61,60,87,254,213,194,81,216,161,151,209,166,222,230,24,128,117,140,92,4,203,254,170,253,249,88,90,112,226,18,44,122,39,158,158,56,69,204,159,5,179,51,197,233,139,216,102,226,206,248,15,78,112,214,126,67,28,40,38,98,190,178,206,67,94,245,254,160,101,176,32,157,26,132,83,252,228,87,242,32,127,160,112,210,224,133,149,115,41,30,16,200,69,89,81,77,144,12,106,182,73,54,28,53,195,28,216,179,179,136,35,141,102,234,177,240,34,186,106,145,245,3,84,48,251,157,245,11,217,111,227,138,42,67,114,211,177,37,103,16,71,152,72,117,123,36,213,202,56,124,227,84,8,45,229,149,165,214,69,244,169,55,68,62,94,104,228,74,205,123,222,17,7,172,158,227,74,206,149,67,175,171,251,185,121,151,223,63,35,229,32,49,190,209,120,137,69,213,214,19,150,187,177,28,12,158,153,126,149,171,167,234,120,129,109,32,157,180,75,66,56,233,115,127,230,157,32,34,143,156,31,230,168,174,125,118,195,249,243,165,81,246,10,144,15,103,139,55,173,7,59,136,69,172,54,132,165,140,78,77,230,33,169,129,188,71,209,109,161,8,57,57,199,143,31,164,43,58,130,1,110,145,31,229,13,46,149,94,244,106,76,238,105,107,1,183,177,10,61,225,94,185,116,58,183,95,225,22,119,19,248,28,13,123,125,108,158,64,184,77,245,153,162,217,227,208,41,185,211,235,41,153,181,54,166,165,11,154,55,21,184,209,192,249,44,164,160,29,229,159,82,156,198,241,183,114,83,137,186,151,148,31,21,197,216,145,32,13,50,22,241,137,39,71,28,142,160,215,107,221,45,202,104,227,110,186,12,150,145,240,51,49,44,196,115,224,238,149,189,134,99,67,241,62,157,240,114,247,195,26,200,141,97,147,249,23,150,174,10,13,219,81,73,58,242,96,250,243,15,49,218,58,230,104,252,175,150,123,86,185,84,90,198,6,36,0,99,72,28,166,238,115,231,171,249,179,71,174,68,156,227,17,198,79,73,142,99,144,20,80,62,80,191,142,46,71,9,243,6,8,214,116,72,190,106,161,19,185,100,9,187,64,94,86,203,174,156,245,222,95,54,30,148,19,11,50,112,96,61,237,159,173,7,154,127,175,79,48,97,89,78,126,66,171,204,158,195,27,226,205,222,157,89,251,90,125,37,212,27,97,3,141,247,175,50,121,7,187,68,196,181,202,167,189,57,84,81,222,23,27,84,130,176,98,66,240,207,18,23,28,163,163,194,45,37,129,202,170,97,189,0,81,238,0,39,199,163,35,211,206,247,65,29,116,242,67,102,235,13,136,232,230,114,146,187,7,254,142,26,121,16,237,5,160,201,114,94,178,199,95,212,241,45,112,180,188,72,86,114,189,155,149,149,163,210,112,101,12,69,225,75,202,223,28,242,90,215,156,169,224,245,135,128,92,148,217,131,208,255,25,135,117,136,5,104,185,249,161,228,214,16,105,204,9,182,135,153,220,101,244,160,207,58,182,118,185,240,57,245,123,13,112,182,106,229,220,90,29,86,215,96,147,232,2,55,131,225,137,68,245,89,141,252,97,3,129,155,216,223,98,116,45,78,85,141,161,74,215,7,150,171,225,59,78,221,152,236,14,117,100,208,158,86,13,185,124,87,157,111,40,187,182,124,173,71,173,23,199,52,155,190,134,11,23,64,25,215,39,115,231,173,77,72,114,54,252,116,178,59,221,106,241,119,254,30,226,241,204,233,113,197,96,146,0,41,67,3,231,126,12,218,202,22,171,114,249,176,134,160,19,216,31,229,118,226,62,242,126,126,42,127,130,68,218,218,81,202,106,217,191,25,177,82,97,81,36,232,137,58,90,216,190,117,235,20,194,144,76,178,27,213,13,208,18,29,118,126,49,98,203,179,128,237,100,32,242,189,212,6,210,210,188,161,205,13,124,119,13,215,112,41,183,176,215,168,210,182,111,1,115,2,239,141,8,177,124,112,48,197,2,239,11,99,4,36,77,69,47,244,19,153,61,19,2,96,176,7,112,122,131,169,25,189,116,171,49,12,121,162,79,154,74,251,50,233,182,63,180,224,118,49,253,21,20,16,31,144,184,93,174,231,244,183,13,49,225,189,211,73,185,49,110,142,25,226,45,176,233,204,74,33,16,205,88,131,92,157,170,175,68,170,61,53,116,165,16,27,182,160,181,87,241,15,151,85,107,76,167,129,25,172,127,184,138,153,222,228,125,64,44,45,32,12,227,148,106,152,83,240,166,54,235,32,190,12,242,164,123,189,53,194,141,104,43,202,110,4,168,119,245,232,179,178,198,1,224,87,86,160,31,19,140,233,102,191,204,4,98,138,163,191,106,24,213,47,208,82,137,132,131,16,253,84,25,144,90,159,148,16,196,84,166,61,160,101,229,227,93,118,59,87,66,16,128,59,96,131,250,20,184,150,205,91,227,201,62,35,79,180,172,173,85,197,106,153,238,229,60,204,65,193,230,94,101,177,134,6,165,53,171,142,208,155,2,11,4,202,127,54,17,142,117,227,121,128,204,192,147,147,92,189,5,224,148,72,18,83,101,126,124,228,153,242,123,229,247,92,221,6,73,227,250,87,167,194,129,187,73,38,185,109,217,240,193,88,50,178,180,151,54,197,187,137,190,166,233,1,103,204,88,31,127,185,29,65,1,29,254,223,14,83,167,215,114,248,30,173,89,173,187,69,5,105,117,15,106,94,173,63,227,25,230,190,136,168,177,175,107,91,126,254,34,188,25,118,48,12,226,130,153,162,57,47,181,212,79,160,97,64,157,246,90,53,43,149,76,102,15,195,107,58,242,84,172,29,81,198,113,81,251,138,182,154,111,30,171,129,56,17,45,214,153,112,117,203,174,40,38,234,236,32,4,112,225,26,187,195,246,252,9,218,69,160,223,178,54,148,81,8,134,151,75,248,63,224,240,48,75,250,221,85,46,100,50,3,70,64,102,111,160,155,233,59,147,184,57,61,6,126,79,176,16,185,94,166,33,135,78,42,75,140,208,140,44,153,187,64,103,119,160,236,16,239,74,218,219,212,207,110,53,30,76,248,40,111,98,44,20,113,204,233,109,135,96,107,39,163,203,125,45,157,152,71,239,175,174,159,147,80,111,93,38,253,228,154,225,181,101,12,241,127,65,49,189,5,85,151,237,213,143,14,104,138,54,52,27,4,132,67,35,156,86,157,73,16,229,222,245,110,79,165,179,56,179,53,218,229,100,58,87,149,48,231,64,63,115,67,3,172,6,186,115,154,60,53,214,152,149,89,234,37,143,82,255,64,28,183,93,112,39,70,185,57,0,199,9,61,175,219,41,76,37,176,82,125,65,53,160,214,105,62,153,244,222,96,205,6,178,85,41,240,113,0,96,149,38,3,195,18,152,41,246,3,103,29,110,134,30,101,75,46,103,199,184,20,230,8,55,120,4,229,168,35,43,7,28,161,143,87,27,87,79,255,186,44,195,158,155,181,119,81,172,217,107,95,98,55,243,186,66,105,48,224,123,232,84,156,20,10,156,208,204,52,34,228,136,97,242,200,246,211,67,202,40,241,91,92,253,9,54,72,131,221,106,178,32,44,182,4,225,193,37,20,249,249,231,10,206,18,71,254,221,187,172,88,204,6,127,138,102,7,208,75,147,219,199,177,79,36,170,101,207,177,109,95,143,217,41,199,80,183,201,2,254,12,55,23,198,14,255,69,245,138,155,129,227,167,168,130,156,135,14,96,93,48,99,143,107,126,92,117,143,112,108,193,228,84,13,41,186,27,172,92,201,149,116,19,112,197,116,209,128,102,1,55,152,177,28,37,34,50,83,41,199,74,178,59,111,67,118,35,252,36,33,87,28,170,17,215,47,90,154,124,137,15,14,211,59,75,59,30,77,0,49,37,225,191,87,101,127,214,227,160,99,174,234,82,148,235,16,241,219,147,170,127,221,250,116,39,218,156,72,227,172,55,0,79,188,76,51,222,232,24,36,62,94,154,3,61,230,146,114,253,0,128,58,253,90,72,211,242,38,39,133,153,161,119,105,195,152,225,208,105,140,80,217,186,196,157,21,116,230,116,139,25,159,143,118,128,77,201,238,247,228,15,168,4,133,148,21,148,12,44,241,7,115,17,129,176,202,46,130,122,129,235,141,223,85,21,199,65,181,169,52,174,161,153,62,25,164,115,213,89,138,199,103,79,200,165,135,249,244,27,209,178,240,129,211,61,9,111,157,147,119,36,119,255,110,130,84,49,210,225,247,100,26,121,127,163,160,26,79,99,24,77,65,32,178,109,36,27,253,173,110,183,11,14,211,57,130,254,124,104,165,219,31,70,97,14,194,39,61,26,141,125,228,126,194,184,101,160,204,106,128,144,106,103,171,18,246,129,220,85,172,151,123,5,73,155,192,175,91,157,239,61,237,116,170,65,233,56,19,49,114,168,190,3,214,53,250,90,213,244,88,101,30,229,248,124,15,71,141,27,172,235,21,129,211,72,61,172,112,170,128,135,96,196,221,255,27,176,105,188,183,121,33,37,149,53,131,226,233,29,167,234,218,109,53,185,152,36,248,53,61,235,78,21,201,214,210,163,12,251,187,45,188,137,126,127,237,92,234,91,240,225,38,194,57,213,251,237,171,30,99,52,14,49,84,101,252,237,7,166,122,114,32,107,32,207,239,136,168,178,12,11,241,233,230,146,132,18,83,233,41,172,17,6,161,42,113,87,40,255,185,1,146,128,5,240,126,131,71,42,54,124,205,2,122,71,30,222,229,40,134,142,102,97,239,151,177,1,230,231,49,123,219,28,129,91,152,112,13,154,81,197,226,255,112,158,178,177,55,181,108,138,185,245,29,186,21,73,188,209,154,200,89,116,235,198,144,36,87,248,22,7,200,122,7,148,44,42,87,140,238,204,95,231,252,0,136,0,22,39,70,123,125,165,113,227,172,146,163,128,158,36,52,91,19,36,245,27,150,138,141,11,67,239,224,65,24,116,101,7,39,46,142,172,164,243,148,0,33,226,59,47,203,137,156,241,66,250,157,30,204,101,143,134,98,238,155,226,25,184,136,219,89,100,193,11,143,71,139,243,230,151,0,249,1,78,26,32,93,104,157,67,97,164,248,86,124,146,93,74,222,228,167,55,53,100,135,216,109,13,64,37,106,177,200,200,182,92,251,69,31,243,89,80,198,14,132,203,72,103,28,104,217,24,97,223,113,11,29,178,191,210,46,162,255,68,99,8,237,213,162,152,193,183,121,203,19,108,182,29,86,26,192,103,220,103,205,154,179,197,9,22,73,127,175,146,38,119,210,0,24,180,21,245,215,204,91,186,119,138,183,239,15,155,231,248,133,39,24,101,144,236,10,230,54,174,227,73,21,110,10,160,241,232,131,14,212,127,232,59,122,65,146,54,163,9,189,190,121,88,170,62,194,14,204,152,245,38,131,37,91,81,72,114,29,115,239,182,56,44,156,159,177,180,82,160,93,97,86,183,236,50,95,85,39,71,181,225,152,143,63,123,117,34,44,109,160,166,229,240,91,138,102,54,180,173,44,50,80,42,124,7,50,124,211,239,21,94,197,185,239,213,107,142,64,95,124,125,17,180,97,189,101,52,48,19,112,12,70,9,212,177,54,118,66,84,147,236,248,26,124,95,103,135,254,124,49,112,186,99,120,90,8,194,191,88,57,242,65,61,10,104,246,197,252,19,159,58,194,75,173,242,103,8,115,84,69,238,149,26,15,159,182,141,132,119,70,29,53,20,143,46,163,204,6,236,59,45,185,172,89,119,83,38,144,36,222,96,151,26,99,195,163,170,133,92,159,214,53,150,116,90,176,69,145,130,15,172,140,217,215,101,163,115,161,65,101,8,7,183,113,213,134,58,175,130,251,143,173,248,168,135,60,159,30,194,68,208,119,120,2,40,178,227,247,161,77,47,136,46,244,163,72,65,158,25,225,195,61,132,182,204,177,186,200,81,2,65,105,212,72,94,203,232,217,182,123,251,228,160,1,161,204,123,20,37,1,77,208,179,45,149,181,122,102,190,123,213,164,231,41,216,130,234,248,208,251,252,220,84,209,67,47,61,220,5,142,162,26,236,121,142,248,132,255,65,122,203,196,102,191,187,2,195,127,255,193,92,49,91,186,154,39,156,29,211,172,49,104,245,114,153,223,211,199,249,35,130,160,128,0,152,176,183,20,236,113,193,108,26,255,11,237,102,133,245,94,115,114,10,89,229,214,221,99,149,30,99,37,246,10,26,26,39,92,123,170,73,211,127,227,54,30,86,133,159,112,225,91,148,100,174,149,75,143,14,140,20,44,64,212,5,243,8,116,63,30,97,42,123,20,73,212,85,207,83,122,27,251,233,84,10,17,236,232,83,200,127,119,143,163,204,220,167,59,231,20,106,186,222,191,8,40,234,21,25,180,13,116,250,152,224,174,75,3,205,38,173,215,236,151,185,121,254,244,154,239,17,53,106,164,61,49,116,216,118,94,150,35,181,26,238,66,49,211,221,132,146,166,115,39,136,36,205,230,179,31,197,51,148,165,109,38,70,37,148,52,44,209,250,98,58,246,225,103,198,101,26,25,196,207,8,166,21,88,252,175,253,10,88,107,157,19,225,61,12,246,221,37,239,186,167,137,142,135,222,128,174,62,95,216,38,141,157,45,232,97,217,173,203,234,116,129,69,206,189,94,221,12,54,139,186,247,184,16,200,121,244,104,8,7,35,111,47,188,10,140,92,73,143,206,203,72,122,184,20,102,197,130,64,150,63,96,239,8,132,111,217,84,91,198,32,43,100,138,241,15,160,42,190,253,193,184,164,124,29,210,96,67,224,221,182,29,218,129,149,29,128,174,98,88,88,125,56,40,255,120,5,0,87,174,42,150,90,112,201,183,169,19,57,195,191,12,58,244,235,132,25,145,72,146,214,8,125,100,135,12,5,102,97,248,174,24,159,90,33,43,187,6,61,212,241,225,190,219,252,197,123,129,164,108,123,55,230,4,153,166,105,234,15,85,216,23,56,32,3,41,110,68,146,172,133,202,98,41,7,47,152,35,255,168,106,241,226,222,77,244,52,185,65,252,227,32,66,38,11,172,60,28,28,103,84,1,1,205,182,190,28,189,102,253,43,1,191,148,116,10,227,18,81,93,80,239,157,232,215,180,163,165,161,109,177,71,150,244,144,208,160,110,22,174,60,206,43,103,121,55,103,114,115,173,238,13,10,227,251,41,176,216,158,229,216,55,234,128,128,20,167,106,181,86,163,130,215,110,149,191,10,227,215,8,214,154,178,181,15,19,0,247,250,97,74,43,157,55,94,174,41,41,9,199,97,20,91,32,18,10,43,98,240,247,203,20,250,117,160,44,229,202,187,64,54,124,15,184,169,129,27,160,240,26,61,255,60,166,60,144,209,84,55,187,186,168,13,124,125,29,17,100,249,227,62,205,78,179,163,168,139,168,21,38,83,239,151,74,43,66,2,92,72,71,94,216,134,238,20,45,158,213,164,73,57,80,47,198,184,130,223,227,71,132,133,235,177,85,174,142,124,172,200,54,229,40,126,60,76,92,216,153,56,241,174,66,141,90,226,3,30,68,234,71,187,163,112,146,255,22,143,170,204,3,127,179,81,139,160,37,77,246,128,220,196,158,153,73,177,65,199,119,29,197,144,130,248,206,155,253,108,213,124,7,223,221,162,146,134,242,65,99,162,107,120,247,214,207,96,150,169,131,208,218,221,28,24,112,208,23,1,130,142,232,56,104,45,33,158,95,255,123,31,74,76,120,178,155,213,6,195,164,8,8,69,241,197,127,83,169,21,167,19,94,143,252,33,159,248,241,170,153,147,1,149,199,201,131,170,79,236,212,209,143,107,98,24,123,56,33,193,85,247,64,225,135,210,78,145,57,16,145,71,170,20,133,87,235,4,166,239,100,82,235,81,50,223,9,193,52,49,86,129,190,196,82,165,107,63,115,161,98,33,20,193,29,42,151,205,252,124,72,245,48,181,67,7,13,21,127,59,226,188,144,129,112,244,192,121,213,80,42,196,1,13,107,108,78,0,40,121,225,148,237,234,209,216,238,9,147,226,254,96,89,212,72,193,106,75,135,74,227,67,255,92,191,81,188,124,226,149,152,142,15,159,195,238,114,55,255,166,157,230,59,148,170,166,151,65,213,104,253,253,112,150,82,147,137,27,214,100,247,65,81,92,47,86,217,7,45,120,81,130,31,236,243,76,78,3,45,105,172,220,71,48,220,94,196,249,163,193,133,50,236,205,20,55,2,63,14,127,69,113,212,204,12,58,79,89,86,29,61,199,201,64,149,6,144,182,150,129,31,18,167,120,248,82,107,25,143,128,27,161,28,25,153,183,217,238,78,186,106,92,27,202,219,165,96,0,216,234,169,73,101,39,182,113,217,240,170,116,172,221,250,233,48,49,242,83,227,92,181,184,72,230,180,21,15,108,135,25,38,153,25,124,227,26,149,73,236,39,211,244,149,58,183,132,26,223,219,174,144,117,233,219,165,205,157,159,222,184,52,47,241,201,123,65,24,44,55,215,177,168,250,179,115,190,227,123,158,163,179,224,69,196,66,207,254,243,101,221,193,140,250,4,28,222,52,96,138,160,33,218,64,118,214,234,201,152,148,91,178,111,107,144,142,6,182,102,72,188,34,213,181,26,223,58,255,103,81,17,47,169,11,245,224,123,148,215,237,186,107,75,152,90,202,166,22,149,197,5,246,238,78,76,229,106,199,94,127,195,0,45,82,6,159,103,96,138,231,71,46,107,59,216,39,43,12,221,27,214,56,155,145,66,187,169,250,235,78,211,179,239,183,198,163,93,5,196,24,174,143,225,106,139,89,98,13,127,207,184,194,30,1,165,198,169,8,197,118,86,163,221,138,23,209,61,116,79,99,233,43,130,60,244,85,229,243,172,123,148,200,120,192,127,211,52,11,159,41,95,212,230,188,169,156,137,29,212,12,148,168,148,133,243,44,241,139,127,24,246,220,227,125,209,97,60,52,162,192,146,49,161,92,138,112,189,128,59,126,125,46,207,60,79,231,174,152,209,68,223,205,2,38,14,91,116,159,255,28,27,178,248,164,104,158,79,69,214,234,157,12,75,163,83,253,245,202,61,213,176,6,197,230,29,208,166,253,194,254,235,29,141,241,70,249,15,62,0,148,163,135,52,122,40,96,87,31,179,152,51,216,133,184,122,198,203,60,115,218,191,193,16,178,25,148,252,112,104,103,252,36,92,221,28,179,43,199,198,151,128,100,252,217,161,249,34,201,172,118,52,180,252,104,7,223,44,116,102,212,21,40,224,184,55,163,210,21,207,161,239,51,54,155,41,133,18,67,48,3,165,130,251,4,79,214,57,72,130,157,212,144];function C(e,t,n){var r=e.gl,i=5,o=.1,a=.5,s=175/180*3.141593,c=115/180*3.141593,u=173/180*3.141593,d=116/180*3.141593,l=2.04203545,f=0,p=0,h=0,m=[],g=[0,1,3,4,6,7,9,10,12,13,15,16,18,19,21,22,24,26,29,31,34,36,39,41,44,46,49,51,54,56,59,61,64,65,66,67,68,69,70,72,73,74,75,76,77,79,80,81,82,83,84,85,87,88,89,90,91,92,94,95,96,97,98,99,101,102,103,104,105,106,107,109,110,111,112,113,114,116,117,118,119,120,121,123,124,125,126,127,128,129,131,132,133,134,135,136,138,139,140,141,142,143,145,146,147,148,149,150,151,153,154,155,156,157,158,160,161,162,163,164,165,166,168,169,170,171,172,173,175,176,177,178,179,180,182,183,184,185,186,187,188,190,191,192,193,194,195,197,198,199,200,201,202,204,205,206,207,208,209,210,212,213,214,215,216,217,219,220,221,222,223,224,226,226,226,227,227,227,228,228,228,229,229,229,230,230,231,231,231,232,232,232,233,233,233,234,234,235,235,235,236,236,236,237,237,237,238,238,239,239,239,240,240,240,241,241,241,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,250,250,250,251,251,251,252,252,252,253,253,253,254,254,254,255],y=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,32,33,35,36,37,39,40,42,43,44,46,47,49,50,51,53,54,56,57,58,59,61,62,63,64,66,67,68,69,71,72,73,74,76,77,78,79,81,82,83,84,86,87,88,90,91,92,93,95,96,97,98,100,101,102,103,105,106,107,108,110,111,112,113,115,116,117,118,120,121,122,124,125,126,127,129,130,131,132,134,135,136,137,139,140,141,142,144,145,146,147,149,150,151,152,154,155,156,158,159,160,161,163,164,165,166,168,169,170,171,173,174,175,176,178,179,180,181,183,184,185,186,188,189,190,192,193,194,195,197,198,199,200,202,203,204,205,207,208,209,210,212,213,214,215,217,218,219,220,222,223,224,226,226,226,227,227,228,228,229,229,230,230,231,231,232,232,233,233,234,234,234,235,235,236,236,237,237,238,238,239,239,240,240,241,241,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,250,250,250,251,251,251,252,252,252,253,253,253,254,254,254,255],b=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,43,44,45,46,47,48,50,51,52,53,54,55,56,58,59,60,61,62,63,65,66,67,68,69,70,72,73,74,76,77,78,80,81,83,84,85,87,88,89,91,92,94,95,96,98,99,100,102,103,105,106,107,109,110,111,113,114,116,117,118,120,121,122,124,125,127,128,129,131,132,133,135,136,138,139,140,142,143,144,146,147,149,150,151,153,154,155,157,158,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,192,193,193,194,195,195,196,197,197,198,199,199,200,201,201,202,203,203,204,205,205,206,207,207,208,209,209,210,211,211,212,213,213,214,215,215,216,217,217,218,219,219,220,221,221,222,223,223,224,225,225,226,227,227,228,229,229,230,231,231,232,233,233,234,235,235,236,237,237,238,239,239,240,241,241,242,243,243,244,245,245,246,247,247,248,249,249,250,251,251,252,253,253,254,255];this.program=v(r,w),this.setUniforms=function(){var t=r.getUniformLocation(this.program,"u_flipY"),n=r.getUniformLocation(this.program,"u_denoiseLevel");r.uniform1f(n,i),r.uniform1f(t,1);var g=r.getUniformLocation(this.program,"light");r.uniform1f(g,o);var v=r.getUniformLocation(this.program,"redness");r.uniform1f(v,a);var y=r.getUniformLocation(this.program,"skin_he_max"),b=r.getUniformLocation(this.program,"skin_he_min"),S=r.getUniformLocation(this.program,"skin_hc_max"),E=r.getUniformLocation(this.program,"skin_hc_min"),_=r.getUniformLocation(this.program,"skin_hc_axis"),T=r.getUniformLocation(this.program,"facts_rotate_c"),R=r.getUniformLocation(this.program,"facts_rotate_le"),I=r.getUniformLocation(this.program,"facts_rotate_ge");r.uniform1f(y,s),r.uniform1f(b,c),r.uniform1f(S,u),r.uniform1f(E,d),r.uniform1f(_,l),r.uniform1f(T,f),r.uniform1f(R,p),r.uniform1f(I,h);var w=r.getUniformLocation(this.program,"u_originImage");r.activeTexture(r.TEXTURE2),r.bindTexture(r.TEXTURE_2D,e.inputTexture),r.uniform1i(w,2);for(var C=["lighten_lut"],O=[r.TEXTURE3],A=0;A<C.length;A++){var x=r.getUniformLocation(this.program,C[A]);r.activeTexture(O[A]),r.bindTexture(r.TEXTURE_2D,m[A]),r.uniform1i(x,A+3)}},this.setParameters=function(e){void 0!==e.denoiseLevel&&(i=e.denoiseLevel),void 0!==e.lightLevel&&(o=e.lightLevel),void 0!==e.rednessLevel&&(a=e.rednessLevel,this._updateRedness(a)),void 0!==e.lighteningContrastLevel&&this._updateLut(e.lighteningContrastLevel)},this._updateRedness=function(e){var t,n,r=3.141593,i=e,o=i;i>1&&(i=1),i<0&&(i=0),o>1&&(o=1),o<0&&(o=0),f=.8*i,o<.8&&(o=0),(l=(117-4*o)/180*r)<(d=(116-4*o)/180*r)&&(l=d),d<r/2&&(d=r/2),l<r/2&&(l=r/2),(c=(115-4*o)/180*r)<r/2&&(c=r/2),(u=173/180*r)>r&&(u=r),l>r&&(l=r),(s=175/180*r)>r&&(s=r),n=u-l,h=(t=s-u)>.01?f*n/t:f,n=l-d,p=(t=d-c)>.01?f*n/t:f},this._updateLut=function(e){var t=null;0==e&&(t=y),1==e&&(t=b),2==e&&(t=g);for(var n=[new Uint8Array(t)],i=[256],o=[1],a=0;a<n.length;a++)r.bindTexture(r.TEXTURE_2D,m[a]),r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,i[a],o[a],0,r.LUMINANCE,r.UNSIGNED_BYTE,n[a])},this._init=function(){for(var e=[new Uint8Array(y)],t=[256],n=[1],i=0;i<e.length;i++){var o=r.createTexture();r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,t[i],n[i],0,r.LUMINANCE,r.UNSIGNED_BYTE,e[i]),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),m.push(o)}},this._init()}var O=!1;function A(){this.programs=[];var e=this,t=null,n=null;e.gl=null,e.inputTexture=null;var r=[],i=[],o=0,a=0;e._initGl=function(n,s){e.inputTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,e.inputTexture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR);for(var c=0;c<4;c++){var u=t.createTexture();t.bindTexture(t.TEXTURE_2D,u),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),c<2?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n,s,0,t.RGBA,t.UNSIGNED_BYTE,null):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,s,n,0,t.RGBA,t.UNSIGNED_BYTE,null);var d=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,d),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,u,0),r.push(u),i.push(d)}t.viewport(0,0,n,s),o=n,a=s},e.render=function(s){if(t){var c=0;a==s.videoWidth&&o===s.videoHeight&&(c=2),t.viewport(0,0,s.videoWidth,s.videoHeight),t.bindTexture(t.TEXTURE_2D,e.inputTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,s);for(var u=O?e.programs.length-1:0,d=0;d<=u;d++){var l=e.programs[d].program;t.useProgram(l);var f=t.getUniformLocation(l,"u_image");e.programs[d].setUniforms(),t.bindFramebuffer(t.FRAMEBUFFER,i[c+d%2]),t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.TRIANGLES,0,6),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,r[c+d%2]),t.uniform1i(f,0)}t.useProgram(n);var p=t.getUniformLocation(n,"u_flipY");t.uniform1f(p,-1),t.bindFramebuffer(t.FRAMEBUFFER,null),t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.TRIANGLES,0,6)}},e.setEnableBeauty=function(e){O=e},e.init=function(r,i,o){if("undefined"==typeof WebGLRenderingContext)throw new Error("NOT_SUPPORT");t=o.getContext("webgl"),e.gl=t,e._initGl(r,i),e.programs.push(new b(this,r,i)),e.programs.push(new E(this,r,i)),e.programs.push(new T(this,r,i)),e.programs.push(new I(this,r,i)),e.programs.push(new C(this,r,i)),n=e.programs[0].program},e.release=function(){e.gl=null,t=null,n=null,e.inputTexture=null,e.programs=[],r=[],i=[]},e.setDenoiseLevel=function(t){e.programs.forEach((function(e){e.setParameters&&e.setParameters({denoiseLevel:t})}))},e.setLightLevel=function(t){e.programs.forEach((function(e){e.setParameters&&e.setParameters({lightLevel:t})}))},e.setRednessLevel=function(t){e.programs.forEach((function(e){e.setParameters&&e.setParameters({rednessLevel:t})}))},e.setContrastLevel=function(t){e.programs.forEach((function(e){e.setParameters&&e.setParameters({lighteningContrastLevel:t})}))},e.setSize=function(t,n){e.programs.forEach((function(e){e.setSize&&e.setSize(t,n)}))}}A._instance=null,A.getInstance=function(){return A._instance||(A._instance=new A),A._instance},t.a={addVideoEffectCapability:function(e){e.videoEffect={canvas:null,video:null,fps:30,stopChromeBackgroundLoop:null,enableBeauty:!1,denoiseLevel:5,lightLevel:.35,rednessLevel:.5,lighteningContrastLevel:1,videoContextInited:!1,originVideoTrack:null,canvasVideoTrack:null,ctx:null},e._initVideoContext=function(){if(e.videoEffect.videoContextInited)throw new Error("Failed to init video context. Already inited");if(!e.stream)throw new Error("Failed to init video context. Local Stream not initialized");e.videoEffect.originVideoTrack=e.stream.getVideoTracks()[0],e.attributes&&e.attributes.maxFrameRate&&(e.videoEffect.fps=e.attributes.maxFrameRate),e.videoEffect.videoContextInited=!0},e._renderWithWebGL=function(t){return new Promise((function(n){e.videoEffect.canvas||(e.videoEffect.canvas=document.createElement("canvas")),e.videoEffect.video||(e.videoEffect.video=document.createElement("video")),e.videoEffect.video.setAttribute("autoplay",""),e.videoEffect.video.setAttribute("muted",""),e.videoEffect.video.muted=!0,e.videoEffect.video.setAttribute("playsinline",""),e.videoEffect.video.setAttribute("style","display:none"),e.videoEffect.video.srcObject=t;var r=t.getVideoTracks()[0].getSettings(),i=r.width,o=r.height;e.videoEffect.canvas.setAttribute("width",i),e.videoEffect.canvas.setAttribute("height",o),e.videoEffect.video.setAttribute("width",i),e.videoEffect.video.setAttribute("height",o);var a=A.getInstance();a.init(e.videoEffect.video.width,e.videoEffect.video.height,e.videoEffect.canvas),a.setDenoiseLevel(e.videoEffect.denoiseLevel),a.setLightLevel(e.videoEffect.lightLevel),a.setRednessLevel(e.videoEffect.rednessLevel),a.setContrastLevel(e.videoEffect.lighteningContrastLevel),e.videoEffect.video.addEventListener("playing",(function t(){var r=e.videoEffect.canvas.captureStream(e.videoEffect.fps);e.videoEffect.video.removeEventListener("playing",t,!0),n([r.getVideoTracks()[0],e.videoEffect.video])}),!0),e.videoEffect.video.play()}))},e._disableEffect=function(){e.videoEffect.videoContextInited||e._initVideoContext();var t=e.videoEffect.originVideoTrack;if(!t)return f.default.warning("Video track is null, fail to disable video effect!"),Promise.resolve();if(e.pc&&e.pc.peerConnection&&e.pc.peerConnection){var n=(e.pc.peerConnection&&e.pc.peerConnection.getSenders()).find((function(e){return e&&e.track&&"video"==e.track.kind}));if(n&&n.replaceTrack&&t)return n.replaceTrack(t)}return Promise.resolve()},e._releaseEffect=function(){var t;return t=e.videoEffect.enableBeauty?e._disableEffect():Promise.resolve(),A.getInstance().release(),e.videoEffect.videoContextInited=!1,e.videoEffect.canvasVideoTrack=null,t},e._enableEffect=function(){return e.videoEffect.videoContextInited||e._initVideoContext(),e.videoEffect.originVideoTrack?e.videoEffect.canvasVideoTrack?(e._showEffectInLocalPlayer(),e._replaceWithCanvasTrack()):e._renderWithWebGL(e.stream).then((function(t){var n=c()(t,2),r=n[0],i=n[1];e.videoEffect.canvasVideoTrack=r;var o=A.getInstance();return requestAnimationFrame((function t(){e.videoEffect.enableBeauty&&o.render(i),e.videoEffect.videoContextInited&&requestAnimationFrame(t)})),u.isChrome()&&document.addEventListener("visibilitychange",(function(){document.hidden,document.hidden?e.videoEffect.stopChromeBackgroundLoop=function(e,t){var n=1/t,r=new AudioContext,i=r.createGain();i.gain.value=0,i.connect(r.destination),function t(){var a=r.createOscillator();a.onended=t,a.connect(i),a.start(0),a.stop(r.currentTime+n),e(r.currentTime),o&&(a.onended=function(){r.close()})}();var o=!1;return function(){o=!0}}((function(){e.videoEffect.enableBeauty&&o.render(i)}),e.videoEffect.fps):e.videoEffect.stopChromeBackgroundLoop&&(e.videoEffect.stopChromeBackgroundLoop(),e.videoEffect.stopChromeBackgroundLoop=null)}),!1),e._showEffectInLocalPlayer(),e._replaceWithCanvasTrack()})):(f.default.warning("Video track is null, fail to enable video effect!"),Promise.resolve())},e._showEffectInLocalPlayer=function(){if(e.player){var t=e.player.div.children[0];if("none"!==t.style.display&&(e.player.div.appendChild(e.videoEffect.canvas),"video"===t.tagName.toLowerCase())){var n=t.getAttribute("style");e.videoEffect.canvas.setAttribute("style",n),"none"!==t.style.display&&(t.style.display="none")}}},e._removeEffectFromLocalPlayer=function(){if(e.player&&e.player.div&&e.videoEffect.enableBeauty&&e.videoEffect.canvas){e.player.div.removeChild(e.videoEffect.canvas);var t=e.player.div.children[0];"video"===t.tagName.toLowerCase()&&(e.videoEffect.canvas.style.display="none",t.style.display="block")}},e._replaceWithCanvasTrack=function(){var t=null;return e.pc&&e.pc.peerConnection&&e.pc.peerConnection&&(t=(e.pc.peerConnection&&e.pc.peerConnection.getSenders()).find((function(e){return e&&e.track&&"video"==e.track.kind}))),t&&t.replaceTrack&&e.videoEffect.canvasVideoTrack?t.replaceTrack(e.videoEffect.canvasVideoTrack):Promise.resolve()},e.setBeautyEffectOptions=function(){var t=a()(i.a.mark((function t(n,r){var o,a=arguments;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Object(l.checkValidBoolean)(n,"enabled"),o=A.getInstance(),e.videoEffect.enableBeauty==n){t.next=14;break}if(o.setEnableBeauty(n),!n){t.next=9;break}return t.next=7,e._enableEffect();case 7:t.next=12;break;case 9:return e._removeEffectFromLocalPlayer(),t.next=12,e._releaseEffect();case 12:e.videoEffect.enableBeauty=n,d.report.reportApiInvoke(e.sid,{callback:null,options:a,name:"Stream.setBeautyEffectOptions",tag:"tracer"});case 14:if(n){t.next=16;break}return t.abrupt("return");case 16:if(!r){t.next=20;break}Object(l.checkValidObject)(r,"options"),t.next=21;break;case 20:return t.abrupt("return");case 21:if(void 0!==r.smoothnessLevel&&(Object(l.checkValidFloatNumber)(r.smoothnessLevel,"smoothnessLevel",0,1),e.videoEffect.denoiseLevel=10*r.smoothnessLevel,e.videoEffect.denoiseLevel<.1&&(e.videoEffect.denoiseLevel=.1),o.setDenoiseLevel(e.videoEffect.denoiseLevel)),void 0!==r.lighteningLevel&&(Object(l.checkValidFloatNumber)(r.lighteningLevel,"lighteningLevel",0,1),e.videoEffect.lightLevel=r.lighteningLevel/2,e.videoEffect.lightLevel<.01&&(e.videoEffect.lightLevel=.01),o.setLightLevel(e.videoEffect.lightLevel)),void 0!==r.rednessLevel&&(Object(l.checkValidFloatNumber)(r.rednessLevel,"rednessLevel",0,1),e.videoEffect.rednessLevel=r.rednessLevel,e.videoEffect.rednessLevel<.01&&(e.videoEffect.rednessLevel=.01),o.setRednessLevel(e.videoEffect.rednessLevel)),void 0===r.lighteningContrastLevel){t.next=29;break}if(0===r.lighteningContrastLevel||1===r.lighteningContrastLevel||2===r.lighteningContrastLevel){t.next=27;break}throw new Error("Invalid lighteningContrastLevel: The value should be 0, 1 or 2.");case 27:e.videoEffect.lighteningContrastLevel=parseFloat(r.lighteningContrastLevel),o.setContrastLevel(e.videoEffect.lighteningContrastLevel);case 29:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},restoreVideoEffect:function(e){return e.videoEffect.enableBeauty?e._enableEffect():Promise.resolve()},disableVideoEffect:function(e){return e._releaseEffect?e._releaseEffect():Promise.resolve()},applyEffectInPlayer:function(e){e.videoEffect.enableBeauty&&e.videoEffect.canvas&&e._showEffectInLocalPlayer()},removeEffectFromLocalPlayer:function(e){e._removeEffectFromLocalPlayer()},replaceWithCanvasTrack:function(e){return e.videoEffect.enableBeauty?e._replaceWithCanvasTrack():Promise.resolve()},checkVideoEffectEnabled:function(e){return!!(e.videoEffect.enableBeauty&&e.videoEffect&&e.videoEffect.videoContextInited)&&(f.default.error("Operation not permitted: ".concat("VIDEO_EFFECT_ENABLED")),"VIDEO_EFFECT_ENABLED")}}},function(e,t){function n(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(i,o){var a=e.apply(t,r);function s(e){n(a,i,o,s,c,"next",e)}function c(e){n(a,i,o,s,c,"throw",e)}s(void 0)}))}}},function(e,t,n){"use strict";var r=n(38),i=Object.prototype.toString;function o(e){return"[object Array]"===i.call(e)}function a(e){return void 0===e}function s(e){return null!==e&&"object"==typeof e}function c(e){return"[object Function]"===i.call(e)}function u(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),o(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:o,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:function(e){return null!==e&&!a(e)&&null!==e.constructor&&!a(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:s,isUndefined:a,isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:c,isStream:function(e){return s(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:u,merge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]=n}for(var r=0,i=arguments.length;r<i;r++)u(arguments[r],n);return t},deepMerge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]="object"==typeof n?e({},n):n}for(var r=0,i=arguments.length;r<i;r++)u(arguments[r],n);return t},extend:function(e,t,n){return u(t,(function(t,i){e[i]=n&&"function"==typeof t?r(t,n):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(7),i=n.n(r),o=n(8),a=n(0),s=n(5);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u=new function(){var e=Object(o.b)();return e.devicesHistory={},e.states={UNINIT:"UNINIT",INITING:"INITING",INITED:"INITED"},e.state=e.states.UNINIT,e.deviceStates={ACTIVE:"ACTIVE",INACTIVE:"INACTIVE"},e.deviceReloadTimer=null,e._init=function(t,n){e.state=e.states.INITING,e.devicesHistory={},e._reloadDevicesInfo((function(){e.state=e.states.INITED,e.dispatchEvent({type:"inited"}),t&&t()}),(function(t){a.default.warning("Device Detection functionality cannot start properly."),e.state=e.states.UNINIT,n&&n(t)}))},e._enumerateDevices=function(e,t){if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return a.default.warning("enumerateDevices() not supported."),t&&t("enumerateDevices() not supported");navigator.mediaDevices.enumerateDevices().then((function(t){e&&setTimeout((function(){e(t)}),0)})).catch((function(e){t&&t(e)}))},e._reloadDevicesInfo=function(t,n){var r=[];e._enumerateDevices((function(n){var o=Date.now();for(var s in n.forEach((function(t){var n=e.devicesHistory[t.deviceId];if((n?n.state:e.deviceStates.INACTIVE)!=e.deviceStates.ACTIVE){var i=n||{initAt:o};i.device=t,i.state=e.deviceStates.ACTIVE,r.push(i),e.devicesHistory[t.deviceId]=i}e.devicesHistory[t.deviceId].lastReloadAt=o})),e.devicesHistory){var c=e.devicesHistory[s];c&&c.state==e.deviceStates.ACTIVE&&c.lastReloadAt!==o&&(c.state=e.deviceStates.INACTIVE,r.push(c)),c.lastReloadAt=o}e.state==e.states.INITED&&r.forEach((function(t){var n=i()({},t);switch(t.device.kind){case"audioinput":n.type="recordingDeviceChanged";break;case"audiooutput":n.type="playoutDeviceChanged";break;case"videoinput":n.type="cameraChanged";break;default:a.default.warning("Unknown device change",n),n.type="unknownDeviceChanged"}e.dispatchEvent(n)})),t&&t()}),n)},e.getDeviceById=function(t,n,r){e.getDevices((function(e){for(var i=0;i<e.length;i++){var o=e[i];if(o&&o.deviceId===t)return n&&n(o)}return r&&r()}))},e.searchDeviceNameById=function(t){var n=e.devicesHistory[t];return n?n.device.label||n.device.deviceId:null},e.getDevices=function(t,n){e._enumerateDevices(t,(function(e){n&&n(e.name+": "+e.message)}))},e.getVideoCameraIdByLabel=function(t,n,r){e.getCameras((function(e){var i,o=function(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(a.label===t)return n&&n(a.deviceId)}}catch(e){o.e(e)}finally{o.f()}return r&&r(s.default.NOT_FIND_DEVICE_BY_LABEL)}),r)},e.getRecordingDevices=function(t,n){return e._enumerateDevices((function(e){var n=e.filter((function(e){return"audioinput"==e.kind}));t&&t(n)}),(function(e){n&&n(e)}))},e.getPlayoutDevices=function(t,n){return e._enumerateDevices((function(e){var n=e.filter((function(e){return"audiooutput"==e.kind}));t&&t(n)}),(function(e){n&&n(e)}))},e.getCameras=function(t,n){return e._enumerateDevices((function(e){var n=e.filter((function(e){return"videoinput"==e.kind}));t&&t(n)}),(function(e){n&&n(e)}))},e._init((function(){navigator.mediaDevices&&navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",(function(){e._reloadDevicesInfo()})),e.deviceReloadTimer=setInterval(e._reloadDevicesInfo,5e3)})),e}},function(e,t,n){"use strict";n.r(t),n.d(t,"_getReconnectCSTimer",(function(){return w})),n.d(t,"_setClientConnectionStateRecord",(function(){return C})),n.d(t,"getGatewayList",(function(){return A})),n.d(t,"getUserAccount",(function(){return k}));var r=n(11),i=n.n(r),o=n(12),a=n.n(o),s=n(17),c=n.n(s),u=n(2),d=(n(4),n(0)),l=n(14),f=n(1),p=n(5),h=function(e,t){var n=!1,r=0,i=Object(u.getParameter)("PROXY_CS"),o=Object(u.getParameter)("CHOOSE_SERVER_FRAGEMENT_LENGTH"),a=0,s={command:"convergeAllocateEdge",sid:e.sid,appId:e.appId,token:e.token,uid:e.uid,cname:e.cname,ts:Math.floor(Date.now()/1e3),version:u.VERSION,seq:0,requestId:1},c=function(c){var u=(new Date).getTime();m("https://"+c+"/api/v1",s,(function(s,p){if(s)return d.default.debug("["+e.clientId+"] Request proxy server failed: ",s),r++,f.report.requestProxyAppCenter(e.sid,{lts:u,succ:!1,APAddr:c,workerManagerList:null,ec:JSON.stringify(s),response:JSON.stringify({err:s,res:p})}),r>=i.length&&t&&t("Get proxy server failed: request all failed"),void(!(r%o)&&r<i.length&&(a++,l()));if(!n)if((p=JSON.parse(p)).json_body){var h=JSON.parse(p.json_body);if(d.default.debug("["+e.clientId+"] App return:",h.servers),200!==h.code)s="Get proxy server failed: response code ["+h.code+"], reason [ "+h.reason+"]",r++,d.default.debug("["+e.clientId+"] "+s),f.report.requestProxyAppCenter(e.sid,{lts:u,succ:!1,APAddr:c,workerManagerList:null,ec:s,response:JSON.stringify({err:s,res:p})}),r>=i.length&&t&&t(s),!(r%o)&&r<i.length&&(a++,l());else{n=!0;var m=v(h.servers);f.report.requestProxyAppCenter(e.sid,{lts:u,succ:!0,APAddr:c,workerManagerList:JSON.stringify(m),ec:null,response:JSON.stringify({res:p})}),t&&t(null,m)}}else d.default.debug("["+e.clientId+"] Get proxy server failed: no json_body"),f.report.requestProxyAppCenter(e.sid,{lts:u,succ:!1,APAddr:c,workerManagerList:null,ec:"Get proxy server failed: no json_body",response:JSON.stringify({res:p})})}))},l=function(){for(var e=a*o,t=e;t<Math.min(i.length,e+o);t++){var n=i[t];c(n)}};l()},m=function(e,t,n){var r={service_name:"webrtc_proxy",json_body:JSON.stringify(t)};Object(l.post)(e,r,(function(e){n&&n(null,e)}),(function(e){n&&n(e)}),{"X-Packet-Service-Type":0,"X-Packet-URI":61})},g=function(e,t,n){var r=!1,i=0,o={command:"request",gatewayType:"http",appId:e.appId,cname:e.cname,uid:e.uid+"",sdkVersion:"2.3.1",sid:e.sid,seq:1,ts:+new Date,requestId:3,clientRequest:{appId:e.appId,cname:e.cname,uid:e.uid+"",sid:e.sid}};t.map((function(a){var s=(new Date).getTime();!function(e,t,n){Object(l.post)(e,t,(function(e){n&&n(null,e)}),(function(e){n&&n(e)}))}("https://"+a+":4000/v2/machine",o,(function(o,c){if(o)return d.default.debug("["+e.clientId+"] Request worker manager failed: ",o),i++,f.report.requestProxyWorkerManager(e.sid,{lts:s,succ:!1,workerManagerAddr:a,ec:JSON.stringify(o),response:JSON.stringify({res:c})}),void(i>=t.length&&n&&n("requeet worker manager server failed: request failed"));if(!r){if(!(c=JSON.parse(c)).serverResponse)return n&&n("requeet worker manager server failed: serverResponse is undefined");r=!0,f.report.requestProxyWorkerManager(e.sid,{lts:s,succ:!0,workerManagerAddr:a,ec:JSON.stringify(o),response:JSON.stringify({res:c})}),n&&n(null,{address:a,serverResponse:c.serverResponse})}}))}))},v=function(e){if(!e||[]instanceof Array==0)return[];var t=[];return e.forEach((function(e){var n;e.address&&e.tcp?(e.address.match(/^[\.\:\d]+$/)?n="".concat(e.address.replace(/[^\d]/g,"-"),".edge.agora.io"):(d.default.info("["+joinInfo.clientId+"] "+"Cannot recognized as IP address ".concat(e.address,". Used As Host instead")),n="".concat(e.address,":").concat(e.tcp)),t.push(n)):d.default.error("["+joinInfo.clientId+"] Invalid address format ",e)})),t},y=n(21),b=function(e,t,n,r){var i=Object(u.getParameter)("WEBCS_DOMAIN").concat(Object(u.getParameter)("WEBCS_DOMAIN_BACKUP_LIST")),o=Object(u.getParameter)("PROXY_SERVER_TYPE3");i=i.map((function(e,t){return"".concat(o[(t+1)%o.length],"/ap/?url=").concat(e)}));var a,s=0,c=!0,h=Object(u.getParameter)("CHOOSE_SERVER_FRAGEMENT_LENGTH"),m=0,g=function(g){!function(e,t,n,r,i){var o=Date.now(),a=function(e,r){try{f.report.joinChooseServer2(n.sid,{lts:o,succ:!e,csAddr:t,serverList:r&&r.gateway_addr,cid:r&&r.cid+"",uid:r&&r.uid+"",ec:e,chooseServerIp:r&&r.detail&&r.detail[502]})}catch(e){}},s=function(r,i){var a=Date.now();try{f.report.joinWebProxyAP({lts:a,sid:n.sid,cname:n.cname,cid:n.cid,uid:n.uid,sucess:r?-1:1,elapse:a-o,eventType:e,apServerAddr:t,turnServerAddrList:JSON.stringify(i),errorCode:r||"0"})}catch(e){}},c=Object(u.getParameter)("AREA_SETTING").reduce((function(e,t,n){var r=Object(y.getAreaCodeByArea)(t);return r?0===n?r:"".concat(e,",").concat(r):e}),""),h={appid:n.token,client_ts:Date.now(),opid:133,sid:n.sid,request_bodies:[{uri:22,buffer:{cname:n.cname,detail:{11:c,6:n.stringUid},key:n.token,service_ids:[11,i?20:18],uid:n.uid||0}}]};t="https://".concat(t,"/api/v2/transpond/webrtc?v=2"),Object(l.postFormData)(t,h,(function(e){var o=function(e){return new RegExp(/10102\d{2}$/).test(e)?"NO_SERVICE_AVAILABLE":p.APErrorCode[e]||e};try{var c,l,f=JSON.parse(e);if(30===(f=f.response_body)[0].uri&&0!==f[0].buffer.code){var h=o(f[0].buffer.code);return s(h,f),r(h)}if(4096===f[0].buffer.flag?(l=f[0].buffer,c=f[1].buffer):(l=f[1].buffer,c=f[0].buffer),0!==c.code)return h=o(c.code),d.default.error("[".concat(n.clientId,"] requestProxyServer failed: ").concat(h)),s(h,c),r(h);if(!c.edges_services||!c.edges_services instanceof Array)return s("UNEXPECTED_ERROR",c),r("UNEXPECTED_ERROR");var m=Object(u.getParameter)("GATEWAY_DOMAINS"),g=0;if(t.indexOf(m[1])>-1&&(g=1),0===c.edges_services.length)return s("EMPTY_PROXY_LIST",c),r("EMPTY_PROXY_LIST");var v=c.edges_services.map((function(e){if(e.ip)return e.ip=i?"".concat(e.ip.replace(/[^\d]/g,"-"),".").concat(m[g++%m.length]):"".concat(e.ip),e}));if(s(null,v),0!==l.code)return h=o(l.code),d.default.error("[".concat(n.clientId,"] requestChooseServer failed: ").concat(h)),a(h),r(h);var y=[];if(m=Object(u.getParameter)("GATEWAY_DOMAINS"),g=0,t.indexOf(m[1])>-1&&(g=1),l.edges_services.forEach((function(e){var r;if(e.ip&&e.port){if(!e.ip.match(/^[\.\:\d]+$/))return d.default.info("["+n.clientId+"] "+"Cannot recognized as IP address ".concat(e.ip,". Used As Host instead")),void a("UNEXPECTED_IP");r="".concat(e.ip.replace(/[^\d]/g,"-"),".").concat(m[g++%m.length]);var i=Object(u.getParameter)("PROXY_SERVER_TYPE3");r=/sd-rtn/.test(t)?"".concat(i[0],"/ws/?h=").concat(r,"&p=").concat(e.port):"".concat(i[1],"/ws/?h=").concat(r,"&p=").concat(e.port),y.push(r)}else d.default.error("["+n.clientId+"] Invalid address format ",e)})),!y.length)return d.default.error("["+n.clientId+"] Empty Address response",f),a("EMPTY_ADDRESS_RESPONSE"),r("EMPTY_ADDRESS_RESPONSE");l.ticket=l.cert;var b={gateway_addr:y,uid:l.uid,cid:l.cid,vid:l.detail&&l.detail[8],res:l,detail:f.detail};a(null,b),r(null,{gatewayServers:b,turnServers:v})}catch(e){return d.default.error("[".concat(n.clientId,"] requestProxyServer failed with unexpected body "),e),s("UNEXPECTED_ERROR"),r("UNEXPECTED_ERROR")}}),(function(e,t){"timeout"===e.type?(s("REQUEST_PROXY_SERVER_TIME_OUT"),r("REQUEST_PROXY_SERVER_TIME_OUT")):(s("REQUEST_PROXY_SERVER_FAILED"),r("REQUEST_PROXY_SERVER_FAILED"))}))}(e,g,t,(function(e,r){e?(s++,d.default.error("[".concat(t.clientId,"] request ").concat(g," failed: ").concat(e)),e&&-1===p.JOIN_PROXY_RETRY_LIST.indexOf(e)&&(a=e),s===i.length&&(a||(a="RETRYABLE_ERROR"),n(a)),!(s%h)&&s<i.length&&(m++,v())):c&&(/sd-rtn/.test(r.gatewayServers.gateway_addr[0])?Object(u.setParameter)("NGINX",o[0]):Object(u.setParameter)("NGINX",o[1]),c=!1,n(null,r))}),r)},v=function(){for(var e=m*h,t=e;t<Math.min(i.length,e+h);t++){var n=i[t];g(n)}};v()},S=n(13),E=n(29),_=n.n(E),T=n(30),R={},I={},w=function(e){return R[e]},C=function(e,t){I[e]=t},O=function(e,t,n,r,i,o){var a=(new Date).getTime(),s=t,c="";t.multiIP&&t.multiIP.gateway_ip&&(c={vocs_ip:[t.multiIP.uni_lbs_ip],vos_ip:[t.multiIP.gateway_ip]});var h=Object(u.getParameter)("AREA_SETTING").reduce((function(e,t,n){var r=Object(y.getAreaCodeByArea)(t);return r?0===n?r:"".concat(e,",").concat(r):e}),""),m={appid:t.token,opid:133,client_ts:+new Date,sid:t.sid,request_bodies:[{uri:22,buffer:{cname:t.cname,detail:{5:c?JSON.stringify(c):void 0,6:t.stringUid,11:h},key:t.token,service_ids:[11],uid:t.uid||0}}]};Object(l.postFormData)(e,m,(function(i){try{var c=JSON.parse(i),l=(c=c.response_body[0].buffer).code}catch(e){var h="requestChooseServer failed with unexpected body "+i;return d.default.error("["+s.clientId+"]",h),r(h,void 0,void 0,o)}if(l)return y=new RegExp(/10102\d{2}$/).test(l)?"NO_SERVICE_AVAILABLE":p.APErrorCode[c.code]||l,f.report.joinChooseServer(t.sid,{lts:a,succ:!1,csAddr:e,serverList:null,ec:y,chooseServerIp:c&&c.detail&&c.detail[502]}),r("Get server node failed ["+y+"]",e,y,o);var m=[],g=Object(u.getParameter)("GATEWAY_DOMAINS"),v=0;if(e.indexOf(g[1])>-1&&(v=1),c.edges_services.forEach((function(e){var t;e.ip&&e.port?(e.ip.match(/^[\.\:\d]+$/)?t="".concat(e.ip.replace(/[^\d]/g,"-"),".").concat(g[v++%g.length],":").concat(e.port):(d.default.info("["+s.clientId+"] "+"Cannot recognized as IP address ".concat(e.ip,". Used As Host instead")),t="".concat(e.ip,":").concat(e.port)),m.push(t)):d.default.error("["+s.clientId+"] Invalid address format ",e)})),!m.length){d.default.error("["+s.clientId+"] Empty Address response",c);var y="EMPTY_ADDRESS_RESPONSE";return f.report.joinChooseServer(t.sid,{lts:a,succ:!1,csAddr:e,serverList:null,ec:y,chooseServerIp:c&&c.detail&&c.detail[502]}),r("Get server node failed ["+y+"]",e,y,o)}c.ticket=c.cert;var b={gateway_addr:m,uid:c.uid,cid:c.cid,vid:c.detail&&c.detail[8],res:c,uni_lbs_ip:c.detail};return n(b,e)}),(function(e,n){"timeout"===e.type?(f.report.joinChooseServer(t.sid,{lts:a,succ:!1,csAddr:n,serverList:null,ec:"timeout"}),r("Connect choose server timeout",n,void 0,o)):(f.report.joinChooseServer(t.sid,{lts:a,succ:!1,csAddr:n,serverList:null,ec:e.httpErrorCode||"server_wrong"}),r("Connect choose server error",n,void 0,o))}))},A=function(e,t,n){var r=!1,i=null,o=1,a=1,s=e.clientId,c=function t(a,c){if(!r){var l=[];!function(e,t,n){var r,i=(new Date).getTime(),o=!1,a=0,s=0,c=Object(u.getParameter)("WEBCS_DOMAIN"),l=c.length,h=Object(u.getParameter)("WEBCS_DOMAIN_BACKUP_LIST"),m=h.length,g=Object(u.getParameter)("CHOOSE_SERVER_FRAGEMENT_LENGTH"),v=0,b=0,S=function(n,r){var a;try{a=n.res.detail[8]}catch(t){d.default.debug("["+e.clientId+"] get vid failed",t)}if(o)f.report.joinChooseServer(e.sid,{lts:i,succ:!0,csAddr:r,serverList:n.gateway_addr,cid:n.cid+"",uid:n.uid+"",ec:null,vid:a,chooseServerIp:n.res&&n.res.detail&&n.res.detail[502]},!1);else{if(clearTimeout(R),o=!0,e.proxyServer)for(var s=n.gateway_addr,c=0;c<s.length;c++){var u=s[c].split(":");n.gateway_addr[c]=e.proxyServer+"/ws/?h="+u[0]+"&p="+u[1]}t(n),f.report.joinChooseServer(e.sid,{lts:i,succ:!0,csAddr:r,serverList:n.gateway_addr,cid:n.cid+"",uid:n.uid+"",ec:null,vid:a,chooseServerIp:n.res&&n.res.detail&&n.res.detail[502]},!0)}},E=function(t,i,o,c){"domain"===c&&a++,"backup"===c&&s++,d.default.error("["+e.clientId+"]",t,i,o),o&&-1===p.JOIN_CS_RETRY_LIST.indexOf(o)&&(r=o),a===l&&s===m&&n(r),"domain"===c&&!(a%g)&&a<l&&(v++,_()),"backup"===c&&!(s%g)&&s<m&&(b++,T())},_=function t(){for(var n=v*g,r=n;r<Math.min(l,n+g);++r){var i;if("string"==typeof c[r]){var o=c[r];i=e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(o+"/api/v2/transpond/webrtc?v=2"):"https://".concat(o,"/api/v2/transpond/webrtc?v=2");var s=Object(y.getAreaCodeByWebCS)(o);d.default.debug("["+e.clientId+"] "+"Connect to choose_server: ".concat(i,", ").concat(s)),O(i,e,S,E,0,"domain")}else a++,d.default.error("["+e.clientId+"] Invalid Host",c[r]),r===n+g-1&&r<l-1-1&&(v++,t())}};_();var T=function t(){if(!o)for(var n=b*g,r=n;r<Math.min(m,n+g);r++){var i;if("string"==typeof h[r]){var a=h[r];i=e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(a+"/api/v2/transpond/webrtc?v=2"):"https://".concat(a,"/api/v2/transpond/webrtc?v=2");var c=Object(y.getAreaCodeByWebCS)(a);d.default.debug("["+e.clientId+"] "+"Connect to backup_choose_server: ".concat(i,", ").concat(c)),O(i,e,S,E,0,"backup")}else s++,d.default.error("["+e.clientId+"] Invalid Host",h[r]),r===n+g-1&&r<h-1-1&&(v++,t())}},R=setTimeout(T,1e3)}(e,(function(t){r=!0,l=t,clearTimeout(i),I[s]!==S.a.DISCONNECTED&&I[s]!==S.a.DISCONNECTING?c&&c(l,null):d.default.debug("[".concat(e.clientId,"] Request gateway list success when connection state is ").concat(I[s]))}),(function(r){if(r)return d.default.info("["+e.clientId+"] Join failed: "+r),void(n&&n(r));if(I[s]===S.a.DISCONNECTED||I[s]===S.a.DISCONNECTING)return d.default.debug("[".concat(e.clientId,"] Request gateway list falied when connection state is ").concat(I[s])),void(n&&n("OPERATION_ABORT"));d.default.debug("["+e.clientId+"] Request gateway list will be restart in "+o+"s"),i=setTimeout((function(){t(a,c)}),1e3*o),R[s]=i;var l=Object(u.getParameter)("AP_BACKOFF_MAX_TIME");o=o>=l?l:2*o}))}},l=function n(){!function(e,t){h(e,(function(n,r){if(n)return t&&t(n);d.default.debug("["+e.clientId+"] getProxyServerList: ",r),g(e,r,t)}))}(e,(function(r,o){if(r){d.default.debug("["+e.clientId+"]",r),d.default.debug("["+e.clientId+"] Request proxy will be restart in "+a+"s"),i=setTimeout((function(){n()}),1e3*a),R[s]=i;var l=Object(u.getParameter)("AP_BACKOFF_MAX_TIME");a=a>=l?l:2*a}else{clearTimeout(i);var p=o.address;e.proxyServer=p;var h={mode:"manual",url:o.address,tcpport:o.serverResponse.tcpport||"3433",udpport:o.serverResponse.udpport||"3478",username:o.serverResponse.username||"test",credential:o.serverResponse.password||Object(u.getParameter)("TURN_SERVER_PASSWORD"),forceturn:!0};h.tcpport+="",h.udpport+="",e.turnServers=[],e.turnServers.push(h),f.report.setProxyServer(p),d.default.setProxyServer(p),c(p,t)}}))};e.useProxyServer?1==e.proxyServerType?l():2==e.proxyServerType?function n(){!function(e,t){h(e,(function(n,r){return n?t&&t(n):(d.default.debug("["+e.clientId+"] getProxyServerList: ",r),t&&t(null,{address:r[0],serverResponse:{tcpport:"443",udpport:"3478",username:"test",password:"111111"}}))}))}(e,(function(r,o){if(r)return d.default.debug("["+e.clientId+"]",r),d.default.debug("["+e.clientId+"] Request proxy will be restart in "+a+"s"),i=setTimeout((function(){n()}),1e3*a),R[s]=i,void(a=a>=3600?3600:2*a);clearTimeout(i);var l=Object(u.getParameter)("PROXY_SERVER_TYPE2");e.proxyServer=l;var p={mode:"manual",url:o.address,tcpport:o.serverResponse.tcpport||"3433",udpport:o.serverResponse.udpport||"3478",username:o.serverResponse.username||"test",credential:o.serverResponse.password||"111111",forceturn:!0};p.tcpport+="",p.udpport+="",e.turnServers=[],e.turnServers.push(p),f.report.setProxyServer(l),d.default.setProxyServer(l),c(l,t)}))}():3==e.proxyServerType?function r(){b("proxy3",e,(function(o,c){if(o)return"RETRYABLE_ERROR"!==o?n&&n(o):(d.default.debug("["+e.clientId+"]",o),d.default.debug("["+e.clientId+"] Request proxy will be restart in "+a+"s"),i=setTimeout((function(){r()}),1e3*a),R[s]=i,void(a=a>=3600?3600:2*a));var l=c.gatewayServers,p=c.turnServers;clearTimeout(i);var h=Object(u.getParameter)("NGINX");e.proxyServer=h,e.turnServers=[];var m=Object(T.randomString)();p.map((function(t){var n={mode:"manual",url:t.ip,tcpport:"",udpport:t.port||"3478",username:t.username||m,credential:t.password||_()(m).toString(),forceturn:!0};n.tcpport+="",n.udpport+="",e.turnServers.push(n)})),f.report.setProxyServer(h),d.default.setProxyServer(h),t(l)}))}():4==e.proxyServerType?function r(){b("proxy4",e,(function(o,c){if(o)return"RETRYABLE_ERROR"!==o?n&&n(o):(d.default.debug("["+e.clientId+"]",o),d.default.debug("["+e.clientId+"] Request proxy will be restart in "+a+"s"),i=setTimeout((function(){r()}),1e3*a),R[s]=i,void(a=a>=3600?3600:2*a));var l=c.gatewayServers,p=c.turnServers;clearTimeout(i);var h=Object(u.getParameter)("NGINX");e.proxyServer=h,e.turnServers=[];var m=Object(T.randomString)();p.map((function(t){var n={mode:"manual",url:t.ip,tcpport:t.port||"443",udpport:"",username:t.username||m,credential:t.password||_()(m).toString(),forceturn:!1};n.tcpport+="",n.udpport+="",e.turnServers.push(n)})),f.report.setProxyServer(h),d.default.setProxyServer(h),t(l)}))}():5==e.proxyServerType?function r(){b("proxy5",e,(function(o,c){if(o)return"RETRYABLE_ERROR"!==o?n&&n(o):(d.default.debug("["+e.clientId+"]",o),d.default.debug("["+e.clientId+"] Request proxy will be restart in "+a+"s"),i=setTimeout((function(){r()}),1e3*a),R[s]=i,void(a=a>=3600?3600:2*a));var l=c.gatewayServers,p=c.turnServers;clearTimeout(i);var h=Object(u.getParameter)("NGINX");e.proxyServer=h,e.turnServers=[];var m=Object(T.randomString)();p.map((function(t){var n={mode:"manual",url:t.ip,tcpport:t.port||"443",udpport:"",username:t.username||m,credential:t.password||_()(m).toString(),forceturn:!1,useTurns:!0};n.tcpport+="",n.udpport+="",e.turnServers.push(n)})),f.report.setProxyServer(h),d.default.setProxyServer(h),t(l)}),!0)}():l():c(null,t)},x=function(e,t,n,r,i){var o=Date.now();r=r||t.stringUid;var a={sid:t.sid,opid:10,appid:t.appId,string_uid:r};return new Promise((function(i,s){Object(l.post)(e+"".concat(-1===e.indexOf("?")?"?":"&","action=stringuid"),a,(function(c){try{var u=JSON.parse(c),l=u.code}catch(i){var h="requestUserAccount failed with unexpected body "+c;return d.default.error("["+t.clientId+"]",h),s({retryable:!0,info:h,url:e,error:"UNEXPECTED_ERROR"}),n&&n.dispatchEvent({type:"error",reason:"USER_ACCOUNT_BODY_NOT_JSON"}),void f.report.reqUserAccount(a.sid,{lts:o,success:!1,serverAddress:e,stringUid:r,uid:null,extend:c,errorCode:"USER_ACCOUNT_BODY_NOT_JSON"})}if(l){var m=!1;return"INTERNAL_SERVER_ERROR"===(v=p.StringUidErrorCode[u.code%1e4]||"REQ_ACCOUNT_ERR_".concat(l))&&(m=!0),n&&n.dispatchEvent({type:"error",reason:v}),f.report.reqUserAccount(a.sid,{lts:o,success:!1,serverAddress:e,stringUid:r,uid:null,errorCode:v,extend:a}),s({retryable:m,info:h="Get String Uid Failed ["+v+"]",url:e,error:v})}var g=u.uid;if(!(g>0&&g<Math.pow(2,32))){d.default.error("["+t.clientId+"] "+"Invalid Uint Uid ".concat(r," => ").concat(g),u);var v="INVALID_UINT_UID_".concat(g);return n&&n.dispatchEvent({type:"error",reason:v}),f.report.reqUserAccount(a.sid,{lts:o,success:!1,serverAddress:e,stringUid:r,uid:null,errorCode:v,extend:a}),s({retryable:!0,error:v,info:"Get String Uid failed ["+v+"]",url:e})}i({uid:g,url:e}),f.report.reqUserAccount(a.sid,{lts:o,success:!0,serverAddress:e,stringUid:r,uid:g,errorCode:null,extend:a})}),(function(e,t){if("timeout"===e.type){var i="USER_ACCOUNT_TIMEOUT";n&&n.dispatchEvent({type:"error",reason:i}),f.report.reqUserAccount(a.sid,{lts:o,success:!1,serverAddress:t,stringUid:r,uid:null,errorCode:i,extend:a}),s({retryable:!0,info:i,url:t,error:i})}else{var c="USER_ACCOUNT_SERVER_WRONG_".concat(e.type);n&&n.dispatchEvent({type:"error",reason:c}),f.report.reqUserAccount(a.sid,{lts:o,success:!1,serverAddress:t,stringUid:r,uid:null,errorCode:c,extend:a}),s({retryable:!0,info:c,url:t,error:c})}}),{"X-Packet-Service-Type":0,"X-Packet-URI":72})}))},k=function(e,t,n){Date.now();var r,o=Object(u.getParameter)("ACCOUNT_REGISTER"),s=!1,l=Object(u.getParameter)("ACCOUNT_REGISTER_RETRY_TIMEOUT"),f=null,p=null,h=new Promise(function(){var h=c()(a.a.mark((function c(h,m){var g,v,y;return a.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:f=h,p=m,r=0;case 3:if(!(r<Object(u.getParameter)("ACCOUNT_REGISTER_RETRY_COUNT_MAX"))){c.next=33;break}if(!s){c.next=6;break}return c.abrupt("return");case 6:return g=o[r%o.length],v=e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(g+"/api/v1"):"https://".concat(g,"/api/v1"),c.prev=8,c.delegateYield(a.a.mark((function r(){var i;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e.proxyServer,r.next=3,x(v,e,t,n);case 3:if(i=r.sent,!s){r.next=6;break}return r.abrupt("return",{v:void 0});case 6:s=!0,setTimeout((function(){d.default.debug("Get UserAccount Successfully",i),f(i)}),0);case 8:case"end":return r.stop()}}),r)}))(),"t0",10);case 10:if(y=c.t0,"object"!==i()(y)){c.next=13;break}return c.abrupt("return",y.v);case 13:c.next=30;break;case 15:if(c.prev=15,c.t1=c.catch(8),!s){c.next=19;break}return c.abrupt("return");case 19:if(!c.t1.retryable){c.next=27;break}return(l=Math.ceil(l*Object(u.getParameter)("ACCOUNT_REGISTER_RETRY_RATIO")))>Object(u.getParameter)("ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX")&&(l=Object(u.getParameter)("ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX")),d.default.error("".concat(c.t1.info," ").concat(c.t1.url," Will Fetch User Account in ").concat(l/1e3," seconds")),c.next=25,new Promise((function(e){setTimeout(e,l)}));case 25:c.next=30;break;case 27:d.default.error("Get UserAccount Error: ".concat(c.t1.info," ").concat(c.t1.url),c.t1.error),s=!0,p(c.t1.error);case 30:r++,c.next=3;break;case 33:case"end":return c.stop()}}),c,null,[[8,15]])})));return function(e,t){return h.apply(this,arguments)}}());return h.cancel=function(){s||(s=!0,p({info:"Request Cancelled",retryable:!1}))},h.isFinished=function(){return s},h}},function(e,t,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o,a,s=i(n(0));!function(e){e.CHINA="CHINA",e.ASIA="ASIA",e.NORTH_AMERICA="NORTH_AMERICA",e.EUROPE="EUROPE",e.JAPAN="JAPAN",e.INDIA="INDIA",e.OCEANIA="OCEANIA",e.SOUTH_AMERICA="SOUTH_AMERICA",e.AFRICA="AFRICA",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL"}(o||(o={})),t.AREAS=o,function(e){e.CHINA="CN",e.ASIA="AS",e.NORTH_AMERICA="NA",e.EUROPE="EU",e.JAPAN="JP",e.INDIA="IN",e.OCEANIA="OC",e.SOUTH_AMERICA="SA",e.AFRICA="AF",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL"}(a||(a={}));var c={ASIA:{CODE:a.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],NGINX:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:a.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],NGINX:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:a.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],NGINX:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:a.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","\tuap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],NGINX:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:a.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],NGINX:["india.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:a.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],NGINX:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:a.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],NGINX:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:a.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],NGINX:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:a.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],NGINX:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:a.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],NGINX:["africa.webrtc-cloud-proxy.sd-rtn.com"]}};t.AREA_DOMAIN_MAP=c;var u={GLOBAL:{ASIA:[o.CHINA,o.JAPAN,o.INDIA],EUROPE:[],NORTH_AMERICA:[],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},d=Object.keys(u[o.GLOBAL]),l=[o.CHINA,o.NORTH_AMERICA,o.EUROPE,o.ASIA,o.JAPAN,o.INDIA,o.OCEANIA,o.SOUTH_AMERICA,o.AFRICA];t.getAreaCodeByConfig=function(e){var t=e.areaCode,n=e.excludedArea;return n?function(e,t){var n,i=[];if("string"==typeof e&&(e=[e]),t&&!e.includes(o.GLOBAL)&&(i=e),t||(i=e),t&&e.includes(o.GLOBAL)){var a=[o.GLOBAL,o.OVERSEA],s=Object.keys(c);if(t===o.GLOBAL)throw new Error("Can not set excludedArea to 'GLOBAL'");if(t===o.CHINA)i=[o.OVERSEA];else if(n=t,d.includes(n)){var f=function(e){return void 0===e&&(e=""),u[o.GLOBAL][e]||[]}(t),p=r(a,[t],f);i=s.filter((function(e){return!p.includes(e)}))}else if(function(e){var t=!1;return d.forEach((function(n){u.GLOBAL[n].includes(e)&&(t=!0)})),t}(t)){var h=function(e){void 0===e&&(e="");var t="";return d.forEach((function(n){u.GLOBAL[n].includes(e)&&(t=n)})),t}(t),m=r(a,[h,t]);i=s.filter((function(e){return!m.includes(e)}))}else i=e;i=function(e){var t=[];return l.forEach((function(n){e.includes(n)&&t.push(n)})),t.concat(e.filter((function(e){return!l.includes(e)})))}(i)}return i}(t,n):t},c.CHINA={CODE:a.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],NGINX:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]},t.getAreaCodeByWebCS=function(e){for(var t=Object.keys(c),n=0;n<t.length;n++){var r=t[n],i=c[r];if(i.WEBCS_DOMAIN.includes(e)||i.WEBCS_DOMAIN_BACKUP_LIST.includes(e))return i.CODE===a.OVERSEA?a.ASIA+","+a.EUROPE+","+a.AFRICA+","+a.NORTH_AMERICA+","+a.SOUTH_AMERICA+","+a.OCEANIA:i.CODE}},t.getAreaCodeByArea=function(e){return e===o.OVERSEA?a.ASIA+","+a.EUROPE+","+a.AFRICA+","+a.NORTH_AMERICA+","+a.SOUTH_AMERICA+","+a.OCEANIA:a[e]},t.getAreaDomainConfig=function(e){var t={WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],NGINX:[]};return e.map((function(e){var n=c[e];if(n){var r=Object.keys(n);r?r.map((function(e){"CODE"!==e&&(t[e]=t[e].concat(n[e]))})):s.default.info(e+" is not exist")}else s.default.info(e+" is not exist")})),t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return C})),n.d(t,"b",(function(){return O}));var r=n(7),i=n.n(r),o=n(4),a=n(8),s=function(e){var t=Object(a.b)(e);return t.url=".",t},c=n(0),u=n(15),d=n(5),l=n(2),f=n(1),p=0,h=function(e){var t=s({});t.id=e.id,t.playerId=p++,t.destroyed=!1,t.fit=e.options&&e.options.fit,"contain"!==t.fit&&"cover"!==t.fit&&(t.fit=null),t.url=e.url,t.stream=e.stream.stream,t.peerVideoReady=!1,t.isFreeze=!1,t.freezeTimeCounterList=[],t.freezeCount=0,t.lastFreezeCount=0,t.lastTimeupdateTime=0,t.elementID=e.elementID,t.setAudioOutput=function(e,n,r){var i=t.video||t.audio;return i?i.setSinkId?void i.setSinkId(e).then((function(){return c.default.debug("["+t.id+"] "+"video ".concat(t.id," setAudioOutput ").concat(e," SUCCESS")),i==t.video&&t.audio?t.audio.setSinkId(e):Promise.resolve()})).then((function(){return c.default.debug("["+t.id+"] "+"audio ".concat(t.id," setAudioOutput ").concat(e," SUCCESS")),n&&n()})).catch((function(e){return c.default.error("["+t.id+"] VideoPlayer.setAudioOutput",e),r&&r(e)})):(c.default.error("["+t.id+"] ",d.default.WEB_API_NOT_SUPPORTED),r&&r(d.default.WEB_API_NOT_SUPPORTED)):(c.default.error("["+t.id+"] ",d.default.PLAYER_NOT_FOUND),r&&r(d.default.PLAYER_NOT_FOUND))},t.destroy=function(){c.default.debug("[".concat(t.id,"] destroy ").concat(e.stream.local?"local":"remote"," Player ").concat(t.id)),Object(u.setSrcObject)(t.video,null),Object(u.setSrcObject)(t.audio,null),t.video.load(),t.audio.load(),t.video.pause(),t.video.remove(),t.audio.remove(),t.freezeCheckInterval&&clearInterval(t.freezeCheckInterval),t.destroyed=!0,delete t.resizer,document.getElementById(t.div.id)&&t.parentNode.contains(t.div)&&t.div.remove()&&t.parentNode.removeChild(t.div),["video","audio"].forEach((function(n){t[n];var r=a[n];clearTimeout(r.playDeferTimeout),r.formerMediaState=null;var i={playerId:t.playerId,stateId:r.stateId+1,playDeferTimeout:null,error:!1,status:"aborted",reason:"stop",updatedAt:Date.now()};a[n]=i;var o={type:"player-status-change",playerId:t.playerId,mediaType:n,status:i.status,reason:i.reason,isErrorState:!1,streamId:t.id};c.default.debug("[".concat(t.id,"] Media Player Status Change Triggered by destroy()"),o),e.stream.dispatchEvent(o),f.report.reportApiInvoke(e.stream.sid,{name:"Stream.playerStatusChange",options:o,tag:"tracer"})()}))},t.div=document.createElement("div"),t.div.setAttribute("id","player_"+t.id),e.stream.video?t.div.setAttribute("style","width: 100%; height: 100%; position: relative; background-color: black; overflow: hidden;"):t.div.setAttribute("style","width: 100%; height: 100%; position: relative; overflow: hidden;"),t.video=document.createElement("video"),t.video.setAttribute("id","video"+t.id),e.stream.local&&!e.stream.screen?e.stream.mirror?t.video.setAttribute("style","width: 100%; height: 100%; position: absolute; transform: rotateY(180deg); object-fit: ".concat(t.fit||"cover",";")):t.video.setAttribute("style","width: 100%; height: 100%; position: absolute; object-fit: ".concat(t.fit||"cover",";")):e.stream.video?t.video.setAttribute("style","width: 100%; height: 100%; position: absolute; object-fit: ".concat(t.fit||"cover",";")):e.stream.screen?t.video.setAttribute("style","width: 100%; height: 100%; position: absolute; object-fit: ".concat(t.fit||"contain")):t.video.setAttribute("style","width: 100%; height: 100%; position: absolute; display: none; object-fit: ".concat(t.fit||"cover"));var n={autoplay:!0,muted:!!e.stream.local||!(!o.isSafari()&&"iOS"!==o.getBrowserOS())&&"video_element_muted",playsinline:!0,controls:!1,volume:null},r=i()({},n,e.options);!0!==r.muted||r.volume||(r.volume=0),t.video.setAttribute("autoplay",""),t.video.setAttribute("muted",""),t.video.muted=!0,t.video.autoplay=!0,r.playsinline&&t.video.setAttribute("playsinline",""),r.controls&&t.video.setAttribute("controls",""),r.contains&&(t.video.controls=!0),Number.isFinite(r.volume)&&(t.video.volume=r.volume),t.audio=document.createElement("audio"),t.audio.setAttribute("id","audio"+t.id),!0===r.muted&&t.audio.setAttribute("muted",""),!0===r.muted&&(t.audio.muted=!0),r.playsinline&&t.audio.setAttribute("playsinline",""),Number.isFinite(r.volume)&&(t.audio.volume=r.volume),void 0!==t.elementID?(document.getElementById(t.elementID).appendChild(t.div),t.container=document.getElementById(t.elementID)):(document.body.appendChild(t.div),t.container=document.body),t.parentNode=t.div.parentNode;var a={video:{playerId:t.playerId,stateId:0,playDeferTimeout:null,error:!1,status:"init",reason:null,updatedAt:Date.now()},audio:{playerId:t.playerId,stateId:0,playDeferTimeout:null,error:!1,status:"init",reason:null,updatedAt:Date.now()}};t.mediaElemExists=function(e){for(var t=e,n=0;n<Object(l.getParameter)("MEDIA_ELEMENT_EXISTS_DEPTH")&&t;n++)t=t.parentNode;return!!t};var h=function(e){return t.mediaElemExists(e)?e.paused?"paused":"play":"aborted"},m=function(e,t,n){var r=h(e),i=!0;return"paused"===r?("audio"===t&&!0===n.muted&&(i=!1),n.autoplay||(i=!1)):"play"===r?"video"===t?i=!1:!0===n.muted?e.muted&&(i=!1):e.muted||(i=!1):"aborted"===r&&(i=!1),i},g=function(n){var i,o=this;if(o===t.video?i="video":o===t.audio&&(i="audio"),i){if(n.type||c.default.error("[".concat(t.id,"] Unexpected evt"),n),"video"===i&&o.muted&&o.paused)return c.default.debug("[".concat(t.id,"] auto resume video element")),void o.play();var s=h(o);clearTimeout(a[i].playDeferTimeout),a[i].playDeferTimeout=setTimeout((function(){a[i].playDeferTimeout=null;var u=a[i],d=h(o);if(s===d){var l={playerId:t.playerId,stateId:u.stateId+1,playDeferTimeout:null,error:m(o,i,r),status:h(o),reason:n.type,updatedAt:Date.now()};if(u.status!==l.status){a[i]=l;var p={type:"player-status-change",playerId:t.playerId,mediaType:i,status:l.status,reason:l.reason,isErrorState:l.error,streamId:t.id};c.default.debug("[".concat(t.id,"] Media Player Status Change"),p),e.stream.dispatchEvent(p),f.report.reportApiInvoke(e.stream.sid,{name:"Stream.playerStatusChange",options:p,tag:"tracer"})()}}else c.default.debug("[".concat(t.id,"] Status Change after event Triggered.")+"Stream ".concat(t.id," PlayerId ").concat(t.playerId," mediaType ").concat(i," Status ").concat(s,"=>").concat(d))}),Object(l.getParameter)("PLAYER_STATE_DEFER"))}else c.default.error("[".concat(t.id,"] Unknown media element"),o)};t.video.addEventListener("playing",(function(e){!function e(){t.video.videoWidth*t.video.videoHeight>4?c.default.debug("["+t.id+"] video dimensions:",t.video.videoWidth,t.video.videoHeight):setTimeout(e,50)}()}));var v=0,y=0,b=0;t.freezeCheckInterval=setInterval((function(){Date.now()-t.lastTimeupdateTime>500&&t.peerVideoReady?(t.isFreeze=!0,t.freezeCount+=1):t.isFreeze=!1}),500),t.video.addEventListener("playing",g),t.video.addEventListener("canplay",g),t.video.addEventListener("abort",g),t.video.addEventListener("onerror",g),t.video.addEventListener("suspend",g),t.video.addEventListener("stalled",g),t.video.addEventListener("pause",g),t.audio.addEventListener("playing",g),t.audio.addEventListener("canplay",g),t.audio.addEventListener("abort",g),t.audio.addEventListener("onerror",g),t.audio.addEventListener("suspend",g),t.audio.addEventListener("stalled",g),t.audio.addEventListener("pause",g);var S=t.audio,E="audio";if(e.stream.hasVideo()||e.stream.hasScreen())t.div.appendChild(t.video),t.div.appendChild(t.audio),o.isEdge()?t.video.srcObject=e.stream.stream:(Object(u.attachMediaStream)(t.video,e.stream.stream),Object(u.attachMediaStream)(t.audio,e.stream.stream)),t.video.addEventListener("timeupdate",(function(){var e=Date.now();if((v+=1)<10)t.lastTimeupdateTime=e;else for(e-t.lastTimeupdateTime>500&&(t.peerVideoReady?y+=e-t.lastTimeupdateTime:t.peerVideoReady=!0),b+=e-t.lastTimeupdateTime,t.lastTimeupdateTime=e;b>=6e3;)b-=6e3,t.freezeTimeCounterList.push(Math.min(6e3,y)),y-=6e3,y=Math.max(y,0)}));else{!1!==r.muted&&"video_element_muted"!==r.muted||(t.video.removeAttribute("muted"),t.video.muted=!1),t.video.removeAttribute("autoplay"),t.video.autoplay=!1,t.div.appendChild(t.video),S=t.video,E="video";var _=a.audio,T={playerId:t.playerId,stateId:_.stateId+1,playDeferTimeout:null,error:!1,status:"aborted",reason:"audioonly",updatedAt:Date.now()};a.audio=T;var R={type:"player-status-change",playerId:t.playerId,mediaType:"audio",status:T.status,reason:T.reason,isErrorState:T.error,streamId:t.id};if(c.default.debug("[".concat(t.id,"] Media Player Status Change"),R),Promise.resolve().then((function(){return e.stream.dispatchEvent(R)})),f.report.reportApiInvoke(e.stream.sid,{name:"Stream.playerStatusChange",options:R,tag:"tracer"})(),window.MediaStream&&(o.isSafari()||"iOS"===o.getBrowserOS())){var I=new MediaStream(e.stream.stream.getAudioTracks());Object(u.setSrcObject)(t.video,I)}else Object(u.setSrcObject)(t.video,e.stream.stream)}if(r.autoplay&&S){var w=S.play();w&&w.catch&&w.catch((function(n){if(!t.destroyed&&S){var i=a[E],o={playerId:t.playerId,stateId:i.stateId+1,playDeferTimeout:null,error:m(S,E,r),status:h(S),reason:"error",updatedAt:Date.now()};if(i.status!==o.status){c.default.debug("[".concat(t.id,"] Player ").concat(t.playerId," Status Changed Detected by promise error: ").concat(i.status,"=>").concat(o.status),n),a[E]=o;var s={type:"player-status-change",playerId:t.playerId,mediaType:E,status:o.status,reason:o.reason,isErrorState:o.error,streamId:t.id};c.default.debug("[".concat(t.id,"] Media Player Status Change"),s),e.stream.dispatchEvent(s),f.report.reportApiInvoke(e.stream.sid,{name:"Stream.playerStatusChange",options:s,tag:"tracer"})()}}}))}return t.setAudioVolume=function(e){var n=parseInt(e)/100;isFinite(n)&&(n<0?n=0:n>1&&(n=1),t.video&&(t.video.volume=n),t.audio&&(t.audio.volume=n))},t},m=n(23),g=n(10),v=n(6),y=n(19),b=n(3),S=n(25),E=n(16),_=n(11),T=n.n(_),R=function(e){Object(b.checkValidString)(e,"profileName"),-1===(e=e.toLowerCase()).indexOf("_")&&(e+="_1"),Object(b.checkValidEnum)(e,"profileName",Object.keys(l.SUPPORT_RESOLUTION_LIST));var t=l.SUPPORT_RESOLUTION_LIST[e];t||(e=Object(l.getParameter)("DEFAULT_PROFILE"),t=l.SUPPORT_RESOLUTION_LIST[e]);var n={profileName:e,video:{width:t[0],height:t[1]},attributes:{resolution:"".concat(t[0],"x").concat(t[1]),minFrameRate:t[2],maxFrameRate:t[3],minVideoBW:t[4],maxVideoBW:t[5]}};return t[2]&&(n.video.frameRate=t[2]),t[6]&&t[7]&&(n.screen={width:t[0],height:t[1],frameRate:{min:t[6],max:t[7]}}),n},I=function(e){return Object.keys(l.SUPPORT_RESOLUTION_LIST).filter((function(t){var n=l.SUPPORT_RESOLUTION_LIST[t],r=["width","height","frameRate"];for(var i in r){var o=r[i];if(e[o]&&n[i]){if("number"==typeof e[o].max&&e[o].max<n[i])return!1;if("number"==typeof e[o].min&&e[o].min>n[i])return!1}}return!0})).reverse()},w=function(e){var t=l.AUDIO_PROFILE_SETTINGS[e]||l.AUDIO_PROFILE_SETTINGS.default;return{highQuality:t[0],stereo:t[1],speech:t[2],lowQuality:t[3]}},C=function(e){var t=Object(a.b)();if(t.params=i()({},e),t.stream=e.stream,t.url=e.url,t.onClose=void 0,t.local=!1,t.videoSource=e.videoSource,t.audioSource=e.audioSource,e.video=!(!e.videoSource&&!e.video),t.video=e.video,e.audio=!(!e.audioSource&&!e.audio),t.audio=e.audio,t.screen=!!e.screen,t.screenAudio=!!e.screenAudio,t.screenAttributes={width:1920,height:1080,maxFr:5,minFr:1},t.videoSize=e.videoSize,t.player=void 0,t.audioLevelHelper=null,e.attributes=e.attributes||{},t.attributes=e.attributes,t.microphoneId=e.microphoneId,t.cameraId=e.cameraId,t.facingMode=e.facingMode,t.inSwitchDevice=!1,t.userMuteVideo=!1,t.userMuteAudio=!1,t.peerMuteVideo=!1,t.peerMuteAudio=!1,t.lowStream=null,t.videoWidth=0,t.videoHeight=0,t.streamId=e.streamID,t.userId=null,t.uintId=e.uintUID||null,t.mirror=!1!==e.mirror,t.DTX=e.audioProcessing&&e.audioProcessing.DTX,t.audioProcessing=e.audioProcessing,t.optimizationMode=e.optimizationMode,t.highQuality=!1,t.stereo=!1,t.speech=!1,t.screen||delete t.screen,!(void 0===t.videoSize||t.videoSize instanceof Array&&4===t.videoSize.length))throw Error("Invalid Video Size");function n(){var e={};t.getVideoTrack()===this?(c.default.debug("Video Track Ended"),e.type="videoTrackEnded",e.track=this):t.getAudioTrack()===this?(c.default.debug("Audio Track Ended"),e.type="audioTrackEnded",e.track=this):c.default.debug("Detached Track ended",this.kind,this.label,this),e.type&&t.dispatchEvent(e)}return t.videoSize=[640,480,640,480],void 0!==e.local&&!0!==e.local||(t.local=!0),t.initialized=!t.local,t._streamInitID=null,function(e){e.audioMixing={audioContextInited:!1,defaultVolume:100,inEarMonitoring:"FILE",sounds:{},states:{IDLE:"IDLE",STARTING:"STARTING",BUSY:"BUSY",PAUSED:"PAUSED"},inEarMonitoringModes:{NONE:"NONE",FILE:"FILE",MICROPHONE:"MOCROPHONE",ALL:"ALL"},ctx:null,mediaStreamSource:null,mediaStreamDest:null,buffer:{}},e._initSoundIfNotExists=function(t,n){e.audioMixing.sounds[t]||(e.audioMixing.sounds[t]={soundId:t,state:"IDLE",muted:e.userMuteAudio,filePath:n,volume:e.audioMixing.defaultVolume,startAt:null,startOffset:null,pauseAt:null,pauseOffset:null,resumeAt:null,resumeOffset:null,stopAt:null,options:null,source:null})},e._initSoundIfNotExists(-1),e.loadAudioBuffer=function(t,n,r){var i=f.report.reportApiInvoke(e.sid,{callback:r,name:"Stream.loadAudioBuffer",options:arguments,tag:"tracer"});Object(b.checkValidString)(n,"url",1,1024,!1),Object(b.checkValidString)(t,"id",1,1024,!1);var o=function(t){c.default.error("[".concat(e.streamId,"] loadAudioBuffer Failed: ")+t),i(d.default.LOAD_AUDIO_FAILED)},a=new XMLHttpRequest;a.open("GET",n,!0),a.responseType="arraybuffer",a.onload=function(){if(a.status>400)o("".concat(a.status," ").concat(a.statusText));else{var n=a.response;e.audioMixing.audioContextInited||e._initAudioContext(),e.audioMixing.ctx.decodeAudioData(n,(function(n){e.audioMixing.buffer[t]=n,i(null)}),(function(t){c.default.error("[".concat(e.streamId,"] decodeAudioData Failed: "),t),i(t)}))}},a.onerror=function(){return o("load error")},a.ontimeout=function(){return o("timeout")},a.send()},e.createAudioBufferSource=function(t){var n=f.report.reportApiInvoke(e.sid,{name:"Stream.createAudioBufferSource",options:arguments,tag:"tracer"});if(e.audioMixing.buffer[t.id]){var r=e.audioMixing.buffer[t.id],i=e.audioMixing.ctx.createBufferSource();i.buffer=r;var a=e.audioMixing.ctx.createGain();if(i.connect(a),a.connect(e.audioMixing.mediaStreamDest),i.gainNode=a,t.loop)i.loop=!0,i.start(0,t.playTime/1e3);else if(t.cycle>1)if(Object(o.isChrome)()){i.loop=!0;var s=t.cycle*r.duration*1e3-(t.playTime||0);i.start(0,t.playTime/1e3,s/1e3)}else c.default.warning("[".concat(e.streamId,"] Cycle Param is ignored by current browser")),i.start(0,t.playTime/1e3);else i.start(0,t.playTime/1e3);var u=e.audioMixing.sounds[t.soundId];return u.source=i,e._flushAudioMixingMuteStatus(),i.addEventListener("ended",(function(){i===u.source&&e.dispatchEvent({type:"audioSourceEnded",soundId:t.soundId,source:i,sound:u})})),n(),i}var d="AUDIOBUFFER_NOT_FOUND";return c.default.error("[".concat(e.streamId,"] "),d,t.id),n(!1),!1},e.on("audioSourceEnded",(function(t){var n=t.source,r=t.sound;r&&r.state===e.audioMixing.states.BUSY&&!r.pauseAt&&(r.state=e.audioMixing.states.IDLE,r.startAt=null,r.startOffset=null,r.resumeAt=null,r.resumeOffset=null,n.gainNode&&n.gainNode.disconnect&&n.gainNode.disconnect(),n.buffer=null,e.audioMixing.mediaStreamSource.connect(e.audioMixing.mediaStreamDest))})),e.clearAudioBufferSource=function(){e.audioBufferSource.forEach((function(e){e.stop()}))},e._isSoundExists=function(t){return!!e.audioMixing.sounds[t.soundId]||(c.default.error("SoundId not exists. #".concat(t.soundId)),!1)},e._initAudioContext=function(){if(e.audioMixing.audioContextInited)throw new Error("Failed to init audio context. Already inited");if(!e.stream)throw new Error("Failed to init audio context. Local Stream not initialized");e.audioMixing.ctx=Object(S.a)(),e.audioMixing.mediaStreamSource=e.audioMixing.ctx.createMediaStreamSource(e.stream),e.audioMixing.mediaStreamDest=e.audioMixing.ctx.createMediaStreamDestination(),e.audioMixing.mediaStreamSource.connect(e.audioMixing.mediaStreamDest);var t=e.stream.getVideoTracks()[0];if(t&&e.audioMixing.mediaStreamDest.stream.addTrack(t),e._originStream=e.stream,e._isAudioMuted()?(e._unmuteAudio(),e.stream=e.audioMixing.mediaStreamDest.stream,e._muteAudio()):e.stream=e.audioMixing.mediaStreamDest.stream,e.audioLevelHelper=null,e.pc&&e.pc.peerConnection&&e.pc.peerConnection){var n=(e.pc.peerConnection&&e.pc.peerConnection.getSenders()).find((function(e){return e&&e.track&&"audio"==e.track.kind})),r=e.audioMixing.mediaStreamDest.stream.getAudioTracks()[0];n&&n.replaceTrack&&r&&n.replaceTrack(r)}e.audioMixing.audioContextInited=!0},e._cleanupAudioMixing=function(){if(e.audioMixing.audioContextInited){for(var t in e.audioMixing.sounds){var n=e.audioMixing.sounds[t];n.state!==e.audioMixing.states.BUSY&&n.state!==e.audioMixing.states.PAUSED||e._stopOneEffect({soundId:t})}e.audioLevelHelper=null,e.audioMixing.audioContextInited=!1}},e._reloadInEarMonitoringMode=function(t){if(t){if(!e.audioMixing.inEarMonitoringModes[t])return c.default.error("[".concat(e.streamId,"] Invalid InEarMonitoringMode ").concat(t));e.audioMixing.inEarMonitoring=t}switch(e.audioMixing.audioContextInited||e._initAudioContext(),e.audioMixing.inEarMonitoring){case e.audioMixing.inEarMonitoringModes.FILE:e.audioMixing.mediaStreamSource.connectedToDestination&&(e.audioMixing.mediaStreamSource.disconnect(e.audioMixing.ctx.destination),e.audioMixing.mediaStreamSource.connectedToDestination=!1);case e.audioMixing.inEarMonitoringModes.ALL:for(var n in e.audioMixing.sounds){var r=e.audioMixing.sounds[n];r&&r.source&&!r.source.connectedToDestination&&(r.source.gainNode.connect(e.audioMixing.ctx.destination),r.source.connectedToDestination=!0)}}switch(e.audioMixing.inEarMonitoring){case e.audioMixing.inEarMonitoringModes.MICROPHONE:e.audioMixing.source.forEach((function(t){t.connectedToDestination&&(t.gainNode.disconnect(e.audioMixing.ctx.destination),t.connectedToDestination=!1)}));case e.audioMixing.inEarMonitoringModes.ALL:e.audioMixing.mediaStreamSource.connectedToDestination||(e.audioMixing.mediaStreamSource.connect(e.audioMixing.ctx.destination),e.audioMixing.mediaStreamSource.connectedToDestination=!0)}},e._startAudioMixingBufferSource=function(t){e.audioMixing.audioContextInited||e._initAudioContext();var n={soundId:t.soundId,id:t.filePath,loop:t.loop,cycle:t.cycle,playTime:t.playTime||0},r=t.replace,i=e.createAudioBufferSource(n);return i.sound=e.audioMixing.sounds[t.soundId],i?(i.addEventListener("ended",e._audioMixingFinishedListener,{once:!0}),e._reloadInEarMonitoringMode(),r&&e.audioMixing.mediaStreamSource.disconnect(e.audioMixing.mediaStreamDest),i):null},e._stopAudioMixingBufferSource=function(t){var n=e.audioMixing.sounds[t.soundId].source;return n?(n.removeEventListener("ended",e._audioMixingFinishedListener),e.audioMixing.mediaStreamSource.connect(e.audioMixing.mediaStreamDest),n.stop(),n.gainNode&&n.gainNode.disconnect&&n.gainNode.disconnect(),n.buffer=null,n):null},e._flushAudioMixingMuteStatus=function(t){for(var n in e.audioMixing.sounds){var r=e.audioMixing.sounds[n];r&&(void 0!==t&&(r.muted=!!t),r.source&&(r.muted?r.source.gainNode.gain.value=0:r.source.gainNode.gain.value=r.volume/100))}},e._handleAudioMixingInvalidStateError=function(t,n,r){var i=e.audioMixing.sounds[n.soundId],o=-1===n.soundId?"INVALID_AUDIO_MIXING_STATE":"INVALID_PLAY_EFFECT_STATE";c.default.error("[".concat(e.streamId,"] Cannot ").concat(t,": ").concat(o,", state is ").concat(i.state)),r&&r(o)},e._handleAudioMixingNoSourceError=function(t,n,r){e.audioMixing.sounds[n.soundId].state=e.audioMixing.states.IDLE;var i=-1===n.soundId?"NO_AUDIO_MIXING_SOURCE":"NO_EFFECT_SOURCE";c.default.error("[".concat(e.streamId,"] Cannot ").concat(t,": ").concat(i)),r&&r(i)},e._getOneEffectStates=function(t){var n=e.audioMixing.sounds[t.soundId];return function(){return n?{state:n.state,startAt:n.startAt,resumeAt:n.resumeAt,pauseOffset:n.pauseOffset,pauseAt:n.pauseAt,resumeOffset:n.resumeOffset,stopAt:n.stopAt,duration:e._getOneEffectDuration(t),position:e._getOneEffectCurrentPosition(t)}:{}}},e._audioMixingFinishedListener=function(){var t=this.sound;t.state===e.audioMixing.states.IDLE&&e.audioMixing.buffer[t.options.filePath]&&!t.options.cacheResource&&(c.default.debug("Recycled buffer ".concat(t.options.filePath)),delete e.audioMixing.buffer[t.options.filePath]),-1===t.soundId&&e.dispatchEvent({type:"audioMixingFinished"})},e._playOneEffect=function(t,n){Object(b.checkValidObject)(t,"options");var r=t.soundId,i=(t.filePath,t.cacheResource);if(t.cycle,t.loop,t.playTime,t.replace,Object(o.isSafari)()&&Object(o.getBrowserVersion)()<12){var a="BROWSER_NOT_SUPPORT";return c.default.error("[".concat(e.streamId,"] Cannot _playOneEffect: "),a),n(a)}e.audioMixing.audioContextInited||e._initAudioContext(),e._initSoundIfNotExists(r);var s=e.audioMixing.sounds[r];if(s.state===e.audioMixing.states.IDLE){if(void 0!==t.cycle&&!t.cycle>0)return a="Invalid Parmeter cycle: "+t.cycle,c.default.error("[".concat(e.streamId,"] ").concat(r),a),n(a);if(Object(b.isEmpty)(i)&&(t.cacheResource=!0),s.state=e.audioMixing.states.STARTING,s.options=t,e.audioMixing.buffer[t.filePath]){var u=e._startAudioMixingBufferSource(t);if(u)return s.source=u,s.startAt=Date.now(),s.resumeAt=null,s.pauseOffset=null,s.pauseAt=null,s.resumeOffset=null,s.stopAt=null,s.startOffset=t.playTime||0,s.state=e.audioMixing.states.BUSY,e._flushAudioMixingMuteStatus(),n(null);s.state=e.audioMixing.states.IDLE;var d="CREATE_BUFFERSOURCE_FAILED";if(n)return n(d);c.default.error("[".concat(e.streamId,"] "),d)}else e.loadAudioBuffer(t.filePath,t.filePath,(function(r){if(r)s.state=e.audioMixing.states.IDLE,n?n(r):c.default.error("[".concat(e.streamId,"] "),r);else{var i=e._startAudioMixingBufferSource(t);if(i)return s.source=i,s.startAt=Date.now(),s.resumeAt=null,s.pauseOffset=null,s.pauseAt=null,s.resumeOffset=null,s.stopAt=null,s.startOffset=t.playTime||0,s.state=e.audioMixing.states.BUSY,e._flushAudioMixingMuteStatus(),n(null);if(s.state=e.audioMixing.states.IDLE,r="CREATE_BUFFERSOURCE_FAILED",n)return n(r);c.default.error("[".concat(e.streamId,"] "),r)}}))}else e._handleAudioMixingInvalidStateError("_playEffect",t,n)},e._stopOneEffect=function(t,n){var r=e.audioMixing.sounds[t.soundId];return e._isSoundExists(t)?r.state===e.audioMixing.states.BUSY||r.state===e.audioMixing.states.PAUSED?(e._stopAudioMixingBufferSource(t),r.stopAt=Date.now(),r.state=e.audioMixing.states.IDLE,e.audioMixing.buffer[r.options.filePath]&&!r.options.cacheResource&&(c.default.debug("Recycled buffer ".concat(r.options.filePath)),delete e.audioMixing.buffer[r.options.filePath]),void(n&&n(null))):void e._handleAudioMixingInvalidStateError("_stopOneEffect",t,n):n("SOUND_NOT_EXISTS")},e._pauseOneEffect=function(t,n){var r=e.audioMixing.sounds[t.soundId];if(r.state===e.audioMixing.states.BUSY)return e._stopAudioMixingBufferSource(t)?(r.pauseAt=Date.now(),r.state=e.audioMixing.states.PAUSED,r.resumeAt?r.pauseOffset=r.pauseAt-r.resumeAt+r.resumeOffset:r.pauseOffset=r.pauseAt-r.startAt+r.startOffset,n&&n(null)):void e._handleAudioMixingNoSourceError("_pauseOneEffect",t,n);e._handleAudioMixingInvalidStateError("_pauseOneEffect",t,n)},e._resumeOneEffect=function(t,n){var r=e.audioMixing.sounds[t.soundId];if(r.state===e.audioMixing.states.PAUSED){var i={soundId:t.soundId,filePath:r.options.filePath,cycle:r.options.cycle,loop:r.options.loop,playTime:r.pauseOffset,replace:r.options.replace},o=e._startAudioMixingBufferSource(i);if(!o){var a="CREATE_BUFFERSOURCE_FAILED";return n(a),void c.default.error("[".concat(e.streamId,"] "),a)}r.source=o,r.resumeAt=Date.now(),r.resumeOffset=r.pauseOffset,r.state=e.audioMixing.states.BUSY,r.pauseAt=null,r.pauseOffset=null,n(null)}else e._handleAudioMixingInvalidStateError("_resumeOneEffect",t,n)},e._getOneEffectDuration=function(t){var n=e.audioMixing.sounds[t.soundId];return n.options&&n.options.filePath&&e.audioMixing.buffer[n.options.filePath]?1e3*e.audioMixing.buffer[n.options.filePath].duration:null},e._getOneEffectCurrentPosition=function(t,n){var r=e.audioMixing.sounds[t.soundId];return r.state===e.audioMixing.states.PAUSED?r.pauseOffset%e._getOneEffectDuration(t):r.state===e.audioMixing.states.BUSY?r.resumeAt?(Date.now()-r.resumeAt+r.resumeOffset)%e._getOneEffectDuration(t):(Date.now()-r.startAt+r.startOffset)%e._getOneEffectDuration(t):void(n&&e._handleAudioMixingInvalidStateError("_getOneEffectCurrentPosition",t))},e._setOneEffectPosition=function(t,n,r){var i=e.audioMixing.sounds[t.soundId];if(i.state===e.audioMixing.states.BUSY){if(!e._stopAudioMixingBufferSource(t))return void e._handleAudioMixingNoSourceError("_setOneEffectPosition",t,r);var o={soundId:t.soundId,filePath:i.options.filePath,loop:i.options.loop,cycle:i.options.cycle,playTime:n},a=e._startAudioMixingBufferSource(o);if(!a){var s="CREATE_BUFFERSOURCE_FAILED";return r&&r(s),void c.default.error("[".concat(e.streamId,"] "),s)}i.source=a,i.startAt=Date.now(),i.startOffset=n,i.resumeAt=null,i.resumeOffset=null,i.pauseOffset=null,i.pauseAt=null}else{if(i.state!==e.audioMixing.states.PAUSED)return void e._handleAudioMixingInvalidStateError("_setOneEffectPosition",t,r);i.pauseOffset=n}r&&r(null)},e.startAudioMixing=function(t,n){var r=f.report.reportApiInvoke(e.sid,{callback:function(t){if(t)return n&&n(t);e.dispatchEvent({type:"audioMixingPlayed"}),n&&n(null)},getStates:e._getOneEffectStates({soundId:-1}),name:"Stream.startAudioMixing",options:t});Object(b.checkValidObject)(t,"options");var o=t.filePath,a=t.cacheResource,s=t.cycle,c=t.loop,u=t.playTime,d=t.replace;Object(b.checkValidString)(o,"filePath",1,Object(l.getParameter)("FILEPATH_LENMAX"),!1),Object(b.checkValidNumber)(u,"playTime",0,1e8),!Object(b.isEmpty)(s)&&Object(b.checkValidNumber)(s,"cycle"),!Object(b.isEmpty)(c)&&Object(b.checkValidBoolean)(c,"loop"),!Object(b.isEmpty)(d)&&Object(b.checkValidBoolean)(d,"replace"),!Object(b.isEmpty)(a)&&Object(b.checkValidBoolean)(a,"cacheResource");var p=i()({soundId:-1},t);e._playOneEffect(p,r)},e.stopAudioMixing=function(t){var n=f.report.reportApiInvoke(e.sid,{callback:t,getStates:e._getOneEffectStates({soundId:-1}),name:"Stream.stopAudioMixing"});e._stopOneEffect({soundId:-1},n)},e.pauseAudioMixing=function(t){var n=f.report.reportApiInvoke(e.sid,{callback:t,getStates:e._getOneEffectStates({soundId:-1}),name:"Stream.pauseAudioMixing"});return e._pauseOneEffect({soundId:-1},n)},e.resumeAudioMixing=function(t){var n=f.report.reportApiInvoke(e.sid,{callback:function(n,r){if(n)return t&&t(n);e.dispatchEvent({type:"audioMixingPlayed"}),t&&t(null)},getStates:e._getOneEffectStates({soundId:-1}),name:"Stream.resumeAudioMixing"});e._resumeOneEffect({soundId:-1},n)},e.adjustAudioMixingVolume=function(t){var n=f.report.reportApiInvoke(e.sid,{getStates:e._getOneEffectStates({soundId:-1}),name:"Stream.adjustAudioMixingVolume",options:arguments,tag:"tracer"});Object(b.checkValidNumber)(t,"volume",0,100),e.audioMixing.sounds[-1].volume=t,e._flushAudioMixingMuteStatus(),n()},e.getAudioMixingDuration=function(){var t=f.report.reportApiInvoke(e.sid,{getStates:e._getOneEffectStates({soundId:-1}),name:"Stream.getAudioMixingDuration"}),n=e._getOneEffectDuration({soundId:-1});return t(null,n),n},e.getAudioMixingCurrentPosition=function(){var t=f.report.reportApiInvoke(e.sid,{getStates:e._getOneEffectStates({soundId:-1}),name:"Stream.getAudioMixingCurrentPosition"}),n=e._getOneEffectCurrentPosition({soundId:-1},!0);return t(null,n),n},e.setAudioMixingPosition=function(t,n){var r=f.report.reportApiInvoke(e.sid,{callback:n,options:arguments,tag:"tracer",getStates:e._getOneEffectStates({soundId:-1}),name:"Stream.setAudioMixingPosition"});Object(b.checkValidNumber)(t,"position",0,1e8),e._setOneEffectPosition({soundId:-1},t,r)},e.playEffect=function(t,n){var r=f.report.reportApiInvoke(e.sid,{callback:function(t){if(t)return n&&n(t);e.dispatchEvent({type:"effectPlayed"}),n&&n(null)},name:"Stream.playEffect",options:t});Object(b.checkValidObject)(t,"options");var i=t.soundId,o=t.filePath,a=t.cycle;Object(b.checkValidNumber)(i,"soundId",1,1e4),Object(b.checkValidString)(o,"filePath",0,Object(l.getParameter)("FILEPATH_LENMAX"),!1),!Object(b.isEmpty)(a)&&Object(b.checkValidNumber)(a,"cycle"),e._playOneEffect(t,r)},e.stopEffect=function(t,n){var r=f.report.reportApiInvoke(e.sid,{callback:n,getStates:e._getOneEffectStates({soundId:t}),name:"Stream.stopEffect"});Object(b.checkValidNumber)(t,"soundId",1,1e4),e._stopOneEffect({soundId:t},r)},e.stopAllEffects=function(t){var n=f.report.reportApiInvoke(e.sid,{callback:t,name:"Stream.stopAllEffect"}),r=!1,i=0,o=0,a=function(e){r||(e?(n(e),r=!0):i+=1,i===o&&(n(null),r=!0))};for(var s in e.audioMixing.sounds){var c=e.audioMixing.sounds[s];-1!==c.soundId&&(c.state!==e.audioMixing.states.BUSY&&c.state!==e.audioMixing.states.PAUSED||(o++,e._stopOneEffect({soundId:s},a)))}o||n(null)},e.preloadEffect=function(t,n,r){var i=f.report.reportApiInvoke(e.sid,{callback:r,options:arguments,tag:"tracer",name:"Stream.preloadEffect"});Object(b.checkValidNumber)(t,"soundId",1,1e4),Object(b.checkValidString)(n,"filePath",1,Object(l.getParameter)("FILEPATH_LENMAX"),!1),e._initSoundIfNotExists(t,n),e.audioMixing.buffer[n]?i(null):e.loadAudioBuffer(n,n,i)},e.unloadEffect=function(t,n){var r=f.report.reportApiInvoke(e.sid,{callback:n,options:arguments,tag:"tracer",name:"Stream.unloadEffect"});Object(b.checkValidNumber)(t,"soundId",1,1e4);var i=e.audioMixing.sounds[t];if(!i){var o="SOUND_NOT_EXISTS";return c.default.error(o,t),void r(o)}var a=i.options?i.options.filePath:i.filePath;if(a)delete e.audioMixing.buffer[a],delete e.audioMixing.sounds[t],r(null);else{var s="SOUND_BUFFER_NOT_FOUND";c.default.error(s,t),r(s)}},e.pauseEffect=function(t,n){var r=f.report.reportApiInvoke(e.sid,{callback:n,options:arguments,tag:"tracer",name:"Stream.pauseEffect"});return e._pauseOneEffect({soundId:t},r)},e.pauseAllEffects=function(t){var n=f.report.reportApiInvoke(e.sid,{callback:t,name:"Stream.pauseAllEffects"}),r=!1,i=0,o=0,a=function(e){r||(e?(n(e),r=!0):i+=1,i===o&&(n(null),r=!0))};for(var s in e.audioMixing.sounds)"-1"!==s&&e.audioMixing.sounds[s].state===e.audioMixing.states.BUSY&&(o++,e._pauseOneEffect({soundId:s},a));o||n(null)},e.resumeEffect=function(t,n){Object(b.checkValidNumber)(t,"soundId",1,1e4);var r=f.report.reportApiInvoke(e.sid,{callback:n,options:arguments,tag:"tracer",name:"Stream.resumeEffect"});return e._resumeOneEffect({soundId:t},r)},e.resumeAllEffects=function(t){var n=f.report.reportApiInvoke(e.sid,{callback:t,name:"Stream.resumeAllEffects"}),r=!1,i=0,o=0,a=function(e){r||(e?(n(e),r=!0):i+=1,i===o&&(n(null),r=!0))};for(var s in e.audioMixing.sounds)"-1"!==s&&e.audioMixing.sounds[s].state===e.audioMixing.states.PAUSED&&(o++,e._resumeOneEffect({soundId:s},a));o||n(null)},e.getEffectsVolume=function(){var t=[];for(var n in e.audioMixing.sounds){var r=e.audioMixing.sounds[n];r&&"-1"!==n&&t.push({soundId:parseInt(n),volume:r.volume})}return t},e.setEffectsVolume=function(t,n){var r=f.report.reportApiInvoke(e.sid,{name:"Stream.setEffectsVolume",options:arguments,tag:"tracer",callback:n});for(var i in Object(b.checkValidNumber)(t,"volume",0,100),e.audioMixing.defaultVolume=t,e.audioMixing.sounds){var o=e.audioMixing.sounds[i];"-1"!==i&&(o.volume=t)}e._flushAudioMixingMuteStatus(),r(null)},e.setVolumeOfEffect=function(t,n,r){var i=f.report.reportApiInvoke(e.sid,{name:"Stream.setVolumeOfEffect",options:arguments,tag:"tracer",callback:r});Object(b.checkValidNumber)(t,"soundId",0,1e4),Object(b.checkValidNumber)(n,"volume",0,100),e._initSoundIfNotExists(t);var o=e.audioMixing.sounds[t];o.volume=n,e._flushAudioMixingMuteStatus(),i(null)}}(t),E.a.addVideoEffectCapability(t),function(e,t){e.videoConstraint={},t.cameraId&&(e.videoConstraint.deviceId={exact:t.cameraId}),t.facingMode&&(e.videoConstraint.facingMode=t.facingMode),e.videoSize&&(e.videoConstraint.width=e.videoSize[0],e.videoConstraint.height=e.videoSize[1]),Object(o.isLegacyChrome)()||(e.videoConstraint.frameRate=30),e.audioConstraint={},t.microphoneId&&(e.audioConstraint.deviceId={exact:t.microphoneId}),Object(o.isLegacyChrome)()||e.audioProcessing&&(void 0!==e.audioProcessing.AGC&&(Object(o.isFireFox)()?e.audioConstraint.autoGainControl=e.audioProcessing.AGC:Object(o.isChrome)()&&(e.audioConstraint.googAutoGainControl=e.audioProcessing.AGC,e.audioConstraint.googAutoGainControl2=e.audioProcessing.AGC)),void 0!==e.audioProcessing.AEC&&(e.audioConstraint.echoCancellation=e.audioProcessing.AEC),void 0!==e.audioProcessing.ANS&&(Object(o.isFireFox)()?e.audioConstraint.noiseSuppression=e.audioProcessing.ANS:Object(o.isChrome)()&&(e.audioConstraint.googNoiseSuppression=e.audioProcessing.ANS))),e.screenConstraint={},t.sourceId&&(e.screenConstraint.sourceId=t.sourceId),t.extensionId&&Object(o.isChrome)()?(e.screenConstraint.extensionId=t.extensionId,e.screenConstraint.mandatory={chromeMediaSource:"desktop",maxWidth:e.screenAttributes.width,maxHeight:e.screenAttributes.height,maxFrameRate:e.screenAttributes.maxFr,minFrameRate:e.screenAttributes.minFr}):(e.screenConstraint.mediaSource="screen",e.screenConstraint.width=e.screenAttributes.width,e.screenConstraint.height=e.screenAttributes.height,e.screenConstraint.frameRate={ideal:e.screenAttributes.maxFr,max:e.screenAttributes.maxFr}),t.mediaSource&&(e.screenConstraint.mediaSource=t.mediaSource),e.setVideoResolution=function(n){var r=f.report.reportApiInvoke(e.sid,{name:"Stream.setVideoResolution",options:arguments,tag:"tracer"});if(!(n instanceof Array)){var o=R(n+="");return o&&o.video?(e.videoConstraint=i()(e.videoConstraint,{width:{ideal:o.video.width},height:{ideal:o.video.height}}),t.attributes.resolution=o.attributes.resolution,(a=e.stream&&e.stream.getVideoTracks&&e.stream.getVideoTracks()[0])&&a.applyConstraints?(c.default.debug("setVideoResolution applyConstraints",e.videoConstraint),a.applyConstraints(e.videoConstraint).then(r).catch(r)):r(),!0):(r("NO_PROFILE_".concat(n)),!1)}var a,s=n[0],u=n[1];e.videoConstraint=i()(e.videoConstraint,{width:{ideal:s},height:{ideal:u}}),t.attributes.resolution="".concat(s,"x").concat(u),(a=e.stream&&e.stream.getVideoTracks&&e.stream.getVideoTracks()[0])&&a.applyConstraints?(c.default.debug("setVideoResolution applyConstraints",e.videoConstraint),E.a.disableVideoEffect(e).then((function(){return a.applyConstraints(e.videoConstraint).then(r).catch(r)})).then((function(){return E.a.restoreVideoEffect(e)}))):r()},e.setVideoFrameRate=function(t){var n=f.report.reportApiInvoke(e.sid,{name:"Stream.setVideoFrameRate",options:arguments,tag:"tracer"});if(Object(o.isFireFox)())return n("FIREFOX_NOT_SUPPORTED"),!1;if("object"===T()(t)&&t instanceof Array&&t.length>1){e.videoConstraint=i()(e.videoConstraint,{frameRate:t[0]}),e.attributes.minFrameRate=t[0],e.attributes.maxFrameRate=t[1];var r=e.stream&&e.stream.getVideoTracks&&e.stream.getVideoTracks()[0];return r&&r.applyConstraints?(c.default.debug("setVideoFrameRate applyConstraints",e.videoConstraint),r.applyConstraints(e.videoConstraint).then(n).catch(n)):n(),!0}return n("INVALID_PARAM_".concat(JSON.stringify(t))),!1},e.setVideoBitRate=function(n){var r=f.report.reportApiInvoke(e.sid,{name:"Stream.setVideoBitRate",options:arguments,tag:"tracer"});return"object"===T()(n)&&n instanceof Array&&n.length>1?(t.attributes.minVideoBW=n[0],t.attributes.maxVideoBW=n[1],e.connectionSpec&&(e.connectionSpec.minVideoBW=n[0],e.connectionSpec.maxVideoBW=n[1]),e.pc&&e.pc.renegotiate&&e.pc.renegotiate(),r(),!0):(r("INVALID_PARAM_".concat(JSON.stringify(n))),!1)},e.setScreenBitRate=function(t){var n=f.report.reportApiInvoke(e.sid,{name:"Stream.setScreenBitRate",options:arguments,tag:"tracer"});return"object"===T()(t)&&t instanceof Array&&t.length>1?(e.screenAttributes.minVideoBW=t[0],e.screenAttributes.maxVideoBW=t[1],n(),!0):(n("INVALID_PARAM_".concat(JSON.stringify(t))),!1)},e.setScreenProfile=function(t){var n=f.report.reportApiInvoke(e.sid,{name:"Stream.setScreenProfile",options:arguments,tag:"tracer"});Object(b.checkValidEnum)(t,"profile",["480p_1","480p_2","720p_1","720p_2","1080p_1","1080p_2"]);var r=R(t);return r&&r.screen?(e.screenConstraint.mandatory?(e.screenConstraint.mandatory.maxWidth=r.screen.width,e.screenConstraint.mandatory.maxHeight=r.screen.height,r.screen.frameRate&&r.screen.frameRate.min&&r.screen.frameRate.max&&(e.screenConstraint.mandatory.minFrameRate=r.screen.frameRate.min,e.screenConstraint.mandatory.maxFrameRate=r.screen.frameRate.max)):e.screenConstraint=i()(e.screenConstraint,r.screen),e.screenAttributes.width=r.screen.width,e.screenAttributes.height=r.screen.height,e.screenAttributes.minFr=r.screen.frameRate.min,e.screenAttributes.maxFr=r.screen.frameRate.max,n(),!0):(n("NO_SCREEN_PROFILE_".concat(JSON.stringify(t))),!1)},e.setVideoProfileCustom=function(t){var n=f.report.reportApiInvoke(e.sid,{name:"Stream.setVideoProfileCustom",options:arguments,tag:"tracer"});e.setVideoResolution(t[0]),e.setVideoFrameRate([t[1],t[1]]),e.setVideoBitRate([t[2],t[2]]),n()},e.setVideoProfileCustomPlus=function(n){var r=f.report.reportApiInvoke(e.sid,{name:"Stream.setVideoProfileCustom",options:arguments,tag:"tracer"});e.setVideoResolution([n.width,n.height]),t.attributes.resolution="".concat(n.width,"x").concat(n.height),e.setVideoFrameRate([n.framerate,n.framerate]),e.setVideoBitRate([n.bitrate,n.bitrate]),r()},e.setVideoProfile=function(n){var r=f.report.reportApiInvoke(e.sid,{name:"Stream.setVideoProfile",options:arguments,tag:"tracer"}),a=R(n);if(!a){var s="Invalid Profile ".concat(n);throw new Error(s)}if(e.profile=n,a&&a.video){e.profile=a.profileName,e.videoConstraint=i()(e.videoConstraint,a.video),e.connectionSpec&&a.attributes.maxVideoBW&&(e.connectionSpec.minVideoBW=a.attributes.minVideoBW,e.connectionSpec.maxVideoBW=a.attributes.maxVideoBW),Object(o.isEdge)()&&(e.videoConstraint.frameRate.max=60),Object(o.isFireFox)()&&(e.videoConstraint.frameRate=30),t.attributes=i()(t.attributes,a.attributes),e.pc&&e.pc.renegotiate&&e.pc.renegotiate();var u=e.stream&&e.stream.getVideoTracks&&e.stream.getVideoTracks()[0];return u&&u.applyConstraints?(c.default.debug("setVideoProfile applyConstraints",e.videoConstraint),E.a.disableVideoEffect(e).then((function(){return u.applyConstraints(e.videoConstraint)})).then((function(){return E.a.restoreVideoEffect(e)})).then((function(t){return new Promise((function(n,i){r(t),setTimeout((function(){Object(g.vsResHack)(e.stream,(function(t,r){e.videoWidth=t,e.videoHeight=r,n()}),(function(t){c.default.warning("[".concat(e.streamId,"] vsResHack failed: "),t),i()}))}),2500)}))})).catch(r)):r(),!0}return r("INVALID_VIDEO_PROFILE_".concat(n)),!1},e.setAudioProfile=function(t){var n=f.report.reportApiInvoke(e.sid,{name:"Stream.setAudioProfile",options:arguments,tag:"tracer"});Object(b.checkValidEnum)(t,"profile",["speech_low_quality","speech_standard","music_standard","standard_stereo","high_quality","high_quality_stereo"]),e.audioProfile=t;var r=w(t);return e.highQuality=r.highQuality,e.stereo=r.stereo,e.speech=r.speech,e.lowQuality=r.lowQuality,e.stereo&&Object(o.isChrome)()&&(e.audioConstraint.googAutoGainControl=!1,e.audioConstraint.googAutoGainControl2=!1,e.audioConstraint.echoCancellation=!1,e.audioConstraint.googNoiseSuppression=!1),n(),!0},e.setVideoEncoderConfiguration=function(t){Object(b.checkValidObject)(t,"config");var n=f.report.reportApiInvoke(e.sid,{name:"Stream.setVideoEncoderConfiguration",options:t,tag:"tracer"});t.resolution&&(Object(b.checkValidNumber)(t.resolution.width,"config.resolution.width"),Object(b.checkValidNumber)(t.resolution.height,"config.resolution.height"),e.setVideoResolution([t.resolution.width,t.resolution.height])),t.frameRate&&(Object(b.checkValidNumber)(t.frameRate.min,"config.frameRate.min"),Object(b.checkValidNumber)(t.frameRate.max,"config.frameRate.max"),e.setVideoFrameRate([t.frameRate.min,t.frameRate.max])),t.bitrate&&(Object(b.checkValidNumber)(t.bitrate.min,"config.bitrate.min",1,1e7),Object(b.checkValidNumber)(t.bitrate.max,"config.bitrate.max",1,1e7),e.setVideoBitRate([t.bitrate.min,t.bitrate.max])),n()},e.getSupportedProfile=function(t){var n=f.report.reportApiInvoke(e.sid,{name:"Stream.getSupportedProfile",options:arguments,tag:"tracer",callback:t});if(!e.local){var r="ONLY_LOCAL_STREAM_SUPPORTED";return c.default.error(r),n(r)}if(!e.stream)return r="STREAM_NOT_INIT",c.default.error(r),n(r);if(!e.stream.getVideoTracks)return r="TRACK_NOT_SUPPORT",c.default.error(r),n(r);var i=e.stream.getVideoTracks()[0];if(!i)return r="NO_VIDEO_TRACK_FOUND",c.default.error(r),n(r);if(!i.getCapabilities)return r="GETCAPABILITY_NOT_SUPPORT",c.default.error(r),n(r);var o=i.getCapabilities(),a=I(o);return n(null,a)}}(t,e),t.getId=function(){return t.streamId},t.getUserId=function(){return t.userId},t.checkDualStreamEnabled=function(){return!(!Object(l.getParameter)("DUALSTREAM_OPERATION_CHECK")||!t.isDualStream)&&(c.default.error("Operation not permitted: ".concat("DUAL_STREAM_ENABLED")),"DUAL_STREAM_ENABLED")},t.setUserId=function(e){var n=f.report.reportApiInvoke(t.sid,{name:"Stream.setUserId",options:arguments,tag:"tracer"});t.userId&&c.default.warning("[".concat(t.streamId,"] Stream.userId ").concat(t.userId," => ").concat(e)),t.userId=e,n()},t.getAttributes=function(){return e.screen?t.screenAttributes:e.attributes},t.hasAudio=function(){return!!t.audio},t.hasVideo=function(){return!!t.video},t.hasScreen=function(){return!!t.screen},t.hasScreenAudio=function(){return!!t.screenAudio},t.isVideoOn=function(){return(t.hasVideo()||t.hasScreen())&&!t.userMuteVideo},t.isAudioOn=function(){return t.hasAudio()&&!t.userMuteAudio},t.init=function(r,i){var o=f.report.reportApiInvoke(t.sid,{callback:function(e,t){if(e)return i&&i(e);r&&r(t)},name:"Stream.init",options:arguments,tag:"tracer"}),a=((new Date).getTime(),arguments[2]);if(void 0===a&&(a=2),!0===t.initialized)return o({type:"warning",msg:"STREAM_ALREADY_INITIALIZED"});if(!0!==t.local)return o({type:"warning",msg:"STREAM_NOT_LOCAL"});var s=Math.random().toString().slice(3);t._streamInitID=s,t.videoSource?t.videoName="videoSource":t.video&&(t.videoName=y.a.searchDeviceNameById(e.cameraId)||"default"),t.audioSource?t.audioName="audioSource":t.audio&&(t.audioName=y.a.searchDeviceNameById(e.microphoneId)||"default"),t.screen&&(t.screenName=e.extensionId||"default");try{if(e.audio||e.video||e.screen||e.screenAudio||e.videoSource||e.audioSource){c.default.debug("[".concat(t.streamId,"] Requested access to local media"));var u={streamId:t.streamId};e.videoSource?u.videoSource=e.videoSource:e.screen?u.screen=t.screenConstraint:e.video&&(u.video=t.videoConstraint),e.audioSource?u.audioSource=e.audioSource:e.screenAudio?u.screenAudio=e.screenAudio:e.audio&&(u.audio=t.audioConstraint),Object(m.b)(u,(function(r){if(u.screenAudio&&!r.getAudioTracks()[0]&&c.default.warning("[".concat(t.streamId,"] Audio sharing is not selected")),u.screen&&c.default.debug("[".concat(t.streamId,"] User has granted access to screen sharing")),(u.video||u.audio)&&c.default.debug("[".concat(t.streamId,"] User has granted access to local media")),null===t._streamInitID){r.getTracks().forEach((function(e){e.stop()}));var i={type:"error",msg:"STREAM_IS_CLOSED",info:"stream is closed and cannot be initialized"};return c.default.error(t.streamId,i.info),void o(i)}if(t._streamInitID!==s)return r.getTracks().forEach((function(e){e.stop()})),i={type:"error",msg:"ABORT_OTHER_INIT",info:"stream initialization is aborted because of another stream.init"},c.default.error(t.streamId,i.info),void o(i);t.dispatchEvent({type:"accessAllowed"}),t.stream=r,t.initialized=!0,t.reloadDeviceName(),t.hasVideo()&&Object(g.vsResHack)(r,(function(e,n){t.videoWidth=e,t.videoHeight=n}),(function(e){c.default.warning("[".concat(t.streamId,"] vsResHack failed: "),e)})),e.screen&&t.stream&&t.stream.getVideoTracks()[0]&&(t.stream.getVideoTracks()[0].onended=function(){t.dispatchEvent({type:"stopScreenSharing"})}),t.stream&&t.stream.getTracks&&t.stream.getTracks().forEach((function(r){r&&!r.onended&&(r.onended=n),"video"===r.kind&&e.optimizationMode&&(r.contentHint=e.optimizationMode,r.contentHint===e.optimizationMode&&c.default.debug("[".concat(t.streamId,"] set content hint to"),e.optimizationMode))})),o()}),(function(e){var n={type:"error",info:null};switch(e&&(n.msg=e.name||e.code||e,e.message&&(n.info=e.message),e.code&&(n.info?n.info+=". "+e.code:n.info=" "+e.code),e.constraint&&(n.info?n.info+=". Constraint: "+e.constraint:n.info="constraint: "+e.constraint)),n.msg){case"Starting video failed":case"TrackStartError":if(t.videoConstraint&&(delete t.videoConstraint.width,delete t.videoConstraint.height),a>0)return void setTimeout((function(){t.init((function(e){return o(e)}),o,a-1)}),1);n.msg="MEDIA_OPTION_INVALID";break;case"DevicesNotFoundError":n.msg="DEVICES_NOT_FOUND";break;case"NotSupportedError":n.msg="NOT_SUPPORTED";break;case"PermissionDeniedError":case"InvalidStateError":n.msg="PERMISSION_DENIED",t.dispatchEvent({type:"accessDenied"});break;case"PERMISSION_DENIED":case"NotAllowedError":t.dispatchEvent({type:"accessDenied"});break;case"ConstraintNotSatisfiedError":n.msg="CONSTRAINT_NOT_SATISFIED";break;default:n.msg||(n.msg="UNDEFINED")}var r="Media access ".concat(n.msg).concat(n.info?": "+n.info:"");c.default.error("[".concat(t.streamId,"] "),r),o(n)}))}else o({type:"warning",msg:"STREAM_HAS_NO_MEDIA_ATTRIBUTES"})}catch(e){c.default.error("[".concat(t.streamId,"] Stream init: "),e),o({type:"error",msg:e.message||e})}},t.reloadDeviceName=function(){if(t.stream){if(t.stream.getVideoTracks){var e=t.stream.getVideoTracks()[0];e&&e.label&&(t.videoName=e.label)}if(t.stream.getAudioTracks){var n=t.stream.getAudioTracks()[0];n&&n.label&&(t.audioName=n.label)}}},t.close=function(){var e=f.report.reportApiInvoke(null,{name:"Stream.close",options:arguments,tag:"tracer"});if(c.default.debug("[".concat(t.streamId,"] Close stream with id"),t.streamId),t._originStream)try{t._originStream.getTracks().map((function(e){return e.stop()}))}catch(e){}if(void 0!==t.stream){var n=t.stream.getTracks();for(var r in n)n.hasOwnProperty(r)&&(n[r].stop(),n[r].onended=null);!t.isLowStream&&t.local?E.a.disableVideoEffect(t).then((function(){t.stream=void 0})):(t.stream&&t.stream.clean&&t.stream.clean(),t.stream=void 0)}if(t._originStream){for(var r in n=t._originStream.getTracks())n.hasOwnProperty(r)&&(n[r].stop(),n[r].onended=null);!t.isLowStream&&t.local?E.a.disableVideoEffect(t).then((function(){t._originStream=void 0})):(t._originStream&&t._originStream.clean&&t._originStream.clean(),t._originStream=void 0)}if(Object(o.isSafari)()&&t.pc&&t.pc.peerConnection&&t.pc.peerConnection.removeTrack&&t.pc.peerConnection.getSenders){var i=t.pc.peerConnection.getSenders();i.forEach((function(e){e&&(c.default.debug("[".concat(t.streamId,"] Remove Track"),e),t.pc.peerConnection.removeTrack(e))}))}t.local&&(t.initialized=!1),t._streamInitID=null,t._onAudioMute=void 0,t._onAudioUnmute=void 0,t._onVideoMute=void 0,t._onVideoUnmute=void 0,t.lowStream&&t.lowStream.close(),t.player&&t.player.video&&t.player.video.srcObject&&(t.player.video.srcObject=null),t.player&&t.player.audio&&t.player.audio.srcObject&&(t.player.audio.srcObject=null),e()},t.enableAudio=function(){var e,n=f.report.reportApiInvoke(t.sid,{name:"Stream.enableAudio",options:arguments,tag:"tracer"});return c.default.deprecate("[".concat(t.streamId,"] Stream.enableAudio is deprecated and will be removed in the future. Use Stream.unmuteAudio instead")),t.userMuteAudio||c.default.warning("[".concat(t.streamId,"] User already enableAudio")),t.userMuteAudio=!1,n(null,e=!t.peerMuteAudio&&t._unmuteAudio()),e},t.disableAudio=function(){var e=f.report.reportApiInvoke(t.sid,{name:"Stream.disableAudio",options:arguments,tag:"tracer"});c.default.deprecate("[".concat(t.streamId,"] Stream.disableAudio is deprecated and will be removed in the future. Use Stream.muteAudio instead")),t.userMuteAudio&&c.default.warning("[".concat(t.streamId,"] User already disableAudio")),t.userMuteAudio=!0;var n=t._muteAudio();return e(null,n),n},t.enableVideo=function(){var e,n=f.report.reportApiInvoke(t.sid,{name:"Stream.enableVideo",options:arguments,tag:"tracer"});return c.default.deprecate("[".concat(t.streamId,"] Stream.enableVideo is deprecated and will be removed in the future. Use Stream.unmuteVideo instead")),t.userMuteVideo||c.default.warning("[".concat(t.streamId,"] User already enableVideo")),t.userMuteVideo=!1,t.lowStream&&(t.lowStream.userMuteVideo=!1),n(null,e=!t.peerMuteVideo&&t._unmuteVideo()),e},t.disableVideo=function(){var e=f.report.reportApiInvoke(t.sid,{name:"Stream.disableVideo",options:arguments,tag:"tracer"});c.default.deprecate("[".concat(t.streamId,"] Stream.disableVideo is deprecated and will be removed in the future. Use Stream.muteVideo instead")),t.userMuteVideo&&c.default.warning("[".concat(t.streamId,"] User already disableVideo")),t.userMuteVideo=!0,t.lowStream&&(t.lowStream.userMuteVideo=!0);var n=t._muteVideo();return e(null,n),n},t.unmuteAudio=function(){var e,n=f.report.reportApiInvoke(t.sid,{name:"Stream.unmuteAudio",options:arguments,tag:"tracer"});return t.userMuteAudio||c.default.warning("[".concat(t.streamId,"] User already unmuteAudio")),t.userMuteAudio=!1,n(null,e=!t.peerMuteAudio&&t._unmuteAudio()),e},t.muteAudio=function(){var e=f.report.reportApiInvoke(t.sid,{name:"Stream.muteAudio",options:arguments,tag:"tracer"});t.userMuteAudio&&c.default.warning("[".concat(t.streamId,"] User already muteAudio")),t.userMuteAudio=!0;var n=t._muteAudio();return e(null,n),n},t.unmuteVideo=function(){var e,n=f.report.reportApiInvoke(t.sid,{name:"Stream.unmuteVideo",options:arguments,tag:"tracer"});return t.userMuteVideo||c.default.warning("[".concat(t.streamId,"] User already unmuteVideo")),t.userMuteVideo=!1,t.lowStream&&(t.lowStream.userMuteVideo=!1),n(null,e=!t.peerMuteVideo&&t._unmuteVideo()),e},t.muteVideo=function(){var e=f.report.reportApiInvoke(t.sid,{name:"Stream.muteVideo",options:arguments,tag:"tracer"});t.userMuteVideo&&c.default.warning("[".concat(t.streamId,"] User already muteVideo")),t.userMuteVideo=!0,t.lowStream&&(t.lowStream.userMuteVideo=!0);var n=t._muteVideo();return e(null,n),n},t._unmuteAudio=function(){return c.default.debug("[".concat(t.streamId,"] Unmuted audio stream with id "),t.streamId),t._flushAudioMixingMuteStatus(!1),!(!t.hasAudio()||!t.initialized||void 0===t.stream||!0===t.stream.getAudioTracks()[0].enabled||(t._onAudioUnmute&&t._onAudioUnmute(),t.pc&&(t.pc.isAudioMute=!1),t.stream.getAudioTracks()[0].enabled=!0,0))},t._isAudioMuted=function(){if(t.stream&&t.hasAudio()){var e=t.stream.getAudioTracks();return e.length>0&&!e[0].enabled}return!1},t._isVideoMuted=function(){if(t.stream&&t.hasVideo()){var e=t.stream.getVideoTracks();return e.length>0&&!e[0].enabled}return!1},t._muteAudio=function(){return c.default.debug("[".concat(t.streamId,"] Muted audio stream with id "),t.streamId),t._flushAudioMixingMuteStatus(!0),!!(t.hasAudio()&&t.initialized&&void 0!==t.stream&&t.stream.getAudioTracks()[0].enabled)&&(t._onAudioMute&&t._onAudioMute(),t.pc&&(t.pc.isAudioMute=!0),t.stream.getAudioTracks()[0].enabled=!1,t.sid&&f.report.audioSendingStopped(t.sid,{succ:!0,reason:"muteAudio"}),!0)},t._unmuteVideo=function(){return c.default.debug("[".concat(t.streamId,"] Unmuted video stream with id"),t.streamId),!(!t.initialized||void 0===t.stream||!t.stream.getVideoTracks().length||!0===t.stream.getVideoTracks()[0].enabled||(t._onVideoUnmute&&t._onVideoUnmute(),t.pc&&(t.pc.isVideoMute=!1),t.stream.getVideoTracks()[0].enabled=!0,t.lowStream&&t.lowStream._unmuteVideo(),0))},t._muteVideo=function(){return c.default.debug("[".concat(t.streamId,"] Muted video stream with id"),t.streamId),!!(t.initialized&&void 0!==t.stream&&t.stream.getVideoTracks().length&&t.stream.getVideoTracks()[0].enabled)&&(t._onVideoMute&&t._onVideoMute(),t.pc&&(t.pc.isVideoMute=!0),t.stream.getVideoTracks()[0].enabled=!1,t.lowStream&&t.lowStream._muteVideo(),t.sid&&f.report.videoSendingStopped(t.sid,{succ:!0,reason:"muteVideo"}),!0)},t.addTrack=function(r){if(t.audio&&"audio"===r.kind)c.default.warning("already added audio track");else if(t.video&&"video"===r.kind)c.default.warning("already added video track");else{var i=f.report.reportApiInvoke(t.sid,{name:"Stream.addTrack",options:arguments,tag:"tracer"});if(t.pc&&t.pc.addTrack(r,t.stream),"audio"==r.kind){t._cleanupAudioMixing();var o=new MediaStream;t.userMuteAudio&&(r.enabled=!1),o.addTrack(r);var a=t.stream.getVideoTracks()[0];a&&o.addTrack(a),t.audio=!0,e.audio=!0,t.stream=o,t.audioLevelHelper=null,t.player&&t.player.video&&(t.player.video.srcObject=t.stream)}else t.userMuteVideo&&(r.enabled=!1),t.stream.addTrack(r),t.video=!0,e.video=!0;r.onended||(r.onended=n),i()}},t.removeTrack=function(n){if(n)if(t.audio||"audio"!==n.kind)if(t.video||"video"!==n.kind){var r=f.report.reportApiInvoke(t.sid,{name:"Stream.removeTrack",options:arguments,tag:"tracer"});t.pc&&t.pc.removeTrack(n,t.stream),t.stream.removeTrack(n),t._cleanupAudioMixing(),"audio"===n.kind?(t.audio=!1,e.audio=!1):(t.video=!1,e.video=!1),t.audioLevelHelper=null,"live"==n.readyState&&(n.stop(),c.default.debug("[".concat(t.streamId,"] Track ").concat(n.kind," Stopped"))),r()}else c.default.warning("already removed video track");else c.default.warning("already removed audio track");else c.default.warning("track doesn't exist.")},t.setAudioOutput=function(e,n,r){var i=f.report.reportApiInvoke(t.sid,{callback:function(e,t){if(e)return r&&r(e);n&&n(t)},name:"Stream.setAudioOutput",options:arguments,tag:"tracer"});return Object(b.isValidString)(e,1,255)?(t.audioOutput=e,t.player?void t.player.setAudioOutput(e,(function(){return i()}),i):i()):(c.default.error("[".concat(t.streamId,"] setAudioOutput Invalid Parameter"),e),i(d.default.INVALID_PARAMETER))},t.play=function(e,n,r){"function"==typeof n&&(r=n,n=null),c.default.debug("[".concat(t.streamId,"] play()."),e,n);var i=f.report.reportApiInvoke(t.sid,{name:"Stream.play",options:arguments,tag:"tracer",callback:r});if(Object(b.checkValidString)(e,"elementID"),Object(b.isEmpty)(n)||(Object(b.isEmpty)(n.fit)||Object(b.checkValidEnum)(n.fit,"fit",["cover","contain"]),Object(b.isEmpty)(n.muted)||Object(b.checkValidBoolean)(n.muted,"muted")),t.player)c.default.warning("[".concat(t.streamId,"] Stream.play(): Stream is already playing. Fallback to resume stream")),t.resume().then((function(){i(null)})).catch(i);else{t.elementID=e,t.playOptions=n,!t.local||t.video||t.screen?(t.player=new h({id:t.getId(),stream:t,elementID:e,options:n}),t.local&&E.a.applyEffectInPlayer(t)):t.hasAudio()&&(t.player=new h({id:t.getId(),stream:t,elementID:e,options:n}));var o={video:null,audio:null},a=function e(n){if(o[n.mediaType]=n,o.video&&o.audio)if(t.removeEventListener("player-status-change",e),o.video.isErrorState||o.audio.isErrorState){var r=o.video.isErrorState?o.video:o.audio;i({isErrorState:!0,status:r.status,reason:r.reason,video:o.video,audio:o.audio})}else"aborted"===o.video.status&&"aborted"===o.audio.status?i({status:"aborted",reason:"stop",video:o.video,audio:o.audio}):i(null)};t.on("player-status-change",a),t.audioOutput&&t.player.setAudioOutput(t.audioOutput),void 0!==t.audioLevel&&t.player.setAudioVolume(t.audioLevel),t._flushAudioMixingMuteStatus(!1)}},t.stop=function(){var e=f.report.reportApiInvoke(t.sid,{name:"Stream.stop",options:arguments,tag:"tracer"});c.default.debug("[".concat(t.streamId,"] Stop stream player with id "),t.streamId),t.player?(E.a.removeEffectFromLocalPlayer(t),t.player.destroy(),delete t.player):c.default.error("[".concat(t.streamId,"] Stream.stop(): Stream is not playing")),t._flushAudioMixingMuteStatus(!0),e()},t.isPlaying=function(){return!!t.player},t.isPaused=function(){return!(!t.player||!(t.player.video&&t.player.video.paused&&t.player.mediaElemExists(t.player.video)||t.player.audio&&t.player.audio.paused&&t.player.mediaElemExists(t.player.audio)))},t.resume=function(){var e,n;return t.player?(t.player.video&&t.player.video.play&&(e=t.player.video.play()),e=e||Promise.resolve(),t.player.audio&&t.player.audio.play&&(n=t.player.audio.play()),n=n||Promise.resolve(),Promise.all([e,n])):Promise.reject("NO_PLAYER_FOUND")},t.getVideoTrack=function(){var e=f.report.reportApiInvoke(t.sid,{name:"Stream.getVideoTrack",options:arguments,tag:"tracer"});if(t.stream&&t.stream.getVideoTracks){var n=t.stream.getVideoTracks()[0];if(n)return c.default.info("[".concat(t.streamId,"] getVideoTrack"),n),e(),n}c.default.info("[".concat(t.streamId,"] getVideoTrack None")),e(null,"getVideoTrack None")},t.getAudioTrack=function(){var e=f.report.reportApiInvoke(t.sid,{name:"Stream.getAudioTrack",options:arguments,tag:"tracer"});if(t.stream&&t.stream.getAudioTracks){var n=t.stream.getAudioTracks()[0];if(n)return c.default.info("[".concat(t.streamId,"] getAudioTracks"),n),e(),n}c.default.info("[".concat(t.streamId,"] getAudioTracks None")),e(null,"getAudioTracks None")},t._hasVideoTracks=function(){return!!(t.stream&&t.stream.getVideoTracks&&t.stream.getVideoTracks()[0])},t._hasAudioTracks=function(){return!!(t.stream&&t.stream.getAudioTracks&&t.stream.getAudioTracks()[0])},t._replaceMediaStreamTrack=function(e,n,r){if(t.stream){if("video"==e.kind){if(o=t.stream.getVideoTracks()[0])return t.userMuteVideo&&(e.enabled=!1),t.stream.removeTrack(o),t.stream.addTrack(e),c.default.debug("[".concat(t.streamId,"] _replaceMediaStreamTrack ").concat(e.kind," SUCCESS")),"live"==o.readyState&&(o.stop(),c.default.debug("[".concat(t.streamId,"] Track ").concat(o.kind," Stopped"))),n&&n();var i="MEDIASTREAM_TRACK_NOT_FOUND";return c.default.error("[".concat(t.streamId,"] MEDIASTREAM_TRACK_NOT_FOUND ").concat(e.kind)),r(i)}if("audio"==e.kind){var o;if(o=t.stream.getAudioTracks()[0]){t.userMuteAudio&&(e.enabled=!1);var a=new MediaStream;a.addTrack(e);var s=t.stream&&t.stream.getVideoTracks()[0];return s&&a.addTrack(s),t.stream=a,t.audioLevelHelper=null,t.player&&t.player.video&&(t.player.video.srcObject=t.stream),c.default.debug("[".concat(t.streamId,"] _replaceMediaStreamTrack SUCCESS")),"live"==o.readyState&&(o.stop(),c.default.debug("[".concat(t.streamId,"] Track ").concat(o.kind," Stopped"))),n&&n()}return i="MEDIASTREAM_TRACK_NOT_FOUND",c.default.error("[".concat(t.streamId,"] MEDIASTREAM_TRACK_NOT_FOUND ").concat(e.kind)),r(i)}return i="INVALID_TRACK_TYPE",c.default.error("[".concat(t.streamId,"] _replaceMediaStreamTrack ").concat(i," ").concat(e.kind)),r&&r(i)}return i="NO_STREAM_FOUND",c.default.error("[".concat(t.streamId,"] _replaceMediaStreamTrack ").concat(i)),r&&r(i)},t.replaceTrack=function(e,r,i){var o=f.report.reportApiInvoke(t.sid,{callback:function(e,t){if(e)return i&&i(e);r&&r(t)},name:"Stream.replaceTrack",options:arguments,tag:"tracer"});return e&&e.kind?(t._cleanupAudioMixing(),e.onended||(e.onended=n),t.pc&&t.pc.hasSender&&t.pc.hasSender(e.kind)?void t.pc.replaceTrack(e,(function(){return c.default.debug("[".concat(t.streamId,"] PeerConnection.replaceTrack ").concat(e.kind," SUCCESS")),t._replaceMediaStreamTrack(e,(function(e){return o(null,e)}),o)}),(function(n){return c.default.error("[".concat(t.streamId,"] PeerConnection.replaceTrack ").concat(e.kind," Failed ").concat(n)),o(n)})):t._replaceMediaStreamTrack(e,(function(e){return o(null,e)}),o)):o("INVALID_TRACK")},t.setAudioVolume=function(e){var n=f.report.reportApiInvoke(t.sid,{name:"Stream.setAudioVolume",options:arguments,tag:"tracer"});Object(b.checkValidNumber)(e,"level",0,100),t.audioLevel=e,t.player&&t.player.setAudioVolume(e),n()},t.getStats=function(e,n,r){var a=[];a.push(t._getPCStats(r)),a.push(new Promise((function(e){var n={};t.pc&&t.pc.isSubscriber?null!==window.navigator.userAgent.match("Firefox")&&(Object(v.b)(n,"videoReceiveResolutionHeight",t.videoHeight),Object(v.b)(n,"videoReceiveResolutionWidth",t.videoWidth)):t.pc&&!t.pc.isSubscriber&&((Object(o.isSafari)()||Object(o.isFireFox)())&&(Object(v.b)(n,"videoSendResolutionHeight",t.videoHeight),Object(v.b)(n,"videoSendResolutionWidth",t.videoWidth)),(Object(o.isSafari)()||Object(o.isFireFox)())&&t.uplinkStats&&Object(v.b)(n,"videoSendPacketsLost",t.uplinkStats.uplink_cumulative_lost)),e(n)}))),a.push(new Promise((function(e){var n={};return t.traffic_stats&&t.pc&&t.pc.isSubscriber?(Object(v.b)(n,"accessDelay",t.traffic_stats.access_delay),Object(v.b)(n,"endToEndDelay",t.traffic_stats.e2e_delay),Object(v.b)(n,"videoReceiveDelay",t.traffic_stats.video_delay),Object(v.b)(n,"audioReceiveDelay",t.traffic_stats.audio_delay)):t.traffic_stats&&t.pc&&!t.pc.isSubscriber&&Object(v.b)(n,"accessDelay",t.traffic_stats.access_delay),e(n)}))),Promise.all(a).then((function(n){for(var r={},o=n.length-1;o>=0;o--){var a=n[o];i()(r,a)}e&&setTimeout(e.bind(t,r),0)})).catch((function(e){n&&setTimeout(n.bind(t,e),0)}))},t._getPCStats=function(e){return new Promise((function(n,r){if(!t.pc||"established"!==t.pc.state||!t.pc.getStats)return r("PEER_CONNECTION_NOT_ESTABLISHED");t.pc.getStats((function(e){if(!t.pc||"established"!==t.pc.state||!t.pc.getStats)return r("PEER_CONNECTION_STATE_CHANGE");var i=t.pc.isSubscriber?Object(v.c)(e):Object(v.a)(e);return n(i)}),e)})).then((function(e){return t.pc.isSubscriber?(Object(o.isFireFox)()||Object(o.isSafari)())&&(e.videoReceiveResolutionHeight&&"0"!==e.videoReceiveResolutionHeight||e.videoReceiveResolutionWidth&&"0"!==e.videoReceiveResolutionWidth||(Object(v.b)(e,"videoReceiveResolutionHeight",t.videoHeight),Object(v.b)(e,"videoReceiveResolutionWidth",t.videoWidth))):((Object(o.isSafari)()||Object(o.isFireFox)())&&(e.videoSendResolutionHeight&&"0"!==e.videoSendResolutionHeight||e.videoSendResolutionWidth&&"0"!==e.videoSendResolutionWidth||(Object(v.b)(e,"videoSendResolutionHeight",t.videoHeight),Object(v.b)(e,"videoSendResolutionWidth",t.videoWidth))),(Object(o.isSafari)()||Object(o.isFireFox)())&&t.uplinkStats&&Object(v.b)(e,"videoSendPacketsLost",t.uplinkStats.uplink_cumulative_lost)),Promise.resolve(e)}))},t.getAudioLevel=function(){if(t.audioLevelHelper)return t.audioLevelHelper.getAudioLevel();if(t.stream){if(0!==t.stream.getAudioTracks().length)return t.audioLevelHelper=new g.audioLevelHelper(t.stream),t.audioLevelHelper.getAudioLevel();c.default.warning("[".concat(t.streamId,"] can't get audioLevel beacuse no audio trace in stream"))}else c.default.warning("[".concat(t.streamId,"] can't get audioLevel beacuse no stream exist"))},t.setVideoProfile("480p_1"),t._switchVideoDevice=function(e,n,r){if(e===t.cameraId)return n&&n();var o={video:i()({},t.videoConstraint,{deviceId:{exact:e}}),audio:!1};c.default.debug("[".concat(t.streamId,"] ").concat(o)),Object(m.b)(o,(function(i){try{var o=function(){t.isPlaying()&&(t.stop(),t.elementID&&t.play(t.elementID,t.playOptions)),t.cameraId=e,t.videoConstraint.deviceId={exact:e},t.userMuteVideo&&(t.stream.getVideoTracks()[0].enabled=!1),E.a.restoreVideoEffect(t).then((function(){n&&n()}))};E.a.disableVideoEffect(t).then((function(){var e=!1;window.RTCRtpSender&&"function"==typeof RTCRtpSender.prototype.replaceTrack&&(e=!0),e?t.replaceTrack(i.getVideoTracks()[0],o,r):(t.removeTrack(t.stream.getVideoTracks()[0]),t.addTrack(i.getVideoTracks()[0]),o())}))}catch(e){return r&&r(e)}}),(function(e){return r&&r(e)}))},t._switchAudioDevice=function(e,n,r){if(e===t.microphoneId)return n&&n();var o={video:!1,audio:i()({},t.audioConstraint,{deviceId:{exact:e}})};c.default.debug("[".concat(t.streamId,"] "),o);var a=t.stream.getAudioTracks()[0];a&&a.stop(),Object(m.b)(o,(function(i){var o=function(){t._cleanupAudioMixing(),t.userMuteAudio&&(t.stream.getAudioTracks()[0].enabled=!1),t.isPlaying()&&(t.stop(),t.elementID&&t.play(t.elementID,t.playOptions)),t.microphoneId=e,t.audioConstraint.deviceId={exact:e},n&&n()};try{var a=!1;window.RTCRtpSender&&"function"==typeof RTCRtpSender.prototype.replaceTrack&&(a=!0),a?t.replaceTrack(i.getAudioTracks()[0],o,r):(t.removeTrack(t.stream.getAudioTracks()[0]),t.addTrack(i.getAudioTracks()[0]),o())}catch(e){return r&&r(e)}}),(function(e){return r&&r(e)}))},t.switchDevice=function(e,n,r,i){var o=f.report.reportApiInvoke(t.sid,{callback:function(e,t){if(e)return i&&i(e);r&&r(t)},name:"Stream.switchDevice",options:arguments,tag:"tracer"});Object(b.checkValidString)(n,"deviceId");var a=function(){return t.inSwitchDevice=!1,o()},s=function(e){t.inSwitchDevice=!1,c.default.error("[".concat(t.streamId,"] "),e),o(e)};if(t.inSwitchDevice)return o("Device switch is in process.");if(t.inSwitchDevice=!0,!t.local)return s("Only the local stream can switch the device.");if(t.screen&&"video"===e)return s("The device cannot be switched during screen-sharing.");if(!t.video&&"video"===e)return s("Video track not exist.");if(!t.audio&&"audio"===e)return s("Audio track not exist.");if(t.videoSource||t.audioSource)return s("The device cannot be switched when using videoSource or audioSource.");var u=!1;for(var d in t.audioMixing.sounds){var l=t.audioMixing.sounds[d];if(l.state!==t.audioMixing.states.IDLE){u=!0;break}}var p=t.audioMixing.audioContextInited;if(p&&u)return s("The device cannot be switched when using audio Mixing.");y.a.getDeviceById(n,(function(){if("video"===e)t._switchVideoDevice(n,a,s);else{if("audio"!==e)return s("Invalid type.");t._switchAudioDevice(n,a,s)}}),(function(){return s("The device does not exist.")}))},t},O=function(e){var t=f.report.reportApiInvoke(null,{name:"createStream",options:arguments,tag:"tracer",getStates:function(){return{audioTrackEnable:e&&e.audioSource?e.audioSource.enabled:null,videoTrackEnable:e&&e.videoSource?e.videoSource.enabled:null}}});Object(b.checkValidObject)(e,"StreamSpec");var n=e.streamID,r=e.audio,i=e.video,o=e.screen,a=e.screenAudio,s=(e.audioSource,e.videoSource,e.cameraId),u=e.facingMode,d=e.microphoneId,l=e.mirror,p=e.extensionId,h=e.mediaSource,m=e.audioProcessing,v=e.optimizationMode;if(!Object(b.isEmpty)(n)&&!Object(g.is32Uint)(n)&&!Object(b.isValidString)(n,1,255))throw new Error("[String streamID] Length of the string: [1,255]. ASCII characters only. [Number streamID] The value range is Uint32");if(Object(b.checkValidBoolean)(r,"audio"),Object(b.checkValidBoolean)(i,"video"),Object(b.isEmpty)(o)||Object(b.checkValidBoolean)(o,"screen"),Object(b.isEmpty)(a)||Object(b.checkValidBoolean)(a,"screenAudio"),Object(b.isEmpty)(s)||Object(b.checkValidString)(s,"cameraId",0,255,!1),Object(b.isEmpty)(u)||Object(b.checkValidEnum)(u,"facingMode",["user","environment","left","right"]),Object(b.isEmpty)(d)||Object(b.checkValidString)(d,"microphoneId",0,255,!1),Object(b.isEmpty)(p)||Object(b.checkValidString)(p,"extensionId"),Object(b.isEmpty)(h)||Object(b.checkValidEnum)(h,"mediaSource",["screen","application","window"]),Object(b.isEmpty)(l)||Object(b.checkValidBoolean)(l,"mirror"),!Object(b.isEmpty)(m)){var y=m.AGC,S=m.AEC,E=m.ANS;Object(b.isEmpty)(y)||Object(b.checkValidBoolean)(y,"AGC"),Object(b.isEmpty)(S)||Object(b.checkValidBoolean)(S,"AEC"),Object(b.isEmpty)(E)||Object(b.checkValidBoolean)(E,"ANS")}Object(b.isEmpty)(v)||Object(b.checkValidEnum)(v,"optimizationMode",["detail","motion"]),c.default.debug("Create stream"),!0===a&&!0===r&&c.default.warning("Do not set both 'screenAudio' and 'audio' to true at the same time"),e.screen&&!v&&(e.optimizationMode="detail");var _=C(e);return t(),_}},function(e,t,n){"use strict";n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return _}));var r=n(4),i=n(7),o=n.n(i),a=n(12),s=n.n(a),c=n(17),u=n.n(c),d=n(0),l=n(15),f=n(2);function p(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function m(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var v=n(50),y=n.n(v),b=n(26),S=(n(5),103),E=function(e){var t={};if(t.clientId=e.clientId,e.session_id=S+=1,"undefined"==typeof window||!window.navigator)throw d.default.error("["+t.streamId+"]["+t.clientId+"]Publish/subscribe video/audio streams not supported yet"),new Error("NON_BROWSER_ENV_DETECTED");return null!==window.navigator.userAgent.match("Firefox")?(t.browser="mozilla",t=function(e){var t={},n=(mozRTCPeerConnection,mozRTCSessionDescription),r=!1;t.uid=e.uid,t.isVideoMute=e.isVideoMute,t.isAudioMute=e.isAudioMute,t.isSubscriber=e.isSubscriber,t.clientId=e.clientId,t.filterStatsCache=[],t.originStatsCache=[],t.lastTimeGetStats=null,t.pc_config={iceServers:[]},e.iceServers instanceof Array?e.iceServers.map((function(e){0===e.url.indexOf("stun:")&&t.pc_config.iceServers.push({url:e.url})})):(e.stunServerUrl&&(e.stunServerUrl instanceof Array?e.stunServerUrl.map((function(e){"string"==typeof e&&""!==e&&t.pc_config.iceServers.push({url:e})})):"string"==typeof e.stunServerUrl&&""!==e.stunServerUrl&&t.pc_config.iceServers.push({url:e.stunServerUrl})),e.turnServers&&(e.turnServers instanceof Array?e.turnServers.map((function(e){e.udpport&&t.pc_config.iceServers.push({username:e.username,credential:e.credential,credentialType:"password",urls:(e.useTurns?"turns:":"turn:")+e.url+":"+e.udpport+"?transport=udp"}),"string"==typeof e.tcpport&&""!==e.tcpport&&t.pc_config.iceServers.push({username:e.username,credential:e.credential,credentialType:"password",urls:(e.useTurns?"turns:":"turn:")+e.url+":"+e.tcpport+"?transport=tcp"}),!0===e.forceturn&&(t.pc_config.iceTransportPolicy="relay")})):d.default.error("[".concat(t.clientId,"] turnServers is not a array")))),void 0===e.audio&&(e.audio=!0),void 0===e.video&&(e.video=!0),t.mediaConstraints={offerToReceiveAudio:e.audio,offerToReceiveVideo:e.video,mozDontOfferDataChannel:!0},t.roapSessionId=103,t.peerConnection=new l.RTCPeerConnection(t.pc_config),t.iceCandidateTimer=setTimeout((function(){t.iceCandidateTimer=null,d.default.debug("[".concat(t.clientId,"]Candidates collected: ").concat(t.iceCandidateCount)),t.moreIceComing&&(t.moreIceComing=!1,t.markActionNeeded())}),Object(f.getParameter)("CANDIDATE_TIMEOUT")),t.peerConnection.onicecandidate=function(e){var n,r,i,o;r=(n=t.peerConnection.localDescription.sdp).match(/a=candidate:.+typ\ssrflx.+\r\n/),i=n.match(/a=candidate:.+typ\shost.+\r\n/),o=n.match(/a=candidate:.+typ\srelay.+\r\n/),null===r&&null===i&&null===o||void 0!==t.ice||!t.iceCandidateTimer||(clearTimeout(t.iceCandidateTimer),t.iceCandidateTimer=null,t.ice=0,t.moreIceComing=!1,t.markActionNeeded()),t.iceCandidateCount=t.iceCandidateCount+1},t.checkMLineReverseInSDP=function(e){return!(!~e.indexOf("m=audio")||!~e.indexOf("m=video"))&&e.indexOf("m=audio")>e.indexOf("m=video")},t.reverseMLineInSDP=function(e){var t=e.split("m=audio"),n=t[1].split("m=video"),r="m=video"+n[1],i="m=audio"+n[0];return t[0]+r+i},t.processSignalingMessage=function(r){var i,o=JSON.parse(r);t.incomingMessage=o,"new"===t.state?"OFFER"===o.messageType?(o.sdp=v(o.sdp),i={sdp:o.sdp,type:"offer"},t.peerConnection.setRemoteDescription(new n(i),(function(){d.default.debug("["+t.clientId+"]setRemoteDescription succeeded")}),(function(e){d.default.info("["+t.clientId+"]setRemoteDescription failed: "+e.name)})),t.state="offer-received",t.markActionNeeded()):t.error("Illegal message for this state: "+o.messageType+" in state "+t.state):"offer-sent"===t.state?"ANSWER"===o.messageType?(o.sdp=v(o.sdp),o.sdp=o.sdp.replace(/ generation 0/g,""),o.sdp=o.sdp.replace(/ udp /g," UDP "),-1!==o.sdp.indexOf("a=group:BUNDLE")?(o.sdp=o.sdp.replace(/a=group:BUNDLE audio video/,"a=group:BUNDLE sdparta_0 sdparta_1"),o.sdp=o.sdp.replace(/a=mid:audio/,"a=mid:sdparta_0"),o.sdp=o.sdp.replace(/a=mid:video/,"a=mid:sdparta_1")):(o.sdp=o.sdp.replace(/a=mid:audio/,"a=mid:sdparta_0"),o.sdp=o.sdp.replace(/a=mid:video/,"a=mid:sdparta_0")),i={sdp:o.sdp,type:"answer"},e.screen&&"detail"===e.optimizationMode&&(d.default.debug("[".concat(t.client,"] remove screen share abs ext")),o.sdp=y(i.sdp)),t.peerConnection.setRemoteDescription(new n(i),(function(){d.default.debug("["+t.clientId+"]setRemoteDescription succeeded")}),(function(e){d.default.info("["+t.clientId+"]setRemoteDescription failed: "+e)})),t.state="established"):"pr-answer"===o.messageType?(i={sdp:o.sdp,type:"pr-answer"},t.peerConnection.setRemoteDescription(new n(i),(function(){d.default.debug("["+t.clientId+"]setRemoteDescription succeeded")}),(function(e){d.default.info("["+t.clientId+"]setRemoteDescription failed: "+e.name)}))):"offer"===o.messageType?t.error("Not written yet"):t.error("Illegal message for this state: "+o.messageType+" in state "+t.state):"established"===t.state&&("OFFER"===o.messageType?(i={sdp:o.sdp,type:"offer"},t.peerConnection.setRemoteDescription(new n(i),(function(){d.default.debug("["+t.clientId+"]setRemoteDescription succeeded")}),(function(e){d.default.info("["+t.clientId+"]setRemoteDescription failed: "+e.name)})),t.state="offer-received",t.markActionNeeded()):t.error("Illegal message for this state: "+o.messageType+" in state "+t.state))},t.setRtpSenderParameters=function(){var e=u()(s.a.mark((function e(n){var r,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.peerConnection.getSenders(),i=r.find((function(e){return"video"===e.track.kind}))){e.next=4;break}return e.abrupt("return");case 4:return(o=i.getParameters()).degradationPreference=n,e.prev=6,d.default.debug("[".concat(t.clientId,"] setParameters"),o),e.next=10,i.setParameters(o);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(6),d.default.debug("[".concat(t.clientId,"] setParameters failed, ignore"));case 15:case"end":return e.stop()}}),e,null,[[6,12]])})));return function(t){return e.apply(this,arguments)}}();var i={id:"",type:"",mediaType:"opus",googCodecName:"opus",aecDivergentFilterFraction:"0",audioInputLevel:"0",bytesSent:"0",packetsSent:"0",googEchoCancellationReturnLoss:"0",googEchoCancellationReturnLossEnhancement:"0"},o={id:"",type:"",mediaType:"",googCodecName:e.codec?e.codec.toUpperCase():"",bytesSent:"0",packetsLost:"0",packetsSent:"0",googAdaptationChanges:"0",googAvgEncodeMs:"0",googEncodeUsagePercent:"0",googFirsReceived:"0",googFrameHeightSent:"0",googFrameHeightInput:"0",googFrameRateInput:"0",googFrameRateSent:"0",googFrameWidthSent:"0",googFrameWidthInput:"0",googNacksReceived:"0",googPlisReceived:"0",googRtt:"0"},a={id:"",type:"",mediaType:"",audioOutputLevel:"0",bytesReceived:"0",packetsLost:"0",packetsReceived:"0",googAccelerateRate:"0",googCurrentDelayMs:"0",googDecodingCNG:"0",googDecodingCTN:"0",googDecodingCTSG:"0",googDecodingNormal:"0",googDecodingPLC:"0",googDecodingPLCCNG:"0",googExpandRate:"0",googJitterBufferMs:"0",googJitterReceived:"0",googPreemptiveExpandRate:"0",googPreferredJitterBufferMs:"0",googSecondaryDecodedRate:"0",googSpeechExpandRate:"0"},c={id:"",type:"",mediaType:"",googTargetDelayMs:"0",packetsLost:"0",googDecodeMs:"0",googMaxDecodeMs:"0",googRenderDelayMs:"0",googFrameWidthReceived:"0",googFrameHeightReceived:"0",googFrameRateReceived:"0",googFrameRateDecoded:"0",googFrameRateOutput:"0",googJitterBufferMs:"0",googCurrentDelayMs:"0",googMinPlayoutDelayMs:"0",googNacksSent:"0",googPlisSent:"0",googFirsSent:"0",bytesReceived:"0",packetsReceived:"0",googFramesDecoded:"0"},p=0,h=0,g=0;t.getVideoRelatedStats=function(e){t.peerConnection.getStats().then((function(n){var r,i=m(n.values());try{for(i.s();!(r=i.n()).done;){var o=r.value;if(t.isSubscriber){if(("inbound-rtp"===o.type||"inboundrtp"===o.type)&&"video"===o.mediaType){if(!t.lastReport)return void(t.lastReport=o);e&&e({browser:"firefox",mediaType:"video",peerId:t.uid,isVideoMute:t.isVideoMute,frameRateReceived:Math.round(o.framerateMean)+"",frameRateDecoded:o.framesDecoded-t.lastReport.framesDecoded+"",bytesReceived:o.bytesReceived+"",packetsReceived:o.packetsReceived+"",packetsLost:o.packetsLost+""}),t.lastReport=o}}else if(("outbound-rtp"===o.type||"outboundrtp"===o.type)&&"video"===o.mediaType){if(!t.lastReport)return void(t.lastReport=o);e&&e({mediaType:"video",isVideoMute:t.isVideoMute,frameRateInput:Math.round(o.framerateMean)+"",frameRateSent:o.framesEncoded-t.lastReport.framesEncoded+""}),t.lastReport=o}}}catch(e){i.e(e)}finally{i.f()}}))},t.getAudioRelatedStats=function(e){t.peerConnection.getStats().then((function(n){var r,i=m(n.values());try{for(i.s();!(r=i.n()).done;){var o=r.value;t.isSubscriber&&("inbound-rtp"!==o.type&&"inboundrtp"!==o.type||"audio"!==o.mediaType||e&&e({browser:"firefox",mediaType:"audio",peerId:t.uid,isAudioMute:t.isAudioMute,frameDropped:o.packetsLost+"",frameReceived:o.packetsReceived+"",googJitterReceived:o.jitter+"",bytesReceived:o.bytesReceived+"",packetsReceived:o.packetsReceived+"",packetsLost:o.packetsLost+""}))}}catch(e){i.e(e)}finally{i.f()}}))},t.getStatsRate=function(e){t.getStats((function(t){t.forEach((function(e){})),e(t)}))},t.getStats=function(e,n){n=(n=n||500)>500?500:n,t.lastTimeGetStats&&Date.now()-t.lastTimeGetStats<n?e&&e(t.filterStatsCache,t.originStatsCache):this._getStats((function(n,r){t.filterStatsCache=n,t.originStatsCache=r,t.lastTimeGetStats=Date.now(),e&&e(n,r)}))},t._getStats=function(n){t.peerConnection.getStats().then((function(r){var s,u=[],d=m(r.values());try{for(d.s();!(s=d.n()).done;){var l=s.value;u.push(l),"outbound-rtp"!==l.type&&"outboundrtp"!==l.type||"video"!==l.mediaType||-1!==l.id.indexOf("rtcp")||(o.id=l.id,o.type=l.type,o.mediaType=l.mediaType,o.bytesSent=l.bytesSent?l.bytesSent+"":"0",o.packetsSent=l.packetsSent?l.packetsSent+"":"0",o.googPlisReceived=l.pliCount?l.pliCount+"":"0",o.googNacksReceived=l.nackCount?l.nackCount+"":"0",o.googFirsReceived=l.firCount?l.firCount+"":"0",o.googFrameRateSent=l.framerateMean?Math.round(l.framerateMean)+"":"0"),"outbound-rtp"!==l.type&&"outboundrtp"!==l.type||"audio"!==l.mediaType||-1!==l.id.indexOf("rtcp")||(i.id=l.id,i.type=l.type,i.mediaType=l.mediaType,i.bytesSent=l.bytesSent?l.bytesSent+"":"0",i.packetsSent=l.packetsSent?l.packetsSent+"":"0",e.agoraStream.local&&(i.audioInputLevel=Math.round(32767*e.agoraStream.getAudioLevel()).toString())),"inbound-rtp"!==l.type&&"inboundrtp"!==l.type||"audio"!==l.mediaType||l.isRemote||-1!==l.id.indexOf("rtcp")||(a.id=l.id,a.type=l.type,a.mediaType=l.mediaType,a.bytesReceived=l.bytesReceived?l.bytesReceived+"":"0",a.packetsLost=l.packetsLost?l.packetsLost+"":"0",a.packetsReceived=l.packetsReceived?l.packetsReceived+"":"0",a.googJitterReceived=l.jitter?l.jitter+"":"0",e.agoraStream.local||(a.audioOutputLevel=Math.round(32767*e.agoraStream.getAudioLevel()).toString())),"inbound-rtp"!==l.type&&"inboundrtp"!==l.type||"video"!==l.mediaType||l.isRemote||-1!==l.id.indexOf("rtcp")||(c.id=l.id,c.type=l.type,c.mediaType=l.mediaType,c.bytesReceived=l.bytesReceived?l.bytesReceived+"":"0",c.googFrameRateReceived=l.framerateMean?Math.round(l.framerateMean)+"":"0",c.googFramesDecoded=l.framesDecoded?l.framesDecoded+"":"0",Date.now()-g>=1e3?(c.googFrameRateDecoded=(l.framesDecoded-p)/((Date.now()-g)/1e3),c.googFrameRateDecoded=Math.round(Math.max(0,c.googFrameRateDecoded)),g=Date.now(),h=c.googFrameRateDecoded,p=l.framesDecoded,c.googFrameRateDecoded=c.googFrameRateDecoded.toString()):c.googFrameRateDecoded=h.toString(),c.packetsLost=l.packetsLost?l.packetsLost+"":"0",c.packetsReceived=l.packetsReceived?l.packetsReceived+"":"0",c.googJitterBufferMs=l.jitter?l.jitter+"":"0",c.googNacksSent=l.nackCount?l.nackCount+"":"0",c.googPlisSent=l.pliCount?l.pliCount+"":"0",c.googFirsSent=l.firCount?l.firCount+"":"0"),-1!==l.id.indexOf("outbound_rtcp_video")&&(o.packetsLost=l.packetsLost?l.packetsLost+"":"0")}}catch(e){d.e(e)}finally{d.f()}var f=[o,i,a,c];f.push({id:"time",startTime:t.connectedTime,timestamp:new Date}),n(f,u)}),(function(e){d.default.error("["+t.clientId+"]"+e)}))},t.addStream=function(e){r=!0,t.peerConnection.addStream(e),t.markActionNeeded()},t.removeStream=function(){t.markActionNeeded()},t.close=function(){t.state="closed",t.peerConnection.close()},t.markActionNeeded=function(){t.actionNeeded=!0,t.doLater((function(){t.onstablestate()}))},t.doLater=function(e){window.setTimeout(e,1)},t.onstablestate=function(){if(t.actionNeeded){if("new"===t.state||"established"===t.state)r&&(t.mediaConstraints=void 0),t.peerConnection.createOffer((function(e){if(e.sdp=v(e.sdp),e.sdp=e.sdp.replace(/a=extmap:1 http:\/\/www.webrtc.org\/experiments\/rtp-hdrext\/abs-send-time/,"a=extmap:3 http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"),e.sdp!==t.prevOffer)return t.peerConnection.setLocalDescription(e),t.state="preparing-offer",void t.markActionNeeded();d.default.debug("["+t.clientId+"]Not sending a new offer")}),(function(e){d.default.debug("["+t.clientId+"]Ups! create offer failed ",e)}),t.mediaConstraints);else if("preparing-offer"===t.state){if(t.moreIceComing)return;t.prevOffer=t.peerConnection.localDescription.sdp,t.offerCandidates=t.prevOffer.match(/a=candidate.+\r\n/g)||[],t.offerCandidates.length||(e.isCloudProxy3&&e.onNoIceCandidate&&e.onNoIceCandidate(),d.default.warning("[".concat(t.clientId,"]No Ice Candidate generated")),Object(f.getParameter)("SHIM_CANDIDATE")?(d.default.debug("Shimming fake candidate"),t.prevOffer+="a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"):d.default.error("[".concat(t.clientId,"]None Ice Candidate not allowed"))),t.prevOffer=t.prevOffer.replace(/a=candidate:.+typ\shost.+\r\n/g,"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"),t.sendMessage("OFFER",t.prevOffer),t.state="offer-sent"}else if("offer-received"===t.state)t.peerConnection.createAnswer((function(e){if(t.peerConnection.setLocalDescription(e),t.state="offer-received-preparing-answer",t.iceStarted)t.markActionNeeded();else{var n=new Date;d.default.debug("["+t.clientId+"]"+n.getTime()+": Starting ICE in responder"),t.iceStarted=!0}}),(function(){d.default.debug("["+t.clientId+"]Ups! Something went wrong")}));else if("offer-received-preparing-answer"===t.state){if(t.moreIceComing)return;var n=t.peerConnection.localDescription.sdp;t.sendMessage("ANSWER",n),t.state="established"}else t.debug("Dazed and confused in state "+t.state+", stopping here");t.actionNeeded=!1}},t.sendMessage=function(e,n){var r={};r.messageType=e,r.sdp=n,"OFFER"===e?(r.offererSessionId=t.sessionId,r.answererSessionId=t.otherSessionId,r.seq=t.sequenceNumber+=1,r.tiebreaker=Math.floor(429496723*Math.random()+1)):(r.offererSessionId=t.incomingMessage.offererSessionId,r.answererSessionId=t.sessionId,r.seq=t.incomingMessage.seq),t.onsignalingmessage(JSON.stringify(r))},t._getSender=function(e){if(t.peerConnection&&t.peerConnection.getSenders){var n=t.peerConnection.getSenders().find((function(t){return t.track.kind==e}));if(n)return n}return null},t.hasSender=function(e){return!!t._getSender(e)},t.replaceTrack=function(e,n,r){var i=t._getSender(e.kind);if(!i)return r("NO_SENDER_FOUND");try{i.replaceTrack(e)}catch(e){return r&&r(e)}setTimeout((function(){return n&&n()}),50)},t.error=function(e){throw"Error in RoapOnJsep: "+e},t.sessionId=t.roapSessionId+=1,t.sequenceNumber=0,t.actionNeeded=!1,t.iceStarted=!1,t.moreIceComing=!0,t.iceCandidateCount=0,t.onsignalingmessage=e.callback,t.peerConnection.ontrack=function(e){t.onaddstream&&t.onaddstream(e,"ontrack")},t.peerConnection.onremovestream=function(e){t.onremovestream&&t.onremovestream(e)},t.peerConnection.oniceconnectionstatechange=function(e){"connected"===e.currentTarget.iceConnectionState&&(t.connectedTime=new Date),t.oniceconnectionstatechange&&t.oniceconnectionstatechange(e.currentTarget.iceConnectionState)};var v=function(t){var n;if(e.video&&e.maxVideoBW&&(null==(n=t.match(/m=video.*\r\n/))&&(n=t.match(/m=video.*\n/)),n&&n.length>0)){var r=n[0]+"b=TIAS:"+1e3*e.maxVideoBW+"\r\n";t=t.replace(n[0],r)}return e.audio&&e.maxAudioBW&&(null==(n=t.match(/m=audio.*\r\n/))&&(n=t.match(/m=audio.*\n/)),n&&n.length>0)&&(r=n[0]+"b=TIAS:"+1e3*e.maxAudioBW+"\r\n",t=t.replace(n[0],r)),t},y=function(e){return(e=e.replace(/a=.*abs-send-time\r\n/g,"")).replace(/a=.*goog-remb\r\n/g,"")};return t.onaddstream=null,t.onremovestream=null,t.state="new",t.markActionNeeded(),t}(e)):"iOS"===r.getBrowserOS()||r.isSafari()?(d.default.debug("["+t.streamId+"]["+t.clientId+"]Safari"),(t=function(e){var t={},n=l.RTCPeerConnection;t.uid=e.uid,t.isVideoMute=e.isVideoMute,t.isAudioMute=e.isAudioMute,t.isSubscriber=e.isSubscriber,t.clientId=e.clientId,t.filterStatsCache=[],t.originStatsCache=[],t.lastTimeGetStats=null,t.pc_config={iceServers:[],bundlePolicy:"max-bundle"},t.con={optional:[{DtlsSrtpKeyAgreement:!0}]},e.iceServers instanceof Array?t.pc_config.iceServers=e.iceServers:(e.stunServerUrl&&(e.stunServerUrl instanceof Array?e.stunServerUrl.map((function(e){"string"==typeof e&&""!==e&&t.pc_config.iceServers.push({url:e})})):"string"==typeof e.stunServerUrl&&""!==e.stunServerUrl&&t.pc_config.iceServers.push({url:e.stunServerUrl})),e.turnServers&&(e.turnServers instanceof Array?e.turnServers.map((function(e){e.udpport&&t.pc_config.iceServers.push({username:e.username,credential:e.credential,credentialType:"password",urls:(e.useTurns?"turns:":"turn:")+e.url+":"+e.udpport+"?transport=udp"}),"string"==typeof e.tcpport&&""!==e.tcpport&&t.pc_config.iceServers.push({username:e.username,credential:e.credential,credentialType:"password",urls:(e.useTurns?"turns:":"turn:")+e.url+":"+e.tcpport+"?transport=tcp"}),!0===e.forceturn&&(t.pc_config.iceTransportPolicy="relay")})):d.default.error("[".concat(t.clientId,"] turnServers is not a array")))),void 0===e.audio&&(e.audio=!0),void 0===e.video&&(e.video=!0),t.mediaConstraints={mandatory:{OfferToReceiveVideo:e.video,OfferToReceiveAudio:e.audio}},t.roapSessionId=103;try{t.pc_config.sdpSemantics=Object(f.getParameter)("PLAN"),t.peerConnection=new n(t.pc_config,t.con)}catch(e){delete t.pc_config.sdpSemantics,t.peerConnection=new n(t.pc_config,t.con)}t.iceCandidateTimer=setTimeout((function(){t.iceCandidateTimer=null,t.moreIceComing&&(t.moreIceComing=!1,t.markActionNeeded())}),Object(f.getParameter)("CANDIDATE_TIMEOUT")),t.peerConnection.onicecandidate=function(e){var n,r,i,o;r=(n=t.peerConnection.localDescription.sdp).match(/a=candidate:.+typ\ssrflx.+\r\n/),i=n.match(/a=candidate:.+typ\shost.+\r\n/),o=n.match(/a=candidate:.+typ\srelay.+\r\n/),0===t.iceCandidateCount&&(t.timeout=setTimeout((function(){t.moreIceComing&&(t.moreIceComing=!1,t.markActionNeeded())}),1e3)),null===r&&null===i&&null===o||void 0!==t.ice||!t.iceCandidateTimer||(clearTimeout(t.iceCandidateTimer),t.iceCandidateTimer=null,t.ice=0,t.moreIceComing=!1,t.markActionNeeded()),t.iceCandidateCount=t.iceCandidateCount+1};var r=function(t){return e.screen&&(t=t.replace("a=x-google-flag:conference\r\n","")),t},i=function(n){var r,i;return(r=n.match(/m=video.*\r\n/))&&e.minVideoBW&&e.maxVideoBW&&(i=r[0]+"b=AS:"+e.maxVideoBW+"\r\n",n=n.replace(r[0],i),d.default.debug("["+t.clientId+"]Set Video Bitrate - min:"+e.minVideoBW+" max:"+e.maxVideoBW)),(r=n.match(/m=audio.*\r\n/))&&e.maxAudioBW&&(i=r[0]+"b=AS:"+e.maxAudioBW+"\r\n",n=n.replace(r[0],i)),n};t.processSignalingMessage=function(n){var o,a=JSON.parse(n);t.incomingMessage=a,"new"===t.state?"OFFER"===a.messageType?(o={sdp:a.sdp,type:"offer"},t.peerConnection.setRemoteDescription(new RTCSessionDescription(o)),t.state="offer-received",t.markActionNeeded()):t.error("Illegal message for this state: "+a.messageType+" in state "+t.state):"offer-sent"===t.state?"ANSWER"===a.messageType?((o={sdp:a.sdp,type:"answer"}).sdp=r(o.sdp),o.sdp=i(o.sdp),o.sdp=o.sdp.replace(/a=x-google-flag:conference\r\n/g,""),e.screen&&"detail"===e.optimizationMode&&(d.default.debug("[".concat(t.client,"] remove screen share abs ext")),o.sdp=o.sdp.replace(/a=.*abs-send-time\r\n/g,"").replace(/a=.*goog-remb\r\n/g,"")),t.peerConnection.setRemoteDescription(new RTCSessionDescription(o)),t.state="established"):"pr-answer"===a.messageType?(o={sdp:a.sdp,type:"pr-answer"},t.peerConnection.setRemoteDescription(new RTCSessionDescription(o))):"offer"===a.messageType?t.error("Not written yet"):t.error("Illegal message for this state: "+a.messageType+" in state "+t.state):"established"===t.state&&("OFFER"===a.messageType?(o={sdp:a.sdp,type:"offer"},t.peerConnection.setRemoteDescription(new RTCSessionDescription(o)),t.state="offer-received",t.markActionNeeded()):"ANSWER"===a.messageType?((o={sdp:a.sdp,type:"answer"}).sdp=r(o.sdp),o.sdp=i(o.sdp),t.peerConnection.setRemoteDescription(new RTCSessionDescription(o))):t.error("Illegal message for this state: "+a.messageType+" in state "+t.state))},t.setRtpSenderParameters=function(){var e=u()(s.a.mark((function e(n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.degradation=n;case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t._setRtpSenderParameters=function(){var e=u()(s.a.mark((function e(n){var r,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.peerConnection.getSenders(),i=r.find((function(e){return e&&e.track&&"video"===e.track.kind}))){e.next=4;break}return e.abrupt("return");case 4:return(o=i.getParameters()).degradationPreference=n,e.prev=6,d.default.debug("[".concat(t.clientId,"] setParameters"),o),e.next=10,i.setParameters(o);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(6),d.default.debug("[".concat(t.clientId,"] setParameters failed, ignore"));case 15:case"end":return e.stop()}}),e,null,[[6,12]])})));return function(t){return e.apply(this,arguments)}}();var o={id:"",type:"",mediaType:"",googCodecName:"opus",aecDivergentFilterFraction:"0",audioInputLevel:"0",bytesSent:"0",packetsSent:"0",googEchoCancellationReturnLoss:"0",googEchoCancellationReturnLossEnhancement:"0"},a={id:"",type:"",mediaType:"",googCodecName:e.codec?e.codec.toUpperCase():"",bytesSent:"0",packetsLost:"0",packetsSent:"0",googAdaptationChanges:"0",googAvgEncodeMs:"0",googEncodeUsagePercent:"0",googFirsReceived:"0",googFrameHeightSent:"0",googFrameHeightInput:"0",googFrameRateInput:"0",googFrameRateSent:"0",googFrameWidthSent:"0",googFrameWidthInput:"0",googNacksReceived:"0",googPlisReceived:"0",googRtt:"0",googFramesEncoded:"0"},c={id:"",type:"",mediaType:"",audioOutputLevel:"0",bytesReceived:"0",packetsLost:"0",packetsReceived:"0",googAccelerateRate:"0",googCurrentDelayMs:"0",googDecodingCNG:"0",googDecodingCTN:"0",googDecodingCTSG:"0",googDecodingNormal:"0",googDecodingPLC:"0",googDecodingPLCCNG:"0",googExpandRate:"0",googJitterBufferMs:"0",googJitterReceived:"0",googPreemptiveExpandRate:"0",googPreferredJitterBufferMs:"0",googSecondaryDecodedRate:"0",googSpeechExpandRate:"0"},p={id:"",type:"",mediaType:"",googTargetDelayMs:"0",packetsLost:"0",googDecodeMs:"0",googMaxDecodeMs:"0",googRenderDelayMs:"0",googFrameWidthReceived:"0",googFrameHeightReceived:"0",googFrameRateReceived:"0",googFrameRateDecoded:"0",googFrameRateOutput:"0",googFramesDecoded:"0",googFrameReceived:"0",googJitterBufferMs:"0",googCurrentDelayMs:"0",googMinPlayoutDelayMs:"0",googNacksSent:"0",googPlisSent:"0",googFirsSent:"0",bytesReceived:"0",packetsReceived:"0"},h={id:"bweforvideo",type:"VideoBwe",googAvailableSendBandwidth:"0",googAvailableReceiveBandwidth:"0",googActualEncBitrate:"0",googRetransmitBitrate:"0",googTargetEncBitrate:"0",googBucketDelay:"0",googTransmitBitrate:"0"},m=0,g=0,v=0;return t.isRemoteVideoStats=function(e){return!!(e.frameHeight&&e.frameWidth&&e.remoteSource)},t.getVideoRelatedStats=function(n){t.peerConnection.getStats().then((function(r){r.forEach((function(r){if(t.isSubscriber){var i={peerId:t.uid,mediaType:"video",isVideoMute:t.isVideoMute};if("track"===r.type&&(~r.id.indexOf("video")||~r.trackIdentifier.indexOf("v")||t.isRemoteVideoStats(r))){if(!t.lastReport)return void(t.lastReport=r);i.frameRateReceived=r.framesReceived-t.lastReport.framesReceived+"",i.frameRateDecoded=r.framesDecoded-t.lastReport.framesDecoded+"",t.lastReport=r}"inbound-rtp"===r.type&&~r.id.indexOf("Video")&&(i.bytesReceived=r.bytesReceived+"",i.packetsReceived=r.packetsReceived+"",i.packetsLost=r.packetsLost+""),n&&n(i)}else if("outbound-rtp"===r.type&&~r.id.indexOf("Video")){if(!t.lastReport)return void(t.lastReport=r);n&&n({mediaType:"video",isVideoMute:t.isVideoMute,frameRateInput:e.maxFrameRate+"",frameRateSent:r.framesEncoded-t.lastReport.framesEncoded+""}),t.lastReport=r}}))}))},t.getAudioRelatedStats=function(e){t.peerConnection.getStats().then((function(n){n.forEach((function(n){t.isSubscriber&&"inbound-rtp"===n.type&&~n.id.indexOf("Audio")&&e&&e({peerId:t.uid,mediaType:"audio",isAudioMute:t.isAudioMute,frameDropped:n.packetsLost+"",frameReceived:n.packetsReceived+"",googJitterReceived:n.jitter+"",bytesReceived:n.bytesReceived+"",packetsReceived:n.packetsReceived+"",packetsLost:n.packetsLost+""})}))}))},t.getStatsRate=function(e){t.getStats((function(t){t.forEach((function(e){"outbound-rtp"===e.type&&"video"===e.mediaType&&e.googFramesEncoded&&(e.googFrameRateSent=Math.ceil((e.googFramesEncoded-m)/3).toString(),m=e.googFramesEncoded),"inbound-rtp"===e.type&&-1!=e.id.indexOf("55543")&&(e.googFrameRateReceived&&(e.googFrameRateReceived=Math.ceil((e.googFrameReceived-v)/3).toString(),v=e.googFrameReceived),e.googFrameRateDecoded&&(e.googFrameRateDecoded=Math.ceil((e.googFramesDecoded-g)/3).toString(),g=e.googFramesDecoded))})),e(t)}))},t.getStats=function(e,n){n=(n=n||500)>500?500:n,t.lastTimeGetStats&&Date.now()-t.lastTimeGetStats<n?e&&e(t.filterStatsCache,t.originStatsCache):this._getStats((function(n,r){t.filterStatsCache=n,t.originStatsCache=r,t.lastTimeGetStats=Date.now(),e&&e(n,r)}))},t._getStats=function(n){var r=[];t.peerConnection.getStats().then((function(i){i.forEach((function(t){var n;r.push(t),"outbound-rtp"===t.type&&"audio"===t.mediaType&&(o.id=t.id,o.type=t.type,o.mediaType=t.mediaType,o.bytesSent=t.bytesSent?t.bytesSent+"":"0",o.packetsSent=t.packetsSent?t.packetsSent+"":"0",e.agoraStream.local&&(o.audioInputLevel=Math.round(32767*e.agoraStream.getAudioLevel()).toString())),"outbound-rtp"===t.type&&"video"===t.mediaType&&(a.id=t.id,a.type=t.type,a.mediaType=t.mediaType,a.bytesSent=t.bytesSent?t.bytesSent+"":"0",a.packetsSent=t.packetsSent?t.packetsSent+"":"0",a.googPlisReceived=t.pliCount?t.pliCount+"":"0",a.googNacksReceived=t.nackCount?t.nackCount+"":"0",a.googFirsReceived=t.firCount?t.firCount+"":"0",a.googFramesEncoded=t.framesEncoded?t.framesEncoded+"":"0",(n=i.get(t.trackId))&&(a.googFrameHeightSent=n.frameHeight&&n.frameHeight.toString(),a.googFrameWidthSent=n.frameWidth&&n.frameWidth.toString())),"inbound-rtp"!==t.type||-1==t.id.indexOf("44444")&&"audio"!==t.mediaType||(c.id=t.id,c.type=t.type,c.mediaType="audio",c.packetsReceived=t.packetsReceived?t.packetsReceived+"":"0",c.bytesReceived=t.bytesReceived?t.bytesReceived+"":"0",c.packetsLost=t.packetsLost?t.packetsLost+"":"0",c.packetsReceived=t.packetsReceived?t.packetsReceived+"":"0",c.googJitterReceived=t.jitter?t.jitter+"":"0",(n=i.get(t.trackId))&&(c.audioOutputLevel=n.audioLevel&&Math.round(32767*n.audioLevel).toString()),e.agoraStream.local||c.audioOutputLevel||(c.audioOutputLevel=Math.round(32767*e.agoraStream.getAudioLevel()).toString())),"inbound-rtp"!==t.type||-1==t.id.indexOf("55543")&&"video"!==t.mediaType||(p.id=t.id,p.type=t.type,p.mediaType="video",p.packetsReceived=t.packetsReceived?t.packetsReceived+"":"0",p.bytesReceived=t.bytesReceived?t.bytesReceived+"":"0",p.packetsLost=t.packetsLost?t.packetsLost+"":"0",p.googJitterBufferMs=t.jitter?t.jitter+"":"0",p.googNacksSent=t.nackCount?t.nackCount+"":"0",p.googPlisSent=t.pliCount?t.pliCount+"":"0",p.googFirsSent=t.firCount?t.firCount+"":"0",(n=i.get(t.trackId))&&(p.googFrameHeightReceived=n.frameHeight&&n.frameHeight.toString(),p.googFrameWidthReceived=n.frameWidth&&n.frameWidth.toString(),p.googFrameReceived=n.framesReceived&&n.framesReceived.toString(),p.googFramesDecoded=n.framesDecoded&&n.framesDecoded.toString())),"candidate-pair"===t.type&&(0==t.availableIncomingBitrate?h.googAvailableSendBandwidth=t.availableOutgoingBitrate+"":h.googAvailableReceiveBandwidth=t.availableIncomingBitrate+"")}));var s=[h,o,a,c,p];s.push({id:"time",startTime:t.connectedTime,timestamp:new Date}),n(s,r)})).catch((function(e){d.default.error("["+t.clientId+"] ",e)}))},t.addTrack=function(e,n){t.peerConnection.addTrack(e,n)},t.removeTrack=function(e,n){var r=t.peerConnection.getSenders().find((function(t){return t.track==e}));r.replaceTrack(null),t.peerConnection.removeTrack(r)},t.addStream=function(e){window.navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome")?e.getTracks().forEach((function(n){return t.peerConnection.addTrack(n,e)})):t.peerConnection.addStream(e),t.markActionNeeded()},t.removeStream=function(){t.markActionNeeded()},t.close=function(){t.state="closed",t.peerConnection.close()},t.markActionNeeded=function(){t.actionNeeded=!0,t.doLater((function(){t.onstablestate()}))},t.doLater=function(e){window.setTimeout(e,1)},t.onstablestate=function(){var n;if(t.actionNeeded){if("new"===t.state||"established"===t.state)e.isSubscriber&&(t.peerConnection.addTransceiver("audio",{direction:"recvonly"}),t.peerConnection.addTransceiver("video",{direction:"recvonly"})),t.peerConnection.createOffer(t.mediaConstraints).then((function(n){if(n.sdp=i(n.sdp),e.isSubscriber||(n.sdp=n.sdp.replace(/a=.*video-orientation\r\n/g,"")),n.sdp!==t.prevOffer)return t.peerConnection.setLocalDescription(n),t.state="preparing-offer",void t.markActionNeeded();d.default.debug("["+t.clientId+"]Not sending a new offer")})).catch((function(e){d.default.debug("["+t.clientId+"]peer connection create offer failed ",e)}));else if("preparing-offer"===t.state){if(t.moreIceComing)return;t.prevOffer=t.peerConnection.localDescription.sdp,t.offerCandidates=t.prevOffer.match(/a=candidate.+\r\n/g)||[],t.offerCandidates.length||(d.default.warning("[".concat(t.clientId,"]No Ice Candidate generated")),e.isCloudProxy3&&e.onNoIceCandidate&&e.onNoIceCandidate(),Object(f.getParameter)("SHIM_CANDIDATE")?(d.default.debug("Shimming fake candidate"),t.prevOffer+="a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"):d.default.error("[".concat(t.clientId,"]None Ice Candidate not allowed"))),t.prevOffer=t.prevOffer.replace(/a=candidate:.+typ\shost.+\r\n/g,"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"),t.sendMessage("OFFER",t.prevOffer),t.state="offer-sent"}else if("offer-received"===t.state)t.peerConnection.createAnswer((function(e){if(t.peerConnection.setLocalDescription(e),t.state="offer-received-preparing-answer",t.iceStarted)t.markActionNeeded();else{var n=new Date;d.default.debug("["+t.clientId+"]"+n.getTime()+": Starting ICE in responder"),t.iceStarted=!0}}),(function(e){d.default.debug("["+t.clientId+"]peer connection create answer failed ",e)}),t.mediaConstraints);else if("offer-received-preparing-answer"===t.state){if(t.moreIceComing)return;n=t.peerConnection.localDescription.sdp,t.sendMessage("ANSWER",n),t.state="established"}else t.debug("Dazed and confused in state "+t.state+", stopping here");t.actionNeeded=!1}},t.sendMessage=function(e,n){var r={};r.messageType=e,r.sdp=n,"OFFER"===e?(r.offererSessionId=t.sessionId,r.answererSessionId=t.otherSessionId,r.seq=t.sequenceNumber+=1,r.tiebreaker=Math.floor(429496723*Math.random()+1)):(r.offererSessionId=t.incomingMessage.offererSessionId,r.answererSessionId=t.sessionId,r.seq=t.incomingMessage.seq),t.onsignalingmessage(JSON.stringify(r))},t._getSender=function(e){if(t.peerConnection&&t.peerConnection.getSenders){var n=t.peerConnection.getSenders().find((function(t){return t.track.kind==e}));if(n)return n}return null},t.hasSender=function(e){return!!t._getSender(e)},t.replaceTrack=function(e,n,r){var i=t._getSender(e.kind);if(!i)return r("NO_SENDER_FOUND");try{i.replaceTrack(e)}catch(e){return r&&r(e)}setTimeout((function(){return n&&n()}),50)},t.error=function(e){throw"Error in RoapOnJsep: "+e},t.sessionId=t.roapSessionId+=1,t.sequenceNumber=0,t.actionNeeded=!1,t.iceStarted=!1,t.moreIceComing=!0,t.iceCandidateCount=0,t.onsignalingmessage=e.callback,t.peerConnection.ontrack=function(e){t.onaddstream&&t.onaddstream(e,"ontrack")},t.peerConnection.onremovestream=function(e){t.onremovestream&&t.onremovestream(e)},t.peerConnection.oniceconnectionstatechange=function(e){"connected"===e.currentTarget.iceConnectionState&&(t.connectedTime=new Date,t._setRtpSenderParameters(t.degradation)),t.oniceconnectionstatechange&&t.oniceconnectionstatechange(e.currentTarget.iceConnectionState)},t.renegotiate=function(){t.isSubscriber||(d.default.debug("[".concat(t.uid,"]"),"renegotiating"),void 0!==t.prevOffer&&t.peerConnection.createOffer().then((function(e){return e.sdp=e.sdp.replace(/a=recvonly\r\n/g,"a=inactive\r\n"),e.sdp=r(e.sdp),e.sdp=i(e.sdp),t.peerConnection.setLocalDescription(e)})).then((function(){t.onnegotiationneeded&&t.onnegotiationneeded(t.peerConnection.localDescription.sdp)})).catch((function(e){d.default.error("createOffer error: ",e)})))},t.isSubscriber||(t.peerConnection.onnegotiationneeded=t.renegotiate),t.onaddstream=null,t.onremovestream=null,t.state="new",t.markActionNeeded(),t}(e)).browser="safari"):~window.navigator.userAgent.indexOf("Edge")?t=new y.a(e):(t=function(e){var t={},n=l.RTCPeerConnection;t.uid=e.uid,t.isVideoMute=e.isVideoMute,t.isAudioMute=e.isAudioMute,t.isSubscriber=e.isSubscriber,t.clientId=e.clientId,t.filterStatsCache=[],t.originStatsCache=[],t.lastTimeGetStats=null,t.pc_config={iceServers:[]};var i={id:"outbound_audio_ssrc_send",type:"ssrc",mediaType:"",googCodecName:"opus",aecDivergentFilterFraction:"0",audioInputLevel:"0",bytesSent:"0",packetsSent:"0",googEchoCancellationReturnLoss:"0",googEchoCancellationReturnLossEnhancement:"0"},a={id:"outbound_video_ssrc_send",type:"ssrc",mediaType:"",googCodecName:e.codec?e.codec.toUpperCase():"",bytesSent:"0",packetsLost:"0",packetsSent:"0",googAdaptationChanges:"0",googAvgEncodeMs:"0",googEncodeUsagePercent:"0",googFirsReceived:"0",googFrameHeightSent:"0",googFrameHeightInput:"0",googFrameRateInput:"0",googFrameRateSent:"0",googFrameWidthSent:"0",googFrameWidthInput:"0",googNacksReceived:"0",googPlisReceived:"0",googRtt:"0"},c={id:"inbound_audio_ssrc_recv",type:"ssrc",mediaType:"",googCodecName:"opus",audioOutputLevel:"0",bytesReceived:"0",packetsLost:"0",packetsReceived:"0",googAccelerateRate:"0",googCurrentDelayMs:"0",googDecodingCNG:"0",googDecodingCTN:"0",googDecodingCTSG:"0",googDecodingNormal:"0",googDecodingPLC:"0",googDecodingPLCCNG:"0",googExpandRate:"0",googJitterBufferMs:"0",googJitterReceived:"0",googPreemptiveExpandRate:"0",googPreferredJitterBufferMs:"0",googSecondaryDecodedRate:"0",googSpeechExpandRate:"0"},h={id:"inbound_video_ssrc_recv",type:"ssrc",mediaType:"",googTargetDelayMs:"0",packetsLost:"0",googDecodeMs:"0",googMaxDecodeMs:"0",googRenderDelayMs:"0",googFrameWidthReceived:"0",googFrameHeightReceived:"0",googFrameRateReceived:"0",googFrameRateDecoded:"0",googFrameRateOutput:"0",googJitterBufferMs:"0",googCurrentDelayMs:"0",googMinPlayoutDelayMs:"0",googNacksSent:"0",googPlisSent:"0",googFirsSent:"0",bytesReceived:"0",packetsReceived:"0",googFramesReceived:"0",googFramesDecoded:"0"},m={id:"bweforvideo",type:"VideoBwe",googAvailableSendBandwidth:"0",googAvailableReceiveBandwidth:"0",googActualEncBitrate:"0",googRetransmitBitrate:"0",googTargetEncBitrate:"0",googBucketDelay:"0",googTransmitBitrate:"0"};t.con={optional:[{DtlsSrtpKeyAgreement:!0}]},e.iceServers instanceof Array?t.pc_config.iceServers=e.iceServers:(e.stunServerUrl&&(e.stunServerUrl instanceof Array?e.stunServerUrl.map((function(e){"string"==typeof e&&""!==e&&t.pc_config.iceServers.push({url:e})})):"string"==typeof e.stunServerUrl&&""!==e.stunServerUrl&&t.pc_config.iceServers.push({url:e.stunServerUrl})),e.turnServers&&(e.turnServers instanceof Array?e.turnServers.map((function(e){e.udpport&&t.pc_config.iceServers.push({username:e.username,credential:e.credential,credentialType:"password",urls:(e.useTurns?"turns:":"turn:")+e.url+":"+e.udpport+"?transport=udp"}),"string"==typeof e.tcpport&&""!==e.tcpport&&t.pc_config.iceServers.push({username:e.username,credential:e.credential,credentialType:"password",urls:(e.useTurns?"turns:":"turn:")+e.url+":"+e.tcpport+"?transport=tcp"}),!0===e.forceturn&&(t.pc_config.iceTransportPolicy="relay")})):d.default.error("[".concat(t.clientId,"] turnServers is not a array")))),void 0===e.audio&&(e.audio=!0),void 0===e.video&&(e.video=!0),t.mediaConstraints=r.isChromeKernel()&&r.getChromeKernelVersion()<103?{mandatory:{OfferToReceiveVideo:e.video,OfferToReceiveAudio:e.audio}}:{offerToReceiveVideo:e.video,offerToReceiveAudio:e.audio},t.roapSessionId=103;try{t.pc_config.sdpSemantics=Object(f.getParameter)("PLAN"),t.peerConnection=new n(t.pc_config,t.con)}catch(e){delete t.pc_config.sdpSemantics,t.peerConnection=new n(t.pc_config,t.con);var g=t.peerConnection.getConfiguration();g.sdpSemantics&&Object(f.setParameter)("PLAN",g.sdpSemantics)}t.iceCandidateTimer=setTimeout((function(){t.iceCandidateTimer=null,d.default.debug("[".concat(t.clientId,"]Candidates collected: ").concat(t.iceCandidateCount)),t.moreIceComing&&(t.moreIceComing=!1,t.markActionNeeded())}),Object(f.getParameter)("CANDIDATE_TIMEOUT")),t.peerConnection.onicecandidate=function(e){var n,r,i,o;r=(n=t.peerConnection.localDescription.sdp).match(/a=candidate:.+typ\ssrflx.+\r\n/),i=n.match(/a=candidate:.+typ\shost.+\r\n/),o=n.match(/a=candidate:.+typ\srelay.+\r\n/),null===r&&null===i&&null===o||void 0!==t.ice||!t.iceCandidateTimer||(clearTimeout(t.iceCandidateTimer),t.iceCandidateTimer=null,t.ice=0,t.moreIceComing=!1,t.markActionNeeded()),t.iceCandidateCount=t.iceCandidateCount+1};var v=function(e){return e.replace("a=x-google-flag:conference\r\n","")},y=function(n){var r,i;if((r=n.match(/m=video.*\r\n/))&&e.minVideoBW&&e.maxVideoBW){i=r[0]+"b=AS:"+e.maxVideoBW+"\r\n";var o=0,a=0;"h264"===e.codec?(o=n.search(/a=rtpmap:(\d+) H264\/90000\r\n/),a=n.search(/H264\/90000\r\n/)):"vp8"===e.codec?(o=n.search(/a=rtpmap:(\d+) VP8\/90000\r\n/),a=n.search(/VP8\/90000\r\n/)):"vp9"===e.codec&&(o=n.search(/a=rtpmap:(\d+) VP9\/90000\r\n/),a=n.search(/VP9\/90000\r\n/)),-1!==o&&-1!==a&&a-o>10&&(i=i+"a=fmtp:"+n.slice(o+9,a-1)+" x-google-min-bitrate="+e.minVideoBW+"\r\n"),n=(n=(n=n.replace(r[0],i)).replace("a=fmtp:102 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42001f","a=fmtp:102 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42e01f")).replace("a=fmtp:125 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42e01f","a=fmtp:125 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42001f"),d.default.debug("["+t.clientId+"]Set Video Bitrate - min:"+e.minVideoBW+" max:"+e.maxVideoBW)}return(r=n.match(/m=audio.*\r\n/))&&e.maxAudioBW&&(i=r[0]+"b=AS:"+e.maxAudioBW+"\r\n",n=n.replace(r[0],i)),n};t.processSignalingMessage=function(n){var r,i=JSON.parse(n);t.incomingMessage=i,"new"===t.state?"OFFER"===i.messageType?(r={sdp:i.sdp,type:"offer"},t.peerConnection.setRemoteDescription(new RTCSessionDescription(r)).catch((function(e){})),t.state="offer-received",t.markActionNeeded()):t.error("Illegal message for this state: "+i.messageType+" in state "+t.state):"offer-sent"===t.state?"ANSWER"===i.messageType?((r={sdp:i.sdp,type:"answer"}).sdp=v(r.sdp),r.sdp=y(r.sdp),e.screen&&"detail"===e.optimizationMode&&(d.default.debug("[".concat(t.client,"] remove screen share abs ext")),r.sdp=r.sdp.replace(/a=.*abs-send-time\r\n/g,"").replace(/a=.*goog-remb\r\n/g,"")),e.isSubscriber&&(r.sdp=r.sdp.replace("minptime=10","minptime=10;stereo=1; sprop-stereo=1")),t.peerConnection.setRemoteDescription(new RTCSessionDescription(r)).catch((function(e){})),t.state="established"):"pr-answer"===i.messageType?(r={sdp:i.sdp,type:"pr-answer"},t.peerConnection.setRemoteDescription(new RTCSessionDescription(r)).catch((function(e){}))):"offer"===i.messageType?t.error("Not written yet"):t.error("Illegal message for this state: "+i.messageType+" in state "+t.state):"established"===t.state&&("OFFER"===i.messageType?(r={sdp:i.sdp,type:"offer"},t.peerConnection.setRemoteDescription(new RTCSessionDescription(r)).catch((function(e){})),t.state="offer-received",t.markActionNeeded()):"ANSWER"===i.messageType?((r={sdp:i.sdp,type:"answer"}).sdp=v(r.sdp),r.sdp=y(r.sdp),t.peerConnection.setRemoteDescription(new RTCSessionDescription(r)).catch((function(e){}))):t.error("Illegal message for this state: "+i.messageType+" in state "+t.state))},t.setRtpSenderParameters=function(){var e=u()(s.a.mark((function e(n){var r,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.peerConnection.getSenders(),i=r.find((function(e){return"video"===e.track.kind}))){e.next=4;break}return e.abrupt("return");case 4:return(o=i.getParameters()).degradationPreference=n,e.prev=6,d.default.debug("[".concat(t.clientId,"] setParameters"),o),e.next=10,i.setParameters(o);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(6),d.default.debug("[".concat(t.clientId,"] setParameters failed, ignore"));case 15:case"end":return e.stop()}}),e,null,[[6,12]])})));return function(t){return e.apply(this,arguments)}}();var b=0,S=0;return t.getVideoRelatedStats=function(e){t.getStats((function(n){n.forEach((function(n){if(t.isSubscriber){if("video"===n.mediaType&&n.id&&~n.id.indexOf("recv")){if(r.isChromeKernel()&&+r.getBrowserVersion()>=76){var i=+n.googFramesReceived-b,o=+n.googFramesDecoded-S;t._setStat(h,"googFrameRateReceived",i),t._setStat(h,"googFrameRateDecoded",o),t._setStat(h,"googFrameRateOutput",o),b=+n.googFramesReceived,S=+n.googFramesDecoded}e&&e({mediaType:"video",peerId:t.uid,isVideoMute:t.isVideoMute,frameRateReceived:n.googFrameRateReceived,frameRateDecoded:n.googFrameRateDecoded,bytesReceived:n.bytesReceived,packetsReceived:n.packetsReceived,packetsLost:n.packetsLost})}}else"video"===n.mediaType&&n.id&&~n.id.indexOf("send")&&e&&e({mediaType:"video",isVideoMute:t.isVideoMute,frameRateInput:n.googFrameRateInput,frameRateSent:n.googFrameRateSent,googRtt:n.googRtt})}))}))},t.getAudioRelatedStats=function(e){t.getStats((function(n){n.forEach((function(n){t.isSubscriber&&"audio"===n.mediaType&&n.id&&~n.id.indexOf("recv")&&e&&e({mediaType:"audio",peerId:t.uid,isAudioMute:t.isAudioMute,frameDropped:parseInt(n.googDecodingPLC)+parseInt(n.googDecodingPLCCNG)+"",frameReceived:n.googDecodingCTN,googJitterReceived:n.googJitterReceived,bytesReceived:n.bytesReceived,packetsReceived:n.packetsReceived,packetsLost:n.packetsLost})}))}))},t.getStatsRate=function(e){t.getStats((function(t){e(t)}))},t.getStats=function(e,n){n=(n=n||500)>500?500:n,t.lastTimeGetStats&&Date.now()-t.lastTimeGetStats<n?e&&e(t.filterStatsCache,t.originStatsCache):(t.lastTimeGetStats=Date.now(),this._getStats((function(n,r){t.filterStatsCache=n,t.originStatsCache=r,e&&e(n,r)})))},t._setStat=function(e,t,n){e.hasOwnProperty(t)&&(null!=n&&n!==1/0&&n==n||(n=0),e[t]=n+"")},t._processGetStatsAfterChrome76=function(e){var n=this;t.lastStats||(t.lastStats=new Map),t.peerConnection.getStats().then((function(r){var s,u=[],d=[],l=new Map,f=new Date,g=p(r.values());try{for(g.s();!(s=g.n()).done;){var v=s.value;"codec"!=v.type?"candidate-pair"!=v.type?("inbound-rtp"===v.type&&"video"===v.mediaType&&l.set("inbound-video",v),"inbound-rtp"===v.type&&"audio"===v.mediaType&&l.set("inbound-audio",v),"outbound-rtp"===v.type&&"audio"===v.mediaType&&l.set("outbound-audio",v),"outbound-rtp"===v.type&&"video"===v.mediaType&&l.set("outbound-video",v),"track"===v.type&&"video"===v.kind&&v.remoteSource&&l.set("remote-video-track",v),"track"===v.type&&"audio"===v.kind&&v.remoteSource&&l.set("remote-audio-track",v),"remote-inbound-rtp"===v.type&&"video"===v.mediaType&&l.set("remote-inbound-video",v),"remote-inbound-rtp"===v.type&&"audio"===v.mediaType&&l.set("remote-inbound-audio",v),"track"!==v.type||"video"!==v.kind||v.remoteSource||l.set("local-video-track",v),"track"!==v.type||"audio"!==v.kind||v.remoteSource||l.set("local-audio-track",v),"media-source"===v.type&&"video"===v.kind&&l.set("media-source-video",v),"media-source"===v.type&&"audio"===v.kind&&l.set("media-source-audio",v)):d.push(v):u.push(v)}}catch(e){g.e(e)}finally{g.f()}l.set("codec",u),l.set("candidatePairs",d),l.set("timestamp",+f);var y=null,b=null;if(h.timestamp=f,c.timestamp=f,i.timestamp=f,i.timestamp=f,m.timestamp=f,n.isSubscriber)(y=l.get("inbound-video"))&&(t._setStat(h,"id","inbound_video_ssrc_recv"),t._setStat(h,"mediaType",y.mediaType),t._setStat(h,"packetsLost",y.packetsLost),t._setStat(h,"googDecodeMs",null),t._setStat(h,"googMaxDecodeMs",null),t._setStat(h,"googRenderDelayMs",null),t._setStat(h,"googMinPlayoutDelayMs",null),t._setStat(h,"googNacksSent",y.nackCount),t._setStat(h,"googPlisSent",y.pliCount),t._setStat(h,"googFirsSent",y.firCount),t._setStat(h,"bytesReceived",y.bytesReceived),t._setStat(h,"packetsReceived",y.packetsReceived)),(y=l.get("inbound-audio"))&&(t._setStat(c,"id","inbound_audio_ssrc_recv"),t._setStat(c,"mediaType",y.mediaType),t._setStat(c,"bytesReceived",y.bytesReceived),t._setStat(c,"packetsLost",y.packetsLost),t._setStat(c,"packetsReceived",y.packetsReceived),t._setStat(c,"googAccelerateRate",y.removedSamplesForAcceleration),t._setStat(c,"googCurrentDelayMs",y.jitterBufferDelay),t._setStat(c,"googDecodingCNG",null),t._setStat(c,"googDecodingCTN",null),t._setStat(c,"googDecodingCTSG",null),t._setStat(c,"googDecodingNormal",null),t._setStat(c,"googDecodingPLC",null),t._setStat(c,"googDecodingPLCCNG",null),t._setStat(c,"googJitterReceived",y.jitter),t._setStat(c,"googPreferredJitterBufferMs",null),t._setStat(c,"googSecondaryDecodedRate",null)),(y=l.get("remote-video-track"))&&(t._setStat(h,"googTargetDelayMs",y.jitterBufferDelay),t._setStat(h,"googFrameWidthReceived",y.frameWidth),t._setStat(h,"googFrameHeightReceived",y.frameHeight),t._setStat(h,"googJitterBufferMs",y.jitterBufferDelay/y.jitterBufferEmittedCount*1e3),t._setStat(h,"googCurrentDelayMs",y.jitterBufferDelay),t._setStat(h,"googFramesDecoded",y.framesDecoded),t._setStat(h,"googFramesReceived",y.framesReceived)),(y=l.get("remote-audio-track"))&&(t._setStat(c,"audioOutputLevel",32767*y.audioLevel),t._setStat(c,"googJitterBufferMs",y.jitterBufferDelay/y.jitterBufferEmittedCount*1e3),t._setStat(c,"googExpandRate",y.concealedSamples),t._setStat(c,"googPreemptiveExpandRate",y.insertedSamplesForDeceleration),t._setStat(c,"googSpeechExpandRate",y.silentConcealedSamples));else{var S=t.lastStats.get("timestamp"),E=t.lastStats.get("outbound-video");if((y=l.get("outbound-audio"))&&(t._setStat(i,"id","outbound_audio_ssrc_send"),t._setStat(i,"mediaType",y.mediaType),t._setStat(i,"aecDivergentFilterFraction",null),t._setStat(i,"bytesSent",y.bytesSent),t._setStat(i,"packetsSent",y.packetsSent),b=y.transportId),y=l.get("outbound-video")){if(t._setStat(a,"id","outbound_video_ssrc_send"),t._setStat(a,"mediaType",y.mediaType),t._setStat(a,"bytesSent",y.bytesSent),t._setStat(a,"packetsSent",y.packetsSent),t._setStat(a,"googAdaptationChanges",y.qualityLimitationDurations),t._setStat(a,"googAvgEncodeMs",null),t._setStat(a,"googEncodeUsagePercent",null),b=y.transportId,y.totalEncodedBytesTarget&&E&&E.totalEncodedBytesTarget){var _=(y.totalEncodedBytesTarget-E.totalEncodedBytesTarget)/(+new Date-S);t._setStat(m,"googTargetEncBitrate",Math.floor(8*_*1e3))}if(y.retransmittedBytesSent&&E&&E.retransmittedBytesSent){var T=(y.retransmittedBytesSent-E.retransmittedBytesSent)/(+new Date-S);t._setStat(m,"googRetransmitBitrate",Math.floor(8*T*1e3))}if(y.bytesSent&&E&&E.bytesSent){var R=(y.bytesSent-E.bytesSent)/(+new Date-S);t._setStat(m,"googTransmitBitrate",Math.floor(8*R*1e3)),t._setStat(m,"googActualEncBitrate",Math.floor(8*R*1e3))}if(y.totalPacketSendDelay&&E&&E.totalPacketSendDelay){var I=(y.totalPacketSendDelay-E.totalPacketSendDelay)/(+new Date-S);t._setStat(m,"googBucketDelay",Math.floor(1e3*I))}}if((y=l.get("remote-inbound-video"))&&(t._setStat(a,"packetsLost",y.packetsLost),t._setStat(a,"googRtt",y.roundTripTime)),(y=l.get("local-video-track"))&&(t._setStat(a,"googFrameHeightSent",y.frameHeight),t._setStat(a,"googFrameWidthSent",y.frameWidth),void 0!==y.framesPerSecond&&t._setStat(a,"googFrameRateSent",y.framesPerSecond)),(y=l.get("local-audio-track"))&&(t._setStat(i,"googEchoCancellationReturnLoss",y.echoReturnLoss),t._setStat(i,"googEchoCancellationReturnLossEnhancement",y.echoReturnLossEnhancement)),(y=l.get("media-source-video"))&&(t._setStat(a,"googFrameHeightInput",y.height),t._setStat(a,"googFrameWidthInput",y.width),t._setStat(a,"googFrameRateInput",y.framesPerSecond)),(y=l.get("media-source-audio"))&&t._setStat(i,"audioInputLevel",32767*y.totalAudioEnergy),(y=l.get("inbound-video"))&&(t._setStat(a,"googFirsReceived",y.firCount),t._setStat(a,"googNacksReceived",y.nackCount),t._setStat(a,"googPlisReceived",y.pliCount)),b)l.get("candidatePairs").map((function(e){b==e.transportId&&t._setStat(m,"googAvailableSendBandwidth",e.availableOutgoingBitrate)}));else{var w=l.get("candidatePairs")[0];w&&t._setStat(m,"googAvailableSendBandwidth",w.availableOutgoingBitrate)}}t.lastStats=l;var C=[o()({},a),o()({},i),o()({},h),o()({},c),o()({},m)];C.push({id:"time",startTime:t.connectedTime,timestamp:new Date}),e(C)}))},t._processGetStatsBeforeChrome76=function(e){t.peerConnection.getStats((function(n){var r=[],s=[],u=null;Object.keys(n).forEach((function(e){var t=n[e];t&&(s.push(t),u=t.timestamp,"VideoBwe"===t.type?m=t:t.id.indexOf("_send")>-1&&"video"===t.mediaType?a=t:t.id.indexOf("_send")>-1&&"audio"===t.mediaType?i=t:t.id.indexOf("_recv")>-1&&"video"===t.mediaType?h=t:t.id.indexOf("_recv")>-1&&"audio"===t.mediaType&&(c=t))})),(r=[o()({},a),o()({},i),o()({},h),o()({},c),o()({},m)]).push({id:"time",startTime:t.connectedTime,timestamp:u||new Date}),e(r,s)}))},t._getStats=function(e){Object(f.getParameter)("CHROME_NEW_STATS")&&r.isChromeKernel()&&+r.getBrowserVersion()>=76?t._processGetStatsAfterChrome76(e):t._processGetStatsBeforeChrome76(e)},t.addTrack=function(e,n){if("unified-plan"===Object(f.getParameter)("PLAN")){var r="audio"===e.kind?t._audioSender:t._videoSender;if(r){var i=t.peerConnection.getTransceivers().find((function(e){return e.sender===r}));r.replaceTrack(e).then((function(){i.direction="sendrecv",t.renegotiate()}))}else r=t.peerConnection.addTrack(e,n),"audio"===e.kind?t._audioSender=r:t._videoSender=r}else t.peerConnection.addTrack(e,n)},t.removeTrack=function(e,n){if("unified-plan"===Object(f.getParameter)("PLAN")){var r=t.peerConnection.getTransceivers().find((function(t){return t.sender.track===e}));r&&(r.direction="inactive",t.peerConnection.removeTrack(r.sender))}else t.peerConnection.removeTrack(t.peerConnection.getSenders().find((function(t){return t.track==e})))},t.addStream=function(e){"unified-plan"===Object(f.getParameter)("PLAN")?e.getTracks().forEach((function(n){var r=t.peerConnection.addTrack(n,e);"audio"===n.kind?t._audioSender=r:t._videoSender=r})):(t.peerConnection.addStream(e),t.markActionNeeded())},t.removeStream=function(){t.markActionNeeded()},t.close=function(){t.state="closed",t.peerConnection.close()},t.markActionNeeded=function(){t.actionNeeded=!0,t.doLater((function(){t.onstablestate()}))},t.doLater=function(e){window.setTimeout(e,1)},t.onstablestate=function(){var n;if(t.actionNeeded){if("new"===t.state||"established"===t.state)t.peerConnection.createOffer(t.mediaConstraints).then((function(n){return n?n.sdp!==t.prevOffer?(e.isSubscriber&&(n.sdp=n.sdp.replace("minptime=10","minptime=10;stereo=1; sprop-stereo=1")),t.peerConnection.setLocalDescription(n),t.state="preparing-offer",void t.markActionNeeded()):void d.default.debug("["+t.clientId+"]Not sending a new offer"):(d.default.debug("["+t.clientId+"]sessionDescription is null"),void t.onsignalingmessage(null))})).catch((function(e){d.default.debug("["+t.clientId+"]peer connection create offer failed ",e)}));else if("preparing-offer"===t.state){if(t.moreIceComing)return;t.prevOffer=t.peerConnection.localDescription.sdp,t.offerCandidates=t.prevOffer.match(/a=candidate.+\r\n/g)||[],t.offerCandidates.length||(e.isCloudProxy3&&e.onNoIceCandidate&&e.onNoIceCandidate(),d.default.warning("[".concat(t.clientId,"]No Ice Candidate generated")),Object(f.getParameter)("SHIM_CANDIDATE")?(d.default.debug("Shimming fake candidate"),t.prevOffer+="a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"):d.default.error("[".concat(t.clientId,"]None Ice Candidate not allowed"))),t.prevOffer=t.prevOffer.replace(/a=candidate:.+typ\shost.+\r\n/g,"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"),t.sendMessage("OFFER",t.prevOffer),t.state="offer-sent"}else if("offer-received"===t.state)t.peerConnection.createAnswer((function(e){if(t.peerConnection.setLocalDescription(e),t.state="offer-received-preparing-answer",t.iceStarted)t.markActionNeeded();else{var n=new Date;d.default.debug("["+t.clientId+"]"+n.getTime()+": Starting ICE in responder"),t.iceStarted=!0}}),(function(e){d.default.debug("["+t.clientId+"]peer connection create answer failed ",e)}),t.mediaConstraints);else if("offer-received-preparing-answer"===t.state){if(t.moreIceComing)return;n=t.peerConnection.localDescription.sdp,t.sendMessage("ANSWER",n),t.state="established"}else d.default.debug("[".concat(t.clientId,"] Dazed and confused in state ").concat(t.state,", stopping here'"));t.actionNeeded=!1}},t.sendMessage=function(e,n){var r={};r.messageType=e,r.sdp=n,"OFFER"===e?(r.offererSessionId=t.sessionId,r.answererSessionId=t.otherSessionId,r.seq=t.sequenceNumber+=1,r.tiebreaker=Math.floor(429496723*Math.random()+1)):(r.offererSessionId=t.incomingMessage.offererSessionId,r.answererSessionId=t.sessionId,r.seq=t.incomingMessage.seq),t.onsignalingmessage(JSON.stringify(r))},t._getSender=function(e){if(t.peerConnection&&t.peerConnection.getSenders){var n=t.peerConnection.getSenders().find((function(t){return t.track.kind==e}));if(n)return n}return null},t.hasSender=function(e){return!!t._getSender(e)},t.replaceTrack=function(e,n,r){var i=t._getSender(e.kind);if(!i)return r("NO_SENDER_FOUND");try{i.replaceTrack(e)}catch(e){return r&&r(e)}setTimeout((function(){return n&&n()}),50)},t.error=function(e){throw"Error in RoapOnJsep: "+e},t.sessionId=t.roapSessionId+=1,t.sequenceNumber=0,t.actionNeeded=!1,t.iceStarted=!1,t.moreIceComing=!0,t.iceCandidateCount=0,t.onsignalingmessage=e.callback,t.peerConnection.ontrack=function(e){t.onaddstream&&(t.onaddstream(e,"ontrack"),t.peerConnection.onaddstream=null)},t.peerConnection.onaddstream=function(e){t.onaddstream&&(t.onaddstream(e,"onaddstream"),t.peerConnection.ontrack=null)},t.peerConnection.onremovestream=function(e){t.onremovestream&&t.onremovestream(e)},t.peerConnection.oniceconnectionstatechange=function(e){d.default.debug(t.peerConnection.iceConnectionState),"connected"===e.currentTarget.iceConnectionState&&(t.connectedTime=new Date),t.oniceconnectionstatechange&&t.oniceconnectionstatechange(e.currentTarget.iceConnectionState)},t.renegotiate=function(){void 0!==t.prevOffer&&t.peerConnection.createOffer().then((function(e){return"unified-plan"!==Object(f.getParameter)("PLAN")&&(e.sdp=e.sdp.replace(/a=recvonly\r\n/g,"a=inactive\r\n")),e.sdp=v(e.sdp),e.sdp=y(e.sdp),t.peerConnection.setLocalDescription(e)})).then((function(){t.onnegotiationneeded&&t.onnegotiationneeded(t.peerConnection.localDescription.sdp)})).catch((function(e){d.default.error("createOffer error: ",e.message||e)}))},t.peerConnection.onnegotiationneeded=t.renegotiate,t.onaddstream=null,t.onremovestream=null,t.onnegotiationneeded=null,t.state="new",t.markActionNeeded(),t}(e)).browser="chrome-stable",t},_=function(e,t,n){var i={};i.config=e,i.streamId=e.streamId,delete e.streamId,navigator.getMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var o=0,a=1,s=!1,c=null,u=function(e){if(o++,c)if(c===e)d.default.debug("Using Video Source/ Audio Source");else{var n=c.getVideoTracks()[0],r=c.getAudioTracks()[0],i=e.getVideoTracks()[0],u=e.getAudioTracks()[0];i&&(n&&c.removeTrack(n),c.addTrack(i)),u&&(r&&c.removeTrack(r),c.addTrack(u))}else c=e;o!==a||s||(s=!0,setTimeout((function(){t(c)}),0))},l=function(e){d.default.error("Failed to GetUserMedia",e.name,e.code,e.message,e),o++,s||(s=!0,setTimeout((function(){n&&n(e)}),0))},f=function(){var t={video:e.video,audio:e.audio};if(d.default.debug("GetUserMedia",JSON.stringify(t)),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)navigator.mediaDevices.getUserMedia(t).then(u).catch(l);else if("undefined"!=typeof navigator&&navigator.getMedia)navigator.getMedia(e,u,l);else{var r={name:"MEDIA_NOT_SUPPORT",message:"Video/audio streams not supported yet"};d.default.error("["+i.streamId+"]"+r.message),n&&n(r)}};if((e.videoSource||e.audioSource)&&(c=new MediaStream,e.videoSource&&c.addTrack(e.videoSource),e.audioSource&&c.addTrack(e.audioSource)),e.video||e.audio||e.screen||e.screenAudio){if(!e.screen&&e.screenAudio)return n&&n({code:"Set screen to true before sharing the audio"});if(e.screen){if(b.a.isElectron())return e.screen.sourceId?b.a.getScreenStream(e.screen.sourceId,e.screen,(function(t,n){t?l(t):(e.audio&&(a++,f()),u(n))})):b.a.shareScreen(e.screen,(function(t,n){t?l(t):(e.audio&&(a++,f()),u(n))}));if(r.isFireFox()){if(d.default.debug("["+i.streamId+"]Screen access requested"),!~["screen","window","application"].indexOf(e.screen.mediaSource))return n&&n({code:"Invalid mediaSource, mediaSource should be one of [screen, window, application]"});navigator.getMedia({video:e.screen},(function(t){e.audio&&(a++,f()),u(t)}),l)}else if(r.isChromeKernel()&&e.screen.extensionId){if(window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<34)return void n({code:"This browser does not support screen sharing"});d.default.debug("["+i.streamId+"]Screen access on chrome stable, looking for extension");try{chrome.runtime.sendMessage(e.screen.extensionId,{getStream:!0},(function(t){void 0===t?(d.default.error("["+i.streamId+"]No response from Chrome Plugin. Plugin not installed properly"),l({name:"PluginNotInstalledProperly",message:"No response from Chrome Plugin. Plugin not installed properly."})):(e.screen.mandatory.chromeMediaSourceId=t.streamId,navigator.getMedia({video:e.screen},(function(t){e.audio&&(a++,f()),u(t)}),l))}))}catch(e){return d.default.debug("["+i.streamId+"]AgoraRTC screensharing plugin is not accessible"),void n({code:"no_plugin_present"})}}else{if(window.navigator.mediaDevices.getDisplayMedia){var p={};return"number"==typeof e.screen.width&&"number"==typeof e.screen.height?p.video={width:{ideal:e.screen.width},height:{ideal:e.screen.height}}:p.video={width:e.screen.width,height:e.screen.height},e.screen.frameRate&&e.screen.frameRate.min?p.video.frameRate={ideal:e.screen.frameRate.max,max:e.screen.frameRate.max}:p.video.frameRate=e.screen.frameRate,e.screenAudio&&(p.audio=e.screenAudio),d.default.debug("use getDisplayMedia, constraints:",p),window.navigator.mediaDevices.getDisplayMedia(p).then((function(t){!e.screenAudio&&e.audio&&(a++,f()),u(t)})).catch(l)}d.default.error("["+i.streamId+"]This browser does not support screenSharing"),n({code:"This browser does not support screen sharing"})}}else f()}else u(c)}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(0)),o=function(){function e(e,t,n){void 0===t&&(t=""),this.name="AgoraRTCException",this.code=e,this.message="AgoraRTCError "+this.code+": "+t,this.data=n}return e.prototype.toString=function(){return this.data?this.message+" data: "+JSON.stringify(this.data):this.message},e.prototype.throw=function(){throw i.default.error(this.toString()),this},e}();t.AgoraRTCError=o,function(e){e.UNEXPECTED_ERROR="UNEXPECTED_ERROR",e.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",e.TIMEOUT="TIMEOUT",e.INVALID_PARAMS="INVALID_PARAMS",e.NOT_SUPPORT="NOT_SUPPORT",e.INVALID_OPERATION="INVALID_OPERATION",e.OPERATION_ABORT="OPERATION_ABORT",e.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",e.NETWORK_ERROR="NETWORK_ERROR",e.NETWORK_TIMEOUT="NETWORK_TIMEOUT",e.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",e.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",e.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",e.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",e.ELECTRON_IS_NULL="ELECTRON_IS_NULL",e.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",e.STREAM_ALREADY_INITIALIZED="STREAM_ALREADY_INITIALIZED",e.STREAM_IS_CLOSED="STREAM_IS_CLOSED",e.ABORT_OTHER_INIT="ABORT_OTHER_INIT",e.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",e.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",e.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",e.PERMISSION_DENIED="PERMISSION_DENIED",e.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",e.CAN_NOT_AUTOPLAY="CAN_NOT_AUTOPLAY",e.HIGH_STREAM_NO_VIDEO_TRACK="HIGH_STREAM_NO_VIDEO_TRACK",e.SCREEN_SHARE_CAN_NOT_CREATE_LOW_STREAM="SCREEN_SHARE_CAN_NOT_CREATE_LOW_STREAM",e.TRACK_IS_DISABLED="TRACK_IS_DISABLED",e.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",e.TOKEN_GENERATOR_FUNCTION_ERROR="TOKEN_GENERATOR_FUNCTION_ERROR",e.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",e.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",e.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",e.UID_CONFLICT="UID_CONFLICT",e.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",e.INVALID_TRACK="INVALID_TRACK",e.SENDER_NOT_FOUND="SENDER_NOT_FOUND",e.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",e.SET_ANSWER_FAILED="SET_ANSWER_FAILED",e.ICE_FAILED="ICE_FAILED",e.PC_CLOSED="PC_CLOSED",e.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",e.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",e.INVALID_REMOTE_USER="INVALID_REMOTE_USER",e.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",e.SUBSCRIPTION_IS_IN_PROGRESS="SUBSCRIPTION_IS_IN_PROGRESS",e.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",e.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",e.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",e.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",e.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",e.EFFECT_ID_CONFLICTED="EFFECT_ID_CONFLICTED",e.EFFECT_SOUND_ID_NOT_FOUND="EFFECT_SOUND_ID_NOT_FOUND",e.WS_ABORT="WS_ABORT",e.WS_DISCONNECT="WS_DISCONNECT",e.WS_ERR="WS_ERR",e.CAN_NOT_CONNECT_TO_LIVE_STREAMING_WORKER="CAN_NOT_CONNECT_TO_LIVE_STREAMING_WORKER",e.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",e.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",e.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",e.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",e.LIVE_STREAMING_TRANSCODING_NOT_SUPPORT="LIVE_STREAMING_TRANSCODING_NOT_SUPPORT",e.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",e.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",e.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",e.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",e.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",e.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",e.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",e.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",e.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",e.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",e.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",e.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",e.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE"}(t.AgoraRTCErrorCode||(t.AgoraRTCErrorCode={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=window.AudioContext||window.webkitAudioContext,o=n(2),a=o.getParameter,s=o.setParameter,c=function(){return a("AUDIO_CONTEXT")||s("AUDIO_CONTEXT",function(){if(i){var e=new i;return window.ctx=e,new Promise((function(e){document.body?e():window.addEventListener("load",e)})).then((function(){var t=function t(){"suspended"==e.state?(r.default.debug("AudioContext is suspended, auto resume"),e.resume().then((function(){r.default.debug("AudioContext resume success"),document.body.removeEventListener("touchend",t,!0),document.body.removeEventListener("mousedown",t,!0)}))):(r.default.debug("AudioContext is running"),document.body.removeEventListener("touchend",t,!0),document.body.removeEventListener("mousedown",t,!0))};document.body.addEventListener("touchend",t,!0),document.body.addEventListener("mousedown",t,!0)})),e}throw new Error("AUDIO_CONTEXT_NOT_SUPPORTED")}()),a("AUDIO_CONTEXT")};c()},function(e,t,n){"use strict";var r=n(1),i=null,o=function(){try{i=window.require("electron")}catch(e){}return i},a=function(e){var t=r.report.reportApiInvoke(null,{callback:e,name:"getScreenSources",options:arguments,tag:"tracer"}),n=o();if(!n)return t&&t("electron is null");try{var i=n.desktopCapturer.getSources({types:["window","screen"]})}catch(e){console.log(e)}i instanceof Promise?i.then((function(e){return t&&t(null,e)})).catch((function(e){return t&&t(e)})):i=n.desktopCapturer.getSources({types:["window","screen"]},(function(e,n){t&&t(null,n)}))},s=function(e,t,n){var r=t.width;t={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxHeight:t.height,maxWidth:r,maxFrameRate:t.frameRate&&t.frameRate.max,minFrameRate:t.frameRate&&t.frameRate.min}}},navigator.webkitGetUserMedia(t,(function(e){n&&n(null,e)}),(function(e){n&&n(e)}))};t.a={isElectron:function(){return!!o()},getElectronInstance:o,getScreenSources:a,getScreenStream:s,shareScreen:function(e,t){a((function(n,r){if(n)return t&&t(n);!function(e,t){var n=document.createElement("div");n.innerText="share screen",n.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");var r=document.createElement("div");r.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");var i=document.createElement("div");i.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",i.setAttribute("style","height: 12%;");var o=document.createElement("div");o.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");var a=document.createElement("div");a.setAttribute("style","text-align: right; padding: 16px 0;");var s=document.createElement("button");s.innerHTML="cancel",s.setAttribute("style","width: 85px;"),s.onclick=function(){document.body.removeChild(c),t&&t("NotAllowedError")},a.appendChild(s),r.appendChild(i),r.appendChild(o),r.appendChild(a);var c=document.createElement("div");c.setAttribute("style","position: absolute; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),c.appendChild(n),c.appendChild(r),document.body.appendChild(c),e.map((function(e){if(e.id){var n=document.createElement("div");n.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");var r=e.thumbnail;r.getSize().width>1920&&(r=r.resize({width:1920})),n.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+r.toDataURL()+' /></div><span style="\theight: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+e.name.replace(/[\u00A0-\u9999<>\&]/g,(function(e){return"&#"+e.charCodeAt(0)+";"}))+"</span>",n.onclick=function(){document.body.removeChild(c),t&&t(null,e.id)},o.appendChild(n)}}))}(r,(function(n,r){if(n)return t&&t(n);s(r,e,t)}))}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);!function(e){e.TRANSCODE="mix_streaming",e.RAW="raw_streaming",e.INJECT="inject_streaming"}(t.LiveStreamingServiceMode||(t.LiveStreamingServiceMode={})),t.DEFAULT_LIVE_STREAMING_TRANSCODING_USER={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},t.DEFAULT_LIVE_STREAMING_TRANSCODING_WATERMARK={x:0,y:0,width:160,height:160,zOrder:255,alpha:1},t.isLiveStreamingTranscodingConfig=function(e){return r.isEmpty(e.width)||r.checkValidNumber(e.width,"config.width",0),r.isEmpty(e.height)||r.checkValidNumber(e.height,"config.height",0),r.isEmpty(e.videoBitrate)||r.checkValidNumber(e.videoBitrate,"config.videoBitrate",1,1e6),r.isEmpty(e.videoFramerate)||r.checkValidNumber(e.videoFramerate,"config.videoFramerate"),r.isEmpty(e.lowLatency)||r.checkValidBoolean(e.lowLatency,"config.lowLatency"),r.isEmpty(e.audioSampleRate)||r.checkValidEnum(e.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),r.isEmpty(e.audioBitrate)||r.checkValidNumber(e.audioBitrate,"config.audioBitrate",1,128),r.isEmpty(e.audioChannels)||r.checkValidEnum(e.audioChannels,"config.audioChannels",[1,2,3,4,5]),r.isEmpty(e.videoGop)||r.checkValidNumber(e.videoGop,"config.videoGop"),r.isEmpty(e.videoCodecProfile)||r.checkValidEnum(e.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),r.isEmpty(e.userCount)||r.checkValidNumber(e.userCount,"config.userCount",0,17),r.isEmpty(e.backgroundColor)||r.checkValidNumber(e.backgroundColor,"config.backgroundColor",0,16777215),e.transcodingUsers&&!r.isEmpty(e.transcodingUsers)&&(r.checkValidArray(e.transcodingUsers,"config.transcodingUsers"),e.transcodingUsers.forEach((function(e,t){r.checkValidUID(e.uid),r.isEmpty(e.x)||r.checkValidNumber(e.x,"transcodingUser["+t+"].x",0,1e4),r.isEmpty(e.y)||r.checkValidNumber(e.y,"transcodingUser["+t+"].y",0,1e4),r.isEmpty(e.width)||r.checkValidNumber(e.width,"transcodingUser["+t+"].width",0,1e4),r.isEmpty(e.height)||r.checkValidNumber(e.height,"transcodingUser["+t+"].height",0,1e4),r.isEmpty(e.zOrder)||r.checkValidNumber(e.zOrder-1,"transcodingUser["+t+"].zOrder",0,100),r.isEmpty(e.alpha)||r.checkValidFloatNumber(e.alpha,"transcodingUser["+t+"].alpha",0,1)}))),e.images&&!r.isEmpty(e.images)&&(r.checkValidArray(e.images,"config.images"),e.images.forEach((function(e,t){r.checkValidString(e.url,"images["+t+"].url",1,1e3,!1),r.isEmpty(e.x)||r.checkValidNumber(e.x,"images["+t+"].x",0,1e4),r.isEmpty(e.y)||r.checkValidNumber(e.y,"images["+t+"].y",0,1e4),r.isEmpty(e.width)||r.checkValidNumber(e.width,"images["+t+"].width",0,1e4),r.isEmpty(e.height)||r.checkValidNumber(e.height,"images["+t+"].height",0,1e4),r.isEmpty(e.zOrder)||r.checkValidNumber(e.zOrder,"images["+t+"].zOrder",0,255),r.isEmpty(e.alpha)||r.checkValidFloatNumber(e.alpha,"images["+t+"].alpha",0,1)}))),!0},t.DEFAULT_TRANSCODING_CONFIG={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFramerate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""},t.isInjectStreamConfig=function(e){return r.isEmpty(e.audioVolume)||r.checkValidNumber(e.audioVolume,"config.audioVolume",0,1e3),r.isEmpty(e.audioBitrate)||r.checkValidNumber(e.audioBitrate,"config.audioBitrate",1,1e4),r.isEmpty(e.audioChannels)||r.checkValidEnum(e.audioChannels,"config.audioChannels",[1,2]),r.isEmpty(e.audioSampleRate)||r.checkValidEnum(e.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),r.isEmpty(e.width)||r.checkValidNumber(e.width,"config.width",0,1e4),r.isEmpty(e.height)||r.checkValidNumber(e.height,"config.height",0,1e4),r.isEmpty(e.videoBitrate)||r.checkValidNumber(e.videoBitrate,"config.videoBitrate",1,1e4),r.isEmpty(e.videoFramerate)||r.checkValidNumber(e.videoFramerate,"config.videoFramerate",1,1e4),r.isEmpty(e.videoGop)||r.checkValidNumber(e.videoGop,"config.videoGop",1,1e4),!0},t.DEFAULT_INJECT_CONFIG={audioBitrate:48,audioChannels:2,audioVolume:100,audioSampleRate:48e3,height:0,width:0,videoBitrate:400,videoFramerate:15,videoGop:30},function(e){e.WARNING="@live_uap-warning",e.ERROR="@line_uap-error",e.PUBLISH_STREAM_STATUS="@live_uap-publish-status",e.INJECT_STREAM_STATUS="@live_uap-inject-status",e.WORKER_STATUS="@live_uap-worker-status",e.REQUEST_NEW_ADDRESS="@live_uap-request-address"}(t.LiveStreamingUapSignalEvents||(t.LiveStreamingUapSignalEvents={})),function(e){e.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager"}(t.LiveStreamingInternalEvents||(t.LiveStreamingInternalEvents={})),function(e){e[e.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",e[e.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",e[e.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",e[e.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",e[e.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",e[e.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",e[e.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",e[e.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",e[e.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",e[e.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",e[e.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",e[e.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",e[e.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",e[e.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",e[e.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",e[e.LIVE_STREAM_RESPONSE_INGNORE_MESSAGE=505]="LIVE_STREAM_RESPONSE_INGNORE_MESSAGE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",e[e.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN"}(t.LIVE_STREAM_ERROR_CODE||(t.LIVE_STREAM_ERROR_CODE={})),function(e){e.CONNECTED="websocket:connected",e.RECONNECTING="websocket:reconnecting",e.WILL_RECONNECT="websocket:will_reconnect",e.CLOSED="websocket:closed",e.FAILED="websocket:failed",e.ON_MESSAGE="websocket:on_message",e.REQUEST_NEW_URLS="websocket:request_new_urls"}(t.WebSocketManagerEvents||(t.WebSocketManagerEvents={}))},function(e,t,n){var r=n(57),i=n(58);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[o+s]=a[s];return t||i(a)}},function(e,t,n){var r;e.exports=(r=n(73),function(e){var t=r,n=t.lib,i=n.WordArray,o=n.Hasher,a=t.algo,s=[],c=[];!function(){function t(t){for(var n=e.sqrt(t),r=2;r<=n;r++)if(!(t%r))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var r=2,i=0;i<64;)t(r)&&(i<8&&(s[i]=n(e.pow(r,.5))),c[i]=n(e.pow(r,1/3)),i++),r++}();var u=[],d=a.SHA256=o.extend({_doReset:function(){this._hash=new i.init(s.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],d=n[5],l=n[6],f=n[7],p=0;p<64;p++){if(p<16)u[p]=0|e[t+p];else{var h=u[p-15],m=(h<<25|h>>>7)^(h<<14|h>>>18)^h>>>3,g=u[p-2],v=(g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10;u[p]=m+u[p-7]+v+u[p-16]}var y=r&i^r&o^i&o,b=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),S=f+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&d^~s&l)+c[p]+u[p];f=l,l=d,d=s,s=a+S|0,a=o,o=i,i=r,r=S+(b+y)|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0,n[5]=n[5]+d|0,n[6]=n[6]+l|0,n[7]=n[7]+f|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(i+64>>>9<<4)]=e.floor(r/4294967296),n[15+(i+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=o._createHelper(d),t.HmacSHA256=o._createHmacHelper(d)}(Math),r.SHA256)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomString=function(e){void 0===e&&(e=8);for(var t="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",n=t.length,r="",i=0;i<e;i++)r+=t.charAt(Math.floor(Math.random()*n));return r}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(2),c=a(n(37)),u=n(24),d=a(n(0)),l=n(1);function f(e){return new Promise((function(t){window.setTimeout(t,e)}))}function p(e,t){return new Promise((function(n,r){t.timeout=t.timeout||s.getParameter("HTTP_CONNECT_TIMEOUT"),t.responseType=t.responseType||"json",t.data&&(t.data=JSON.stringify(t.data)),t.headers=t.headers||{},t.headers["Content-Type"]="application/json",t.method="POST",t.url=e,c.default.request(t).then((function(e){n(e.data)})).catch((function(e){c.default.isCancel(e)?r(new u.AgoraRTCError(u.AgoraRTCErrorCode.OPERATION_ABORT,"cancel token canceled")):"ECONNABORTED"===e.code?r(new u.AgoraRTCError(u.AgoraRTCErrorCode.NETWORK_TIMEOUT,e.message)):e.response?r(new u.AgoraRTCError(u.AgoraRTCErrorCode.NETWORK_RESPONSE_ERROR,e.response.status)):r(new u.AgoraRTCError(u.AgoraRTCErrorCode.NETWORK_ERROR,e.message))}))}))}function h(e,n,r,a){var s=this,c=Object.assign({},t.DEFAULT_RETRY_CONFIG,a),d=c.timeout,l=function(){return i(s,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,f(d)];case 1:return e.sent(),d*=c.timeoutFactor,d=Math.min(c.maxRetryTimeout,d),[2]}}))}))},p=!1,h=new Promise((function(t,a){return i(s,void 0,void 0,(function(){var i,s,d;return o(this,(function(o){switch(o.label){case 0:n=n||function(){return!1},r=r||function(){return!0},i=0,o.label=1;case 1:if(!(i<c.maxRetryCount))return[3,12];if(p)return[2,a(new u.AgoraRTCError(u.AgoraRTCErrorCode.OPERATION_ABORT))];o.label=2;case 2:return o.trys.push([2,7,,11]),[4,e()];case 3:return s=o.sent(),n(s,i)?i+1===c.maxRetryCount?[2,t(s)]:[4,l()]:[3,5];case 4:return o.sent(),[3,6];case 5:return[2,t(s)];case 6:return[3,11];case 7:return d=o.sent(),r(d,i)?i+1===c.maxRetryCount?[2,a(d)]:[4,l()]:[3,9];case 8:return o.sent(),[3,10];case 9:return[2,a(d)];case 10:return[3,11];case 11:return i+=1,[3,1];case 12:return[2]}}))}))}));return h.cancel=function(){return p=!0},h}function m(e,t){return{addressList:e.servers.map((function(e,n){return"wss://"+e.address.replace(/\./g,"-")+".edge.agora.io:"+e.wss+"?serviceName="+encodeURIComponent(t)})),workerToken:e.workerToken,vid:e.vid}}t.wait=f,t.post=p,t.DEFAULT_RETRY_CONFIG={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4},t.getRetryWaitTime=function(e,t){var n=t.timeout*Math.pow(t.timeoutFactor,e);return Math.min(t.maxRetryTimeout,n)},t.retryable=h,t.liveStreamingServerResponseToResult=m;var g=1;function v(e,n,a,c,f){var v=this;void 0===f&&(f=t.DEFAULT_RETRY_CONFIG),g+=1;var y,b,S={sid:a.sid,command:"convergeAllocateEdge",uid:"666",appId:a.appId,ts:Math.floor(Date.now()/1e3),seq:g,requestId:g,version:s.VERSION,cname:a.cname},E={service_name:n,json_body:JSON.stringify(S)},_=e[0];return h((function(){return i(v,void 0,void 0,(function(){var e,t,i,a,l;return o(this,(function(o){switch(o.label){case 0:return y=Date.now(),[4,p(_,{data:E,cancelToken:c,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}})];case 1:if(e=o.sent(),b=Date.now()-y,0!==e.code)throw i=new u.AgoraRTCError(u.AgoraRTCErrorCode.UNEXPECTED_RESPONSE,"live streaming ap error, code"+e.code,{retry:!0}),d.default.error(i.toString()),i;if(200!==(t=JSON.parse(e.json_body)).code)throw i=new u.AgoraRTCError(u.AgoraRTCErrorCode.UNEXPECTED_RESPONSE,"live streaming app center error, code: "+t.code+", reason: "+t.reason),d.default.error(i.toString()),i;if(!t.servers||0===t.servers.length)throw i=new u.AgoraRTCError(u.AgoraRTCErrorCode.UNEXPECTED_RESPONSE,"live streaming app center empty server"),d.default.error(i.toString()),i;if(a=m(t,n),s.getParameter("LIVE_STREAMING_ADDRESS"))try{l=JSON.parse(s.getParameter("LIVE_STREAMING_ADDRESS")),a.addressList=l}catch(e){a.addressList=[s.getParameter("LIVE_STREAMING_ADDRESS")]}return[2,r(r({},a),{responseTime:b})]}}))}))}),(function(t,r){return l.report.requestApWorkerEvent(a.sid,{success:!0,sc:200,serviceName:n,responseDetail:JSON.stringify(t.addressList),firstSuccess:0===r,responseTime:b,serverIp:e[r%e.length]}),!1}),(function(t,r){return l.report.requestApWorkerEvent(a.sid,{success:!1,sc:t.data&&t.data.code||200,serviceName:n,responseTime:b,serverIp:e[r%e.length]}),!!(t.code!==u.AgoraRTCErrorCode.OPERATION_ABORT&&t.code!==u.AgoraRTCErrorCode.UNEXPECTED_RESPONSE||t.data&&t.data.retry)&&(_=e[(r+1)%e.length],!0)}),f)}t.requestLiveStreamingWorkerManager=v,t.getLiveStreamingWorkerMangerResult=function(e,t,n){return i(this,void 0,void 0,(function(){var r,i;return o(this,(function(o){switch(o.label){case 0:r=s.getParameter("UAP_AP").map((function(e){return t.proxyServer?"https://"+t.proxyServer+"/ap/?url="+e+"/api/v1?action=uap":"https://"+e+"/api/v1?action=uap"})),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,v(r,e,t,n)];case 2:return[2,o.sent()];case 3:throw i=o.sent(),l.report.requestApWorkerEvent(t.sid,{success:!1,sc:i.data&&i.data.code||200,serviceName:e,responseTime:i.data&&i.data.responseTime}),i;case 4:return[2]}}))}))}},function(e,t,n){var r=n(70),i=n(71),o=n(34),a=n(72);e.exports=function(e){return r(e)||i(e)||o(e)||a()}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(35);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}},function(e,t,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r};Object.defineProperty(t,"__esModule",{value:!0});var i=n(24),o=function(){function e(){this._events={},this.addListener=this.on}return e.prototype.getListeners=function(e){return this._events[e]?this._events[e].map((function(e){return e.listener})):[]},e.prototype.on=function(e,t){this._events[e]||(this._events[e]=[]);var n=this._events[e];-1===this._indexOfListener(n,t)&&n.push({listener:t,once:!1})},e.prototype.once=function(e,t){this._events[e]||(this._events[e]=[]);var n=this._events[e];-1===this._indexOfListener(n,t)&&n.push({listener:t,once:!0})},e.prototype.off=function(e,t){if(this._events[e]){var n=this._events[e],r=this._indexOfListener(n,t);-1!==r&&n.splice(r,1),0===this._events[e].length&&delete this._events[e]}},e.prototype.removeAllListeners=function(e){e?delete this._events[e]:this._events={}},e.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this._events[e]||(this._events[e]=[]);for(var r=this._events[e].map((function(e){return e})),i=0;i<r.length;i+=1){var o=r[i];o.once&&this.off(e,o.listener),o.listener.apply(this,t||[])}},e.prototype._indexOfListener=function(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1},e}();function a(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var a=null,s=null;if(e.emit.apply(e,r([t],n,[function(e){a=e},function(e){s=e}])),null!==s)throw s;if(null===a)throw new i.AgoraRTCError(i.AgoraRTCErrorCode.UNEXPECTED_ERROR,"handler is not sync");return a}t.EventEmitter=o,t.emitAsPromise=function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return 0===e.getListeners(t).length?Promise.reject(new i.AgoraRTCError(i.AgoraRTCErrorCode.UNEXPECTED_ERROR,"can not emit promise")):new Promise((function(i,o){e.emit.apply(e,r([t],n,[i,o]))}))},t.emitAsInvokerNoResponse=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return 0===e.getListeners(t).length?null:a.apply(void 0,r([e,t],n))},t.emitAsInvoker=a},function(e,t,n){e.exports=n(78)},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},function(e,t,n){"use strict";var r=n(18);function i(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var o;if(n)o=n(t);else if(r.isURLSearchParams(t))o=t.toString();else{var a=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),a.push(i(t)+"="+i(e))})))})),o=a.join("&")}if(o){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";(function(t){var r=n(18),i=n(84),o={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var s,c={adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==t&&"[object process]"===Object.prototype.toString.call(t))&&(s=n(42)),s),transformRequest:[function(e,t){return i(t,"Accept"),i(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(a(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){c.headers[e]=r.merge(o)})),e.exports=c}).call(this,n(83))},function(e,t,n){"use strict";var r=n(18),i=n(85),o=n(39),a=n(87),s=n(90),c=n(91),u=n(43);e.exports=function(e){return new Promise((function(t,d){var l=e.data,f=e.headers;r.isFormData(l)&&delete f["Content-Type"];var p=new XMLHttpRequest;if(e.auth){var h=e.auth.username||"",m=e.auth.password||"";f.Authorization="Basic "+btoa(h+":"+m)}var g=a(e.baseURL,e.url);if(p.open(e.method.toUpperCase(),o(g,e.params,e.paramsSerializer),!0),p.timeout=e.timeout,p.onreadystatechange=function(){if(p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in p?s(p.getAllResponseHeaders()):null,r={data:e.responseType&&"text"!==e.responseType?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:n,config:e,request:p};i(t,d,r),p=null}},p.onabort=function(){p&&(d(u("Request aborted",e,"ECONNABORTED",p)),p=null)},p.onerror=function(){d(u("Network Error",e,null,p)),p=null},p.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),d(u(t,e,"ECONNABORTED",p)),p=null},r.isStandardBrowserEnv()){var v=n(92),y=(e.withCredentials||c(g))&&e.xsrfCookieName?v.read(e.xsrfCookieName):void 0;y&&(f[e.xsrfHeaderName]=y)}if("setRequestHeader"in p&&r.forEach(f,(function(e,t){void 0===l&&"content-type"===t.toLowerCase()?delete f[t]:p.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(p.withCredentials=!!e.withCredentials),e.responseType)try{p.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&p.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){p&&(p.abort(),d(e),p=null)})),void 0===l&&(l=null),p.send(l)}))}},function(e,t,n){"use strict";var r=n(86);e.exports=function(e,t,n,i,o){var a=new Error(e);return r(a,t,n,i,o)}},function(e,t,n){"use strict";var r=n(18);e.exports=function(e,t){t=t||{};var n={},i=["url","method","params","data"],o=["headers","auth","proxy"],a=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"];r.forEach(i,(function(e){void 0!==t[e]&&(n[e]=t[e])})),r.forEach(o,(function(i){r.isObject(t[i])?n[i]=r.deepMerge(e[i],t[i]):void 0!==t[i]?n[i]=t[i]:r.isObject(e[i])?n[i]=r.deepMerge(e[i]):void 0!==e[i]&&(n[i]=e[i])})),r.forEach(a,(function(r){void 0!==t[r]?n[r]=t[r]:void 0!==e[r]&&(n[r]=e[r])}));var s=i.concat(o).concat(a),c=Object.keys(t).filter((function(e){return-1===s.indexOf(e)}));return r.forEach(c,(function(r){void 0!==t[r]?n[r]=t[r]:void 0!==e[r]&&(n[r]=e[r])})),n}},function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(59)),c=a(n(62)),u=a(n(63)),d=o(n(0)),l=n(2),f=s.default.Root.fromJSON(u),p=function(){function e(){this.requestArray=[],this.retryBackoffCount=0,this.state=0}return e.prototype.setProxy=function(e){this.proxyServer=e},e.prototype.sendReportList=function(e,t){var n=this,r=this._dataConvert("ProtoRaws",{vid:t,sendTs:Math.round(Date.now()/1e3),payloads:e.map((function(e){return{id:c[e.type],msg:n._dataConvert(e.type,e.data)}}))});this.send(r)},e.prototype._dataConvert=function(e,t){var n;try{n=f.lookupType("protobuf."+e)}catch(t){d.default.error("[send-proto] invalid proto name "+e)}var r=n.create(t);return n.encode(r).finish()},e.prototype.send=function(e){0==this.state?this._send(e):this.requestArray.push(e)},e.prototype._send=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,4]),this.state=1,[4,this.request(e)];case 1:return t.sent(),this.retryBackoffCount=0,0!==this.requestArray.length?this._send(this.requestArray.shift()):this.state=0,[3,4];case 2:return t.sent(),[4,h(this.retryBackoffCount++<2?200:1e4)];case 3:return t.sent(),this._send(e),[3,4];case 4:return[2]}}))}))},e.prototype.request=function(e){return r(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:t=this._getAddress(),n=this._getBackupAddress(),r.label=1;case 1:return r.trys.push([1,3,,5]),[4,this._request(t,e)];case 2:return r.sent(),[3,5];case 3:return r.sent(),[4,this._request(n,e)];case 4:return r.sent(),[3,5];case 5:return[2]}}))}))},e.prototype._request=function(e,t){return this._post(e,t)},e.prototype._post=function(e,t){var n=this;return new Promise((function(r,i){var o=new XMLHttpRequest;o.timeout=l.getParameter("HTTP_CONNECT_TIMEOUT"),o.open("POST",e,!0),o.setRequestHeader("Content-type","application/octet-stream"),n.proxyServer||(o.setRequestHeader("Cache-Control","no-cache, no-store"),o.setRequestHeader("Pragma","no-cache"),o.setRequestHeader("Expires","0")),o.onload=function(e){r(o.responseText)},o.onerror=function(e){i(e)},o.ontimeout=function(e){i(e)},o.send(t)}))},e.prototype._getAddress=function(){return this.proxyServer?"https://"+this.proxyServer+"/rs/?h="+l.getParameter("EVENT_REPORT_DOMAIN")+"&p=6443&d=events/proto-raws":"https://"+l.getParameter("EVENT_REPORT_DOMAIN")+":6443/events/proto-raws"},e.prototype._getBackupAddress=function(){return this.proxyServer?"https://"+this.proxyServer+"/rs/?h="+l.getParameter("EVENT_REPORT_BACKUP_DOMAIN")+"&p=6443&d=events/proto-raws":"https://"+l.getParameter("EVENT_REPORT_BACKUP_DOMAIN")+":6443/events/proto-raws"},e}();t.default=p;var h=function(e){return new Promise((function(t){window.setTimeout(t,e)}))}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a,s=o(n(0)),c=n(15);!function(e){e.NEW="new",e.PREPARING_OFFER="preparing-offer",e.OFFER_SENT="offer-sent",e.ESTABLISHED="established",e.CLOSED="closed"}(a||(a={}));var u=function(){function e(e){this.candidate=null,this.state=a.NEW,this.config=e,this.isSubscriber=this.config.isSubscriber,this.peerConnection=this.initPeecConnection(e),this.peerConnection.onicecandidate=this._onicecandidate.bind(this),this.peerConnection.oniceconnectionstatechange=this._oniceconnectionstatechange.bind(this),this.peerConnection.onaddstream=this._onaddstream.bind(this),this.peerConnection.ontrack=this._ontrack.bind(this),this.processSignalingMessage=this.setAnswer.bind(this),this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then(this.setLocalSDP.bind(this)),this.sendVideoStats={id:"",type:"",mediaType:"",googCodecName:this.config.codec.toUpperCase(),bytesSent:"0",packetsLost:"0",packetsSent:"0",googAdaptationChanges:"0",googAvgEncodeMs:"0",googEncodeUsagePercent:"0",googFirsReceived:"0",googFrameHeightSent:"0",googFrameHeightInput:"0",googFrameRateInput:"0",googFrameRateSent:"0",googFrameWidthSent:"0",googFrameWidthInput:"0",googNacksReceived:"0",googPlisReceived:"0",googRtt:"0",googFramesEncoded:"0"},this.sendAudioStats={id:"",type:"",mediaType:"",googCodecName:"opus",aecDivergentFilterFraction:"0",audioInputLevel:"0",bytesSent:"0",packetsSent:"0",googEchoCancellationReturnLoss:"0",googEchoCancellationReturnLossEnhancement:"0"},this.receiveAudioStats={id:"",type:"",mediaType:"",audioOutputLevel:"0",bytesReceived:"0",packetsLost:"0",packetsReceived:"0",googAccelerateRate:"0",googCurrentDelayMs:"0",googDecodingCNG:"0",googDecodingCTN:"0",googDecodingCTSG:"0",googDecodingNormal:"0",googDecodingPLC:"0",googDecodingPLCCNG:"0",googExpandRate:"0",googJitterBufferMs:"0",googJitterReceived:"0",googPreemptiveExpandRate:"0",googPreferredJitterBufferMs:"0",googSecondaryDecodedRate:"0",googSpeechExpandRate:"0"},this.receiveVideoStats={id:"",type:"",mediaType:"",googTargetDelayMs:"0",packetsLost:"0",googDecodeMs:"0",googMaxDecodeMs:"0",googRenderDelayMs:"0",googFrameWidthReceived:"0",googFrameHeightReceived:"0",googFrameRateReceived:"0",googFrameRateDecoded:"0",googFrameRateOutput:"0",googFramesDecoded:"0",googFrameReceived:"0",googJitterBufferMs:"0",googCurrentDelayMs:"0",googMinPlayoutDelayMs:"0",googNacksSent:"0",googPlisSent:"0",googFirsSent:"0",bytesReceived:"0",packetsReceived:"0"}}return e.prototype.addStream=function(e){this.peerConnection.addStream(e)},e.prototype.setRtpSenderParameters=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(e){return[2]}))}))},e.prototype.setAnswer=function(e){var t=JSON.parse(e);this.peerConnection.setRemoteDescription(new RTCSessionDescription({sdp:t.sdp,type:"answer"})),this.onsignalingmessage&&this.onsignalingmessage("")},e.prototype.close=function(){this.peerConnection.close()},e.prototype.getStats=function(e,t){if(void 0===t&&(t=500),t=t>500?500:t,Date.now()-this.lastTimeGetStats<t){var n=[];this.config.isSubscriber?(n.push(this.receiveVideoStats),n.push(this.receiveAudioStats)):(n.push(this.sendAudioStats),n.push(this.sendVideoStats)),n.push({id:"time",startTime:this.connectedTime,timestamp:Date.now()}),e&&e(n)}else this._getStats(e)},e.prototype._getStats=function(e){var t=this,n=[];this.peerConnection.getStats(null).then((function(r){t.lastTimeGetStats=Date.now(),Object.keys(r).map((function(e){var n=r[e];t.config.isSubscriber?n.type&&"inboundrtp"===n.type&&n.mediaType&&"audio"===n.mediaType?(t.receiveAudioStats.id=n.id+"recv",t.receiveAudioStats.type=n.type+"",t.receiveAudioStats.mediaType=n.mediaType+"",t.receiveAudioStats.packetsReceived=n.packetsReceived+"",t.receiveAudioStats.bytesReceived=n.bytesReceived+"",t.receiveAudioStats.packetsLost=n.packetsLost+"",t.receiveAudioStats.googJitterReceived=n.jitter+""):n.type&&"inboundrtp"===n.type&&n.mediaType&&"video"===n.mediaType?(t.receiveVideoStats.id=n.id+"recv",t.receiveVideoStats.type=n.type+"",t.receiveVideoStats.mediaType=n.mediaType+"",t.receiveVideoStats.packetsReceived=n.packetsReceived+"",t.receiveVideoStats.bytesReceived=n.bytesReceived+"",t.receiveVideoStats.packetsLost=n.packetsLost+"",t.receiveVideoStats.googJitterBufferMs=n.jitter+"",t.receiveVideoStats.googPlisSent=n.pliCount+"",t.receiveVideoStats.googFirsSent=n.firCount+"",t.receiveVideoStats.googNacksSent=n.nackCount+""):n.remoteSource&&n.type&&"track"===n.type&&n.trackIdentifier&&-1!==n.trackIdentifier.indexOf("v")?(t.receiveVideoStats.googFrameHeightReceived=n.frameHeight+"",t.receiveVideoStats.googFrameWidthReceived=n.frameWidth+"",t.receiveVideoStats.googFrameRateDecoded=n.framesPerSecond+"",t.receiveVideoStats.googFrameRateOutput=n.framesPerSecond+"",t.receiveVideoStats.googFrameRateReceived=n.framesPerSecond+"",t.receiveVideoStats.googFramesDecoded=n.framesDecoded+"",t.receiveVideoStats.googFrameReceived=n.framesReceived+""):n.remoteSource&&n.type&&"track"===n.type&&n.trackIdentifier&&-1!==n.trackIdentifier.indexOf("a")&&(t.receiveAudioStats.audioOutputLevel=n.audioLevel+""):!n.isRemote&&n.type&&"outboundrtp"===n.type&&n.mediaType&&"audio"===n.mediaType?(t.sendAudioStats.id=n.id+"send",t.sendAudioStats.type=n.type+"",t.sendAudioStats.mediaType=n.mediaType+"",t.sendAudioStats.packetsSent=n.packetsSent+"",t.sendAudioStats.bytesSent=n.bytesSent+""):!n.isRemote&&n.type&&"outboundrtp"===n.type&&n.mediaType&&"video"===n.mediaType?(t.sendVideoStats.id=n.id+"send",t.sendVideoStats.type=n.type+"",t.sendVideoStats.mediaType=n.mediaType+"",t.sendVideoStats.packetsSent=n.packetsSent+"",t.sendVideoStats.bytesSent=n.bytesSent+"",t.sendVideoStats.googRtt=n.roundTripTime+"",t.sendVideoStats.googPlisReceived=n.pliCount+"",t.sendVideoStats.googFirsReceived=n.firCount+"",t.sendVideoStats.googNacksReceived=n.nackCount+""):!n.remoteSource&&n.type&&"track"===n.type&&n.framesSent&&0!==n.framesSent&&(t.sendVideoStats.googFrameHeightSent=n.frameHeight+"",t.sendVideoStats.googFrameHeightInput=n.frameHeight+"",t.sendVideoStats.googFrameWidthSent=n.frameWidth+"",t.sendVideoStats.googFrameWidthInput=n.frameWidth+"",t.sendVideoStats.googFramesEncoded=n.framesSent+"",t.sendVideoStats.googFrameRateSent=n.framesPerSecond+"")})),t.config.isSubscriber?(n.push(t.receiveVideoStats),n.push(t.receiveAudioStats)):(n.push(t.sendAudioStats),n.push(t.sendVideoStats)),n.push({id:"time",startTime:t.connectedTime,timestamp:Date.now()}),e&&e(n)}))},e.prototype.getStatsRate=function(e){this.getStats(e)},e.prototype.initPeecConnection=function(e){var t=e.stunServerUrl,n=e.turnServer,r=e.iceServers;return this.pcConfig={iceServers:[]},r instanceof Array?this.pcConfig.iceServers=e.iceServers:t&&(t instanceof Array?t.map((function(e){"string"==typeof e&&""!==e&&this.pcConfig.iceServers.push({urls:e})})):"string"==typeof t&&""!==t&&this.pcConfig.iceServers.push({urls:t})),n&&(n instanceof Array?n.map((function(e){"string"==typeof e.url&&""!==e.url&&this.pcConfig.iceServers.push({username:e.username,credential:e.credential,url:e.url})})):"auto"!==n.mode&&"manual"!==n.mode||(n.udpport&&this.pcConfig.iceServers.push({username:n.username,credential:n.credential,credentialType:"password",urls:"turn:"+n.url+":"+n.udpport+"?transport=udp"}),"string"==typeof n.tcpport&&""!==n.tcpport&&this.pcConfig.iceServers.push({username:n.username,credential:n.credential,credentialType:"password",urls:"turn:"+n.url+":"+n.tcpport+"?transport=tcp"}),!0===n.forceturn&&(this.pcConfig.iceTransportPolicy="relay"))),new c.RTCPeerConnection(this.pcConfig)},e.prototype._ontrack=function(e){this.onaddstream&&this.onaddstream(e,"ontrack")},e.prototype._onaddstream=function(e){this.onaddstream&&this.onaddstream(e,"onaddstream")},e.prototype._oniceconnectionstatechange=function(e){"connected"===e.currentTarget.iceConnectionState&&(this.state=a.ESTABLISHED,this.connectedTime=Date.now()),this.oniceconnectionstatechange&&this.oniceconnectionstatechange(e.currentTarget.iceConnectionState)},e.prototype._onicecandidate=function(e){!this.candidate&&e&&(this.candidate=e.candidate,this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then(this.editLocalSDP.bind(this)).then(this.setLocalSDP.bind(this)).then(this.sendOffer.bind(this)).catch())},e.prototype.setLocalSDP=function(e){return this.peerConnection.setLocalDescription(new RTCSessionDescription({sdp:e.sdp,type:"offer"})),this.state=a.PREPARING_OFFER,e},e.prototype.editLocalSDP=function(e){return e.sdp=this.setBandWidth(e.sdp),e.sdp=this.reviseOpus(e.sdp),e.sdp=this.addCandidate(e.sdp),e},e.prototype.setSendRecv=function(e){return(e=(e=e.replace(/a=recvonly\r\n/g,"a=sendrecv\r\n")).replace(/a=sendonly\r\n/g,"a=sendrecv\r\n")).replace(/a=inactive\r\n/g,"a=sendrecv\r\n")},e.prototype.setBandWidth=function(e){var t,n,r=this.config,i=r.codec,o=r.minVideoBW,a=r.maxVideoBW,c=r.maxAudioBW,u=r.clientId;if((t=e.match(/m=video.*\r\n/))&&o&&a){n=t[0]+"b=AS:"+a+"\r\n";var d=0,l=0;"h264"===i?(d=e.search(/a=rtpmap:(\d+) H264\/90000\r\n/),l=e.search(/H264\/90000\r\n/)):"vp8"===i?(d=e.search(/a=rtpmap:(\d+) VP8\/90000\r\n/),l=e.search(/VP8\/90000\r\n/)):"vp9"===i&&(d=e.search(/a=rtpmap:(\d+) VP9\/90000\r\n/),l=e.search(/VP9\/90000\r\n/)),-1!==d&&-1!==l&&l-d>10&&(n=n+"a=fmtp:"+e.slice(d+9,l-1)+" x-google-min-bitrate="+o+"\r\n"),e=e.replace(t[0],n),s.default.debug("["+u+"]Set Video Bitrate - min:"+o+" max:"+a)}return(t=e.match(/m=audio.*\r\n/))&&c&&(n=t[0]+"b=AS:"+c+"\r\n",e=e.replace(t[0],n)),e},e.prototype.reviseOpus=function(e){return(e=e.replace(/a=rtpmap:102 opus\/48000\/2/g,"a=rtpmap:111 opus/48000/2")).replace(/m=audio 9 UDP\/TLS\/RTP\/SAVPF 102 0 8 97 13 118 101/g,"m=audio 9 UDP/TLS/RTP/SAVPF 111 0 8 97 13 118 101")},e.prototype.addCandidate=function(e){return e+"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"},e.prototype.sendOffer=function(e){this.config.callback(JSON.stringify({sdp:e.sdp,messageType:"OFFER",tiebreaker:Math.floor(429496723*Math.random()+1)})),this.state=a.OFFER_SENT},e}();t.default=u},function(e,t,n){var r=n(65),i=n(66),o=n(34),a=n(67);e.exports=function(e,t){return r(e)||i(e,t)||o(e,t)||a()}},function(e,t,n){var r,i,o;i=this,o=function(){"use strict";var e,t=this;function n(e){t.console&&(t.console.error?t.console.error(e):t.console.log&&t.console.log(e))}function r(e,t,r,i){var o=i||n,a=e.createShader(r);return e.shaderSource(a,t),e.compileShader(a),e.getShaderParameter(a,e.COMPILE_STATUS)?a:(o("*** Error compiling shader '"+a+"':"+e.getShaderInfoLog(a)),e.deleteShader(a),null)}function i(e,t,r,i,o){var a=o||n,s=e.createProgram();return t.forEach((function(t){e.attachShader(s,t)})),r&&r.forEach((function(t,n){e.bindAttribLocation(s,i?i[n]:n,t)})),e.linkProgram(s),e.getProgramParameter(s,e.LINK_STATUS)?s:(a("Error in program linking:"+e.getProgramInfoLog(s)),e.deleteProgram(s),null)}(e=e||t)===e.top&&(console.log("%c%s","color:blue;font-weight:bold;","for more about webgl-utils.js see:"),console.log("%c%s","color:blue;font-weight:bold;","http://webglfundamentals.org/webgl/lessons/webgl-boilerplate.html"));var o,a=["VERTEX_SHADER","FRAGMENT_SHADER"];return!document.documentMode&&!!window.StyleMedia&&(HTMLCanvasElement.prototype.getContext=(o=HTMLCanvasElement.prototype.getContext,function(){var e=arguments,t=e[0];return"webgl"===t&&((e=[].slice.call(arguments))[0]="experimental-webgl"),o.apply(this,e)})),{createProgram:i,createProgramFromSources:function(e,t,n,o,s){for(var c=[],u=0;u<t.length;++u)c.push(r(e,t[u],e[a[u]],s));return i(e,c,n,o,s)}}},void 0===(r=function(){return o.call(i)}.apply(t,[]))||(e.exports=r)},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(68),s=n(4),c=o(n(0));t.getSupportedCodec=function(e){return r(void 0,void 0,void 0,(function(){var t,n,r,o,d;return i(this,(function(i){switch(i.label){case 0:return t={video:[],audio:[]},"undefined"!=typeof window?[3,1]:(c.default.error("getSupportedCodec: NOT_BROWSER_ENV"),[2,Promise.reject("NOT_BROWSER_ENV")]);case 1:try{n=a.createRTCPeerConnection({iceServers:[]})}catch(e){return c.default.error("Failed to init RTCPeerConnection",e),[2,Promise.reject(e)]}return n?[3,2]:(c.default.warning("getSupportedCodec: no RTCPeerConnection constructor is detected"),[2,Promise.resolve(t)]);case 2:return e&&e.stream?[3,7]:(r={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},o=void 0,(s.isSafari()||s.isFireFox()||s.isWeChatBrowser())&&n.addTransceiver?(n.addTransceiver("audio"),n.addTransceiver("video"),[4,n.createOffer()]):[3,4]);case 3:return o=i.sent(),[3,6];case 4:return[4,new Promise((function(e,t){var i=setTimeout((function(){t("CREATEOFFER_TIMEOUT")}),3e3);n.createOffer((function(t){clearTimeout(i),e(t)}),(function(e){clearTimeout(i),t(e)}),r)}))];case 5:o=i.sent(),i.label=6;case 6:return n.close(),d=o.sdp,[2,u(d)];case 7:return e.stream.getTracks&&n.addTrack?e.stream.getTracks().forEach((function(t){n.addTrack(t,e.stream)})):n.addStream(e.stream),o=void 0,s.isSafari()||s.isFireFox()?[4,n.createOffer()]:[3,9];case 8:return o=i.sent(),[3,11];case 9:return[4,new Promise((function(e,t){n.createOffer(e,t)}))];case 10:o=i.sent(),i.label=11;case 11:return n.close(),d=o.sdp,[2,u(d)]}}))}))};var u=function(e){var t={video:[],audio:[]};return e.match(/ VP8/i)&&t.video.push("VP8"),e.match(/ VP9/i)&&t.video.push("VP9"),e.match(/ H264/i)&&t.video.push("H264"),e.match(/ opus/i)&&t.audio.push("OPUS"),Promise.resolve(t)}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(10);function a(e){for(var t="",n=0;n<e.length;n+=1)t+=String.fromCharCode(e[n]);return window.btoa(t)}t.encryptRSA=function(e){return r(void 0,void 0,void 0,(function(){var t,n,r,s;return i(this,(function(i){switch(i.label){case 0:return t=o.base64ToUint8Array("MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu\nSTM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+\nHvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy\nxQiYDz3vqa6bP29adwIDAQAB"),[4,window.crypto.subtle.importKey("spki",t,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"])];case 1:return n=i.sent(),c=e,r=(new TextEncoder).encode(c),[4,window.crypto.subtle.encrypt({name:"RSA-OAEP"},n,r)];case 2:return s=i.sent(),[2,a(new Uint8Array(s))]}var c}))}))}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(75),c=n(24),u=n(1),d=n(27);t.addLiveStreamingCapability=function(e,t){var n=this,o=function(t){var n=t.type;if(!e.joinInfo)return new c.AgoraRTCError(c.AgoraRTCErrorCode.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();switch(n){case d.LiveStreamingServiceMode.INJECT:return e._injectStreamingClient||(e._injectStreamingClient=new s.AgoraRTCLiveStreamingClient(e.joinInfo),e._injectStreamingClient.onInjectStatusChange=function(t,n,r){e.gatewayClient.dispatchEvent({type:"streamInjectedStatus",url:r,status:t})}),e._injectStreamingClient;case d.LiveStreamingServiceMode.RAW:return e._liveRawStreamingClient||(e._liveRawStreamingClient=new s.AgoraRTCLiveStreamingClient(e.joinInfo),e._liveRawStreamingClient.setGatewayConnectionState(e.getConnectionState()),e.on("connection-state-change",(function(t){e._liveRawStreamingClient.setGatewayConnectionState(t.curState),"CONNECTING"===t.prevState&&"CONNECTED"===t.curState&&e._liveRawStreamingClient&&e._liveRawStreamingClient.resetAllTask()})),e._liveRawStreamingClient.onLiveStreamError=function(t,n){a.default.error("LIVE_STREAMING_ERROR",n.toString()),e.gatewayClient.dispatchEvent({type:"liveStreamingFailed",url:t,reason:n.code})},e._liveRawStreamingClient.onLiveStreamWarning=function(t,n){a.default.warning("LIVE_STREAMING_WARNING",n.toString()),e.gatewayClient.dispatchEvent({type:"liveStreamingWarning",url:t,reason:n.code})}),e._liveRawStreamingClient;case d.LiveStreamingServiceMode.TRANSCODE:return e._liveTranscodeStreamingClient||(e._liveTranscodeStreamingClient=new s.AgoraRTCLiveStreamingClient(e.joinInfo),e._liveTranscodeStreamingClient.setGatewayConnectionState(e.getConnectionState()),e.on("connection-state-change",(function(t){e._liveTranscodeStreamingClient.setGatewayConnectionState(t.curState),"CONNECTING"===t.prevState&&"CONNECTED"===t.curState&&e._liveTranscodeStreamingClient&&e._liveTranscodeStreamingClient.resetAllTask()})),e._liveTranscodeStreamingClient.onLiveStreamError=function(t,n){a.default.error("LIVE_STREAMING_ERROR",n.toString()),e.gatewayClient.dispatchEvent({type:"liveStreamingFailed",url:t,reason:n.code})},e._liveTranscodeStreamingClient.onLiveStreamWarning=function(t,n){a.default.warning("LIVE_STREAMING_WARNING",n.toString()),e.gatewayClient.dispatchEvent({type:"liveStreamingWarning",url:t,reason:n})}),e._liveTranscodeStreamingClient}};e.gatewayClient.addEventListener("join",(function(t){e._injectStreamingClient&&e._injectStreamingClient.resetAllTask()})),e.gatewayClient.addEventListener("stream-unpublished",(function(t){t.options&&0===t.options.streamType&&(e._liveRawStreamingClient&&e._liveRawStreamingClient.resetAllTask(),e._liveTranscodeStreamingClient&&e._liveTranscodeStreamingClient.resetAllTask())})),e.gatewayClient.addEventListener("stream-published",(function(e){})),e.startLiveStreaming=function(n,r){a.default.debug("startLiveStreaming");var i=u.report.reportApiInvoke(t.sessionId,{name:"Client.startLiveStreaming",options:arguments,tag:"tracer"});if(e.gatewayClient&&"audience"===e.gatewayClient.role){var o={code:403,reason:"AUDIENCE_STREAMING_FORBIDDEN"};throw i(o),o}var s=e._startLiveStreaming(n,r);return s.then((function(e){i(null,e)})).catch((function(t){a.default.error("LIVE_STREAMING_ERROR",t.toString()),e.gatewayClient.dispatchEvent({type:"liveStreamingFailed",url:n,reason:t.code}),i(t)})),s},e._startLiveStreaming=function(s,u){return r(n,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return u||("vp8"===t.codec&&a.default.warning("VP8 is not supported by raw_streaming. Subscriber side will suffer"),"vp9"===t.codec&&a.default.warning("VP9 is not supported by raw_streaming. Subscriber side will suffer"),"rtc"===t.mode&&a.default.warning("RTC mode is not supported by raw_streaming. Subscriber side will suffer")),(e._liveRawStreamingClient&&e._liveRawStreamingClient.haveUrl(s)||e._liveTranscodeStreamingClient&&e._liveTranscodeStreamingClient.haveUrl(s))&&new c.AgoraRTCError(c.AgoraRTCErrorCode.LIVE_STREAMING_TASK_CONFLICT).throw(),n=u?d.LiveStreamingServiceMode.TRANSCODE:d.LiveStreamingServiceMode.RAW,[4,o({type:n}).startLiveStreamingTask(s,n)];case 1:return r.sent(),e.gatewayClient.dispatchEvent({type:"liveStreamingStarted",url:s}),[2]}}))}))},e.setLiveTranscoding=function(n){a.default.debug("setLiveTranscoding: "+JSON.stringify(n));var r=u.report.reportApiInvoke(t.sessionId,{name:"Client.setLiveTranscoding",options:arguments,tag:"tracer"}),i=o({type:d.LiveStreamingServiceMode.TRANSCODE});return i.setTranscodingConfig(n).then((function(){e.gatewayClient.dispatchEvent({type:"liveTranscodingUpdated"}),r(null)})).catch((function(t){a.default.error("SET_LIVE_TRANSCODING_ERROR",t.toString()),e.gatewayClient.dispatchEvent({type:"liveStreamingFailed",reason:t.code}),r(t)}))},e.stopLiveStreaming=function(n){var r=u.report.reportApiInvoke(t.sessionId,{name:"Client.stopLiveStreaming",options:arguments,tag:"tracer"}),i=e._stopLiveStreaming(n);return i.then((function(e){r(null,e)})).catch((function(t){a.default.error("STOP_LIVE_STREAMING_ERROR",t.toString()),e.gatewayClient.dispatchEvent({type:"liveStreamingFailed",url:n,reason:t.code}),r(t)})),i},e._stopLiveStreaming=function(t){return r(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return a.default.debug("stopLiveStreaming: "+JSON.stringify(t)),n=[e._liveRawStreamingClient,e._liveTranscodeStreamingClient],[4,Promise.all(n.map((function(e){return e&&e.haveUrl(t)&&e.stopLiveStreamingTask(t)})))];case 1:return r.sent(),a.default.debug("stopLiveStreaming sucess: "+JSON.stringify(t)),e.gatewayClient.dispatchEvent({type:"liveStreamingStopped",url:t}),[2]}}))}))},e.addInjectStreamUrl=function(n,r){var i=u.report.reportApiInvoke(t.sessionId,{name:"Client.addInjectStreamUrl",options:[n,r],tag:"tracer"});if("audience"===e.gatewayClient.role){var o={code:403,reason:"AUDIENCE_INJECTING_FORBIDDEN"};throw i(o),o}var s=e._addInjectStreamUrl(n,r);return s.then((function(e){i(null,e)})).catch((function(e){a.default.error("ADD_INJECT_STREAM_ERROR",e.toString()),i(e)})),s},e._addInjectStreamUrl=function(e,t){return r(n,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return(n=o({type:d.LiveStreamingServiceMode.INJECT})).setInjectStreamConfig(t,0),[4,n.startLiveStreamingTask(e,d.LiveStreamingServiceMode.INJECT)];case 1:return r.sent(),[2]}}))}))},e.removeInjectStreamUrl=function(n){return r(this,void 0,void 0,(function(){var r,o;return i(this,(function(i){return r=u.report.reportApiInvoke(t.sessionId,{name:"Client.removeInjectStreamUrl",options:[n],tag:"tracer"}),(o=e._removeInjectStreamUrl(n)).then((function(e){r(null,e)})).catch((function(e){a.default.error("REMOVE_INJECT_STREAM_ERROR",e.toString()),r(e)})),[2,o]}))}))},e._removeInjectStreamUrl=function(e){return r(n,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,o({type:d.LiveStreamingServiceMode.INJECT}).stopLiveStreamingTask(e)];case 1:return t.sent(),[2]}}))}))},e._terminateLiveStreaming=function(){return r(n,void 0,void 0,(function(){return i(this,(function(t){return[e._injectStreamingClient,e._liveRawStreamingClient,e._liveTranscodeStreamingClient].forEach((function(e){e&&e.terminate()})),[2]}))}))}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(5)),o=r(n(0)),a=n(10);t.default=function(e,t){void 0===t&&(t={width:160,height:120,framerate:15});var n=t.width,r=t.height,s=t.framerate,c=e.stream;if(!c)throw i.default.INVALID_LOCAL_STREAM;if(!c.getVideoTracks()[0])throw i.default.HIGH_STREAM_NOT_VIDEO_TRACE;var u=c.getVideoTracks()[0];o.default.debug("Start getLowStream");var d=document.createElement("video"),l=document.createElement("canvas");d.setAttribute("style","display:none"),d.setAttribute("muted",""),d.muted=!0,d.setAttribute("autoplay",""),d.autoplay=!0,d.setAttribute("playsinline",""),l.setAttribute("style","display:none"),l.setAttribute("width",n.toString()),l.setAttribute("height",r.toString());var f=l.getContext("2d");if(!f)throw new Error("not get canvas context");d.srcObject=c,document.body.append(d),document.body.append(l),d.play(),o.default.debug("Start render lowStream");var p=a.audioTimerLoop((function(){return function(){if(d.paused&&d.play(),d.videoHeight>2&&d.videoWidth>2){var t=d.videoWidth,n=d.videoHeight/t,r=l.width*n;Math.abs(r-l.height)>=2&&(o.default.debug("adjust low stream resolution",l.width+"x"+l.height+" -> "+l.width+"x"+r),l.height=r)}f.drawImage(d,0,0,l.width,l.height);var i=e.stream;if(i){var a=i.getVideoTracks()[0];u!==a&&(o.default.debug("adjust low stream track"),d.srcObject=i,u=a)}}()}),s),h=l.captureStream(s),m=h.getVideoTracks()[0];return m.requestFrame&&m.requestFrame(),h.clean=function(){o.default.debug("Start clean lowStream"),p(),(d||d.parentNode||d.parentNode.removeChild)&&d.parentNode.removeChild(d),(l||l.parentNode||l.parentNode.removeChild)&&l.parentNode.removeChild(l),o.default.debug("Clean lowStream")},h}},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},function(module,exports,__webpack_require__){(function(global,module){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;
/*!
 * protobuf.js v6.10.0 (c) 2016, daniel wirtz
 * compiled wed, 15 jul 2020 23:34:13 utc
 * licensed under the bsd-3-clause license
 * see: https://github.com/dcodeio/protobuf.js for details
 */!function(undefined){"use strict";!function(e,t,n){var r=function n(r){var i=t[r];return i||e[r][0].call(i=t[r]={exports:{}},n,i,i.exports),i.exports}(16);r.util.global.protobuf=r,__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(61)],(__WEBPACK_AMD_DEFINE_RESULT__=function(e){return e&&e.isLong&&(r.util.Long=e,r.configure()),r}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))===undefined||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__),module&&module.exports&&(module.exports=r)}({1:[function(e,t,n){t.exports=function(e,t){for(var n=new Array(arguments.length-1),r=0,i=2,o=!0;i<arguments.length;)n[r++]=arguments[i++];return new Promise((function(i,a){n[r]=function(e){if(o)if(o=!1,e)a(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];i.apply(null,t)}};try{e.apply(t||null,n)}catch(e){o&&(o=!1,a(e))}}))}},{}],2:[function(e,t,n){var r=n;r.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var i=new Array(64),o=new Array(123),a=0;a<64;)o[i[a]=a<26?a+65:a<52?a+71:a<62?a-4:a-59|43]=a++;r.encode=function(e,t,n){for(var r,o=null,a=[],s=0,c=0;t<n;){var u=e[t++];switch(c){case 0:a[s++]=i[u>>2],r=(3&u)<<4,c=1;break;case 1:a[s++]=i[r|u>>4],r=(15&u)<<2,c=2;break;case 2:a[s++]=i[r|u>>6],a[s++]=i[63&u],c=0}s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,a)),s=0)}return c&&(a[s++]=i[r],a[s++]=61,1===c&&(a[s++]=61)),o?(s&&o.push(String.fromCharCode.apply(String,a.slice(0,s))),o.join("")):String.fromCharCode.apply(String,a.slice(0,s))},r.decode=function(e,t,n){for(var r,i=n,a=0,s=0;s<e.length;){var c=e.charCodeAt(s++);if(61===c&&a>1)break;if((c=o[c])===undefined)throw Error("invalid encoding");switch(a){case 0:r=c,a=1;break;case 1:t[n++]=r<<2|(48&c)>>4,r=c,a=2;break;case 2:t[n++]=(15&r)<<4|(60&c)>>2,r=c,a=3;break;case 3:t[n++]=(3&r)<<6|c,a=0}}if(1===a)throw Error("invalid encoding");return n-i},r.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},{}],3:[function(e,t,n){function r(e,t){"string"==typeof e&&(t=e,e=undefined);var n=[];function i(e){if("string"!=typeof e){var t=o();if(r.verbose&&console.log("codegen: "+t),t="return "+t,e){for(var a=Object.keys(e),s=new Array(a.length+1),c=new Array(a.length),u=0;u<a.length;)s[u]=a[u],c[u]=e[a[u++]];return s[u]=t,Function.apply(null,s).apply(null,c)}return Function(t)()}for(var d=new Array(arguments.length-1),l=0;l<d.length;)d[l]=arguments[++l];if(l=0,e=e.replace(/%([%dfijs])/g,(function(e,t){var n=d[l++];switch(t){case"d":case"f":return String(Number(n));case"i":return String(Math.floor(n));case"j":return JSON.stringify(n);case"s":return String(n)}return"%"})),l!==d.length)throw Error("parameter count mismatch");return n.push(e),i}function o(r){return"function "+(r||t||"")+"("+(e&&e.join(",")||"")+"){\n  "+n.join("\n  ")+"\n}"}return i.toString=o,i}t.exports=r,r.verbose=!1},{}],4:[function(e,t,n){function r(){this._listeners={}}t.exports=r,r.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},r.prototype.off=function(e,t){if(e===undefined)this._listeners={};else if(t===undefined)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},r.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this}},{}],5:[function(e,t,n){t.exports=o;var r=e(1),i=e(7)("fs");function o(e,t,n){return"function"==typeof t?(n=t,t={}):t||(t={}),n?!t.xhr&&i&&i.readFile?i.readFile(e,(function(r,i){return r&&"undefined"!=typeof XMLHttpRequest?o.xhr(e,t,n):r?n(r):n(null,t.binary?i:i.toString("utf8"))})):o.xhr(e,t,n):r(o,this,e,t)}o.xhr=function(e,t,n){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4!==r.readyState)return undefined;if(0!==r.status&&200!==r.status)return n(Error("status "+r.status));if(t.binary){var e=r.response;if(!e){e=[];for(var i=0;i<r.responseText.length;++i)e.push(255&r.responseText.charCodeAt(i))}return n(null,"undefined"!=typeof Uint8Array?new Uint8Array(e):e)}return n(null,r.responseText)},t.binary&&("overrideMimeType"in r&&r.overrideMimeType("text/plain; charset=x-user-defined"),r.responseType="arraybuffer"),r.open("GET",e),r.send()}},{1:1,7:7}],6:[function(e,t,n){function r(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=128===n[3];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3]}function o(e,r,i){t[0]=e,r[i]=n[3],r[i+1]=n[2],r[i+2]=n[1],r[i+3]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],t[0]}function s(e,r){return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t[0]}e.writeFloatLE=r?i:o,e.writeFloatBE=r?o:i,e.readFloatLE=r?a:s,e.readFloatBE=r?s:a}():function(){function t(e,t,n,r){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,n,r);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,n,r);else{var o=Math.floor(Math.log(t)/Math.LN2);e((i<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,n,r)}}function n(e,t,n){var r=e(t,n),i=2*(r>>31)+1,o=r>>>23&255,a=8388607&r;return 255===o?a?NaN:i*(1/0):0===o?1401298464324817e-60*i*a:i*Math.pow(2,o-150)*(a+8388608)}e.writeFloatLE=t.bind(null,i),e.writeFloatBE=t.bind(null,o),e.readFloatLE=n.bind(null,a),e.readFloatBE=n.bind(null,s)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=128===n[7];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3],r[i+4]=n[4],r[i+5]=n[5],r[i+6]=n[6],r[i+7]=n[7]}function o(e,r,i){t[0]=e,r[i]=n[7],r[i+1]=n[6],r[i+2]=n[5],r[i+3]=n[4],r[i+4]=n[3],r[i+5]=n[2],r[i+6]=n[1],r[i+7]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],n[4]=e[r+4],n[5]=e[r+5],n[6]=e[r+6],n[7]=e[r+7],t[0]}function s(e,r){return n[7]=e[r],n[6]=e[r+1],n[5]=e[r+2],n[4]=e[r+3],n[3]=e[r+4],n[2]=e[r+5],n[1]=e[r+6],n[0]=e[r+7],t[0]}e.writeDoubleLE=r?i:o,e.writeDoubleBE=r?o:i,e.readDoubleLE=r?a:s,e.readDoubleBE=r?s:a}():function(){function t(e,t,n,r,i,o){var a=r<0?1:0;if(a&&(r=-r),0===r)e(0,i,o+t),e(1/r>0?0:2147483648,i,o+n);else if(isNaN(r))e(0,i,o+t),e(2146959360,i,o+n);else if(r>17976931348623157e292)e(0,i,o+t),e((a<<31|2146435072)>>>0,i,o+n);else{var s;if(r<22250738585072014e-324)e((s=r/5e-324)>>>0,i,o+t),e((a<<31|s/4294967296)>>>0,i,o+n);else{var c=Math.floor(Math.log(r)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(s=r*Math.pow(2,-c))>>>0,i,o+t),e((a<<31|c+1023<<20|1048576*s&1048575)>>>0,i,o+n)}}}function n(e,t,n,r,i){var o=e(r,i+t),a=e(r,i+n),s=2*(a>>31)+1,c=a>>>20&2047,u=4294967296*(1048575&a)+o;return 2047===c?u?NaN:s*(1/0):0===c?5e-324*s*u:s*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,i,0,4),e.writeDoubleBE=t.bind(null,o,4,0),e.readDoubleLE=n.bind(null,a,0,4),e.readDoubleBE=n.bind(null,s,4,0)}(),e}function i(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function o(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function a(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function s(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}t.exports=r(r)},{}],7:[function(require,module,exports){function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},{}],8:[function(e,t,n){var r=n,i=r.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},o=r.normalize=function(e){var t=(e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),n=i(e),r="";n&&(r=t.shift()+"/");for(var o=0;o<t.length;)".."===t[o]?o>0&&".."!==t[o-1]?t.splice(--o,2):n?t.splice(o,1):++o:"."===t[o]?t.splice(o,1):++o;return r+t.join("/")};r.resolve=function(e,t,n){return n||(t=o(t)),i(t)?t:(n||(e=o(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?o(e+"/"+t):t)}},{}],9:[function(e,t,n){t.exports=function(e,t,n){var r=n||8192,i=r>>>1,o=null,a=r;return function(n){if(n<1||n>i)return e(n);a+n>r&&(o=e(r),a=0);var s=t.call(o,a,a+=n);return 7&a&&(a=1+(7|a)),s}}},{}],10:[function(e,t,n){var r=n;r.length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)(n=e.charCodeAt(r))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},r.read=function(e,t,n){if(n-t<1)return"";for(var r,i=null,o=[],a=0;t<n;)(r=e[t++])<128?o[a++]=r:r>191&&r<224?o[a++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[a++]=55296+(r>>10),o[a++]=56320+(1023&r)):o[a++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),a=0);return i?(a&&i.push(String.fromCharCode.apply(String,o.slice(0,a))),i.join("")):String.fromCharCode.apply(String,o.slice(0,a))},r.write=function(e,t,n){for(var r,i,o=n,a=0;a<e.length;++a)(r=e.charCodeAt(a))<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&56320==(64512&(i=e.charCodeAt(a+1)))?(r=65536+((1023&r)<<10)+(1023&i),++a,t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128);return n-o}},{}],11:[function(e,t,n){var r=n,i=e(14),o=e(33);function a(e,t,n,r){if(t.resolvedType)if(t.resolvedType instanceof i){e("switch(d%s){",r);for(var o=t.resolvedType.values,a=Object.keys(o),s=0;s<a.length;++s)t.repeated&&o[a[s]]===t.typeDefault&&e("default:"),e("case%j:",a[s])("case %i:",o[a[s]])("m%s=%j",r,o[a[s]])("break");e("}")}else e('if(typeof d%s!=="object")',r)("throw TypeError(%j)",t.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",r,n,r);else{var c=!1;switch(t.type){case"double":case"float":e("m%s=Number(d%s)",r,r);break;case"uint32":case"fixed32":e("m%s=d%s>>>0",r,r);break;case"int32":case"sint32":case"sfixed32":e("m%s=d%s|0",r,r);break;case"uint64":c=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",r,r,c)('else if(typeof d%s==="string")',r)("m%s=parseInt(d%s,10)",r,r)('else if(typeof d%s==="number")',r)("m%s=d%s",r,r)('else if(typeof d%s==="object")',r)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",r,r,r,c?"true":"");break;case"bytes":e('if(typeof d%s==="string")',r)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",r,r,r)("else if(d%s.length)",r)("m%s=d%s",r,r);break;case"string":e("m%s=String(d%s)",r,r);break;case"bool":e("m%s=Boolean(d%s)",r,r)}}return e}function s(e,t,n,r){if(t.resolvedType)t.resolvedType instanceof i?e("d%s=o.enums===String?types[%i].values[m%s]:m%s",r,n,r,r):e("d%s=types[%i].toObject(m%s,o)",r,n,r);else{var o=!1;switch(t.type){case"double":case"float":e("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",r,r,r,r);break;case"uint64":o=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e('if(typeof m%s==="number")',r)("d%s=o.longs===String?String(m%s):m%s",r,r,r)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",r,r,r,r,o?"true":"",r);break;case"bytes":e("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",r,r,r,r,r);break;default:e("d%s=m%s",r,r)}}return e}r.fromObject=function(e){var t=e.fieldsArray,n=o.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return n("return new this.ctor");n("var m=new this.ctor");for(var r=0;r<t.length;++r){var s=t[r].resolve(),c=o.safeProp(s.name);s.map?(n("if(d%s){",c)('if(typeof d%s!=="object")',c)("throw TypeError(%j)",s.fullName+": object expected")("m%s={}",c)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",c),a(n,s,r,c+"[ks[i]]")("}")("}")):s.repeated?(n("if(d%s){",c)("if(!Array.isArray(d%s))",c)("throw TypeError(%j)",s.fullName+": array expected")("m%s=[]",c)("for(var i=0;i<d%s.length;++i){",c),a(n,s,r,c+"[i]")("}")("}")):(s.resolvedType instanceof i||n("if(d%s!=null){",c),a(n,s,r,c),s.resolvedType instanceof i||n("}"))}return n("return m")},r.toObject=function(e){var t=e.fieldsArray.slice().sort(o.compareFieldsById);if(!t.length)return o.codegen()("return {}");for(var n=o.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),r=[],a=[],c=[],u=0;u<t.length;++u)t[u].partOf||(t[u].resolve().repeated?r:t[u].map?a:c).push(t[u]);if(r.length){for(n("if(o.arrays||o.defaults){"),u=0;u<r.length;++u)n("d%s=[]",o.safeProp(r[u].name));n("}")}if(a.length){for(n("if(o.objects||o.defaults){"),u=0;u<a.length;++u)n("d%s={}",o.safeProp(a[u].name));n("}")}if(c.length){for(n("if(o.defaults){"),u=0;u<c.length;++u){var d=c[u],l=o.safeProp(d.name);if(d.resolvedType instanceof i)n("d%s=o.enums===String?%j:%j",l,d.resolvedType.valuesById[d.typeDefault],d.typeDefault);else if(d.long)n("if(util.Long){")("var n=new util.Long(%i,%i,%j)",d.typeDefault.low,d.typeDefault.high,d.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",l)("}else")("d%s=o.longs===String?%j:%i",l,d.typeDefault.toString(),d.typeDefault.toNumber());else if(d.bytes){var f="["+Array.prototype.slice.call(d.typeDefault).join(",")+"]";n("if(o.bytes===String)d%s=%j",l,String.fromCharCode.apply(String,d.typeDefault))("else{")("d%s=%s",l,f)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",l,l)("}")}else n("d%s=%j",l,d.typeDefault)}n("}")}var p=!1;for(u=0;u<t.length;++u){d=t[u];var h=e._fieldsArray.indexOf(d);l=o.safeProp(d.name),d.map?(p||(p=!0,n("var ks2")),n("if(m%s&&(ks2=Object.keys(m%s)).length){",l,l)("d%s={}",l)("for(var j=0;j<ks2.length;++j){"),s(n,d,h,l+"[ks2[j]]")("}")):d.repeated?(n("if(m%s&&m%s.length){",l,l)("d%s=[]",l)("for(var j=0;j<m%s.length;++j){",l),s(n,d,h,l+"[j]")("}")):(n("if(m%s!=null&&m.hasOwnProperty(%j)){",l,d.name),s(n,d,h,l),d.partOf&&n("if(o.oneofs)")("d%s=%j",o.safeProp(d.partOf.name),d.name)),n("}")}return n("return d")}},{14:14,33:33}],12:[function(e,t,n){t.exports=function(e){var t=o.codegen(["r","l"],e.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(e.fieldsArray.filter((function(e){return e.map})).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");e.group&&t("if((t&7)===4)")("break"),t("switch(t>>>3){");for(var n=0;n<e.fieldsArray.length;++n){var s=e._fieldsArray[n].resolve(),c=s.resolvedType instanceof r?"int32":s.type,u="m"+o.safeProp(s.name);t("case %i:",s.id),s.map?(t("if(%s===util.emptyObject)",u)("%s={}",u)("var c2 = r.uint32()+r.pos"),i.defaults[s.keyType]!==undefined?t("k=%j",i.defaults[s.keyType]):t("k=null"),i.defaults[c]!==undefined?t("value=%j",i.defaults[c]):t("value=null"),t("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",s.keyType)("case 2:"),i.basic[c]===undefined?t("value=types[%i].decode(r,r.uint32())",n):t("value=r.%s()",c),t("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),i.long[s.keyType]!==undefined?t('%s[typeof k==="object"?util.longToHash(k):k]=value',u):t("%s[k]=value",u)):s.repeated?(t("if(!(%s&&%s.length))",u,u)("%s=[]",u),i.packed[c]!==undefined&&t("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",u,c)("}else"),i.basic[c]===undefined?t(s.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",u,n):t("%s.push(r.%s())",u,c)):i.basic[c]===undefined?t(s.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",u,n):t("%s=r.%s()",u,c),t("break")}for(t("default:")("r.skipType(t&7)")("break")("}")("}"),n=0;n<e._fieldsArray.length;++n){var d=e._fieldsArray[n];d.required&&t("if(!m.hasOwnProperty(%j))",d.name)("throw util.ProtocolError(%j,{instance:m})",a(d))}return t("return m")};var r=e(14),i=e(32),o=e(33);function a(e){return"missing required '"+e.name+"'"}},{14:14,32:32,33:33}],13:[function(e,t,n){t.exports=function(e){for(var t,n=o.codegen(["m","w"],e.name+"$encode")("if(!w)")("w=Writer.create()"),s=e.fieldsArray.slice().sort(o.compareFieldsById),c=0;c<s.length;++c){var u=s[c].resolve(),d=e._fieldsArray.indexOf(u),l=u.resolvedType instanceof r?"int32":u.type,f=i.basic[l];t="m"+o.safeProp(u.name),u.map?(n("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",t,u.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",t)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(u.id<<3|2)>>>0,8|i.mapKey[u.keyType],u.keyType),f===undefined?n("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",d,t):n(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|f,l,t),n("}")("}")):u.repeated?(n("if(%s!=null&&%s.length){",t,t),u.packed&&i.packed[l]!==undefined?n("w.uint32(%i).fork()",(u.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",t)("w.%s(%s[i])",l,t)("w.ldelim()"):(n("for(var i=0;i<%s.length;++i)",t),f===undefined?a(n,u,d,t+"[i]"):n("w.uint32(%i).%s(%s[i])",(u.id<<3|f)>>>0,l,t)),n("}")):(u.optional&&n("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",t,u.name),f===undefined?a(n,u,d,t):n("w.uint32(%i).%s(%s)",(u.id<<3|f)>>>0,l,t))}return n("return w")};var r=e(14),i=e(32),o=e(33);function a(e,t,n,r){return t.resolvedType.group?e("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",n,r,(t.id<<3|3)>>>0,(t.id<<3|4)>>>0):e("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",n,r,(t.id<<3|2)>>>0)}},{14:14,32:32,33:33}],14:[function(e,t,n){t.exports=a;var r=e(22);((a.prototype=Object.create(r.prototype)).constructor=a).className="Enum";var i=e(21),o=e(33);function a(e,t,n,i,o){if(r.call(this,e,n),t&&"object"!=typeof t)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=i,this.comments=o||{},this.reserved=undefined,t)for(var a=Object.keys(t),s=0;s<a.length;++s)"number"==typeof t[a[s]]&&(this.valuesById[this.values[a[s]]=t[a[s]]]=a[s])}a.fromJSON=function(e,t){var n=new a(e,t.values,t.options,t.comment,t.comments);return n.reserved=t.reserved,n},a.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["options",this.options,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:undefined,"comment",t?this.comment:undefined,"comments",t?this.comments:undefined])},a.prototype.add=function(e,t,n){if(!o.isString(e))throw TypeError("name must be a string");if(!o.isInteger(t))throw TypeError("id must be an integer");if(this.values[e]!==undefined)throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(this.valuesById[t]!==undefined){if(!this.options||!this.options.allow_alias)throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return this.comments[e]=n||null,this},a.prototype.remove=function(e){if(!o.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(null==t)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this},a.prototype.isReservedId=function(e){return i.isReservedId(this.reserved,e)},a.prototype.isReservedName=function(e){return i.isReservedName(this.reserved,e)}},{21:21,22:22,33:33}],15:[function(e,t,n){t.exports=u;var r=e(22);((u.prototype=Object.create(r.prototype)).constructor=u).className="Field";var i,o=e(14),a=e(32),s=e(33),c=/^required|optional|repeated$/;function u(e,t,n,i,o,u,d){if(s.isObject(i)?(d=o,u=i,i=o=undefined):s.isObject(o)&&(d=u,u=o,o=undefined),r.call(this,e,u),!s.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!s.isString(n))throw TypeError("type must be a string");if(i!==undefined&&!c.test(i=i.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(o!==undefined&&!s.isString(o))throw TypeError("extend must be a string");this.rule=i&&"optional"!==i?i:undefined,this.type=n,this.id=t,this.extend=o||undefined,this.required="required"===i,this.optional=!this.required,this.repeated="repeated"===i,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!s.Long&&a.long[n]!==undefined,this.bytes="bytes"===n,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=d}u.fromJSON=function(e,t){return new u(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)},Object.defineProperty(u.prototype,"packed",{get:function(){return null===this._packed&&(this._packed=!1!==this.getOption("packed")),this._packed}}),u.prototype.setOption=function(e,t,n){return"packed"===e&&(this._packed=null),r.prototype.setOption.call(this,e,t,n)},u.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return s.toObject(["rule","optional"!==this.rule&&this.rule||undefined,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:undefined])},u.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=a.defaults[this.type])===undefined&&(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof i?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof o&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(!0!==this.options.packed&&(this.options.packed===undefined||!this.resolvedType||this.resolvedType instanceof o)||delete this.options.packed,Object.keys(this.options).length||(this.options=undefined)),this.long)this.typeDefault=s.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var e;s.base64.test(this.typeDefault)?s.base64.decode(this.typeDefault,e=s.newBuffer(s.base64.length(this.typeDefault)),0):s.utf8.write(this.typeDefault,e=s.newBuffer(s.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=s.emptyObject:this.repeated?this.defaultValue=s.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof i&&(this.parent.ctor.prototype[this.name]=this.defaultValue),r.prototype.resolve.call(this)},u.d=function(e,t,n,r){return"function"==typeof t?t=s.decorateType(t).name:t&&"object"==typeof t&&(t=s.decorateEnum(t).name),function(i,o){s.decorateType(i.constructor).add(new u(o,e,t,n,{default:r}))}},u._configure=function(e){i=e}},{14:14,22:22,32:32,33:33}],16:[function(e,t,n){var r=t.exports=e(17);r.build="light",r.load=function(e,t,n){return"function"==typeof t?(n=t,t=new r.Root):t||(t=new r.Root),t.load(e,n)},r.loadSync=function(e,t){return t||(t=new r.Root),t.loadSync(e)},r.encoder=e(13),r.decoder=e(12),r.verifier=e(36),r.converter=e(11),r.ReflectionObject=e(22),r.Namespace=e(21),r.Root=e(26),r.Enum=e(14),r.Type=e(31),r.Field=e(15),r.OneOf=e(23),r.MapField=e(18),r.Service=e(30),r.Method=e(20),r.Message=e(19),r.wrappers=e(37),r.types=e(32),r.util=e(33),r.ReflectionObject._configure(r.Root),r.Namespace._configure(r.Type,r.Service,r.Enum),r.Root._configure(r.Type),r.Field._configure(r.Type)},{11:11,12:12,13:13,14:14,15:15,17:17,18:18,19:19,20:20,21:21,22:22,23:23,26:26,30:30,31:31,32:32,33:33,36:36,37:37}],17:[function(e,t,n){var r=n;function i(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=e(38),r.BufferWriter=e(39),r.Reader=e(24),r.BufferReader=e(25),r.util=e(35),r.rpc=e(28),r.roots=e(27),r.configure=i,i()},{24:24,25:25,27:27,28:28,35:35,38:38,39:39}],18:[function(e,t,n){t.exports=a;var r=e(15);((a.prototype=Object.create(r.prototype)).constructor=a).className="MapField";var i=e(32),o=e(33);function a(e,t,n,i,a,s){if(r.call(this,e,t,i,undefined,undefined,a,s),!o.isString(n))throw TypeError("keyType must be a string");this.keyType=n,this.resolvedKeyType=null,this.map=!0}a.fromJSON=function(e,t){return new a(e,t.id,t.keyType,t.type,t.options,t.comment)},a.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:undefined])},a.prototype.resolve=function(){if(this.resolved)return this;if(i.mapKey[this.keyType]===undefined)throw Error("invalid key type: "+this.keyType);return r.prototype.resolve.call(this)},a.d=function(e,t,n){return"function"==typeof n?n=o.decorateType(n).name:n&&"object"==typeof n&&(n=o.decorateEnum(n).name),function(r,i){o.decorateType(r.constructor).add(new a(i,e,t,n))}}},{15:15,32:32,33:33}],19:[function(e,t,n){t.exports=i;var r=e(35);function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)this[t[n]]=e[t[n]]}i.create=function(e){return this.$type.create(e)},i.encode=function(e,t){return this.$type.encode(e,t)},i.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)},i.decode=function(e){return this.$type.decode(e)},i.decodeDelimited=function(e){return this.$type.decodeDelimited(e)},i.verify=function(e){return this.$type.verify(e)},i.fromObject=function(e){return this.$type.fromObject(e)},i.toObject=function(e,t){return this.$type.toObject(e,t)},i.prototype.toJSON=function(){return this.$type.toObject(this,r.toJSONOptions)}},{35:35}],20:[function(e,t,n){t.exports=o;var r=e(22);((o.prototype=Object.create(r.prototype)).constructor=o).className="Method";var i=e(33);function o(e,t,n,o,a,s,c,u){if(i.isObject(a)?(c=a,a=s=undefined):i.isObject(s)&&(c=s,s=undefined),t!==undefined&&!i.isString(t))throw TypeError("type must be a string");if(!i.isString(n))throw TypeError("requestType must be a string");if(!i.isString(o))throw TypeError("responseType must be a string");r.call(this,e,c),this.type=t||"rpc",this.requestType=n,this.requestStream=!!a||undefined,this.responseType=o,this.responseStream=!!s||undefined,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=u}o.fromJSON=function(e,t){return new o(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment)},o.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return i.toObject(["type","rpc"!==this.type&&this.type||undefined,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:undefined])},o.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),r.prototype.resolve.call(this))}},{22:22,33:33}],21:[function(e,t,n){t.exports=d;var r=e(22);((d.prototype=Object.create(r.prototype)).constructor=d).className="Namespace";var i,o,a,s=e(15),c=e(33);function u(e,t){if(!e||!e.length)return undefined;for(var n={},r=0;r<e.length;++r)n[e[r].name]=e[r].toJSON(t);return n}function d(e,t){r.call(this,e,t),this.nested=undefined,this._nestedArray=null}function l(e){return e._nestedArray=null,e}d.fromJSON=function(e,t){return new d(e,t.options).addJSON(t.nested)},d.arrayToJSON=u,d.isReservedId=function(e,t){if(e)for(var n=0;n<e.length;++n)if("string"!=typeof e[n]&&e[n][0]<=t&&e[n][1]>t)return!0;return!1},d.isReservedName=function(e,t){if(e)for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1},Object.defineProperty(d.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=c.toArray(this.nested))}}),d.prototype.toJSON=function(e){return c.toObject(["options",this.options,"nested",u(this.nestedArray,e)])},d.prototype.addJSON=function(e){if(e)for(var t,n=Object.keys(e),r=0;r<n.length;++r)t=e[n[r]],this.add((t.fields!==undefined?i.fromJSON:t.values!==undefined?a.fromJSON:t.methods!==undefined?o.fromJSON:t.id!==undefined?s.fromJSON:d.fromJSON)(n[r],t));return this},d.prototype.get=function(e){return this.nested&&this.nested[e]||null},d.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof a)return this.nested[e].values;throw Error("no such enum: "+e)},d.prototype.add=function(e){if(!(e instanceof s&&e.extend!==undefined||e instanceof i||e instanceof a||e instanceof o||e instanceof d))throw TypeError("object must be a valid nested object");if(this.nested){var t=this.get(e.name);if(t){if(!(t instanceof d&&e instanceof d)||t instanceof i||t instanceof o)throw Error("duplicate name '"+e.name+"' in "+this);for(var n=t.nestedArray,r=0;r<n.length;++r)e.add(n[r]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}}else this.nested={};return this.nested[e.name]=e,e.onAdd(this),l(this)},d.prototype.remove=function(e){if(!(e instanceof r))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=undefined),e.onRemove(this),l(this)},d.prototype.define=function(e,t){if(c.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&""===e[0])throw Error("path must be relative");for(var n=this;e.length>0;){var r=e.shift();if(n.nested&&n.nested[r]){if(!((n=n.nested[r])instanceof d))throw Error("path conflicts with non-namespace objects")}else n.add(n=new d(r))}return t&&n.addJSON(t),n},d.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof d?e[t++].resolveAll():e[t++].resolve();return this.resolve()},d.prototype.lookup=function(e,t,n){if("boolean"==typeof t?(n=t,t=undefined):t&&!Array.isArray(t)&&(t=[t]),c.isString(e)&&e.length){if("."===e)return this.root;e=e.split(".")}else if(!e.length)return this;if(""===e[0])return this.root.lookup(e.slice(1),t);var r=this.get(e[0]);if(r){if(1===e.length){if(!t||t.indexOf(r.constructor)>-1)return r}else if(r instanceof d&&(r=r.lookup(e.slice(1),t,!0)))return r}else for(var i=0;i<this.nestedArray.length;++i)if(this._nestedArray[i]instanceof d&&(r=this._nestedArray[i].lookup(e,t,!0)))return r;return null===this.parent||n?null:this.parent.lookup(e,t)},d.prototype.lookupType=function(e){var t=this.lookup(e,[i]);if(!t)throw Error("no such type: "+e);return t},d.prototype.lookupEnum=function(e){var t=this.lookup(e,[a]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t},d.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[i,a]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t},d.prototype.lookupService=function(e){var t=this.lookup(e,[o]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t},d._configure=function(e,t,n){i=e,o=t,a=n}},{15:15,22:22,33:33}],22:[function(e,t,n){t.exports=o,o.className="ReflectionObject";var r,i=e(33);function o(e,t){if(!i.isString(e))throw TypeError("name must be a string");if(t&&!i.isObject(t))throw TypeError("options must be an object");this.options=t,this.parsedOptions=null,this.name=e,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(o.prototype,{root:{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}},fullName:{get:function(){for(var e=[this.name],t=this.parent;t;)e.unshift(t.name),t=t.parent;return e.join(".")}}}),o.prototype.toJSON=function(){throw Error()},o.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof r&&t._handleAdd(this)},o.prototype.onRemove=function(e){var t=e.root;t instanceof r&&t._handleRemove(this),this.parent=null,this.resolved=!1},o.prototype.resolve=function(){return this.resolved||this.root instanceof r&&(this.resolved=!0),this},o.prototype.getOption=function(e){return this.options?this.options[e]:undefined},o.prototype.setOption=function(e,t,n){return n&&this.options&&this.options[e]!==undefined||((this.options||(this.options={}))[e]=t),this},o.prototype.setParsedOption=function(e,t,n){this.parsedOptions||(this.parsedOptions=[]);var r=this.parsedOptions;if(n){var o=r.find((function(t){return Object.prototype.hasOwnProperty.call(t,e)}));if(o){var a=o[e];i.setProperty(a,n,t)}else(o={})[e]=i.setProperty({},n,t),r.push(o)}else{var s={};s[e]=t,r.push(s)}return this},o.prototype.setOptions=function(e,t){if(e)for(var n=Object.keys(e),r=0;r<n.length;++r)this.setOption(n[r],e[n[r]],t);return this},o.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e},o._configure=function(e){r=e}},{33:33}],23:[function(e,t,n){t.exports=a;var r=e(22);((a.prototype=Object.create(r.prototype)).constructor=a).className="OneOf";var i=e(15),o=e(33);function a(e,t,n,i){if(Array.isArray(t)||(n=t,t=undefined),r.call(this,e,n),t!==undefined&&!Array.isArray(t))throw TypeError("fieldNames must be an Array");this.oneof=t||[],this.fieldsArray=[],this.comment=i}function s(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)e.fieldsArray[t].parent||e.parent.add(e.fieldsArray[t])}a.fromJSON=function(e,t){return new a(e,t.oneof,t.options,t.comment)},a.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:undefined])},a.prototype.add=function(e){if(!(e instanceof i))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,s(this),this},a.prototype.remove=function(e){if(!(e instanceof i))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),(t=this.oneof.indexOf(e.name))>-1&&this.oneof.splice(t,1),e.partOf=null,this},a.prototype.onAdd=function(e){r.prototype.onAdd.call(this,e);for(var t=0;t<this.oneof.length;++t){var n=e.get(this.oneof[t]);n&&!n.partOf&&(n.partOf=this,this.fieldsArray.push(n))}s(this)},a.prototype.onRemove=function(e){for(var t,n=0;n<this.fieldsArray.length;++n)(t=this.fieldsArray[n]).parent&&t.parent.remove(t);r.prototype.onRemove.call(this,e)},a.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(t,n){o.decorateType(t.constructor).add(new a(n,e)),Object.defineProperty(t,n,{get:o.oneOfGetter(e),set:o.oneOfSetter(e)})}}},{15:15,22:22,33:33}],24:[function(e,t,n){t.exports=c;var r,i=e(35),o=i.LongBits,a=i.utf8;function s(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var u,d="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},l=function(){return i.Buffer?function(e){return(c.create=function(e){return i.Buffer.isBuffer(e)?new r(e):d(e)})(e)}:d};function f(){var e=new o(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw s(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw s(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function p(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function h(){if(this.pos+8>this.len)throw s(this,8);return new o(p(this.buf,this.pos+=4),p(this.buf,this.pos+=4))}c.create=l(),c.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,c.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return u;if((this.pos+=5)>this.len)throw this.pos=this.len,s(this,10);return u}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw s(this,4);return p(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw s(this,4);return 0|p(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw s(this,4);var e=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw s(this,4);var e=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw s(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},c.prototype.string=function(){var e=this.bytes();return a.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw s(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw s(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){r=e,c.create=l(),r._configure();var t=i.Long?"toLong":"toNumber";i.merge(c.prototype,{int64:function(){return f.call(this)[t](!1)},uint64:function(){return f.call(this)[t](!0)},sint64:function(){return f.call(this).zzDecode()[t](!1)},fixed64:function(){return h.call(this)[t](!0)},sfixed64:function(){return h.call(this)[t](!1)}})}},{35:35}],25:[function(e,t,n){t.exports=o;var r=e(24);(o.prototype=Object.create(r.prototype)).constructor=o;var i=e(35);function o(e){r.call(this,e)}o._configure=function(){i.Buffer&&(o.prototype._slice=i.Buffer.prototype.slice)},o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},o._configure()},{24:24,35:35}],26:[function(e,t,n){t.exports=l;var r=e(21);((l.prototype=Object.create(r.prototype)).constructor=l).className="Root";var i,o,a,s=e(15),c=e(14),u=e(23),d=e(33);function l(e){r.call(this,"",e),this.deferred=[],this.files=[]}function f(){}l.fromJSON=function(e,t){return t||(t=new l),e.options&&t.setOptions(e.options),t.addJSON(e.nested)},l.prototype.resolvePath=d.path.resolve,l.prototype.fetch=d.fetch,l.prototype.load=function e(t,n,r){"function"==typeof n&&(r=n,n=undefined);var i=this;if(!r)return d.asPromise(e,i,t,n);var s=r===f;function c(e,t){if(r){var n=r;if(r=null,s)throw e;n(e,t)}}function u(e){var t=e.lastIndexOf("google/protobuf/");if(t>-1){var n=e.substring(t);if(n in a)return n}return null}function l(e,t){try{if(d.isString(t)&&"{"===t.charAt(0)&&(t=JSON.parse(t)),d.isString(t)){o.filename=e;var r,a=o(t,i,n),l=0;if(a.imports)for(;l<a.imports.length;++l)(r=u(a.imports[l])||i.resolvePath(e,a.imports[l]))&&p(r);if(a.weakImports)for(l=0;l<a.weakImports.length;++l)(r=u(a.weakImports[l])||i.resolvePath(e,a.weakImports[l]))&&p(r,!0)}else i.setOptions(t.options).addJSON(t.nested)}catch(e){c(e)}s||h||c(null,i)}function p(e,t){if(!(i.files.indexOf(e)>-1))if(i.files.push(e),e in a)s?l(e,a[e]):(++h,setTimeout((function(){--h,l(e,a[e])})));else if(s){var n;try{n=d.fs.readFileSync(e).toString("utf8")}catch(e){return void(t||c(e))}l(e,n)}else++h,i.fetch(e,(function(n,o){--h,r&&(n?t?h||c(null,i):c(n):l(e,o))}))}var h=0;d.isString(t)&&(t=[t]);for(var m,g=0;g<t.length;++g)(m=i.resolvePath("",t[g]))&&p(m);return s?i:(h||c(null,i),undefined)},l.prototype.loadSync=function(e,t){if(!d.isNode)throw Error("not supported");return this.load(e,t,f)},l.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map((function(e){return"'extend "+e.extend+"' in "+e.parent.fullName})).join(", "));return r.prototype.resolveAll.call(this)};var p=/^[A-Z]/;function h(e,t){var n=t.parent.lookup(t.extend);if(n){var r=new s(t.fullName,t.id,t.type,t.rule,undefined,t.options);return r.declaringField=t,t.extensionField=r,n.add(r),!0}return!1}l.prototype._handleAdd=function(e){if(e instanceof s)e.extend===undefined||e.extensionField||h(0,e)||this.deferred.push(e);else if(e instanceof c)p.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof u)){if(e instanceof i)for(var t=0;t<this.deferred.length;)h(0,this.deferred[t])?this.deferred.splice(t,1):++t;for(var n=0;n<e.nestedArray.length;++n)this._handleAdd(e._nestedArray[n]);p.test(e.name)&&(e.parent[e.name]=e)}},l.prototype._handleRemove=function(e){if(e instanceof s){if(e.extend!==undefined)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof c)p.test(e.name)&&delete e.parent[e.name];else if(e instanceof r){for(var n=0;n<e.nestedArray.length;++n)this._handleRemove(e._nestedArray[n]);p.test(e.name)&&delete e.parent[e.name]}},l._configure=function(e,t,n){i=e,o=t,a=n}},{14:14,15:15,21:21,23:23,33:33}],27:[function(e,t,n){t.exports={}},{}],28:[function(e,t,n){n.Service=e(29)},{29:29}],29:[function(e,t,n){t.exports=i;var r=e(35);function i(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(i.prototype=Object.create(r.EventEmitter.prototype)).constructor=i,i.prototype.rpcCall=function e(t,n,i,o,a){if(!o)throw TypeError("request must be specified");var s=this;if(!a)return r.asPromise(e,s,t,n,i,o);if(!s.rpcImpl)return setTimeout((function(){a(Error("already ended"))}),0),undefined;try{return s.rpcImpl(t,n[s.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,n){if(e)return s.emit("error",e,t),a(e);if(null===n)return s.end(!0),undefined;if(!(n instanceof i))try{n=i[s.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return s.emit("error",e,t),a(e)}return s.emit("data",n,t),a(null,n)}))}catch(e){return s.emit("error",e,t),setTimeout((function(){a(e)}),0),undefined}},i.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},{35:35}],30:[function(e,t,n){t.exports=s;var r=e(21);((s.prototype=Object.create(r.prototype)).constructor=s).className="Service";var i=e(20),o=e(33),a=e(28);function s(e,t){r.call(this,e,t),this.methods={},this._methodsArray=null}function c(e){return e._methodsArray=null,e}s.fromJSON=function(e,t){var n=new s(e,t.options);if(t.methods)for(var r=Object.keys(t.methods),o=0;o<r.length;++o)n.add(i.fromJSON(r[o],t.methods[r[o]]));return t.nested&&n.addJSON(t.nested),n.comment=t.comment,n},s.prototype.toJSON=function(e){var t=r.prototype.toJSON.call(this,e),n=!!e&&Boolean(e.keepComments);return o.toObject(["options",t&&t.options||undefined,"methods",r.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||undefined,"comment",n?this.comment:undefined])},Object.defineProperty(s.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=o.toArray(this.methods))}}),s.prototype.get=function(e){return this.methods[e]||r.prototype.get.call(this,e)},s.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return r.prototype.resolve.call(this)},s.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof i?(this.methods[e.name]=e,e.parent=this,c(this)):r.prototype.add.call(this,e)},s.prototype.remove=function(e){if(e instanceof i){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,c(this)}return r.prototype.remove.call(this,e)},s.prototype.create=function(e,t,n){for(var r,i=new a.Service(e,t,n),s=0;s<this.methodsArray.length;++s){var c=o.lcFirst((r=this._methodsArray[s]).resolve().name).replace(/[^$\w_]/g,"");i[c]=o.codegen(["r","c"],o.isReserved(c)?c+"_":c)("return this.rpcCall(m,q,s,r,c)")({m:r,q:r.resolvedRequestType.ctor,s:r.resolvedResponseType.ctor})}return i}},{20:20,21:21,28:28,33:33}],31:[function(e,t,n){t.exports=y;var r=e(21);((y.prototype=Object.create(r.prototype)).constructor=y).className="Type";var i=e(14),o=e(23),a=e(15),s=e(18),c=e(30),u=e(19),d=e(24),l=e(38),f=e(33),p=e(13),h=e(12),m=e(36),g=e(11),v=e(37);function y(e,t){r.call(this,e,t),this.fields={},this.oneofs=undefined,this.extensions=undefined,this.reserved=undefined,this.group=undefined,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function b(e){return e._fieldsById=e._fieldsArray=e._oneofsArray=null,delete e.encode,delete e.decode,delete e.verify,e}Object.defineProperties(y.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var n=this.fields[e[t]],r=n.id;if(this._fieldsById[r])throw Error("duplicate id "+r+" in "+this);this._fieldsById[r]=n}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=f.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=f.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=y.generateConstructor(this)())},set:function(e){var t=e.prototype;t instanceof u||((e.prototype=new u).constructor=e,f.merge(e.prototype,t)),e.$type=e.prototype.$type=this,f.merge(e,u,!0),this._ctor=e;for(var n=0;n<this.fieldsArray.length;++n)this._fieldsArray[n].resolve();var r={};for(n=0;n<this.oneofsArray.length;++n)r[this._oneofsArray[n].resolve().name]={get:f.oneOfGetter(this._oneofsArray[n].oneof),set:f.oneOfSetter(this._oneofsArray[n].oneof)};n&&Object.defineProperties(e.prototype,r)}}}),y.generateConstructor=function(e){for(var t,n=f.codegen(["p"],e.name),r=0;r<e.fieldsArray.length;++r)(t=e._fieldsArray[r]).map?n("this%s={}",f.safeProp(t.name)):t.repeated&&n("this%s=[]",f.safeProp(t.name));return n("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},y.fromJSON=function(e,t){var n=new y(e,t.options);n.extensions=t.extensions,n.reserved=t.reserved;for(var u=Object.keys(t.fields),d=0;d<u.length;++d)n.add((void 0!==t.fields[u[d]].keyType?s.fromJSON:a.fromJSON)(u[d],t.fields[u[d]]));if(t.oneofs)for(u=Object.keys(t.oneofs),d=0;d<u.length;++d)n.add(o.fromJSON(u[d],t.oneofs[u[d]]));if(t.nested)for(u=Object.keys(t.nested),d=0;d<u.length;++d){var l=t.nested[u[d]];n.add((l.id!==undefined?a.fromJSON:l.fields!==undefined?y.fromJSON:l.values!==undefined?i.fromJSON:l.methods!==undefined?c.fromJSON:r.fromJSON)(u[d],l))}return t.extensions&&t.extensions.length&&(n.extensions=t.extensions),t.reserved&&t.reserved.length&&(n.reserved=t.reserved),t.group&&(n.group=!0),t.comment&&(n.comment=t.comment),n},y.prototype.toJSON=function(e){var t=r.prototype.toJSON.call(this,e),n=!!e&&Boolean(e.keepComments);return f.toObject(["options",t&&t.options||undefined,"oneofs",r.arrayToJSON(this.oneofsArray,e),"fields",r.arrayToJSON(this.fieldsArray.filter((function(e){return!e.declaringField})),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:undefined,"reserved",this.reserved&&this.reserved.length?this.reserved:undefined,"group",this.group||undefined,"nested",t&&t.nested||undefined,"comment",n?this.comment:undefined])},y.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var n=this.oneofsArray;for(t=0;t<n.length;)n[t++].resolve();return r.prototype.resolveAll.call(this)},y.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null},y.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof a&&e.extend===undefined){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),b(this)}return e instanceof o?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),b(this)):r.prototype.add.call(this,e)},y.prototype.remove=function(e){if(e instanceof a&&e.extend===undefined){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),b(this)}if(e instanceof o){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),b(this)}return r.prototype.remove.call(this,e)},y.prototype.isReservedId=function(e){return r.isReservedId(this.reserved,e)},y.prototype.isReservedName=function(e){return r.isReservedName(this.reserved,e)},y.prototype.create=function(e){return new this.ctor(e)},y.prototype.setup=function(){for(var e=this.fullName,t=[],n=0;n<this.fieldsArray.length;++n)t.push(this._fieldsArray[n].resolve().resolvedType);this.encode=p(this)({Writer:l,types:t,util:f}),this.decode=h(this)({Reader:d,types:t,util:f}),this.verify=m(this)({types:t,util:f}),this.fromObject=g.fromObject(this)({types:t,util:f}),this.toObject=g.toObject(this)({types:t,util:f});var r=v[e];if(r){var i=Object.create(this);i.fromObject=this.fromObject,this.fromObject=r.fromObject.bind(i),i.toObject=this.toObject,this.toObject=r.toObject.bind(i)}return this},y.prototype.encode=function(e,t){return this.setup().encode(e,t)},y.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()},y.prototype.decode=function(e,t){return this.setup().decode(e,t)},y.prototype.decodeDelimited=function(e){return e instanceof d||(e=d.create(e)),this.decode(e,e.uint32())},y.prototype.verify=function(e){return this.setup().verify(e)},y.prototype.fromObject=function(e){return this.setup().fromObject(e)},y.prototype.toObject=function(e,t){return this.setup().toObject(e,t)},y.d=function(e){return function(t){f.decorateType(t,e)}}},{11:11,12:12,13:13,14:14,15:15,18:18,19:19,21:21,23:23,24:24,30:30,33:33,36:36,37:37,38:38}],32:[function(e,t,n){var r=n,i=e(33),o=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function a(e,t){var n=0,r={};for(t|=0;n<e.length;)r[o[n+t]]=e[n++];return r}r.basic=a([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),r.defaults=a([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",i.emptyArray,null]),r.long=a([0,0,0,1,1],7),r.mapKey=a([0,0,0,5,5,0,0,0,1,1,0,2],2),r.packed=a([1,5,0,0,0,5,5,0,0,0,1,1,0])},{33:33}],33:[function(e,t,n){var r,i,o=t.exports=e(35),a=e(27);o.codegen=e(3),o.fetch=e(5),o.path=e(8),o.fs=o.inquire("fs"),o.toArray=function(e){if(e){for(var t=Object.keys(e),n=new Array(t.length),r=0;r<t.length;)n[r]=e[t[r++]];return n}return[]},o.toObject=function(e){for(var t={},n=0;n<e.length;){var r=e[n++],i=e[n++];i!==undefined&&(t[r]=i)}return t};var s=/\\/g,c=/"/g;o.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)},o.safeProp=function(e){return!/^[$\w_]+$/.test(e)||o.isReserved(e)?'["'+e.replace(s,"\\\\").replace(c,'\\"')+'"]':"."+e},o.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var u=/_([a-z])/g;o.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(u,(function(e,t){return t.toUpperCase()}))},o.compareFieldsById=function(e,t){return e.id-t.id},o.decorateType=function(t,n){if(t.$type)return n&&t.$type.name!==n&&(o.decorateRoot.remove(t.$type),t.$type.name=n,o.decorateRoot.add(t.$type)),t.$type;r||(r=e(31));var i=new r(n||t.name);return o.decorateRoot.add(i),i.ctor=t,Object.defineProperty(t,"$type",{value:i,enumerable:!1}),Object.defineProperty(t.prototype,"$type",{value:i,enumerable:!1}),i};var d=0;o.decorateEnum=function(t){if(t.$type)return t.$type;i||(i=e(14));var n=new i("Enum"+d++,t);return o.decorateRoot.add(n),Object.defineProperty(t,"$type",{value:n,enumerable:!1}),n},o.setProperty=function(e,t,n){if("object"!=typeof e)throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return function e(t,n,r){var i=n.shift();if(n.length>0)t[i]=e(t[i]||{},n,r);else{var o=t[i];o&&(r=[].concat(o).concat(r)),t[i]=r}return t}(e,t=t.split("."),n)},Object.defineProperty(o,"decorateRoot",{get:function(){return a.decorated||(a.decorated=new(e(26)))}})},{14:14,26:26,27:27,3:3,31:31,35:35,5:5,8:8}],34:[function(e,t,n){t.exports=i;var r=e(35);function i(e,t){this.lo=e>>>0,this.hi=t>>>0}var o=i.zero=new i(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var a=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(e){if(0===e)return o;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new i(n,r)},i.from=function(e){if("number"==typeof e)return i.fromNumber(e);if(r.isString(e)){if(!r.Long)return i.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new i(e.low>>>0,e.high>>>0):o},i.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var s=String.prototype.charCodeAt;i.fromHash=function(e){return e===a?o:new i((s.call(e,0)|s.call(e,1)<<8|s.call(e,2)<<16|s.call(e,3)<<24)>>>0,(s.call(e,4)|s.call(e,5)<<8|s.call(e,6)<<16|s.call(e,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},i.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},i.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},{35:35}],35:[function(e,t,n){var r=n;function i(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;++i)e[r[i]]!==undefined&&n||(e[r[i]]=t[r[i]]);return e}function o(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&i(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}r.asPromise=e(1),r.base64=e(2),r.EventEmitter=e(4),r.float=e(6),r.inquire=e(7),r.utf8=e(10),r.pool=e(9),r.LongBits=e(34),r.isNode=Boolean(void 0!==global&&global&&global.process&&global.process.versions&&global.process.versions.node),r.global=r.isNode&&global||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"==typeof e||e instanceof String},r.isObject=function(e){return e&&"object"==typeof e},r.isset=r.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"==typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var n=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},r.merge=i,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=o,r.ProtocolError=o("ProtocolError"),r.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&this[e[n]]!==undefined&&null!==this[e[n]])return e[n]}},r.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;e?(r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):r._Buffer_from=r._Buffer_allocUnsafe=null}},{1:1,10:10,2:2,34:34,4:4,6:6,7:7,9:9}],36:[function(e,t,n){t.exports=function(e){var t=i.codegen(["m"],e.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),n={};e.oneofsArray.length&&t("var p={}");for(var r=0;r<e.fieldsArray.length;++r){var c=e._fieldsArray[r].resolve(),u="m"+i.safeProp(c.name);if(c.optional&&t("if(%s!=null&&m.hasOwnProperty(%j)){",u,c.name),c.map)t("if(!util.isObject(%s))",u)("return%j",o(c,"object"))("var k=Object.keys(%s)",u)("for(var i=0;i<k.length;++i){"),s(t,c,"k[i]"),a(t,c,r,u+"[k[i]]")("}");else if(c.repeated)t("if(!Array.isArray(%s))",u)("return%j",o(c,"array"))("for(var i=0;i<%s.length;++i){",u),a(t,c,r,u+"[i]")("}");else{if(c.partOf){var d=i.safeProp(c.partOf.name);1===n[c.partOf.name]&&t("if(p%s===1)",d)("return%j",c.partOf.name+": multiple values"),n[c.partOf.name]=1,t("p%s=1",d)}a(t,c,r,u)}c.optional&&t("}")}return t("return null")};var r=e(14),i=e(33);function o(e,t){return e.name+": "+t+(e.repeated&&"array"!==t?"[]":e.map&&"object"!==t?"{k:"+e.keyType+"}":"")+" expected"}function a(e,t,n,i){if(t.resolvedType)if(t.resolvedType instanceof r){e("switch(%s){",i)("default:")("return%j",o(t,"enum value"));for(var a=Object.keys(t.resolvedType.values),s=0;s<a.length;++s)e("case %i:",t.resolvedType.values[a[s]]);e("break")("}")}else e("{")("var e=types[%i].verify(%s);",n,i)("if(e)")("return%j+e",t.name+".")("}");else switch(t.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.isInteger(%s))",i)("return%j",o(t,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",i,i,i,i)("return%j",o(t,"integer|Long"));break;case"float":case"double":e('if(typeof %s!=="number")',i)("return%j",o(t,"number"));break;case"bool":e('if(typeof %s!=="boolean")',i)("return%j",o(t,"boolean"));break;case"string":e("if(!util.isString(%s))",i)("return%j",o(t,"string"));break;case"bytes":e('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',i,i,i)("return%j",o(t,"buffer"))}return e}function s(e,t,n){switch(t.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.key32Re.test(%s))",n)("return%j",o(t,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.key64Re.test(%s))",n)("return%j",o(t,"integer|Long key"));break;case"bool":e("if(!util.key2Re.test(%s))",n)("return%j",o(t,"boolean key"))}return e}},{14:14,33:33}],37:[function(e,t,n){var r=n,i=e(19);r[".google.protobuf.Any"]={fromObject:function(e){if(e&&e["@type"]){var t=e["@type"].substring(e["@type"].lastIndexOf("/")+1),n=this.lookup(t);if(n){var r="."===e["@type"].charAt(0)?e["@type"].substr(1):e["@type"];return-1===r.indexOf("/")&&(r="/"+r),this.create({type_url:r,value:n.encode(n.fromObject(e)).finish()})}}return this.fromObject(e)},toObject:function(e,t){var n="",r="";if(t&&t.json&&e.type_url&&e.value){r=e.type_url.substring(e.type_url.lastIndexOf("/")+1),n=e.type_url.substring(0,e.type_url.lastIndexOf("/")+1);var o=this.lookup(r);o&&(e=o.decode(e.value))}if(!(e instanceof this.ctor)&&e instanceof i){var a=e.$type.toObject(e,t);return""===n&&(n="type.googleapis.com/"),r=n+("."===e.$type.fullName[0]?e.$type.fullName.substr(1):e.$type.fullName),a["@type"]=r,a}return this.toObject(e,t)}}},{19:19}],38:[function(e,t,n){t.exports=l;var r,i=e(35),o=i.LongBits,a=i.base64,s=i.utf8;function c(e,t,n){this.fn=e,this.len=t,this.next=undefined,this.val=n}function u(){}function d(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function l(){this.len=0,this.head=new c(u,0,0),this.tail=this.head,this.states=null}var f=function(){return i.Buffer?function(){return(l.create=function(){return new r})()}:function(){return new l}};function p(e,t,n){t[n]=255&e}function h(e,t){this.len=e,this.next=undefined,this.val=t}function m(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function g(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}l.create=f(),l.alloc=function(e){return new i.Array(e)},i.Array!==Array&&(l.alloc=i.pool(l.alloc,i.Array.prototype.subarray)),l.prototype._push=function(e,t,n){return this.tail=this.tail.next=new c(e,t,n),this.len+=t,this},h.prototype=Object.create(c.prototype),h.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},l.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new h((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},l.prototype.int32=function(e){return e<0?this._push(m,10,o.fromNumber(e)):this.uint32(e)},l.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},l.prototype.uint64=function(e){var t=o.from(e);return this._push(m,t.length(),t)},l.prototype.int64=l.prototype.uint64,l.prototype.sint64=function(e){var t=o.from(e).zzEncode();return this._push(m,t.length(),t)},l.prototype.bool=function(e){return this._push(p,1,e?1:0)},l.prototype.fixed32=function(e){return this._push(g,4,e>>>0)},l.prototype.sfixed32=l.prototype.fixed32,l.prototype.fixed64=function(e){var t=o.from(e);return this._push(g,4,t.lo)._push(g,4,t.hi)},l.prototype.sfixed64=l.prototype.fixed64,l.prototype.float=function(e){return this._push(i.float.writeFloatLE,4,e)},l.prototype.double=function(e){return this._push(i.float.writeDoubleLE,8,e)};var v=i.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};l.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(p,1,0);if(i.isString(e)){var n=l.alloc(t=a.length(e));a.decode(e,n,0),e=n}return this.uint32(t)._push(v,t,e)},l.prototype.string=function(e){var t=s.length(e);return t?this.uint32(t)._push(s.write,t,e):this._push(p,1,0)},l.prototype.fork=function(){return this.states=new d(this),this.head=this.tail=new c(u,0,0),this.len=0,this},l.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(u,0,0),this.len=0),this},l.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},l.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},l._configure=function(e){r=e,l.create=f(),r._configure()}},{35:35}],39:[function(e,t,n){t.exports=o;var r=e(38);(o.prototype=Object.create(r.prototype)).constructor=o;var i=e(35);function o(){r.call(this)}function a(e,t,n){e.length<40?i.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}o._configure=function(){o.alloc=i._Buffer_allocUnsafe,o.writeBytesBuffer=i.Buffer&&i.Buffer.prototype instanceof Uint8Array&&"set"===i.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}},o.prototype.bytes=function(e){i.isString(e)&&(e=i._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(o.writeBytesBuffer,t,e),this},o.prototype.string=function(e){var t=i.Buffer.byteLength(e);return this.uint32(t),t&&this._push(a,t,e),this},o._configure()},{35:35,38:38}]},{})}()}).call(this,__webpack_require__(33),__webpack_require__(60)(module))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){e.exports=r;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function r(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function i(e){return!0===(e&&e.__isLong__)}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=i;var o={},a={};function s(e,t){var n,r,i;return t?(i=0<=(e>>>=0)&&e<256)&&(r=a[e])?r:(n=u(e,(0|e)<0?-1:0,!0),i&&(a[e]=n),n):(i=-128<=(e|=0)&&e<128)&&(r=o[e])?r:(n=u(e,e<0?-1:0,!1),i&&(o[e]=n),n)}function c(e,t){if(isNaN(e))return t?y:v;if(t){if(e<0)return y;if(e>=h)return T}else{if(e<=-m)return R;if(e+1>=m)return _}return e<0?c(-e,t).neg():u(e%p|0,e/p|0,t)}function u(e,t,n){return new r(e,t,n)}r.fromInt=s,r.fromNumber=c,r.fromBits=u;var d=Math.pow;function l(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return v;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return l(e.substring(1),t,n).neg();for(var i=c(d(n,8)),o=v,a=0;a<e.length;a+=8){var s=Math.min(8,e.length-a),u=parseInt(e.substring(a,a+s),n);if(s<8){var f=c(d(n,s));o=o.mul(f).add(c(u))}else o=(o=o.mul(i)).add(c(u))}return o.unsigned=t,o}function f(e,t){return"number"==typeof e?c(e,t):"string"==typeof e?l(e,t):u(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}r.fromString=l,r.fromValue=f;var p=4294967296,h=p*p,m=h/2,g=s(1<<24),v=s(0);r.ZERO=v;var y=s(0,!0);r.UZERO=y;var b=s(1);r.ONE=b;var S=s(1,!0);r.UONE=S;var E=s(-1);r.NEG_ONE=E;var _=u(-1,2147483647,!1);r.MAX_VALUE=_;var T=u(-1,-1,!0);r.MAX_UNSIGNED_VALUE=T;var R=u(0,-2147483648,!1);r.MIN_VALUE=R;var I=r.prototype;I.toInt=function(){return this.unsigned?this.low>>>0:this.low},I.toNumber=function(){return this.unsigned?(this.high>>>0)*p+(this.low>>>0):this.high*p+(this.low>>>0)},I.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(R)){var t=c(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=c(d(e,6),this.unsigned),o=this,a="";;){var s=o.div(i),u=(o.sub(s.mul(i)).toInt()>>>0).toString(e);if((o=s).isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}},I.getHighBits=function(){return this.high},I.getHighBitsUnsigned=function(){return this.high>>>0},I.getLowBits=function(){return this.low},I.getLowBitsUnsigned=function(){return this.low>>>0},I.getNumBitsAbs=function(){if(this.isNegative())return this.eq(R)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},I.isZero=function(){return 0===this.high&&0===this.low},I.eqz=I.isZero,I.isNegative=function(){return!this.unsigned&&this.high<0},I.isPositive=function(){return this.unsigned||this.high>=0},I.isOdd=function(){return 1==(1&this.low)},I.isEven=function(){return 0==(1&this.low)},I.equals=function(e){return i(e)||(e=f(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},I.eq=I.equals,I.notEquals=function(e){return!this.eq(e)},I.neq=I.notEquals,I.ne=I.notEquals,I.lessThan=function(e){return this.comp(e)<0},I.lt=I.lessThan,I.lessThanOrEqual=function(e){return this.comp(e)<=0},I.lte=I.lessThanOrEqual,I.le=I.lessThanOrEqual,I.greaterThan=function(e){return this.comp(e)>0},I.gt=I.greaterThan,I.greaterThanOrEqual=function(e){return this.comp(e)>=0},I.gte=I.greaterThanOrEqual,I.ge=I.greaterThanOrEqual,I.compare=function(e){if(i(e)||(e=f(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},I.comp=I.compare,I.negate=function(){return!this.unsigned&&this.eq(R)?R:this.not().add(b)},I.neg=I.negate,I.add=function(e){i(e)||(e=f(e));var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,o=65535&this.low,a=e.high>>>16,s=65535&e.high,c=e.low>>>16,d=0,l=0,p=0,h=0;return p+=(h+=o+(65535&e.low))>>>16,l+=(p+=r+c)>>>16,d+=(l+=n+s)>>>16,d+=t+a,u((p&=65535)<<16|(h&=65535),(d&=65535)<<16|(l&=65535),this.unsigned)},I.subtract=function(e){return i(e)||(e=f(e)),this.add(e.neg())},I.sub=I.subtract,I.multiply=function(e){if(this.isZero())return v;if(i(e)||(e=f(e)),n)return u(n.mul(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned);if(e.isZero())return v;if(this.eq(R))return e.isOdd()?R:v;if(e.eq(R))return this.isOdd()?R:v;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(g)&&e.lt(g))return c(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,r=65535&this.high,o=this.low>>>16,a=65535&this.low,s=e.high>>>16,d=65535&e.high,l=e.low>>>16,p=65535&e.low,h=0,m=0,y=0,b=0;return y+=(b+=a*p)>>>16,m+=(y+=o*p)>>>16,y&=65535,m+=(y+=a*l)>>>16,h+=(m+=r*p)>>>16,m&=65535,h+=(m+=o*l)>>>16,m&=65535,h+=(m+=a*d)>>>16,h+=t*p+r*l+o*d+a*s,u((y&=65535)<<16|(b&=65535),(h&=65535)<<16|(m&=65535),this.unsigned)},I.mul=I.multiply,I.divide=function(e){if(i(e)||(e=f(e)),e.isZero())throw Error("division by zero");var t,r,o;if(n)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?u((this.unsigned?n.div_u:n.div_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?y:v;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return y;if(e.gt(this.shru(1)))return S;o=y}else{if(this.eq(R))return e.eq(b)||e.eq(E)?R:e.eq(R)?b:(t=this.shr(1).div(e).shl(1)).eq(v)?e.isNegative()?b:E:(r=this.sub(e.mul(t)),o=t.add(r.div(e)));if(e.eq(R))return this.unsigned?y:v;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=v}for(r=this;r.gte(e);){t=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(t)/Math.LN2),s=a<=48?1:d(2,a-48),l=c(t),p=l.mul(e);p.isNegative()||p.gt(r);)p=(l=c(t-=s,this.unsigned)).mul(e);l.isZero()&&(l=b),o=o.add(l),r=r.sub(p)}return o},I.div=I.divide,I.modulo=function(e){return i(e)||(e=f(e)),n?u((this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},I.mod=I.modulo,I.rem=I.modulo,I.not=function(){return u(~this.low,~this.high,this.unsigned)},I.and=function(e){return i(e)||(e=f(e)),u(this.low&e.low,this.high&e.high,this.unsigned)},I.or=function(e){return i(e)||(e=f(e)),u(this.low|e.low,this.high|e.high,this.unsigned)},I.xor=function(e){return i(e)||(e=f(e)),u(this.low^e.low,this.high^e.high,this.unsigned)},I.shiftLeft=function(e){return i(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u(0,this.low<<e-32,this.unsigned)},I.shl=I.shiftLeft,I.shiftRight=function(e){return i(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},I.shr=I.shiftRight,I.shiftRightUnsigned=function(e){if(i(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return e<32?u(this.low>>>e|t<<32-e,t>>>e,this.unsigned):u(32===e?t:t>>>e-32,0,this.unsigned)},I.shru=I.shiftRightUnsigned,I.shr_u=I.shiftRightUnsigned,I.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},I.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},I.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},I.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},I.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},r.fromBytes=function(e,t,n){return n?r.fromBytesLE(e,t):r.fromBytesBE(e,t)},r.fromBytesLE=function(e,t){return new r(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},r.fromBytesBE=function(e,t){return new r(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},function(e){e.exports=JSON.parse('{"PeerPublishStatus":408,"JoinChannelTimeout":407,"OnUpdateStream":356,"OnRemoveStream":355,"OnAddVideoStream":353,"OnAddAudioStream":352,"FirstAudioDecode":351,"FirstVideoDecode":350,"FirstAudioReceived":349,"FirstVideoReceived":348,"ReqUserAccount":196,"ApiInvoke":41,"RequestProxyWorkerManager":36,"RequestProxyAppCenter":35,"VideoSendingStopped":34,"AudioSendingStopped":33,"StreamSwitch":32,"FirstFrame":31,"Publish":30,"Subscribe":29,"JoinGateway":28,"JoinChooseServer":27,"Session":26,"APWorkerEvent":160,"WorkerEvent":156,"JoinWebProxyAP":700,"WebSocketQuit":671}')},function(e){e.exports=JSON.parse('{"nested":{"protobuf":{"nested":{"Session":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"version":{"type":"string","id":11},"browser":{"type":"string","id":12},"appid":{"type":"string","id":13},"mode":{"type":"string","id":14},"extend":{"type":"string","id":15},"process":{"type":"string","id":16},"build":{"type":"string","id":17},"ipv6":{"type":"string","id":18},"sourceHost":{"type":"string","id":19},"sourcePath":{"type":"string","id":20},"collectorHost":{"type":"string","id":21},"collectorName":{"type":"string","id":22}}},"JoinChooseServer":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"chooseServerAddr":{"type":"string","id":11},"chooseServerAddrList":{"type":"string","id":12},"errorCode":{"type":"string","id":13},"eventElapse":{"type":"int64","id":14},"chooseServerIp":{"type":"string","id":15}}},"JoinGateway":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"gatewayAddr":{"type":"string","id":11},"errorCode":{"type":"string","id":12},"eventElapse":{"type":"int64","id":13},"firstSuccess":{"type":"bool","id":14}}},"Subscribe":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"localSdp":{"type":"string","id":11},"remoteSdp":{"type":"string","id":12},"extend":{"type":"string","id":13},"errorCode":{"type":"string","id":14},"eventElapse":{"type":"int64","id":15},"video":{"type":"bool","id":16},"audio":{"type":"bool","id":17},"subscribeRequestid":{"type":"int32","id":18},"p2pid":{"type":"int32","id":19}}},"Publish":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"localSdp":{"type":"string","id":11},"remoteSdp":{"type":"string","id":12},"extend":{"type":"string","id":13},"errorCode":{"type":"string","id":14},"eventElapse":{"type":"int64","id":15},"videoName":{"type":"string","id":16},"audioName":{"type":"string","id":17},"screenName":{"type":"string","id":18},"video":{"type":"bool","id":19},"audio":{"type":"bool","id":20},"publishRequestid":{"type":"int32","id":21},"p2pid":{"type":"int32","id":22},"screenshare":{"type":"bool","id":23}}},"FirstFrame":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"extend":{"type":"string","id":11},"errorCode":{"type":"string","id":12},"width":{"type":"int64","id":13},"height":{"type":"int64","id":14}}},"StreamSwitch":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"isDual":{"type":"bool","id":11}}},"AudioSendingStopped":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"reason":{"type":"string","id":10},"eventType":{"type":"string","id":11}}},"VideoSendingStopped":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"reason":{"type":"string","id":10},"eventType":{"type":"string","id":11}}},"RequestProxyAppCenter":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"APAddr":{"type":"string","id":11},"workerManagerList":{"type":"string","id":12},"errorCode":{"type":"string","id":13},"eventElapse":{"type":"int64","id":14},"extend":{"type":"string","id":15},"response":{"type":"string","id":16}}},"RequestProxyWorkerManager":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"workerManagerAddr":{"type":"string","id":11},"errorCode":{"type":"string","id":12},"eventElapse":{"type":"int64","id":13},"extend":{"type":"string","id":14},"response":{"type":"string","id":15}}},"ApiInvoke":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"apiName":{"type":"string","id":9},"errorCode":{"type":"string","id":10},"options":{"type":"string","id":11},"execElapse":{"type":"int64","id":12},"execStates":{"type":"string","id":13},"execResult":{"type":"string","id":14},"invokeId":{"type":"int64","id":15}}},"ReqUserAccount":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"eventType":{"type":"string","id":9},"serverAddress":{"type":"string","id":10},"stringUid":{"type":"string","id":11},"errorCode":{"type":"string","id":12},"extend":{"type":"string","id":13}}},"FirstVideoReceived":{"fields":{"lts":{"type":"int64","id":1},"peer":{"type":"int64","id":2},"elapse":{"type":"int64","id":3},"sid":{"type":"string","id":4},"cname":{"type":"string","id":5},"cid":{"type":"int64","id":6},"uid":{"type":"int64","id":8},"subscribeRequestid":{"type":"int32","id":9},"p2pid":{"type":"int32","id":10},"subscribeElapse":{"type":"int64","id":11}}},"FirstAudioReceived":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":6},"peer":{"type":"int64","id":7},"elapse":{"type":"int64","id":8},"subscribeRequestid":{"type":"int32","id":9},"p2pid":{"type":"int32","id":10},"subscribeElapse":{"type":"int64","id":11}}},"FirstVideoDecode":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":6},"peer":{"type":"int64","id":7},"elapse":{"type":"int64","id":8},"videowidth":{"type":"int32","id":9},"videoheight":{"type":"int32","id":10},"subscribeRequestid":{"type":"int32","id":11},"p2pid":{"type":"int32","id":12},"subscribeElapse":{"type":"int64","id":13}}},"FirstAudioDecode":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":6},"peer":{"type":"int64","id":7},"elapse":{"type":"int64","id":8},"subscribeRequestid":{"type":"int32","id":9},"p2pid":{"type":"int32","id":10},"subscribeElapse":{"type":"int64","id":11}}},"OnAddAudioStream":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":6},"peer":{"type":"int64","id":7}}},"OnAddVideoStream":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":6},"peer":{"type":"int64","id":7}}},"OnRemoveStream":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":6},"peer":{"type":"int64","id":7}}},"OnUpdateStream":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":6},"peer":{"type":"int64","id":7},"audio":{"type":"bool","id":8},"video":{"type":"bool","id":9}}},"JoinChannelTimeout":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":5},"elapse":{"type":"int64","id":6},"timeout":{"type":"int32","id":7}}},"PeerPublishStatus":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":5},"peer":{"type":"int64","id":6},"elapse":{"type":"int64","id":7},"peerPublishDuration":{"type":"int64","id":8},"joinChannelSuccessElapse":{"type":"int64","id":9},"subscribeElapse":{"type":"int64","id":10},"audiotag":{"type":"int32","id":11},"videotag":{"type":"int32","id":12},"screensharetag":{"type":"int32","id":13},"firsttimetag":{"type":"int32","id":14}}},"WebSocketQuit":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":5},"elapse":{"type":"int64","id":6},"succ":{"type":"int32","id":7},"errorCode":{"type":"string","id":8},"ip":{"type":"string","id":9}}},"Message":{"fields":{"id":{"type":"int64","id":1},"msg":{"type":"bytes","id":2}}},"ProtoRaws":{"fields":{"sendTs":{"type":"int64","id":1},"payloads":{"rule":"repeated","type":"Message","id":2},"vid":{"type":"int32","id":3}}},"APWorkerEvent":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"ec":{"type":"int32","id":10},"sc":{"type":"int32","id":11},"serverIp":{"type":"string","id":12},"firstSuccess":{"type":"bool","id":13},"responseTime":{"type":"int32","id":14},"serviceName":{"type":"string","id":15},"responseDetail":{"type":"string","id":16}}},"WorkerEvent":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"command":{"type":"string","id":10},"actionType":{"type":"string","id":11},"url":{"type":"string","id":12},"payload":{"type":"string","id":13},"serverCode":{"type":"int32","id":14},"code":{"type":"int32","id":15},"traceId":{"type":"string","id":16},"workerType":{"type":"int32","id":17},"responseTime":{"type":"int32","id":18},"requestId":{"type":"int64","id":19},"packIndex":{"type":"int32","id":20},"requestByUser":{"type":"bool","id":21},"tid":{"type":"string","id":22}}},"JoinWebProxyAP":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"sucess":{"type":"int32","id":7},"elapse":{"type":"int64","id":8},"eventType":{"type":"string","id":9},"apServerAddr":{"type":"string","id":10},"turnServerAddrList":{"type":"string","id":11},"errorCode":{"type":"string","id":12}}}}}}}')},function(e,t,n){var r=function(e){"use strict";var t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(e,t,n,r){var i=t&&t.prototype instanceof d?t:d,o=Object.create(i.prototype),a=new _(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=b(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var d=c(e,t,n);if("normal"===d.type){if(r=n.done?"completed":"suspendedYield",d.arg===u)continue;return{value:d.arg,done:n.done}}"throw"===d.type&&(r="completed",n.method="throw",n.arg=d.arg)}}}(e,n,a),o}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var u={};function d(){}function l(){}function f(){}var p={};p[i]=function(){return this};var h=Object.getPrototypeOf,m=h&&h(h(T([])));m&&m!==t&&n.call(m,i)&&(p=m);var g=f.prototype=d.prototype=Object.create(p);function v(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function y(e,t){var r;this._invoke=function(i,o){function a(){return new t((function(r,a){!function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var d=u.arg,l=d.value;return l&&"object"==typeof l&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(l).then((function(e){d.value=e,a(d)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}(i,o,r,a)}))}return r=r?r.then(a,a):a()}}function b(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=c(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,u;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function T(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:R}}function R(){return{value:void 0,done:!0}}return l.prototype=g.constructor=f,f.constructor=l,f[a]=l.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===l||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,a in e||(e[a]="GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},v(y.prototype),y.prototype[o]=function(){return this},e.AsyncIterator=y,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new y(s(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},v(g),g[a]="Generator",g[i]=function(){return this},g.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=T,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:T(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="object"==typeof window&&window.RTCPeerConnection,i="object"==typeof window&&window.webkitRTCPeerConnection,o="object"==typeof window&&window.mozRTCPeerConnection;t.createRTCPeerConnection=function(e){var t=r||i||o;return t?new t(e):null}},function(e,t,n){var r;
/*!
 * EventEmitter v5.2.9 - git.io/ee
 * Unlicense - http://unlicense.org/
 * Oliver Caldwell - https://oli.me.uk/
 * @preserve
 */!function(t){"use strict";function i(){}var o=i.prototype,a=t.EventEmitter;function s(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function c(e){return function(){return this[e].apply(this,arguments)}}o.getListeners=function(e){var t,n,r=this._getEvents();if(e instanceof RegExp)for(n in t={},r)r.hasOwnProperty(n)&&e.test(n)&&(t[n]=r[n]);else t=r[e]||(r[e]=[]);return t},o.flattenListeners=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n.push(e[t].listener);return n},o.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&((t={})[e]=n),t||n},o.addListener=function(e,t){if(!function e(t){return"function"==typeof t||t instanceof RegExp||!(!t||"object"!=typeof t)&&e(t.listener)}(t))throw new TypeError("listener must be a function");var n,r=this.getListenersAsObject(e),i="object"==typeof t;for(n in r)r.hasOwnProperty(n)&&-1===s(r[n],t)&&r[n].push(i?t:{listener:t,once:!1});return this},o.on=c("addListener"),o.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},o.once=c("addOnceListener"),o.defineEvent=function(e){return this.getListeners(e),this},o.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},o.removeListener=function(e,t){var n,r,i=this.getListenersAsObject(e);for(r in i)i.hasOwnProperty(r)&&-1!==(n=s(i[r],t))&&i[r].splice(n,1);return this},o.off=c("removeListener"),o.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},o.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},o.manipulateListeners=function(e,t,n){var r,i,o=e?this.removeListener:this.addListener,a=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(r=n.length;r--;)o.call(this,t,n[r]);else for(r in t)t.hasOwnProperty(r)&&(i=t[r])&&("function"==typeof i?o.call(this,r,i):a.call(this,r,i));return this},o.removeEvent=function(e){var t,n=typeof e,r=this._getEvents();if("string"===n)delete r[e];else if(e instanceof RegExp)for(t in r)r.hasOwnProperty(t)&&e.test(t)&&delete r[t];else delete this._events;return this},o.removeAllListeners=c("removeEvent"),o.emitEvent=function(e,t){var n,r,i,o,a=this.getListenersAsObject(e);for(o in a)if(a.hasOwnProperty(o))for(n=a[o].slice(0),i=0;i<n.length;i++)!0===(r=n[i]).once&&this.removeListener(e,r.listener),r.listener.apply(this,t||[])===this._getOnceReturnValue()&&this.removeListener(e,r.listener);return this},o.trigger=c("emitEvent"),o.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},o.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},o._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},o._getEvents=function(){return this._events||(this._events={})},i.noConflict=function(){return t.EventEmitter=a,i},void 0===(r=function(){return i}.call(t,n,t,e))||(e.exports=r)}("undefined"!=typeof window?window:this||{})},function(e,t,n){var r=n(35);e.exports=function(e){if(Array.isArray(e))return r(e)}},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,n){(function(t){var r;e.exports=r=r||function(e,r){var i;if("undefined"!=typeof window&&window.crypto&&(i=window.crypto),"undefined"!=typeof self&&self.crypto&&(i=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(i=globalThis.crypto),!i&&"undefined"!=typeof window&&window.msCrypto&&(i=window.msCrypto),!i&&void 0!==t&&t.crypto&&(i=t.crypto),!i)try{i=n(74)}catch(e){}var o=function(){if(i){if("function"==typeof i.getRandomValues)try{return i.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof i.randomBytes)try{return i.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},a=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),s={},c=s.lib={},u=c.Base={extend:function(e){var t=a(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},d=c.WordArray=u.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||f).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,i=e.sigBytes;if(this.clamp(),r%4)for(var o=0;o<i;o++){var a=n[o>>>2]>>>24-o%4*8&255;t[r+o>>>2]|=a<<24-(r+o)%4*8}else for(var s=0;s<i;s+=4)t[r+s>>>2]=n[s>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=u.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(o());return new d.init(t,e)}}),l=s.enc={},f=l.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push((o>>>4).toString(16)),r.push((15&o).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new d.init(n,t/2)}},p=l.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(o))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new d.init(n,t)}},h=l.Utf8={stringify:function(e){try{return decodeURIComponent(escape(p.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return p.parse(unescape(encodeURIComponent(e)))}},m=c.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=h.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,r=this._data,i=r.words,o=r.sigBytes,a=this.blockSize,s=o/(4*a),c=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*a,u=e.min(4*c,o);if(c){for(var l=0;l<c;l+=a)this._doProcessBlock(i,l);n=i.splice(0,c),r.sigBytes-=u}return new d.init(n,u)},clone:function(){var e=u.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),g=(c.Hasher=m.extend({cfg:u.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){m.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new g.HMAC.init(e,n).finalize(t)}}}),s.algo={});return s}(Math)}).call(this,n(33))},function(e,t){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(76),c=n(27),u=n(95),d=n(20),l=n(24),f=n(31),p=a(n(0)),h=a(n(37)),m=function(){function e(e){this.retryTimeout=1e4,this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.taskMutex=new u.PromiseMutex("LS"),this.cancelToken=h.default.CancelToken.source(),this.injectConfig=r({},c.DEFAULT_INJECT_CONFIG),this.injectLoopTimes=0,this.lastTaskId=1,this.statusError=new Map,this.spec=e}return Object.defineProperty(e.prototype,"isNeedReset",{get:function(){for(var e=this,t=0,n=Array.from(this.streamingTasks.values());t<n.length;t++){var r=n[t];if(r.mode===c.LiveStreamingServiceMode.INJECT)return!0;if(r.mode===c.LiveStreamingServiceMode.TRANSCODE&&(this.transcodingConfig&&(this.transcodingConfig.userConfigs||this.transcodingConfig.transcodingUsers)||[]).find((function(t){return t.uid===e.spec.uid})))return!0}return!1},enumerable:!0,configurable:!0}),e.prototype.setTranscodingConfig=function(e){return i(this,void 0,void 0,(function(){var t,n,i,a,s,u=this;return o(this,(function(o){switch(o.label){case 0:(t=r(r({},c.DEFAULT_TRANSCODING_CONFIG),e)).transcodingUsers||(t.transcodingUsers=t.userConfigs),66!==t.videoCodecProfile&&77!==t.videoCodecProfile&&100!==t.videoCodecProfile&&(p.default.debug("["+this.spec.clientId+"] set transcoding config, fix video codec profile: "+t.videoCodecProfile+" -> 100"),t.videoCodecProfile=100),t.transcodingUsers&&(t.transcodingUsers=t.transcodingUsers.map((function(e){return r(r(r({},c.DEFAULT_LIVE_STREAMING_TRANSCODING_USER),e),{zOrder:e.zOrder?e.zOrder+1:1})}))),t.images&&(t.images=t.images.map((function(e){return r(r({},c.DEFAULT_LIVE_STREAMING_TRANSCODING_WATERMARK),e)})));try{c.isLiveStreamingTranscodingConfig(t)}catch(e){throw e}return t.transcodingUsers&&(t.userConfigs=t.transcodingUsers.map((function(e){return r({},e)})),t.userCount=t.transcodingUsers.length,delete t.transcodingUsers),n=(t.userConfigs||[]).map((function(e){return"number"==typeof e.uid?Promise.resolve(e.uid):d.getUserAccount(u.spec,null,e.uid)})),[4,this.taskMutex.lock()];case 1:return i=o.sent(),[4,Promise.all(n)];case 2:if(o.sent().forEach((function(e,n){t.userConfigs&&t.userConfigs[n]&&(t.userConfigs[n].uid=e&&e.uid||e)})),this.transcodingConfig=t,!this.connection)return i(),[2];o.label=3;case 3:return o.trys.push([3,5,,6]),[4,this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(this.streamingTasks.values()).map((function(e){return e.taskId})).join("#")})];case 4:return a=o.sent(),i(),p.default.debug("["+this.spec.clientId+"] update live transcoding config success, code: "+a.code+", config:",JSON.stringify(this.transcodingConfig)),[3,6];case 5:if(s=o.sent(),i(),!s.data||!s.data.retry)throw s;return s.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach((function(e){p.default.warning("["+u.spec.clientId+"] live streaming receive error",s.toString(),"try to republish",e.url),u.startLiveStreamingTask(e.url,e.mode,s).then((function(){p.default.debug("["+u.spec.clientId+"] live streaming republish "+e.url+" success")})).catch((function(t){p.default.error("["+u.spec.clientId+"] live streaming republish failed",e.url,t.toString()),u.onLiveStreamError&&u.onLiveStreamError(e.url,t)}))})),[3,6];case 6:return[2]}}))}))},e.prototype.setInjectStreamConfig=function(e,t){this.injectConfig=Object.assign({},this.injectConfig,e),this.injectLoopTimes=t},e.prototype.startLiveStreamingTask=function(e,t,n){return i(this,void 0,void 0,(function(){var i,a,s,u,d,h,m,g,v=this;return o(this,(function(o){switch(o.label){case 0:return Array.from(this.streamingTasks.values()).find((function(e){return e.mode===c.LiveStreamingServiceMode.INJECT}))&&t===c.LiveStreamingServiceMode.INJECT?[2,new l.AgoraRTCError(l.AgoraRTCErrorCode.LIVE_STREAMING_TASK_CONFLICT,"inject stream over limit").throw()]:(i={command:"PublishStream",ts:Date.now(),url:e,uid:this.spec.uid.toString(),autoDestroyTime:30},p.default.debug("["+this.spec.clientId+"] start live streaming "+e+", mode: "+t),[4,this.taskMutex.lock()]);case 1:if(a=o.sent(),!this.transcodingConfig&&t===c.LiveStreamingServiceMode.TRANSCODE)throw a(),new l.AgoraRTCError(l.AgoraRTCErrorCode.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");if(!this.connection&&n)return a(),[2];if(this.streamingTasks.get(e)&&!n)return a(),[2,new l.AgoraRTCError(l.AgoraRTCErrorCode.LIVE_STREAMING_TASK_CONFLICT).throw()];if(!this.transcodingConfig&&t===c.LiveStreamingServiceMode.TRANSCODE)throw a(),new l.AgoraRTCError(l.AgoraRTCErrorCode.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");o.label=2;case 2:return o.trys.push([2,5,,6]),this.connection?[3,4]:(s=this,[4,this.connect(t)]);case 3:s.connection=o.sent(),o.label=4;case 4:return[3,6];case 5:throw u=o.sent(),a(),u;case 6:switch(t){case c.LiveStreamingServiceMode.TRANSCODE:i.transcodingConfig=r({},this.transcodingConfig);break;case c.LiveStreamingServiceMode.RAW:break;case c.LiveStreamingServiceMode.INJECT:i={cname:this.spec.cname,command:"InjectStream",sid:this.spec.sid,transcodingConfig:this.injectConfig,ts:Date.now(),url:e,loopTimes:this.injectLoopTimes}}this.uapResponse&&this.uapResponse.vid&&(i.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0,d=this.lastTaskId++,o.label=7;case 7:return o.trys.push([7,9,,14]),h=new Promise((function(t,r){f.wait(v.retryTimeout).then((function(){if(n)return r(n);var t=v.statusError.get(e);return t?(v.statusError.delete(e),r(t)):void 0}))})),[4,Promise.race([this.connection.request("request",{clientRequest:i},!0,{url:e,command:"PublishStream",workerType:t===c.LiveStreamingServiceMode.TRANSCODE?1:2,requestByUser:!n,tid:d.toString()}),h])];case 8:return m=o.sent(),this.isStartingStreamingTask=!1,p.default.debug("["+this.spec.clientId+"] live streaming started, code: "+m.code),this.streamingTasks.set(e,{clientRequest:i,mode:t,url:e,taskId:d}),a(),[3,14];case 9:if(g=o.sent(),a(),this.isStartingStreamingTask=!1,!g.data||!g.data.retry||n)throw g;return g.data.changeAddress?[3,11]:[4,this.startLiveStreamingTask(e,t,g)];case 10:return[2,o.sent()];case 11:return this.connection.tryNextAddress(),[4,this.startLiveStreamingTask(e,t,g)];case 12:return[2,o.sent()];case 13:return[3,14];case 14:return[2]}}))}))},e.prototype.stopLiveStreamingTask=function(e){var t=this;return new Promise((function(n,r){var i=t.streamingTasks.get(e);if(!i||!t.connection)return new l.AgoraRTCError(l.AgoraRTCErrorCode.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();var o=i.mode;i.abortTask=function(){p.default.debug("["+t.spec.clientId+"] stop live streaming success(worker exception)"),t.streamingTasks.delete(e),n()},p.default.debug("stop live streaming task request: "+JSON.stringify(e)),t.connection.request("request",{clientRequest:{command:o===c.LiveStreamingServiceMode.INJECT?"UninjectStream":"UnpublishStream",url:i.url}},!1,{url:e,command:"UnPublishStream",workerType:o===c.LiveStreamingServiceMode.TRANSCODE?1:2,requestByUser:!0,tid:(t.lastTaskId++).toString()}).then((function(r){p.default.debug("["+t.spec.clientId+"] stop live streaming success, code: "+r.code),t.streamingTasks.delete(e),0===t.streamingTasks.size&&o!==c.LiveStreamingServiceMode.INJECT&&(t.connection.close(),t.connection=void 0),n()})).catch(r)}))},e.prototype.controlInjectStream=function(e,t,n,r){return i(this,void 0,void 0,(function(){var i;return o(this,(function(o){switch(o.label){case 0:if(!(i=this.streamingTasks.get(e))||!this.connection||i.mode!==c.LiveStreamingServiceMode.INJECT)throw new l.AgoraRTCError(l.AgoraRTCErrorCode.INVALID_OPERATION,"can not find inject stream task to control");return[4,this.connection.request("request",{clientRequest:{command:"ControlStream",url:e,control:t,audioVolume:n,position:r}})];case 1:return[2,o.sent().serverResponse]}}))}))},e.prototype.resetAllTask=function(){var e=this,t=Array.from(this.streamingTasks.values());this.terminate();for(var n=function(t){r.startLiveStreamingTask(t.url,t.mode).catch((function(n){e.onLiveStreamError&&e.onLiveStreamError(t.url,n)}))},r=this,i=0,o=t;i<o.length;i++)n(o[i])},e.prototype.setGatewayConnectionState=function(e){this.connection&&(this.connection.gatewayConnectionState=e)},e.prototype.terminate=function(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=h.default.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0},e.prototype.connect=function(e){return i(this,void 0,void 0,(function(){var t,n=this;return o(this,(function(r){switch(r.label){case 0:if(this.connection)throw new l.AgoraRTCError(l.AgoraRTCErrorCode.UNEXPECTED_ERROR,"live streaming connection has already connected");return[4,f.getLiveStreamingWorkerMangerResult(e,this.spec,this.cancelToken.token)];case 1:return t=r.sent(),this.uapResponse=t,this.connection=new s.AgoraLiveStreamingUapSignal(t.workerToken,this.spec,e),this.connection.on(c.LiveStreamingUapSignalEvents.WARNING,(function(e,t){return n.onLiveStreamWarning&&n.onLiveStreamWarning(t,e)})),this.connection.on(c.LiveStreamingUapSignalEvents.PUBLISH_STREAM_STATUS,(function(e){return n.handlePublishStreamServer(e)})),this.connection.on(c.LiveStreamingUapSignalEvents.INJECT_STREAM_STATUS,(function(e){return n.handleInjectStreamServerStatus(e)})),this.connection.on(c.LiveStreamingUapSignalEvents.REQUEST_NEW_ADDRESS,(function(t,r){if(!n.connection)return r(new l.AgoraRTCError(l.AgoraRTCErrorCode.UNEXPECTED_ERROR,"can not get new live streaming address list"));f.getLiveStreamingWorkerMangerResult(e,n.spec,n.cancelToken.token).then((function(e){n.uapResponse=e,t(e.addressList)})).catch(r)})),[4,this.connection.init(t.addressList)];case 2:return r.sent(),[2,this.connection]}}))}))},e.prototype.handlePublishStreamServer=function(e){var t=this,n=e.serverStatus&&e.serverStatus.url;if(!n)throw new l.AgoraRTCError(l.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"empty url",{code:e.code});var r=this.streamingTasks.get(n);switch(e.code){case c.LIVE_STREAM_ERROR_CODE.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case c.LIVE_STREAM_ERROR_CODE.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case c.LIVE_STREAM_ERROR_CODE.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case c.LIVE_STREAM_ERROR_CODE.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:var i=new l.AgoraRTCError(l.AgoraRTCErrorCode.LIVE_STREAMING_CDN_ERROR,"",{code:e.code});if(r)return p.default.error(i.toString()),this.onLiveStreamError&&this.onLiveStreamError(n,i);if(!this.isStartingStreamingTask)return;this.statusError.set(n,i);case c.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_WORKER_LOST:case c.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_WORKER_QUIT:if(!this.connection||0===this.streamingTasks.size)return;this.connection.tryNextAddress();for(var o=Array.from(this.streamingTasks.values()),a=function(n){if(n.abortTask)return n.abortTask(),"continue";p.default.warning("["+s.spec.clientId+"] publish stream status code",e.code,"try to republish",n.url),s.startLiveStreamingTask(n.url,n.mode,new l.AgoraRTCError(l.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:e.code})).then((function(){p.default.debug("["+t.spec.clientId+"] republish live stream success",n.url)})).catch((function(e){p.default.error(e.toString()),t.onLiveStreamError&&t.onLiveStreamError(n.url,e)}))},s=this,u=0,d=o;u<d.length;u++)a(d[u]);return}},e.prototype.handleInjectStreamServerStatus=function(e){var t=Number(e.uid),n=e.serverStatus&&e.serverStatus.url;switch(e.code){case 200:return void(this.onInjectStatusChange&&this.onInjectStatusChange(0,t,n));case 451:return this.onInjectStatusChange&&this.onInjectStatusChange(1,t,n),void this.streamingTasks.delete(n);case 453:return this.onInjectStatusChange&&this.onInjectStatusChange(2,t,n),void this.streamingTasks.delete(n);case 470:return this.onInjectStatusChange&&this.onInjectStatusChange(10,t,n),void this.streamingTasks.delete(n);case 499:return this.onInjectStatusChange&&this.onInjectStatusChange(3,t,n),void this.streamingTasks.delete(n);default:return void p.default.debug("inject stream server status",e)}},e.prototype.haveUrl=function(e){return this.streamingTasks.has(e)||void 0},e}();t.AgoraRTCLiveStreamingClient=m},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(27),d=n(77),l=n(36),f=n(24),p=n(2),h=c(n(0)),m=n(1),g=n(31),v=function(e){function t(t,n,r){var i=e.call(this)||this;return i._gatewayConnectionState="CONNECTED",i.reconnectMode="retry",i.reqId=0,i.commandReqId=0,i.waitingResponseList=[],i.handleWebSocketOpen=function(){i.reconnectMode="retry",i.startPingPong()},i.handleWebSocketMessage=function(e){if(e.data){var t=JSON.parse(e.data);if(t.requestId)i.emit("@"+t.requestId,t);else if(i.serviceMode===u.LiveStreamingServiceMode.INJECT)i.emit(u.LiveStreamingUapSignalEvents.INJECT_STREAM_STATUS,t);else{m.report.requestWorkerEvent(i.spec.sid,{actionType:"status",serverCode:t.code,workerType:i.serviceMode===u.LiveStreamingServiceMode.TRANSCODE?1:2});var n=t.serverStatus&&t.serverStatus.url;n&&i.waitingResponseList.includes(n)&&200===t.code&&i.emit(n),i.emit(u.LiveStreamingUapSignalEvents.PUBLISH_STREAM_STATUS,t)}}},i.spec=n,i.token=t,i.serviceMode=r,i.websocket=new d.AgoraWebSocketManager("live-streaming"),i.websocket.on(u.WebSocketManagerEvents.CONNECTED,i.handleWebSocketOpen),i.websocket.on(u.WebSocketManagerEvents.ON_MESSAGE,i.handleWebSocketMessage),i.websocket.on(u.WebSocketManagerEvents.REQUEST_NEW_URLS,(function(e,t){l.emitAsPromise(i,u.LiveStreamingUapSignalEvents.REQUEST_NEW_ADDRESS).then(e).catch(t)})),i.websocket.on(u.WebSocketManagerEvents.RECONNECTING,(function(){i.websocket.reconnectMode=i.reconnectMode})),i}return i(t,e),Object.defineProperty(t.prototype,"gatewayConnectionState",{get:function(){return this._gatewayConnectionState},set:function(e){this._gatewayConnectionState=e,"CONNECTED"===e&&this.emit("gateway-connected",e)},enumerable:!0,configurable:!0}),t.prototype.init=function(e){return this.websocket.init(e)},t.prototype.request=function(e,t,n,r){return a(this,void 0,void 0,(function(){var i,a,c,d,l,h,v,y,b,S,E=this;return s(this,(function(s){switch(s.label){case 0:if(this.reqId+=1,i=this.reqId,"request"===e&&(this.commandReqId+=1),a=this.commandReqId,!i||!this.websocket)throw new f.AgoraRTCError(f.AgoraRTCErrorCode.UNEXPECTED_ERROR);if(c=p.VERSION,"closed"===this.websocket.state)throw new f.AgoraRTCError(f.AgoraRTCErrorCode.WS_DISCONNECT);return d=function(){return new Promise((function(e,t){var n=function(){"CONNECTED"===E.gatewayConnectionState&&"connected"===E.websocket.state&&(E.off("gateway-connected",n),E.websocket.off(u.WebSocketManagerEvents.CONNECTED,n),e(void 0))};E.on("gateway-connected",n),E.websocket.once(u.WebSocketManagerEvents.CLOSED,(function(){return t(new f.AgoraRTCError(f.AgoraRTCErrorCode.WS_ABORT))})),E.websocket.on(u.WebSocketManagerEvents.CONNECTED,n)}))},"connected"===this.websocket.state&&"CONNECTED"===this.gatewayConnectionState?[3,2]:[4,d()];case 1:s.sent(),s.label=2;case 2:l=Promise.race([new Promise((function(e,t){var n=function(){t(new f.AgoraRTCError(f.AgoraRTCErrorCode.WS_ABORT))};E.websocket.once(u.WebSocketManagerEvents.RECONNECTING,n),E.websocket.once(u.WebSocketManagerEvents.CLOSED,n),E.once("@"+i,(function(t){e(t)}))})),g.wait(p.getParameter("LIVE_STREAMING_TIMEOUT")).then((function(){return!1}))]),(h=o({command:e,sdkVersion:c,seq:i,requestId:i,allocate:n,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},t)).clientRequest&&(h.clientRequest.workerToken=this.token),r&&m.report.requestWorkerEvent(this.spec.sid,o(o({},r),{requestId:a,actionType:"request",payload:JSON.stringify(t.clientRequest),serverCode:0,code:0})),v=Date.now(),this.websocket.sendMessage(h),y=null,s.label=3;case 3:return s.trys.push([3,5,,8]),[4,l];case 4:return y=s.sent(),[3,8];case 5:if(b=s.sent(),"closed"===this.websocket.state)throw b;return[4,d()];case 6:return s.sent(),[4,this.request(e,t,n,r)];case 7:return[2,s.sent()];case 8:if(!1===y)throw S=new f.AgoraRTCError(f.AgoraRTCErrorCode.NETWORK_TIMEOUT,(t&&t.clientRequest&&t.clientRequest.command)+" timeout",{changeAddress:!0,retry:!0}),this.emit(u.LiveStreamingUapSignalEvents.WARNING,S,r&&r.url||"unknown url"),r&&m.report.requestWorkerEvent(this.spec.sid,o(o({},r),{requestId:a,actionType:"response",payload:"TIMEOUT",serverCode:0,success:0,responseTime:Date.now()-v})),S;return r&&m.report.requestWorkerEvent(this.spec.sid,o(o({},r),{requestId:a,actionType:"response",payload:JSON.stringify(y.serverResponse),serverCode:y.code,success:200===y.code,responseTime:Date.now()-v})),200===y.code?[3,10]:[4,this.handleResponseError(y)];case 9:s.sent(),s.label=10;case 10:return[2,y]}}))}))},t.prototype.tryNextAddress=function(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")},t.prototype.close=function(){var e="__VERSION__"===p.VERSION?"0.0.1":p.VERSION;this.reqId+=1,"connected"===this.websocket.state?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:e,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)},t.prototype.handleResponseError=function(e){return a(this,void 0,void 0,(function(){var t,n,r,i,o=this;return s(this,(function(a){switch(h.default.debug("[live-streaming] receive response error "+e.code),e.code){case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return h.default.warning("live stream response already exists stream"),t=e.serverResponse.url,this.emit(u.LiveStreamingUapSignalEvents.WARNING,"live stream response already exists stream, code 454",t),this.waitingResponseList.includes(t)||this.waitingResponseList.push(t),[2,new Promise((function(n,r){o.once(t,(function(){o.waitingResponseList.splice(o.waitingResponseList.indexOf(t),1),n()})),setTimeout((function(){o.waitingResponseList.splice(o.waitingResponseList.indexOf(t),1),r(new f.AgoraRTCError(f.AgoraRTCErrorCode.TIMEOUT,"live stream timeout waiting 454",{code:e.code}))}),1e4)}))];case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_BAD_STREAM:case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return[2,new f.AgoraRTCError(f.AgoraRTCErrorCode.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:e.code}).throw()];case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_INGNORE_MESSAGE:throw new f.AgoraRTCError(f.AgoraRTCErrorCode.LIVE_STREAMING_INVALID_ARGUMENT,"",{retry:!0,changeAddress:!0});case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if("UnpublishStream"===e.serverResponse.command||"UninjectStream"===e.serverResponse.command)return[2];throw new f.AgoraRTCError(f.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return[2,new f.AgoraRTCError(f.AgoraRTCErrorCode.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:e.code}).throw()];case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:return n=new f.AgoraRTCError(f.AgoraRTCErrorCode.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE),[2,this.emit(u.LiveStreamingUapSignalEvents.WARNING,n,e.serverResponse.url)];case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:return n=new f.AgoraRTCError(f.AgoraRTCErrorCode.LIVE_STREAMING_WARN_FREQUENT_REQUEST),[2,this.emit(u.LiveStreamingUapSignalEvents.WARNING,n,e.serverResponse.url)];case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new f.AgoraRTCError(f.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return[2,new f.AgoraRTCError(f.AgoraRTCErrorCode.LIVE_STREAMING_TRANSCODING_NOT_SUPPORT,"",{code:e.code}).throw()];case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:return n=new f.AgoraRTCError(f.AgoraRTCErrorCode.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT),[2,this.emit(u.LiveStreamingUapSignalEvents.WARNING,n,e.serverResponse.url)];case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return[2,new f.AgoraRTCError(f.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:e.code}).throw()];case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new f.AgoraRTCError(f.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_WORKER_LOST:case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_WORKER_QUIT:if("UnpublishStream"===e.serverResponse.command||"UninjectStream"===e.serverResponse.command)return[2];throw new f.AgoraRTCError(f.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case u.LIVE_STREAM_ERROR_CODE.ERROR_FAIL_SEND_MESSAGE:if("UnpublishStream"===e.serverResponse.command||"UninjectStream"===e.serverResponse.command)return[2];if("UpdateTranscoding"===e.serverResponse.command||"ControlStream"===e.serverResponse.command)return[2,new f.AgoraRTCError(f.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:e.code}).throw()];throw new f.AgoraRTCError(f.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case u.LIVE_STREAM_ERROR_CODE.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case u.LIVE_STREAM_ERROR_CODE.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case u.LIVE_STREAM_ERROR_CODE.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case u.LIVE_STREAM_ERROR_CODE.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return r=e.serverResponse.url,this.waitingResponseList.includes(r)||this.waitingResponseList.push(r),i=new f.AgoraRTCError(f.AgoraRTCErrorCode.LIVE_STREAMING_CDN_ERROR,"",{code:e.code}),this.emit(u.LiveStreamingUapSignalEvents.WARNING,i,r),[2,new Promise((function(e,t){o.once(r,(function(){o.waitingResponseList.splice(o.waitingResponseList.indexOf(r),1),e()})),setTimeout((function(){o.waitingResponseList.splice(o.waitingResponseList.indexOf(r),1),t(i)}),1e4)}))]}return[2]}))}))},t.prototype.startPingPong=function(){var e=this;this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval((function(){"connected"===e.websocket.state&&e.request("ping",{}).catch((function(){}))}),6e3)},t}(l.EventEmitter);t.AgoraLiveStreamingUapSignal=v},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(24),u=n(36),d=n(31),l=n(27),f=s(n(0)),p=function(e){function t(t){var n=e.call(this)||this;return n.connectionID=0,n.currentURLIndex=0,n.reconnectMode="tryNext",n._state="closed",n.retryConfig=d.DEFAULT_RETRY_CONFIG,n.reconnectCount=0,n.name=t,n}return i(t,e),Object.defineProperty(t.prototype,"url",{get:function(){return this.websocket?this.websocket.url:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(e){e!==this._state&&(this._state=e,"reconnecting"===this._state?this.emit(l.WebSocketManagerEvents.RECONNECTING,this.reconnectMode):"connected"===this._state?this.emit(l.WebSocketManagerEvents.CONNECTED):"closed"===this._state?this.emit(l.WebSocketManagerEvents.CLOSED):"failed"===this._state&&this.emit(l.WebSocketManagerEvents.FAILED))},enumerable:!0,configurable:!0}),t.prototype.init=function(e){var t=this;return new Promise((function(n,r){t.urls=e;var i=t.urls[t.currentURLIndex];t.state="connecting",t.createWebSocketConnection(i).then(n).catch(r),t.once(l.WebSocketManagerEvents.CLOSED,(function(){return r(new c.AgoraRTCError(c.AgoraRTCErrorCode.WS_DISCONNECT))})),t.once(l.WebSocketManagerEvents.CONNECTED,(function(){return n()}))}))},t.prototype.close=function(e,t){if(this.currentURLIndex=0,this.reconnectCount=0,this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;var n=this.websocket;t?setTimeout((function(){return n.close()}),500):n.close(),this.websocket=void 0}this.state=e?"failed":"closed"},t.prototype.reconnect=function(e){if(this.websocket){void 0!==e&&(this.reconnectMode=e);var t=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),t&&t.bind(this.websocket)({code:9999})}else f.default.warning("["+this.name+"] can not reconnect, no websocket")},t.prototype.sendMessage=function(e){if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new c.AgoraRTCError(c.AgoraRTCErrorCode.WS_ABORT,"websocket is not ready");var t=JSON.stringify(e);try{this.websocket.send(t)}catch(e){throw new c.AgoraRTCError(c.AgoraRTCErrorCode.WS_ERR,"send websocket message error"+e.toString())}},t.prototype.createWebSocketConnection=function(e){return o(this,void 0,void 0,(function(){var t,n=this;return a(this,(function(r){return this.connectionID+=1,t=this.connectionID,[2,new Promise((function(r,i){n.websocket&&(n.websocket.onclose=null,n.websocket.close()),f.default.debug("["+n.name+"] start connect, url: "+e);try{n.websocket=new WebSocket(e),n.websocket.binaryType="arraybuffer"}catch(e){var s=new c.AgoraRTCError(c.AgoraRTCErrorCode.WS_ERR,"init websocket failed! Error: "+e.toString());return f.default.error("["+n.name+"]"+s),void i(s)}d.wait(5e3).then((function(){t===n.connectionID&&n.websocket&&n.websocket.readyState!==WebSocket.OPEN&&n.websocket&&n.websocket.close()})),n.websocket.onopen=function(){f.default.debug("["+n.name+"] websockect opened:",e),n.reconnectMode="retry",n.state="connected",n.reconnectCount=0,r()},n.websocket.onclose=function(e){return o(n,void 0,void 0,(function(){var t,n;return a(this,(function(o){switch(o.label){case 0:return f.default.debug("["+this.name+"] websocket close "+(this.websocket&&this.websocket.url)+", code: "+e.code+", reason: "+e.reason+", current mode: "+this.reconnectMode),this.reconnectCount<this.retryConfig.maxRetryCount?("connected"===this.state&&(this.state="reconnecting"),t=u.emitAsInvokerNoResponse(this,l.WebSocketManagerEvents.WILL_RECONNECT,this.reconnectMode)||this.reconnectMode,[4,this.reconnectWithAction(t)]):[3,2];case 1:return n=o.sent(),"closed"===this.state?(f.default.debug("["+this.connectionID+"] ws is closed, no need to reconnect"),[2]):n?(r(),[3,3]):(i(new c.AgoraRTCError(c.AgoraRTCErrorCode.WS_DISCONNECT,"websocket reconnect failed: "+e.code)),this.close(!0),[2]);case 2:i(new c.AgoraRTCError(c.AgoraRTCErrorCode.WS_DISCONNECT,"websocket close: "+e.code)),this.close(),o.label=3;case 3:return[2]}}))}))},n.websocket.onmessage=function(e){n.emit(l.WebSocketManagerEvents.ON_MESSAGE,e)}}))]}))}))},t.prototype.reconnectWithAction=function(e,t){return o(this,void 0,void 0,(function(){var n,r,i,o;return a(this,(function(a){switch(a.label){case 0:return!t&&this.reconnectCount>=this.retryConfig.maxRetryCount?[2,!1]:this.urls?"closed"===this.state?[2,!1]:(n=d.getRetryWaitTime(this.reconnectCount,this.retryConfig),f.default.debug("["+this.name+"] wait "+n+"ms to reconnect websocket, mode: "+e),[4,d.wait(n)]):[2,!1];case 1:if(a.sent(),"closed"===this.state)return[2,!1];this.reconnectCount+=1,a.label=2;case 2:return a.trys.push([2,12,,14]),"retry"!==e?[3,4]:(i=this.urls[this.currentURLIndex],[4,this.createWebSocketConnection(i)]);case 3:return a.sent(),[3,11];case 4:return"tryNext"!==e?[3,8]:(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length?[4,this.reconnectWithAction("recover")]:[3,6]);case 5:return[2,a.sent()];case 6:return f.default.debug("["+this.name+"] websocket url length: "+this.urls.length+" current index: "+this.currentURLIndex),i=this.urls[this.currentURLIndex],[4,this.createWebSocketConnection(i)];case 7:return a.sent(),[3,11];case 8:return"recover"!==e?[3,11]:(f.default.debug("["+this.name+"] request new urls"),r=this,[4,u.emitAsPromise(this,l.WebSocketManagerEvents.REQUEST_NEW_URLS)]);case 9:return r.urls=a.sent(),this.currentURLIndex=0,i=this.urls[this.currentURLIndex],[4,this.createWebSocketConnection(i)];case 10:a.sent(),a.label=11;case 11:return[2,!0];case 12:return o=a.sent(),f.default.error("["+this.name+"] reconnect failed",o.toString()),[4,this.reconnectWithAction(e)];case 13:return[2,a.sent()];case 14:return[2]}}))}))},t}(u.EventEmitter);t.AgoraWebSocketManager=p},function(e,t,n){"use strict";var r=n(18),i=n(38),o=n(79),a=n(44);function s(e){var t=new o(e),n=i(o.prototype.request,t);return r.extend(n,o.prototype,t),r.extend(n,t),n}var c=s(n(41));c.Axios=o,c.create=function(e){return s(a(c.defaults,e))},c.Cancel=n(45),c.CancelToken=n(93),c.isCancel=n(40),c.all=function(e){return Promise.all(e)},c.spread=n(94),e.exports=c,e.exports.default=c},function(e,t,n){"use strict";var r=n(18),i=n(39),o=n(80),a=n(81),s=n(44);function c(e){this.defaults=e,this.interceptors={request:new o,response:new o}}c.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=s(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[a,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)n=n.then(t.shift(),t.shift());return n},c.prototype.getUri=function(e){return e=s(this.defaults,e),i(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){c.prototype[e]=function(t,n){return this.request(r.merge(n||{},{method:e,url:t}))}})),r.forEach(["post","put","patch"],(function(e){c.prototype[e]=function(t,n,i){return this.request(r.merge(i||{},{method:e,url:t,data:n}))}})),e.exports=c},function(e,t,n){"use strict";var r=n(18);function i(){this.handlers=[]}i.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},function(e,t,n){"use strict";var r=n(18),i=n(82),o=n(40),a=n(41);function s(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return s(e),e.headers=e.headers||{},e.data=i(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||a.adapter)(e).then((function(t){return s(e),t.data=i(t.data,t.headers,e.transformResponse),t}),(function(t){return o(t)||(s(e),t&&t.response&&(t.response.data=i(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},function(e,t,n){"use strict";var r=n(18);e.exports=function(e,t,n){return r.forEach(n,(function(n){e=n(e,t)})),e}},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var c,u=[],d=!1,l=-1;function f(){d&&c&&(d=!1,c.length?u=c.concat(u):l=-1,u.length&&p())}function p(){if(!d){var e=s(f);d=!0;for(var t=u.length;t;){for(c=u,u=[];++l<t;)c&&c[l].run();l=-1,t=u.length}c=null,d=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new h(e,t)),1!==u.length||d||s(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){"use strict";var r=n(18);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},function(e,t,n){"use strict";var r=n(43);e.exports=function(e,t,n){var i=n.config.validateStatus;!i||i(n.status)?e(n):t(r("Request failed with status code "+n.status,n.config,null,n.request,n))}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,i){return e.config=t,n&&(e.code=n),e.request=r,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},function(e,t,n){"use strict";var r=n(88),i=n(89);e.exports=function(e,t){return e&&!r(t)?i(e,t):t}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var r=n(18),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,o,a={};return e?(r.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=r.trim(e.substr(0,o)).toLowerCase(),n=r.trim(e.substr(o+1)),t){if(a[t]&&i.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([n]):a[t]?a[t]+", "+n:n}})),a):a}},function(e,t,n){"use strict";var r=n(18);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=i(window.location.href),function(t){var n=r.isString(t)?i(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},function(e,t,n){"use strict";var r=n(18);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,i,o,a){var s=[];s.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),r.isString(i)&&s.push("path="+i),r.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";var r=n(45);function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(0)),o=1,a=function(){function e(e){this.lockingPromise=Promise.resolve(),this.locks=0,this.name="",this.lockId=o++,e&&(this.name=e),i.default.debug("[lock-"+this.name+"-"+this.lockId+"] is created.")}return Object.defineProperty(e.prototype,"isLocked",{get:function(){return this.locks>0},enumerable:!0,configurable:!0}),e.prototype.lock=function(){var e,t=this;this.locks+=1,i.default.debug("[lock-"+this.name+"-"+this.lockId+"] is locked, current queue "+this.locks+".");var n=new Promise((function(n){e=function(){t.locks-=1,i.default.debug("[lock-"+t.name+"-"+t.lockId+"] is not locked, current queue "+t.locks+"."),n()}})),r=this.lockingPromise.then((function(){return e}));return this.lockingPromise=this.lockingPromise.then((function(){return n})),r},e}();t.PromiseMutex=a},function(e,t,n){"use strict";n.r(t);var r=n(2),i=n(0),o=n(1),a=n(8),s=n(4),c=function(){};c.prototype.set=function(e,t){["BatteryLevel"].indexOf(e)>-1&&(this[e]=t)};var u=function(){var e=o.report.reportApiInvoke(null,{name:"checkSystemRequirements",options:arguments,tag:"tracer"}),t=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,n=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia||navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,r=window.WebSocket,i=!!t&&!!n&&!!r,a=!1;s.isChrome()&&s.getBrowserVersion()>=58&&"iOS"!==s.getBrowserOS()&&(a=!0),s.isFireFox()&&s.getBrowserVersion()>=56&&(a=!0),s.isOpera()&&s.getBrowserVersion()>=45&&(a=!0),s.isSafari()&&s.getBrowserVersion()>=11&&(a=!0),s.isEdge()&&(a=!0),(s.isWeChatBrowser()||s.isQQBrowser())&&"iOS"!==s.getBrowserOS()&&(a=!0),s.isSupportedPC()||s.isSupportedMobile()||(a=!1);var c=i&&a;return e(null,c),c},d=new function(){var e=Object(a.b)();return e.states={UNINIT:"UNINIT",INITING:"INITING",INITED:"INITED"},e.state=e.states.UNINIT,e.batteryManager=null,e._init=function(t,n){e.state=e.states.INITING,navigator.getBattery?navigator.getBattery().then((function(n){e.batteryManager=n,t&&setTimeout((function(){t()}),0)})).catch((function(e){i.default.debug("navigator.getBattery is disabled",e),t&&t()})):(e.state=e.states.INITED,t&&t())},e._getBatteryStats=function(){var t={};return e.batteryManager&&e.batteryManager.level?t.BatteryLevel=Math.floor(100*e.batteryManager.level):t.BatteryLevel="UNSUPPORTED",t},e.getStats=function(t,n){var r=new c,i=e._getBatteryStats();i&&i.BatteryLevel&&r.set("BatteryLevel",i.BatteryLevel),t&&t(r)},e._init(),e},l=n(22),f=n(19),p=n(26),h=n(53),m=n(9),g=["live","rtc","web","interop","h264_interop","web-only"],v=["vp8","vp9","h264"],y=["aes-128-gcm","aes-256-gcm","aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-256-gcm2","aes-128-gcm2"],b=n(11),S=n.n(b),E=n(7),_=n.n(E),T=n(13),R=n(5),I=n(10),w=n(20),C=n(6),O=n(14),A={1001:"FRAMERATE_INPUT_TOO_LOW",1002:"FRAMERATE_SENT_TOO_LOW",1003:"SEND_VIDEO_BITRATE_TOO_LOW",1005:"RECV_VIDEO_DECODE_FAILED",2001:"AUDIO_INPUT_LEVEL_TOO_LOW",2002:"AUDIO_OUTPUT_LEVEL_TOO_LOW",2003:"SEND_AUDIO_BITRATE_TOO_LOW",2005:"RECV_AUDIO_DECODE_FAILED",3001:"FRAMERATE_INPUT_TOO_LOW_RECOVER",3002:"FRAMERATE_SENT_TOO_LOW_RECOVER",3003:"SEND_VIDEO_BITRATE_TOO_LOW_RECOVER",3005:"RECV_VIDEO_DECODE_FAILED_RECOVER",4001:"AUDIO_INPUT_LEVEL_TOO_LOW_RECOVER",4002:"AUDIO_OUTPUT_LEVEL_TOO_LOW_RECOVER",4003:"SEND_AUDIO_BITRATE_TOO_LOW_RECOVER",4005:"RECV_AUDIO_DECODE_FAILED_RECOVER"},x={FramerateInput:1001,FramerateSent:1002,SendVideoBitrate:1003,VideoDecode:1005,AudioIntputLevel:2001,AudioOutputLevel:2002,SendAudioBitrate:2003,AudioDecode:2005},k=function(e){var t={remoteStreamStorage:{},localStreamStorage:{}};return t.gatewayClient=e,t.checkAudioOutputLevel=function(e){return!(e&&parseInt(e.audioRecvBytesDelta)>0&&parseInt(e.audioDecodingNormalDelta)>0&&0===parseInt(e.audioOutputLevel))},t.checkAudioIntputLevel=function(e){return!e||0!==parseInt(e.audioInputLevel)},t.checkFramerateInput=function(e,t){if(!e||!t.attributes)return!0;var n=parseInt(t.attributes.maxFrameRate),r=parseInt(e.googFrameRateInput);return!n||!r||!(n>10&&r<5||n<10&&n>=5&&r<=1)},t.checkFramerateSent=function(e){return!(e&&parseInt(e.googFrameRateInput)>5&&parseInt(e.googFrameRateSent)<=1)},t.checkSendVideoBitrate=function(e){return!e||0!==parseInt(e.videoSendBytesDelta)},t.checkSendAudioBitrate=function(e){return!e||0!==parseInt(e.audioSendBytesDelta)},t.checkVideoDecode=function(e){return!e||0===parseInt(e.videoRecvBytesDelta)||0!==parseInt(e.googFrameRateDecoded)},t.checkAudioDecode=function(e){return!e||0===parseInt(e.audioRecvBytesDelta)||0!==parseInt(e.audioDecodingNormalDelta)},t.record=function(e,n,r,i,o){r[e]||(r[e]={isPrevNormal:!0,record:[]});var a=r[e],s=t["check"+e](n,o);if(a.record.push(s),a.record.length>=5){a.isCurNormal=-1!==a.record.indexOf(!0);var c=x[e];a.isPrevNormal&&!a.isCurNormal&&t.gatewayClient.dispatchEvent({type:"exception",code:c,msg:A[c],uid:i}),!a.isPrevNormal&&a.isCurNormal&&t.gatewayClient.dispatchEvent({type:"exception",code:c+2e3,msg:A[c+2e3],uid:i}),a.isPrevNormal=a.isCurNormal,a.record=[]}},t.setLocalStats=function(e){var n={};Object.keys(e).map((function(r){var i=e[r],o=t.gatewayClient.localStreams[parseInt(r)],a=t.localStreamStorage[r]||{};o&&o.hasVideo()&&(t.record("SendVideoBitrate",i.videoStats,a,r),t.record("FramerateInput",i.videoStats,a,r,o),t.record("FramerateSent",i.videoStats,a,r)),o&&o.hasAudio()&&(t.record("AudioIntputLevel",i.audioStats,a,r),t.record("SendAudioBitrate",i.audioStats,a,r)),n[r]=a})),t.localStreamStorage=n},t.setRemoteStats=function(n){var r={};Object.keys(n).map((function(i){var o=n[i],a=e.remoteStreams[i],s=t.remoteStreamStorage[i]||{};a&&a.hasVideo()&&a.isPlaying()&&t.record("VideoDecode",o.videoStats,s,i),a&&a.hasAudio()&&a.isPlaying()&&(t.record("AudioOutputLevel",o.audioStats,s,i),t.record("AudioDecode",o.audioStats,s,i)),r[i]=s})),t.remoteStreamStorage=r},t};function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var L,M=n(3),V=new function(){var e=Object(a.b)();return e.states={UNINIT:"UNINIT",INITING:"INITING",INITED:"INITED"},e.state=e.states.UNINIT,e.type=null,e.lastConnectedAt=null,e.lastDisconnectedAt=null,e.lastTypeChangedAt=null,e.networkChangeTimer=null,e._init=function(t,n){if(e.state=e.states.INITING,navigator.connection&&navigator.connection.addEventListener){var r=e._getNetworkInfo();e.type=r&&r.type,e.state=e.states.INITED,t&&t()}else e.state=e.states.UNINIT,n&&n("DO_NOT_SUPPORT")},e._getNetworkInfo=function(){return navigator.connection},e._reloadNetworkInfo=function(){var t=e._getNetworkInfo(),n=t&&t.type||"UNSUPPORTED",r=Date.now();if(n!==e.type){e.lastTypeChangedAt=r,"none"==n?e.lastDisconnectedAt=r:"none"==e.type&&(e.lastConnectedAt=r),e.type=n;var i={type:"networkTypeChanged",networkType:n};e.dispatchEvent(i)}},e.getStats=function(t,n){var r={},i=e._getNetworkInfo();i&&(r.NetworkType=i.type||"UNSUPPORTED"),setTimeout((function(){t(r)}),0)},e._init((function(){navigator.connection.addEventListener("change",(function(){e._reloadNetworkInfo()})),e.networkChangeTimer=setInterval((function(){e._reloadNetworkInfo()}),5e3)}),(function(e){})),e},P=n(55),D=n(16),Z=n(56),j=n.n(Z),W=n(21),G=function(){return"HTTPS"===(L||L||(L=(window.location.protocol.split(":")[0]||"").toUpperCase()))},F=function(){return void 0!==window.isSecureContext},U="host",X=function(e){var t={key:void 0,highStream:null,lowStream:null,lowStreamParameter:null,isDualStream:!1,highStreamState:2,lowStreamState:2,proxyServer:null,turnServers:[],useProxyServer:!1,useLocalAccessPoint:!1};if(t.mode=e.mode,t.codec=e.codec,t.clientId=Object(I.generateSessionId)().slice(0,5),t.uintUid=null,t.customReportCount=0,e=_()({},e),t.aespassword=null,t.aesmode="none",t.hasPublished=!1,t.getSessionId=function(){return e.sessionId},t.startChannelMediaRelay=function(n,r){var i=o.report.reportApiInvoke(e.sessionId,{callback:function(e){if(e)return r&&r(e);r&&r()},name:"Client.startChannelMediaRelay",options:arguments,tag:"tracer"});if(!(n instanceof m.ChannelMediaRelayConfiguration))throw"Configration should be instance of [ChannelMediaRelayConfiguration]";var a=n.getSrcChannelMediaInfo(),s=n.getDestChannelMediaInfos();if(Object(M.isEmpty)(a))throw"srcChannelMediaInfo should not be empty";if(Object(M.isEmpty)(s)||0===s.length)throw"destChannelMediaInfos should not be empty";if(!Object(I.is32Uint)(a.uid))throw"Invalid uid in srcChannelMediaInfo";if(!Object(M.isValidChannelName)(a.channelName))throw"Invalid channelName in srcChannelMediaInfo";if(a.token&&!Object(M.isValidToken)(a.token))throw"Invalid token in srcChannelMediaInfo";if(s.forEach((function(e){if(!Object(I.is32Uint)(e.uid))throw"Invalid uid in destChannelMediaInfo";if(!Object(M.isValidChannelName)(e.channelName))throw"Invalid channelName in destChannelMediaInfo";if(e.token&&!Object(M.isValidToken)(e.token))throw"Invalid token in destChannelMediaInfo"})),t.gatewayClient.state!==T.a.CONNECTED)throw"startChannelMediaRelay should be used after join";t.gatewayClient.startChannelMediaRelay(n).then((function(){i&&i()})).catch((function(e){i&&i(e)}))},t.updateChannelMediaRelay=function(n,r){var i=o.report.reportApiInvoke(e.sessionId,{callback:function(e){if(e)return r&&r(e);r&&r()},name:"Client.updateChannelMediaRelay",options:arguments,tag:"tracer"});if(!(n instanceof m.ChannelMediaRelayConfiguration))throw"Configration should be instance of [ChannelMediaRelayConfiguration]";var a=n.getSrcChannelMediaInfo(),s=n.getDestChannelMediaInfos();if(Object(M.isEmpty)(a))throw"srcChannelMediaInfo should not be empty";if(Object(M.isEmpty)(s)||0===s.length)throw"destChannelMediaInfos should not be empty";if(!Object(I.is32Uint)(a.uid))throw"Invalid uid in srcChannelMediaInfo";if(!Object(M.isValidChannelName)(a.channelName))throw"Invalid channelName in srcChannelMediaInfo";if(a.token&&!Object(M.isValidToken)(a.token))throw"Invalid token in srcChannelMediaInfo";if(s.forEach((function(e){if(!Object(I.is32Uint)(e.uid))throw"Invalid uid in destChannelMediaInfo";if(!Object(M.isValidChannelName)(e.channelName))throw"Invalid channelName in destChannelMediaInfo";if(e.token&&!Object(M.isValidToken)(e.token))throw"Invalid token in destChannelMediaInfo"})),t.gatewayClient.state!==T.a.CONNECTED)throw"updateChannelMediaRelay should be used after join";t.gatewayClient.updateChannelMediaRelay(n).then((function(){i&&i()})).catch((function(e){i&&i(e)}))},t.stopChannelMediaRelay=function(n){var r=o.report.reportApiInvoke(e.sessionId,{callback:function(e){if(e)return n&&n(e);n&&n()},name:"Client.stopChannelMediaRelay",options:arguments,tag:"tracer"});t.gatewayClient.stopChannelMediaRelay().then((function(){r&&r()})).catch((function(e){r&&r(e)}))},t.getConnectionState=function(){var n=o.report.reportApiInvoke(e.sessionId,{name:"Client.getConnectionState",options:arguments,tag:"tracer"}),r=T.a.connetionStateMap[t.gatewayClient.state];return n(),r},t.setClientRole=function(n,r){var a=o.report.reportApiInvoke(e.sessionId,{callback:r,name:"Client.setClientRole",options:arguments,tag:"tracer"});if(Object(M.checkValidEnum)(n,"setClientRole",[U,"audience"]),"rtc"===t.mode){var s="RTC mode can not use setClientRole";return i.default.warning("[".concat(t.clientId,"] ").concat(s)),a&&a(s)}t.gatewayClient&&t.gatewayClient.state===T.a.CONNECTED?("audience"===n&&(0===this.highStreamState?this._unpublish(this.highStream,(function(){a&&a(null,{role:n})}),(function(e){a&&a(e)})):t.gatewayClient.setClientRole("audience",a)),n===U&&t.gatewayClient.setClientRole(U,a)):(t.gatewayClient.role=n,a&&a(null,{role:n}))},t.getGatewayInfo=function(e){if(t.gatewayClient.state!==T.a.CONNECTED){var n="Client is not in connected state";return i.default.error("[".concat(t.clientId,"] ").concat(n)),void e(n)}t.gatewayClient.getGatewayInfo((function(t){e(null,t)}),e)},t.renewToken=function(n,r,a){var s=o.report.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return i.default.error("Failed to renew token ".concat(e),t),a&&a(e);r&&r(t)},name:"Client.renewToken",options:arguments,tag:"tracer"});if(!Object(M.isValidToken)(n))throw new Error("Invalid token: Token is of the string type .Length of the string: [1,255]. ASCII characters only.");return t.gatewayClient?t.key?(t.key=n,void t.gatewayClient.renewToken(n,(function(e){return s(null,e)}),s)):(i.default.error("[".concat(t.clientId,"] renewToken should not be called before user join")),s(R.default.INVALID_OPERATION)):(i.default.error("[".concat(t.clientId,"] renewToken Failed. GatewayClient not Exist")),s(R.default.INVALID_OPERATION))},t.setLowStreamParameter=function(n){var r=o.report.reportApiInvoke(e.sessionId,{name:"Client.setLowStreamParameter",options:arguments,tag:"tracer"});Object(M.checkValidObject)(n,"param");var a=n.width,s=n.height,c=n.framerate,u=n.bitrate;Object(M.isEmpty)(a)||Object(M.checkValidNumber)(a,"width"),Object(M.isEmpty)(s)||Object(M.checkValidNumber)(s,"height"),Object(M.isEmpty)(c)||Object(M.checkValidNumber)(c,"framerate"),Object(M.isEmpty)(u)||Object(M.checkValidNumber)(u,"bitrate",1,1e7),(!a&&s||a&&!s)&&i.default.warning("[".concat(t.clientId,"] The width and height parameters take effect only when both are set")),t.lowStreamParameter=n,r()},t.init=function(t,n,r){var i=o.report.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return r&&r(e);n&&n(t)},name:"Client.init",options:arguments,tag:"tracer"});Object(M.checkValidString)(t),Object(s.isChromeKernel)()&&Object(s.getChromeKernelVersion)()<=48?r?i(R.default.BAD_ENVIRONMENT):Object(I.popBanTip)():(e.appId=t,e.sessionId=Object(I.generateSessionId)(),i())},t.setTurnServer=function(n){var r=o.report.reportApiInvoke(e.sessionId,{name:"Client.setTurnServer",options:arguments,tag:"tracer"});if(t.gatewayClient&&t.gatewayClient.state!==T.a.DISCONNECTED)throw new Error("Set turn server before join channel");if(t.useProxyServer)throw new Error("You have already set the proxy");if(t.useLocalAccessPoint)throw new Error("You have already set the local proxy");n instanceof Array||(n=[n]);var a=[];n.map((function(e,n){Object(M.checkValidObject)(e,"turnServer");var r=e.turnServerURL,o=e.username,s=e.password,c=e.udpport,u=e.forceturn,d=e.tcpport;if(Object(M.checkValidString)(r,"turnServerURL"),Object(M.checkValidString)(o,"username"),Object(M.checkValidString)(s,"password"),Object(M.checkValidString)(c,"udpport"),0===parseInt(c))throw new Error("udpport should not be ".concat(c));Object(M.isEmpty)(u)||Object(M.checkValidBoolean)(u,"forceturn");var l={mode:"manual"};if(l.url=r,l.udpport=c,l.username=o,l.credential=s,l.forceturn=u||!1,!Object(M.isEmpty)(d)){if(Object(M.checkValidString)(d,"tcpport"),0===parseInt(d))throw new Error("tcpport should not be ".concat(d));l.tcpport=d,i.default.info("[".concat(t.clientId,"] Set turnserver[").concat(n,"] tcpurl. ").concat(l.url,":").concat(l.tcpport))}i.default.info("[".concat(t.clientId,"] Set turnserver[").concat(n,"] udpurl. ").concat(l.url,":").concat(l.udpport,",username: ").concat(l.username)),a.push(l)})),t.turnServers=a,r()},t.setProxyServer=function(n){var r=o.report.reportApiInvoke(e.sessionId,{name:"Client.setProxyServer",options:arguments,tag:"tracer"});if(t.gatewayClient&&t.gatewayClient.state!==T.a.DISCONNECTED)throw new Error("Set proxy server before join channel");if(!n)throw new Error("Do not set the proxyServer parameter as empty");if(t.useProxyServer)throw new Error("You have already set the proxy");if(t.useLocalAccessPoint)throw new Error("You have already set the local proxy");Object(M.checkValidString)(n,"proxyServer"),t.proxyServer=n,o.report.setProxyServer(n),i.default.setProxyServer(n),r()},t.startProxyServer=function(n){var r=o.report.reportApiInvoke(e.sessionId,{name:"Client.startProxyServer",options:arguments,tag:"tracer"});if(t.gatewayClient&&t.gatewayClient.state!==T.a.DISCONNECTED)throw new Error("Start proxy server before join channel");if(t.proxyServer)throw new Error("You have already set the proxy");if(t.useLocalAccessPoint)throw new Error("You have already set the local proxy");t.useProxyServer=!0,t.proxyServerType=n||1,r()},t.stopProxyServer=function(){var n=o.report.reportApiInvoke(e.sessionId,{name:"Client.stopProxyServer",options:arguments,tag:"tracer"});if(t.gatewayClient&&t.gatewayClient.state!==T.a.DISCONNECTED)throw new Error("Stop proxy server after leave channel");o.report.setProxyServer(),i.default.setProxyServer(),t.turnServers=[],t.proxyServer=null,t.useProxyServer=!1,t.proxyServerType=null,n()},t.setEncryptionSecret=function(n){var r=o.report.reportApiInvoke(e.sessionId,{name:"Client.setEncryptionSecret",options:arguments,tag:"tracer"});Object(M.checkValidString)(n,"password");var a=new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*])(?=.{8,})");a.test(n)||i.default.warning("The secret is not strong:\n      The secret must contain at least 1 lowercase alphabetical character,\n      The secret must contain at least 1 uppercase alphabetical character,\n      The secret must contain at least 1 numeric character,\n      The secret must contain at least one special character,\n      The secret must be eight characters or longer,\n      "),t.aespassword=n,r()},t.setEncryptionMode=function(n,r){var i=o.report.reportApiInvoke(e.sessionId,{name:"Client.setEncryptionMode",options:arguments,tag:"tracer"});if(Object(M.checkValidString)(n,"encryptionMode"),-1===y.indexOf(n))throw new Error('Invalid encryptionMode: encryptionMode should be "aes-128-xts" | "aes-256-xts" | "aes-128-ecb" | "sm4-128-ecb" | "aes-128-gcm" | "aes-256-gcm" | "aes-128-gcm2" | "aes-256-gcm2"');var a=["aes-128-gcm2","aes-256-gcm2"];if(-1!==a.indexOf(n)){if(!r||!(r instanceof Uint8Array&&32===r.length))throw Error("salt must be an Uint8Array and exactly equal to 32 bytes")}else if(r)throw new Error("Only ".concat("aes-128-gcm2"," and ").concat("aes-256-gcm2"," support use salt"));r&&(t.aesSalt=Object(I.uint8ArrayToBase64)(r)),t.aesmode=n,i()},t.configPublisher=function(n){var r=o.report.reportApiInvoke(e.sessionId,{name:"Client.configPublisher",options:arguments,tag:"tracer"});Object(M.checkValidObject)(n,"config");var i=n.width,a=n.height,s=n.framerate,c=n.bitrate,u=n.publisherUrl;Object(M.checkValidNumber)(i,"width"),Object(M.checkValidNumber)(a,"height"),Object(M.checkValidNumber)(s,"framerate"),Object(M.checkValidNumber)(c,"bitrate",1,1e7),u&&Object(M.checkValidString)(u,"publisherUrl"),t.gatewayClient.configPublisher(n),r()},t.enableDualStream=function(n,r){var a=o.report.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return r&&r(e);n&&n(t)},name:"Client.enableDualStream",options:arguments,tag:"tracer"});return"iOS"===Object(s.getBrowserOS)()?(o.report.streamSwitch(e.sessionId,{lts:(new Date).getTime(),isdual:!0,succ:!1}),a(R.default.IOS_NOT_SUPPORT)):Object(s.isWeChatBrowser)()?(o.report.streamSwitch(e.sessionId,{lts:(new Date).getTime(),isdual:!0,succ:!1}),a(R.default.WECHAT_NOT_SUPPORT)):(o.report.streamSwitch(e.sessionId,{lts:(new Date).getTime(),isdual:!0,succ:!0}),t.isDualStream=!0,t.highStream&&(t.highStream.isDualStream=!0),void(0===t.highStreamState?t._publishLowStream((function(e){return a(null,e)}),(function(e){i.default.warning("[".concat(t.clientId,"]"),e),a(R.default.ENABLE_DUALSTREAM_FAILED)})):1===t.highStreamState?a(R.default.STILL_ON_PUBLISHING):a(null)))},t.disableDualStream=function(n,r){var a=o.report.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return r&&r(e);n&&n(t)},name:"Client.disableDualStream",options:arguments,tag:"tracer"});o.report.streamSwitch(e.sessionId,{lts:(new Date).getTime(),isdual:!1,succ:!0}),t.isDualStream=!1,t.highStream&&(t.highStream.isDualStream=!1),0===t.highStreamState?t._unpublishLowStream((function(){t.highStream.lowStream=null,a()}),(function(e){i.default.warning("[".concat(t.clientId,"]"),e),a(R.default.DISABLE_DUALSTREAM_FAILED)})):1===t.highStreamState?a(R.default.STILL_ON_PUBLISHING):a()},t._getLowStream=function(e,n){t.lowStream?e(t.lowStream):t._createLowStream((function(n){t.lowStream=n,e(t.lowStream)}),n)},t._createLowStream=function(e,n){if(t.highStream&&t.highStream.stream){var r=_()({},t.highStream.params);if(r.streamID+=1,r.audio=!1,r.video)if(t.highStream.stream.getVideoTracks()[0]){var i=new l.a(r);i.isLowStream=!0,i.streamId=t.highStream.getId()+1;var o={};t.lowStreamParameter&&(o=_()({},t.lowStreamParameter)),o.width&&o.height||(o.width=160,o.height=120),o.framerate=o.framerate||15,o.bitrate=o.bitrate||50,i.setVideoProfileCustomPlus(o);try{var a=j()(t.highStream,{width:i.videoConstraint.width.ideal,height:i.videoConstraint.height.ideal,framerate:i.videoConstraint.frameRate});return i.stream=a,t.highStream.lowStream=i,t.highStream.userMuteVideo&&i.muteVideo(),e&&e(i)}catch(e){return n&&n(e)}}else n&&n(R.default.HIGH_STREAM_NOT_VIDEO_TRACE);else n&&n(R.default.HIGH_STREAM_NOT_VIDEO_TRACE)}else n&&n(R.default.HIGH_STREAM_NOT_VIDEO_TRACE)},t._publishLowStream=function(e,n){return 2!==t.lowStreamState?n&&n(R.default.LOW_STREAM_ALREADY_PUBLISHED):t.highStream&&t.highStream.hasScreen()?n&&n(R.default.SHARING_SCREEN_NOT_SUPPORT):void t._getLowStream((function(r){t.lowStreamState=1,t.gatewayClient.publish(r,{streamType:1},(function(){t.lowStreamState=0,e&&e()}),(function(e){1===t.lowStreamState&&(t.lowStreamState=2),i.default.debug("[".concat(t.clientId,"] publish low stream failed")),n&&n(e)}))}),n)},t._unpublishLowStream=function(e,n){if(0!==t.lowStreamState)return n&&n(R.default.LOW_STREAM_NOT_YET_PUBLISHED);t.lowStream&&(t.gatewayClient.unpublish(t.lowStream,{streamType:1},(function(){}),(function(e){i.default.debug("[".concat(t.clientId,"] unpublish low stream failed")),n&&n(e)})),t.lowStream.close(),t.lowStream=null,t.lowStreamState=2,e&&e())},t.join=function(n,r,a,c,d,l){c&&"function"==typeof c&&(l=d,d=c,c=null);var f=u(),p=Object(s.getBrowserInfo)();i.default.debug(p,",Support: "+f);var h=G(),m="The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser",g=F()?window.isSecureContext:"Browser Not Support",v=function(){i.default.warning(m)};F()?window.isSecureContext||v():h||v();var y=o.report.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return l&&l(e);d&&d(t)},name:"Client.join",options:arguments,getStates:function(){return{isHttps:h,isSecureContext:g}},tag:"tracer"});if(n&&!Object(M.isValidToken)(n))return i.default.warning("[".concat(t.clientId,"] Param channelKey should be string")),y(R.default.INVALID_PARAMETER);if(!Object(M.isValidChannelName)(r))return i.default.error("Invalid Channel Name ".concat(r)),i.default.warning("[".concat(t.clientId,"] The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")),y(R.default.INVALID_PARAMETER);if("string"==typeof r&&""===r)return i.default.warning("[".concat(t.clientId,"] Param channel should not be empty")),y(R.default.INVALID_PARAMETER);if(c&&!Object(M.isValidString)(c))return i.default.warning("[".concat(t.clientId,"] optionalInfo should be string")),y(R.default.INVALID_PARAMETER);if(a&&!Object(I.is32Uint)(a)&&!Object(M.isValidString)(a,1,255))return i.default.error("Invalid UID ".concat(a," ").concat(S()(a))),i.default.warning("[".concat(t.clientId,"] [String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is 32Uint")),y(R.default.INVALID_PARAMETER);if("string"==typeof a&&0==a.length)return i.default.warning("[".concat(t.clientId,"] String uid should not be empty")),y(R.default.INVALID_PARAMETER);if("string"==typeof a&&a.length>256)return i.default.warning("[".concat(t.clientId,"] Length of string uid should be less than 255")),y(R.default.INVALID_PARAMETER);i.default.stopWaitJoin(),t.highStream=null,t.lowStream=null,t.lowStreamParameter=null,t.isDualStream=!1,t.highStreamState=2,t.lowStreamState=2;var b=Date.now(),E=setTimeout((function(){if(1!=t.gatewayClient.hasJoined){i.default.debug("[".concat(t.clientId,"] The time to join the channel is greater than 5 seconds "));var n=Date.now();o.report.joinChannelTimeOut({lts:n,sid:e.sessionId,cname:r,cid:C&&C.cid,uid:C.uid||("string"==typeof a?void 0:a),elapse:n-b,timeout:5})}}),5e3),C={clientId:t.clientId,appId:e.appId,sid:e.sessionId,cname:r,uid:a,turnServers:t.turnServers.concat(),proxyServer:t.proxyServer,token:n||e.appId,useProxyServer:t.useProxyServer,useLocalAccessPoint:t.useLocalAccessPoint,proxyServerType:t.proxyServerType,optionalInfo:c};if("string"==typeof a&&(C.stringUid=a,t.uintUid?(C.uid=t.uintUid,delete t.uintUid):C.uid=0),t.aespassword&&"none"!==t.aesmode&&_()(C,{aespassword:t.aespassword,aesmode:t.aesmode}),t.aesSalt&&(C.aes_salt=t.aesSalt),o.report.sessionInit(e.sessionId,{lts:(new Date).getTime(),cname:r,appid:e.appId,mode:e.mode,succ:!0}),t.onSuccess=function(e){clearTimeout(E),t.rtcStatsCollector.startNetworkQualityTimer(),t.onSuccess=null,y(null,e)},t.onFailure=function(e){return y(e)},t.channel=r,t.gatewayClient.state!==T.a.DISCONNECTED)return i.default.error("[".concat(t.clientId,"] Client already in connecting/connected state")),y(R.default.INVALID_OPERATION),void o.report.joinGateway(e.sessionId,{lts:Date.now(),succ:!1,ec:R.default.INVALID_OPERATION,addr:null});t.gatewayClient.state=T.a.CONNECTING;var O=function(o,a){i.default.info("[".concat(t.clientId,"] Joining channel: ").concat(r)),t.gatewayClient.dispatchEvent({type:"config-distribute",config:a,joinInfo:C}),t.key=n||e.appId,C.cid=o.cid,C.uid||(C.uid=o.uid),C.vid=o.vid,C.clientId=t.clientId,C.apResponse=o.res,o.uni_lbs_ip&&o.uni_lbs_ip[1]&&(C.uni_lbs_ip=o.uni_lbs_ip[1]),C.gatewayAddr=o.gateway_addr,t.joinInfo=C,t.gatewayClient.join(C,t.key,(function(e){i.default.info("[".concat(t.clientId,"] Join channel ").concat(r," success, join with uid: ").concat(e,".")),t.onSuccess=null,t.rtcStatsCollector.startNetworkQualityTimer(),y(null,e)}),(function(e){return y(e)}))};C.stringUid&&!C.uid?(t.userAccountReq&&!t.userAccountReq.isFinished()&&t.userAccountReq.cancel(),t.userAccountReq=Object(w.getUserAccount)(C,t.gatewayClient),t.userAccountReq.then((function(e){i.default.debug("getUserAccount Success ".concat(e.url," ").concat(C.stringUid," => ").concat(e.uid)),C.uid=e.uid,Object(w.getGatewayList)(C,O,(function(e){return y(e)}))})).catch((function(e){i.default.error("getUserAccount rejected",e),y(e)}))):Object(w.getGatewayList)(C,O,(function(e){return y(e)}))},t.renewChannelKey=function(n,r,a){var s=o.report.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return a&&a(e);r&&r(t)},name:"Client.renewChannelKey",options:arguments,tag:"tracer"});Object(M.checkValidString)(n,"key",1,2047),void 0===t.key?(i.default.error("[".concat(t.clientId,"] renewChannelKey should not be called before user join")),s(R.default.INVALID_OPERATION)):(t.key=n,t.gatewayClient.joinInfo.token=n,t.gatewayClient.key=n,t.gatewayClient.recover(),s())},t.leave=function(n,a){t.gatewayClient.isFirstSuccess=!0,t.gatewayClient.hasInvokeLeave=!0;var s=!1,c=o.report.reportApiInvoke(e.sessionId,{callback:function(e,r){if(e)return a&&a(e);t.gatewayClient.reconnectingCS=!1,t.gatewayClient.state=T.a.DISCONNECTED,clearTimeout(Object(w._getReconnectCSTimer)(t.clientId)),t._renewSession(),t.rtcStatsCollector.clearNetworkQualityTimer(),n&&n(r)},name:"Client.leave",options:arguments,tag:"tracer"});i.default.info("[".concat(t.clientId,"] Leaving channel")),t.userAccountReq&&!t.userAccountReq.isFinished()&&(t.userAccountReq.cancel(),t.gatewayClient.state===T.a.CONNECTING&&(t.gatewayClient.state=T.a.DISCONNECTED)),t._terminateLiveStreaming(),t.gatewayClient.leave((function(e){s=!0,c(null,e)}),c),setTimeout((function(){s||(t.gatewayClient.socket&&(t.gatewayClient.socket.close(),t.gatewayClient.socket=null),t.gatewayClient.state=T.a.DISCONNECTED,c(null,"LEAVE_MSG_TIMEOUT"))}),Object(r.getParameter)("LEAVE_MSG_TIMEOUT"))},t._renewSession=function(){var n=Object(I.generateSessionId)();if(i.default.debug("renewSession ".concat(e.sessionId," => ").concat(n)),e.sessionId=n,t.gatewayClient.peerPublishDurationMap.clear(),t.joinInfo&&(t.joinInfo.sid=n),t.gatewayClient&&(t.gatewayClient.joinInfo&&(t.gatewayClient.joinInfo.sid=n),t.gatewayClient.localStreams))for(var r in t.gatewayClient.localStreams){var o=t.gatewayClient.localStreams[r];o&&(o.sid=n)}},t._publish=function(n,o,a,s){if(2!==t.highStreamState)return i.default.warning("[".concat(t.clientId,"] Can't publish stream when stream already publish ").concat(n.getId())),a&&a(R.default.STREAM_ALREADY_PUBLISHED);if(0===t.turnServers.length&&Object(r.getParameter)("FORCE_TURN")&&!Object(r.getParameter)("TURN_ENABLE_TCP")&&!Object(r.getParameter)("TURN_ENABLE_UDP"))throw new Error("force TURN With No TURN Configuration");i.default.info("[".concat(t.clientId,"] Publishing stream, uid ").concat(n.getId())),t.highStream=n,t.highStreamState=1,t.highStream.streamId=t.joinInfo.stringUid||t.joinInfo.uid,t.hasPublished=!1;var c=function(n,r,o){t.gatewayClient.publish(n,{streamType:0},(function(){n.sid=e.sessionId,t.highStreamState=0,i.default.info("[".concat(t.clientId,"] Publish success, uid: ").concat(n.getId())),t.highStream&&(t.highStream.isDualStream=t.isDualStream),t.isDualStream?t._publishLowStream((function(){r&&r()}),(function(e){i.default.warning("[".concat(t.clientId,"] "),e),D.a.replaceWithCanvasTrack(n).then((function(){r&&r()}))})):D.a.replaceWithCanvasTrack(n).then((function(){r&&r()}))}),o)};"audience"!==t.gatewayClient.role||"live"!==t.mode||s?c(n,o,a):t.gatewayClient.setClientRole(U,(function(e){if(e)return a&&a(e);c(n,o,a)}))},t._unpublish=function(e,n,r,o){if(0!==t.highStreamState)return i.default.warning("[".concat(t.clientId,"] Can't unpublish stream when stream not publish")),r&&r(R.default.STREAM_NOT_YET_PUBLISHED);i.default.info("[".concat(t.clientId,"] Unpublish stream, uid ").concat(e.getId()));var a=function(e,n,r){t.isDualStream&&t.lowStream&&t._unpublishLowStream(null,r),t.gatewayClient.unpublish(e,{streamType:0},(function(){t.highStreamState=2,i.default.info("[".concat(t.clientId,"] Unpublish stream success, uid: ").concat(e.getId())),t.gatewayClient.dispatchEvent({type:"stream-unpublished",stream:e}),n&&n()}),(function(n){i.default.info("[".concat(t.clientId,"] Unpublish stream fail, uid: ").concat(e.getId())),r&&r(n)}))};t.gatewayClient.role!==U||"live"!==t.mode||o?a(e,n,r):t.gatewayClient.setClientRole("audience",(function(t){if(t)return r&&r(t);a(e,n,r)}))},t.publish=function(n,r){var i=o.report.reportApiInvoke(e.sessionId,{callback:function(e,n){if(e)return 1===t.highStreamState&&"REQUEST_ABORT"!==e&&(t.highStreamState=2),r&&r(e)},name:"Client.publish",tag:"tracer",options:{stream:"too long to show",onFailure:!!r}});2===t.highStreamState?n._hasVideoTracks()||n._hasAudioTracks()?(t.gatewayClient.publishRequestId=Object(I.generateId)(),t._publish(n,(function(e){return i(null,e)}),(function(e){return i(e)}))):i(R.default.NO_TRACK_IN_STREAM):i(R.default.STREAM_ALREADY_PUBLISHED)},t.unpublish=function(n,r,i){var a=o.report.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return r&&r(e);i&&i(t)},name:"Client.unpublish",tag:"tracer",options:{stream:"too long to show",onFailure:!!r}});0===t.highStreamState?(t.gatewayClient.publishRequestId=null,t._unpublish(n,(function(e){return a(null,e)}),(function(e){return a(e)}))):a(R.default.STREAM_NOT_YET_PUBLISHED)},t.subscribe=function(n,r,a){var c=o.report.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return a&&a(e)},name:"Client.subscribe",tag:"tracer",options:{stream:"too long to show",options:r,onFailure:!!a}});"function"==typeof r&&(a=r,r=null),Object(M.checkValidObject)(n,"stream"),Object(M.isEmpty)(r)||(Object(M.checkValidObject)(r,"options"),Object(M.isEmpty)(r.video)||Object(M.checkValidBoolean)(r.video,"options.video"),Object(M.isEmpty)(r.audio)||Object(M.checkValidBoolean)(r.audio,"options.audio"));var u={video:!0,audio:!0};if(!Object(M.isEmpty)(r)){if(Object(s.isSafari)()&&(!r.video||!r.audio)){var d="SAFARI_NOT_SUPPORTED_FOR_TRACK_SUBSCRIPTION";return i.default.error("[".concat(t.clientId,"] "),d),void c(d)}if(!Object(M.isEmpty)(r.video)&&!Object(M.isValidBoolean)(r.video)||!Object(M.isEmpty)(r.audio)&&!Object(M.isValidBoolean)(r.audio)||!1===r.audio&&!1===r.video)return d="INVALID_PARAMETER ".concat(JSON.stringify(r)),i.default.error("[".concat(t.clientId,"] "),d),void c(d)}n.subscribeOptions?(_()(n.subscribeOptions,u,r),t.gatewayClient.subscribeChange(n,(function(e){return c(null,e)}),c)):(t.gatewayClient.subscribeRequestId.set(n.getId(),Object(I.generateId)()),n.subscribeOptions=_()({},u,r),t.gatewayClient.subscribe(n,(function(e){return c(null,e)}),c))},t.unsubscribe=function(n,r){var a=o.report.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return r&&r(e)},name:"Client.unsubscribe",tag:"tracer",options:{stream:"too long to show",onFailure:!!r}});i.default.info("[".concat(t.clientId,"] Unsubscribe stream, uid: ").concat(n.getId())),t.gatewayClient.subscribeRequestId.delete(n.getId()),t.gatewayClient.unsubscribe(n,(function(e){return a(null,e)}),a)},t.setRemoteVideoStreamType=function(n,r){var i=o.report.reportApiInvoke(e.sessionId,{name:"Client.setRemoteVideoStreamType",tag:"tracer",options:{stream:"too long to show",streamType:r}});Object(M.checkValidEnum)(r,"streamType",[0,1]),t.gatewayClient.setRemoteVideoStreamType(n,r),i()},t.setStreamFallbackOption=function(n,r){var i=o.report.reportApiInvoke(e.sessionId,{name:"Client.setStreamFallbackOption",tag:"tracer",options:{stream:"too long to show",fallbackType:r}});Object(M.checkValidEnum)(r,"fallbackType",[0,1,2]),t.gatewayClient.setStreamFallbackOption(n,r),i()},t.enableAudioVolumeIndicator=function(n,r){var a=o.report.reportApiInvoke(e.sessionId,{name:"Client.enableAudioVolumeIndicator",options:arguments,tag:"tracer"});n=n||2e3,r=r||3,Object(M.checkValidNumber)(r,"smooth",1,100),Object(M.checkValidNumber)(n,"interval",50,1e5),t.audioVolumeIndication=t.audioVolumeIndication||{enabled:!0},t.audioVolumeIndication.interval=n,t.audioVolumeIndication.smooth=r,t.audioVolumeIndication={interval:n,smooth:r},i.default.info("[".concat(t.clientId,"] enableAudioVolumeIndicator interval ").concat(n," smooth ").concat(r)),t.gatewayClient.enableAudioVolumeIndicator(n,r),a()},t.getNetworkStats=function(e,n){return i.default.deprecate("[".concat(t.clientId,"] client.getNetworkStats is deprecated. Use client.getTransportStats instead.")),V.getStats(e,n)},t.getSystemStats=function(e,t){return d.getStats(e,t)},t.getRecordingDevices=function(e,t){return f.a.getRecordingDevices(e,t)},t.getPlayoutDevices=function(e,t){return f.a.getPlayoutDevices(e,t)},t.getCameras=function(e,t){return f.a.getCameras(e,t)},t.getRemoteAudioStats=function(e,n){return t.rtcStatsCollector.getRemoteAudioStats(e,n)},t.getLocalAudioStats=function(e,n){return t.rtcStatsCollector.getLocalAudioStats(e,n)},t.getRemoteVideoStats=function(e,n){return t.rtcStatsCollector.getRemoteVideoStats(e,n)},t.getLocalVideoStats=function(e,n){return t.rtcStatsCollector.getLocalVideoStats(e,n)},t._getRemoteVideoQualityStats=function(e,n){return t.rtcStatsCollector.getRemoteVideoQualityStats(e,n)},t._getRemoteAudioQualityStats=function(e,n){return t.rtcStatsCollector.getRemoteAudioQualityStats(e,n)},t.getTransportStats=function(e,n){return t.rtcStatsCollector.getTransportStats((function(t){return V.getStats((function(n){var r=_()({},t,n);e&&e(r)}),n)}),n)},t.getSessionStats=function(e,n){return t.rtcStatsCollector.getSessionStats(e,n)},t.onNetworkQuality=function(){return t.rtcStatsCollector.onNetworkQuality(onSuccess,onFailure)},t.sendMetadata=function(n,r){var i=o.report.reportApiInvoke(e.sessionId,{name:"Client.sendMetadata",tag:"tracer",callback:function(e){if(e)return r&&r(e);r&&r()}});t.gatewayClient.sendMetadata(n,i)},t.sendCustomReportMessage=function(n,a,s,c,u,d){Object(r.getParameter)("CR")?t.customReportCount>Object(r.getParameter)("CRL")?d&&d("REPORT_LIMITED"):(t.gatewayClient.hasJoined||(i.default.WARNING("Should invoke Client.sendCustomReportMessage after join"),d&&d("REPORT_BEFORE_JOINED")),t.customReportTimer||(t.customReportTimer=setInterval((function(){t.customReportCount=0}),Object(r.getParameter)("CRI"))),Object(M.checkValidString)(n,"reportId",0,100,!1),Object(M.checkValidString)(a,"category",0,100,!1),Object(M.checkValidString)(s,"event",0,100,!1),Object(M.checkValidString)(c,"label",0,100,!1),Object(M.checkValidNumber)(u,"value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),t.customReportCount++,o.report.sendCustomReportMessage(e.sessionId,{reportId:n,category:a,event:s,label:c,value:u,lts:Date.now()},(function(e){e?d&&d("REPORT_FAILED"):d&&d()}))):d&&d("REPORT_FORBIDDEN")},t.setLocalAccessPoints=function(n,i){var a=o.report.reportApiInvoke(e.sessionId,{name:"Client.setLocalAccessPoints",tag:"tracer"});if(Object(M.checkValidArray)(n,"serverList"),Object(M.checkValidString)(i,"domain"),t.useProxyServer)throw new Error("You have already set the proxy");var s=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;n=n.map((function(e){return s.test(e)?"".concat(e.replace(/\./g,"-"),".").concat(i):e})),t.useLocalAccessPoint=!0,Object(r.setParameter)("WEBCS_DOMAIN",n),Object(r.setParameter)("WEBCS_DOMAIN_BACKUP_LIST",n),Object(r.setParameter)("GATEWAY_DOMAINS",[i]),Object(r.setParameter)("EVENT_REPORT_DOMAIN",n[Math.floor(Math.random()*n.length)]),Object(r.setParameter)("EVENT_REPORT_BACKUP_DOMAIN",n[Math.floor(Math.random()*n.length)]),Object(r.setParameter)("LOG_UPLOAD_SERVER","".concat(n[Math.floor(Math.random()*n.length)],":6444")),a()},e.clientId=t.clientId,t.gatewayClient=Object(T.a)(e),t.listenerLoggerTimer=null,t.listenerLoggerCache=[],t.on=function(e,n){t.gatewayClient.on(e,n),t.listenerLoggerCache.push("".concat(e).concat(n.name?":"+n.name:"")),t.listenerLoggerTimer?clearTimeout(t.listenerLoggerTimer):i.default.info("[".concat(t.clientId,"] Adding event handler on ").concat(e)),t.listenerLoggerTimer=setTimeout((function(){t.listenerLoggerCache.length&&(t.listenerLoggerTimer=null,i.default.info("[".concat(t.clientId,"] Added event handler on ").concat(t.listenerLoggerCache.join(", "))),t.listenerLoggerCache=[])}),0)},t.off=function(e,n){i.default.info("remove event handler from [".concat(e,"]")),t.gatewayClient.removeEventListener(e,n)},t.rtcStatsCollector=function(e){var t=Object(a.b)();return t.gatewayClient=e,t.exceptionMonitor=new k(e),t.localStats={},t.remoteStats={},t.session={sendBytes:0,recvBytes:0,WSSendBytes:0,WSSendBytesDelta:0,WSRecvBytes:0,WSRecvBytesDelta:0,HTTPSendBytes:0,HTTPSendBytesDelta:0,HTTPRecvBytes:0,HTTPRecvBytesDelta:0},t.getRemoteAudioStats=function(e){var n=t.gatewayClient.traffic_stats,r={};for(var i in t.remoteStats){var o={},a=t.remoteStats[i];if(Object(C.b)(o,"End2EndDelay",a.peer_delay&&a.peer_delay.audio_delay),Object(C.b)(o,"TransportDelay",a.peer_delay&&a.peer_delay.e2e_delay),Object(C.b)(o,"PacketLossRate",a.peer_delay&&a.peer_delay.e2e_audio_lost_ratio_400ms),Object(C.b)(o,"RecvLevel",a.audioStats&&a.audioStats.audioOutputLevel),Object(C.b)(o,"RecvBitrate",a.audioRecvBitrate),Object(C.b)(o,"CodecType",a.audioStats&&a.audioStats.googCodecName),Object(C.b)(o,"MuteState",a.audioDisabled),Object(C.b)(o,"TotalFreezeTime",a.audioStats&&a.audioStats.audioTotalFreezeTime),Object(C.b)(o,"TotalPlayDuration",a.audioStats&&a.audioStats.audioTotalPlayDuration),n&&n.peer_delay){var s=n.peer_delay.find((function(e){return e.peer_uid==i}));if(s){var c=s.peer_publish_audio_duration+(Date.now()-n.timestamp);Object(C.b)(o,"AudioPublishDuration",c)}else Object(C.b)(o,"AudioPublishDuration",-1)}r[i]=o}e&&e(r)},t.getLocalAudioStats=function(e){var n={};for(var r in t.localStats){var i={},o=t.localStats[r];Object(C.b)(i,"RecordingLevel",o.audioStats&&o.audioStats.audioInputLevel),Object(C.b)(i,"SendLevel",o.audioStats&&o.audioStats.totalAudioEnergy),Object(C.b)(i,"SamplingRate",o.audioStats&&o.audioStats.totalSamplesDuration),Object(C.b)(i,"SendBitrate",o.audioSendBitrate),Object(C.b)(i,"CodecType",o.audioStats&&o.audioStats.googCodecName),Object(C.b)(i,"MuteState",o.audioDisabled),Object(C.b)(i,"audioSendPacketsLost",o.audioStats&&o.audioStats.packetsLost);var a=t.gatewayClient.localStreams[r];a&&a.isPlaying()&&Object(C.b)(i,"MuteState",a.userMuteAudio?"1":"0"),n[r]=i}e&&e(n)},t.getRemoteVideoStats=function(e){var n=t.gatewayClient.traffic_stats,r={};for(var i in t.remoteStats){var o={},a=t.remoteStats[i];if(Object(C.b)(o,"End2EndDelay",a.peer_delay&&a.peer_delay.video_delay),Object(C.b)(o,"TransportDelay",a.peer_delay&&a.peer_delay.e2e_delay),Object(C.b)(o,"PacketLossRate",a.peer_delay&&a.peer_delay.e2e_video_lost_ratio_400ms),Object(C.b)(o,"RecvBitrate",a.videoRecvBitrate),Object(C.b)(o,"RecvResolutionWidth",a.videoStats&&a.videoStats.googFrameWidthReceived),Object(C.b)(o,"RecvResolutionHeight",a.videoStats&&a.videoStats.googFrameHeightReceived),Object(C.b)(o,"RenderResolutionWidth",a.videoStats&&a.videoStats.renderRemoteWidth),Object(C.b)(o,"RenderResolutionHeight",a.videoStats&&a.videoStats.renderRemoteHeight),Object(C.b)(o,"RenderFrameRate",a.videoStats&&a.videoStats.googFrameRateOutput),Object(C.b)(o,"MuteState",a.videoDisabled),Object(C.b)(o,"TotalFreezeTime",a.videoStats&&a.videoStats.videoTotalFreezeTime),Object(C.b)(o,"TotalPlayDuration",a.videoStats&&a.videoStats.videoTotalPlayDuration),n&&n.peer_delay){var s=n.peer_delay.find((function(e){return e.peer_uid==i}));if(s){var c=s.peer_publish_video_duration+(Date.now()-n.timestamp);Object(C.b)(o,"VideoPublishDuration",c)}else Object(C.b)(o,"VideoPublishDuration",-1)}r[i]=o}e&&e(r)},t.getLocalVideoStats=function(e){var n={};for(var r in t.localStats){var i={},o=t.localStats[r];Object(C.b)(i,"TargetSendBitrate",o.videoTargetSendBitrate),Object(C.b)(i,"SendFrameRate",o.videoStats&&o.videoStats.googFrameRateSent),Object(C.b)(i,"SendBitrate",o.videoSendBitrate),Object(C.b)(i,"SendResolutionWidth",o.videoStats&&o.videoStats.googFrameWidthSent),Object(C.b)(i,"SendResolutionHeight",o.videoStats&&o.videoStats.googFrameHeightSent),Object(C.b)(i,"CaptureResolutionWidth",o.videoStats&&o.videoStats.googFrameWidthInput),Object(C.b)(i,"CaptureResolutionHeight",o.videoStats&&o.videoStats.googFrameHeightInput),Object(C.b)(i,"EncodeDelay",o.videoStats&&o.videoStats.googAvgEncodeMs),Object(C.b)(i,"MuteState",o.videoDisabled),Object(C.b)(i,"TotalFreezeTime",o.videoStats&&o.videoStats.videoTotalFreezeTime),Object(C.b)(i,"TotalDuration",o.videoStats&&o.videoStats.videoTotalPlayDuration),Object(C.b)(i,"CaptureFrameRate",o.videoStats&&o.videoStats.googFrameRateSent),Object(C.b)(i,"videoSendPacketsLost",o.videoStats&&o.videoStats.packetsLost),o.videoStats&&!o.videoStats.googFrameWidthInput&&Object(C.b)(i,"CaptureResolutionWidth",o.videoStats&&o.videoStats.renderLocalWidth),o.videoStats&&!o.videoStats.googFrameHeightInput&&Object(C.b)(i,"CaptureResolutionHeight",o.videoStats&&o.videoStats.renderLocalHeight),n[r]=i}e&&e(n)},t.getRemoteVideoQualityStats=function(e){var n={};for(var r in t.remoteStats){var i={},o=t.remoteStats[r];Object(C.b)(i,"videoReceiveDelay",o.videoStats&&o.videoStats.googCurrentDelayMs),Object(C.b)(i,"VideoFreezeRate",o.videoStats&&o.videoStats.videoFreezeRate),Object(C.b)(i,"FirstFrameTime",o.firstFrameTime),n[r]=i}e&&e(n)},t.getRemoteAudioQualityStats=function(e){var n={};for(var r in t.remoteStats){var i={},o=t.remoteStats[r];Object(C.b)(i,"audioReceiveDelay",o.audioStats&&o.audioStats.googCurrentDelayMs),Object(C.b)(i,"AudioFreezeRate",o.videoStats&&o.videoStats.videoFreezeRate),n[r]=i}e&&e(n)},t.getTransportStats=function(e){var n={},r={},i=t.gatewayClient.traffic_stats,o=i.peer_delay;if(Object(C.b)(n,"OutgoingAvailableBandwidth",t.gatewayClient.OutgoingAvailableBandwidth/1e3),Object(C.b)(n,"RTT",i&&2*i.access_delay),o){var a,s=function(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?N(e,t):void 0}}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}(o);try{for(s.s();!(a=s.n()).done;){var c=a.value;c.downlink_estimate_bandwidth&&(r[c.peer_uid]=c.downlink_estimate_bandwidth/1e3+"")}}catch(e){s.e(e)}finally{s.f()}}n.IncomingAvailableBandwidth=r,e&&e(n)},t.getSessionStats=function(e){var n={},r=t.gatewayClient.traffic_stats,i=t.gatewayClient.socket,o=0,a=0;for(var s in t.remoteStats)(c=t.remoteStats[s])&&c.videoStats&&c.videoStats.videoRecvBytesDelta&&(a+=parseInt(c.videoStats.videoRecvBytesDelta)),c&&c.audioStats&&c.audioStats.audioRecvBytesDelta&&(a+=parseInt(c.audioStats.audioRecvBytesDelta));for(var s in t.localStats){var c;(c=t.localStats[s])&&c.videoStats&&c.videoStats.videoSendBytesDelta&&(o+=parseInt(c.videoStats.videoSendBytesDelta)),c&&c.audioStats&&c.audioStats.audioSendBytesDelta&&(o+=parseInt(c.audioStats.audioSendBytesDelta))}var u=o+t.session.WSSendBytesDelta+t.session.HTTPSendBytesDelta,d=a+t.session.WSRecvBytesDelta+t.session.HTTPRecvBytesDelta,l=t.session.sendBytes+Object(O.getHTTPSendBytes)(),f=t.session.recvBytes+Object(O.getHTTPRecvBytes)();t.gatewayClient.socket&&t.gatewayClient.socket.state===t.gatewayClient.CONNECTED&&(l+=i.getSendBytes(),f+=i.getRecvBytes());var p=1;r.peer_delay&&(p=r.peer_delay.length,p+=1),i?Object(C.b)(n,"Duration",i.getDuration()):Object(C.b)(n,"Duration",0),Object(C.b)(n,"UserCount",p),Object(C.b)(n,"SendBytes",l),Object(C.b)(n,"RecvBytes",f),Object(C.b)(n,"SendBitrate",8*u/1e3),Object(C.b)(n,"RecvBitrate",8*d/1e3),e&&e(n)},t.isLocalVideoFreeze=function(e,t){var n=0,r=0;if(!e||!t)return!1;if(Object(s.isChrome)()||Object(s.isOpera)())n=e.googFrameRateInput,r=e.googFrameRateSent;else if(Object(s.isSafari)())n=parseInt(e.framerateMean),r=parseInt(e.framesEncoded)-parseInt(t.framesEncoded);else{if(!Object(s.isFireFox)())return!1;n=parseInt(e.framerateMean),r=parseInt(e.framesEncoded)-parseInt(t.framesEncoded)}return n>5&&r<3},t.isRemoteVideoFreeze=function(e,t){var n=0,r=0;if(!e||!t)return!1;if(Object(s.isChrome)()||Object(s.isOpera)())n=e.googFrameRateReceived,r=e.googFrameRateDecoded;else if(Object(s.isSafari)())n=e.framerateMean,r=parseInt(e.framesDecoded)-parseInt(t.framesDecoded);else{if(!Object(s.isFireFox)())return!1;n=parseInt(e.framesReceived)-parseInt(t.framesReceived),r=parseInt(e.framesDecoded)-parseInt(t.framesDecoded)}return n>5&&n<10&&r<3||n>10&&n<20&&r<4||n>20&&r<5},t.isAudioFreeze=function(e){if(Object(s.isChrome)()&&e){if(e.googDecodingPLC&&e.googDecodingPLCCNG&&e.googDecodingCTN)return(parseInt(e.googDecodingPLC)+parseInt(e.googDecodingPLCCNG))/parseInt(e.googDecodingCTN)>.2}else if((Object(s.isSafari)()||Object(s.isFireFox)())&&e.packetsLost&&e.packetsReceived)return parseInt(e.packetsLost)/(parseInt(e.packetsLost)+parseInt(e.packetsReceived))>.2;return!1},t.isAudioDecodeFailed=function(e){return!!((Object(s.isChrome)()||Object(s.isOpera)())&&e&&parseInt(e.bytesReceived)>0&&0===parseInt(e.googDecodingNormal))},t.startNetworkQualityTimer=function(){t.clearNetworkQualityTimer(),t.networkQualityTimer=setInterval((function(){if(t.gatewayClient.state===T.a.CONNECTED&&navigator.onLine){var e=t.gatewayClient.traffic_stats;t.gatewayClient.dispatchEvent({type:"network-quality",uplinkNetworkQuality:t.networkQualityTrans(e.uplink_network_quality),downlinkNetworkQuality:t.networkQualityTrans(e.downlink_network_quality)})}else t.gatewayClient.dispatchEvent({type:"network-quality",uplinkNetworkQuality:0,downlinkNetworkQuality:0})}),2e3)},t.clearNetworkQualityTimer=function(){t.networkQualityTimer&&clearInterval(t.networkQualityTimer)},t.networkQualityTrans=function(e){return e>=0&&e<.17?1:e>=.17&&e<.36?2:e>=.36&&e<.59?3:e>=.59&&e<=1?4:e>1?5:0},t.getStatsTimer=setInterval((function(){var e=t.gatewayClient.traffic_stats,n=Date.now();t.gatewayClient.dispatchEvent({type:"_testException"}),Object.keys(t.localStats).length&&t.exceptionMonitor.setLocalStats(t.localStats),Object.keys(t.remoteStats).length&&t.exceptionMonitor.setRemoteStats(t.remoteStats);var r={};Object.keys(t.gatewayClient.remoteStreams).forEach((function(i){var o=t.gatewayClient.remoteStreams[i],a=t.remoteStats[i],s={id:i,updatedAt:n};r[i]=s,s.firstFrameTime=o.firstFrameTime,a?(s.audioTotalPlayDuration=a.audioTotalPlayDuration+1,s.audioTotalFreezeTime=a.audioTotalFreezeTime,s.isAudioFreeze=!1,s.isAudioDecodeFailed=!1,s.videoTotalPlayDuration=a.videoTotalPlayDuration+1,s.videoTotalFreezeTime=a.videoTotalFreezeTime,s.isVideoFreeze=!1):(s.audioTotalPlayDuration=1,s.audioTotalFreezeTime=0,s.videoTotalPlayDuration=1,s.videoTotalFreezeTime=0);var c=e&&e.peer_delay&&e.peer_delay.find((function(e){return e.peer_uid==i}));c&&(s.peer_delay=c),o&&(o.isPlaying()&&(s.audioDisabled=o.userMuteAudio||o.peerMuteAudio?"1":"0",s.videoDisabled=o.userMuteVideo||o.peerMuteVideo?"1":"0"),a&&a.peer_delay&&c&&a.peer_delay.stream_type!==c.stream_type&&t.gatewayClient.dispatchEvent({type:"streamTypeChange",uid:i,streamType:c.stream_type}),o.pc&&"established"==o.pc.state&&o.pc.getStats((function(e){if(s.pcStats=e,s.audioStats=e.find((function(e){return"audio"==e.mediaType&&(e.id.indexOf("_recv")>-1||e.id.toLowerCase().indexOf("inbound")>-1)})),s.videoStats=e.find((function(e){return"video"==e.mediaType&&(e.id.indexOf("_recv")>-1||e.id.toLowerCase().indexOf("inbound")>-1)})),a&&a.audioStats&&s.audioStats){var n=parseInt(s.audioStats.bytesReceived)-parseInt(a.audioStats.bytesReceived),r=parseInt(s.audioStats.googDecodingNormal)-parseInt(a.audioStats.googDecodingNormal);if(s.audioStats.audioRecvBytesDelta=n,s.audioStats.audioDecodingNormalDelta=r,t.session.recvBytes+=n,isFinite(n)&&s.audioStats.timestamp){var i=s.audioStats.timestamp.getTime()-a.audioStats.timestamp.getTime();s.audioRecvBitrate=Math.floor(8*n/i)}t.isAudioFreeze(s.audioStats)&&s.audioTotalPlayDuration>10&&(s.audioTotalFreezeTime++,s.isAudioFreeze=!0),t.isAudioDecodeFailed(s.audioStats)&&s.audioTotalPlayDuration>10&&(s.isAudioDecodeFailed=!0),s.audioStats.audioTotalFreezeTime=s.audioTotalFreezeTime,s.audioStats.audioTotalPlayDuration=s.audioTotalPlayDuration,s.audioStats.audioFreezeRate=Math.ceil(100*s.audioTotalFreezeTime/s.audioTotalPlayDuration)}if(a&&a.videoStats&&s.videoStats){var c=parseInt(s.videoStats.bytesReceived)-parseInt(a.videoStats.bytesReceived);s.videoStats.videoRecvBytesDelta=c,t.session.recvBytes+=c,isFinite(c)&&s.videoStats.timestamp&&(i=s.videoStats.timestamp.getTime()-a.videoStats.timestamp.getTime(),s.videoRecvBitrate=Math.floor(8*c/i)),t.isRemoteVideoFreeze(s.videoStats,a.videoStats)&&(s.videoTotalFreezeTime++,s.isVideoFreeze=!0),s.videoStats.videoTotalFreezeTime=s.videoTotalFreezeTime,s.videoStats.videoTotalPlayDuration=s.videoTotalPlayDuration,s.videoStats.videoFreezeRate=Math.ceil(100*s.videoTotalFreezeTime/s.videoTotalPlayDuration),o.player&&o.player.video&&o.player.video.videoWidth&&o.player.video.videoHeight?(s.videoStats.renderRemoteWidth=o.player.video.videoWidth,s.videoStats.renderRemoteHeight=o.player.video.videoHeight):(s.videoStats.renderRemoteWidth=o.videoWidth||s.videoStats.googFrameWidthReceived,s.videoStats.renderRemoteHeight=o.videoHeight||s.videoStats.googFrameHeightReceived)}})))})),t.remoteStats=r;var i={};if(Object.keys(t.gatewayClient.localStreams).forEach((function(e){var r=t.gatewayClient.localStreams[e],o=t.localStats[e],a={id:e,updatedAt:n};i[e]=a,o?(a.videoTotalPlayDuration=o.videoTotalPlayDuration+1,a.videoTotalFreezeTime=o.videoTotalFreezeTime,a.isVideoFreeze=!1):(a.videoTotalPlayDuration=1,a.videoTotalFreezeTime=0),r&&(r.isPlaying()&&(a.audioDisabled=r.userMuteAudio?"1":"0",a.videoDisabled=r.userMuteVideo?"1":"0"),r.video&&r.attributes.maxVideoBW?a.videoTargetSendBitrate=r.attributes.maxVideoBW:r.video&&r.screenAttributes&&(a.videoTargetSendBitrate=r.screenAttributes.maxVideoBW),r.pc&&"established"==r.pc.state&&r.pc.getStats((function(e){if(a.pcStats=e.reverse(),a.audioStats=e.find((function(e){return"audio"==e.mediaType&&(e.id.indexOf("_send")>-1||e.id.toLowerCase().indexOf("outbound")>-1)})),a.videoStats=e.find((function(e){return"video"==e.mediaType&&(e.id.indexOf("_send")>-1||e.id.toLowerCase().indexOf("outbound")>-1)})),a.audioStats&&o&&o.audioStats){var n=parseInt(a.audioStats.bytesSent)-parseInt(o.audioStats.bytesSent);if(a.audioStats.audioSendBytesDelta=n,t.session.sendBytes+=n,isFinite(n)&&a.audioStats.timestamp){var i=a.audioStats.timestamp.getTime()-o.audioStats.timestamp.getTime();a.audioSendBitrate=Math.floor(8*n/i)}}if(a.videoStats&&o&&o.videoStats){var s=parseInt(a.videoStats.bytesSent)-parseInt(o.videoStats.bytesSent);a.videoStats.videoSendBytesDelta=s,t.session.sendBytes+=s,isFinite(s)&&a.videoStats.timestamp&&(i=a.videoStats.timestamp.getTime()-o.videoStats.timestamp.getTime(),a.videoSendBitrate=Math.floor(8*s/i)),t.isLocalVideoFreeze(a.videoStats,o.videoStats)&&(a.videoTotalFreezeTime++,a.isVideoFreeze=!0),a.videoStats.videoTotalFreezeTime=a.videoTotalFreezeTime,a.videoStats.videoTotalPlayDuration=a.videoTotalPlayDuration,a.videoStats.videoFreezeRate=Math.ceil(100*a.videoTotalFreezeTime/a.videoTotalPlayDuration),a.videoStats.renderLocalWidth=r.videoWidth||a.videoStats.googFrameWidthSent,a.videoStats.renderLocalHeight=r.videoHeight||a.videoStats.googFrameHeightSent}})))})),t.localStats=i,t.session.HTTPSendBytesDelta=Object(O.getHTTPSendBytes)()-t.session.HTTPSendBytes,t.session.HTTPSendBytes=Object(O.getHTTPSendBytes)(),t.session.HTTPRecvBytesDelta=Object(O.getHTTPRecvBytes)()-t.session.HTTPRecvBytes,t.session.HTTPRecvBytes=Object(O.getHTTPRecvBytes)(),t.gatewayClient.socket&&t.gatewayClient.socket.state===t.gatewayClient.CONNECTED){var o=t.gatewayClient.socket;t.session.WSSendBytesDelta=o.getSendBytes()-t.session.WSSendBytes,t.session.WSSendBytes=o.getSendBytes(),t.session.WSRecvBytesDelta=o.getRecvBytes()-t.session.WSRecvBytes,t.session.WSRecvBytes=o.getRecvBytes()}}),1e3),t.gatewayClient.on("join",(function(){t.session={sendBytes:0,recvBytes:0,WSSendBytes:0,WSSendBytesDelta:0,WSRecvBytes:0,WSRecvBytesDelta:0,HTTPSendBytes:0,HTTPSendBytesDelta:0,HTTPRecvBytes:0,HTTPRecvBytesDelta:0}})),t}(t.gatewayClient),t.configDistributManager=function(e){var t={};return t.client=e,t.client.gatewayClient&&t.client.gatewayClient.on("config-distribute",(function(n){var a=n.joinInfo,s=n.config;if(s){Object(M.isEmpty)(s.uploadLog)||(Object(r.setParameter)("UPLOAD_LOG",s.uploadLog),o.report.reportApiInvoke(a.sid,{name:"_configDistribute",options:{feature:"uploadLog",value:s.uploadLog}})()),Object(M.isEmpty)(s.dualStream)||(e.isDualStream=s.dualStream,o.report.reportApiInvoke(a.sid,{name:"_configDistribute",options:{feature:"dualStream",value:s.dualStream}})()),Object(M.isEmpty)(s.streamFallbackOption)||t.client.gatewayClient&&t.client.gatewayClient.on("stream-subscribed",(function(e){var n=e.stream;n?(t.client.gatewayClient.setStreamFallbackOption(n,s.streamFallbackOption),o.report.reportApiInvoke(a.sid,{name:"_configDistribute",options:{feature:"streamFallbackOption",value:s.streamFallbackOption,streamId:n.getId()}})()):o.report.reportApiInvoke(a.sid,{name:"_configDistribute",options:{feature:"streamFallbackOption",value:s.streamFallbackOption,streamId:n.getId(),err:"invalid stream"}})()}));try{i.default.debug("[".concat(e.clientId,"] setParameter in distribution: ").concat(JSON.stringify(s))),Object.keys(s).map((function(e){return Object(r.setParameter)(e,s[e])}))}catch(t){i.default.debug("[".concat(e.clientId,"] setParameter in distribution failed: ").concat(JSON.stringify(s)))}}})),t}(t),Object(P.addLiveStreamingCapability)(t,e),e.areaCode){var n=e,c=n.areaCode,p=n.excludedArea,h=Object(W.getAreaCodeByConfig)({areaCode:c,excludedArea:p});Object(r.setParameter)("AREA_SETTING",h);var g=Object(W.getAreaDomainConfig)(h);Object.keys(g).map((function(e){var t=g[e];"LOG_UPLOAD_SERVER"==e||"EVENT_REPORT_DOMAIN"==e||"EVENT_REPORT_BACKUP_DOMAIN"==e||"NGINX"==e?Object(r.setParameter)(e,t[0]):Object(r.setParameter)(e,t)}))}return Object(M.isEmpty)(e.turnServer)||t.setTurnServer(e.turnServer),Object(M.isEmpty)(e.proxyServer)||t.setProxyServer(e.proxyServer),"live"===t.mode&&(t.gatewayClient.role="audience"),"rtc"===t.mode&&(t.gatewayClient.role=U),t.gatewayClient.on("onMultiIP",(function(e){t.gatewayClient.closeGateway(),t.gatewayClient.socket=void 0,t.gatewayClient.hasChangeBGPAddress=!0,t.joinInfo.multiIP=e.option,t.gatewayClient.state=T.a.CONNECTING;var n=function(e){i.default.info("[".concat(t.clientId,"] Joining channel: ").concat(t.channel)),t.joinInfo.cid=e.cid,t.joinInfo.uid||(t.joinInfo.uid=e.uid),t.joinInfo.uni_lbs_ip=e.uni_lbs_ip,t.joinInfo.gatewayAddr=e.gateway_addr,t.onSuccess?t.gatewayClient.join(t.joinInfo,t.key,(function(e){i.default.info("[".concat(t.clientId,"] Join channel ").concat(t.channel," success"));var n=t.onSuccess;t.onSuccess=null,t.onFailure=null,n(e)}),t.onFailure):(t.gatewayClient.joinInfo=_()({},t.joinInfo),t.gatewayClient.rejoin())};t.joinInfo.stringUid&&!t.joinInfo.uid?(t.userAccountReq&&!t.userAccountReq.isFinished()&&t.userAccountReq.cancel(),t.userAccountReq=Object(w.getUserAccount)(joinInfo,t.gatewayClient),t.userAccountReq.then((function(e){i.default.error("getUserAccount Success ".concat(e.url," ").concat(joinInfo.stringUid," => ").concat(e.uid)),t.joinInfo.uid=e.uid,Object(w.getGatewayList)(t.joinInfo,n,t.onFailure)})).catch((function(e){i.default.error("getUserAccount rejected",e),t.onFailure(e)}))):Object(w.getGatewayList)(t.joinInfo,n,t.onFailure)})),t.gatewayClient.on("rejoin-start",(function(){t._renewSession(),o.report.sessionInit(e.sessionId,{lts:(new Date).getTime(),extend:{rejoin:!0},cname:t.channel,appid:e.appId,mode:e.mode,succ:!0})})),t.gatewayClient.on("recover",(function(){t._renewSession(),i.default.debug("[".concat(t.clientId,"]"),"recover",e.sessionId),o.report.sessionInit(e.sessionId,{lts:(new Date).getTime(),extend:{recover:!0},cname:t.channel,appid:e.appId,mode:e.mode,succ:!0})})),t.gatewayClient.on("rejoin",(function(){var e=t.highStreamState;if(i.default.debug("[".concat(t.clientId,"] Client local stream preState: ").concat(e)),t.onSuccess){var n=t.onSuccess;t.onSuccess=null,t.onFailure=null,n(t.joinInfo.uid)}!t.highStream||0!==e&&1!==e||(i.default.info("[".concat(t.clientId,"] publish after rejoin")),t.highStreamState=2,t.lowStreamState=2,t.publish(t.highStream,(function(e){e&&i.default.info("[".concat(t.clientId,"] "),e)})))})),t.gatewayClient.on("streamPublished",(function(e){t.hasPublished||(t.hasPublished=!0,t.gatewayClient.dispatchEvent({type:"stream-published",stream:e.stream,proxy:e.proxy}))})),t.gatewayClient.on("pubP2PLost",(function(e){i.default.debug("[".concat(t.clientId,"] Start reconnect local peerConnection: ").concat(t.highStream.getId())),t.gatewayClient.dispatchEvent({type:"stream-reconnect-start",uid:t.highStream.getId()}),1===t.highStreamState&&(t.highStreamState=0,t.lowStreamState=0),t._unpublish(t.highStream,(function(){t._publish(t.highStream,(function(){i.default.debug("[".concat(t.clientId,"] Reconnect local peerConnection success: ").concat(t.highStream.getId())),t.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:t.highStream.getId(),success:!0,reason:""})}),(function(e){i.default.debug("[".concat(t.clientId,"] Reconnect local peerConnection failed: ").concat(e)),t.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:t.highStream.getId(),success:!1,reason:e})}),!0)}),(function(e){i.default.debug("[".concat(t.clientId,"] Reconnect local peerConnection failed: ").concat(e)),t.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:t.highStream.getId(),success:!1,reason:e})}),!0)})),t.gatewayClient.on("subP2PLost",(function(e){i.default.debug("[".concat(t.clientId,"] Start reconnect remote peerConnection: ").concat(e.stream.getId()," ").concat(e.stream.subscribeOptions)),t.gatewayClient.dispatchEvent({type:"stream-reconnect-start",uid:e.stream.getId()});var n=e.stream.subscribeOptions;i.default.debug("[".concat(t.clientId,"]"),"Re-subscribe stream",JSON.stringify(n)),t.gatewayClient.unsubscribe(e.stream,(function(){e.stream.subscribeOptions=n,t.gatewayClient.subscribe(e.stream,(function(){i.default.debug("[".concat(t.clientId,"] Reconnect remote peerConnection success: ").concat(e.stream.getId())),t.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:e.stream.getId(),success:!0,reason:""})}),(function(n){i.default.debug("[".concat(t.clientId,"] Reconnect remote peerConnection failed: "),n),t.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:e.stream.getId(),success:!1,reason:n})}))}),(function(n){i.default.debug("[".concat(t.clientId,"] Reconnect remote peerConnection failed: "),n),t.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:e.stream.getId(),success:!1,reason:n})}))})),V.on("networkTypeChanged",(function(e){t.gatewayClient&&t.gatewayClient.dispatchEvent(e);var n=_()({},e,{type:"network-type-changed"});t.gatewayClient.dispatchEvent(n)})),f.a.on("recordingDeviceChanged",(function(e){t.gatewayClient&&t.gatewayClient.dispatchEvent(e);var n=_()({},e,{type:"recording-device-changed"});t.gatewayClient.dispatchEvent(n)})),f.a.on("playoutDeviceChanged",(function(e){t.gatewayClient&&t.gatewayClient.dispatchEvent(e);var n=_()({},e,{type:"playout-device-changed"});t.gatewayClient.dispatchEvent(n)})),f.a.on("cameraChanged",(function(e){t.gatewayClient&&t.gatewayClient.dispatchEvent(e);var n=_()({},e,{type:"camera-changed"});t.gatewayClient.dispatchEvent(n)})),t.gatewayClient.on("streamTypeChange",(function(n){var r=_()({},n,{type:"stream-type-changed"});t.gatewayClient.dispatchEvent(r),o.report.reportApiInvoke(e.sessionId,{name:"streamTypeChange"})(null,JSON.stringify(n))})),t},B=function(e){switch(e){case"h264_interop":return"h264";default:return"vp8"}},H=function(e){return-1===g.indexOf(e.mode)?R.default.INVALID_CLIENT_MODE:-1===v.indexOf(e.codec)?R.default.INVALID_CLIENT_CODEC:"h264_interop"==e.mode&&"h264"!==e.codec&&R.default.CLIENT_MODE_CODEC_MISMATCH},Y=function(e){switch(e.mode){case"interop":case"h264_interop":e.mode="live";break;case"web-only":e.mode="rtc"}},J=f.a.getDevices,z=p.a.getScreenSources,K=JSON.parse(JSON.stringify(r.SUPPORT_RESOLUTION_LIST));t.default={TranscodingUser:{uid:0,x:0,y:0,width:0,height:0,zOrder:0,alpha:1},LiveTranscoding:{width:640,height:360,videoBitrate:400,videoFramerate:15,lowLatency:!1,audioSampleRate:48e3,audioBitrate:48,audioChannels:1,videoGop:30,videoCodecProfile:100,userCount:0,userConfigExtraInfo:{},backgroundColor:0,transcodingUsers:[]},createClient:function(e){var t=o.report.reportApiInvoke(null,{name:"createClient",options:arguments,tag:"tracer"});(e=_()({},e||{})).codec||(e.codec=B(e.mode));var n=H(e);if(n)throw i.default.error("Invalid parameter setting MODE: ".concat(e.mode," CODEC: ").concat(e.codec," ERROR ").concat(n)),t(n),new Error(n);return i.default.info("Creating client, MODE: ".concat(e.mode," CODEC: ").concat(e.codec)),Y(e),t(null,e),X(e)},createStream:l.b,Logger:i.default,report:o.report,getDevices:J,getScreenSources:z,getParameter:r.getParameter,setParameter:r.setParameter,checkSystemRequirements:u,getSupportedCodec:h.getSupportedCodec,ChannelMediaRelayConfiguration:m.ChannelMediaRelayConfiguration,VERSION:r.VERSION,BUILD:r.BUILD,PROFILE_TABLE:K,AUDIO_SAMPLE_RATE_32000:32e3,AUDIO_SAMPLE_RATE_44100:44100,AUDIO_SAMPLE_RATE_48000:48e3,VIDEO_CODEC_PROFILE_BASELINE:66,VIDEO_CODEC_PROFILE_MAIN:77,VIDEO_CODEC_PROFILE_HIGH:100,REMOTE_VIDEO_STREAM_HIGH:0,REMOTE_VIDEO_STREAM_LOW:1,REMOTE_VIDEO_STREAM_MEDIUM:2,AREAS:W.AREAS,AREA_VERSION:"global"}}]).default},module.exports=t()},,,,,,,function(e,t,n){},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){(function(e,r){var i;
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(){var o="Expected a function",a="__lodash_placeholder__",s=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],c="[object Arguments]",u="[object Array]",d="[object Boolean]",l="[object Date]",f="[object Error]",p="[object Function]",h="[object GeneratorFunction]",m="[object Map]",g="[object Number]",v="[object Object]",y="[object RegExp]",b="[object Set]",S="[object String]",E="[object Symbol]",_="[object WeakMap]",T="[object ArrayBuffer]",R="[object DataView]",I="[object Float32Array]",w="[object Float64Array]",C="[object Int8Array]",O="[object Int16Array]",A="[object Int32Array]",x="[object Uint8Array]",k="[object Uint16Array]",N="[object Uint32Array]",L=/\b__p \+= '';/g,M=/\b(__p \+=) '' \+/g,V=/(__e\(.*?\)|\b__t\)) \+\n'';/g,P=/&(?:amp|lt|gt|quot|#39);/g,D=/[&<>"']/g,Z=RegExp(P.source),j=RegExp(D.source),W=/<%-([\s\S]+?)%>/g,G=/<%([\s\S]+?)%>/g,F=/<%=([\s\S]+?)%>/g,U=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,X=/^\w*$/,B=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,H=/[\\^$.*+?()[\]{}|]/g,Y=RegExp(H.source),J=/^\s+/,z=/\s/,K=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Q=/\{\n\/\* \[wrapped with (.+)\] \*/,q=/,? & /,$=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ee=/[()=,{}\[\]\/\s]/,te=/\\(\\)?/g,ne=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,re=/\w*$/,ie=/^[-+]0x[0-9a-f]+$/i,oe=/^0b[01]+$/i,ae=/^\[object .+?Constructor\]$/,se=/^0o[0-7]+$/i,ce=/^(?:0|[1-9]\d*)$/,ue=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,de=/($^)/,le=/['\n\r\u2028\u2029\\]/g,fe="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",pe="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",he="[\\ud800-\\udfff]",me="["+pe+"]",ge="["+fe+"]",ve="\\d+",ye="[\\u2700-\\u27bf]",be="[a-z\\xdf-\\xf6\\xf8-\\xff]",Se="[^\\ud800-\\udfff"+pe+ve+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",Ee="\\ud83c[\\udffb-\\udfff]",_e="[^\\ud800-\\udfff]",Te="(?:\\ud83c[\\udde6-\\uddff]){2}",Re="[\\ud800-\\udbff][\\udc00-\\udfff]",Ie="[A-Z\\xc0-\\xd6\\xd8-\\xde]",we="(?:"+be+"|"+Se+")",Ce="(?:"+Ie+"|"+Se+")",Oe="(?:"+ge+"|"+Ee+")"+"?",Ae="[\\ufe0e\\ufe0f]?"+Oe+("(?:\\u200d(?:"+[_e,Te,Re].join("|")+")[\\ufe0e\\ufe0f]?"+Oe+")*"),xe="(?:"+[ye,Te,Re].join("|")+")"+Ae,ke="(?:"+[_e+ge+"?",ge,Te,Re,he].join("|")+")",Ne=RegExp("['â]","g"),Le=RegExp(ge,"g"),Me=RegExp(Ee+"(?="+Ee+")|"+ke+Ae,"g"),Ve=RegExp([Ie+"?"+be+"+(?:['â](?:d|ll|m|re|s|t|ve))?(?="+[me,Ie,"$"].join("|")+")",Ce+"+(?:['â](?:D|LL|M|RE|S|T|VE))?(?="+[me,Ie+we,"$"].join("|")+")",Ie+"?"+we+"+(?:['â](?:d|ll|m|re|s|t|ve))?",Ie+"+(?:['â](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ve,xe].join("|"),"g"),Pe=RegExp("[\\u200d\\ud800-\\udfff"+fe+"\\ufe0e\\ufe0f]"),De=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ze=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],je=-1,We={};We[I]=We[w]=We[C]=We[O]=We[A]=We[x]=We["[object Uint8ClampedArray]"]=We[k]=We[N]=!0,We[c]=We[u]=We[T]=We[d]=We[R]=We[l]=We[f]=We[p]=We[m]=We[g]=We[v]=We[y]=We[b]=We[S]=We[_]=!1;var Ge={};Ge[c]=Ge[u]=Ge[T]=Ge[R]=Ge[d]=Ge[l]=Ge[I]=Ge[w]=Ge[C]=Ge[O]=Ge[A]=Ge[m]=Ge[g]=Ge[v]=Ge[y]=Ge[b]=Ge[S]=Ge[E]=Ge[x]=Ge["[object Uint8ClampedArray]"]=Ge[k]=Ge[N]=!0,Ge[f]=Ge[p]=Ge[_]=!1;var Fe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ue=parseFloat,Xe=parseInt,Be="object"==typeof e&&e&&e.Object===Object&&e,He="object"==typeof self&&self&&self.Object===Object&&self,Ye=Be||He||Function("return this")(),Je=t&&!t.nodeType&&t,ze=Je&&"object"==typeof r&&r&&!r.nodeType&&r,Ke=ze&&ze.exports===Je,Qe=Ke&&Be.process,qe=function(){try{var e=ze&&ze.require&&ze.require("util").types;return e||Qe&&Qe.binding&&Qe.binding("util")}catch(e){}}(),$e=qe&&qe.isArrayBuffer,et=qe&&qe.isDate,tt=qe&&qe.isMap,nt=qe&&qe.isRegExp,rt=qe&&qe.isSet,it=qe&&qe.isTypedArray;function ot(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function at(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(r,a,n(a),e)}return r}function st(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function ct(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function ut(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function dt(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}function lt(e,t){return!!(null==e?0:e.length)&&Et(e,t,0)>-1}function ft(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function pt(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function ht(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function mt(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function gt(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function vt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var yt=It("length");function bt(e,t,n){var r;return n(e,(function(e,n,i){if(t(e,n,i))return r=n,!1})),r}function St(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function Et(e,t,n){return t==t?function(e,t,n){var r=n-1,i=e.length;for(;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):St(e,Tt,n)}function _t(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}function Tt(e){return e!=e}function Rt(e,t){var n=null==e?0:e.length;return n?Ot(e,t)/n:NaN}function It(e){return function(t){return null==t?void 0:t[e]}}function wt(e){return function(t){return null==e?void 0:e[t]}}function Ct(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)})),n}function Ot(e,t){for(var n,r=-1,i=e.length;++r<i;){var o=t(e[r]);void 0!==o&&(n=void 0===n?o:n+o)}return n}function At(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function xt(e){return e?e.slice(0,Jt(e)+1).replace(J,""):e}function kt(e){return function(t){return e(t)}}function Nt(e,t){return pt(t,(function(t){return e[t]}))}function Lt(e,t){return e.has(t)}function Mt(e,t){for(var n=-1,r=e.length;++n<r&&Et(t,e[n],0)>-1;);return n}function Vt(e,t){for(var n=e.length;n--&&Et(t,e[n],0)>-1;);return n}function Pt(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}var Dt=wt({Ã:"A",Ã:"A",Ã:"A",Ã:"A",Ã:"A",Ã:"A",Ã :"a",Ã¡:"a",Ã¢:"a",Ã£:"a",Ã¤:"a",Ã¥:"a",Ã:"C",Ã§:"c",Ã:"D",Ã°:"d",Ã:"E",Ã:"E",Ã:"E",Ã:"E",Ã¨:"e",Ã©:"e",Ãª:"e",Ã«:"e",Ã:"I",Ã:"I",Ã:"I",Ã:"I",Ã¬:"i",Ã­:"i",Ã®:"i",Ã¯:"i",Ã:"N",Ã±:"n",Ã:"O",Ã:"O",Ã:"O",Ã:"O",Ã:"O",Ã:"O",Ã²:"o",Ã³:"o",Ã´:"o",Ãµ:"o",Ã¶:"o",Ã¸:"o",Ã:"U",Ã:"U",Ã:"U",Ã:"U",Ã¹:"u",Ãº:"u",Ã»:"u",Ã¼:"u",Ã:"Y",Ã½:"y",Ã¿:"y",Ã:"Ae",Ã¦:"ae",Ã:"Th",Ã¾:"th",Ã:"ss",Ä:"A",Ä:"A",Ä:"A",Ä:"a",Ä:"a",Ä:"a",Ä:"C",Ä:"C",Ä:"C",Ä:"C",Ä:"c",Ä:"c",Ä:"c",Ä:"c",Ä:"D",Ä:"D",Ä:"d",Ä:"d",Ä:"E",Ä:"E",Ä:"E",Ä:"E",Ä:"E",Ä:"e",Ä:"e",Ä:"e",Ä:"e",Ä:"e",Ä:"G",Ä:"G",Ä :"G",Ä¢:"G",Ä:"g",Ä:"g",Ä¡:"g",Ä£:"g",Ä¤:"H",Ä¦:"H",Ä¥:"h",Ä§:"h",Ä¨:"I",Äª:"I",Ä¬:"I",Ä®:"I",Ä°:"I",Ä©:"i",Ä«:"i",Ä­:"i",Ä¯:"i",Ä±:"i",Ä´:"J",Äµ:"j",Ä¶:"K",Ä·:"k",Ä¸:"k",Ä¹:"L",Ä»:"L",Ä½:"L",Ä¿:"L",Å:"L",Äº:"l",Ä¼:"l",Ä¾:"l",Å:"l",Å:"l",Å:"N",Å:"N",Å:"N",Å:"N",Å:"n",Å:"n",Å:"n",Å:"n",Å:"O",Å:"O",Å:"O",Å:"o",Å:"o",Å:"o",Å:"R",Å:"R",Å:"R",Å:"r",Å:"r",Å:"r",Å:"S",Å:"S",Å:"S",Å :"S",Å:"s",Å:"s",Å:"s",Å¡:"s",Å¢:"T",Å¤:"T",Å¦:"T",Å£:"t",Å¥:"t",Å§:"t",Å¨:"U",Åª:"U",Å¬:"U",Å®:"U",Å°:"U",Å²:"U",Å©:"u",Å«:"u",Å­:"u",Å¯:"u",Å±:"u",Å³:"u",Å´:"W",Åµ:"w",Å¶:"Y",Å·:"y",Å¸:"Y",Å¹:"Z",Å»:"Z",Å½:"Z",Åº:"z",Å¼:"z",Å¾:"z",Ä²:"IJ",Ä³:"ij",Å:"Oe",Å:"oe",Å:"'n",Å¿:"s"}),Zt=wt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function jt(e){return"\\"+Fe[e]}function Wt(e){return Pe.test(e)}function Gt(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function Ft(e,t){return function(n){return e(t(n))}}function Ut(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var s=e[n];s!==t&&s!==a||(e[n]=a,o[i++]=n)}return o}function Xt(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function Bt(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}function Ht(e){return Wt(e)?function(e){var t=Me.lastIndex=0;for(;Me.test(e);)++t;return t}(e):yt(e)}function Yt(e){return Wt(e)?function(e){return e.match(Me)||[]}(e):function(e){return e.split("")}(e)}function Jt(e){for(var t=e.length;t--&&z.test(e.charAt(t)););return t}var zt=wt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var Kt=function e(t){var n,r=(t=null==t?Ye:Kt.defaults(Ye.Object(),t,Kt.pick(Ye,Ze))).Array,i=t.Date,z=t.Error,fe=t.Function,pe=t.Math,he=t.Object,me=t.RegExp,ge=t.String,ve=t.TypeError,ye=r.prototype,be=fe.prototype,Se=he.prototype,Ee=t["__core-js_shared__"],_e=be.toString,Te=Se.hasOwnProperty,Re=0,Ie=(n=/[^.]+$/.exec(Ee&&Ee.keys&&Ee.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",we=Se.toString,Ce=_e.call(he),Oe=Ye._,Ae=me("^"+_e.call(Te).replace(H,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),xe=Ke?t.Buffer:void 0,ke=t.Symbol,Me=t.Uint8Array,Pe=xe?xe.allocUnsafe:void 0,Fe=Ft(he.getPrototypeOf,he),Be=he.create,He=Se.propertyIsEnumerable,Je=ye.splice,ze=ke?ke.isConcatSpreadable:void 0,Qe=ke?ke.iterator:void 0,qe=ke?ke.toStringTag:void 0,yt=function(){try{var e=eo(he,"defineProperty");return e({},"",{}),e}catch(e){}}(),wt=t.clearTimeout!==Ye.clearTimeout&&t.clearTimeout,Qt=i&&i.now!==Ye.Date.now&&i.now,qt=t.setTimeout!==Ye.setTimeout&&t.setTimeout,$t=pe.ceil,en=pe.floor,tn=he.getOwnPropertySymbols,nn=xe?xe.isBuffer:void 0,rn=t.isFinite,on=ye.join,an=Ft(he.keys,he),sn=pe.max,cn=pe.min,un=i.now,dn=t.parseInt,ln=pe.random,fn=ye.reverse,pn=eo(t,"DataView"),hn=eo(t,"Map"),mn=eo(t,"Promise"),gn=eo(t,"Set"),vn=eo(t,"WeakMap"),yn=eo(he,"create"),bn=vn&&new vn,Sn={},En=Oo(pn),_n=Oo(hn),Tn=Oo(mn),Rn=Oo(gn),In=Oo(vn),wn=ke?ke.prototype:void 0,Cn=wn?wn.valueOf:void 0,On=wn?wn.toString:void 0;function An(e){if(Ba(e)&&!Ma(e)&&!(e instanceof Ln)){if(e instanceof Nn)return e;if(Te.call(e,"__wrapped__"))return Ao(e)}return new Nn(e)}var xn=function(){function e(){}return function(t){if(!Xa(t))return{};if(Be)return Be(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function kn(){}function Nn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}function Ln(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Mn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Vn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Pn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Dn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Pn;++t<n;)this.add(e[t])}function Zn(e){var t=this.__data__=new Vn(e);this.size=t.size}function jn(e,t){var n=Ma(e),r=!n&&La(e),i=!n&&!r&&Za(e),o=!n&&!r&&!i&&$a(e),a=n||r||i||o,s=a?At(e.length,ge):[],c=s.length;for(var u in e)!t&&!Te.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||so(u,c))||s.push(u);return s}function Wn(e){var t=e.length;return t?e[Dr(0,t-1)]:void 0}function Gn(e,t){return Io(yi(e),Kn(t,0,e.length))}function Fn(e){return Io(yi(e))}function Un(e,t,n){(void 0!==n&&!xa(e[t],n)||void 0===n&&!(t in e))&&Jn(e,t,n)}function Xn(e,t,n){var r=e[t];Te.call(e,t)&&xa(r,n)&&(void 0!==n||t in e)||Jn(e,t,n)}function Bn(e,t){for(var n=e.length;n--;)if(xa(e[n][0],t))return n;return-1}function Hn(e,t,n,r){return tr(e,(function(e,i,o){t(r,e,n(e),o)})),r}function Yn(e,t){return e&&bi(t,Es(t),e)}function Jn(e,t,n){"__proto__"==t&&yt?yt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function zn(e,t){for(var n=-1,i=t.length,o=r(i),a=null==e;++n<i;)o[n]=a?void 0:gs(e,t[n]);return o}function Kn(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}function Qn(e,t,n,r,i,o){var a,s=1&t,u=2&t,f=4&t;if(n&&(a=i?n(e,r,i,o):n(e)),void 0!==a)return a;if(!Xa(e))return e;var _=Ma(e);if(_){if(a=function(e){var t=e.length,n=new e.constructor(t);t&&"string"==typeof e[0]&&Te.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!s)return yi(e,a)}else{var L=ro(e),M=L==p||L==h;if(Za(e))return fi(e,s);if(L==v||L==c||M&&!i){if(a=u||M?{}:oo(e),!s)return u?function(e,t){return bi(e,no(e),t)}(e,function(e,t){return e&&bi(t,_s(t),e)}(a,e)):function(e,t){return bi(e,to(e),t)}(e,Yn(a,e))}else{if(!Ge[L])return i?e:{};a=function(e,t,n){var r=e.constructor;switch(t){case T:return pi(e);case d:case l:return new r(+e);case R:return function(e,t){var n=t?pi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case I:case w:case C:case O:case A:case x:case"[object Uint8ClampedArray]":case k:case N:return hi(e,n);case m:return new r;case g:case S:return new r(e);case y:return function(e){var t=new e.constructor(e.source,re.exec(e));return t.lastIndex=e.lastIndex,t}(e);case b:return new r;case E:return i=e,Cn?he(Cn.call(i)):{}}var i}(e,L,s)}}o||(o=new Zn);var V=o.get(e);if(V)return V;o.set(e,a),Ka(e)?e.forEach((function(r){a.add(Qn(r,t,n,r,e,o))})):Ha(e)&&e.forEach((function(r,i){a.set(i,Qn(r,t,n,i,e,o))}));var P=_?void 0:(f?u?Yi:Hi:u?_s:Es)(e);return st(P||e,(function(r,i){P&&(r=e[i=r]),Xn(a,i,Qn(r,t,n,i,e,o))})),a}function qn(e,t,n){var r=n.length;if(null==e)return!r;for(e=he(e);r--;){var i=n[r],o=t[i],a=e[i];if(void 0===a&&!(i in e)||!o(a))return!1}return!0}function $n(e,t,n){if("function"!=typeof e)throw new ve(o);return Eo((function(){e.apply(void 0,n)}),t)}function er(e,t,n,r){var i=-1,o=lt,a=!0,s=e.length,c=[],u=t.length;if(!s)return c;n&&(t=pt(t,kt(n))),r?(o=ft,a=!1):t.length>=200&&(o=Lt,a=!1,t=new Dn(t));e:for(;++i<s;){var d=e[i],l=null==n?d:n(d);if(d=r||0!==d?d:0,a&&l==l){for(var f=u;f--;)if(t[f]===l)continue e;c.push(d)}else o(t,l,r)||c.push(d)}return c}An.templateSettings={escape:W,evaluate:G,interpolate:F,variable:"",imports:{_:An}},An.prototype=kn.prototype,An.prototype.constructor=An,Nn.prototype=xn(kn.prototype),Nn.prototype.constructor=Nn,Ln.prototype=xn(kn.prototype),Ln.prototype.constructor=Ln,Mn.prototype.clear=function(){this.__data__=yn?yn(null):{},this.size=0},Mn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Mn.prototype.get=function(e){var t=this.__data__;if(yn){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return Te.call(t,e)?t[e]:void 0},Mn.prototype.has=function(e){var t=this.__data__;return yn?void 0!==t[e]:Te.call(t,e)},Mn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=yn&&void 0===t?"__lodash_hash_undefined__":t,this},Vn.prototype.clear=function(){this.__data__=[],this.size=0},Vn.prototype.delete=function(e){var t=this.__data__,n=Bn(t,e);return!(n<0)&&(n==t.length-1?t.pop():Je.call(t,n,1),--this.size,!0)},Vn.prototype.get=function(e){var t=this.__data__,n=Bn(t,e);return n<0?void 0:t[n][1]},Vn.prototype.has=function(e){return Bn(this.__data__,e)>-1},Vn.prototype.set=function(e,t){var n=this.__data__,r=Bn(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Pn.prototype.clear=function(){this.size=0,this.__data__={hash:new Mn,map:new(hn||Vn),string:new Mn}},Pn.prototype.delete=function(e){var t=qi(this,e).delete(e);return this.size-=t?1:0,t},Pn.prototype.get=function(e){return qi(this,e).get(e)},Pn.prototype.has=function(e){return qi(this,e).has(e)},Pn.prototype.set=function(e,t){var n=qi(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Dn.prototype.add=Dn.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Dn.prototype.has=function(e){return this.__data__.has(e)},Zn.prototype.clear=function(){this.__data__=new Vn,this.size=0},Zn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Zn.prototype.get=function(e){return this.__data__.get(e)},Zn.prototype.has=function(e){return this.__data__.has(e)},Zn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Vn){var r=n.__data__;if(!hn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Pn(r)}return n.set(e,t),this.size=n.size,this};var tr=_i(ur),nr=_i(dr,!0);function rr(e,t){var n=!0;return tr(e,(function(e,r,i){return n=!!t(e,r,i)})),n}function ir(e,t,n){for(var r=-1,i=e.length;++r<i;){var o=e[r],a=t(o);if(null!=a&&(void 0===s?a==a&&!qa(a):n(a,s)))var s=a,c=o}return c}function or(e,t){var n=[];return tr(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n}function ar(e,t,n,r,i){var o=-1,a=e.length;for(n||(n=ao),i||(i=[]);++o<a;){var s=e[o];t>0&&n(s)?t>1?ar(s,t-1,n,r,i):ht(i,s):r||(i[i.length]=s)}return i}var sr=Ti(),cr=Ti(!0);function ur(e,t){return e&&sr(e,t,Es)}function dr(e,t){return e&&cr(e,t,Es)}function lr(e,t){return dt(t,(function(t){return Ga(e[t])}))}function fr(e,t){for(var n=0,r=(t=ci(t,e)).length;null!=e&&n<r;)e=e[Co(t[n++])];return n&&n==r?e:void 0}function pr(e,t,n){var r=t(e);return Ma(e)?r:ht(r,n(e))}function hr(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":qe&&qe in he(e)?function(e){var t=Te.call(e,qe),n=e[qe];try{e[qe]=void 0;var r=!0}catch(e){}var i=we.call(e);r&&(t?e[qe]=n:delete e[qe]);return i}(e):function(e){return we.call(e)}(e)}function mr(e,t){return e>t}function gr(e,t){return null!=e&&Te.call(e,t)}function vr(e,t){return null!=e&&t in he(e)}function yr(e,t,n){for(var i=n?ft:lt,o=e[0].length,a=e.length,s=a,c=r(a),u=1/0,d=[];s--;){var l=e[s];s&&t&&(l=pt(l,kt(t))),u=cn(l.length,u),c[s]=!n&&(t||o>=120&&l.length>=120)?new Dn(s&&l):void 0}l=e[0];var f=-1,p=c[0];e:for(;++f<o&&d.length<u;){var h=l[f],m=t?t(h):h;if(h=n||0!==h?h:0,!(p?Lt(p,m):i(d,m,n))){for(s=a;--s;){var g=c[s];if(!(g?Lt(g,m):i(e[s],m,n)))continue e}p&&p.push(m),d.push(h)}}return d}function br(e,t,n){var r=null==(e=vo(e,t=ci(t,e)))?e:e[Co(Wo(t))];return null==r?void 0:ot(r,e,n)}function Sr(e){return Ba(e)&&hr(e)==c}function Er(e,t,n,r,i){return e===t||(null==e||null==t||!Ba(e)&&!Ba(t)?e!=e&&t!=t:function(e,t,n,r,i,o){var a=Ma(e),s=Ma(t),p=a?u:ro(e),h=s?u:ro(t),_=(p=p==c?v:p)==v,I=(h=h==c?v:h)==v,w=p==h;if(w&&Za(e)){if(!Za(t))return!1;a=!0,_=!1}if(w&&!_)return o||(o=new Zn),a||$a(e)?Xi(e,t,n,r,i,o):function(e,t,n,r,i,o,a){switch(n){case R:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case T:return!(e.byteLength!=t.byteLength||!o(new Me(e),new Me(t)));case d:case l:case g:return xa(+e,+t);case f:return e.name==t.name&&e.message==t.message;case y:case S:return e==t+"";case m:var s=Gt;case b:var c=1&r;if(s||(s=Xt),e.size!=t.size&&!c)return!1;var u=a.get(e);if(u)return u==t;r|=2,a.set(e,t);var p=Xi(s(e),s(t),r,i,o,a);return a.delete(e),p;case E:if(Cn)return Cn.call(e)==Cn.call(t)}return!1}(e,t,p,n,r,i,o);if(!(1&n)){var C=_&&Te.call(e,"__wrapped__"),O=I&&Te.call(t,"__wrapped__");if(C||O){var A=C?e.value():e,x=O?t.value():t;return o||(o=new Zn),i(A,x,n,r,o)}}if(!w)return!1;return o||(o=new Zn),function(e,t,n,r,i,o){var a=1&n,s=Hi(e),c=s.length,u=Hi(t).length;if(c!=u&&!a)return!1;var d=c;for(;d--;){var l=s[d];if(!(a?l in t:Te.call(t,l)))return!1}var f=o.get(e),p=o.get(t);if(f&&p)return f==t&&p==e;var h=!0;o.set(e,t),o.set(t,e);var m=a;for(;++d<c;){l=s[d];var g=e[l],v=t[l];if(r)var y=a?r(v,g,l,t,e,o):r(g,v,l,e,t,o);if(!(void 0===y?g===v||i(g,v,n,r,o):y)){h=!1;break}m||(m="constructor"==l)}if(h&&!m){var b=e.constructor,S=t.constructor;b==S||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof S&&S instanceof S||(h=!1)}return o.delete(e),o.delete(t),h}(e,t,n,r,i,o)}(e,t,n,r,Er,i))}function _r(e,t,n,r){var i=n.length,o=i,a=!r;if(null==e)return!o;for(e=he(e);i--;){var s=n[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){var c=(s=n[i])[0],u=e[c],d=s[1];if(a&&s[2]){if(void 0===u&&!(c in e))return!1}else{var l=new Zn;if(r)var f=r(u,d,c,e,t,l);if(!(void 0===f?Er(d,u,3,r,l):f))return!1}}return!0}function Tr(e){return!(!Xa(e)||(t=e,Ie&&Ie in t))&&(Ga(e)?Ae:ae).test(Oo(e));var t}function Rr(e){return"function"==typeof e?e:null==e?Ys:"object"==typeof e?Ma(e)?xr(e[0],e[1]):Ar(e):nc(e)}function Ir(e){if(!po(e))return an(e);var t=[];for(var n in he(e))Te.call(e,n)&&"constructor"!=n&&t.push(n);return t}function wr(e){if(!Xa(e))return function(e){var t=[];if(null!=e)for(var n in he(e))t.push(n);return t}(e);var t=po(e),n=[];for(var r in e)("constructor"!=r||!t&&Te.call(e,r))&&n.push(r);return n}function Cr(e,t){return e<t}function Or(e,t){var n=-1,i=Pa(e)?r(e.length):[];return tr(e,(function(e,r,o){i[++n]=t(e,r,o)})),i}function Ar(e){var t=$i(e);return 1==t.length&&t[0][2]?mo(t[0][0],t[0][1]):function(n){return n===e||_r(n,e,t)}}function xr(e,t){return uo(e)&&ho(t)?mo(Co(e),t):function(n){var r=gs(n,e);return void 0===r&&r===t?vs(n,e):Er(t,r,3)}}function kr(e,t,n,r,i){e!==t&&sr(t,(function(o,a){if(i||(i=new Zn),Xa(o))!function(e,t,n,r,i,o,a){var s=bo(e,n),c=bo(t,n),u=a.get(c);if(u)return void Un(e,n,u);var d=o?o(s,c,n+"",e,t,a):void 0,l=void 0===d;if(l){var f=Ma(c),p=!f&&Za(c),h=!f&&!p&&$a(c);d=c,f||p||h?Ma(s)?d=s:Da(s)?d=yi(s):p?(l=!1,d=fi(c,!0)):h?(l=!1,d=hi(c,!0)):d=[]:Ja(c)||La(c)?(d=s,La(s)?d=ss(s):Xa(s)&&!Ga(s)||(d=oo(c))):l=!1}l&&(a.set(c,d),i(d,c,r,o,a),a.delete(c));Un(e,n,d)}(e,t,a,n,kr,r,i);else{var s=r?r(bo(e,a),o,a+"",e,t,i):void 0;void 0===s&&(s=o),Un(e,a,s)}}),_s)}function Nr(e,t){var n=e.length;if(n)return so(t+=t<0?n:0,n)?e[t]:void 0}function Lr(e,t,n){t=t.length?pt(t,(function(e){return Ma(e)?function(t){return fr(t,1===e.length?e[0]:e)}:e})):[Ys];var r=-1;return t=pt(t,kt(Qi())),function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(Or(e,(function(e,n,i){return{criteria:pt(t,(function(t){return t(e)})),index:++r,value:e}})),(function(e,t){return function(e,t,n){var r=-1,i=e.criteria,o=t.criteria,a=i.length,s=n.length;for(;++r<a;){var c=mi(i[r],o[r]);if(c){if(r>=s)return c;var u=n[r];return c*("desc"==u?-1:1)}}return e.index-t.index}(e,t,n)}))}function Mr(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var a=t[r],s=fr(e,a);n(s,a)&&Fr(o,ci(a,e),s)}return o}function Vr(e,t,n,r){var i=r?_t:Et,o=-1,a=t.length,s=e;for(e===t&&(t=yi(t)),n&&(s=pt(e,kt(n)));++o<a;)for(var c=0,u=t[o],d=n?n(u):u;(c=i(s,d,c,r))>-1;)s!==e&&Je.call(s,c,1),Je.call(e,c,1);return e}function Pr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;so(i)?Je.call(e,i,1):ei(e,i)}}return e}function Dr(e,t){return e+en(ln()*(t-e+1))}function Zr(e,t){var n="";if(!e||t<1||t>9007199254740991)return n;do{t%2&&(n+=e),(t=en(t/2))&&(e+=e)}while(t);return n}function jr(e,t){return _o(go(e,t,Ys),e+"")}function Wr(e){return Wn(xs(e))}function Gr(e,t){var n=xs(e);return Io(n,Kn(t,0,n.length))}function Fr(e,t,n,r){if(!Xa(e))return e;for(var i=-1,o=(t=ci(t,e)).length,a=o-1,s=e;null!=s&&++i<o;){var c=Co(t[i]),u=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(i!=a){var d=s[c];void 0===(u=r?r(d,c,s):void 0)&&(u=Xa(d)?d:so(t[i+1])?[]:{})}Xn(s,c,u),s=s[c]}return e}var Ur=bn?function(e,t){return bn.set(e,t),e}:Ys,Xr=yt?function(e,t){return yt(e,"toString",{configurable:!0,enumerable:!1,value:Xs(t),writable:!0})}:Ys;function Br(e){return Io(xs(e))}function Hr(e,t,n){var i=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var a=r(o);++i<o;)a[i]=e[i+t];return a}function Yr(e,t){var n;return tr(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}function Jr(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=2147483647){for(;r<i;){var o=r+i>>>1,a=e[o];null!==a&&!qa(a)&&(n?a<=t:a<t)?r=o+1:i=o}return i}return zr(e,t,Ys,n)}function zr(e,t,n,r){var i=0,o=null==e?0:e.length;if(0===o)return 0;for(var a=(t=n(t))!=t,s=null===t,c=qa(t),u=void 0===t;i<o;){var d=en((i+o)/2),l=n(e[d]),f=void 0!==l,p=null===l,h=l==l,m=qa(l);if(a)var g=r||h;else g=u?h&&(r||f):s?h&&f&&(r||!p):c?h&&f&&!p&&(r||!m):!p&&!m&&(r?l<=t:l<t);g?i=d+1:o=d}return cn(o,4294967294)}function Kr(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n],s=t?t(a):a;if(!n||!xa(s,c)){var c=s;o[i++]=0===a?0:a}}return o}function Qr(e){return"number"==typeof e?e:qa(e)?NaN:+e}function qr(e){if("string"==typeof e)return e;if(Ma(e))return pt(e,qr)+"";if(qa(e))return On?On.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function $r(e,t,n){var r=-1,i=lt,o=e.length,a=!0,s=[],c=s;if(n)a=!1,i=ft;else if(o>=200){var u=t?null:Zi(e);if(u)return Xt(u);a=!1,i=Lt,c=new Dn}else c=t?[]:s;e:for(;++r<o;){var d=e[r],l=t?t(d):d;if(d=n||0!==d?d:0,a&&l==l){for(var f=c.length;f--;)if(c[f]===l)continue e;t&&c.push(l),s.push(d)}else i(c,l,n)||(c!==s&&c.push(l),s.push(d))}return s}function ei(e,t){return null==(e=vo(e,t=ci(t,e)))||delete e[Co(Wo(t))]}function ti(e,t,n,r){return Fr(e,t,n(fr(e,t)),r)}function ni(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?Hr(e,r?0:o,r?o+1:i):Hr(e,r?o+1:0,r?i:o)}function ri(e,t){var n=e;return n instanceof Ln&&(n=n.value()),mt(t,(function(e,t){return t.func.apply(t.thisArg,ht([e],t.args))}),n)}function ii(e,t,n){var i=e.length;if(i<2)return i?$r(e[0]):[];for(var o=-1,a=r(i);++o<i;)for(var s=e[o],c=-1;++c<i;)c!=o&&(a[o]=er(a[o]||s,e[c],t,n));return $r(ar(a,1),t,n)}function oi(e,t,n){for(var r=-1,i=e.length,o=t.length,a={};++r<i;){var s=r<o?t[r]:void 0;n(a,e[r],s)}return a}function ai(e){return Da(e)?e:[]}function si(e){return"function"==typeof e?e:Ys}function ci(e,t){return Ma(e)?e:uo(e,t)?[e]:wo(cs(e))}var ui=jr;function di(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:Hr(e,t,n)}var li=wt||function(e){return Ye.clearTimeout(e)};function fi(e,t){if(t)return e.slice();var n=e.length,r=Pe?Pe(n):new e.constructor(n);return e.copy(r),r}function pi(e){var t=new e.constructor(e.byteLength);return new Me(t).set(new Me(e)),t}function hi(e,t){var n=t?pi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function mi(e,t){if(e!==t){var n=void 0!==e,r=null===e,i=e==e,o=qa(e),a=void 0!==t,s=null===t,c=t==t,u=qa(t);if(!s&&!u&&!o&&e>t||o&&a&&c&&!s&&!u||r&&a&&c||!n&&c||!i)return 1;if(!r&&!o&&!u&&e<t||u&&n&&i&&!r&&!o||s&&n&&i||!a&&i||!c)return-1}return 0}function gi(e,t,n,i){for(var o=-1,a=e.length,s=n.length,c=-1,u=t.length,d=sn(a-s,0),l=r(u+d),f=!i;++c<u;)l[c]=t[c];for(;++o<s;)(f||o<a)&&(l[n[o]]=e[o]);for(;d--;)l[c++]=e[o++];return l}function vi(e,t,n,i){for(var o=-1,a=e.length,s=-1,c=n.length,u=-1,d=t.length,l=sn(a-c,0),f=r(l+d),p=!i;++o<l;)f[o]=e[o];for(var h=o;++u<d;)f[h+u]=t[u];for(;++s<c;)(p||o<a)&&(f[h+n[s]]=e[o++]);return f}function yi(e,t){var n=-1,i=e.length;for(t||(t=r(i));++n<i;)t[n]=e[n];return t}function bi(e,t,n,r){var i=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var s=t[o],c=r?r(n[s],e[s],s,n,e):void 0;void 0===c&&(c=e[s]),i?Jn(n,s,c):Xn(n,s,c)}return n}function Si(e,t){return function(n,r){var i=Ma(n)?at:Hn,o=t?t():{};return i(n,e,Qi(r,2),o)}}function Ei(e){return jr((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,a&&co(n[0],n[1],a)&&(o=i<3?void 0:o,i=1),t=he(t);++r<i;){var s=n[r];s&&e(t,s,r,o)}return t}))}function _i(e,t){return function(n,r){if(null==n)return n;if(!Pa(n))return e(n,r);for(var i=n.length,o=t?i:-1,a=he(n);(t?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function Ti(e){return function(t,n,r){for(var i=-1,o=he(t),a=r(t),s=a.length;s--;){var c=a[e?s:++i];if(!1===n(o[c],c,o))break}return t}}function Ri(e){return function(t){var n=Wt(t=cs(t))?Yt(t):void 0,r=n?n[0]:t.charAt(0),i=n?di(n,1).join(""):t.slice(1);return r[e]()+i}}function Ii(e){return function(t){return mt(Gs(Ls(t).replace(Ne,"")),e,"")}}function wi(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=xn(e.prototype),r=e.apply(n,t);return Xa(r)?r:n}}function Ci(e){return function(t,n,r){var i=he(t);if(!Pa(t)){var o=Qi(n,3);t=Es(t),n=function(e){return o(i[e],e,i)}}var a=e(t,n,r);return a>-1?i[o?t[a]:a]:void 0}}function Oi(e){return Bi((function(t){var n=t.length,r=n,i=Nn.prototype.thru;for(e&&t.reverse();r--;){var a=t[r];if("function"!=typeof a)throw new ve(o);if(i&&!s&&"wrapper"==zi(a))var s=new Nn([],!0)}for(r=s?r:n;++r<n;){var c=zi(a=t[r]),u="wrapper"==c?Ji(a):void 0;s=u&&lo(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?s[zi(u[0])].apply(s,u[3]):1==a.length&&lo(a)?s[c]():s.thru(a)}return function(){var e=arguments,r=e[0];if(s&&1==e.length&&Ma(r))return s.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}}))}function Ai(e,t,n,i,o,a,s,c,u,d){var l=128&t,f=1&t,p=2&t,h=24&t,m=512&t,g=p?void 0:wi(e);return function v(){for(var y=arguments.length,b=r(y),S=y;S--;)b[S]=arguments[S];if(h)var E=Ki(v),_=Pt(b,E);if(i&&(b=gi(b,i,o,h)),a&&(b=vi(b,a,s,h)),y-=_,h&&y<d){var T=Ut(b,E);return Pi(e,t,Ai,v.placeholder,n,b,T,c,u,d-y)}var R=f?n:this,I=p?R[e]:e;return y=b.length,c?b=yo(b,c):m&&y>1&&b.reverse(),l&&u<y&&(b.length=u),this&&this!==Ye&&this instanceof v&&(I=g||wi(I)),I.apply(R,b)}}function xi(e,t){return function(n,r){return function(e,t,n,r){return ur(e,(function(e,i,o){t(r,n(e),i,o)})),r}(n,e,t(r),{})}}function ki(e,t){return function(n,r){var i;if(void 0===n&&void 0===r)return t;if(void 0!==n&&(i=n),void 0!==r){if(void 0===i)return r;"string"==typeof n||"string"==typeof r?(n=qr(n),r=qr(r)):(n=Qr(n),r=Qr(r)),i=e(n,r)}return i}}function Ni(e){return Bi((function(t){return t=pt(t,kt(Qi())),jr((function(n){var r=this;return e(t,(function(e){return ot(e,r,n)}))}))}))}function Li(e,t){var n=(t=void 0===t?" ":qr(t)).length;if(n<2)return n?Zr(t,e):t;var r=Zr(t,$t(e/Ht(t)));return Wt(t)?di(Yt(r),0,e).join(""):r.slice(0,e)}function Mi(e){return function(t,n,i){return i&&"number"!=typeof i&&co(t,n,i)&&(n=i=void 0),t=rs(t),void 0===n?(n=t,t=0):n=rs(n),function(e,t,n,i){for(var o=-1,a=sn($t((t-e)/(n||1)),0),s=r(a);a--;)s[i?a:++o]=e,e+=n;return s}(t,n,i=void 0===i?t<n?1:-1:rs(i),e)}}function Vi(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=as(t),n=as(n)),e(t,n)}}function Pi(e,t,n,r,i,o,a,s,c,u){var d=8&t;t|=d?32:64,4&(t&=~(d?64:32))||(t&=-4);var l=[e,t,i,d?o:void 0,d?a:void 0,d?void 0:o,d?void 0:a,s,c,u],f=n.apply(void 0,l);return lo(e)&&So(f,l),f.placeholder=r,To(f,e,t)}function Di(e){var t=pe[e];return function(e,n){if(e=as(e),(n=null==n?0:cn(is(n),292))&&rn(e)){var r=(cs(e)+"e").split("e");return+((r=(cs(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Zi=gn&&1/Xt(new gn([,-0]))[1]==1/0?function(e){return new gn(e)}:qs;function ji(e){return function(t){var n=ro(t);return n==m?Gt(t):n==b?Bt(t):function(e,t){return pt(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Wi(e,t,n,i,s,c,u,d){var l=2&t;if(!l&&"function"!=typeof e)throw new ve(o);var f=i?i.length:0;if(f||(t&=-97,i=s=void 0),u=void 0===u?u:sn(is(u),0),d=void 0===d?d:is(d),f-=s?s.length:0,64&t){var p=i,h=s;i=s=void 0}var m=l?void 0:Ji(e),g=[e,t,n,i,s,p,h,c,u,d];if(m&&function(e,t){var n=e[1],r=t[1],i=n|r,o=i<131,s=128==r&&8==n||128==r&&256==n&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!o&&!s)return e;1&r&&(e[2]=t[2],i|=1&n?0:4);var c=t[3];if(c){var u=e[3];e[3]=u?gi(u,c,t[4]):c,e[4]=u?Ut(e[3],a):t[4]}(c=t[5])&&(u=e[5],e[5]=u?vi(u,c,t[6]):c,e[6]=u?Ut(e[5],a):t[6]);(c=t[7])&&(e[7]=c);128&r&&(e[8]=null==e[8]?t[8]:cn(e[8],t[8]));null==e[9]&&(e[9]=t[9]);e[0]=t[0],e[1]=i}(g,m),e=g[0],t=g[1],n=g[2],i=g[3],s=g[4],!(d=g[9]=void 0===g[9]?l?0:e.length:sn(g[9]-f,0))&&24&t&&(t&=-25),t&&1!=t)v=8==t||16==t?function(e,t,n){var i=wi(e);return function o(){for(var a=arguments.length,s=r(a),c=a,u=Ki(o);c--;)s[c]=arguments[c];var d=a<3&&s[0]!==u&&s[a-1]!==u?[]:Ut(s,u);if((a-=d.length)<n)return Pi(e,t,Ai,o.placeholder,void 0,s,d,void 0,void 0,n-a);var l=this&&this!==Ye&&this instanceof o?i:e;return ot(l,this,s)}}(e,t,d):32!=t&&33!=t||s.length?Ai.apply(void 0,g):function(e,t,n,i){var o=1&t,a=wi(e);return function t(){for(var s=-1,c=arguments.length,u=-1,d=i.length,l=r(d+c),f=this&&this!==Ye&&this instanceof t?a:e;++u<d;)l[u]=i[u];for(;c--;)l[u++]=arguments[++s];return ot(f,o?n:this,l)}}(e,t,n,i);else var v=function(e,t,n){var r=1&t,i=wi(e);return function t(){var o=this&&this!==Ye&&this instanceof t?i:e;return o.apply(r?n:this,arguments)}}(e,t,n);return To((m?Ur:So)(v,g),e,t)}function Gi(e,t,n,r){return void 0===e||xa(e,Se[n])&&!Te.call(r,n)?t:e}function Fi(e,t,n,r,i,o){return Xa(e)&&Xa(t)&&(o.set(t,e),kr(e,t,void 0,Fi,o),o.delete(t)),e}function Ui(e){return Ja(e)?void 0:e}function Xi(e,t,n,r,i,o){var a=1&n,s=e.length,c=t.length;if(s!=c&&!(a&&c>s))return!1;var u=o.get(e),d=o.get(t);if(u&&d)return u==t&&d==e;var l=-1,f=!0,p=2&n?new Dn:void 0;for(o.set(e,t),o.set(t,e);++l<s;){var h=e[l],m=t[l];if(r)var g=a?r(m,h,l,t,e,o):r(h,m,l,e,t,o);if(void 0!==g){if(g)continue;f=!1;break}if(p){if(!vt(t,(function(e,t){if(!Lt(p,t)&&(h===e||i(h,e,n,r,o)))return p.push(t)}))){f=!1;break}}else if(h!==m&&!i(h,m,n,r,o)){f=!1;break}}return o.delete(e),o.delete(t),f}function Bi(e){return _o(go(e,void 0,Vo),e+"")}function Hi(e){return pr(e,Es,to)}function Yi(e){return pr(e,_s,no)}var Ji=bn?function(e){return bn.get(e)}:qs;function zi(e){for(var t=e.name+"",n=Sn[t],r=Te.call(Sn,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function Ki(e){return(Te.call(An,"placeholder")?An:e).placeholder}function Qi(){var e=An.iteratee||Js;return e=e===Js?Rr:e,arguments.length?e(arguments[0],arguments[1]):e}function qi(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function $i(e){for(var t=Es(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,ho(i)]}return t}function eo(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return Tr(n)?n:void 0}var to=tn?function(e){return null==e?[]:(e=he(e),dt(tn(e),(function(t){return He.call(e,t)})))}:oc,no=tn?function(e){for(var t=[];e;)ht(t,to(e)),e=Fe(e);return t}:oc,ro=hr;function io(e,t,n){for(var r=-1,i=(t=ci(t,e)).length,o=!1;++r<i;){var a=Co(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&Ua(i)&&so(a,i)&&(Ma(e)||La(e))}function oo(e){return"function"!=typeof e.constructor||po(e)?{}:xn(Fe(e))}function ao(e){return Ma(e)||La(e)||!!(ze&&e&&e[ze])}function so(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&ce.test(e))&&e>-1&&e%1==0&&e<t}function co(e,t,n){if(!Xa(n))return!1;var r=typeof t;return!!("number"==r?Pa(n)&&so(t,n.length):"string"==r&&t in n)&&xa(n[t],e)}function uo(e,t){if(Ma(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!qa(e))||(X.test(e)||!U.test(e)||null!=t&&e in he(t))}function lo(e){var t=zi(e),n=An[t];if("function"!=typeof n||!(t in Ln.prototype))return!1;if(e===n)return!0;var r=Ji(n);return!!r&&e===r[0]}(pn&&ro(new pn(new ArrayBuffer(1)))!=R||hn&&ro(new hn)!=m||mn&&"[object Promise]"!=ro(mn.resolve())||gn&&ro(new gn)!=b||vn&&ro(new vn)!=_)&&(ro=function(e){var t=hr(e),n=t==v?e.constructor:void 0,r=n?Oo(n):"";if(r)switch(r){case En:return R;case _n:return m;case Tn:return"[object Promise]";case Rn:return b;case In:return _}return t});var fo=Ee?Ga:ac;function po(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Se)}function ho(e){return e==e&&!Xa(e)}function mo(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in he(n)))}}function go(e,t,n){return t=sn(void 0===t?e.length-1:t,0),function(){for(var i=arguments,o=-1,a=sn(i.length-t,0),s=r(a);++o<a;)s[o]=i[t+o];o=-1;for(var c=r(t+1);++o<t;)c[o]=i[o];return c[t]=n(s),ot(e,this,c)}}function vo(e,t){return t.length<2?e:fr(e,Hr(t,0,-1))}function yo(e,t){for(var n=e.length,r=cn(t.length,n),i=yi(e);r--;){var o=t[r];e[r]=so(o,n)?i[o]:void 0}return e}function bo(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var So=Ro(Ur),Eo=qt||function(e,t){return Ye.setTimeout(e,t)},_o=Ro(Xr);function To(e,t,n){var r=t+"";return _o(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(K,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return st(s,(function(n){var r="_."+n[0];t&n[1]&&!lt(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(Q);return t?t[1].split(q):[]}(r),n)))}function Ro(e){var t=0,n=0;return function(){var r=un(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function Io(e,t){var n=-1,r=e.length,i=r-1;for(t=void 0===t?r:t;++n<t;){var o=Dr(n,i),a=e[o];e[o]=e[n],e[n]=a}return e.length=t,e}var wo=function(e){var t=Ra(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(B,(function(e,n,r,i){t.push(r?i.replace(te,"$1"):n||e)})),t}));function Co(e){if("string"==typeof e||qa(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Oo(e){if(null!=e){try{return _e.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Ao(e){if(e instanceof Ln)return e.clone();var t=new Nn(e.__wrapped__,e.__chain__);return t.__actions__=yi(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var xo=jr((function(e,t){return Da(e)?er(e,ar(t,1,Da,!0)):[]})),ko=jr((function(e,t){var n=Wo(t);return Da(n)&&(n=void 0),Da(e)?er(e,ar(t,1,Da,!0),Qi(n,2)):[]})),No=jr((function(e,t){var n=Wo(t);return Da(n)&&(n=void 0),Da(e)?er(e,ar(t,1,Da,!0),void 0,n):[]}));function Lo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:is(n);return i<0&&(i=sn(r+i,0)),St(e,Qi(t,3),i)}function Mo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r-1;return void 0!==n&&(i=is(n),i=n<0?sn(r+i,0):cn(i,r-1)),St(e,Qi(t,3),i,!0)}function Vo(e){return(null==e?0:e.length)?ar(e,1):[]}function Po(e){return e&&e.length?e[0]:void 0}var Do=jr((function(e){var t=pt(e,ai);return t.length&&t[0]===e[0]?yr(t):[]})),Zo=jr((function(e){var t=Wo(e),n=pt(e,ai);return t===Wo(n)?t=void 0:n.pop(),n.length&&n[0]===e[0]?yr(n,Qi(t,2)):[]})),jo=jr((function(e){var t=Wo(e),n=pt(e,ai);return(t="function"==typeof t?t:void 0)&&n.pop(),n.length&&n[0]===e[0]?yr(n,void 0,t):[]}));function Wo(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var Go=jr(Fo);function Fo(e,t){return e&&e.length&&t&&t.length?Vr(e,t):e}var Uo=Bi((function(e,t){var n=null==e?0:e.length,r=zn(e,t);return Pr(e,pt(t,(function(e){return so(e,n)?+e:e})).sort(mi)),r}));function Xo(e){return null==e?e:fn.call(e)}var Bo=jr((function(e){return $r(ar(e,1,Da,!0))})),Ho=jr((function(e){var t=Wo(e);return Da(t)&&(t=void 0),$r(ar(e,1,Da,!0),Qi(t,2))})),Yo=jr((function(e){var t=Wo(e);return t="function"==typeof t?t:void 0,$r(ar(e,1,Da,!0),void 0,t)}));function Jo(e){if(!e||!e.length)return[];var t=0;return e=dt(e,(function(e){if(Da(e))return t=sn(e.length,t),!0})),At(t,(function(t){return pt(e,It(t))}))}function zo(e,t){if(!e||!e.length)return[];var n=Jo(e);return null==t?n:pt(n,(function(e){return ot(t,void 0,e)}))}var Ko=jr((function(e,t){return Da(e)?er(e,t):[]})),Qo=jr((function(e){return ii(dt(e,Da))})),qo=jr((function(e){var t=Wo(e);return Da(t)&&(t=void 0),ii(dt(e,Da),Qi(t,2))})),$o=jr((function(e){var t=Wo(e);return t="function"==typeof t?t:void 0,ii(dt(e,Da),void 0,t)})),ea=jr(Jo);var ta=jr((function(e){var t=e.length,n=t>1?e[t-1]:void 0;return n="function"==typeof n?(e.pop(),n):void 0,zo(e,n)}));function na(e){var t=An(e);return t.__chain__=!0,t}function ra(e,t){return t(e)}var ia=Bi((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,i=function(t){return zn(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Ln&&so(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:ra,args:[i],thisArg:void 0}),new Nn(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(void 0),e}))):this.thru(i)}));var oa=Si((function(e,t,n){Te.call(e,n)?++e[n]:Jn(e,n,1)}));var aa=Ci(Lo),sa=Ci(Mo);function ca(e,t){return(Ma(e)?st:tr)(e,Qi(t,3))}function ua(e,t){return(Ma(e)?ct:nr)(e,Qi(t,3))}var da=Si((function(e,t,n){Te.call(e,n)?e[n].push(t):Jn(e,n,[t])}));var la=jr((function(e,t,n){var i=-1,o="function"==typeof t,a=Pa(e)?r(e.length):[];return tr(e,(function(e){a[++i]=o?ot(t,e,n):br(e,t,n)})),a})),fa=Si((function(e,t,n){Jn(e,n,t)}));function pa(e,t){return(Ma(e)?pt:Or)(e,Qi(t,3))}var ha=Si((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));var ma=jr((function(e,t){if(null==e)return[];var n=t.length;return n>1&&co(e,t[0],t[1])?t=[]:n>2&&co(t[0],t[1],t[2])&&(t=[t[0]]),Lr(e,ar(t,1),[])})),ga=Qt||function(){return Ye.Date.now()};function va(e,t,n){return t=n?void 0:t,Wi(e,128,void 0,void 0,void 0,void 0,t=e&&null==t?e.length:t)}function ya(e,t){var n;if("function"!=typeof t)throw new ve(o);return e=is(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}}var ba=jr((function(e,t,n){var r=1;if(n.length){var i=Ut(n,Ki(ba));r|=32}return Wi(e,r,t,n,i)})),Sa=jr((function(e,t,n){var r=3;if(n.length){var i=Ut(n,Ki(Sa));r|=32}return Wi(t,r,e,n,i)}));function Ea(e,t,n){var r,i,a,s,c,u,d=0,l=!1,f=!1,p=!0;if("function"!=typeof e)throw new ve(o);function h(t){var n=r,o=i;return r=i=void 0,d=t,s=e.apply(o,n)}function m(e){return d=e,c=Eo(v,t),l?h(e):s}function g(e){var n=e-u;return void 0===u||n>=t||n<0||f&&e-d>=a}function v(){var e=ga();if(g(e))return y(e);c=Eo(v,function(e){var n=t-(e-u);return f?cn(n,a-(e-d)):n}(e))}function y(e){return c=void 0,p&&r?h(e):(r=i=void 0,s)}function b(){var e=ga(),n=g(e);if(r=arguments,i=this,u=e,n){if(void 0===c)return m(u);if(f)return li(c),c=Eo(v,t),h(u)}return void 0===c&&(c=Eo(v,t)),s}return t=as(t)||0,Xa(n)&&(l=!!n.leading,a=(f="maxWait"in n)?sn(as(n.maxWait)||0,t):a,p="trailing"in n?!!n.trailing:p),b.cancel=function(){void 0!==c&&li(c),d=0,r=u=i=c=void 0},b.flush=function(){return void 0===c?s:y(ga())},b}var _a=jr((function(e,t){return $n(e,1,t)})),Ta=jr((function(e,t,n){return $n(e,as(t)||0,n)}));function Ra(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new ve(o);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(Ra.Cache||Pn),n}function Ia(e){if("function"!=typeof e)throw new ve(o);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Ra.Cache=Pn;var wa=ui((function(e,t){var n=(t=1==t.length&&Ma(t[0])?pt(t[0],kt(Qi())):pt(ar(t,1),kt(Qi()))).length;return jr((function(r){for(var i=-1,o=cn(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return ot(e,this,r)}))})),Ca=jr((function(e,t){return Wi(e,32,void 0,t,Ut(t,Ki(Ca)))})),Oa=jr((function(e,t){return Wi(e,64,void 0,t,Ut(t,Ki(Oa)))})),Aa=Bi((function(e,t){return Wi(e,256,void 0,void 0,void 0,t)}));function xa(e,t){return e===t||e!=e&&t!=t}var ka=Vi(mr),Na=Vi((function(e,t){return e>=t})),La=Sr(function(){return arguments}())?Sr:function(e){return Ba(e)&&Te.call(e,"callee")&&!He.call(e,"callee")},Ma=r.isArray,Va=$e?kt($e):function(e){return Ba(e)&&hr(e)==T};function Pa(e){return null!=e&&Ua(e.length)&&!Ga(e)}function Da(e){return Ba(e)&&Pa(e)}var Za=nn||ac,ja=et?kt(et):function(e){return Ba(e)&&hr(e)==l};function Wa(e){if(!Ba(e))return!1;var t=hr(e);return t==f||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!Ja(e)}function Ga(e){if(!Xa(e))return!1;var t=hr(e);return t==p||t==h||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Fa(e){return"number"==typeof e&&e==is(e)}function Ua(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function Xa(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ba(e){return null!=e&&"object"==typeof e}var Ha=tt?kt(tt):function(e){return Ba(e)&&ro(e)==m};function Ya(e){return"number"==typeof e||Ba(e)&&hr(e)==g}function Ja(e){if(!Ba(e)||hr(e)!=v)return!1;var t=Fe(e);if(null===t)return!0;var n=Te.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&_e.call(n)==Ce}var za=nt?kt(nt):function(e){return Ba(e)&&hr(e)==y};var Ka=rt?kt(rt):function(e){return Ba(e)&&ro(e)==b};function Qa(e){return"string"==typeof e||!Ma(e)&&Ba(e)&&hr(e)==S}function qa(e){return"symbol"==typeof e||Ba(e)&&hr(e)==E}var $a=it?kt(it):function(e){return Ba(e)&&Ua(e.length)&&!!We[hr(e)]};var es=Vi(Cr),ts=Vi((function(e,t){return e<=t}));function ns(e){if(!e)return[];if(Pa(e))return Qa(e)?Yt(e):yi(e);if(Qe&&e[Qe])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Qe]());var t=ro(e);return(t==m?Gt:t==b?Xt:xs)(e)}function rs(e){return e?(e=as(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function is(e){var t=rs(e),n=t%1;return t==t?n?t-n:t:0}function os(e){return e?Kn(is(e),0,4294967295):0}function as(e){if("number"==typeof e)return e;if(qa(e))return NaN;if(Xa(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Xa(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=xt(e);var n=oe.test(e);return n||se.test(e)?Xe(e.slice(2),n?2:8):ie.test(e)?NaN:+e}function ss(e){return bi(e,_s(e))}function cs(e){return null==e?"":qr(e)}var us=Ei((function(e,t){if(po(t)||Pa(t))bi(t,Es(t),e);else for(var n in t)Te.call(t,n)&&Xn(e,n,t[n])})),ds=Ei((function(e,t){bi(t,_s(t),e)})),ls=Ei((function(e,t,n,r){bi(t,_s(t),e,r)})),fs=Ei((function(e,t,n,r){bi(t,Es(t),e,r)})),ps=Bi(zn);var hs=jr((function(e,t){e=he(e);var n=-1,r=t.length,i=r>2?t[2]:void 0;for(i&&co(t[0],t[1],i)&&(r=1);++n<r;)for(var o=t[n],a=_s(o),s=-1,c=a.length;++s<c;){var u=a[s],d=e[u];(void 0===d||xa(d,Se[u])&&!Te.call(e,u))&&(e[u]=o[u])}return e})),ms=jr((function(e){return e.push(void 0,Fi),ot(Rs,void 0,e)}));function gs(e,t,n){var r=null==e?void 0:fr(e,t);return void 0===r?n:r}function vs(e,t){return null!=e&&io(e,t,vr)}var ys=xi((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=we.call(t)),e[t]=n}),Xs(Ys)),bs=xi((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=we.call(t)),Te.call(e,t)?e[t].push(n):e[t]=[n]}),Qi),Ss=jr(br);function Es(e){return Pa(e)?jn(e):Ir(e)}function _s(e){return Pa(e)?jn(e,!0):wr(e)}var Ts=Ei((function(e,t,n){kr(e,t,n)})),Rs=Ei((function(e,t,n,r){kr(e,t,n,r)})),Is=Bi((function(e,t){var n={};if(null==e)return n;var r=!1;t=pt(t,(function(t){return t=ci(t,e),r||(r=t.length>1),t})),bi(e,Yi(e),n),r&&(n=Qn(n,7,Ui));for(var i=t.length;i--;)ei(n,t[i]);return n}));var ws=Bi((function(e,t){return null==e?{}:function(e,t){return Mr(e,t,(function(t,n){return vs(e,n)}))}(e,t)}));function Cs(e,t){if(null==e)return{};var n=pt(Yi(e),(function(e){return[e]}));return t=Qi(t),Mr(e,n,(function(e,n){return t(e,n[0])}))}var Os=ji(Es),As=ji(_s);function xs(e){return null==e?[]:Nt(e,Es(e))}var ks=Ii((function(e,t,n){return t=t.toLowerCase(),e+(n?Ns(t):t)}));function Ns(e){return Ws(cs(e).toLowerCase())}function Ls(e){return(e=cs(e))&&e.replace(ue,Dt).replace(Le,"")}var Ms=Ii((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Vs=Ii((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Ps=Ri("toLowerCase");var Ds=Ii((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));var Zs=Ii((function(e,t,n){return e+(n?" ":"")+Ws(t)}));var js=Ii((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Ws=Ri("toUpperCase");function Gs(e,t,n){return e=cs(e),void 0===(t=n?void 0:t)?function(e){return De.test(e)}(e)?function(e){return e.match(Ve)||[]}(e):function(e){return e.match($)||[]}(e):e.match(t)||[]}var Fs=jr((function(e,t){try{return ot(e,void 0,t)}catch(e){return Wa(e)?e:new z(e)}})),Us=Bi((function(e,t){return st(t,(function(t){t=Co(t),Jn(e,t,ba(e[t],e))})),e}));function Xs(e){return function(){return e}}var Bs=Oi(),Hs=Oi(!0);function Ys(e){return e}function Js(e){return Rr("function"==typeof e?e:Qn(e,1))}var zs=jr((function(e,t){return function(n){return br(n,e,t)}})),Ks=jr((function(e,t){return function(n){return br(e,n,t)}}));function Qs(e,t,n){var r=Es(t),i=lr(t,r);null!=n||Xa(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=lr(t,Es(t)));var o=!(Xa(n)&&"chain"in n&&!n.chain),a=Ga(e);return st(i,(function(n){var r=t[n];e[n]=r,a&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__),i=n.__actions__=yi(this.__actions__);return i.push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,ht([this.value()],arguments))})})),e}function qs(){}var $s=Ni(pt),ec=Ni(ut),tc=Ni(vt);function nc(e){return uo(e)?It(Co(e)):function(e){return function(t){return fr(t,e)}}(e)}var rc=Mi(),ic=Mi(!0);function oc(){return[]}function ac(){return!1}var sc=ki((function(e,t){return e+t}),0),cc=Di("ceil"),uc=ki((function(e,t){return e/t}),1),dc=Di("floor");var lc,fc=ki((function(e,t){return e*t}),1),pc=Di("round"),hc=ki((function(e,t){return e-t}),0);return An.after=function(e,t){if("function"!=typeof t)throw new ve(o);return e=is(e),function(){if(--e<1)return t.apply(this,arguments)}},An.ary=va,An.assign=us,An.assignIn=ds,An.assignInWith=ls,An.assignWith=fs,An.at=ps,An.before=ya,An.bind=ba,An.bindAll=Us,An.bindKey=Sa,An.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Ma(e)?e:[e]},An.chain=na,An.chunk=function(e,t,n){t=(n?co(e,t,n):void 0===t)?1:sn(is(t),0);var i=null==e?0:e.length;if(!i||t<1)return[];for(var o=0,a=0,s=r($t(i/t));o<i;)s[a++]=Hr(e,o,o+=t);return s},An.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},An.concat=function(){var e=arguments.length;if(!e)return[];for(var t=r(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return ht(Ma(n)?yi(n):[n],ar(t,1))},An.cond=function(e){var t=null==e?0:e.length,n=Qi();return e=t?pt(e,(function(e){if("function"!=typeof e[1])throw new ve(o);return[n(e[0]),e[1]]})):[],jr((function(n){for(var r=-1;++r<t;){var i=e[r];if(ot(i[0],this,n))return ot(i[1],this,n)}}))},An.conforms=function(e){return function(e){var t=Es(e);return function(n){return qn(n,e,t)}}(Qn(e,1))},An.constant=Xs,An.countBy=oa,An.create=function(e,t){var n=xn(e);return null==t?n:Yn(n,t)},An.curry=function e(t,n,r){var i=Wi(t,8,void 0,void 0,void 0,void 0,void 0,n=r?void 0:n);return i.placeholder=e.placeholder,i},An.curryRight=function e(t,n,r){var i=Wi(t,16,void 0,void 0,void 0,void 0,void 0,n=r?void 0:n);return i.placeholder=e.placeholder,i},An.debounce=Ea,An.defaults=hs,An.defaultsDeep=ms,An.defer=_a,An.delay=Ta,An.difference=xo,An.differenceBy=ko,An.differenceWith=No,An.drop=function(e,t,n){var r=null==e?0:e.length;return r?Hr(e,(t=n||void 0===t?1:is(t))<0?0:t,r):[]},An.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?Hr(e,0,(t=r-(t=n||void 0===t?1:is(t)))<0?0:t):[]},An.dropRightWhile=function(e,t){return e&&e.length?ni(e,Qi(t,3),!0,!0):[]},An.dropWhile=function(e,t){return e&&e.length?ni(e,Qi(t,3),!0):[]},An.fill=function(e,t,n,r){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&co(e,t,n)&&(n=0,r=i),function(e,t,n,r){var i=e.length;for((n=is(n))<0&&(n=-n>i?0:i+n),(r=void 0===r||r>i?i:is(r))<0&&(r+=i),r=n>r?0:os(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},An.filter=function(e,t){return(Ma(e)?dt:or)(e,Qi(t,3))},An.flatMap=function(e,t){return ar(pa(e,t),1)},An.flatMapDeep=function(e,t){return ar(pa(e,t),1/0)},An.flatMapDepth=function(e,t,n){return n=void 0===n?1:is(n),ar(pa(e,t),n)},An.flatten=Vo,An.flattenDeep=function(e){return(null==e?0:e.length)?ar(e,1/0):[]},An.flattenDepth=function(e,t){return(null==e?0:e.length)?ar(e,t=void 0===t?1:is(t)):[]},An.flip=function(e){return Wi(e,512)},An.flow=Bs,An.flowRight=Hs,An.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},An.functions=function(e){return null==e?[]:lr(e,Es(e))},An.functionsIn=function(e){return null==e?[]:lr(e,_s(e))},An.groupBy=da,An.initial=function(e){return(null==e?0:e.length)?Hr(e,0,-1):[]},An.intersection=Do,An.intersectionBy=Zo,An.intersectionWith=jo,An.invert=ys,An.invertBy=bs,An.invokeMap=la,An.iteratee=Js,An.keyBy=fa,An.keys=Es,An.keysIn=_s,An.map=pa,An.mapKeys=function(e,t){var n={};return t=Qi(t,3),ur(e,(function(e,r,i){Jn(n,t(e,r,i),e)})),n},An.mapValues=function(e,t){var n={};return t=Qi(t,3),ur(e,(function(e,r,i){Jn(n,r,t(e,r,i))})),n},An.matches=function(e){return Ar(Qn(e,1))},An.matchesProperty=function(e,t){return xr(e,Qn(t,1))},An.memoize=Ra,An.merge=Ts,An.mergeWith=Rs,An.method=zs,An.methodOf=Ks,An.mixin=Qs,An.negate=Ia,An.nthArg=function(e){return e=is(e),jr((function(t){return Nr(t,e)}))},An.omit=Is,An.omitBy=function(e,t){return Cs(e,Ia(Qi(t)))},An.once=function(e){return ya(2,e)},An.orderBy=function(e,t,n,r){return null==e?[]:(Ma(t)||(t=null==t?[]:[t]),Ma(n=r?void 0:n)||(n=null==n?[]:[n]),Lr(e,t,n))},An.over=$s,An.overArgs=wa,An.overEvery=ec,An.overSome=tc,An.partial=Ca,An.partialRight=Oa,An.partition=ha,An.pick=ws,An.pickBy=Cs,An.property=nc,An.propertyOf=function(e){return function(t){return null==e?void 0:fr(e,t)}},An.pull=Go,An.pullAll=Fo,An.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Vr(e,t,Qi(n,2)):e},An.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?Vr(e,t,void 0,n):e},An.pullAt=Uo,An.range=rc,An.rangeRight=ic,An.rearg=Aa,An.reject=function(e,t){return(Ma(e)?dt:or)(e,Ia(Qi(t,3)))},An.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=Qi(t,3);++r<o;){var a=e[r];t(a,r,e)&&(n.push(a),i.push(r))}return Pr(e,i),n},An.rest=function(e,t){if("function"!=typeof e)throw new ve(o);return jr(e,t=void 0===t?t:is(t))},An.reverse=Xo,An.sampleSize=function(e,t,n){return t=(n?co(e,t,n):void 0===t)?1:is(t),(Ma(e)?Gn:Gr)(e,t)},An.set=function(e,t,n){return null==e?e:Fr(e,t,n)},An.setWith=function(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:Fr(e,t,n,r)},An.shuffle=function(e){return(Ma(e)?Fn:Br)(e)},An.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&co(e,t,n)?(t=0,n=r):(t=null==t?0:is(t),n=void 0===n?r:is(n)),Hr(e,t,n)):[]},An.sortBy=ma,An.sortedUniq=function(e){return e&&e.length?Kr(e):[]},An.sortedUniqBy=function(e,t){return e&&e.length?Kr(e,Qi(t,2)):[]},An.split=function(e,t,n){return n&&"number"!=typeof n&&co(e,t,n)&&(t=n=void 0),(n=void 0===n?4294967295:n>>>0)?(e=cs(e))&&("string"==typeof t||null!=t&&!za(t))&&!(t=qr(t))&&Wt(e)?di(Yt(e),0,n):e.split(t,n):[]},An.spread=function(e,t){if("function"!=typeof e)throw new ve(o);return t=null==t?0:sn(is(t),0),jr((function(n){var r=n[t],i=di(n,0,t);return r&&ht(i,r),ot(e,this,i)}))},An.tail=function(e){var t=null==e?0:e.length;return t?Hr(e,1,t):[]},An.take=function(e,t,n){return e&&e.length?Hr(e,0,(t=n||void 0===t?1:is(t))<0?0:t):[]},An.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?Hr(e,(t=r-(t=n||void 0===t?1:is(t)))<0?0:t,r):[]},An.takeRightWhile=function(e,t){return e&&e.length?ni(e,Qi(t,3),!1,!0):[]},An.takeWhile=function(e,t){return e&&e.length?ni(e,Qi(t,3)):[]},An.tap=function(e,t){return t(e),e},An.throttle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new ve(o);return Xa(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Ea(e,t,{leading:r,maxWait:t,trailing:i})},An.thru=ra,An.toArray=ns,An.toPairs=Os,An.toPairsIn=As,An.toPath=function(e){return Ma(e)?pt(e,Co):qa(e)?[e]:yi(wo(cs(e)))},An.toPlainObject=ss,An.transform=function(e,t,n){var r=Ma(e),i=r||Za(e)||$a(e);if(t=Qi(t,4),null==n){var o=e&&e.constructor;n=i?r?new o:[]:Xa(e)&&Ga(o)?xn(Fe(e)):{}}return(i?st:ur)(e,(function(e,r,i){return t(n,e,r,i)})),n},An.unary=function(e){return va(e,1)},An.union=Bo,An.unionBy=Ho,An.unionWith=Yo,An.uniq=function(e){return e&&e.length?$r(e):[]},An.uniqBy=function(e,t){return e&&e.length?$r(e,Qi(t,2)):[]},An.uniqWith=function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?$r(e,void 0,t):[]},An.unset=function(e,t){return null==e||ei(e,t)},An.unzip=Jo,An.unzipWith=zo,An.update=function(e,t,n){return null==e?e:ti(e,t,si(n))},An.updateWith=function(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:ti(e,t,si(n),r)},An.values=xs,An.valuesIn=function(e){return null==e?[]:Nt(e,_s(e))},An.without=Ko,An.words=Gs,An.wrap=function(e,t){return Ca(si(t),e)},An.xor=Qo,An.xorBy=qo,An.xorWith=$o,An.zip=ea,An.zipObject=function(e,t){return oi(e||[],t||[],Xn)},An.zipObjectDeep=function(e,t){return oi(e||[],t||[],Fr)},An.zipWith=ta,An.entries=Os,An.entriesIn=As,An.extend=ds,An.extendWith=ls,Qs(An,An),An.add=sc,An.attempt=Fs,An.camelCase=ks,An.capitalize=Ns,An.ceil=cc,An.clamp=function(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=as(n))==n?n:0),void 0!==t&&(t=(t=as(t))==t?t:0),Kn(as(e),t,n)},An.clone=function(e){return Qn(e,4)},An.cloneDeep=function(e){return Qn(e,5)},An.cloneDeepWith=function(e,t){return Qn(e,5,t="function"==typeof t?t:void 0)},An.cloneWith=function(e,t){return Qn(e,4,t="function"==typeof t?t:void 0)},An.conformsTo=function(e,t){return null==t||qn(e,t,Es(t))},An.deburr=Ls,An.defaultTo=function(e,t){return null==e||e!=e?t:e},An.divide=uc,An.endsWith=function(e,t,n){e=cs(e),t=qr(t);var r=e.length,i=n=void 0===n?r:Kn(is(n),0,r);return(n-=t.length)>=0&&e.slice(n,i)==t},An.eq=xa,An.escape=function(e){return(e=cs(e))&&j.test(e)?e.replace(D,Zt):e},An.escapeRegExp=function(e){return(e=cs(e))&&Y.test(e)?e.replace(H,"\\$&"):e},An.every=function(e,t,n){var r=Ma(e)?ut:rr;return n&&co(e,t,n)&&(t=void 0),r(e,Qi(t,3))},An.find=aa,An.findIndex=Lo,An.findKey=function(e,t){return bt(e,Qi(t,3),ur)},An.findLast=sa,An.findLastIndex=Mo,An.findLastKey=function(e,t){return bt(e,Qi(t,3),dr)},An.floor=dc,An.forEach=ca,An.forEachRight=ua,An.forIn=function(e,t){return null==e?e:sr(e,Qi(t,3),_s)},An.forInRight=function(e,t){return null==e?e:cr(e,Qi(t,3),_s)},An.forOwn=function(e,t){return e&&ur(e,Qi(t,3))},An.forOwnRight=function(e,t){return e&&dr(e,Qi(t,3))},An.get=gs,An.gt=ka,An.gte=Na,An.has=function(e,t){return null!=e&&io(e,t,gr)},An.hasIn=vs,An.head=Po,An.identity=Ys,An.includes=function(e,t,n,r){e=Pa(e)?e:xs(e),n=n&&!r?is(n):0;var i=e.length;return n<0&&(n=sn(i+n,0)),Qa(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&Et(e,t,n)>-1},An.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:is(n);return i<0&&(i=sn(r+i,0)),Et(e,t,i)},An.inRange=function(e,t,n){return t=rs(t),void 0===n?(n=t,t=0):n=rs(n),function(e,t,n){return e>=cn(t,n)&&e<sn(t,n)}(e=as(e),t,n)},An.invoke=Ss,An.isArguments=La,An.isArray=Ma,An.isArrayBuffer=Va,An.isArrayLike=Pa,An.isArrayLikeObject=Da,An.isBoolean=function(e){return!0===e||!1===e||Ba(e)&&hr(e)==d},An.isBuffer=Za,An.isDate=ja,An.isElement=function(e){return Ba(e)&&1===e.nodeType&&!Ja(e)},An.isEmpty=function(e){if(null==e)return!0;if(Pa(e)&&(Ma(e)||"string"==typeof e||"function"==typeof e.splice||Za(e)||$a(e)||La(e)))return!e.length;var t=ro(e);if(t==m||t==b)return!e.size;if(po(e))return!Ir(e).length;for(var n in e)if(Te.call(e,n))return!1;return!0},An.isEqual=function(e,t){return Er(e,t)},An.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:void 0)?n(e,t):void 0;return void 0===r?Er(e,t,void 0,n):!!r},An.isError=Wa,An.isFinite=function(e){return"number"==typeof e&&rn(e)},An.isFunction=Ga,An.isInteger=Fa,An.isLength=Ua,An.isMap=Ha,An.isMatch=function(e,t){return e===t||_r(e,t,$i(t))},An.isMatchWith=function(e,t,n){return n="function"==typeof n?n:void 0,_r(e,t,$i(t),n)},An.isNaN=function(e){return Ya(e)&&e!=+e},An.isNative=function(e){if(fo(e))throw new z("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Tr(e)},An.isNil=function(e){return null==e},An.isNull=function(e){return null===e},An.isNumber=Ya,An.isObject=Xa,An.isObjectLike=Ba,An.isPlainObject=Ja,An.isRegExp=za,An.isSafeInteger=function(e){return Fa(e)&&e>=-9007199254740991&&e<=9007199254740991},An.isSet=Ka,An.isString=Qa,An.isSymbol=qa,An.isTypedArray=$a,An.isUndefined=function(e){return void 0===e},An.isWeakMap=function(e){return Ba(e)&&ro(e)==_},An.isWeakSet=function(e){return Ba(e)&&"[object WeakSet]"==hr(e)},An.join=function(e,t){return null==e?"":on.call(e,t)},An.kebabCase=Ms,An.last=Wo,An.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r;return void 0!==n&&(i=(i=is(n))<0?sn(r+i,0):cn(i,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,i):St(e,Tt,i,!0)},An.lowerCase=Vs,An.lowerFirst=Ps,An.lt=es,An.lte=ts,An.max=function(e){return e&&e.length?ir(e,Ys,mr):void 0},An.maxBy=function(e,t){return e&&e.length?ir(e,Qi(t,2),mr):void 0},An.mean=function(e){return Rt(e,Ys)},An.meanBy=function(e,t){return Rt(e,Qi(t,2))},An.min=function(e){return e&&e.length?ir(e,Ys,Cr):void 0},An.minBy=function(e,t){return e&&e.length?ir(e,Qi(t,2),Cr):void 0},An.stubArray=oc,An.stubFalse=ac,An.stubObject=function(){return{}},An.stubString=function(){return""},An.stubTrue=function(){return!0},An.multiply=fc,An.nth=function(e,t){return e&&e.length?Nr(e,is(t)):void 0},An.noConflict=function(){return Ye._===this&&(Ye._=Oe),this},An.noop=qs,An.now=ga,An.pad=function(e,t,n){e=cs(e);var r=(t=is(t))?Ht(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return Li(en(i),n)+e+Li($t(i),n)},An.padEnd=function(e,t,n){e=cs(e);var r=(t=is(t))?Ht(e):0;return t&&r<t?e+Li(t-r,n):e},An.padStart=function(e,t,n){e=cs(e);var r=(t=is(t))?Ht(e):0;return t&&r<t?Li(t-r,n)+e:e},An.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),dn(cs(e).replace(J,""),t||0)},An.random=function(e,t,n){if(n&&"boolean"!=typeof n&&co(e,t,n)&&(t=n=void 0),void 0===n&&("boolean"==typeof t?(n=t,t=void 0):"boolean"==typeof e&&(n=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=rs(e),void 0===t?(t=e,e=0):t=rs(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var i=ln();return cn(e+i*(t-e+Ue("1e-"+((i+"").length-1))),t)}return Dr(e,t)},An.reduce=function(e,t,n){var r=Ma(e)?mt:Ct,i=arguments.length<3;return r(e,Qi(t,4),n,i,tr)},An.reduceRight=function(e,t,n){var r=Ma(e)?gt:Ct,i=arguments.length<3;return r(e,Qi(t,4),n,i,nr)},An.repeat=function(e,t,n){return t=(n?co(e,t,n):void 0===t)?1:is(t),Zr(cs(e),t)},An.replace=function(){var e=arguments,t=cs(e[0]);return e.length<3?t:t.replace(e[1],e[2])},An.result=function(e,t,n){var r=-1,i=(t=ci(t,e)).length;for(i||(i=1,e=void 0);++r<i;){var o=null==e?void 0:e[Co(t[r])];void 0===o&&(r=i,o=n),e=Ga(o)?o.call(e):o}return e},An.round=pc,An.runInContext=e,An.sample=function(e){return(Ma(e)?Wn:Wr)(e)},An.size=function(e){if(null==e)return 0;if(Pa(e))return Qa(e)?Ht(e):e.length;var t=ro(e);return t==m||t==b?e.size:Ir(e).length},An.snakeCase=Ds,An.some=function(e,t,n){var r=Ma(e)?vt:Yr;return n&&co(e,t,n)&&(t=void 0),r(e,Qi(t,3))},An.sortedIndex=function(e,t){return Jr(e,t)},An.sortedIndexBy=function(e,t,n){return zr(e,t,Qi(n,2))},An.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=Jr(e,t);if(r<n&&xa(e[r],t))return r}return-1},An.sortedLastIndex=function(e,t){return Jr(e,t,!0)},An.sortedLastIndexBy=function(e,t,n){return zr(e,t,Qi(n,2),!0)},An.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var n=Jr(e,t,!0)-1;if(xa(e[n],t))return n}return-1},An.startCase=Zs,An.startsWith=function(e,t,n){return e=cs(e),n=null==n?0:Kn(is(n),0,e.length),t=qr(t),e.slice(n,n+t.length)==t},An.subtract=hc,An.sum=function(e){return e&&e.length?Ot(e,Ys):0},An.sumBy=function(e,t){return e&&e.length?Ot(e,Qi(t,2)):0},An.template=function(e,t,n){var r=An.templateSettings;n&&co(e,t,n)&&(t=void 0),e=cs(e),t=ls({},t,r,Gi);var i,o,a=ls({},t.imports,r.imports,Gi),s=Es(a),c=Nt(a,s),u=0,d=t.interpolate||de,l="__p += '",f=me((t.escape||de).source+"|"+d.source+"|"+(d===F?ne:de).source+"|"+(t.evaluate||de).source+"|$","g"),p="//# sourceURL="+(Te.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++je+"]")+"\n";e.replace(f,(function(t,n,r,a,s,c){return r||(r=a),l+=e.slice(u,c).replace(le,jt),n&&(i=!0,l+="' +\n__e("+n+") +\n'"),s&&(o=!0,l+="';\n"+s+";\n__p += '"),r&&(l+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=c+t.length,t})),l+="';\n";var h=Te.call(t,"variable")&&t.variable;if(h){if(ee.test(h))throw new z("Invalid `variable` option passed into `_.template`")}else l="with (obj) {\n"+l+"\n}\n";l=(o?l.replace(L,""):l).replace(M,"$1").replace(V,"$1;"),l="function("+(h||"obj")+") {\n"+(h?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+l+"return __p\n}";var m=Fs((function(){return fe(s,p+"return "+l).apply(void 0,c)}));if(m.source=l,Wa(m))throw m;return m},An.times=function(e,t){if((e=is(e))<1||e>9007199254740991)return[];var n=4294967295,r=cn(e,4294967295);e-=4294967295;for(var i=At(r,t=Qi(t));++n<e;)t(n);return i},An.toFinite=rs,An.toInteger=is,An.toLength=os,An.toLower=function(e){return cs(e).toLowerCase()},An.toNumber=as,An.toSafeInteger=function(e){return e?Kn(is(e),-9007199254740991,9007199254740991):0===e?e:0},An.toString=cs,An.toUpper=function(e){return cs(e).toUpperCase()},An.trim=function(e,t,n){if((e=cs(e))&&(n||void 0===t))return xt(e);if(!e||!(t=qr(t)))return e;var r=Yt(e),i=Yt(t);return di(r,Mt(r,i),Vt(r,i)+1).join("")},An.trimEnd=function(e,t,n){if((e=cs(e))&&(n||void 0===t))return e.slice(0,Jt(e)+1);if(!e||!(t=qr(t)))return e;var r=Yt(e);return di(r,0,Vt(r,Yt(t))+1).join("")},An.trimStart=function(e,t,n){if((e=cs(e))&&(n||void 0===t))return e.replace(J,"");if(!e||!(t=qr(t)))return e;var r=Yt(e);return di(r,Mt(r,Yt(t))).join("")},An.truncate=function(e,t){var n=30,r="...";if(Xa(t)){var i="separator"in t?t.separator:i;n="length"in t?is(t.length):n,r="omission"in t?qr(t.omission):r}var o=(e=cs(e)).length;if(Wt(e)){var a=Yt(e);o=a.length}if(n>=o)return e;var s=n-Ht(r);if(s<1)return r;var c=a?di(a,0,s).join(""):e.slice(0,s);if(void 0===i)return c+r;if(a&&(s+=c.length-s),za(i)){if(e.slice(s).search(i)){var u,d=c;for(i.global||(i=me(i.source,cs(re.exec(i))+"g")),i.lastIndex=0;u=i.exec(d);)var l=u.index;c=c.slice(0,void 0===l?s:l)}}else if(e.indexOf(qr(i),s)!=s){var f=c.lastIndexOf(i);f>-1&&(c=c.slice(0,f))}return c+r},An.unescape=function(e){return(e=cs(e))&&Z.test(e)?e.replace(P,zt):e},An.uniqueId=function(e){var t=++Re;return cs(e)+t},An.upperCase=js,An.upperFirst=Ws,An.each=ca,An.eachRight=ua,An.first=Po,Qs(An,(lc={},ur(An,(function(e,t){Te.call(An.prototype,t)||(lc[t]=e)})),lc),{chain:!1}),An.VERSION="4.17.21",st(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){An[e].placeholder=An})),st(["drop","take"],(function(e,t){Ln.prototype[e]=function(n){n=void 0===n?1:sn(is(n),0);var r=this.__filtered__&&!t?new Ln(this):this.clone();return r.__filtered__?r.__takeCount__=cn(n,r.__takeCount__):r.__views__.push({size:cn(n,4294967295),type:e+(r.__dir__<0?"Right":"")}),r},Ln.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),st(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;Ln.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Qi(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),st(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Ln.prototype[e]=function(){return this[n](1).value()[0]}})),st(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Ln.prototype[e]=function(){return this.__filtered__?new Ln(this):this[n](1)}})),Ln.prototype.compact=function(){return this.filter(Ys)},Ln.prototype.find=function(e){return this.filter(e).head()},Ln.prototype.findLast=function(e){return this.reverse().find(e)},Ln.prototype.invokeMap=jr((function(e,t){return"function"==typeof e?new Ln(this):this.map((function(n){return br(n,e,t)}))})),Ln.prototype.reject=function(e){return this.filter(Ia(Qi(e)))},Ln.prototype.slice=function(e,t){e=is(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Ln(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),void 0!==t&&(n=(t=is(t))<0?n.dropRight(-t):n.take(t-e)),n)},Ln.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ln.prototype.toArray=function(){return this.take(4294967295)},ur(Ln.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),i=An[r?"take"+("last"==t?"Right":""):t],o=r||/^find/.test(t);i&&(An.prototype[t]=function(){var t=this.__wrapped__,a=r?[1]:arguments,s=t instanceof Ln,c=a[0],u=s||Ma(t),d=function(e){var t=i.apply(An,ht([e],a));return r&&l?t[0]:t};u&&n&&"function"==typeof c&&1!=c.length&&(s=u=!1);var l=this.__chain__,f=!!this.__actions__.length,p=o&&!l,h=s&&!f;if(!o&&u){t=h?t:new Ln(this);var m=e.apply(t,a);return m.__actions__.push({func:ra,args:[d],thisArg:void 0}),new Nn(m,l)}return p&&h?e.apply(this,a):(m=this.thru(d),p?r?m.value()[0]:m.value():m)})})),st(["pop","push","shift","sort","splice","unshift"],(function(e){var t=ye[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);An.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(Ma(i)?i:[],e)}return this[n]((function(n){return t.apply(Ma(n)?n:[],e)}))}})),ur(Ln.prototype,(function(e,t){var n=An[t];if(n){var r=n.name+"";Te.call(Sn,r)||(Sn[r]=[]),Sn[r].push({name:t,func:n})}})),Sn[Ai(void 0,2).name]=[{name:"wrapper",func:void 0}],Ln.prototype.clone=function(){var e=new Ln(this.__wrapped__);return e.__actions__=yi(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=yi(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=yi(this.__views__),e},Ln.prototype.reverse=function(){if(this.__filtered__){var e=new Ln(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Ln.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Ma(e),r=t<0,i=n?e.length:0,o=function(e,t,n){var r=-1,i=n.length;for(;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=cn(t,e+a);break;case"takeRight":e=sn(e,t-a)}}return{start:e,end:t}}(0,i,this.__views__),a=o.start,s=o.end,c=s-a,u=r?s:a-1,d=this.__iteratees__,l=d.length,f=0,p=cn(c,this.__takeCount__);if(!n||!r&&i==c&&p==c)return ri(e,this.__actions__);var h=[];e:for(;c--&&f<p;){for(var m=-1,g=e[u+=t];++m<l;){var v=d[m],y=v.iteratee,b=v.type,S=y(g);if(2==b)g=S;else if(!S){if(1==b)continue e;break e}}h[f++]=g}return h},An.prototype.at=ia,An.prototype.chain=function(){return na(this)},An.prototype.commit=function(){return new Nn(this.value(),this.__chain__)},An.prototype.next=function(){void 0===this.__values__&&(this.__values__=ns(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?void 0:this.__values__[this.__index__++]}},An.prototype.plant=function(e){for(var t,n=this;n instanceof kn;){var r=Ao(n);r.__index__=0,r.__values__=void 0,t?i.__wrapped__=r:t=r;var i=r;n=n.__wrapped__}return i.__wrapped__=e,t},An.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Ln){var t=e;return this.__actions__.length&&(t=new Ln(this)),(t=t.reverse()).__actions__.push({func:ra,args:[Xo],thisArg:void 0}),new Nn(t,this.__chain__)}return this.thru(Xo)},An.prototype.toJSON=An.prototype.valueOf=An.prototype.value=function(){return ri(this.__wrapped__,this.__actions__)},An.prototype.first=An.prototype.head,Qe&&(An.prototype[Qe]=function(){return this}),An}();Ye._=Kt,void 0===(i=function(){return Kt}.call(t,n,t,r))||(r.exports=i)}).call(this)}).call(this,n(12),n(19)(e))},,function(module,exports,__webpack_require__){(function(global){
/**
 * @license OpenTok.js 2.25.4 3ebf43adb
 *
 * Copyright (c) 2010-2023 TokBox, Inc.
 * Subject to the applicable Software Development Kit (SDK) License Agreement:
 * https://www.vonage.com/legal/communications-apis/terms-of-use/
 *
 * Date: Wed, 21 Jun 2023 20:53:25 GMT
 */
var factory;window,factory=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=339)}([function(e,t,n){"use strict";const r=n(407),i=n(191),o=n(121),a=i(e=>{const t={};return Object.keys(o).forEach(n=>{const i=o[n].method,a=r(`OpenTok:${e}:${n.toLowerCase()}`);a.log=console[i].bind(console),t[n.toLowerCase()]=a}),t});a.setLogLevel=e=>{let t;try{t=(void 0!==typeof window?window:global).localStorage.debug}catch(e){t=""}const n=[...Object.keys(o).map(t=>`${e>=o[t].priority?"":"-"}(autogen)?OpenTok:*:${t.toLowerCase()}`),...(t||"").split(/[\s,]/).filter(e=>-1===e.indexOf("(autogen)?"))].filter(e=>e).join(",");r.enable(n)},e.exports=a},function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){(function(t){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var n;n=function(){"use strict";function e(e){return"function"==typeof e}var n=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=0,i=void 0,o=void 0,a=function(e,t){p[r]=e,p[r+1]=t,2===(r+=2)&&(o?o(h):b())},s="undefined"!=typeof window?window:void 0,c=s||{},u=c.MutationObserver||c.WebKitMutationObserver,d="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),l="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function f(){var e=setTimeout;return function(){return e(h,1)}}var p=new Array(1e3);function h(){for(var e=0;e<r;e+=2)(0,p[e])(p[e+1]),p[e]=void 0,p[e+1]=void 0;r=0}var m,g,v,y,b=void 0;function S(e,t){var n=this,r=new this.constructor(T);void 0===r[_]&&L(r);var i=n._state;if(i){var o=arguments[i-1];a((function(){return k(i,r,o,n._result)}))}else A(n,r,e,t);return r}function E(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(T);return I(t,e),t}d?b=function(){return t.nextTick(h)}:u?(g=0,v=new u(h),y=document.createTextNode(""),v.observe(y,{characterData:!0}),b=function(){y.data=g=++g%2}):l?((m=new MessageChannel).port1.onmessage=h,b=function(){return m.port2.postMessage(0)}):b=void 0===s?function(){try{var e=Function("return this")().require("vertx");return void 0!==(i=e.runOnLoop||e.runOnContext)?function(){i(h)}:f()}catch(e){return f()}}():f();var _=Math.random().toString(36).substring(2);function T(){}function R(t,n,r){n.constructor===t.constructor&&r===S&&n.constructor.resolve===E?function(e,t){1===t._state?C(e,t._result):2===t._state?O(e,t._result):A(t,void 0,(function(t){return I(e,t)}),(function(t){return O(e,t)}))}(t,n):void 0===r?C(t,n):e(r)?function(e,t,n){a((function(e){var r=!1,i=function(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}(n,t,(function(n){r||(r=!0,t!==n?I(e,n):C(e,n))}),(function(t){r||(r=!0,O(e,t))}),e._label);!r&&i&&(r=!0,O(e,i))}),e)}(t,n,r):C(t,n)}function I(e,t){if(e===t)O(e,new TypeError("You cannot resolve a promise with itself"));else if(i=typeof(r=t),null===r||"object"!==i&&"function"!==i)C(e,t);else{var n=void 0;try{n=t.then}catch(t){return void O(e,t)}R(e,t,n)}var r,i}function w(e){e._onerror&&e._onerror(e._result),x(e)}function C(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&a(x,e))}function O(e,t){void 0===e._state&&(e._state=2,e._result=t,a(w,e))}function A(e,t,n,r){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+1]=n,i[o+2]=r,0===o&&e._state&&a(x,e)}function x(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,i=void 0,o=e._result,a=0;a<t.length;a+=3)r=t[a],i=t[a+n],r?k(n,r,i,o):i(o);e._subscribers.length=0}}function k(t,n,r,i){var o=e(r),a=void 0,s=void 0,c=!0;if(o){try{a=r(i)}catch(e){c=!1,s=e}if(n===a)return void O(n,new TypeError("A promises callback cannot return that same promise."))}else a=i;void 0!==n._state||(o&&c?I(n,a):!1===c?O(n,s):1===t?C(n,a):2===t&&O(n,a))}var N=0;function L(e){e[_]=N++,e._state=void 0,e._result=void 0,e._subscribers=[]}var M=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(T),this.promise[_]||L(this.promise),n(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?C(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&C(this.promise,this._result))):O(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;void 0===this._state&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===E){var i=void 0,o=void 0,a=!1;try{i=e.then}catch(e){a=!0,o=e}if(i===S&&void 0!==e._state)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===V){var s=new n(T);a?O(s,o):R(s,e,i),this._willSettleAt(s,t)}else this._willSettleAt(new n((function(t){return t(e)})),t)}else this._willSettleAt(r(e),t)},e.prototype._settledAt=function(e,t,n){var r=this.promise;void 0===r._state&&(this._remaining--,2===e?O(r,n):this._result[t]=n),0===this._remaining&&C(r,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;A(e,void 0,(function(e){return n._settledAt(1,t,e)}),(function(e){return n._settledAt(2,t,e)}))},e}(),V=function(){function t(e){this[_]=N++,this._result=this._state=void 0,this._subscribers=[],T!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){I(e,t)}),(function(t){O(e,t)}))}catch(t){O(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var n=this.constructor;return e(t)?this.then((function(e){return n.resolve(t()).then((function(){return e}))}),(function(e){return n.resolve(t()).then((function(){throw e}))})):this.then(t,t)},t}();return V.prototype.then=S,V.all=function(e){return new M(this,e).promise},V.race=function(e){var t=this;return n(e)?new t((function(n,r){for(var i=e.length,o=0;o<i;o++)t.resolve(e[o]).then(n,r)})):new t((function(e,t){return t(new TypeError("You must pass an array to race."))}))},V.resolve=E,V.reject=function(e){var t=new this(T);return O(t,e),t},V._setScheduler=function(e){o=e},V._setAsap=function(e){a=e},V._asap=a,V.polyfill=function(){var e=void 0;if(void 0!==(void 0!==typeof window?window:global))e=void 0!==typeof window?window:global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=V},V.Promise=V,V},e.exports=n()}).call(this,n(43))},function(e,t,n){"use strict";const r=n(550).parse();e.exports=r},function(e,t,n){e.exports=n(542)},function(e,t,n){(function(t){function n(e,n,r,i,o,a,s){try{var c=e[a](s),u=c.value}catch(e){return void r(e)}c.done?n(u):t.resolve(u).then(i,o)}e.exports=function(e){return function(){var r=this,i=arguments;return new t((function(t,o){var a=e.apply(r,i);function s(e){n(a,t,o,s,c,"next",e)}function c(e){n(a,t,o,s,c,"throw",e)}s(void 0)}))}}}).call(this,n(2))},function(e,t,n){"use strict";const r=n(14),i=n(17),o=n(0)("Events"),a=n(9),s=n(412);e.exports=function(e){const t=new r;t.on("newListener",e=>{t.emit(e+":added")}),t.on("removeListener",e=>{t.emit(e+":removed")});const n={eventsDispatched:{},on(e,n,r){return"string"==typeof e&&n?e.split(" ").forEach(e=>{t.on(e,s(n,r))}):Object.keys(e).forEach(r=>{t.on(r,s(e[r],n))}),this},off(e,n,r){return"string"==typeof e?this.off(e.split(" "),n,r):Array.isArray(e)?e.forEach(e=>{n&&i(n)?t.removeListener(e,s(n,r)):t.removeAllListeners(e)}):e?Object.keys(e).forEach(r=>{t.removeListener(r,s(e[r],n))}):t.removeAllListeners(),this},once(e,n,r){return"string"==typeof e&&n?e.split(" ").forEach(e=>{t.once(e,s(n,r))}):Object.keys(e).forEach(r=>{t.once(r,s(e[r],n))}),this},dispatchEvent(e){if(!e.type)throw new Error("dispatchEvent: Event has no type");return e.target||(e.target=this),this.trigger(e.type,e),this},dispatchEventOnce(e,t){this.isEventDispatched(e.type,t)||(this.dispatchEvent(e),this.eventsDispatched[e.type]?this.eventsDispatched[e.type].push(t):this.eventsDispatched[e.type]=[t])},isEventDispatched(e,t){var n;return null==(n=this.eventsDispatched[e])?void 0:n.includes(t)},trigger(e){try{for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t.emit(e,...r)}catch(e){o.error("An error occurred in an event handler",e)}return this},emit(){return e.trigger(...arguments)},addEventListener:(t,n,r)=>(o.warn("The addEventListener() method is deprecated. Use on() or once() instead."),e.on(t,n,r)),removeEventListener:(t,n,r)=>(o.warn("The removeEventListener() method is deprecated. Use off() instead."),e.off(t,n,r)),listenerCount:e=>t.listenerCount(e)};return a(e,n)}},function(e,t,n){"use strict";e.exports={AUTHENTICATION_ERROR:"OT_AUTHENTICATION_ERROR",BADLY_FORMED_RESPONSE:"OT_BADLY_FORMED_RESPONSE",CHROME_MICROPHONE_ACQUISITION_ERROR:"OT_CHROME_MICROPHONE_ACQUISITION_ERROR",CONNECT_FAILED:"OT_CONNECT_FAILED",CONNECTION_LIMIT_EXCEEDED:"OT_CONNECTION_LIMIT_EXCEEDED",CONSTRAINTS_NOT_SATISFIED:"OT_CONSTRAINTS_NOT_SATISFIED",CREATE_PEER_CONNECTION_FAILED:"OT_CREATE_PEER_CONNECTION_FAILED",DISCONNECTED:"OT_DISCONNECTED",EMPTY_RESPONSE_BODY:"OT_EMPTY_RESPONSE_BODY",GET_RTC_STATS_REPORT_NOT_SUPPORTED:"OT_GET_RTC_STATS_REPORT_NOT_SUPPORTED",HARDWARE_UNAVAILABLE:"OT_HARDWARE_UNAVAILABLE",ICE_WORKFLOW_FAILED:"OT_ICE_WORKFLOW_FAILED",INVALID_HTTP_STATUS:"OT_INVALID_HTTP_STATUS",INVALID_PARAMETER:"OT_INVALID_PARAMETER",INVALID_SESSION_ID:"OT_INVALID_SESSION_ID",MEDIA_ERR_ABORTED:"OT_MEDIA_ERR_ABORTED",MEDIA_ERR_DECODE:"OT_MEDIA_ERR_DECODE",MEDIA_ERR_NETWORK:"OT_MEDIA_ERR_NETWORK",MEDIA_ERR_SRC_NOT_SUPPORTED:"OT_MEDIA_ERR_SRC_NOT_SUPPORTED",MEDIA_ENDED:"OT_MEDIA_ENDED",NO_DEVICES_FOUND:"OT_NO_DEVICES_FOUND",NO_VALID_CONSTRAINTS:"OT_NO_VALID_CONSTRAINTS",NOT_CONNECTED:"OT_NOT_CONNECTED",NOT_FOUND:"OT_NOT_FOUND",NOT_SUPPORTED:"OT_NOT_SUPPORTED",PEER_CONNECTION_NOT_CONNECTED:"OT_PEER_CONNECTION_NOT_CONNECTED",PERMISSION_DENIED:"OT_PERMISSION_DENIED",RATE_LIMIT_EXCEEDED:"OT_RATE_LIMIT_EXCEEDED",REPORT_ISSUE_FAILED:"OT_REPORT_ISSUE_FAILED",SCREEN_SHARING_EXTENSION_NOT_INSTALLED:"OT_SCREEN_SHARING_EXTENSION_NOT_INSTALLED",SCREEN_SHARING_EXTENSION_NOT_REGISTERED:"OT_SCREEN_SHARING_EXTENSION_NOT_REGISTERED",SCREEN_SHARING_NOT_SUPPORTED:"OT_SCREEN_SHARING_NOT_SUPPORTED",SET_REMOTE_DESCRIPTION_FAILED:"OT_SET_REMOTE_DESCRIPTION_FAILED",FAILED_SET_CONFIGURATION:"OT_FAILED_SET_CONFIGURATION",SOCKET_ALREADY_CONNECTED_CONNECTING:"OT_SOCKET_ALREADY_CONNECTED_CONNECTING",SOCKET_CLOSE_ABNORMAL:"OT_SOCKET_CLOSE_ABNORMAL",SOCKET_CLOSE_CONNECT_EXCEPTION:"OT_SOCKET_CLOSE_CONNECT_EXCEPTION",SOCKET_CLOSE_CONNECTIVITY_LOSS:"OT_SOCKET_CLOSE_CONNECTIVITY_LOSS",SOCKET_CLOSE_FALLBACK_CODE:"OT_SOCKET_CLOSE_FALLBACK_CODE",SOCKET_CLOSE_INCONSISTENT_DATA:"OT_SOCKET_CLOSE_INCONSISTENT_DATA",SOCKET_CLOSE_NO_STATUS:"OT_SOCKET_CLOSE_NO_STATUS",SOCKET_CLOSE_POLICY_VIOLATION:"OT_SOCKET_CLOSE_POLICY_VIOLATION",SOCKET_CLOSE_GOING_AWAY:"OT_SOCKET_CLOSE_GOING_AWAY",SOCKET_CLOSE_PROTOCOL_ERROR:"OT_SOCKET_CLOSE_PROTOCOL_ERROR",SOCKET_CLOSE_TIMEOUT:"OT_SOCKET_CLOSE_TIMEOUT",SOCKET_CLOSE_TOO_LARGE:"OT_SOCKET_CLOSE_TOO_LARGE",SOCKET_CLOSE_UNEXPECTED_CONDITION:"OT_SOCKET_CLOSE_UNEXPECTED_CONDITION",SOCKET_CLOSE_UNSUPPORTED:"OT_SOCKET_CLOSE_UNSUPPORTED",STREAM_CREATE_FAILED:"OT_STREAM_CREATE_FAILED",STREAM_DESTROYED:"OT_STREAM_DESTROYED",STREAM_LIMIT_EXCEEDED:"OT_STREAM_LIMIT_EXCEEDED",STREAM_NOT_FOUND:"OT_STREAM_NOT_FOUND",UNABLE_TO_SUBSCRIBE:"OT_UNABLE_TO_SUBSCRIBE",TERMS_OF_SERVICE_FAILURE:"OT_TERMS_OF_SERVICE_FAILURE",TIMEOUT:"OT_TIMEOUT",CANCEL:"OT_CANCEL",UNABLE_TO_CAPTURE_MEDIA:"OT_UNABLE_TO_CAPTURE_MEDIA",UNABLE_TO_CAPTURE_SCREEN:"OT_UNABLE_TO_CAPTURE_SCREEN",UNEXPECTED_ERROR_CODE:"OT_UNEXPECTED_ERROR_CODE",UNEXPECTED_HTTP_STATUS:"OT_UNEXPECTED_HTTP_STATUS",UNEXPECTED_SERVER_RESPONSE:"OT_UNEXPECTED_SERVER_RESPONSE",UNKNOWN_HTTP_ERROR:"OT_UNKNOWN_HTTP_ERROR",UNSUPPORTED_BROWSER:"OT_UNSUPPORTED_BROWSER",USER_MEDIA_ACCESS_DENIED:"OT_USER_MEDIA_ACCESS_DENIED",XDOMAIN_OR_PARSING_ERROR:"OT_XDOMAIN_OR_PARSING_ERROR",API_KEY_DISABLED:"OT_API_KEY_DISABLED",UNABLE_TO_ACCESS_MEDIA_ENGINE:"OT_UNABLE_TO_ACCESS_MEDIA_ENGINE",SET_PROXY_URL_TIMING_ERROR:"OT_SET_PROXY_URL_TIMING_ERROR",PROXY_URL_ALREADY_SET_ERROR:"OT_PROXY_URL_ALREADY_SET_ERROR",SET_VIDEO_SOURCE_FAILURE:"OT_SET_VIDEO_SOURCE_FAILURE",INVALID_VIDEO_SOURCE:"OT_INVALID_VIDEO_SOURCE",REQUESTED_DEVICE_PERMISSION_DENIED:"OT_REQUESTED_DEVICE_PERMISSION_DENIED",INVALID_AUDIO_OUTPUT_SOURCE:"OT_INVALID_AUDIO_OUTPUT_SOURCE",INVALID_ENCRYPTION_SECRET:"OT_INVALID_ENCRYPTION_SECRET"}},function(e,t,n){"use strict";const r=n(245),i=n(249),o=n(6),a=n(0);r.logging=a("OT.$"),r.ElementCollection=n(246),r.env=n(3),r.ajax=n(244),r.statable=n(559),r.Analytics=n(21),r.Collection=n(248),r.domExtras=n(560),r.Error=n(250),i(r,"useLogHelpers",{value(e){const t=a("useLogHelpersDeprecatedMixin");return Object.keys(t).forEach(n=>{e[n]=t[n]}),e},name:"OT.useLogHelpers",getWarning:"Please use an external library for your debugging needs"}),r.defaults=n(141),i(r,"eventing",{value:o,name:"OT.$.eventing",getWarning:"Please use an external library to create an event emitter."}),Object.keys(r).forEach(e=>{const t=r[e]._attachToOTHelpers||{};Object.keys(t).forEach(n=>{!Object.hasOwnProperty.call(r,n)||"util"===e&&"bind"===n||console.warn(`More than one module is trying to define ${n} on OTHelpers.`),r[n]=t[n]})}),e.exports=r},function(e,t,n){var r=n(84),i=n(41),o=n(192),a=n(25),s=n(68),c=n(31),u=Object.prototype.hasOwnProperty,d=o((function(e,t){if(s(t)||a(t))i(t,c(t),e);else for(var n in t)u.call(t,n)&&r(e,n,t[n])}));e.exports=d},function(e,t,n){"use strict";e.exports={JS_EXCEPTION:2e3,AUTHENTICATION_ERROR:1004,INVALID_SESSION_ID:1005,CONNECT_FAILED:1006,CONNECT_REJECTED:1007,CONNECTION_TIMEOUT:1008,NOT_CONNECTED:1010,INVALID_PARAMETER:1011,P2P_CONNECTION_FAILED:1013,API_RESPONSE_FAILURE:1014,PEER_CONNECTION_NOT_CONNECTED:1015,TERMS_OF_SERVICE_FAILURE:1026,CONNECTION_LIMIT_EXCEEDED:1027,UNABLE_TO_PUBLISH:1500,UNABLE_TO_SUBSCRIBE:1501,UNSUPPORTED_VIDEO_CODEC:1502,UNABLE_TO_FORCE_DISCONNECT:1520,UNABLE_TO_FORCE_UNPUBLISH:1530,UNABLE_TO_FORCE_MUTE:1540,PUBLISHER_ICE_WORKFLOW_FAILED:1553,SUBSCRIBER_ICE_WORKFLOW_FAILED:1554,STREAM_LIMIT_EXCEEDED:1605,UNEXPECTED_SERVER_RESPONSE:2001,REPORT_ISSUE_ERROR:2011,SET_PROXY_URL_TIMING_ERROR:2021,PROXY_URL_ALREADY_SET_ERROR:2022,GET_RTC_STATS_REPORT_NOT_SUPPORTED:2031,ANVIL_BADLY_FORMED_RESPONSE:3001,ANVIL_INVALID_HTTP_STATUS:3002,ANVIL_XDOMAIN_OR_PARSING_ERROR:3003,ANVIL_UNKNOWN_HTTP_ERROR:3004,ANVIL_UNEXPECTED_ERROR_CODE:3005,ANVIL_EMPTY_RESPONSE_BODY:3006,ANVIL_CONNECT_FAILED:3007,UNABLE_TO_ACCESS_MEDIA_ENGINE:5001}},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t){var n=Array.isArray;e.exports=n},function(e,t,n){"use strict";e.exports=function(e){void 0===e&&(e={});const t=e.Errors||n(7),r=e.OTErrorClass||n(23),i=Object.keys(t).map(e=>t[e]);return function(e,t,n){if(-1===i.indexOf(e))return new Error(`Attempt to use invalid error name (${e}). Original message: ${t.message}`);if(!(t instanceof Error||/^\[object .*Error\]$/.test(Object.prototype.toString.call(t))))return new Error("Did not pass Error as second argument: "+t);const o=new r(void 0,t.message);if(o.name=e,!t.stack)try{throw t}catch(e){}return o.stack=t.stack,n&&(o.code=n),o}}},function(e,t,n){"use strict";(function(t){var n,r="object"==typeof Reflect?Reflect:null,i=r&&"function"==typeof r.apply?r.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};n=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,n){return new t((function(t,r){function i(t){e.removeListener(n,o),r(t)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),t([].slice.call(arguments))}g(e,n,o,{once:!0}),"error"!==n&&function(e,t,n){"function"==typeof e.on&&g(e,"error",t,n)}(e,i,{once:!0})}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var s=10;function c(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function d(e,t,n,r){var i,o,a,s;if(c(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]),void 0===a)a=o[t]=n,++e._eventsCount;else if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=u(e))>0&&a.length>i&&!a.warned){a.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=e,d.type=t,d.count=a.length,s=d,console&&console.warn&&console.warn(s)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=l.bind(r);return i.listener=n,r.wrapFn=i,i}function p(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):m(i,i.length)}function h(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function g(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){r.once&&e.removeEventListener(t,i),n(o)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return u(this)},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)i(c,this,t);else{var u=c.length,d=m(c,u);for(n=0;n<u;++n)i(d[n],this,t)}return!0},a.prototype.addListener=function(e,t){return d(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return d(this,e,t,!0)},a.prototype.once=function(e,t){return c(t),this.on(e,f(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,f(this,e,t)),this},a.prototype.removeListener=function(e,t){var n,r,i,o,a;if(c(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},a.prototype.listeners=function(e){return p(this,e,!0)},a.prototype.rawListeners=function(e){return p(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},a.prototype.listenerCount=h,a.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}}).call(this,n(2))},function(e,t,n){var r=n(174),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();e.exports=o},function(e,t,n){var r=n(544),i=n(545),o=i;o.v1=r,o.v4=i,e.exports=o},function(e,t,n){var r=n(30),i=n(11);e.exports=function(e){if(!i(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,n){"use strict";var r=n(208),i=Object.prototype.toString;function o(e){return"[object Array]"===i.call(e)}function a(e){return void 0===e}function s(e){return null!==e&&"object"==typeof e}function c(e){if("[object Object]"!==i.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function u(e){return"[object Function]"===i.call(e)}function d(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),o(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:o,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:function(e){return null!==e&&!a(e)&&null!==e.constructor&&!a(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:s,isPlainObject:c,isUndefined:a,isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:u,isStream:function(e){return s(e)&&u(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:d,merge:function e(){var t={};function n(n,r){c(t[r])&&c(n)?t[r]=e(t[r],n):c(n)?t[r]=e({},n):o(n)?t[r]=n.slice():t[r]=n}for(var r=0,i=arguments.length;r<i;r++)d(arguments[r],n);return t},extend:function(e,t,n){return d(t,(function(t,i){e[i]=n&&"function"==typeof t?r(t,n):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},function(e,t,n){"use strict";(function(t){var r=n(1),i=r(n(4)),o=r(n(5)),a=r(n(289));e.exports=function(e){void 0===e&&(e={});const r=e.getNativeEnumerateDevices||n(288)(),s=e.getNativeMediaDevices||n(650)(),c=(e.currentAudioOutputDevice||n(107)).getCurrentAudioOutputDeviceId,u=(e.currentAudioInputDevice||a.default).getCurrentAudioInputDevice,d=e.env||n(3),l=e.global||(void 0!==typeof window?window:global),f={},p={audio:"audioInput",video:"videoInput",audioinput:"audioInput",videoinput:"videoInput",audiooutput:"audioOutput",audioInput:"audioInput",videoInput:"videoInput",audioOutput:"audioOutput"};return f.getNativeMediaDevices=()=>s(),f.hasEnumerateDevicesCapability=()=>"function"==typeof r(),f.hasDeviceChangeCapability=()=>{const e=s();return!(!e||!("ondevicechange"in e))},f.hasSetSinkIdCapability=()=>"setSinkId"in(null==l?void 0:l.HTMLMediaElement.prototype),f.hasAudioOutputApiSupport=()=>f.hasSetSinkIdCapability()&&f.hasDeviceChangeCapability(),f.hasEnumerateDevicesBug=()=>d.isSafari&&13.1===d.version,f.getMediaDevices=()=>f.hasEnumerateDevicesCapability()?r()().then(e=>e.map(e=>({deviceId:e.deviceId||e.id,label:e.label,kind:p[e.kind]}))):t.reject(new Error("This browser does not support enumerateDevices APIs")),f.getInputMediaDevices=()=>f.getMediaDevices().then(e=>e.filter(e=>/^(audio|video)Input$/.test(e.kind))),f.getAudioOutputMediaDevices=()=>f.getMediaDevices().then(e=>e.filter(e=>"audioOutput"===e.kind).map(e=>({deviceId:e.deviceId,label:e.label}))),f.getAudioInputMediaDevices=()=>f.getMediaDevices().then(e=>e.filter(e=>"audioInput"===e.kind).map(e=>({deviceId:e.deviceId,label:e.label}))),f.shouldAskForDevices=()=>f.hasEnumerateDevicesCapability()?f.getInputMediaDevices().then(e=>{if(0===e.length)return{video:!0,audio:!0};const t=e.filter(e=>"audioInput"===e.kind),n=e.filter(e=>"videoInput"===e.kind);return f.hasEnumerateDevicesBug()&&0===n.length?{audio:!0,video:!0}:{video:n.length>0,audio:t.length>0,videoDevices:n,audioDevices:t}}).catch(()=>({video:!0,audio:!0})):t.resolve({video:!0,audio:!0}),f.getDefaultAudioOutputDeviceId=e=>Array.isArray(e)&&0!==e.length?(e.find(e=>"default"===e.deviceId)||e[0]).deviceId:"",f.getDefaultAudioInputDevice=e=>Array.isArray(e)&&0!==e.length?e.find(e=>"default"===e.deviceId)||e[0]:"",f.hasDevice=(e,t)=>{let n=e;return Array.isArray(n)||(n=[]),n.some(e=>e.deviceId===t)},f.getActiveAudioInputDevice=(0,o.default)(i.default.mark((function e(){var t,n,r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.getAudioInputMediaDevices();case 2:if(0!==(t=e.sent).length){e.next=5;break}return e.abrupt("return",{deviceId:null,label:null});case 5:return(n=u())||(r=f.getDefaultAudioInputDevice(t),n=t.find(e=>e===r)),e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)}))),f.getActiveAudioOutputDevice=(0,o.default)(i.default.mark((function e(){var t,n,r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.getAudioOutputMediaDevices();case 3:t=e.sent,e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:if(0!==t.length){e.next=11;break}return e.abrupt("return",{deviceId:null,label:null});case 11:return(n=t.find(e=>e.deviceId===c()))||(r=f.getDefaultAudioOutputDeviceId(t),n=t.find(e=>e.deviceId===r)),e.abrupt("return",n);case 14:case"end":return e.stop()}}),e,null,[[0,6]])}))),f}}).call(this,n(2))},function(e,t,n){"use strict";var r=n(1),i=r(n(4)),o=r(n(5)),a=r(n(46));const s=n(241),c=n(546),u=n(142),d=n(35)(),l=n(561),f=n(6),p=n(563),h=n(566);let m=function(){function e(e){let t=void 0===e?{}:e,n=t.staticConfig,r=void 0===n?d.onlyLocal():n,i=t.sessionInfo,o=void 0===i?new u:i,a=t.ajax,s=t.queue,c=t.getUserAgentClientHintData,l=void 0===c?h:c,f=t.userAgentData,p=void 0===f?"undefined"!=typeof navigator&&navigator.userAgentData:f;this.getTurnServerName=e=>{let t,n;return e&&"object"==typeof e?((Array.isArray(e)?e:[e]).forEach(e=>{const r=e.urls||e.url;(Array.isArray(r)?r:[r]).forEach(e=>{const r=e.indexOf(":")+1,i=e.lastIndexOf(":");e.includes("turns")?n=e.substring(r,i):t=e.substring(r,i)})}),n||t):t},this.ajax=a,this.queue=s,this.sessionInfo=o,this.getUserAgentClientHintData=l,this.userAgentData=p,this.staticConfig=r}var t=e.prototype;return t._getCachedUserAgentData=function(){var e=(0,o.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.cachedUserAgentData){e.next=4;break}return e.next=3,this.getUserAgentClientHintData(this.userAgentData);case 3:this.cachedUserAgentData=e.sent;case 4:return e.abrupt("return",this.cachedUserAgentData);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.commonQoSFields=function(){const e=this._analytics.proxyUrl,t=this.sessionInfo.messagingURL;return{clientVersion:this.staticConfig.clientVersion,buildHash:this.staticConfig.buildHash,source:(void 0!==typeof window?window:global).location&&(void 0!==typeof window?window:global).location.href,logVersion:"2",apiServer:this.staticConfig.apiUrl,clientSystemTime:(new Date).getTime(),sessionId:this.sessionInfo.sessionId,mediaServerName:this.sessionInfo.mediaServerName,relayServer:this.getTurnServerName(this.sessionInfo.iceServers),p2p:this.sessionInfo.p2pEnabled,messagingServer:this.sessionInfo.messagingServer,messagingUrl:l(e,t),version:this.staticConfig.version,partnerId:this.sessionInfo.partnerId}},t._getCommonDataFields=function(){var e=(0,o.default)(i.default.mark((function e(){var t,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.getAsync();case 2:return t=e.sent,e.next=5,this._getCachedUserAgentData();case 5:return n=e.sent,e.abrupt("return",Object.assign({guid:t},this.commonQoSFields(),n));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.logError=function(t,n,r,i,o){void 0===o&&(o={}),this._getCommonDataFields().then(a=>{const s=[t,n,r,i,Object.assign({},a,o)];e.emit("logError",...s),this._analytics.logError(...s)})},t.logEvent=function(t,n,r){void 0===t&&(t={}),this._getCommonDataFields().then(i=>{const o=Object.assign({},i,t);e.emit("logEvent",o),this._analytics.logEvent(o,!1,n,r)})},t.logQOS=function(t){void 0===t&&(t={}),this._getCommonDataFields().then(n=>{const r=Object.assign({duration:0},n,t);p(r),e.emit("logQOS",r),this._analytics.logQOS(r)})},(0,a.default)(e,[{key:"staticConfig",get:function(){return this._staticConfig},set:function(e){this._staticConfig=e,this._analytics=new c({loggingUrl:this.staticConfig.loggingUrl,ajax:this.ajax,queue:this.queue})}}]),e}();f(m),e.exports=m},function(e,t,n){"use strict";const r=n(248),i={publishers:new r("guid"),subscribers:new r("widgetId"),sessions:new r};e.exports=i},function(e,t,n){"use strict";const r=n(0)("GlobalExceptionHandler"),i=n(6),o=n(26),a=n(558),s=n(24)(),c=function(e,t){Error.call(this),this.code=e,this.message=t};(c.prototype=Object.create(Error.prototype)).constructor=c,e.exports=c,i(c),c.getTitleByCode=function(e){return a[+e]},c.handleJsException=e=>{let t=e.error,n=e.errorMsg,i=e.code,a=e.target,u=e.analytics;if(!a)throw new Error("handleJsException requires target");const d=()=>void 0!==i?i:t&&t.code,l=()=>void 0!==n?n:t&&t.message,f=c.getTitleByCode(d());r.error(`OT.exception :: title: ${f} (${d()}) msg: ${l()}`);try{const e={partnerId:a.session?a.session.apiKey:a.apiKey,sessionId:a.session?a.session.sessionId:a.sessionId};u.logError(d(),"tb.exception",f,{details:l()},e);const n=new s.ExceptionEvent(o.EXCEPTION,l(),f,d(),a,a,t);if(t)n.stack=t.stack;else try{throw new Error}catch(e){n.stack=e.stack}c.dispatchEvent(n)}catch(e){r.error("OT.exception :: Failed to dispatch exception - "+e.toString())}}},function(e,t,n){"use strict";var r=n(1),i=r(n(46)),o=r(n(49));const a=n(128),s=n(26);e.exports=function(e){void 0===e&&(e={});const t=e.logging||n(0)("Events"),r={ExceptionEvent:function(e,t,n,r,i,o,s){return new a(e,!1,{error:s,message:t,title:n,code:r,component:i,target:o})},IssueReportedEvent:function(e,t){return new a(e,!1,{issueId:t})},EnvLoadedEvent:function(e){return new a(e,!1)}};let c=!1;r.ConnectionEvent=function(e){function n(t,n,r){return e.call(this,t,!1,{connection:n,reason:r})||this}return(0,o.default)(n,e),(0,i.default)(n,[{key:"connections",get:function(){return c||(t.warn("OT.ConnectionEvent connections property is deprecated, use connection instead."),c=!0),[this.connection]}}]),n}(a);let u=!1;r.StreamEvent=function(e){function n(t,n,r,i){return e.call(this,t,i,{stream:n,reason:r})||this}return(0,o.default)(n,e),(0,i.default)(n,[{key:"streams",get:function(){return u||(t.warn("OT.StreamEvent streams property is deprecated, use stream instead."),u=!0),[this.stream]}}]),n}(a);let d=!1,l=!1,f=!1;return r.SessionConnectEvent=function(e){function n(t){return e.call(this,t,!1)||this}return(0,o.default)(n,e),(0,i.default)(n,[{key:"connections",get:function(){return d||(t.warn("OT.SessionConnectedEvent no longer includes connections. Listen for connectionCreated events instead."),d=!0),[]}},{key:"streams",get:function(){return l||(t.warn("OT.SessionConnectedEvent no longer includes streams. Listen for streamCreated events instead."),l=!0),[]}},{key:"archives",get:function(){return f||(t.warn("OT.SessionConnectedEvent no longer includes archives. Listen for archiveStarted events instead."),f=!0),[]}}]),n}(a),r.SessionReconnectingEvent=function(){return new a(s.SESSION_RECONNECTING,!1)},r.SessionReconnectedEvent=function(){return new a(s.SESSION_RECONNECTED)},r.SessionDisconnectEvent=function(e,t,n){return new a(e,n,{reason:t})},r.StreamPropertyChangedEvent=function(e,t,n,r,i){return new a(e,!1,{stream:t,changedProperty:n,oldValue:r,newValue:i})},r.VideoDimensionsChangedEvent=function(e,t,n){return new a("videoDimensionsChanged",!1,{target:e,oldValue:t,newValue:n})},r.ArchiveEvent=function(e,t){return new a(e,!1,{id:t.id,name:t.name,status:t.status,archive:t})},r.ArchiveUpdatedEvent=function(e,t,n,r){return new a("updated",!1,{target:e,changedProperty:t,oldValue:n,newValue:r})},r.SignalEvent=function(e,t,n){return new a(e?"signal:"+e:s.SIGNAL,!1,{data:t,from:n})},r.CaptionReceivedEvent=function(e,t,n){return new a("caption",!1,{caption:e,streamId:t,isFinal:n})},r.PublisherCaptionsEnabled=function(e){return new a("publisherCaptionsEnabled",!1,{captionsEnabled:e})},r.StreamUpdatedEvent=function(e,t,n,r){return new a("updated",!1,{target:e,changedProperty:t,oldValue:n,newValue:r})},r.DestroyedEvent=function(e,t,n){return new a(e,!1,{target:t,reason:n})},r.ConnectionStateChangedEvent=function(e,t){return new a(e,!1,{target:t})},r.VideoEnabledChangedEvent=function(e,t){return new a(e,!1,{reason:t.reason})},r.VideoDisableWarningEvent=function(e){return new a(e,!1)},r.AudioLevelUpdatedEvent=function(e){return new a(s.AUDIO_LEVEL_UPDATED,!1,{audioLevel:e})},r.MediaStoppedEvent=function(e,t){return new a(s.MEDIA_STOPPED,!0,{target:e,track:t})},r.MuteForcedEvent=function(e){return new a(s.MUTE_FORCED,!1,e)},r.VideoElementCreatedEvent=function(e){return new a(s.VIDEO_ELEMENT_CREATED,!1,{element:e})},r}},function(e,t,n){var r=n(17),i=n(114);e.exports=function(e){return null!=e&&i(e.length)&&!r(e)}},function(e,t,n){"use strict";e.exports={ACTIVE:"active",INACTIVE:"inactive",UNKNOWN:"unknown",PER_SESSION:"perSession",PER_STREAM:"perStream",EXCEPTION:"exception",ISSUE_REPORTED:"issueReported",SESSION_CONNECTED:"sessionConnected",SESSION_RECONNECTING:"sessionReconnecting",SESSION_RECONNECTED:"sessionReconnected",SESSION_DISCONNECTED:"sessionDisconnected",STREAM_CREATED:"streamCreated",STREAM_DESTROYED:"streamDestroyed",CONNECTION_CREATED:"connectionCreated",CONNECTION_DESTROYED:"connectionDestroyed",SIGNAL:"signal",STREAM_PROPERTY_CHANGED:"streamPropertyChanged",MICROPHONE_LEVEL_CHANGED:"microphoneLevelChanged",RESIZE:"resize",SETTINGS_BUTTON_CLICK:"settingsButtonClick",DEVICE_INACTIVE:"deviceInactive",INVALID_DEVICE_NAME:"invalidDeviceName",ACCESS_ALLOWED:"accessAllowed",ACCESS_DENIED:"accessDenied",ACCESS_DIALOG_OPENED:"accessDialogOpened",ACCESS_DIALOG_CLOSED:"accessDialogClosed",ECHO_CANCELLATION_MODE_CHANGED:"echoCancellationModeChanged",MEDIA_STOPPED:"mediaStopped",PUBLISHER_DESTROYED:"destroyed",MUTE_FORCED:"muteForced",SUBSCRIBER_DESTROYED:"destroyed",SUBSCRIBER_CONNECTED:"connected",SUBSCRIBER_DISCONNECTED:"disconnected",SUBSCRIBER_CAPTION_RECEIVED:"captionReceived",DEVICES_DETECTED:"devicesDetected",DEVICES_SELECTED:"devicesSelected",CLOSE_BUTTON_CLICK:"closeButtonClick",MICLEVEL:"microphoneActivityLevel",MICGAINCHANGED:"microphoneGainChanged",ENV_LOADED:"envLoaded",ENV_UNLOADED:"envUnloaded",AUDIO_LEVEL_UPDATED:"audioLevelUpdated",VIDEO_ELEMENT_CREATED:"videoElementCreated"}},function(e,t,n){"use strict";var r=!0,i=!0;function o(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}e.exports={extractVersion:o,wrapPeerConnectionEvent:function(e,t,n){if(e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);var o=function(e){var t=n(e);t&&r(t)};return this._eventMap=this._eventMap||{},this._eventMap[r]=o,i.apply(this,[e,o])};var o=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[n])return o.apply(this,arguments);var r=this._eventMap[n];return delete this._eventMap[n],o.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}},disableLog:function(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(r=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},disableWarnings:function(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(i=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},log:function(){if("object"==typeof window){if(r)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},deprecated:function(e,t){i&&console.warn(e+" is deprecated, please use "+t+" instead.")},detectBrowser:function(e){var t=e&&e.navigator,n={browser:null,version:null};if(void 0===e||!e.navigator)return n.browser="Not a browser.",n;if(t.mozGetUserMedia)n.browser="firefox",n.version=o(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia)n.browser="chrome",n.version=o(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))n.browser="edge",n.version=o(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return n.browser="Not a supported browser.",n;n.browser="safari",n.version=o(t.userAgent,/AppleWebKit\/(\d+)\./,1)}return n}}},function(e,t,n){"use strict";function r(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const o=n(9),a=n(61),s=n(273),c=n(129),u=n(274),d=n(0)("SDPHelpers"),l={getSections:e=>e.split(/\r\n|\r|\n/).reduce((e,t)=>{const n=t.match(/^m=(\w+) \d+/);return n&&(e.sections[e.section=n[1]]=[]),e.sections[e.section].push(t),e},{sections:{header:[]},section:"header"}).sections,getCodecsFromSection:e=>({codecs:e[0].match(/m=\w+ \d+ [A-Z/]+ ([\d ]+)$/)[1].split(" "),codecMap:o(...e.filter(e=>e.match(/^a=rtpmap:\d+/)).map(e=>e.match(/^a=rtpmap:(\d+) ([\w-]+)/).splice(1)).map(e=>({[e[0]]:e[1]})))}),getCodecsAndCodecMap(e,t){const n=l.getSections(e)[t];if(!n)throw new Error("no mediaType "+t);return l.getCodecsFromSection(n)},getCodecs(e,t){const n=l.getCodecsAndCodecMap(e,t);return n.codecs.map(e=>n.codecMap[e]||"Unknown codec")},mediaDirections:{INACTIVE:"inactive",RECVONLY:"recvonly",SENDONLY:"sendonly",SENDRECV:"sendrecv"}};e.exports=l,l.getMLineIndex=function(e,t){const n="m="+t;return s(e,e=>-1!==e.indexOf(n))},l.getMLine=function(e,t){const n=l.getMLineIndex(e,t);return n>-1?e[n]:void 0},l.hasMediaType=(e,t)=>{const n=new RegExp("^m="+t),r=e.split("\r\n");return s(r,e=>n.test(e))>=0},l.hasMLinePayloadType=function(e,t,n){const r=l.getMLine(e,t);return l.getMLinePayloadTypes(r,t).indexOf(n)>-1},l.getMLinePayloadTypes=function(e,t){const n=new RegExp(`^m=${t} \\d+(/\\d+)? [a-zA-Z0-9/]+(( [a-zA-Z0-9/]+)+)$`,"i"),r=e.match(n);return!r||r.length<2?[]:r[2].trim().split(" ")},l.splitSections=function(e){return e.split("\nm=").map((e,t)=>(t>0?"m="+e:e).trim()+"\r\n")},l.changeMediaDirection=function(e,t){const n=l.splitSections(e);let r=n.shift();return n.forEach(e=>{const n=e.includes("m=video")?(e=>{const n=t===l.mediaDirections.RECVONLY?"a=inactive":"a=recvonly",r=new RegExp(n,"g");return e.replace(r,"a="+t)})(e):e;r+=n}),r},l.removeTypesFromMLine=function(e,t){const n=/[0-9 ]*$/.exec(e)[0],r=n.split(" ").filter(e=>""!==e&&-1===t.indexOf(e));return e.replace(n," "+r.join(" "))},l.removeMediaEncoding=function(e,t,n){let r,i,o,a,s=e.split("\r\n");const c=l.getMLineIndex(s,t),u=c>-1?s[c]:void 0,d=[];if(-1===c)return s.join("\r\n");if(r=l.getMLinePayloadTypes(u,t),0===r.length)return s.join("\r\n");for(i=c;i<s.length;i++){const e=new RegExp(n,"i");0===s[i].indexOf("a=rtpmap:")&&(a=s[i].split(" "),2===a.length&&e.test(a[1])&&d.push(a[0].substr(9)))}if(!d.length)return s.join("\r\n");for(i=c;i<s.length;i++)if(0===s[i].indexOf("a=fmtp:"))for(a=s[i].split(" "),o=0;o<d.length;o++)2===a.length&&a[1]==="apt="+d[o]&&d.push(a[0].substr(7));return s=s.filter(e=>{for(let t=0;t<d.length;t++)if(0===e.indexOf(`a=rtpmap:${d[t]} `)||0===e.indexOf(`a=fmtp:${d[t]} `)||0===e.indexOf(`a=rtcp-fb:${d[t]} `))return!1;return!0}),d.length>0&&c>-1&&(s[c]=l.removeTypesFromMLine(u,d)),s.join("\r\n")},l.disableMediaType=function(e,t){const n=e.split("\r\n"),r=[];let i;n.forEach(e=>{let t=e;/^m=/.test(t)&&(i=void 0),i||(i=[],r.push(i)),i.push(t)});const o=new RegExp(`^m=${t} \\d+ ([^ ]+) [0-9 ]+$`),a=r.map(e=>{const n=e[0].match(o);return n?[`m=${t} 0 ${n[1]} 0`,"a=inactive",...e.filter(e=>/^c=/.test(e)||/^a=mid:/.test(e)||""===e)]:e});return[].concat(...a).join("\r\n")},l.removeVideoCodec=function(e,t){return l.removeMediaEncoding(e,"video",t)};const f=function(e,t){let n=t.filterByName("ssrc-group:FID");switch(n=0===n.length?[]:n[0].value.split(" "),n.length){case 0:case 1:var r=t.find(e=>0===e.name.indexOf("rtpmap:")&&e.value.indexOf("rtx/90000")>-1);if(!r)return!1;var i=r.name.split(":")[1];return i.indexOf("/")>-1&&(i=i.split("/")[0]),l.hasMLinePayloadType(e,"video",i);default:return d.debug("SDP Helpers: There are more than two FIDs, RTX is definitely enabled"),!0}};l.getAttributesForMediaType=function(e,t){let n,r,i,o,s,c,u,d,p,h;const m=l.getMLineIndex(e,t),g=new RegExp(`m=(?!${t}).+ `,"i"),v=new RegExp("a=ssrc:\\d+ .*","i"),y=new RegExp("a=ssrc-group:(SIM|FID) (\\d+).*?","i"),b=new RegExp("a=([a-z0-9:/-]+) (.*)","i"),S=[];for(let t=m+1;t<e.length;t++){if(g.test(e[t])){void 0!==n&&(r=t-1);break}s=e[t].match(y),c=e[t].match(v),void 0===n&&(s||c)&&(n=t,s&&(o=/^(FID|SIM)$/.test(s[1])?s[2]:s[1])),u=e[t].match(`a=ssrc:${o} msid:(.+)`),u&&(d=u[1]);const a=v.test(e[t]),l=y.test(e[t]);void 0!==n&&(void 0!==r||a||l?t===e.length-1&&(r=t):r=t-1);const f=e[t].match(/a=mid:(.+)/);f&&(p=f[1],h=t),i=b.exec(e[t]),i&&3===i.length&&S.push({lineIndex:t,name:i[1],value:i[2]})}return S.ssrcStartIndex=n,S.ssrcEndIndex=r,S.msid=d,S.mid=p,S.midIndex=h,S.isUsingRTX=f.bind(null,e,S),S.filterByName=function(e){return this.filter(t=>t.name===e)},S.getRtpNumber=e=>{const t=new RegExp("rtpmap:(.+)");return a(S.map(n=>{const r=n.name.match(t);return r&&n.value.indexOf(e)>=0?r[1]:null}),e=>null!==e)},S},l.modifyDtx=(e,t)=>{const n=e.split("\r\n");if(!l.getMLine(n,"audio"))return d.debug("No audio m-line, not enabling dtx."),e;const r=l.getAttributesForMediaType(n,"audio"),i=r.getRtpNumber("opus");if(!i)return d.debug("Could not find rtp number for opus, not enabling dtx."),e;const o=r.find(e=>e.name==="fmtp:"+i);if(!o)return d.debug("Could not find a=fmtp line for opus, not enabling dtx."),e;let a=n[o.lineIndex];const s=/usedtx=\d+([\s;]*)/;return s.test(o.value)?a=a.replace(s,t?"usedtx=1$1":""):t&&(a+="; usedtx=1"),a=a.replace(/[;\s]*$/,""),n[o.lineIndex]=a,n.join("\r\n")};const p=(e,t,n)=>{const r=t.split("\r\n");if(!l.getMLine(r,"audio"))return d.debug("No audio m-line, not enabling stereo."),t;const i=l.getAttributesForMediaType(r,"audio"),o=i.getRtpNumber("opus");if(!o)return d.debug("Could not find rtp number for opus, not enabling stereo."),t;const a=i.find(e=>e.name==="fmtp:"+o);if(!a)return d.debug("Could not find a=fmtp line for opus, not enabling stereo."),t;let s,c=r[a.lineIndex];switch(e){case"send":s=/sprop-stereo=\d+([\s;]*)/,s.test(a.value)?c=c.replace(s,n?"sprop-stereo=1$1":""):n&&(c+="; sprop-stereo=1");break;case"receive":s=/([^-])stereo=\d+([\s;]*)/,s.test(a.value)?c=c.replace(s,n?"$1stereo=1$2":"$1"):n&&(c+="; stereo=1");break;default:throw new Error(`Invalid type ${e} passed into enableStereo`)}return c=c.replace(/[;\s]*$/,""),r[a.lineIndex]=c,r.join("\r\n")};l.modifySendStereo=p.bind(null,"send"),l.modifyReceiveStereo=p.bind(null,"receive"),l.setAudioBitrate=(e,t)=>{const n=l.getAudioBitrate(e);if(void 0!==n)return d.debug(`Audio bitrate already set to ${n}, not setting audio bitrate`),e;const r=e.split("\r\n");if(!l.getMLine(r,"audio"))return d.debug("No audio m-line, not setting audio bitrate"),e;const i=l.getAttributesForMediaType(r,"audio"),o=i.getRtpNumber("opus");if(!o)return d.debug("Could not find rtp number for opus, not setting audio bitrate."),e;const a=i.find(e=>e.name==="fmtp:"+o);if(!a)return d.debug("Could not find a=fmtp line for opus, not setting audio bitrate."),e;let s=r[a.lineIndex];return s+="; maxaveragebitrate="+t,s=s.replace(/[;\s]*$/,""),r[a.lineIndex]=s,r.join("\r\n")},l.removeVideoOrientation=e=>{let t=e.split("\r\n");return t=t.filter(e=>!e.includes("urn:3gpp:video-orientation")),t.join("\r\n")},l.hasSendStereo=e=>/[\s;]sprop-stereo=1/.test(e),l.hasSendDtx=e=>/[\s;]usedtx=1/.test(e),l.getAudioBitrate=e=>{const t=e.match(/[\s;]maxaveragebitrate=(\d+)/);if(t)return Number(t[1])},l.MAX_SSRCS=10,l.getSSRCGroupType=e=>["SIM","FID"].find(t=>e.filterByName("ssrc-group:"+t)[0]),l.getSSRCGroup=e=>{const t=l.getSSRCGroupType(e);return e.filterByName("ssrc-group:"+t)[0]},l.getSSRCGroupSSRCs=e=>{const t=l.getSSRCGroup(e);return t?t.value.split(" ").slice(0,l.MAX_SSRCS):[]},l.getAllowedSSRCs=(e,t)=>{const n=t.slice();return e.filterByName("ssrc-group:FID").forEach(e=>{const t=e.value.split(" ");c(n,t).length&&Array.prototype.push.apply(n,t)}),u(n)},l.filterExcessSSRCs=e=>{const t=e.split("\r\n"),n=l.getAttributesForMediaType(t,"video"),r=l.getSSRCGroupType(n),i=n.ssrcStartIndex;if(void 0===i)return e;let o;const a=e=>{let t=null;return e.match(/^a=ssrc:(\d+)/)&&(t=RegExp.$1),t};if(r){const e=l.getSSRCGroupSSRCs(n),i=["a=ssrc-group:"+r,...e].join(" ");t[n.find(e=>e.name.startsWith("ssrc-group:")).lineIndex]=i,o=l.getAllowedSSRCs(n,e)}else o=[],n.ssrcStartIndex&&o.push(a(t[n.ssrcStartIndex]));return t.filter((e,t)=>{if(t<i||t>n.ssrcEndIndex)return!0;if(t===i){if(!r){const t=a(e);return t?o.includes(t):!/^a=ssrc:(\d+)/.test(e)}return!0}const s=a(e);if(s)return o.includes(s);if(e.match(/^a=ssrc-group:FID (\d+)/)){const e=RegExp.$1;return o.includes(e)}return!e.match(/^a=ssrc-group:SIM /)}).join("\r\n")},l.enableSimulcast=function(e,t){let n,r;const i=e.split("\r\n");if(!l.getMLine(i,"video"))return d.debug("No video m-line, not enabling simulcast."),e;const o=l.getAttributesForMediaType(i,"video");if(o.filterByName("ssrc-group:SIM").length>0)return d.debug("Simulcast is already enabled in this SDP, not attempting to enable again."),l.filterExcessSSRCs(e);if(!o.msid)return d.debug("No local stream attached, not enabling simulcast."),e;const a=o.isUsingRTX(),s=[],c=[];for(r=0;r<t;++r)s.push(1e4+r),a&&c.push(2e4+r);if(n=["a=ssrc-group:SIM "+s.join(" ")],a)for(r=0;r<t;++r)n.push(`a=ssrc-group:FID ${s[r]} ${c[r]}`);for(r=0;r<t;++r)n.push(`a=ssrc:${s[r]} cname:localCname`,`a=ssrc:${s[r]} msid:${o.msid}`);if(a)for(r=0;r<t;++r)n.push(`a=ssrc:${c[r]} cname:localCname`,`a=ssrc:${c[r]} msid:${o.msid}`);return n.unshift(o.ssrcStartIndex,o.ssrcEndIndex-o.ssrcStartIndex+1),i.splice(...n),i.join("\r\n")},l.reprioritizeVideoCodec=function(e,t,n){const r=e.split("\r\n"),i=l.getMLineIndex(r,"video");if(-1===i)return e;const o=l.getMLinePayloadTypes(r[i],"video"),a=new RegExp("^a=rtpmap:(\\d+).* "+t,"i"),s=r.map(e=>e.match(a)).filter(e=>null!==e);if(0===s.length)return e;const c=s.map(e=>e[1]);let u=o.filter(e=>-1===c.indexOf(e));"top"===n?u.unshift(...c):"bottom"===n?u.push(...c):(d.error(`Unexpected location param: ${n}; not changing ${t} priority`),u=o);const f=r[i].replace(o.join(" "),u.join(" "));return r[i]=f,r.join("\r\n")},l.getSetupRole=e=>{for(var t,n=r(e.split(/\r\n|\r|\n/));!(t=n()).done;){const e=t.value.match(/^a=setup:(\w+)/);if(e)return e[1]}return""},l.setSetupRole=(e,t)=>e.split(/\r\n|\r|\n/).map(e=>e.match(/^a=setup:(\w+)/)?"a=setup:"+t:e).join("\r\n"),l.changeSetupRole=(e,t,n)=>e.map(e=>e.includes("a=setup:"+t)?"a=setup:"+n:e),l.patterns={bundle:"a=group:BUNDLE",address:"c=IN IP4",rtcp:"a=rtcp:",direction:["a=inactive","a=sendonly","a=recvonly","a=sendrecv"],rsize:"a=rtcp-rsize",ssrc:"a=ssrc:",msid:"a=msid:"},l.getIndexStartingWith=(e,t,n)=>{const r=e.slice(n),i=t.map(e=>r.findIndex(t=>t.includes(e))).filter(e=>e>-1);return i.length?n+Math.min(...i):e.length},l.getLastIndexPriorTo=(e,t,n)=>e.slice(0,n).map(e=>e.includes(t)).lastIndexOf(!0),l.includesAny=(e,t)=>{for(let n=0;n<t.length;n++)if(e.includes(t[n]))return!0;return!1},l.isVersionLine=e=>/^o=/.test(e),l.getVersionLine=e=>e.find(l.isVersionLine),l.getVersion=e=>{const t=l.getVersionLine(e);if(void 0===t)return;const n=Number(t.match(/ (\d+) IN /)[1]);return Number.isInteger(n)?n:void 0},l.updateVersion=(e,t,n)=>{const r=[...e],i=r.findIndex(e=>l.isVersionLine(e));return r[i]=r[i].replace(` ${t} `,` ${n} `),r},l.isBundleLine=e=>e.includes(l.patterns.bundle),l.getBundleLine=e=>e.find(l.isBundleLine),l.createBundleLine=e=>`${l.patterns.bundle} ${e.join(" ")}`,l.updateBundleLine=(e,t)=>{const n=[...e],r=l.createBundleLine(t),i=n.findIndex(e=>l.isBundleLine(e));return n[i]=r,n},l.parseMLine=e=>{const t=e.match(/^(m=(?:audio|video)) (\d+) (.+)/),n=t[1];return{port:t[2],transport:t[3],mediaType:n}},l.disableTrack=e=>{const t=l.parseMLine(e);return`${t.mediaType} 0 ${t.transport}`},l.setMediaDirection=(e,t)=>{if(!Object.values(l.mediaDirections).includes(t))return e;const n=e.slice(),r=n.findIndex(e=>l.includesAny(e,l.patterns.direction));return-1===r||(n[r]="a="+t),n},l.disableTrackSection=e=>{const t=e.mid,n=e.sdp;let r=n.filter(e=>{const t=l.patterns,n=t.address,r=t.rtcp,i=t.rsize,o=t.ssrc,a=t.msid;return!l.includesAny(e,[n,r,i,o,a])});return r[0]=l.disableTrack(n[0]),r=l.setMediaDirection(r,l.mediaDirections.INACTIVE),{mid:t,sdp:r}},l.getEnabledTracks=e=>l.getBundleLine(e).match(new RegExp(`^${l.patterns.bundle} (.+)$`))[1].split(" "),l.getDisabledTracks=(e,t)=>e.filter(e=>!t.includes(e)),l.getTrackSection=(e,t)=>{const n=e.findIndex(e=>e.includes("a=mid:"+t)),r=t.includes("a")?"audio":"video",i=l.getLastIndexPriorTo(e,"m="+r,n),o=l.getIndexStartingWith(e,["m=audio","m=video"],n),a=e.slice(i,o);return{mid:t,sdp:a}},l.getHeaders=e=>{const t=e.findIndex(e=>e.includes("m=audio")||e.includes("m=video"));return e.slice(0,t)},l.disableTracks=(e,t)=>e.map(e=>t.includes(e.mid)?l.disableTrackSection(e):e),l.getSDPLines=e=>e.split("\r\n").filter(e=>e),l.getTrackMids=e=>e.filter(e=>e.match(new RegExp("^a=mid:\\d+"))).map(e=>e.substring("a=mid:".length)),l.getTrackSections=e=>l.getTrackMids(e).map(t=>l.getTrackSection(e,t)),l.parseMantisSDP=e=>{const t=l.getSDPLines(e),n=l.changeSetupRole(t,"actpass","passive");return l.parseSDP(n)},l.parseSDP=e=>{const t=Array.isArray(e)?e:l.getSDPLines(e);return{bundle:l.getBundleLine(t),headers:l.getHeaders(t),version:l.getVersion(t),tracks:l.getEnabledTracks(t),trackSections:l.getTrackSections(t)}},l.createSDP=(e,t)=>{const n=[...e];return t.forEach(e=>n.push(...e.sdp)),n.push(""),n.join("\r\n")},l.removePayloadTypeFromSection=(e,t)=>e.filter(e=>!e.includes(`a=rtpmap:${t} `)&&!e.includes(`a=fmtp:${t} `)&&!e.includes(`a=rtcp-fb:${t} `)),l.getRtxPayloadType=(e,t)=>{const n=e.filter(e=>e.includes("apt="+t))[0];return null==n?void 0:n.match(/^a=fmtp:(\d+) /)[1]},l.removeRtxPayloadTypeFromSection=(e,t)=>{let n=[...e];const r=l.getRtxPayloadType(n,t);return r&&(n=l.removePayloadTypeFromSection(n,r)),n},l.trimUnusedCodecs=(e,t)=>{const n=e[0].split(" "),r=n.slice(3),i=n.slice(0,3),o=l.getCodecsFromSection(e);let a=[...e],s=[];r.forEach(e=>{const n=o.codecMap[e];if(t.includes(n)){s.push(e);const t=l.getRtxPayloadType(a,e);t&&s.push(t)}else a=l.removePayloadTypeFromSection(a,e),a=l.removeRtxPayloadTypeFromSection(a,e)});const c=s.length?s:[0];return a[0]=[...i,...c].join(" "),a},l.removeUnusedCodecs=(e,t)=>{if(!t)return e;const n=l.parseSDP(e),r=n.headers,i=n.trackSections,o=l.parseSDP(t).trackSections,a=i.map(e=>{const t=e.mid,n=e.sdp,r=o.find(e=>e.mid===t);if(!r)return n;const i=Object.values(l.getCodecsFromSection(r.sdp).codecMap);return l.trimUnusedCodecs(n,i)}),s=[...r];return a.forEach(e=>s.push(...e)),s.push(""),s.join("\r\n")},l.updateSDPWithNewOffer=(e,t)=>{const n=e.headers,r=e.version,i=e.tracks,o=e.trackSections,a=l.getSDPLines(t),s={};s.version=l.getVersion(a),s.headers=l.updateVersion(n,r,s.version),s.tracks=l.getEnabledTracks(a);const c=l.getDisabledTracks(i,s.tracks);return s.headers=l.updateBundleLine(s.headers,s.tracks),s.trackSections=l.disableTracks(o,c),s}},function(e,t,n){"use strict";t.__esModule=!0,t.MEDIUM=t.LOW=t.CongestionLevels=t.CRITICAL=void 0,t.CRITICAL=2,t.MEDIUM=1,t.LOW=0;const r={CRITICAL:2,MEDIUM:1,LOW:0};t.CongestionLevels=r},function(e,t,n){var r=n(40),i=n(368),o=n(369),a=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?i(e):o(e)}},function(e,t,n){var r=n(178),i=n(116),o=n(25);e.exports=function(e){return o(e)?r(e):i(e)}},function(e,t,n){"use strict";var r=n(44);e.exports=function(e){if(!r(e))throw new TypeError("Cannot use null or undefined");return e}},function(e,t,n){"use strict";var r=n(56),i=n(199),o=n(127),a=n(200),s=n(201);(e.exports=function(e,t){var n,i,c,u,d;return arguments.length<2||"string"!=typeof e?(u=t,t=e,e=null):u=arguments[2],r(e)?(n=s.call(e,"c"),i=s.call(e,"e"),c=s.call(e,"w")):(n=c=!0,i=!1),d={value:t,configurable:n,enumerable:i,writable:c},u?o(a(u),d):d}).gs=function(e,t,n){var c,u,d,l;return"string"!=typeof e?(d=n,n=t,t=e,e=null):d=arguments[3],r(t)?i(t)?r(n)?i(n)||(d=n,n=void 0):n=void 0:(d=t,t=n=void 0):t=void 0,r(e)?(c=s.call(e,"c"),u=s.call(e,"e")):(c=!0,u=!1),l={get:t,set:n,configurable:c,enumerable:u},d?o(a(d),l):l}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}},function(e,t,n){"use strict";(function(t){var r=n(1)(n(46));const i=n(207),o=n(57),a=n(487),s=n(534),c=n(0)("StaticConfig"),u=n(101).prependProxyToUrlIfNeeded,d=o({version:"v2.25.4",buildHash:"3ebf43adb",minimumVersion:{firefox:52,chrome:49},debug:!1,websiteURL:"http://www.tokbox.com",configURL:"https://config.opentok.com",ipWhitelistConfigURL:"",cdnURL:"https://static.opentok.com",loggingURL:"https://hlg.tokbox.com/prod",apiURL:"https://anvil.opentok.com"}),l=a(["apiURL","assetURL","cdnURL","sessionInfoOverrides","loggingURL"]),f={apiUrl:"apiURL",loggingUrl:"loggingURL"},p=s(e=>f[e]);e.exports=function(e){let n=(void 0===e?{}:e).axios,a=void 0===n?i:n;return function(){function e(e){Object.defineProperty(this,"config",{value:Object.freeze(o(e))})}return e.onlyLocal=function(){const t=o((void 0!==typeof window?window:global).OTProperties);return new e(Object.assign({},d,l(t)))},e.get=function(n){let r=n.partnerId,i=n.token,s=n.useIpWhitelistConfigUrl,f=n.proxyUrl;return(()=>{const e=this.onlyLocal();if(!e.configUrl)return t.resolve({});if(!0===s&&!e.ipWhitelistConfigUrl)return t.resolve({});let n=!0===s?e.ipWhitelistConfigUrl:e.configUrl;return n=u(n,f),a.get(`${n}/project/${r}/config.json`,{headers:{"X-TB-TOKEN-AUTH":i}}).then(e=>e.data)})().catch(e=>(c.error("could not reach live config service",e),{})).then(t=>{const n=o((void 0!==typeof window?window:global).OTProperties);return new e(Object.assign({},d,l(n),p(t)))})},(0,r.default)(e,[{key:"configUrl",get:function(){return this.config.configURL}},{key:"ipWhitelistConfigUrl",get:function(){return this.config.ipWhitelistConfigURL}},{key:"apiUrl",get:function(){return this.config.apiURL}},{key:"loggingUrl",get:function(){return this.config.loggingURL}},{key:"apiEnabled",get:function(){return void 0===this.config.apiEnabled||this.config.apiEnabled}},{key:"version",get:function(){return this.config.version}},{key:"clientVersion",get:function(){return"js-"+(this.version||"unknown").replace("v","")}},{key:"buildHash",get:function(){return this.config.buildHash}},{key:"minimumVersion",get:function(){return this.config.minimumVersion}},{key:"websiteUrl",get:function(){return this.config.websiteURL}},{key:"debug",get:function(){return"true"===this.config.debug||!0===this.config.debug}},{key:"sessionInfoOverrides",get:function(){return this.config.sessionInfoOverrides}},{key:"cdnUrl",get:function(){return this.config.cdnURL||`${(void 0!==typeof window?window:global).location.protocol}//${(void 0!==typeof window?window:global).location.host}`}},{key:"assetUrl",get:function(){return this.config.assetURL||`${this.cdnUrl}/webrtc/${this.version}`}}]),e}()}}).call(this,n(2))},function(e,t,n){var r=n(513),i=n(519),o=n(89),a=n(12),s=n(524);e.exports=function(e){return"function"==typeof e?e:null==e?o:"object"==typeof e?a(e)?i(e[0],e[1]):r(e):s(e)}},function(e,t,n){"use strict";const r=n(8);e.exports=function(e,t){let n;const i=t||{};e.setDisplayMode=function(e){const t=e||"auto";n!==t&&(r.removeClass(this.domElement,"OT_mode-"+n),r.addClass(this.domElement,"OT_mode-"+t),n=t)},e.getDisplayMode=function(){return n},e.showAfterLoading=function(){r.removeClass(this.domElement,"OT_hide-forced")},e.hideWhileLoading=function(){r.addClass(this.domElement,"OT_hide-forced")},e.destroy=function(){return i.onDestroy&&i.onDestroy(this.domElement),this.domElement&&r.removeElement(this.domElement),e},e.appendTo=function(t){return this.domElement=r.createElement(i.nodeName||"div",i.htmlAttributes,i.htmlContent),i.onCreate&&i.onCreate(this.domElement),e.setDisplayMode(i.mode),"auto"===i.mode&&(r.addClass(e.domElement,"OT_mode-on-hold"),setTimeout(()=>{r.removeClass(e.domElement,"OT_mode-on-hold")},2e3)),t.appendChild(this.domElement),e}}},function(e,t,n){var r=n(78);e.exports=function(e){return r(e,4)}},function(e,t,n){var r=n(367),i=n(372);e.exports=function(e,t){var n=i(e,t);return r(n)?n:void 0}},function(e,t,n){var r=n(15).Symbol;e.exports=r},function(e,t,n){var r=n(84),i=n(63);e.exports=function(e,t,n,o){var a=!n;n||(n={});for(var s=-1,c=t.length;++s<c;){var u=t[s],d=o?o(n[u],e[u],u,n,e):void 0;void 0===d&&(d=e[u]),a?i(n,u,d):r(n,u,d)}return n}},function(e,t,n){var r=n(396),i=n(111),o=n(397),a=n(186),s=n(187),c=n(30),u=n(175),d=u(r),l=u(i),f=u(o),p=u(a),h=u(s),m=c;(r&&"[object DataView]"!=m(new r(new ArrayBuffer(1)))||i&&"[object Map]"!=m(new i)||o&&"[object Promise]"!=m(o.resolve())||a&&"[object Set]"!=m(new a)||s&&"[object WeakMap]"!=m(new s))&&(m=function(e){var t=c(e),n="[object Object]"==t?e.constructor:void 0,r=n?u(n):"";if(r)switch(r){case d:return"[object DataView]";case l:return"[object Map]";case f:return"[object Promise]";case p:return"[object Set]";case h:return"[object WeakMap]"}return t}),e.exports=m},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var c,u=[],d=!1,l=-1;function f(){d&&c&&(d=!1,c.length?u=c.concat(u):l=-1,u.length&&p())}function p(){if(!d){var e=s(f);d=!0;for(var t=u.length;t;){for(c=u,u=[];++l<t;)c&&c[l].run();l=-1,t=u.length}c=null,d=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new h(e,t)),1!==u.length||d||s(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){"use strict";var r=n(415)();e.exports=function(e){return e!==r&&null!==e}},function(e,t,n){"use strict";e.exports=n(429)()?n(92).Symbol:n(432)},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t,n){var r=n(70);e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},function(e,t,n){var r=n(531),i=n(140)((function(e,t){return null==e?{}:r(e,t)}));e.exports=i},function(e,t){e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}},function(e,t,n){"use strict";const r=(void 0!==typeof window?window:global).performance||{};e.exports=function(){return r.now?r.timing.navigationStart+r.now():Date.now()}},function(e,t,n){var r=n(597);e.exports=function(e){return r(2,e)}},function(e,t,n){"use strict";const r=n(51),i=n(35)();t.check=function(e){void 0===e&&(e={});const t=e.env||n(3),r=e.hasGetUserMediaCapability||n(605),o=e.hasPeerConnectionCapability||n(606),a=e.logging||n(0)("hasOpenTokSupport"),s=((e.staticConfig||i.onlyLocal()).minimumVersion||{})[t.name.toLowerCase()];return s&&s>t.version?(a.debug("Support for",t.name,"is disabled because we require",s,"but this is",t.version),!1):"Node"===t.name||r()&&o()},t.once=r(()=>t.check())},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,n){var r=n(178),i=n(391),o=n(25);e.exports=function(e){return o(e)?r(e,!0):i(e)}},function(e,t){e.exports=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},function(e,t,n){"use strict";e.exports=function(e){return null!=e}},function(e,t,n){var r=n(78);e.exports=function(e){return r(e,5)}},function(e,t,n){var r=n(99);e.exports=function(e,t,n){var i=null==e?void 0:r(e,t);return void 0===i?n:i}},function(e,t,n){var r=n(12),i=n(139),o=n(236),a=n(60);e.exports=function(e,t){return r(e)?e:i(e,t)?[e]:o(a(e))}},function(e,t,n){var r=n(521);e.exports=function(e){return null==e?"":r(e)}},function(e,t,n){var r=n(620)(n(273));e.exports=r},function(e,t,n){"use strict";e.exports=function(e){const t=[];return{on(n,r){for(var i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];if(t.push({eventName:n,handler:r,args:o}),e.on)e.on(n,r);else{if(!e.addEventListener)throw new Error("Object does not support events",e);e.addEventListener(n,r,...o)}},off(t,n){if(e.off)e.off(t,n);else{if(!e.removeEventListener)throw new Error("Object does not support events",e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];e.removeEventListener(t,n,...i)}},once(n,r){for(var i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];t.push({eventName:n,handler:r,args:o}),e.once(n,r)},removeAll(){t.forEach(e=>{let t=e.eventName,n=e.handler,r=e.args;this.off(t,n,...r)}),t.splice(0,t.length)}}}},function(e,t,n){var r=n(176);e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},function(e,t,n){var r=n(386),i=n(18),o=Object.prototype,a=o.hasOwnProperty,s=o.propertyIsEnumerable,c=r(function(){return arguments}())?r:function(e){return i(e)&&a.call(e,"callee")&&!s.call(e,"callee")};e.exports=c},function(e,t,n){(function(e){var r=n(15),i=n(387),o=t&&!t.nodeType&&t,a=o&&"object"==typeof e&&e&&!e.nodeType&&e,s=a&&a.exports===o?r.Buffer:void 0,c=(s?s.isBuffer:void 0)||i;e.exports=c}).call(this,n(85)(e))},function(e,t){var n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&n.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},function(e,t,n){"use strict";e.exports=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e}},function(e,t,n){var r=n(30),i=n(18);e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==r(e)}},function(e,t,n){"use strict";if("Node"===n(8).env.name)e.exports={value:""};else{var r,i;const t=null==(r=Array.prototype.slice.call(document.getElementsByTagName("script")))||null==(i=r.pop())?void 0:i.getAttribute("src"),n=(t&&t.match(/[?&]apikey=([^&]+)/i)||[])[1];e.exports={value:n||""}}},function(e,t,n){"use strict";(function(t){var r=n(1),i=r(n(4)),o=r(n(5));const a=n(154),s=n(50),c=n(9),u=n(57),d=n(129),l=n(272),f=n(16),p=n(6),h=n(250),m=n(155),g=n(28),v=n(73),y=n(623);e.exports=function(e){void 0===e&&(e={});const r=e.hasValidPeerConnection||n(624),b=e.applySdpTransform||n(156),S=e.createPeerConnection||n(625),E=e.env||n(3),_=e.sdpTransformDefaults||n(627),T=e.getStatsAdapter||n(275),R=e.getRtcStatsReportAdapter||n(278),I=e.getSynchronizationSources||n(631),w=e.IceCandidateProcessor||n(632),C=e.logging||n(0),O=e.offerProcessor||n(634),A=e.PeerConnectionChannels||n(636),x=e.subscribeProcessor||n(638),k=n(639),N=e.changeMediaDirection||n(641),L=N.changeMediaDirectionToInactive,M=N.changeMediaDirectionToRecvOnly,V=e.Qos||n(279).default,P=e.global||(void 0!==typeof window?window:global),D=e.debounce||n(645),Z=e.needsToSwapH264Profiles||n(647).once,j=e.NativeRTCIceCandidate||P.RTCIceCandidate,W=e.NativeRTCSessionDescription||P.RTCSessionDescription,G=e.Errors||n(7),F=e.OTErrorClass||n(23),U=e.ExceptionCodes||n(10),X=e.hasPictureInPictureBug||n(648),B=()=>{};return function(e){void 0===e&&(e={});let n=!1;const N=e,H=N.iceConfig,Y=void 0===H?{servers:[]}:H,J=N.sendMessage,z=N.isPublisher,K=N.offerOverrides,Q=N.answerOverrides,q=N.p2p,$=N.codecFlags,ee=N.sourceStreamId,te=N.keyStore,ne=N.sFrameClientStore,re=N.isE2ee,ie=N.removeUnusedCodecs;let oe,ae=e,se=ae.logAnalyticsEvent,ce=void 0===se?B:se,ue=ae.remoteConnectionId,de=!1;const le=Z();let fe,pe,he,me,ge=0,ve=!1;const ye=new k(ce),be=m();function Se(e,t){if(!n&&["candidate","offer","answer","pranswer"].indexOf(e)>-1){const r="candidate"===e?t.candidate:t.sdp;n=-1!==r.indexOf("typ relay")}J(e,t)}const Ee=s();ce("createPeerConnection","Attempt");const _e={};_e.id=f();const Te=C("PeerConnection:"+_e.id);Te.debug("construct",{id:_e.id,options:e});const Re=_,Ie=l(e,["isPublisher","logAnalyticsEvent","offerOverrides","answerOverrides","sendMessage"]);let we,Ce,Oe,Ae,xe,ke=[];const Ne=(()=>{let e=Ie.overrideSimulcastEnabled||!1;return{get:()=>e,set(t){const n=Boolean(t)&&Ie.capableSimulcastStreams>1;n!==e&&void 0===Ie.overrideSimulcastEnabled&&(e=n,_e.generateOfferAndSend())}}})(),Le=(()=>{let e=!1;return{get:()=>e,set(t){const n=Boolean(t);n!==e&&(e=n,e&&(_e.iceConnectionStateIsConnected()?Te.debug("iceRestart is going to wait until we disconnect or negotiationNeeded and then restart ice"):_e.generateOfferAndSend()))}}})(),Me={clean(){delete this.promise,delete this.resolve,delete this.reject}};Me.promise=new t((e,t)=>{Me.resolve=e,Me.reject=t});let Ve=new w,Pe="new";Object.defineProperty(_e,"signalingState",{get:()=>we.signalingState,set:e=>(we.signalingState=e,e)}),p(_e),_e.addOptions=e=>{ue=e.remoteConnectionId,ce=e.logAnalyticsEvent},_e.startEncryption=function(){var e=(0,o.default)(i.default.mark((function e(t){var n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(re){e.next=2;break}return e.abrupt("return");case 2:return he=y(t),e.next=5,ne.createSender(he);case 5:return pe=e.sent,e.next=8,te.get();case 8:return n=e.sent,e.next=11,pe.setSenderEncryptionKey(n);case 11:me=e=>{pe.setSenderEncryptionKey(e)},te.on("keyChanged",me),we.getTransceivers().forEach(e=>pe.encrypt(e.mid,e.sender));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_e.once("iceConnected",(0,o.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={pcc:parseInt(s()-Ee,10),hasRelayCandidates:n,proxyInfo:""},we&&we.proxyInfo&&(t.proxyInfo=we.proxyInfo),ce("createPeerConnection","Success",t);case 4:case"end":return e.stop()}}),e)})))),Me.resolve();const De=function(){var e=(0,o.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te.get();case 2:if(t=e.sent,he=y(ue),fe=ne.getReceiver(he),fe){e.next=14;break}return e.next=8,ne.createReceiver(he);case 8:fe=e.sent,fe.addReceiver(he),fe.setReceiverEncryptionKey(he,t),te.on("keyChanged",e=>{fe.setReceiverEncryptionKey(he,e)}),fe.addEventListener("decryptFailed",()=>{_e.trigger("decryptFailed")}),fe.addEventListener("decryptionRestored",()=>{_e.trigger("decryptRestored")});case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ze=e=>{if(Te.debug("internalCreatePeerConnection: called"),we)return Te.debug("internalCreatePeerConnection: resolving synchronously"),void e.call(null,null,we);if(ke.push(e),!(ke.length>1)){if(Te.debug(`Creating peer connection config "${JSON.stringify(Ie)}".`),0===Y.servers.length&&(Te.error("No ice servers present"),ce("Error","noIceServers")),"relay"===Y.transportPolicy){const e=e=>e&&0===e.indexOf("turn");Y.servers=Y.servers.map(t=>{const n=u(t);return Array.isArray(n.urls)||(n.urls=[n.urls]),n.urls=n.urls.filter(e),0===n.urls.length?void 0:n}).filter(e=>void 0!==e)}Ie.iceTransportPolicy=Y.transportPolicy,Ie.iceServers=Y.servers,re&&(Ie.forceEncodedVideoInsertableStreams=!0,Ie.forceEncodedAudioInsertableStreams=!0,Ie.encodedInsertableStreams=!0),r(P.RTCPeerConnection).then(e=>{if(!e)throw Te.error("createPeerConnection: Invalid RTCPeerConnection object"),new Error("Failed to create valid RTCPeerConnection object");return S({window:P,config:Ie})}).then(function(){var e=(0,o.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(z||!re){e.next=3;break}return e.next=3,De();case 3:je(null,t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e=>je(e))}},je=(e,t)=>{if(e)return Ye({reason:"Failed to create PeerConnection, exception: "+e,prefix:"NewPeerConnection"}),void(ke=[]);Te.debug("OT attachEventsToPeerConnection"),we=t,Ve&&Ve.setPeerConnection(t),Ce=new A(we),Ie.channels&&Ce.addMany(Ie.channels);const n=(e=>{let t=e.sendMessage,n=e.logging;const r={};return e=>{e.candidate?(r[e.candidate.sdpMid]=e.candidate.sdpMLineIndex,t("candidate",{candidate:e.candidate.candidate,sdpMid:e.candidate.sdpMid||"",sdpMLineIndex:e.candidate.sdpMLineIndex||0})):n.debug("IceCandidateForwarder: No more ICE candidates.")}})({sendMessage:Se,logging:Te}),r=e=>{var t;Me.resolve(),t=e.candidate,"relay"!==Y.transportPolicy||null==t||-1!==t.candidate.indexOf("typ relay")?n(e):Te.debug("Ignore candidate",e.candidate.candidate)},a=function(){var e=(0,o.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Xe(t),!z&&fe&&fe.decrypt(t.transceiver.mid,t.receiver);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();let s=we.iceConnectionState;const c=e=>{we?(Te.debug("iceconnectionstatechange",we.iceConnectionState),"connected"===we.iceConnectionState?("disconnected"===s&&_e.clearFailedTimeout(),_e.emit("iceConnected"),Le.set(!1)):"completed"===we.iceConnectionState&&E.isLegacyEdge&&setTimeout(()=>Ke.startCollecting(we),1e3)):Te.debug("iceconnectionstatechange on peerConnection that no longer exists",_e);const t=e.target.iceConnectionState;_e.trigger("iceConnectionStateChange",t),ce("attachEventsToPeerConnection","iceconnectionstatechange",t),"disconnected"===t&&(Le.get()?(Te.debug("Restarting ice!"),_e.generateOfferAndSend()):v()||(xe=setTimeout(()=>{ce("attachEventsToPeerConnection","iceconnectionstatechange","failed"),s="failed",_e.trigger("iceConnectionStateChange","failed")},1e4))),"disconnected"!==s&&"failed"===t&&Ye({reason:"The stream was unable to connect due to a network error. Make sure your connection isn't blocked by a firewall.",prefix:"ICEWorkflow"}),s=t},u=()=>{ce("peerConnection:negotiationNeeded","Event"),z&&_e.generateOfferAndSend(),_e.trigger("negotiationNeeded")};we.addEventListener("track",a),we.addEventListener("icecandidate",r),we.addEventListener("signalingstatechange",Fe),we.addEventListener("negotiationneeded",u),we.addEventListener("iceconnectionstatechange",c),be.add(()=>{we&&(we.removeEventListener("track",a),we.removeEventListener("icecandidate",r),we.removeEventListener("signalingstatechange",Fe),we.removeEventListener("negotiationneeded",u),we.removeEventListener("iceconnectionstatechange",c))}),We(null)},We=()=>{for(;ke.length;)ke.shift().call(null)},Ge=()=>{Ve&&(Ve.destroy(),Ve=null),ke=[],Ke.stopCollecting(),be.releaseAll(),Me.clean(),null!==we&&(we.destroy&&we.destroy(),we=null,_e.trigger("close")),_e.off()},Fe=e=>{const t=e.target.signalingState;if(_e.emit("signalingStateChange",t),"stable"===t&&_e.emit("signalingStateStable"),t&&t!==Pe)switch(Pe=t,Te.debug("stateChange: "+Pe),Pe){case"closed":Ge()}},Ue=()=>{let e;if(we.getRemoteStreams)e=we.getRemoteStreams();else{if(!we.remoteStreams)throw new Error("Invalid Peer Connection object implements no method for retrieving remote streams");e=we.remoteStreams}return Array.prototype.slice.call(e)},Xe=e=>{var t;const n=e.track,r=e.transceiver,i=e.stream||(null==(t=e.streams)?void 0:t[0]);ce("createPeerConnection","TrackAdded"),_e.trigger("trackAdded",{stream:i,track:n,transceiver:r})},Be=(e,t,n)=>{de=!1,Ye({reason:`PeerConnection.offerProcessor ${e}: ${t}`,prefix:n})},He=e=>{if(de)return void(oe=e);de=!0,ce("peerConnection:processOffer","Event");const t=new W({type:"offer",sdp:e.content.sdp}),n=e=>{de=!1,Ve&&Ve.process(),Se("answer",e),E.isLegacyEdge||Ke.startCollecting(we,z),oe&&(He(oe),oe=null)},r=e=>_e.trigger("remoteVideoSupported",e);Ze(()=>{O(we,P.RTCPeerConnection,P.RTCSessionDescription,W,Re,t,$,q,n,Be,r,le,ee)})};_e.generateOfferAndSend=()=>{_e.generateOffer(e=>{Te.debug("processSubscribe: sending offer"),Se("offer",e)})},_e.generateOfferAndAnswer=e=>{_e.generateOffer(t=>{e(t)})},_e.generateOffer=D((function(e){void 0===e&&(e=()=>{}),ye.enqueueOfferAnswer(()=>(e=>{var t,n;if("closed"===(null==(t=we)||null==(n=t.signalingState)?void 0:n.toLowerCase()))return;ce("peerConnection:processSubscribe","Event"),Te.debug("processSubscribe: Sending offer to subscriber.");let r=Ne.get()?Ie.capableSimulcastStreams:1;"P2P"===ee&&!q&&(r=1),Ze(()=>{x({peerConnection:we,NativeRTCSessionDescription:W,sdpTransforms:Re,numSimulcastStreams:r,removeVideoOrientation:X(),offerOverrides:K,offerConstraints:{iceRestart:Le.get()},replaceBaselineProfile:le,removeUnusedCodecs:ie}).then(t=>{Te.debug("processSubscribe: got offer, waiting for _readyToCompleteOffer"),Oe=t,Me.promise.then(()=>e(Oe))},e=>{Ye({reason:`subscribeProcessor ${e.message}: ${e.reason}`,prefix:e.prefix})}),Le.set(!1)})})(e))}),100);const Ye=e=>{let t=e.reason,n=e.prefix;Te.error(t,"in state",we?{connectionState:we.connectionState,iceConnectionState:we.iceConnectionState,iceGatheringState:we.iceGatheringState,signalingState:we.signalingState}:"(none)"),_e.trigger("error",{reason:t,prefix:n})};function Je(e){this.track=e}_e.addTrack=(e,n)=>{const r=new t((e,t)=>{Ze(n=>{if(n)return t(n);e()})}).then(()=>{if(we.addTrack)return we.addTrack(e,n);const t=we.getLocalStreams()[0];if(void 0===t)throw new Error("PeerConnection has no existing streams, cannot addTrack");t.addTrack(e),_e.generateOfferAndSend()}).then(()=>new t(e=>{_e.once("signalingStateStable",()=>{e()})}));return a(r,15e3,"Renegotiation timed out")},_e.setIceConfig=e=>{try{E.isFirefox&&(e.certificates=we.getConfiguration().certificates),we.setConfiguration(e)}catch(e){throw new h("A peer connection failed to set configuration with "+e.message,G.FAILED_SET_CONFIGURATION)}return Le.set(!0),we},_e.removeTrack=e=>{const n=t.resolve().then(()=>e instanceof Je?(we.getLocalStreams()[0].removeTrack(e.track),void _e.generateOfferAndSend()):we.removeTrack(e)).then(()=>new t(e=>{_e.once("signalingStateStable",()=>{e()})}));return a(n,15e3,"Renegotiation timed out")},_e.addLocalStream=e=>new t((t,n)=>{Ze(r=>{if(r)n(r);else{try{e.getTracks&&e.getTracks().forEach(t=>we.addTrack(t,e))}catch(e){return void n(e)}t()}})}),_e.getLocalStreams=()=>we.getLocalStreams(),_e.getSenders=()=>we.getSenders?we.getSenders():we.getLocalStreams()[0].getTracks().map(e=>new Je(e)),_e.disconnect=()=>{var e;Ve&&(Ve.destroy(),Ve=null),null!=(e=we)&&e.signalingState&&"closed"!==we.signalingState.toLowerCase()&&(we.close(),"function"==typeof me&&te.off("keyChanged",me),pe=null,he=null,setTimeout(Ge))},_e.iceRestart=()=>Le.set(!0),_e.clearFailedTimeout=()=>clearTimeout(xe);const ze=e=>{const n=e?L:M;return new t(e=>{ye.enqueueOfferAnswer((0,o.default)(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n(we);case 2:ye.setResolved(),e();case 4:case"end":return t.stop()}}),t)}))))})};_e.changeMediaDirectionToRecvOnly=()=>ze(!1),_e.changeMediaDirectionToInactive=()=>ze(!0),_e.processMessage=(e,t)=>{switch(Te.debug(`processMessage: Received ${e} from ${t.fromAddress}`,t),Te.debug(t),e){case"generateoffer":t.content&&void 0!==t.content.simulcastEnabled&&Ne.set(t.content.simulcastEnabled),_e.generateOfferAndSend(),r();break;case"offer":He(t),r();break;case"answer":case"pranswer":(e=>{ce("peerConnection:processAnswer","Event");const t=e=>{e.includes("Failed to parse SessionDescription. a=extmap-allow-mixed Expects at least 2 fields.")&&(e="SessionDescription issue has been fixed in Chrome 71 and above. Please update your browser."),Ye({reason:"Error while setting RemoteDescription "+e,prefix:"SetRemoteDescription"})};e.content.sdp?(Ae=new W({type:"answer",sdp:b(Re,"remote","answer",c({replaceBaselineProfile:le},Q),e.content.sdp).local}),we.setRemoteDescription(Ae).then(()=>{Te.debug("processAnswer: setRemoteDescription Success"),Ve&&Ve.process()}).catch(t),ye.setResolved(),E.isLegacyEdge||Ke.startCollecting(we,z)):t("Weird answer message, no SDP.")})(t);break;case"candidate":var n=new j(t.content);Ve&&Ve.addIceCandidate(n).catch(e=>{Te.warn(`Error while adding ICE candidate: ${JSON.stringify(n)}: ${e.toString()}`)});break;default:Te.debug(`processMessage: Received an unexpected message of type ${e} from ${t.fromAddress}: ${JSON.stringify(t)}`)}function r(){ge+=1,Ke.handleOfferMessageReceived(),ge>1&&(ce("Renegotiation","Attempt"),ve=!0)}return _e},_e.stopTransceivers=e=>{(e=>e.sort((e,t)=>e.mid<t.mid?1:e.mid>t.mid?-1:0))(we.getTransceivers().filter(t=>e.includes(t.mid))).forEach(e=>e.stop())},_e.remoteStreams=()=>we?Ue():[],_e.remoteTracks=()=>we?we.getReceivers?Array.prototype.slice.apply(we.getReceivers()).map(e=>e.track):Array.prototype.concat.apply([],Ue().map(e=>e.getTracks())):[],_e.remoteDescription=()=>we.remoteDescription,_e.getStats=e=>{if(we)T(we,e);else{const t=U.PEER_CONNECTION_NOT_CONNECTED;e(new h(F.getTitleByCode(t),G.PEER_CONNECTION_NOT_CONNECTED,{code:t}))}},_e.getRtcStatsReport=e=>{if(we)R(we,e);else{const t=U.PEER_CONNECTION_NOT_CONNECTED;e(new h(F.getTitleByCode(t),G.PEER_CONNECTION_NOT_CONNECTED,{code:t}))}},_e.getSynchronizationSources=e=>{if(!z){if(!we){const t=U.PEER_CONNECTION_NOT_CONNECTED;return void e(new h(F.getTitleByCode(t),G.PEER_CONNECTION_NOT_CONNECTED,{code:t}))}I(we,e)}},_e.getDataChannel=(e,t,n)=>{we?function e(t,n,r,i){let o;const a=Ce.get(n,r);if(!a){if(t>0)return void setTimeout(e.bind(null,t-1,n,r,i),200);o=new h(`A channel with that label and options could not be found. Label:${n}. Options: ${JSON.stringify(r)}`)}i(o,a)}(100,e,t,n):n(new h("Cannot create a DataChannel before there is a connection."))},_e.getSourceStreamId=()=>ee,_e.iceConnectionStateIsConnected=()=>we&&["connected","completed"].indexOf(we.iceConnectionState)>-1,_e.findAndReplaceTrack=(e,n)=>t.resolve().then(()=>{const r=we.getSenders().filter(t=>t.track===e)[0];if(!r)return t.resolve();if("function"!=typeof r.replaceTrack)throw new Error("Sender does not support replaceTrack");return r.replaceTrack(n)}),_e.hasRelayCandidates=()=>n,_e.getNegotiatedCodecs=()=>{if(!we.localDescription||!we.remoteDescription)return null;const e=e=>d(g.getCodecs(we.localDescription.sdp,e),g.getCodecs(we.remoteDescription.sdp,e));return{audio:e("audio"),video:e("video")}},_e.on("signalingStateStable",()=>{ve&&(ve=!1,ce("Renegotiation","Success",_e.getNegotiatedCodecs()))}),_e.on("error",e=>{let t=e.prefix;ve&&-1!==["CreateOffer","SetRemoteDescription"].indexOf(t)&&(ve=!1,ce("Renegotiation","Failure"))}),_e.on("close",()=>{ve&&(ve=!1,ce("Renegotiation","Cancel"))});const Ke=new V;return Ke.on("stats",e=>{e.dataChannels=Ce.sampleQos(),_e.trigger("qos",{parsedStats:e,simulcastEnabled:Ne.get()})}),_e}}}).call(this,n(2))},function(e,t,n){"use strict";const r=n(3);e.exports=()=>!((r.isChrome||r.isElectron)&&r.version>=90||r.isOpera&&r.version>=76)&&(r.isChrome&&r.version>71||r.isChromiumEdge&&r.version<90||r.isOpera&&r.version>58)},function(e,t,n){"use strict";e.exports=function(e,t,n){void 0===n&&(n=1/0);let r=null,i=!1,o=1;const a=1e3/t,s=()=>{!i||o>n||(o+=1,e(),r=setTimeout(s,a))};this.start=()=>{i||(i=!0,setTimeout(s,a))},this.stop=()=>{(void 0!==typeof window?window:global).clearTimeout(r),i=!1}}},function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r={ACTIVE_VIDEO:0,ACTIVE_VIDEO_WITH_WARNING:1,SUSPENDED_VIDEO:2};t.default=r},function(e,t,n){"use strict";const r=n(48),i=n(678),o=n(11),a=n(157),s={};function c(e){return Number(e.framerateMean||e.googFrameRateSent||e.googFrameRateReceived||e.googFrameRateInput||e.googFrameRateOutput||0)}function u(e){return Number(e.framesEncoded||e.framesDecoded)}function d(e,t){if(c(e))return c(e);if(!u(e))return;let n=0;const r=s[e.id]?s[e.id].frames:0,i=s[e.id]?s[e.id].timestamp:t;return n=a({currentStatFrames:u(e),currentTimestamp:e.timestamp,prevStatFrames:r,prevTimestamp:i}),s[e.id]={frames:u(e),timestamp:e.timestamp},n}function l(e,t){if(!t)return{};const n=t.filter(t=>t.id===e.mediaTrackId);return n.length?n[0]:{}}function f(e,t){return"packetsLost"in t?e+t.packetsLost:e}const p={isVideoStat(e,t){const n=l(e,t);return"video"===e.kind&&["outbound-rtp","inbound-rtp"].includes(e.type)||"video"===e.mediaType||"googFrameWidthReceived"in e||"googFrameWidthInput"in e||"inbound-rtp"===e.type&&-1!==e.id.indexOf("Video")||"inboundrtp"===e.type&&0!==n.frameWidth},isAudioStat(e,t){const n=l(e,t);return"audio"===e.kind&&["outbound-rtp","inbound-rtp"].includes(e.type)||"audio"===e.mediaType||"audioInputLevel"in e||"audioOutputLevel"in e||"inbound-rtp"===e.type&&-1!==e.id.indexOf("Audio")||"inboundrtp"===e.type&&0===n.frameWidth},isInboundStat:e=>"bytesReceived"in e||"packetsReceived"in e,isOutboundStat:e=>"bytesSent"in e||"packetsSent"in e,isVideoTrackStat:e=>"track"===e.type&&(e.frameHeight>0||e.frameWidth>0||e.framesCorrupted>0||e.framesDecoded>0||e.framesPerSecond>0||e.framesSent>0||e.framesReceived>0),isVideoRemoteInboundRtpStat:e=>"remote-inbound-rtp"===e.type&&"video"===e.kind,isAudioRemoteInboundRtpStat:e=>"remote-inbound-rtp"===e.type&&"audio"===e.kind,isVideoInboundRtpStat:e=>"inbound-rtp"===e.type&&"video"===e.kind,parseStatCategory(e){const t={packetsLost:0,packetsReceived:0,bytesReceived:0};return"packetsReceived"in e&&(t.packetsReceived=parseInt(e.packetsReceived,10)),"packetsLost"in e&&(t.packetsLost=parseInt(e.packetsLost,10)),"bytesReceived"in e&&(t.bytesReceived=parseInt(e.bytesReceived,10)),this.isVideoStat(e)&&("framerateMean"in e?t.frameRate=Number(e.framerateMean):"googFrameRateOutput"in e?t.frameRate=Number(e.googFrameRateOutput):"googFrameRateInput"in e&&(t.frameRate=Number(e.googFrameRateInput))),t},getVideoPacketsLost(e){return e.filter(t=>this.isVideoRemoteInboundRtpStat(t,e)).reduce(f,0)},getAudioPacketsLost(e){return e.filter(t=>this.isAudioRemoteInboundRtpStat(t,e)).reduce(f,0)},normalizeTimestamp:(e,t)=>(void 0===t&&(t=Date.now()),o(e)&&"getTime"in e?e.getTime():Math.abs(e/(1e3*t)-1)<.05?e/1e3:e),normalizeStats(e,t,n){void 0===t&&(t=!0);const o=e.filter(t=>p.isVideoStat(t,e)).filter(e=>p.isInboundStat(e)===t),a=e.filter(t=>this.isAudioStat(t,e)).filter(e=>this.isInboundStat(e)===t)[0],s=o[0];if(!a&&!s)throw new Error("could not find stats for either audio or video");const c=p.normalizeTimestamp(s?s.timestamp:a.timestamp),u={timestamp:c};s&&!t&&void 0===s.packetsLost&&(s.packetsLost=this.getVideoPacketsLost(e)),a&&!t&&void 0===a.packetsLost&&(a.packetsLost=this.getAudioPacketsLost(e));const l=["packetsSent","packetsLost","bytesSent"],f=t?e=>r(e,["packetsReceived","packetsLost","bytesReceived"]):e=>r(e,l);if(o&&o.length>0){const e=(e=>{const t=l.concat(["framerateMean","googFrameRateSent","googFrameRateReceived","googFrameRateInput","googFrameRateOutput","framesEncoded","framesDecoded"]),n={timestamp:c,id:s.id};return t.forEach(t=>{n[t]=e.map(e=>Number(e[t]||0)).reduce((e,t)=>e+t,0)}),n})(o);u.video=Object.assign({frameRate:d(e,n)},i(f(e),Number))}return a&&(u.audio=i(f(a),Number)),u}};e.exports=p},function(e,t,n){"use strict";t.__esModule=!0,t.messages=t.codes=void 0,t.messages={1e3:"The connection successfully completed the purpose for which it was created.",1001:"The endpoint is going away, either because of a server failure or because the browser is navigating away from the page that opened the connection.",1002:"The endpoint is terminating the connection due to a protocol error. (CLOSE_PROTOCOL_ERROR)",1003:"The connection is being terminated because the endpoint has indicated that reconnections are not available. (CLOSE_UNSUPPORTED)",1005:"Indicates that no status code was provided even though one was expected. (CLOSE_NO_STATUS)",1006:"Used to indicate that a connection was closed abnormally (that is, with no close frame being sent) when a status code is expected. (CLOSE_ABNORMAL)",1007:"Indicates that an endpoint is terminating the connection because it has received data within a message that was not consistent with the type of the message (e.g., non-UTF-8 [RFC3629] data within a text message)",1008:"Indicates that an endpoint is terminating the connection because it has received a message that violates its policy.  This is a generic status code that can be returned when there is no other more suitable status code (e.g., 1003 or 1009) or if there is a need to hide specific details about the policy",1009:"Indicates that an endpoint is terminating the connection because it has received a message that is too big for it to process (CLOSE_TOO_LARGE)",1011:"Indicates that a server is terminating the connection because it encountered an unexpected condition that prevented it from fulfilling the request",4001:"Connectivity loss was detected as it was too long since the socket received the last PONG message",4010:"Timed out while waiting for the Rumor socket to connect.",4020:"Error code unavailable.",4030:"Exception was thrown during Rumor connection, possibly because of a blocked port."},t.codes={CLOSE_NORMAL:1e3,CLOSE_GOING_AWAY:1001,CLOSE_PROTOCOL_ERROR:1002,CLOSE_UNSUPPORTED:1003,CLOSE_NO_STATUS:1005,CLOSE_ABNORMAL:1006,CLOSE_INCONSISTENT_DATA:1007,CLOSE_POLICY_VIOLATION:1008,CLOSE_TOO_LARGE:1009,CLOSE_UNEXPECTED_CONDITION:1011,CLOSE_CONNECTIVITY_LOSS:4001,CLOSE_TIMEOUT:4010,CLOSE_FALLBACK_CODE:4020,CLOSE_CONNECT_EXCEPTION:4030,ALREADY_CONNECTED_CONNECTING:null}},function(e,t,n){var r=n(79),i=n(113),o=n(84),a=n(177),s=n(390),c=n(180),u=n(55),d=n(393),l=n(395),f=n(183),p=n(185),h=n(42),m=n(398),g=n(399),v=n(190),y=n(12),b=n(65),S=n(403),E=n(11),_=n(405),T=n(31),R=n(54),I={};I["[object Arguments]"]=I["[object Array]"]=I["[object ArrayBuffer]"]=I["[object DataView]"]=I["[object Boolean]"]=I["[object Date]"]=I["[object Float32Array]"]=I["[object Float64Array]"]=I["[object Int8Array]"]=I["[object Int16Array]"]=I["[object Int32Array]"]=I["[object Map]"]=I["[object Number]"]=I["[object Object]"]=I["[object RegExp]"]=I["[object Set]"]=I["[object String]"]=I["[object Symbol]"]=I["[object Uint8Array]"]=I["[object Uint8ClampedArray]"]=I["[object Uint16Array]"]=I["[object Uint32Array]"]=!0,I["[object Error]"]=I["[object Function]"]=I["[object WeakMap]"]=!1,e.exports=function e(t,n,w,C,O,A){var x,k=1&n,N=2&n,L=4&n;if(w&&(x=O?w(t,C,O,A):w(t)),void 0!==x)return x;if(!E(t))return t;var M=y(t);if(M){if(x=m(t),!k)return u(t,x)}else{var V=h(t),P="[object Function]"==V||"[object GeneratorFunction]"==V;if(b(t))return c(t,k);if("[object Object]"==V||"[object Arguments]"==V||P&&!O){if(x=N||P?{}:v(t),!k)return N?l(t,s(x,t)):d(t,a(x,t))}else{if(!I[V])return O?t:{};x=g(t,V,k)}}A||(A=new r);var D=A.get(t);if(D)return D;A.set(t,x),_(t)?t.forEach((function(r){x.add(e(r,n,w,r,t,A))})):S(t)&&t.forEach((function(r,i){x.set(i,e(r,n,w,i,t,A))}));var Z=M?void 0:(L?N?p:f:N?R:T)(t);return i(Z||t,(function(r,i){Z&&(r=t[i=r]),o(x,i,e(r,n,w,i,t,A))})),x}},function(e,t,n){var r=n(80),i=n(362),o=n(363),a=n(364),s=n(365),c=n(366);function u(e){var t=this.__data__=new r(e);this.size=t.size}u.prototype.clear=i,u.prototype.delete=o,u.prototype.get=a,u.prototype.has=s,u.prototype.set=c,e.exports=u},function(e,t,n){var r=n(357),i=n(358),o=n(359),a=n(360),s=n(361);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=a,c.prototype.set=s,e.exports=c},function(e,t,n){var r=n(53);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},function(e,t,n){var r=n(39)(Object,"create");e.exports=r},function(e,t,n){var r=n(381);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},function(e,t,n){var r=n(63),i=n(53),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var a=e[t];o.call(e,t)&&i(a,n)&&(void 0!==n||t in e)||r(e,t,n)}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){var r=n(388),i=n(67),o=n(115),a=o&&o.isTypedArray,s=a?i(a):r;e.exports=s},function(e,t,n){var r=n(11),i=Object.create,o=function(){function e(){}return function(t){if(!r(t))return{};if(i)return i(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=o},function(e,t,n){var r=n(89),i=n(193),o=n(123);e.exports=function(e,t){return o(i(e,t,r),e+"")}},function(e,t){e.exports=function(e){return e}},function(e,t,n){"use strict";var r=Object.prototype.toString,i=r.call(function(){return arguments}());e.exports=function(e){return r.call(e)===i}},function(e,t,n){"use strict";var r=Object.prototype.toString,i=r.call("");e.exports=function(e){return"string"==typeof e||e&&"object"==typeof e&&(e instanceof String||r.call(e)===i)||!1}},function(e,t,n){"use strict";e.exports=n(430)()?globalThis:n(431)},function(e,t,n){var r=n(112),i=n(463),o=n(464);function a(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}a.prototype.add=a.prototype.push=i,a.prototype.has=o,e.exports=a},function(e,t,n){var r=n(465);e.exports=function(e,t){return!(null==e||!e.length)&&r(e,t,0)>-1}},function(e,t){e.exports=function(e,t){return e.has(t)}},function(e,t,n){var r=n(87),i=n(11);e.exports=function(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=r(e.prototype),o=e.apply(n,t);return i(o)?o:n}}},function(e,t,n){var r=n(506);e.exports=function(e){var t=r(e),n=t%1;return t==t?n?t-n:t:0}},function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},function(e,t,n){var r=n(59),i=n(47);e.exports=function(e,t){for(var n=0,o=(t=r(t,e)).length;null!=e&&n<o;)e=e[i(t[n++])];return n&&n==o?e:void 0}},function(e,t,n){var r=n(239),i=n(31);e.exports=function(e,t){return e&&r(e,t,i)}},function(e,t,n){"use strict";const r=n(240),i=e=>e.replace(/\/$/,"");e.exports={prependProxyToUrlIfNeeded:(e,t)=>{if(!t)return e;const n=r.parse(t),o=r.parse(e);if(!n.protocol||!o.protocol)return e;const a=n.protocol.match(/^https/),s=o.protocol.match(/^ws/i);return`${i(`${(s?"ws":"http")+(a?"s":"")}://${n.host}${n.pathname}`)}/${i(`${o.host}${o.pathname}${o.search||""}`)}`}}},function(e,t,n){"use strict";const r=n(22),i=n(13),o=n(7),a=n(10),s=n(23);let c;const u={SET_PROXY_URL_TIMING_ERROR:"The proxyUrl was set after a session or publisher was created.",PROXY_URL_ALREADY_SET_ERROR:"The proxyUrl has already been set. Setting it again will not have any effect."};e.exports={errorMessages:u,setProxyUrl:e=>{const t=n(21),d=n(71),l=new t,f=r.sessions.length()>0,p=r.publishers.length()>0;let h;if(f){const e=r.sessions.find(e=>"connected"===e.currentState);h=e?e.sessionId:r.sessions.find().sessionId}else h="";const m={sessionId:h,apiKey:d.value};if(p||f){const e=i()(o.SET_PROXY_URL_TIMING_ERROR,new Error(u.SET_PROXY_URL_TIMING_ERROR),a.SET_PROXY_URL_TIMING_ERROR);s.handleJsException({error:e,target:m,analytics:l})}else if(c){const e=i()(o.PROXY_URL_ALREADY_SET_ERROR,new Error(u.PROXY_URL_ALREADY_SET_ERROR),a.PROXY_URL_ALREADY_SET_ERROR);s.handleJsException({error:e,target:m,analytics:l})}else c=e},getProxyUrl:()=>c,clearProxyUrl:()=>{c=null}}},function(e,t,n){"use strict";t.adaptIceServers=function(e){return e.map(e=>({url:e.url,urls:e.urls||[e.url],username:e.username,credential:e.credential}))},t.parseIceServers=function(e){let n;try{n=JSON.parse(e.data).content.iceServers}catch(e){return[]}return t.adaptIceServers(n)}},function(e,t,n){"use strict";const r=n(3);e.exports=()=>"Chrome"===r.name&&r.version>=58||-1!==["Firefox","Edge","Safari","Opera"].indexOf(r.name)},function(e,t,n){"use strict";e.exports=function(e){let t=null,n=!1;const r=()=>{n&&(e(),t=window.requestAnimationFrame(r))};this.start=()=>{n||(n=!0,window.requestAnimationFrame(r))},this.stop=()=>{window.cancelAnimationFrame(t),n=!1}}},function(e,t,n){"use strict";const r=n(9);e.exports=(e,t)=>{const n={};Object.keys(t).forEach(r=>{n[r]=((e,t,n)=>t&&!n?()=>t.call(e):t&&n?r=>(void 0!==r&&n.call(e,r),t.call(e)):t=>{void 0!==t&&n.call(e,t)})(e,t[r].get,t[r].set)}),r(e,n)}},function(e,t,n){"use strict";let r="";e.exports={getCurrentAudioOutputDeviceId:()=>r,setCurrentAudioOutputDeviceId:e=>{r=e}}},function(e,t,n){"use strict";(function(t){e.exports=function(e){return new t(t=>setTimeout(t,e))}}).call(this,n(2))},function(e,t,n){"use strict";const r=n(296);e.exports=function(e){let t=(void 0===e?{}:e).NativeVideoElementWrapper;const n=void 0===t?r():t;return function(e){let t=void 0===e?{}:e,r=t.fallbackText,i=void 0===r?"Sorry, Web RTC is not available in your browser":r,o=t.fitMode,a=t.muted,s=t._inject,c=t.widgetType;return new n({fallbackText:i,fitMode:o,muted:a,defaultAudioVolume:50,_inject:s,widgetType:c})}}},function(e,t,n){"use strict";const r=!!window.crypto,i=!!window.RTCRtpSender.prototype.createEncodedStreams||!!window.RTCRtpSender.prototype.createdEncodedVideoStreams,o=!!window.Worker,a=()=>r&&i&&o;e.exports=function(e){void 0===e&&(e={});const t=e.hasOpenTokSupport||n(52).once,r=e.isE2eeSupported||a;return t()&&r()}},function(e,t,n){var r=n(39)(n(15),"Map");e.exports=r},function(e,t,n){var r=n(373),i=n(380),o=n(382),a=n(383),s=n(384);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=a,c.prototype.set=s,e.exports=c},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,t,n){(function(e){var r=n(174),i=t&&!t.nodeType&&t,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,a=o&&o.exports===i&&r.process,s=function(){try{var e=o&&o.require&&o.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=s}).call(this,n(85)(e))},function(e,t,n){var r=n(68),i=n(389),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=[];for(var n in Object(e))o.call(e,n)&&"constructor"!=n&&t.push(n);return t}},function(e,t,n){var r=n(394),i=n(181),o=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(e){return null==e?[]:(e=Object(e),r(a(e),(function(t){return o.call(e,t)})))}:i;e.exports=s},function(e,t){e.exports=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}},function(e,t,n){var r=n(179)(Object.getPrototypeOf,Object);e.exports=r},function(e,t,n){var r=n(188);e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},function(e,t,n){"use strict";e.exports={error:{priority:1,method:"error"},warn:{priority:2,method:"warn"},info:{priority:3,method:"info"},log:{priority:4,method:"log"},debug:{priority:5,method:"debug"},spam:{priority:6,method:"log"}}},function(e,t){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},function(e,t,n){var r=n(410),i=n(194)(r);e.exports=i},function(e,t,n){var r=n(53),i=n(25),o=n(66),a=n(11);e.exports=function(e,t,n){if(!a(n))return!1;var s=typeof t;return!!("number"==s?i(n)&&o(t,n.length):"string"==s&&t in n)&&r(n[t],e)}},function(e,t,n){"use strict";e.exports=n(196)()?Object.setPrototypeOf:n(197)},function(e,t,n){"use strict";var r=n(56),i={object:!0,function:!0,undefined:!0};e.exports=function(e){return!!r(e)&&hasOwnProperty.call(i,typeof e)}},function(e,t,n){"use strict";e.exports=n(421)()?Object.assign:n(422)},function(e,t,n){"use strict";const r=n(0)("Event"),i=n(9),o=n(129);e.exports=function(){function e(e,t,n){void 0===t&&(t=!0),void 0===n&&(n={}),this.type=e,this.cancelable=t,this._defaultPrevented=!1;const r=o(Object.keys(this),Object.keys(n));if(r.length>0)throw new Error("Cannot used reserved property names: "+r.join(","));i(this,n)}var t=e.prototype;return t.preventDefault=function(){this.cancelable?this._defaultPrevented=!0:r.warn("Event.preventDefault :: Trying to preventDefault on an event that isn't cancelable")},t.isDefaultPrevented=function(){return this._defaultPrevented},e}()},function(e,t,n){var r=n(34),i=n(462),o=n(88),a=n(468),s=o((function(e){var t=r(e,a);return t.length&&t[0]===e[0]?i(t):[]}));e.exports=s},function(e,t){e.exports=function(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}},function(e,t,n){var r=n(25),i=n(18);e.exports=function(e){return i(e)&&r(e)}},function(e,t,n){"use strict";(function(t){var r=n(19),i=n(474),o=n(210),a={"Content-Type":"application/x-www-form-urlencoded"};function s(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var c,u={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==t&&"[object process]"===Object.prototype.toString.call(t))&&(c=n(211)),c),transformRequest:[function(e,t){return i(t,"Accept"),i(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(s(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)||t&&"application/json"===t["Content-Type"]?(s(t,"application/json"),function(e,t,n){if(r.isString(e))try{return(t||JSON.parse)(e),r.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional,n=t&&t.silentJSONParsing,i=t&&t.forcedJSONParsing,a=!n&&"json"===this.responseType;if(a||i&&r.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(a){if("SyntaxError"===e.name)throw o(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(e){u.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){u.headers[e]=r.merge(a)})),e.exports=u}).call(this,n(43))},function(e,t){e.exports={}},function(e,t,n){var r=n(217),i=n(492),o=n(493),a=n(219),s=n(504),c=n(223),u=n(505),d=n(226),l=n(227),f=n(97),p=Math.max;e.exports=function(e,t,n,h,m,g,v,y){var b=2&t;if(!b&&"function"!=typeof e)throw new TypeError("Expected a function");var S=h?h.length:0;if(S||(t&=-97,h=m=void 0),v=void 0===v?v:p(f(v),0),y=void 0===y?y:f(y),S-=m?m.length:0,64&t){var E=h,_=m;h=m=void 0}var T=b?void 0:c(e),R=[e,t,n,h,m,E,_,g,v,y];if(T&&u(R,T),e=R[0],t=R[1],n=R[2],h=R[3],m=R[4],!(y=R[9]=void 0===R[9]?b?0:e.length:p(R[9]-S,0))&&24&t&&(t&=-25),t&&1!=t)I=8==t||16==t?o(e,t,y):32!=t&&33!=t||m.length?a.apply(void 0,R):s(e,t,n,h);else var I=i(e,t,n);return l((T?r:d)(I,R),e,t)}},function(e,t,n){var r=n(87),i=n(136);function o(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}o.prototype=r(i.prototype),o.prototype.constructor=o,e.exports=o},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n];a!==t&&"__lodash_placeholder__"!==a||(e[n]="__lodash_placeholder__",o[i++]=n)}return o}},function(e,t,n){var r=n(30),i=n(119),o=n(18),a=Function.prototype,s=Object.prototype,c=a.toString,u=s.hasOwnProperty,d=c.call(Object);e.exports=function(e){if(!o(e)||"[object Object]"!=r(e))return!1;var t=i(e);if(null===t)return!0;var n=u.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&c.call(n)==d}},function(e,t,n){var r=n(12),i=n(70),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!i(e))||a.test(e)||!o.test(e)||null!=t&&e in Object(t)}},function(e,t,n){var r=n(528),i=n(193),o=n(123);e.exports=function(e){return o(i(e,void 0,r),e+"")}},function(e,t,n){var r=n(88),i=n(53),o=n(124),a=n(54),s=Object.prototype,c=s.hasOwnProperty,u=r((function(e,t){e=Object(e);var n=-1,r=t.length,u=r>2?t[2]:void 0;for(u&&o(t[0],t[1],u)&&(r=1);++n<r;)for(var d=t[n],l=a(d),f=-1,p=l.length;++f<p;){var h=l[f],m=e[h];(void 0===m||i(m,s[h])&&!c.call(e,h))&&(e[h]=d[h])}return e}));e.exports=u},function(e,t,n){"use strict";var r=n(1)(n(46));const i=n(58),o=n(57);let a=function(){function e(e){void 0===e&&(e={}),Object.defineProperty(this,"_rawSessionInfo",{value:o(e)})}return(0,r.default)(e,[{key:"sessionId",get:function(){return this._rawSessionInfo.session_id}},{key:"partnerId",get:function(){return this._rawSessionInfo.partner_id}},{key:"messagingServer",get:function(){return this._rawSessionInfo.messaging_server_url}},{key:"mediaServerName",get:function(){return this._rawSessionInfo.media_server_hostname}},{key:"messagingURL",get:function(){return this._rawSessionInfo.messaging_url}},{key:"symphonyAddress",get:function(){return this._rawSessionInfo.symphony_address}},{key:"iceServers",get:function(){return this._rawSessionInfo.ice_servers}},{key:"simulcast",get:function(){return i(this._rawSessionInfo,"properties.simulcast")}},{key:"e2ee",get:function(){return i(this._rawSessionInfo,"properties.e2ee",!1)}},{key:"reconnection",get:function(){return i(this._rawSessionInfo,"properties.reconnection",!1)}},{key:"renegotiation",get:function(){return i(this._rawSessionInfo,"properties.renegotiation",!1)}},{key:"p2pEnabled",get:function(){return"enabled"===i(this._rawSessionInfo,"properties.p2p.preference.value")}},{key:"hybridSession",get:function(){return i(this._rawSessionInfo,"properties.hybridSession",!1)}},{key:"isAdaptiveEnabled",get:function(){return"adaptive"===i(this._rawSessionInfo,"properties.p2p.preference.value")}},{key:"priorityVideoCodec",get:function(){return i(this._rawSessionInfo,"properties.priorityVideoCodec","")}},{key:"h264",get:function(){return i(this._rawSessionInfo,"properties.h264",!0)}},{key:"vp8",get:function(){return i(this._rawSessionInfo,"properties.vp8",!0)}},{key:"vp9",get:function(){return i(this._rawSessionInfo,"properties.vp9",!0)}},{key:"singlePeerConnection",get:function(){return i(this._rawSessionInfo,"properties.singlePeerConnection",!1)}},{key:"clientCandidates",get:function(){const e=i(this._rawSessionInfo,"properties.clientCandidates");return"relayed"===e?"relay":e}}]),e}();e.exports=a},function(module,exports,__webpack_require__){"use strict";const extendES5Native=__webpack_require__(570),webrtcAdapter=__webpack_require__(571),logging=__webpack_require__(0)("createWindowMock"),env=__webpack_require__(3),windowKeys=[{key:"location",type:"object"},{key:"setTimeout",type:"function"},{key:"requestAnimationFrame",type:"function"},{key:"URL",type:"function"},{key:"MediaStream",type:"class"},{key:"webkitMediaStream",type:"class"},{key:"RTCIceCandidate",type:"class"},{key:"mozRTCIceCandidate",type:"class"},{key:"RTCSessionDescription",type:"class"},{key:"mozRTCSessionDescription",type:"class"},{key:"RTCIceGatherer",type:"class"},{key:"RTCIceTransport",type:"class"},{key:"RTCDtlsTransport",type:"class"},{key:"RTCSctpTransport",type:"class"},{key:"RTCRtpReceiver",type:"class"},{key:"HTMLMediaElement",type:"class"},{key:"RTCPeerConnection",type:"class"},{key:"webkitRTCPeerConnection",type:"class"},{key:"mozRTCPeerConnection",type:"class"},{key:"MediaStreamTrack",type:"class"},{key:"RTCRtpSender",type:"class"},{key:"RTCTrackEvent",type:"class"},{key:"RTCTransceiver",type:"class"},{key:"RTCDtmfSender",type:"class"},{key:"RTCDTMFSender",type:"class"},{key:"MediaStreamTrackEvent",type:"class"}],navigatorKeys=[{key:"userAgent",type:"string"},{key:"getUserMedia",type:"function"},{key:"getDisplayMedia",type:"function"},{key:"webkitGetUserMedia",type:"function"},{key:"mozGetUserMedia",type:"function"}],mediaDevicesKeys=[{key:"getUserMedia",type:"function"},{key:"getDisplayMedia",type:"function"},{key:"enumerateDevices",type:"function"},{key:"getSupportedConstraints",type:"function"},{key:"addEventListener",type:"function"},{key:"removeEventListener",type:"function"}],bindWithStaticProperties=(e,t)=>{if("function"!=typeof t)return logging.warn("Non-function passed into bindWithStaticProperties()"),t;const n=t.bind(e);return Object.keys(t).forEach(e=>{n[e]=t[e]}),n},extendParentClass=ParentClass=>{try{const ChildClass=eval('\n      "use strict"; // Chrome<49 requires strict mode\n\n      const getOwnProperties = (target) => {\n        const properties = {};\n        Object.getOwnPropertyNames(target).forEach((key) => {\n          properties[key] = Object.getOwnPropertyDescriptor(target, key);\n        });\n        return properties;\n      };\n\n      class ChildClass extends ParentClass {\n        constructor(...args) {\n          super(...args);\n          try {\n            this.__proto__ = ChildClass.prototype;\n          } catch (e) {}\n        }\n      };\n\n      Object.defineProperties(ChildClass.prototype, getOwnProperties(ParentClass.prototype));\n      Object.keys(ParentClass)\n        .forEach((staticKey) => {\n          ChildClass[staticKey] = ParentClass[staticKey];\n        });\n\n      ChildClass; // Ensure the final statement is returned in FF\n    ');if(ChildClass&&ChildClass.prototype instanceof ParentClass)return ChildClass}catch(e){}return null},canUseES6Class=e=>{const t=e.RTCPeerConnection||e.webkitRTCPeerConnection||e.mozRTCPeerConnection,n=extendParentClass(t);if(n)try{n.prototype.foo="bar";const e=new n({iceServers:[]}),t="bar"===e.foo;try{e.close()}catch(e){}return t}catch(e){}return!1},extendClass=(e,t,n)=>{if("function"!=typeof e)return logging.warn("Non-function passed into extendClass()"),e;let r=n&&extendParentClass(e);return r||(r=extendES5Native(e)),r},getCopyProperties=e=>(t,n,r)=>{r.forEach(r=>{let i=r.key,o=r.type,a=n[i];if(void 0!==a){switch(o){case"function":a=bindWithStaticProperties(n,a);break;case"class":a=extendClass(a,i,e);break;case"string":case"object":break;default:throw new Error("Invalid type of window key: "+o)}t[i]=a}})},cloneWindow=e=>{const t={},n=getCopyProperties(canUseES6Class(e));return n(t,e,windowKeys),void 0!==e.navigator&&(t.navigator={},n(t.navigator,e.navigator,navigatorKeys),void 0!==e.navigator.mediaDevices&&(t.navigator.mediaDevices={},n(t.navigator.mediaDevices,e.navigator.mediaDevices,mediaDevicesKeys))),t};module.exports=function(e){if(void 0!==e.adapter||env.isLegacyEdge)return e;const t=cloneWindow(e);return webrtcAdapter({window:t}),t}},function(e,t,n){"use strict";e.exports=function(){let e=null;this.transform=t=>{e=null===e||t>=e?t:.3*t+.7*e;const n=Math.log(e)/Math.LN10/1.5+1;return Math.min(Math.max(n,0),1)}}},function(e,t,n){"use strict";const r=n(6),i=e=>Object.keys(e).map(t=>e[t]),o=n(9);e.exports=function(e){const t={},n=(n,r)=>{o(r,{parent:this}),r.appendTo(e.parent),t[n]=r,this[n]=r};e.parent&&(r(this),this.destroy=()=>{this.off(),this.hideWhileLoading(),i(t).forEach(e=>e.destroy())},this.showAfterLoading=()=>{i(t).forEach(e=>e.showAfterLoading())},this.hideWhileLoading=()=>{i(t).forEach(e=>e.hideWhileLoading())},this.set=(e,t)=>("string"==typeof e&&t?n(e,t):Object.keys(e).forEach(t=>{n(t,e[t])}),this))}},function(e,t,n){"use strict";e.exports=function(){function e(e){this._analyser=null,this._timeDomainData=null,this._sourceNode=null,this._audioContext=e}var t=e.prototype;return t._initAudioAnalyser=function(e){this._analyser=this._audioContext.createAnalyser(),this._sourceNode=this._audioContext.createMediaStreamSource(e),this._sourceNode.connect(this._analyser),this._timeDomainData=new Uint8Array(this._analyser.frequencyBinCount)},t.webRTCStream=function(e){this._sourceNode&&this._sourceNode.disconnect(this._analyser),"suspended"===this._audioContext.state&&this._audioContext.resume(),this._initAudioAnalyser(e)},t.destroy=function(){this._sourceNode&&this._sourceNode.disconnect(this._analyser),this._timeDomainData=null},t.sample=function(e){if("function"==typeof e)throw new Error("sample no longer takes a callback");if(this._analyser&&this._timeDomainData){this._analyser.getByteTimeDomainData(this._timeDomainData);let e=0;for(let t=this._timeDomainData.length-1;t>=0;t-=1)e=Math.max(e,Math.abs(this._timeDomainData[t]-128));return e/128}return null},e}()},function(e,t,n){"use strict";const r=n(582),i=n(26),o=n(6),a=n(24)();e.exports=new function(){const e=this;function t(){return r.isDomLoaded()&&!r.isDomUnloaded()}function n(){e.dispatchEvent(new a.EnvLoadedEvent(i.ENV_UNLOADED))}o(e),r.whenLoaded.then((function(){r.whenUnloaded.then(n),t()&&e.dispatchEvent(new a.EnvLoadedEvent(i.ENV_LOADED))})),this.onLoad=function(n,r){t()?n.call(r):e.on(i.ENV_LOADED,n,r)},this.onUnload=function(t,n){this.isUnloaded()?t.call(n):e.on(i.ENV_UNLOADED,t,n)},this.isUnloaded=function(){return r.isDomUnloaded()}}},function(e,t,n){"use strict";var r=n(587);
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function i(e,t){if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0}function o(e){return(void 0!==typeof window?window:global).Buffer&&"function"==typeof(void 0!==typeof window?window:global).Buffer.isBuffer?(void 0!==typeof window?window:global).Buffer.isBuffer(e):!(null==e||!e._isBuffer)}var a=n(588),s=Object.prototype.hasOwnProperty,c=Array.prototype.slice,u="foo"===function(){}.name;function d(e){return Object.prototype.toString.call(e)}function l(e){return!o(e)&&"function"==typeof(void 0!==typeof window?window:global).ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer)))}var f=e.exports=y,p=/\s*function\s+([^\(\s]*)\s*/;function h(e){if(a.isFunction(e)){if(u)return e.name;var t=e.toString().match(p);return t&&t[1]}}function m(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function g(e){if(u||!a.isFunction(e))return a.inspect(e);var t=h(e);return"[Function"+(t?": "+t:"")+"]"}function v(e,t,n,r,i){throw new f.AssertionError({message:n,actual:e,expected:t,operator:r,stackStartFunction:i})}function y(e,t){e||v(e,!0,t,"==",f.ok)}function b(e,t,n,r){if(e===t)return!0;if(o(e)&&o(t))return 0===i(e,t);if(a.isDate(e)&&a.isDate(t))return e.getTime()===t.getTime();if(a.isRegExp(e)&&a.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(l(e)&&l(t)&&d(e)===d(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===i(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(o(e)!==o(t))return!1;var s=(r=r||{actual:[],expected:[]}).actual.indexOf(e);return-1!==s&&s===r.expected.indexOf(t)||(r.actual.push(e),r.expected.push(t),function(e,t,n,r){if(null==e||null==t)return!1;if(a.isPrimitive(e)||a.isPrimitive(t))return e===t;if(n&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var i=S(e),o=S(t);if(i&&!o||!i&&o)return!1;if(i)return e=c.call(e),t=c.call(t),b(e,t,n);var s,u,d=T(e),l=T(t);if(d.length!==l.length)return!1;for(d.sort(),l.sort(),u=d.length-1;u>=0;u--)if(d[u]!==l[u])return!1;for(u=d.length-1;u>=0;u--)if(s=d[u],!b(e[s],t[s],n,r))return!1;return!0}(e,t,n,r))}return n?e===t:e==t}function S(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function E(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(e){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function _(e,t,n,r){var i;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),i=function(e){var t;try{e()}catch(e){t=e}return t}(t),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),e&&!i&&v(i,n,"Missing expected exception"+r);var o="string"==typeof r,s=!e&&i&&!n;if((!e&&a.isError(i)&&o&&E(i,n)||s)&&v(i,n,"Got unwanted exception"+r),e&&i&&n&&!E(i,n)||!e&&i)throw i}f.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=function(e){return m(g(e.actual),128)+" "+e.operator+" "+m(g(e.expected),128)}(this),this.generatedMessage=!0);var t=e.stackStartFunction||v;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var n=new Error;if(n.stack){var r=n.stack,i=h(t),o=r.indexOf("\n"+i);if(o>=0){var a=r.indexOf("\n",o+1);r=r.substring(a+1)}this.stack=r}}},a.inherits(f.AssertionError,Error),f.fail=v,f.ok=y,f.equal=function(e,t,n){e!=t&&v(e,t,n,"==",f.equal)},f.notEqual=function(e,t,n){e==t&&v(e,t,n,"!=",f.notEqual)},f.deepEqual=function(e,t,n){b(e,t,!1)||v(e,t,n,"deepEqual",f.deepEqual)},f.deepStrictEqual=function(e,t,n){b(e,t,!0)||v(e,t,n,"deepStrictEqual",f.deepStrictEqual)},f.notDeepEqual=function(e,t,n){b(e,t,!1)&&v(e,t,n,"notDeepEqual",f.notDeepEqual)},f.notDeepStrictEqual=function e(t,n,r){b(t,n,!0)&&v(t,n,r,"notDeepStrictEqual",e)},f.strictEqual=function(e,t,n){e!==t&&v(e,t,n,"===",f.strictEqual)},f.notStrictEqual=function(e,t,n){e===t&&v(e,t,n,"!==",f.notStrictEqual)},f.throws=function(e,t,n){_(!0,e,t,n)},f.doesNotThrow=function(e,t,n){_(!1,e,t,n)},f.ifError=function(e){if(e)throw e},f.strict=r((function e(t,n){t||v(t,!0,n,"==",e)}),f,{equal:f.strictEqual,deepEqual:f.deepStrictEqual,notEqual:f.notStrictEqual,notDeepEqual:f.notDeepStrictEqual}),f.strict.strict=f.strict;var T=Object.keys||function(e){var t=[];for(var n in e)s.call(e,n)&&t.push(n);return t}},function(e,t,n){"use strict";const r=n(595),i=n(265),o=n(3);e.exports=e=>o.isElectron?"screen"===e||i(e):r.indexOf(e)>-1},function(e,t,n){"use strict";const r=n(268),i=n(6),o=n(0)("StreamChannel"),a=n(151)();e.exports=function(e){this.id=e.id,this.type=e.type,this.active=r(e.active),this.orientation=e.orientation||a.ROTATED_NORMAL,e.frameRate&&(this.frameRate=parseFloat(e.frameRate)),e.preferredFrameRate&&(this.preferredFrameRate=parseFloat(e.preferredFrameRate)),e.preferredWidth&&(this.preferredWidth=parseInt(e.preferredWidth,10)),e.preferredHeight&&(this.preferredHeight=parseInt(e.preferredHeight,10)),this.width=parseInt(e.width,10),this.height=parseInt(e.height,10),this.source=e.source||"camera",this.fitMode=e.fitMode||"cover",i(this),this.update=function(e){const t={},n={};for(const i in e){if(!e.hasOwnProperty(i))continue;const a=this[i];switch(i){case"active":this.active=r(e[i]);break;case"disableWarning":this.disableWarning=r(e[i]);break;case"frameRate":this.frameRate=parseFloat(e[i],10);break;case"width":case"height":this[i]=parseInt(e[i],10),t[i]=this[i],n[i]=a;break;case"orientation":this[i]=e[i],t[i]=this[i],n[i]=a;break;case"fitMode":case"source":this[i]=e[i];break;default:return o.warn(`Tried to update unknown key ${i} on ${this.type} channel ${this.id}`),!1}this.trigger("update",this,i,a,this[i])}return Object.keys(t).length&&this.trigger("update",this,"videoDimensions",n,t),!0}}},function(e,t,n){"use strict";e.exports=function(){return{ROTATED_NORMAL:0,ROTATED_LEFT:270,ROTATED_RIGHT:90,ROTATED_UPSIDE_DOWN:180}}},function(e,t,n){"use strict";const r=n(603),i=n(0)("StylableComponent"),o=n(604),a=n(269);e.exports=function(e,t,n,s){if(!e.trigger)throw new Error("OT.StylableComponent is dependent on the eventing mixin. Ensure that this is included in the object before StylableComponent.");s=s||function(){};let c=!1;!1===n&&(t={buttonDisplayMode:"off",nameDisplayMode:"off",audioLevelDisplayMode:"off",videoDisabledDisplayMode:"off",audioBlockedDisplayMode:"off"},c=!0,s({showControls:!1}));const u=new o(t,(function(t,n,r){r?e.trigger("styleValueChanged",t,n,r):e.trigger("styleValueChanged",t,n)}));e.getStyle=function(e){return u.get(e)},e.setStyle=function(e,t,n){if(c)return i.warn("Calling setStyle() has no effect because theshowControls option was set to false"),this;let o;return"string"!=typeof e?o=e:(o={},o[e]=t),o.backgroundImageURI&&(o.backgroundImageURI=r(o.backgroundImageURI)),u.setAll(o,n),s(a(o)),this}}},function(e,t,n){"use strict";const r=n(51),i=n(35)(),o=n(21),a=n(71),s=n(147),c=n(52).once,u=n(607),d=n(8),l=n(0)("systemRequirements"),f=n(608),p=n(609),h=i.onlyLocal(),m=new o,g=r(()=>{m.logEvent({action:"checkSystemRequirements",variation:"notHasRequirements",partnerId:a.value,payload:{userAgent:d.env.userAgent}})}),v=r(()=>{n(610)()});let y=!1;e.exports={check(){l.debug("OT.checkSystemRequirements()");const e=Number(u&&c());return v(),e||g(),e},upgrade(e){let t=void 0===e?{}:e,n=t.isSupportedButOld,r=void 0===n?d.env.name.toLowerCase()in h.minimumVersion:n,i=t.userAgent,o=void 0===i?navigator.userAgent:i;s.onLoad(()=>{if(y)return;const e=new p(f);let t;y=!0,e.on("close",()=>{y=!1}),e.open(),t=o.match(/(iPad|iPhone|iPod|android|webOS)/i)?(r?"supported-":"")+"mobile-browser":(r?"upgrade":"normal")+"-install",e.el("#section-"+t).style.display="block"})}}},function(e,t,n){"use strict";(function(t){var r=n(1),i=r(n(49)),o=r(n(611));const a=n(615);let s=function(e){function t(t){var n;return(n=e.call(this,t)||this).name="TimeoutError",n}return(0,i.default)(t,e),t}((0,o.default)(Error));e.exports=(e,n,r)=>new t((t,i)=>{if("number"!=typeof n||n<0)throw new TypeError("Expected `ms` to be a positive number");const o=setTimeout(()=>{if("function"==typeof r){try{t(r())}catch(o){i(o)}return}const o=r instanceof Error?r:new s("string"==typeof r?r:`Promise timed out after ${n} milliseconds`);"function"==typeof e.cancel&&e.cancel(),i(o)},n);a(e.then(t,i),()=>{clearTimeout(o)})}),e.exports.TimeoutError=s}).call(this,n(2))},function(e,t,n){"use strict";e.exports=function(){const e=[];return{add(t){e.push(t)},remove(t){const n=e.indexOf(t);n>=0&&e.splice(n,1)},releaseAll(){const t=[];for(;e.length>0;){const n=e.pop();try{n()}catch(e){t.push(e)}}const n=t.length;if(n>0)throw new Error(`Failed to complete ${n} cleanup job${1===n?"":"s"}: ${t.map(e=>`<${e}>`).join(", ")}`)}}}},function(e,t,n){"use strict";const r=n(0)("applySdpTransform");e.exports=(e,t,n,i,o)=>{const a=e[t][n],s=`${t} ${n}`,c=`sdpTransforms (${"local offer"===s||"remote answer"===s?"publisher":"subscriber"}): ${t} ${n}`,u="local"===t?"created":"received";r.debug(`${c}: ${u}:\n${o}`);const d=a(i,o);return d.local===o?r.debug(c+": not modified"):r.debug(`${c}: modified to:\n${d.local}`),d}},function(e,t,n){"use strict";e.exports=function(e){if(void 0===e&&(e={}),!e)return 0;const t=e,n=t.currentStatFrames,r=void 0===n?0:n,i=t.prevStatFrames,o=void 0===i?0:i,a=t.currentTimestamp,s=void 0===a?0:a,c=t.prevTimestamp,u=void 0===c?0:c;if(r>=o&&s>u){const e=(r-o)/((s-u)/1e3);return Math.round(100*e)/100}return 0}},function(e,t,n){"use strict";let r;e.exports=function(e){void 0===e&&(e={});const t=e.AudioContext||(void 0!==typeof window?window:global).AudioContext||(void 0!==typeof window?window:global).webkitAudioContext;return function(){if(r=r||t&&new t,null==r)throw new Error("AudioContext could not be created, hardware limit reached.");return r}}},function(e,t,n){"use strict";var r=n(1);t.__esModule=!0,t.default=void 0;var i=r(n(58)),o="function"==typeof(0,i.default)(void 0!==typeof window?window:global,"navigator.getDisplayMedia",(0,i.default)(void 0!==typeof window?window:global,"navigator.mediaDevices.getDisplayMedia"));t.default=o},function(e,t,n){"use strict";const r=n(38);e.exports=function(){return function(e,t,n){const i=t.slice(),o=r(n);return function(t){let n=e,r=null;function a(e,i){t({message:e,newState:i,currentState:n,previousState:r})}function s(e){return t=e,-1===i.indexOf(t)?(a(`'${e}' is not a valid state`,e),!1):(s=e,!(!o[r=n]||-1===o[r].indexOf(s))||(a(`'${n}' cannot transition to '${e}'`,e),!1));var t,r,s}this.current=n,this.set=function(e){s(e)&&(r=n,this.current=e,n=e)}}}}},function(e,t,n){"use strict";(function(t){const r=n(61);e.exports=function(e){void 0===e&&(e={});const i=e.chromeExtensionHelper||n(281)(),o=e.electronExtensionHelper||n(653)(),a=e.Errors||n(7),s=e.firefoxExtensionHelper||n(655),c=e.getDisplayMediaExtensionHelper||n(290),u=e.otError||n(13)(),d=e.OTHelpers||n(8),l={extensionByKind:{},extensionClasses:{},registerExtensionHelper:(e,t)=>{l.extensionClasses[e]=t,t.autoRegisters&&t.isSupportedInThisBrowser&&l.registerExtension(e)},registerExtension:function(e){if(null==l.extensionClasses[e])throw new Error("Unsupported kind passed to OT.registerScreenSharingExtension");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=l.extensionClasses[e].register(...n);l.extensionByKind[e]=i}},f=()=>{const e=r(Object.keys(l.extensionClasses).sort(e=>"electron"===e?-1:1),e=>l.extensionClasses[e].isSupportedInThisBrowser);return void 0===e?{}:{name:e,proto:l.extensionClasses[e],instance:l.extensionByKind[e]}};l.pickHelper=()=>f(),l.checkCapability=e=>{const t={supported:!1,extensionRequired:void 0,extensionRegistered:void 0,extensionInstalled:void 0,supportedSources:{}},n=f();if(void 0!==n.name){if(t.supported=!0,t.extensionRequired=n.proto.extensionRequired?n.name:void 0,t.supportedSources={screen:n.proto.sources.screen,application:n.proto.sources.application,window:n.proto.sources.window,browser:n.proto.sources.browser},!n.instance)return t.extensionRegistered=!1,t.extensionRequired&&(t.extensionInstalled=!1),void setTimeout(e.bind(null,t));t.extensionRegistered=!!t.extensionRequired||void 0,n.instance.isInstalled(n=>{t.extensionInstalled=t.extensionRequired||"Firefox"===d.env.name?n:void 0,e(t)})}else setTimeout(e.bind(null,t))},l.registerExtensionHelper("electron",o),l.registerExtensionHelper("getDisplayMedia",c),l.registerExtensionHelper("chrome",i),l.registerExtensionHelper("firefox",s);const p=()=>{};return l.getConstraints=e=>{const n=e.onAccessDialogOpened,r=void 0===n?p:n,i=e.onAccessDialogClosed,o=void 0===i?p:i,s=e.videoSource,c=e.constraints;return new t((e,t)=>{l.checkCapability(n=>{if(n.supported)if(!1===n.extensionRegistered)t(u(a.SCREEN_SHARING_EXTENSION_NOT_REGISTERED,new Error("Screen Sharing support in this browser requires an extension, but one has not been registered.")));else if(n.extensionRequired&&!1===n.extensionInstalled)t(u(a.SCREEN_SHARING_EXTENSION_NOT_INSTALLED,new Error("Screen Sharing support in this browser requires an extension, but the extension is not installed.")));else{const n=l.pickHelper();n.proto.getConstraintsShowsPermissionUI&&r(),n.instance.getConstraints(s,c,(r,i)=>{n.proto.getConstraintsShowsPermissionUI&&o(),r?t(r):e(i)})}else{let e="Screen Sharing is not supported in this browser";d.env.isElectron?e="Set the webPreferences.contextIsolation option of the Electron BrowserWindow to false or use a preload script to access the desktop capturer. For more information, see https://tokbox.com/developer/guides/screen-sharing/js/.":"Chrome"===d.env.name&&d.env.version>73&&"https:"!==(void 0!==typeof window?window:global).location.protocol&&(e="https:// is required for screen sharing"),t(u(a.SCREEN_SHARING_NOT_SUPPORTED,new Error(e)))}})})},l}}).call(this,n(2))},function(e,t,n){"use strict";e.exports=function(e){void 0===e&&(e={});const t=e.Errors||n(7),r=e.ExceptionCodes||n(10),i=e.otError||n(13)(),o={ICEWorkflow:t.ICE_WORKFLOW_FAILED,NewPeerConnection:t.CREATE_PEER_CONNECTION_FAILED,SetRemoteDescription:t.SET_REMOTE_DESCRIPTION_FAILED,Subscribe:{404:t.STREAM_NOT_FOUND,[r.STREAM_LIMIT_EXCEEDED]:t.STREAM_LIMIT_EXCEEDED}};return function(e,n,a,s,c){const u=`${(a?a+": ":"")+c} PeerConnection with connection ${s} failed: ${n}`,d=o[a]||{},l="string"==typeof d?d:d[e],f="Publisher"===c?r.UNABLE_TO_PUBLISH:r.UNABLE_TO_SUBSCRIBE;if(!l){const e=new Error(u);return e.code=f,e}const p="ICEWorkflow"===a?"Publisher"===c?r.PUBLISHER_ICE_WORKFLOW_FAILED:r.SUBSCRIBER_ICE_WORKFLOW_FAILED:l===t.STREAM_LIMIT_EXCEEDED?r.STREAM_LIMIT_EXCEEDED:f;return i(l,new Error(u),p)}}},function(e,t,n){"use strict";e.exports=function(e){void 0===e&&(e={});const t=e.OTHelpers||n(8),r=(e.global||(void 0!==typeof window?window:global)).RTCPeerConnection;return function(e,n){"Firefox"===t.env.name&&r&&r.generateCertificate?r.generateCertificate({name:"RSASSA-PKCS1-v1_5",hash:"SHA-256",modulusLength:2048,publicExponent:new Uint8Array([1,0,1])}).catch(e=>{n(e)}).then(t=>{e.certificates=[t],n(void 0,e)}):setTimeout(()=>{n(void 0,e)})}}},function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r={bandwidthCriticalThreshold:7e4,bandwidthFairThreshold:0,packetLossCriticalThreshold:.15,packetLossCriticalThresholdMediumBw:.2,criticalCongestionPeriod:4e3};t.default=r},function(e,t,n){"use strict";var r=n(1),i=r(n(4)),o=r(n(5)),a=r(n(46));const s=n(6),c=n(683),u=n(0)("WidgetView"),d=n(8),l=n(3),f=n(166),p=f.default,h=f.CancellationError,m=n(167),g=n(685),v=n(686),y=n(687),b=n(688),S=n(689),E=n(62),_=n(690),T=n(109);T(),e.exports=function(e){let t=void 0===e?{}:e,n=t.logging,r=void 0===n?u:n,f=t.OTHelpers,R=void 0===f?d:f,I=t.waitForVideoToBePlaying,w=void 0===I?v:I,C=t.VideoElementFacade,O=void 0===C?T():C,A=t.env,x=void 0===A?l:A;const k=c({window:void 0!==typeof window?window:global}),N=e=>{if(e.isCanceled())throw r.debug("bindVideo bailing due to cancellation"),new h("CANCEL")};return function(){function e(e,t){let n=void 0===t?{}:t,i=n.insertDefaultUI,o=void 0===i||i,a=n.width,c=void 0===a?264:a,u=n.height,d=void 0===u?198:u,l=n.fitMode,f=void 0===l?"cover":l,p=n.mirror,h=void 0!==p&&p,m=n.insertMode,g=n.classNames,v=n.style,_=n.widgetType,T=n.initials;this._videoElementFacade=void 0,this._container=void 0,this._posterContainer=document.createElement("div"),this._widgetContainer=document.createElement("div"),this._loading=!0,this._audioOnly=!1,this._showPoster=void 0,this._poster=void 0,this._cancelBind=void 0,this.MAX_VIDEO_LOADED=5e3,s(this),!1===/^(contain|cover)$/.test(f)&&r.warn(`Invalid fit value "${f}" passed. Only "contain" and "cover" can be used.`),this._widgetType=_,this._fitMode=f,this._insertDefaultUI=o;const I=E(this._widgetContainer);if(I.on("click",this.userGesture.bind(this)),I.on("touchstart",this.userGesture.bind(this),!!k&&{passive:!0}),this.once("destroy",()=>I.removeAll()),this._widgetContainer.classList.add("OT_widget-container"),this._widgetContainer.style.width="100%",this._widgetContainer.style.height="100%",!1!==o){this._container=b(e,m),x.isSafari&&x.isiOS&&x.iOSVersion&&x.iOSVersion<11.2&&this._container.classList.add("OT_ForceContain"),this._container.style.width=S(c),this._container.style.height=S(d),this._container.style.overflow="hidden",y(this._container),h&&R.addClass(this._container,"OT_mirrored"),g&&g.trim().split(/\s+/).forEach(e=>this._container.classList.add(e)),this._container.classList.add("OT_loading"),this._container.classList.add("OT_fit-mode-"+f),this._container.appendChild(this._widgetContainer);const t=R(this._container).observeSize(()=>y(this._container))[0],n=R.observeNodeOrChildNodeRemoval(this._container,e=>{this._videoElementFacade&&e.some(e=>e===this._widgetContainer||e===this._videoElementFacade.domElement())&&this.destroyVideo()});this.once("destroy",()=>{r.debug("disconnecting observers"),t.disconnect(),n.disconnect()})}this._posterContainer.classList.add("OT_video-poster"),this._widgetContainer.appendChild(this._posterContainer);const w=document.createElement("div");w.classList.add("OT_video-loading");const C=document.createElement("div");C.classList.add("OT_video-loading-spinner"),w.appendChild(C),this._widgetContainer.appendChild(w),v&&v.backgroundImageURI?this.setBackgroundImageURI(v.backgroundImageURI):T&&this.setInitials(T)}var t=e.prototype;return t.addError=function(e,t,n){this._container&&(this._container.innerHTML=`<p>${e}${t?` <span class="ot-help-message">${t}</span>`:""}</p>`,R.addClass(this._container,n||"OT_subscriber_error"),this._container.querySelector("p").offsetHeight>this._container.offsetHeight&&(this._container.querySelector("span").style.display="none"))},t.destroy=function(){this.emit("destroy"),this.destroyVideo(),this._container&&(R.removeElement(this._container),this._container=null)},t.setBackgroundImageURI=function(e){R.css(this._posterContainer,"backgroundImage",`url(${e})`),R.css(this._posterContainer,"backgroundSize","contain"),R.css(this._posterContainer,"opacity","1.0")},t.setInitials=function(e){const t=_(e),n=(new XMLSerializer).serializeToString(t);R.css(this._posterContainer,"backgroundImage",`url('data:image/svg+xml,${n}')`),R.css(this._posterContainer,"backgroundSize","auto 55%"),R.css(this._posterContainer,"opacity","1.0")},t.isAudioBlocked=function(){return Boolean(this._videoElementFacade&&this._videoElementFacade.isAudioBlocked())},t.unblockAudio=function(){return this._videoElementFacade.unblockAudio()},t.userGesture=function(){this.isAudioBlocked()&&m().then(()=>r.debug("Successfully unblocked audio"),e=>r.error("Error retrying audio on user interaction:",e))},t.setAudioBlockedUi=function(e){this._container&&(e?this._container.classList.add("OT_container-audio-blocked"):this._container.classList.remove("OT_container-audio-blocked"))},t.rebindSrcObject=function(){this._videoElementFacade&&this._videoElementFacade._rebindSrcObject()},t.pauseAndPlayVideoElement=function(){this._videoElementFacade&&this._videoElementFacade._pauseAndPlay()},t._createBufferVideoElement=function(){var e=(0,o.default)(i.default.mark((function e(t,n){var r,o,a;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n={}),r=n.createElement?n:document,o=!1,(a=r.createElement("video")).srcObject=t,e.prev=5,a.play(),e.next=9,w(a,this.MAX_VIDEO_LOADED);case 9:return o=e.sent,e.abrupt("return",o?a:null);case 13:return e.prev=13,e.t0=e.catch(5),e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(t,n){return e.apply(this,arguments)}}(),t._emitAMREvent=function(e,t,n){this.emit("amrLogEvent",e,t,n)},t._createVideoElementFacade=function(e){let t=e._inject,n=e.audioVolume,i=e.fallbackText,o=e.muted;this._videoElementFacade=new O({defaultAudioVolume:parseFloat(n),fallbackText:i,fitMode:this._fitMode,_inject:t,muted:o,widgetType:this._widgetType});const a=E(this._videoElementFacade);if(this._videoFacadeEvents=a,a.on("error",()=>{this.trigger("error")}),a.on("videoDimensionsChanged",(e,t)=>{this.trigger("videoDimensionsChanged",e,t)}),a.on("mediaStopped",e=>{this.trigger("mediaStopped",e)}),a.on("audioBlocked",()=>this.trigger("audioBlocked")),a.on("audioUnblocked",()=>this.trigger("audioUnblocked")),this._videoElementFacade.audioChannelType("telephony"),r.debug("Appending the video facade"),this._videoElementFacade.appendTo(this._widgetContainer),void 0!==n)try{this._videoElementFacade.setAudioVolume(n)}catch(e){r.warn("bindVideo "+e)}},t._bindToStream=function(){var e=(0,o.default)(i.default.mark((function e(t,n){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._videoElementFacade.bindToStream(t);case 3:e.next=14;break;case 5:if(e.prev=5,e.t0=e.catch(0),!n.isCanceled()){e.next=12;break}throw r.debug("Refusing to destroyVideo as bindVideo was cancelled"),new h("CANCEL");case 12:throw this.destroyVideo(),e.t0;case 14:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(t,n){return e.apply(this,arguments)}}(),t._getNewBindCancellation=function(){this._cancelBind&&(r.debug("Cancelling last bindVideo request"),this._cancelBind.cancel());const e=new p;return this._cancelBind=e,this.once("destroy",()=>e.cancel()),e},t._triggerVideoElementCreated=function(){const e=e=>{this.trigger("videoElementCreated",e),this._insertDefaultUI&&R.addClass(e,"OT_video-element")};this._videoElementFacade.domElement()?e(this._videoElementFacade.domElement()):this._videoFacadeEvents.on("videoElementCreated",t=>{e(t)})},t._waitForVideoResolution=function(){var e=(0,o.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.audioOnly()||!(t.getVideoTracks().length>0)){e.next=5;break}return r.debug("Waiting for correct resolution"),e.next=4,g(this._videoElementFacade,5e3);case 4:r.debug(`Resolution: ${this._videoElementFacade.videoWidth()}x${this._videoElementFacade.videoHeight()}`);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.bindVideo=function(){var e=(0,o.default)(i.default.mark((function e(t,n,o){var a,s,c,u,d,l,f,p;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.audioVolume,s=n.muted,c=n.fallbackText,u=n._inject,void 0===o&&(o=!1),r.debug("bindVideo ",{webRTCStream:t}),d=!!this._videoElementFacade,f=this._getNewBindCancellation(),d){e.next=9;break}this._createVideoElementFacade({_inject:u,audioVolume:a,fallbackText:c,muted:s}),e.next=22;break;case 9:if(!(t instanceof MediaStream)){e.next=22;break}return this._emitAMREvent("AMRLoadVideoBuffer","Attempt"),e.next=13,this._createBufferVideoElement(t);case 13:if(l=e.sent){e.next=20;break}if(this._emitAMREvent("AMRLoadVideoBuffer","Failure"),!o){e.next=18;break}throw new Error("bufferFailed: videoBuffer failed to load or timeout");case 18:e.next=21;break;case 20:this._emitAMREvent("AMRLoadVideoBuffer","Success");case 21:this._videoFacadeEvents.on("amrLogEvent",(e,t,n)=>{this._emitAMREvent(e,t,n)});case 22:return e.next=24,this._bindToStream(t,f);case 24:return d||this._triggerVideoElementCreated(),N(f),p=w(this._videoElementFacade,5e3),e.next=29,this._waitForVideoResolution(t);case 29:return r.debug("Waiting for video to be playing"),e.next=32,p;case 32:r.debug("Video is playing"),N(f),l&&(l.remove&&l.remove(),l=null);case 35:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),t.bindAudioTrackOnly=function(){this._videoElementFacade&&this._videoElementFacade.bindAudioTrackOnly()},t.destroyVideo=function(){this._videoElementFacade&&(this._videoElementFacade.destroy(),this._videoElementFacade=null)},t.video=function(){return this._videoElementFacade},t.showPoster=function(e){return void 0===e?!R.isDisplayNone(this._posterContainer):(this._showPoster=e,R[e?"show":"hide"](this._posterContainer),this.showPoster())},t.poster=function(e){return void 0===e?R.css(this._posterContainer,"backgroundImage"):(this._poster=e,R.css(this._posterContainer,"backgroundImage",`url(${e})`),this.poster())},t.loading=function(e){return void 0===e?this._loading:(this._loading=Boolean(e),this._container&&this._container.classList[e?"add":"remove"]("OT_loading"),this.loading())},t.audioOnly=function(e){return void 0===e?this._audioOnly:(this._audioOnly=e,this._container&&this._container.classList[e?"add":"remove"]("OT_audio-only"),this.audioOnly())},t.domId=function(){return this._container&&this._container.getAttribute("id")},t.setSinkId=function(e){if(this._videoElementFacade)return this._videoElementFacade.setSinkId(e)},(0,a.default)(e,[{key:"domElement",get:function(){return this._container}},{key:"videoElement",get:function(){return this._videoElementFacade&&this._videoElementFacade.domElement()||void 0}},{key:"width",get:function(){return this.videoElement&&this.videoElement.offsetWidth}},{key:"height",get:function(){return this.videoElement&&this.videoElement.offsetHeight}}]),e}()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CancellationError=t.default=void 0;var r=o(n(684)),i=o(n(308));function o(e){return e&&e.__esModule?e:{default:e}}t.default=r.default,t.CancellationError=i.default},function(e,t,n){"use strict";(function(t){const r=n(22);e.exports=()=>t.all(r.subscribers.where().map(e=>{if(e.isAudioBlocked())return e._.unblockAudio()}))}).call(this,n(2))},function(e,t,n){"use strict";e.exports=e=>"P2P"===e?"RELAYED":"ROUTED"},function(e,t,n){"use strict";(function(t){var r=n(1),i=r(n(4)),o=r(n(5)),a=r(n(703)),s=r(n(704)),c=r(n(75)),u=n(29),d=r(n(705)),l=r(n(707));const f=n(58),p=n(148),h=n(9),m=n(57),g=n(61),v=n(276),y=n(48),b=n(51),S=n(709),E=n(16),_=n(259),T=n(195),R=n(166),I=R.CancellationError,w=R.default,C=n(3),O=n(318),A=n(76),x=n(26),k=n(6),N=n(108),L=n(128),M=n(21),V=n(74),P=n(155),D=n(719),Z=n(165)(),j=n(720),W=n(721),G=n(167),F=n(20)().getInputMediaDevices,U=n(722),X=n(270),B=n(316),H=n(723),Y=n(724),J=n(293),z=J.setVideoContentHint,K=J.getVideoContentHint,Q=n(168),q=n(317);e.exports=function(e){void 0===e&&(e={});let r=e,R=(0,s.default)({},((0,a.default)(r),r));["processPubOptions"].forEach(e=>{p(R[e],e+" dependency must be injected into Publisher")});const J=R.AnalyticsHelper||M,$=R.createAudioFallbackCoordinator||d.default,ee=R.calculateCapableSimulcastStreams||n(252),te=R.createChromeMixin||n(282)(),ne=R.deviceHelpers||n(20)(),re=R.EnvironmentLoader||n(147),ie=R.Errors||n(7),oe=R.Events||n(24)(),ae=R.ExceptionCodes||n(10),se=R.interpretPeerConnectionError||n(162)(),ce=R.IntervalRunner||V,ue=R.logging||n(0)("Publisher"),de=R.Microphone||n(294)(),le=R.otError||n(13)(),fe=R.OTErrorClass||n(23),pe=R.OTHelpers||n(8),he=R.parseIceServers||n(103).parseIceServers,me=R.PUBLISH_MAX_DELAY||n(267),ge=R.PublisherPeerConnection||n(298)(),ve=R.PublishingState||n(307)(),ye=R.StreamChannel||n(150),be=R.systemRequirements||n(153),Se=R.VideoOrientation||n(151)(),Ee=R.WidgetView||Z,_e=R.global||(void 0!==typeof window?window:global),Te=R.createSendMethod||n(314),Re=R.MediaProcessor||n(725),Ie=n(730),we=R.shouldLogMediaProcessorEvents||n(731),Ce=n(319),Oe=R.processPubOptions,Ae=R.KEEP_SENDING_MEDIA_AFTER_TRANSITIONED||5e3,xe=R.KEEP_SENDING_MEDIA_TO_KEEP_ALIVE||3e3,ke=R.KEEP_SENDING_RTCP_DELAY||3e4;return function(e){var n=this;void 0===e&&(e={});let r=k({});const a=new T,s=new q;let d=!1;const p=e=>a.get(e);k(this);const R=P();let M,V,Z,Ne=new J;be.check()||be.upgrade();const Le={};let Me,Ve,Pe,De,Ze,je,We,Ge,Fe,Ue,Xe,Be,He,Ye,Je,ze=!1;const Ke={},Qe={};let qe,$e,et,tt=!1;const nt=()=>this.session||et||{isConnected:()=>!1},rt=[],it=new Re;function ot(){return{connectionId:nt().isConnected()?nt().connection.connectionId:null,streamId:V,widgetType:"Publisher"}}this.once("publishComplete",e=>{var t;e||(ze=!0,Xe=null!=(t=this.session)&&t.sessionInfo.p2pEnabled?"P2P":"MANTIS")}),this.on("sourceStreamIdChanged",e=>{Xe=e,s.finishTransitionTo(Xe)}),this.on("audioAcquisitionProblem",e=>{let t=e.method;Ot("publisher:audioAcquisitionProblem","Event",{didPublishComplete:ze,method:t})});const at=e=>{const t=Object.keys(ie).map(e=>ie[e]),n=le(t.indexOf(e.name)>-1?e.name:ie.MEDIA_ERR_ABORTED,e,ae.UNABLE_TO_PUBLISH);ue.error(`onStreamAvailableError ${n.name}: ${n.message}`),Pe.set("Failed"),M&&(M.destroy(),M=null);const r={failureReason:"GetUserMedia",failureCode:ae.UNABLE_TO_PUBLISH,failureMessage:"OT.Publisher failed to access camera/mic: "+n.message};xt("Failure",{},r),fe.handleJsException({error:n,errorMsg:r.failureReason,code:r.failureCode,target:this,analytics:Ne}),this.trigger("publishComplete",n)},st=e=>{const t=m(e);t.code=ae.UNABLE_TO_PUBLISH,ue.error("OT.Publisher.onScreenSharingError "+t.message),Pe.set("Failed"),t.message="Screensharing: "+t.message,this.trigger("publishComplete",t),xt("Failure",{},{failureReason:"ScreenSharing",failureMessage:t.message}),M&&(M.destroy(),M=null)},ct=e=>{const t=m(e);let n;try{n=window.self!==window.top}catch(e){}"https:"!==(void 0!==typeof window?window:global).location.protocol&&(bt?t.message+=" Note: https:// is required for screen sharing.":X()&&"localhost"!==pe.env.hostName&&(t.message+=` Note: ${pe.env.name} requires HTTPS for camera and microphone access.`)),n&&!bt&&(t.message+=" Note: Check that the iframe has the allow attribute for camera and microphone"),ue.error(t.message),Pe.set("Failed"),t.message="OT.Publisher Access Denied: Permission Denied: "+t.message,t.code=ae.UNABLE_TO_PUBLISH,M&&(M.destroy(),M=null),xt("Cancel",{reason:"AccessDenied"}),this.trigger("publishComplete",t),this.dispatchEvent(new L(x.ACCESS_DENIED))},ut=e=>{throw e instanceof Error||/^\[object .*Error\]$/.test(Object.prototype.toString.call(e))||(e=new Error("Unknown error has occurred. Stream is not available.")),e.name===ie.USER_MEDIA_ACCESS_DENIED||e.name===ie.NOT_SUPPORTED&&e.originalMessage.match(/Only secure origins/)?ct(e):Oe.isScreenSharing?st(e):at(e),e},dt=()=>{Ot("accessDialog","Opened"),this.dispatchEvent(new L(x.ACCESS_DIALOG_OPENED,!0))},lt=()=>{Ot("accessDialog","Closed"),this.dispatchEvent(new L(x.ACCESS_DIALOG_CLOSED,!1))},ft=E(),pt={};let ht=!1,mt={},gt=!1,vt=Oe(e,"OT.Publisher",()=>Pe&&Pe.isDestroyed());vt.on({accessDialogOpened:dt,accessDialogClosed:lt});const yt=vt,bt=yt.isScreenSharing,St=yt.isCustomAudioTrack,Et=yt.isCustomVideoTrack,_t=yt.shouldAllowAudio,Tt=yt.properties,Rt=yt.getUserMedia;function It(e){e.forEach(e=>e())}Object.defineProperty(this,"loudness",{writable:!1,value:void 0,configurable:!0});const wt=(e,t,n)=>e.addEventListener?(e.addEventListener(t,n),()=>e.removeEventListener(t,n)):()=>{};(function(){const e=[];r.on("streamDestroy",()=>It(e)),r.on("streamChange",()=>{It(e);const t=Z.getAudioTracks().map(e=>wt(e,"ended",()=>{gt=!0,this.trigger("audioAcquisitionProblem",{method:"trackEndedEvent"})}));e.splice(0,e.length,...t)})}).call(this),function(){const e=[];r.on("streamDestroy",()=>It(e)),r.on("streamChange",()=>{It(e),Ct()||Z.getTracks().forEach(t=>{t.addEventListener&&(e.push(wt(t,"mute",()=>{ln()})),e.push(wt(t,"unmute",()=>{ln()})))})})}();const Ct=()=>{if(bt)return!0;const e=["text","detail"].includes(Tt.videoContentHint);return Et&&e},Ot=e.logAnalyticsEvent||((e,t,n,r,i)=>{let o=h({action:e,variation:t,payload:n},ot(),r);"Failure"===t&&(o=h(mt,o)),mt=y(o,"sessionId","connectionId","partnerId"),Ne.logEvent(o,i)}),At=()=>{if(!we(this.session))return void it.disableLogging();const e=this.session.apiKey;it.enableLogging(e)},xt=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n={}),"Non-fatal"!==n.failureReason&&("Attempt"===e&&(Ze=(new Date).getTime(),$e&&($e.stop(),ue.error("_connectivityAttemptPinger should have been cleaned up")),$e=new ce(()=>{Ot("Publish","Attempting",t,Object.assign({},ot(),n))},.2,6)),"Failure"===e||"Success"===e||"Cancel"===e?($e?($e.stop(),$e=void 0):ue.warn(`Received connectivity event: "${e}" without "Attempt"`),Ot("Publish",e,Object.assign({videoInputDevices:We,audioInputDevices:je,videoInputDeviceCount:We?We.length:void 0,audioInputDeviceCount:je?je.length:void 0,selectedVideoInputDeviceId:Ge,selectedAudioInputDeviceId:Fe},t),Object.assign({attemptDuration:(new Date).getTime()-Ze},n))):Ot("Publish",e,t,n))},kt=(e,t)=>{Ot("ICERestart",e,t)},Nt=(e,t,n)=>{"Attempt"===t?(Ke[e]=(new Date).getTime(),Ot(e,t,n)):"Failure"!==t&&"Success"!==t||Ot(e,t,n,{attemptDuration:(new Date).getTime()-Ke[e]})},Lt=function(e,t){void 0===t&&(t={}),Nt("RoutedToRelayedTransition",e,t)},Mt=function(e,t){void 0===t&&(t={}),Nt("RelayedToRoutedTransition",e,t)},Vt=b(()=>{Ot("GetStats","Called")}),Pt=b(()=>{Ot("GetRtcStatsReport","Called")}),Dt=t=>{let n=t.parsedStats,r=t.simulcastEnabled,i=t.remoteConnectionId,o=t.peerId,a=t.sourceStreamId;const s={peerId:o,widgetType:"Publisher",connectionId:this.session&&this.session.isConnected()?this.session.connection.connectionId:null,streamId:V,width:M.width,height:M.height,audioTrack:Z&&Z.getAudioTracks().length>0,hasAudio:dn(),publishAudio:Tt.publishAudio,videoTrack:Z&&Z.getVideoTracks().length>0,hasVideo:un(),publishVideo:Tt.publishVideo,audioSource:St?"Custom":void 0,duration:Me?Math.round(((new Date).getTime()-Me.getTime())/1e3):0,remoteConnectionId:i,scalableVideo:r,sourceStreamId:Q(a)};let c=(bt&&Et?"Screen":bt&&e.videoSource)||Et&&"Custom"||Tt.constraints.video&&"Camera"||null;v(c)&&(c=S(c)),s.videoSource=c;const u={videoWidth:this.videoWidth(),videoHeight:this.videoHeight()},d=h({},s,n,u);Ne.logQOS(d),this.trigger("qos",d)},Zt=()=>{var e,t;let n=(null==(e=Tt.videoDimensions)?void 0:e.width)||640,r=(null==(t=Tt.videoDimensions)?void 0:t.height)||480;if(Tt.publishVideo){var i;const e=null==(i=M)?void 0:i.video();n=(null==e?void 0:e.videoWidth())||n,r=(null==e?void 0:e.videoHeight())||r}return{width:n,height:r}},jt=()=>{Pe.isDestroyed()?M&&M.destroyVideo():(ue.debug("OT.Publisher.onLoaded; resolution:",`${this.videoWidth()}x${this.videoHeight()}`),Pe.set("MediaBound"),G().catch(ue.error),M.loading(!!this.session&&!this.stream),ht=!0)},Wt=e=>{const t=le(ie.CONNECT_FAILED,e,ae.P2P_CONNECTION_FAILED);t.message="OT.Publisher PeerConnection Error: "+t.message,xt("Failure",{},{failureReason:"PeerConnectionError",failureCode:t.code,failureMessage:t.message}),Pe.set("Failed"),this.trigger("publishComplete",t),fe.handleJsException({error:t,target:this,analytics:Ne})},Gt=()=>{Z&&(r.emit("streamDestroy"),_e.MediaStreamTrack&&_e.MediaStreamTrack.prototype.stop?Z.getTracks().forEach(e=>e.stop()):Z.stop())},Ft=()=>{const e=C.isiOS&&C.iOSVersion>=15&&C.iOSVersion<15.2,t=Z.getVideoTracks()[0];e&&t&&document.addEventListener("visibilitychange",()=>{!document.hidden&&M&&M.rebindSrcObject()})},Ut=()=>{const e=C.isiOS&&C.iOSVersion>=13.3,t=Z.getAudioTracks()[0];e&&t&&(t.onmute=()=>Jn(t),t.onunmute=()=>zn(t))},Xt=function(){var e=(0,o.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={muted:!0},M){e.next=3;break}throw new Error("Cannot bind video after widget view has been destroyed");case 3:return e.abrupt("return",M.bindVideo(Z,t));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Bt=function(){var e=(0,o.default)(i.default.mark((function e(t){var o;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ue.debug("OT.Publisher.onStreamAvailable"),Pe.set("BindingMedia"),void 0!==Tt.videoContentHint&&z(t,Tt.videoContentHint),Gt(),Z=t,!Tt.videoFilter){e.next=14;break}return e.prev=6,e.next=9,n.applyVideoFilter(Tt.videoFilter);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(6),ue.error("Error applying video filter: "+e.t0);case 14:r.emit("streamChange"),Ut(),Ft(),Ge=(o=(e,t)=>{let n;return e.forEach(e=>{if(e.deviceId)n=e.deviceId.toString();else if(e.label&&t){const r=g(t,t=>t.label===e.label);r&&(n=r.deviceId)}}),n})(Z.getVideoTracks(),We),Fe=o(Z.getAudioTracks(),je),Ve=new de(Z,!Tt.publishAudio),On(),In(),n.accessAllowed=!0,n.dispatchEvent(new L(x.ACCESS_ALLOWED,!1));case 25:case"end":return e.stop()}}),e,null,[[6,11]])})));return function(t){return e.apply(this,arguments)}}(),Ht=e=>{let t,n;ue.error("OT.Publisher.onPublishingTimeout"),gt?(t=ie.CHROME_MICROPHONE_ACQUISITION_ERROR,n="Unable to publish because your browser failed to get access to your microphone. You may need to fully quit and restart your browser to get it to work. See https://bugs.chromium.org/p/webrtc/issues/detail?id=4799 for more details."):(t=ie.TIMEOUT,n="Could not publish in a reasonable amount of time");const r={failureReason:"ICEWorkflow",failureCode:ae.UNABLE_TO_PUBLISH,failureMessage:"OT.Publisher failed to publish in a reasonable amount of time (timeout)"};xt("Failure",{},r),fe.handleJsException({errorMsg:r.failureReason,code:r.failureCode,target:this,analytics:Ne}),e.isConnected()&&this.streamId&&e._.streamDestroy(this.streamId),this.disconnect(),this.session=null,Pe.isDestroyed()||Pe.set("MediaBound"),this.trigger("publishComplete",le(t,new Error(n),ae.UNABLE_TO_PUBLISH))},Yt=e=>{const t=le(ie.MEDIA_ERR_DECODE,e,ae.UNABLE_TO_PUBLISH);t.message="OT.Publisher while playing stream: "+t.message,ue.error("OT.Publisher.onVideoError:",t),Ot("stream",null,{reason:t.message});const n=Pe.isAttemptingToPublish();Pe.set("Failed"),n?this.trigger("publishComplete",t):this.trigger("error",t.message),fe.handleJsException({error:t,target:this,analytics:Ne})};this._setWebRTCStream=e=>{Z=e},this._setCurrentVideoFilter=e=>{Ln=e},this._getCurrentVideoFilter=()=>Ln,this._getMediaProcessor=()=>it,this._removePeerConnection=e=>{var t;if(!e)return;const n=p(e).peerConnectionId;delete pt[n],e.destroy(),null==(t=Dn)||t.onPeerConnectionDisconnected()},this._removeSubscriber=e=>{this.session.sessionInfo.isAdaptiveEnabled&&"P2P"===Xe&&this._.startRelayedToRoutedTransition(),tn(e).then(e=>{e.forEach(e=>this._removePeerConnection(e))})};const Jt=e=>{const t=p(e),n=t.remoteSubscriberId,r=t.peerConnectionId;ue.debug("Subscriber has been disconnected from the Publisher's PeerConnection"),Ot("disconnect","PeerConnection",{subscriberConnection:r}),this._removeSubscriber(n)},zt=function(){var e=(0,o.default)(i.default.mark((function e(t,r){var o,a,s,c,u,d,l,f,h,m;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r.reason,a=r.prefix,s=n.session&&n.session.sessionInfo,!("ICEWorkflow"===a&&s&&s.reconnection&&ht)){e.next=5;break}return ue.debug("Ignoring peer connection failure due to possibility of reconnection."),e.abrupt("return");case 5:return c=p(t)||{},u=c.remoteConnectionId,d=void 0===u?"(not found)":u,l=c.peerConnectionId,f=se(void 0,o,a,d,"Publisher"),h={hasRelayCandidates:t&&t.hasRelayCandidates()},m={failureReason:a||"PeerConnectionError",failureCode:f.code,failureMessage:f.message},Pe.isPublishing()?m.reason="Non-fatal":n.trigger("publishComplete",f),xt("Failure",h,m),fe.handleJsException({errorMsg:"OT.Publisher PeerConnection Error: "+o,code:f.code,target:n,analytics:Ne}),e.next=14,pt[l];case 14:e.sent.destroy(),delete pt[l];case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Kt=e=>this.session.sessionInfo.isAdaptiveEnabled&&"P2P"===e.getSourceStreamId(),Qt=function(){var e=(0,o.default)(i.default.mark((function e(t,r){var o,a,s,c,u;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.session.sessionInfo.isAdaptiveEnabled,a=r.getSourceStreamId(),Qe[a]=t,"disconnected"===t&&setTimeout(()=>{const e=n.session._.isSocketReconnecting,t=n.session._.getSocket().is("connected")&&!e();if("disconnected"===Qe[a]&&t){const e=p(r).remoteConnectionId;kt("Attempt",{remoteConnectionId:e}),r.iceRestart()}},2e3),"connected"!==t){e.next=14;break}if(clearTimeout(qe),!o){e.next=14;break}return e.next=9,on();case 9:return s=e.sent.iceConnectionStateIsConnected(),e.next=12,an();case 12:c=e.sent.iceConnectionStateIsConnected(),s&&c&&gn();case 14:if("failed"!==t){e.next=21;break}if(u=n.session._.isSocketReconnecting,n.session._.getSocket().is("connected")&&!u()){e.next=20;break}return e.abrupt("return");case 20:o&&a===Xe&&"P2P"===a?n._.startRelayedToRoutedTransition():qe=setTimeout(()=>{n.session._.streamDestroy(n.streamId,a)},5e3);case 21:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),qt=e=>{e.setP2PMaxBitrate(),e.startEncryption(this.session.connection.id),Kt(e)&&Lt("Success")},$t=n=>{let r=n.peerConnectionId,i=n.send,o=n.log,a=n.logQoS,s=n.sourceStreamId;if(nn(r))return t.reject(new Error("PeerConnection already exists"));const c=ee({isChromiumEdge:pe.env.isChromiumEdge,browserName:pe.env.name,isScreenSharing:bt,isCustomVideoTrack:Et,sessionInfo:this.session.sessionInfo,constraints:Tt.constraints,videoDimensions:Zt(),capableSimulcastScreenshare:Tt.capableSimulcastScreenshare,scalableVideo:Tt.scalableVideo});return pt[r]=t.all([this.session._.getIceConfig(),this.session._.getVideoCodecsCompatible(Z)]).then(n=>{let r=n[0],u=n[1],d=Z;if(!u){d=Z.clone();const e=d.getVideoTracks()[0];e&&(e.stop(),d.removeTrack(e))}const l=new ge({iceConfig:r,sendMessage:(e,t)=>{"offer"===e&&this.trigger("connected"),i(e,t)},webRTCStream:d,channels:Tt.channels,capableSimulcastStreams:c,overrideSimulcastEnabled:e._enableSimulcast,logAnalyticsEvent:o,offerOverrides:{enableDtx:Tt.enableDtx,enableStereo:Tt.enableStereo,audioBitrate:Tt.audioBitrate,priorityVideoCodec:Tt._priorityVideoCodec||this.session.sessionInfo.priorityVideoCodec,codecFlags:Tt._codecFlags||this.session._.getCodecFlags()},answerOverrides:this.session.sessionInfo.p2pEnabled?void 0:{audioBitrate:Tt.audioBitrate},sourceStreamId:s,isP2pEnabled:this.session.sessionInfo.p2pEnabled,sessionId:this.session.id,keyStore:this.session.keyStore,sFrameClientStore:this.session.sFrameClientStore,isE2ee:this.session._.isE2ee(),audioFallbackEnabled:Tt.publisherAudioFallbackEnabled,resolution:{width:this.videoWidth(),height:this.videoHeight()}});return l.on({disconnected:()=>Jt(l),error:e=>{let t=e.reason,n=e.prefix;return zt(l,{reason:t,prefix:n})},qos:a,iceRestartSuccess:()=>(e=>{const t=p(e).remoteConnectionId;kt("Success",{remoteConnectionId:t})})(l),iceRestartFailure:()=>(e=>{const t=p(e).remoteConnectionId;kt("Failure",{reason:"ICEWorkflow",message:"OT.Publisher PeerConnection Error: The stream was unable to connect due to a network error. Make sure your connection isn't blocked by a firewall.",remoteConnectionId:t})})(l),iceConnectionStateChange:e=>Qt(e,l),audioAcquisitionProblem:()=>{gt=!0,this.trigger("audioAcquisitionProblem",{method:"getStats"})},audioFallbackStateChange:e=>{var t,n,r;return Dn.onPeerConnectionStateChange(Object.assign({},e,{peerConnection:l,publishVideo:Tt.publishVideo,stream:this.stream,connectionId:null==(t=this.session)||null==(n=t.connection)?void 0:n.connectionId,sessionId:null==(r=this.session)?void 0:r.sessionId,peerId:p(l).peerId}))}}),l.once("connected",()=>qt(l)),new t((e,t)=>{const n=e=>{t(e)};l.once("error",n),l.init(De,r=>{if(r)return t(r);l.off("error",n),e(l)})})}),nn(r)},en=()=>t.all(Object.keys(pt).map(nn)),tn=e=>en().then(t=>t.filter(t=>p(t).remoteSubscriberId===e)),nn=e=>pt[e],rn=e=>{const t=Object.keys(pt).find(t=>t.endsWith("~"+e));return pt[t]},on=()=>rn("MANTIS"),an=()=>rn("P2P");let sn=te(this,{name:Tt.name,publishAudio:Tt.publishAudio,publishVideo:Tt.publishVideo,audioSource:Tt.audioSource,showControls:Tt.showControls,shouldAllowAudio:_t,logAnalyticsEvent:Ot});const cn=()=>{this.off("publishComplete",ln),sn&&sn.reset(),R.releaseAll(),this.disconnect(),Ve=null,Gt(),Z=null,M&&(M.destroy(),M=null),this.session&&this._.unpublishFromSession(this.session,"reset"),it.getVideoFilter()&&An(),this.id=null,this.stream=null,ht=!1,this.session=null,Pe.isDestroyed()||Pe.set("NotPublishing")},un=()=>{if(!Z||0===Z.getVideoTracks().length)return!1;const e=["text","detail"].includes(Tt.videoContentHint),t=Et&&e,n=pe.env.isChromium&&(bt||t);return Z.getVideoTracks().reduce((e,t)=>e&&(!t.muted||!!n)&&t.enabled&&"ended"!==t.readyState,Tt.publishVideo)},dn=()=>!(!Z||0===Z.getAudioTracks().length)&&Z.getAudioTracks().length>0&&Z.getAudioTracks().reduce((e,t)=>e&&!t.muted&&t.enabled&&"ended"!==t.readyState,Tt.publishAudio),ln=e=>{if(M&&(M.audioOnly(!un()),M.showPoster(!un())),sn&&sn.setAudioOnly(!un()&&dn()),this.stream){let t;tt&&un()&&(t=u.CongestionLevels.LOW,tt=!1),this.stream.setChannelActiveState("audio",dn(),e),this.stream.setChannelActiveState("video",un(),e,t)}else this.off("publishComplete",ln),this.once("publishComplete",ln)},fn=(e,n)=>{let r=!1;if("function"==typeof e?n=e:r="rtcStatsReport"===e,r?Pt():Vt(),!r||B)en().then(e=>{if(0===e.length){const e=ae.PEER_CONNECTION_NOT_CONNECTED;throw le(ie.PEER_CONNECTION_NOT_CONNECTED,new Error(fe.getTitleByCode(e)),e)}return e}).then(e=>this.session.sessionInfo.isAdaptiveEnabled?e.filter(e=>e.getSourceStreamId()===Xe):e).then(e=>t.all(e.map(e=>O(r?e.getRtcStatsReport.bind(e):e.getStats.bind(e))().then(t=>({pc:e,stats:t}))))).then(e=>{const t=Me?Me.getTime():Date.now(),i=e.map(e=>{let n=e.pc,i=e.stats;const o=p(n),a=o.remoteConnectionId,s=o.remoteSubscriberId;return h(a.match(/^symphony\./)?{}:{subscriberId:s,connectionId:a},r?{rtcStatsReport:i}:{stats:A.normalizeStats(i,!1,t)})});n(null,i)}).catch(n);else{const e=ae.GET_RTC_STATS_REPORT_NOT_SUPPORTED;n(le(ie.GET_RTC_STATS_REPORT_NOT_SUPPORTED,new Error(fe.getTitleByCode(e)),e))}},pn=(e,t)=>{const n={name:Tt.name||"",streamId:this.streamId,subscriberAudioFallbackEnabled:Tt.subscriberAudioFallbackEnabled,channels:rt,minBitrate:Tt.minVideoBitrate,sourceStreamId:e,e2ee:this.session._.isE2ee(),publisherAudioFallbackEnabled:Tt.publisherAudioFallbackEnabled,customProperties:{initials:Tt.initials}};this.session._.streamCreate(n,t)},hn=e=>{d||(d=!0,Z.getAudioTracks().forEach(function(){var t=(0,o.default)(i.default.mark((function t(n){var r;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=n.clone()).enabled=!1,t.prev=2,t.next=5,e.findAndReplaceTrack(n,r);case 5:t.next=10;break;case 7:return t.prev=7,t.t0=t.catch(2),t.abrupt("return");case 10:Le[n.id]=r;case 11:case"end":return t.stop()}}),t,null,[[2,7]])})));return function(e){return t.apply(this,arguments)}}()))},mn=e=>{Z.getAudioTracks().forEach(function(){var t=(0,o.default)(i.default.mark((function t(n){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.findAndReplaceTrack(Le[n.id],n);case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return");case 8:delete Le[n.id];case 9:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(e){return t.apply(this,arguments)}}()),d=!1},gn=function(){var e=(0,o.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return He=!1,e.next=3,on();case 3:if(!(t=e.sent)){e.next=18;break}return n.trigger("sourceStreamIdChanged","P2P"),Tt.publisherAudioFallbackEnabled&&t.disableCongestionLevelEstimation(),e.next=9,N(Ae);case 9:if(!He){e.next=12;break}return ue.debug("Cancelling stop sending RTP to MANTIS."),e.abrupt("return");case 12:return hn(t),e.next=15,t.changeMediaDirectionToInactive();case 15:if(!(pe.env.isFirefox&&pe.env.version<96)){e.next=18;break}return e.next=18,yn();case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),vn=function(){var e=(0,o.default)(i.default.mark((function e(){var t,r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return He=!0,e.next=3,on();case 3:if(!(t=e.sent)){e.next=22;break}return mn(t),e.next=8,t.changeMediaDirectionToRecvOnly();case 8:if(Be&&clearTimeout(Be),n.trigger("sourceStreamIdChanged","MANTIS"),!Tt.publisherAudioFallbackEnabled){e.next=22;break}return e.t0=t,e.next=14,an();case 14:if(e.t1=r=e.sent,null!=e.t1){e.next=19;break}e.t2=void 0,e.next=20;break;case 19:e.t2=r.getAudioFallbackState();case 20:e.t3=e.t2,e.t0.enableCongestionLevelEstimation.call(e.t0,e.t3);case 22:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),yn=function(){var e=(0,o.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,on();case 2:(t=e.sent)&&(Be=setTimeout((0,o.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("P2P"!==Xe){e.next=9;break}return e.next=3,t.changeMediaDirectionToRecvOnly();case 3:return e.next=5,N(xe);case 5:return e.next=7,t.changeMediaDirectionToInactive();case 7:return e.next=9,yn();case 9:case"end":return e.stop()}}),e)}))),ke));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),bn=()=>{Lt("Attempt");const e=e=>{const t=Y(e);this.trigger("streamCreateForP2PComplete",t),Lt("Failure",{reason:t.message})};if(!this.session)return void Lt("Failure",{reason:"Not connected to the session."});const t=setTimeout(()=>{Lt("Failure",{reason:"Timeout"})},me);this.once("streamCreateForP2PComplete",()=>{clearTimeout(t)}),ue.debug("streamCreateWithSource: send a message to RUMOR for creating the stream with the sourceStreaId P2P and stream "+this.streamId),pn("P2P",t=>{t?e(t):this.trigger("streamCreateForP2PComplete")})},Sn=function(){var e=(0,o.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("P2P"===Xe){e.next=2;break}return e.abrupt("return");case 2:if(Mt("Attempt"),n.session){e.next=6;break}return Mt("Failure",{reason:"Not connected to the session."}),e.abrupt("return");case 6:if(n.streamId){e.next=9;break}return Mt("Failure",{reason:"No streamId available"}),e.abrupt("return");case 9:return e.next=11,vn();case 11:return n.session._.streamDestroy(n.streamId,"P2P"),e.t0=n,e.next=15,an();case 15:e.t1=e.sent,e.t0._removePeerConnection.call(e.t0,e.t1),Mt("Success"),n.trigger("streamDestroyForP2PComplete");case 19:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();this.publish=e=>(ue.debug("OT.Publisher: publish"),(Pe.isAttemptingToPublish()||Pe.isPublishing())&&cn(),Pe.set("GetUserMedia"),Tt.style&&this.setStyle(Tt.style,null,!0),Tt.classNames="OT_root OT_publisher",re.onLoad(()=>{ue.debug("OT.Publisher: publish: environment loaded"),M=new Ee(e,Object.assign({},Tt,{widgetType:"publisher"})),_t&&j({publisher:this,widgetView:M}),M.on("error",Yt),this.id=M.domId(),this.element=M.domElement,this.element&&sn&&sn.init(M),M.on("videoDimensionsChanged",(e,t)=>{Tt.publishVideo&&(this.stream&&this.stream.setVideoDimensions(t.width,t.height),this.dispatchEvent(new oe.VideoDimensionsChangedEvent(this,e,t)))}),M.on("mediaStopped",e=>{const t=new oe.MediaStoppedEvent(this,e);if(this.dispatchEvent(t),!t.isDefaultPrevented())if(e){const t=String(e.kind).toLowerCase();"audio"===t?In():"video"===t?On():ue.warn("Track with invalid kind has ended: "+e.kind)}else this.session?this._.unpublishFromSession(this.session,"mediaStopped"):this.destroy("mediaStopped")}),M.on("videoElementCreated",e=>{const t=new oe.VideoElementCreatedEvent(e);this.dispatchEvent(t)}),Rt().catch(ut).then(function(){var e=(0,o.default)(i.default.mark((function e(t){var r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return je=vt.audioDevices,We=vt.videoDevices,r=!!Tt.videoFilter,(0,l.default)(n),r&&(Nn=H(t,We)),e.next=7,Bt(t);case 7:return Tt.publishVideo||n._toggleVideo(Tt.publishVideo,Zt()),bt||Et||r||(Nn=H(t,We),Tt.publishVideo&&Xn(Nn)),e.abrupt("return",Xt().catch(e=>{if(!(e instanceof I))throw e}).then(()=>{jt(),Pe.isDestroyed()||(n.trigger("initSuccess"),n.trigger("loaded",n))},e=>{ue.error("OT.Publisher.publish failed to bind video: "+e),Wt(e)}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),this),this._setScalableValues=function(){var e=(0,o.default)(i.default.mark((function e(t,n){var r,o,a;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,en().then(e=>e[0].getSenders().filter(e=>"video"===e.track.kind));case 2:return r=e.sent,o=r[0],(a=o.getParameters()).encodings.forEach((e,r)=>{e[t]=n[r]}),e.next=8,o.setParameters(a);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this._setScalableFramerates=function(){var e=(0,o.default)(i.default.mark((function e(t){var r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=Tn(t))||!En(r)){e.next=4;break}return e.next=4,n._setScalableValues("maxFramerate",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this._setScalableVideoLayers=function(){var e=(0,o.default)(i.default.mark((function e(t){var r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=Tn(t))||!_n(r)){e.next=4;break}return e.next=4,n._setScalableValues("scaleResolutionDownBy",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();const En=e=>{let t=0;return e.every(e=>!(15!==e&&30!==e||e<t||(t=e,0)))},_n=e=>{let t=17;return e.every(e=>!(e<1||e>=t||(t=e,0)))},Tn=e=>{let t;if("string"!=typeof e)return t;const n=e.split(":");return 0===n.length||n.length>3?t:n.every(e=>!isNaN(e))?(t=n.map(e=>parseInt(e,10)).reverse(),t):t},Rn=e=>Z&&Z[`get${_(e)}Tracks`]().length>0&&Z[`get${_(e)}Tracks`]().every(e=>"ended"!==e.readyState),In=e=>{const t=Rn("audio")&&Tt.publishAudio;sn&&sn.setMuted(!t),Ve&&Ve.muted(!t),Je&&Je.originalTrack&&(Je.originalTrack.enabled=t),ln(e)};let wn;this.publishAudio=e=>{Ot("publishAudio","Attempt",{publishAudio:e}),Tt.publishAudio=e;try{In(),Ot("publishAudio","Success",{publishAudio:e})}catch(e){Ot("publishAudio","Failure",{message:e.message})}return this},this.publishCaptions=e=>{Ot("publishCaptions","Attempt");try{r.dispatchEvent(new oe.PublisherCaptionsEnabled(e)),this.stream.setChannelActiveState("data",e),Ot("publishCaptions","Success")}catch(e){Ot("publishCaptions","Failure",{message:e.message})}};let Cn=!1;const On=()=>{const e=Rn("video")&&Tt.publishVideo;if("Chrome"===C.name&&C.version>=69&&(0,o.default)(i.default.mark((function t(){var n,r;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return wn&&wn.cancel(),wn=new w,n=wn,t.next=5,en();case 5:r=t.sent,n.isCanceled()||r.forEach(t=>{t.setVideoActiveState(e)});case 7:case"end":return t.stop()}}),t)})))(),Et&&it){const t=it.getOriginalVideoTrack();t&&(t.enabled=e)}if(Et&&Ye){const t=Ye.originalTrack;t&&(t.enabled=e)}Z&&Z.getVideoTracks().forEach(t=>{t.enabled=e,t.isCreatedCanvas&&(t.enabled=!1)}),ln()},An=function(){var e=(0,o.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=it.getOriginalVideoTrack(),e.prev=1,e.next=4,it.destroy();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),ue.warn("Error cleaning up mediaProcessor: "+e.t0);case 9:t.stop();case 10:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(){return e.apply(this,arguments)}}(),xn=e=>!Ln&&!Ye&&e===Un(),kn=(e,t)=>!(!Ln&&!Ye)||(e?Nn!==t:void 0!==t);let Nn,Ln;this._toggleVideo=W(function(){var e=(0,o.default)(i.default.mark((function e(t,n){var o,a,s,c,u,d,l,f;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(bt||Et||Cn)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Bn();case 4:if(a=e.sent,s=Fn()){e.next=8;break}throw le(ie.NOT_SUPPORTED,new Error("Publisher._toggleVideo cannot toggleVideo when you have no video source."));case 8:if(c=null==(o=a.find(e=>e.label===s.label))?void 0:o.deviceId,kn(t,c)){e.next=11;break}return e.abrupt("return");case 11:if("ended"!==s.readyState){e.next=14;break}return Cn=!0,e.abrupt("return");case 14:if(t&&pe.env.isAndroid&&pe.env.isChrome&&s&&s.stop&&s.stop(),t){e.next=31;break}e.prev=16,u=U(n),e.next=23;break;case 20:return e.prev=20,e.t0=e.catch(16),e.abrupt("return");case 23:if(c&&(Nn=c),Xn(u.label),!(d=it.getVideoFilter())){e.next=30;break}return Ln=d,e.next=30,An();case 30:Ye&&(Ye.destroy(),Ye.stopOriginalTrack());case 31:if(!Nn||-1!==a.findIndex(e=>e.deviceId===Nn)){e.next=33;break}throw le(ie.NO_DEVICES_FOUND,new Error("Previous device no longer available - deviceId not found"));case 33:if(r.emit("streamDestroy"),!t){e.next=64;break}if(!xn(Nn)){e.next=37;break}return e.abrupt("return");case 37:return e.prev=37,e.next=40,Gn(Nn);case 40:u=e.sent,e.next=47;break;case 43:throw e.prev=43,e.t1=e.catch(37),ue.error(`Error getting new track for current device(${Nn}): ${e.t1}`),e.t1;case 47:if(u){e.next=50;break}return ue.error("Failed to enable video. It was not possible to get a new track from the camera"),e.abrupt("return");case 50:if(!Ln){e.next=59;break}return l=it.getOriginalVideoTrack(),e.next=54,it.setVideoFilter(Ln);case 54:return e.next=56,it.setMediaStream(Z);case 56:return e.next=58,it.setVideoTrack(u);case 58:u=e.sent;case 59:if(!Ye){e.next=64;break}return l=Ye.originalTrack,e.next=63,Ye.setTrack(u);case 63:u=e.sent;case 64:return e.prev=64,e.next=67,Wn(s,u);case 67:null==(f=l)||f.stop(),e.next=73;break;case 70:throw e.prev=70,e.t2=e.catch(64),e.t2;case 73:case"end":return e.stop()}}),e,null,[[16,20],[37,43],[64,70]])})));return function(t,n){return e.apply(this,arguments)}}());const Mn=function(){var e=(0,o.default)(i.default.mark((function e(t){var r,o;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(r=sn)||r.videoDisabledIndicator.disableVideo(!1),null==(o=sn)||o.videoDisabledIndicator.setWarning(!1),t===c.default.SUSPENDED_VIDEO?n.trigger("videoEnabled",{reason:"quality"}):n.trigger("videoDisableWarningLifted");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Vn=()=>{var e;Tt.publishVideo&&(null==(e=sn)||e.videoDisabledIndicator.setWarning(!0)),this.trigger("videoDisableWarning")},Pn=function(){var e=(0,o.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Tt.publishVideo&&(null==(t=sn)||t.videoDisabledIndicator.disableVideo(!0)),n.trigger("videoDisabled",{reason:"quality"});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();let Dn;if(Tt.publisherAudioFallbackEnabled){Dn=$({getAllPeerConnections:en,AnalyticsHelper:J});const e={[c.default.ACTIVE_VIDEO]:Mn,[c.default.ACTIVE_VIDEO_WITH_WARNING]:Vn,[c.default.SUSPENDED_VIDEO]:Pn};Dn.on("stateChange",t=>{let n=t.previousState,r=t.state;try{e[r](n)}catch(e){throw ue.error("Audio fallback error: "+e),e}})}this.publishVideo=e=>{if(Tt.publishVideo===e)return this;Ot("publishVideo","Attempt",{publishVideo:e});const t=Zt();var n,r;Tt.publishVideo=e,!1===e&&Tt.publisherAudioFallbackEnabled&&Dn.getState()!==c.default.ACTIVE_VIDEO&&(tt=!0,Dn.reset(),null==(n=sn)||n.videoDisabledIndicator.disableVideo(!1),null==(r=sn)||r.videoDisabledIndicator.setWarning(!1));try{this._toggleVideo(Tt.publishVideo,t),On(),Ot("publishVideo","Success",{publishVideo:e})}catch(e){Ot("publishVideo","Failure",{message:e.message})}return this},this.setVideoContentHint=e=>z(Z,e),this.getVideoContentHint=()=>K(Z),this.destroy=function(e,t){return Pe.isAttemptingToPublish()&&this.session&&xt("Cancel",{reason:"destroy"}),Pe.isDestroyed()||(Pe.set("Destroyed"),cn(),vt&&(vt.off(),vt=null),sn&&(sn.destroy(),sn=null),r&&(r.off(),r=null),!0!==t&&this.dispatchEvent(new oe.DestroyedEvent(x.PUBLISHER_DESTROYED,this,e)),this.off(),Ye&&(Ye.destroy(),Ye.stopOriginalTrack()),Je&&(Je.destroy(),Je.stopOriginalTrack())),this},this.disconnect=()=>{Object.keys(pt).forEach(e=>{const t=nn(e);delete pt[e],t.then(e=>this._removePeerConnection(e))}),rt.length=0},this.processMessage=(e,t,n)=>{const r=f(n,"params.subscriber",t).replace(/^INVALID-STREAM$/,t),i=f(n,"content.peerId"),o=f(n,"content.sourceStreamId","MANTIS"),s=`${r}~${i}~${o}`;ue.debug(`OT.Publisher.processMessage: Received ${e} from ${t} for ${s}`),ue.debug(n);const c=nn(s),u=()=>{const c=Te({socket:this.session._.getSocket(),uri:n.uri,content:{peerId:i,sourceStreamId:o}});$t({peerConnectionId:s,send:c,log:function(e,t,n,r,a){void 0===r&&(r={});const s=Object.assign({peerId:i,sourceStreamId:Q(o)},r);return Ot(e,t,n,s,a)},logQoS:e=>{o===Xe&&Dt(Object.assign({},e,{peerId:i,remoteConnectionId:t,sourceStreamId:o}))},sourceStreamId:o}).then(c=>(((e,t)=>{a.set(e,t)})(c,{remoteConnectionId:t,remoteSubscriberId:r,peerId:i,sourceStreamId:o,peerConnectionId:s}),c.processMessage(e,n),null)).catch(e=>{ue.error("OT.Publisher failed to create a peerConnection",e)})},d=this.session.sessionInfo.isAdaptiveEnabled;switch(e){case"unsubscribe":this._removeSubscriber(r);break;default:if(c)c.then(t=>t.processMessage(e,n));else{if(d&&an())return;u()}}},this.getImgData=function(){if(!ht)return ue.error("OT.Publisher.getImgData: Cannot getImgData before the Publisher is publishing."),null;const e=M&&M.video();return e?e.imgData():null};const Zn=e=>{e.getSenders().forEach(e=>"audio"===e.track.kind&&Z.getAudioTracks().length?e.replaceTrack(Z.getAudioTracks()[0]):"video"===e.track.kind&&Z.getVideoTracks().length?e.replaceTrack(Z.getVideoTracks()[0]):void 0)},jn=function(e){return void 0===e&&(e=Zn),en().then(n=>(n.map(e),t.all([])))};{let e=0;const t=function(){var t=(0,o.default)(i.default.mark((function t(){var n,o,a;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!pe.env.isLegacyEdge&&_e.RTCRtpSender&&"function"==typeof _e.RTCRtpSender.prototype.replaceTrack){t.next=2;break}throw le(ie.UNSUPPORTED_BROWSER,new Error("Publisher#cycleVideo is not supported in your browser."),ae.UNABLE_TO_PUBLISH);case 2:if(!Et&&!bt){t.next=4;break}throw le(ie.NOT_SUPPORTED,new Error("Publisher#cycleVideo: The publisher is not using a camera video source"));case 4:if(Fn()){t.next=7;break}throw le(ie.NOT_SUPPORTED,new Error("Publisher#cycleVideo cannot cycleVideo when you have no video source."));case 7:return e+=1,t.next=10,Bn();case 10:if((n=t.sent).filter(e=>e.deviceId!==Nn).length>0){t.next=14;break}return t.abrupt("return",Nn);case 14:for(;n[e%n.length].deviceId===Nn;)e+=1;return r.emit("streamDestroy"),o=n[e%n.length],a=o.deviceId,t.next=20,tr(a);case 20:return t.abrupt("return",Nn);case 21:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();this.cycleVideo=W((0,o.default)(i.default.mark((function e(){var n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t();case 3:n=e.sent,e.next=10;break;case 6:throw e.prev=6,e.t0=e.catch(0),ue.error("Publisher#cycleVideo: could not cycle video: "+e.t0),e.t0;case 10:return e.abrupt("return",{deviceId:n});case 11:case"end":return e.stop()}}),e,null,[[0,6]])}))))}const Wn=function(){var e=(0,o.default)(i.default.mark((function e(a,s){var c,u,d;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,en();case 2:return c=e.sent,e.next=5,t.all(c.map(function(){var e=(0,o.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.findAndReplaceTrack(a,s);case 2:t.setP2PMaxBitrate();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:if(Z.removeTrack(a),Z.addTrack(s),a&&a.stop){try{u=s instanceof MediaStreamTrackGenerator||Object.getPrototypeOf(s).toString().includes("MediaStreamTrackGenerator")}catch(e){u=!1}u||a.stop()}"Firefox"!==pe.env.name&&"Safari"!==pe.env.name||(n.videoElement().srcObject=null,n.videoElement().srcObject=Z),(d=M&&M.video())&&d.refreshTracks(),r.emit("streamChange"),On();case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Gn=function(){var t=(0,o.default)(i.default.mark((function t(n){var r,o,a,s,c,u,d;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=Un(),Xn(n),(a=m(e)).audioSource=null,a.videoSource=n,vt=Oe(a,"OT.Publisher.getTrackFromDeviceId",()=>Pe&&Pe.isDestroyed()),vt.on({accessDialogOpened:dt,accessDialogClosed:lt}),s=vt.getUserMedia,t.prev=8,t.next=11,s();case 11:c=t.sent,t.next=18;break;case 14:throw t.prev=14,t.t0=t.catch(8),ue.error(t.t0),t.t0;case 18:return u=null==(r=c)?void 0:r.getVideoTracks(),(d=u[0])||Xn(o),t.abrupt("return",d);case 21:case"end":return t.stop()}}),t,null,[[8,14]])})));return function(e){return t.apply(this,arguments)}}(),Fn=()=>Z.getVideoTracks()[0],Un=()=>Ue,Xn=e=>{Ue=e},Bn=function(){var e=(0,o.default)(i.default.mark((function e(){var t,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne.shouldAskForDevices();case 2:if(t=e.sent,n=t.videoDevices,t.video&&n&&n.length){e.next=6;break}throw le(ie.NO_DEVICES_FOUND,new Error("No video devices available"),ae.UNABLE_TO_PUBLISH);case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Hn=function(){var e=(0,o.default)(i.default.mark((function e(n,o){var a,s,c;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,en();case 2:return a=e.sent,e.next=5,t.all(a.map(e=>e.findAndReplaceTrack(n,o)));case 5:o&&Z.addTrack(o),n&&Z.removeTrack(n),(s=M&&M.video())&&s.refreshTracks(),sn&&(o&&!n&&sn.addAudioTrack(),n&&!o&&sn.removeAudioTrack());try{c=o instanceof MediaStreamTrackGenerator||Object.getPrototypeOf(o).toString().includes("MediaStreamTrackGenerator")}catch(e){c=!1}n&&n.stop&&!c&&n.stop(),o&&(In(),Ve=new de(Z,!Tt.publishAudio)),r.emit("streamChange"),ln();case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Yn=function(){var e=(0,o.default)(i.default.mark((function e(t){var r,o;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.getSettings().deviceId,e.prev=1,e.next=4,n.setAudioSource(r);case 4:(o=Z.getAudioTracks()[0])&&(o.onmute=()=>Jn(o),o.onunmute=()=>zn(o)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),ue.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),Jn=e=>{let t=!1;Tt.publishVideo&&document.hidden&&(t=!0,this.publishVideo(!1));const r=function(){var a=(0,o.default)(i.default.mark((function o(){return i.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(document.hidden){i.next=5;break}return i.next=3,Yn(e);case 3:t&&n.publishVideo(!0),document.removeEventListener("visibilitychange",r);case 5:case"end":return i.stop()}}),o)})));return function(){return a.apply(this,arguments)}}();document.addEventListener("visibilitychange",r)},zn=e=>{var t;dn()&&(un()?this.videoElement().pause():Yn(e)),null==this||null==(t=this.session)||t.trigger("gsmCallEnded")},Kn=!(pe.env.isLegacyEdge||!_e.RTCRtpSender||"function"!=typeof _e.RTCRtpSender.prototype.replaceTrack),Qn=()=>le(ie.CANCEL,new Error("Operation did not succeed due to a new request."));let qn;const $n=function(){var t=(0,o.default)(i.default.mark((function t(r){var o,a,s,c,u,d,l,f,p,h,g;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Kn){t.next=2;break}throw le(ie.UNSUPPORTED_BROWSER,new Error("Publisher#setAudioSource is not supported in your browser."));case 2:if(qn&&qn.cancel(),qn=new w,o=qn,a=e=>{if(o.isCanceled())throw e.getTracks(e=>e.stop()),Qn();return $n(e.getAudioTracks()[0])},s=n.getAudioSource()){t.next=7;break}throw le(ie.NOT_SUPPORTED,new Error("Publisher#setAudioSource cannot add an audio source when you started without one."));case 7:if(!(r instanceof MediaStreamTrack)){t.next=26;break}if(!o.isCanceled()){t.next=10;break}throw Qn();case 10:if(!Je){t.next=23;break}return t.prev=11,t.next=14,Je.setTrack(r);case 14:return c=t.sent,t.next=17,Hn(s,c);case 17:return t.abrupt("return",t.sent);case 20:t.prev=20,t.t0=t.catch(11),ue.error("Error setting track on audioMediaProcessorConnector: "+t.t0);case 23:return t.abrupt("return",Hn(s,r));case 26:if("string"!=typeof r){t.next=73;break}return(u=m(e)).audioSource=r,u.videoSource=null,vt=Oe(u,"OT.Publisher.setAudioSource",()=>o.isCanceled()||Pe&&Pe.isDestroyed()),vt.on({accessDialogOpened:dt,accessDialogClosed:lt}),d=s.label,l=s.getConstraints&&s.getSettings().deviceId||void 0,s&&s.stop(),f=vt.getUserMedia,t.prev=36,t.t1=a,t.next=40,f();case 40:return t.t2=t.sent,t.next=43,(0,t.t1)(t.t2);case 43:return t.abrupt("return",t.sent);case 46:if(t.prev=46,t.t3=t.catch(36),!o.isCanceled()){t.next=50;break}throw Qn();case 50:if((p=m(e)).videoSource=null,p.audioSource=l,p.audioSource||!d){t.next=60;break}return t.next=56,F();case 56:if(h=t.sent.find(e=>e.label===d),!o.isCanceled()){t.next=59;break}throw Qn();case 59:h&&(p.audioSource=h.deviceId);case 60:if(p.audioSource){t.next=63;break}throw t.t3.message+=" (could not determine previous audio device)",le(ie.NOT_FOUND,t.t3);case 63:return vt=Oe(p,"OT.Publisher.setAudioSource",()=>o.isCanceled()||Pe&&Pe.isDestroyed()),t.next=66,vt.getUserMedia().catch(e=>{throw e.message+=" (could not obtain previous audio device)",e});case 66:return g=t.sent,t.next=69,a(g);case 69:throw t.t3.message+=" (reverted to previous audio device)",t.t3;case 71:t.next=74;break;case 73:throw le(ie.INVALID_PARAMETER,new Error("Invalid parameter passed to OT.Publisher.setAudioSource(). Expected string or MediaStreamTrack."));case 74:case"end":return t.stop()}}),t,null,[[11,20],[36,46]])})));return function(e){return t.apply(this,arguments)}}();this.setAudioSource=$n,this.getAudioSource=()=>Z&&Z.getAudioTracks().length>0?Z.getAudioTracks()[0]:null;const er=function(){var e=(0,o.default)(i.default.mark((function e(t){var n,r,o;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=le(ie.INVALID_VIDEO_SOURCE,new Error("Invalid video source. Video source must be a valid video input deviceId"),1041),r=le(ie.SET_VIDEO_SOURCE_FAILURE,new Error("You cannot reset the video source on a publisher that does not currently use a camera source."),1040),!pe.env.isLegacyEdge&&_e.RTCRtpSender&&"function"==typeof _e.RTCRtpSender.prototype.replaceTrack){e.next=4;break}throw le(ie.UNSUPPORTED_BROWSER,new Error("setVideoSource is not supported in your browser."),ae.UNABLE_TO_PUBLISH);case 4:if("string"==typeof t){e.next=6;break}throw n;case 6:if(o=!Z||0===Z.getVideoTracks().length,!(Et||bt||o)){e.next=9;break}throw r;case 9:return e.next=11,F();case 11:if(e.sent.find(e=>"videoInput"===e.kind&&e.deviceId===t)){e.next=15;break}throw n;case 15:return e.next=17,tr(t);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();this.setVideoSource=er;const tr=function(){var e=(0,o.default)(i.default.mark((function e(t){var r,o,a,s,c,u;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=Nn,Nn=t,Tt.publishVideo){e.next=4;break}return e.abrupt("return");case 4:if(!xn(t)){e.next=6;break}return e.abrupt("return");case 6:if(a=Fn(),!Tt.publishVideo||!pe.env.isAndroid||!pe.env.isChrome&&!pe.env.isFirefox){e.next=14;break}if(!Ln){e.next=13;break}return s=Ln,e.next=12,An();case 12:Ln=null;case 13:a&&a.stop&&a.stop();case 14:return e.prev=14,e.next=17,Gn(t);case 17:c=e.sent,e.next=25;break;case 20:throw e.prev=20,e.t0=e.catch(14),Nn=o,ue.error(e.t0),e.t0;case 25:if(c){e.next=28;break}return ue.warn("Unable to aquire video track. Moving to next device."),e.abrupt("return");case 28:if(!Ln){e.next=33;break}return u=it.getOriginalVideoTrack(),e.next=32,it.setVideoTrack(c);case 32:c=e.sent;case 33:if(!Ye){e.next=38;break}return u=Ye.originalTrack,e.next=37,Ye.setTrack(c);case 37:c=e.sent;case 38:return e.next=40,Wn(a,c);case 40:if(!s){e.next=43;break}return e.next=43,n.applyVideoFilter(s);case 43:null==(r=u)||r.stop(),Tt.publishVideo&&(Cn=!1);case 45:case"end":return e.stop()}}),e,null,[[14,20]])})));return function(t){return e.apply(this,arguments)}}();var nr;this.getVideoSource=()=>{const e={},t=!Z||0===Z.getVideoTracks().length;return e.track=Z&&Tt.publishVideo&&Z.getVideoTracks()[0]||null,e.deviceId=bt||Et||!Nn?null:Nn,e.type=Et?"custom":bt?"screen":t?null:"camera",e},this._={privateEvents:r,setIceConfig:e=>(0,o.default)(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,en();case 2:t.sent.forEach(t=>t.setIceConfig(e));case 4:case"end":return t.stop()}}),t)})))(),publishToSession:(e,n)=>{n&&(Ne=n),et=e,this.session=e;const r=E();V=r,this.streamId=r,xt("Attempt",{dataChannels:Tt.channels,properties:D(Tt)});const i=new t((e,t)=>{ht?e():(this.once("initSuccess",e),this.once("destroyed",e=>{let n=e.reason,r="";n&&(r=" Reason: "+n),t(new Error("Publisher destroyed before it finished loading."+r))}))});ue.debug("publishToSession: waiting for publishComplete, which is triggered by stream#created from rumor");const o=new t((e,t)=>{this.once("publishComplete",n=>{n?t(n):(this._setScalableFramerates(Tt.scalableFramerates),this._setScalableVideoLayers(Tt.scalableVideoLayers),this.stream&&(this.stream.setChannelActiveState("audio",dn()),this.stream.setChannelActiveState("video",un())),ue.debug("publishToSession: got publishComplete"),e())})}),a=e=>{const t=Y(e);throw xt("Failure",{},{failureReason:"Publish",failureCode:t.code,failureMessage:t.message}),Pe.isAttemptingToPublish()&&this.trigger("publishComplete",t),fe.handleJsException({errorMsg:e.message,code:t.code,target:this,error:e,analytics:Ne}),t};ue.debug("publishToSession: waiting for loaded");const s=i.then(()=>e._.getVideoCodecsCompatible(Z)).then(n=>{if(ue.debug("publishToSession: loaded"),!this.session)return;const r=setTimeout(()=>{Ht(e)},me);this.once("publishComplete",()=>{clearTimeout(r)}),Pe.set("PublishingToSession");const i=n&&M&&M.video(),o=Z.getVideoTracks().length>0,s=null!==Tt.videoSource&&!1!==Tt.videoSource;i&&o&&s&&rt.push(new ye({id:"video1",type:"video",active:Tt.publishVideo,orientation:Se.ROTATED_NORMAL,frameRate:Tt.frameRate,width:this.videoWidth(),height:this.videoHeight(),e2ee:e._.isE2ee(),source:bt?"screen":Et?"custom":"camera",fitMode:Tt.fitMode}));const c=Z.getAudioTracks().length>0,u=null!==Tt.audioSource&&!1!==Tt.audioSource;return u&&c&&rt.push(new ye({id:"audio1",type:"audio",active:Tt.publishAudio})),u&&c&&rt.push(new ye({id:"caption1",type:"data",active:Tt.publishCaptions})),this._.streamChannels=rt,ue.debug("publishToSession: creating rumor stream id"),new t((e,t)=>{pn(null,(n,r,i)=>{n?t(a(n)):e({streamId:r,message:i})})})}).then(e=>{if(void 0===e)return;const t=e.streamId,n=e.message;if(ue.debug("publishToSession: rumor stream id created:",t,"(this is different from stream#created, which requires media to actually be flowing for mantis sessions)"),t!==r)throw new Error("streamId response does not match request");this.streamId=t,De=he(n)}).catch(e=>{throw this.trigger("publishComplete",e),e});return t.all([s,o])},unpublishFromSession:(e,t)=>{if(!this.session||e.id!==this.session.id){if("unpublished"===t){const t=this.session&&this.session.id||"no session";ue.warn(`The publisher ${ft} is trying to unpublish from a session ${e.id} it is not attached to (it is attached to ${t})`)}return this}if(e.isConnected()&&(this.stream||Pe.isAttemptingToPublish())&&e._.streamDestroy(this.streamId),R.releaseAll(),this.disconnect(),Pe.isAttemptingToPublish()){xt("Cancel",{reason:"unpublish"});const e=new Error((()=>{switch(t){case"mediaStopped":return"The video element fired the ended event, indicating there is an issue with the media";case"unpublished":return"The publisher was unpublished before it could be published";case"reset":return"The publisher was reset";default:return"The publisher was destroyed due to "+t}})());this.trigger("publishComplete",le("mediaStopped"===t?ie.MEDIA_ENDED:ie.CANCEL,e))}return this.session=null,Ot("unpublish","Success"),this._.streamDestroyed(t),this},unpublishStreamFromSession:(e,t,n)=>V&&e.id===V?this._.unpublishFromSession(t,n):(ue.warn(`The publisher ${ft} is trying to destroy a stream ${e.id} that is not attached to it (it has ${V||"no stream"} attached to it)`),this),streamDestroyed:e=>{["reset"].indexOf(e)<0&&(Pe.isDestroyed()||Pe.set("MediaBound"));const t=new oe.StreamEvent("streamDestroyed",this.stream,e,!0);this.dispatchEventOnce(t,this.streamId),t.isDefaultPrevented()||this.destroy()},archivingStatus:e=>(sn&&sn.setArchivingStatus(e),e),webRtcStream:()=>Z,switchTracks:()=>(0,o.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Rt().catch(ut);case 3:t=e.sent,e.next=10;break;case 6:throw e.prev=6,e.t0=e.catch(0),ue.error("OT.Publisher.switchTracks failed to getUserMedia: "+e.t0),e.t0;case 10:n=t,Gt(),Z=n,r.emit("streamChange"),Ve=new de(Z,!Tt.publishAudio),e.prev=11,Xt(),e.next=21;break;case 15:if(e.prev=15,e.t1=e.catch(11),!(e.t1 instanceof I)){e.next=19;break}return e.abrupt("return");case 19:throw ue.error("Error while binding video",e.t1),e.t1;case 21:e.prev=21,jn(),e.next=29;break;case 25:throw e.prev=25,e.t2=e.catch(21),ue.error("Error replacing tracks",e.t2),e.t2;case 29:case"end":return e.stop()}var n}),e,null,[[0,6],[11,15],[21,25]])})))(),getDataChannel(e,t,n){const r=nn(Object.keys(pt)[0]);r?r.then(r=>{r.getDataChannel(e,t,n)}):n(new pe.Error("Cannot create a DataChannel before there is a subscriber."))},iceRestart(e){void 0===e&&(e=!1),en().then(t=>{t.forEach(t=>{const n=p(t).remoteConnectionId;kt("Attempt",{remoteConnectionId:n}),ue.debug("Publisher: ice restart attempt"),t.iceRestart(),e&&t.generateOffer()})})},getState:()=>Pe,demoOnlyCycleVideo:this.cycleVideo,testOnlyGetFramesEncoded:()=>(0,o.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,en();case 2:if((t=e.sent).length){e.next=5;break}throw new Error("No established PeerConnections yet");case 5:return e.abrupt("return",t[0]._testOnlyGetFramesEncoded());case 6:case"end":return e.stop()}}),e)})))(),onStreamAvailable:Bt,startRoutedToRelayedTransition:()=>{s.startTransitionTo("P2P"),bn()},startRelayedToRoutedTransition:()=>{s.startTransitionTo("MANTIS",()=>Sn())},forceMuteAudio:function(){Ot("publishAudio","Attempt",{publishAudio:!1}),Tt.publishAudio=!1;try{In("auto"),this.dispatchEvent(new oe.MuteForcedEvent),Ot("publishAudio","Success",{publishAudio:!1})}catch(e){Ot("publishAudio","Failure",{message:e.message})}}.bind(this),setCongestionLevel:(nr=(0,o.default)(i.default.mark((function e(t,n){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Dn){e.next=15;break}if(!n){e.next=8;break}return e.next=4,nn(n);case 4:e.t1=e.sent,e.t0=[e.t1],e.next=11;break;case 8:return e.next=10,en();case 10:e.t0=e.sent;case 11:e.t0.forEach(e=>{e.setCongestionLevel(t)}),e.next=16;break;case 15:ue.warn("Audio Fallback is not enabled");case 16:case"end":return e.stop()}}),e)}))),function(e,t){return nr.apply(this,arguments)})},this.detectDevices=function(){ue.warn("Publisher.detectDevices() is not implemented.")},this.detectMicActivity=function(){ue.warn("Publisher.detectMicActivity() is not implemented.")},this.getEchoCancellationMode=function(){return ue.warn("Publisher.getEchoCancellationMode() is not implemented."),"fullDuplex"},this.setMicrophoneGain=function(){ue.warn("Publisher.setMicrophoneGain() is not implemented.")},this.getMicrophoneGain=function(){return ue.warn("Publisher.getMicrophoneGain() is not implemented."),.5},this.setCamera=function(){ue.warn("Publisher.setCamera() is not implemented.")},this.setMicrophone=function(){ue.warn("Publisher.setMicrophone() is not implemented.")},this.guid=function(){return ft},this.videoElement=function(){const e=M&&M.video();return e?e.domElement():null},this.setStream=e=>{if("PublishingToSession"!==Pe.current)throw new Error("assignStream called when publisher is not successfully publishing");R.releaseAll(),this.stream=e,this.stream.on("destroyed",this.disconnect,this),R.add(()=>{this.stream&&this.stream.off("destroyed",this.disconnect,this)}),Pe.set("Publishing"),M.loading(!ht),Me=new Date,this.dispatchEvent(new oe.StreamEvent("streamCreated",e,null,!1)),xt("Success"),this.trigger("publishComplete",null,this)},this.isWebRTC=!0,this.isLoading=function(){return M&&M.loading()},this.videoWidth=()=>Zt().width,this.videoHeight=()=>Zt().height,this.getStats=function(e){(e=>{fn(e)})((t,n)=>{t?e(t):e(null,n)})},this.getRtcStatsReport=()=>new t((e,t)=>{fn("rtcStatsReport",(n,r)=>{n?t(n):e(r)})}),Pe=new ve(e=>{ue.error("OT.Publisher State Change Failed: ",e.message),ue.debug(e)}),this.accessAllowed=!1,this.applyVideoFilter=function(){var e=(0,o.default)(i.default.mark((function e(t){var r,o,a,s,c;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Ce(t),Ot("applyVideoFilter","Attempt",{videoFilter:r}),e.prev=2,!Ye){e.next=5;break}throw le(ie.NOT_SUPPORTED,new Error("Cannot apply video filter when videoMediaProcessorConnector is set."));case 5:if(Re.isSupported()){e.next=8;break}throw le(ie.NOT_SUPPORTED,new Error("Browser does not support video filters (Insertable Streams and Worker APIs are required)"));case 8:if(it.isValidVideoFilter(t)){e.next=10;break}throw le(ie.INVALID_PARAMETER,new Error("Video filter has invalid configuration"));case 10:if(Z){e.next=15;break}return Ot("applyVideoFilter","Failure",{message:o="Ignoring. No mediaStream"}),ue.warn(o),e.abrupt("return");case 15:if(!bt){e.next=17;break}throw le(ie.INVALID_PARAMETER,new Error("Video filters can not be applied to screen share"));case 17:if(At(),Tt.publishVideo){e.next=22;break}return Ln=t,Ot("applyVideoFilter","Success",{videoFilter:r}),e.abrupt("return");case 22:if(!it.getVideoFilter()){e.next=37;break}if(!it.canUpdateVideoFilter(t.type)){e.next=35;break}return e.prev=24,e.next=27,it.updateVideoFilter(t);case 27:return Ln=t,Ot("applyVideoFilter","Success",{videoFilter:r}),e.abrupt("return");case 32:e.prev=32,e.t0=e.catch(24),ue.warn("Error updating video filter: "+e.t0);case 35:return e.next=37,n.clearVideoFilter();case 37:if(a=Z.getVideoTracks(),s=a[0]){e.next=43;break}return Ot("applyVideoFilter","Failure",{message:o="Ignoring. No video"}),ue.warn(o),e.abrupt("return");case 43:return e.next=45,it.setVideoFilter(t);case 45:return e.next=47,it.setMediaStream(Z);case 47:if(!(c=e.sent)){e.next=51;break}return e.next=51,Wn(s,c);case 51:e.next=58;break;case 53:throw e.prev=53,e.t1=e.catch(2),ue.error("Error applying video filter: "+e.t1),Ot("applyVideoFilter","Failure",{message:e.t1.message}),e.t1;case 58:Ln=t,Ot("applyVideoFilter","Success",{videoFilter:r});case 60:case"end":return e.stop()}}),e,null,[[2,53],[24,32]])})));return function(t){return e.apply(this,arguments)}}(),this.getVideoFilter=()=>(Ot("getVideoFilter","Attempt"),Ot("getVideoFilter","Success"),Ln||null),this.setVideoMediaProcessorConnector=function(){var e=(0,o.default)(i.default.mark((function e(t){var r,o,a,s,c,u;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ot("setVideoMediaProcessorConnector","Attempt",{message:t?"setting the connector":"clearing the connector"}),!n.getVideoFilter()){e.next=4;break}throw Ot("setVideoMediaProcessorConnector","Failure",{message:"Tried to set video MediaProcessorConnector when video filter applied."}),le(ie.NOT_SUPPORTED,new Error("setVideoMediaProcessorConnector: Cannot use this method when videoFilter is set."));case 4:if(!Ye){e.next=14;break}return r=Z.getVideoTracks(),o=r[0],e.next=8,Gn(Nn);case 8:return a=e.sent,e.next=11,Wn(o,a);case 11:Ye.destroy(),Ye.stopOriginalTrack(),Ye=null;case 14:if(t){e.next=17;break}return Ot("setVideoMediaProcessorConnector","Success",{message:"clearing the connector"}),e.abrupt("return");case 17:if(Ie.isValidConnector(t)){e.next=20;break}throw Ot("setVideoMediaProcessorConnector","Failure",{message:"Invalid MediaProcessorConnector"}),le(ie.INVALID_PARAMETER,new Error("setVideoMediaProcessorConnector:  Tried to set invalid MediaProcessorConnector"));case 20:if(Ye=new Ie(t),s=Z.getVideoTracks(),c=s[0]){e.next=28;break}return Ot("setVideoMediaProcessorConnector","Failure",{message:u="Connector not set as no video track is present."}),ue.warn("setVideoMediaProcessorConnector: "+u),Ye=null,e.abrupt("return");case 28:return e.prev=28,e.next=31,Ye.setTrack(c);case 31:return o=e.sent,e.next=34,Wn(c,o);case 34:e.next=42;break;case 36:throw e.prev=36,e.t0=e.catch(28),Ye=null,ue.error("setVideoMediaProcessorConnector: Error getting track from MediaProcessorConnector: "+e.t0),Ot("setVideoMediaProcessorConnector","Failure",{message:e.t0.message}),e.t0;case 42:Ot("setVideoMediaProcessorConnector","Success");case 43:case"end":return e.stop()}}),e,null,[[28,36]])})));return function(t){return e.apply(this,arguments)}}(),this.setAudioMediaProcessorConnector=function(){var e=(0,o.default)(i.default.mark((function e(t){var r,o,a,s,c;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ot("setAudioMediaProcessorConnector","Attempt",{message:t?"setting the connector":"clearing the connector"}),!Je){e.next=7;break}return r=Z.getAudioTracks(),o=r[0],e.next=5,Hn(o,Je.originalTrack);case 5:Je.destroy(),Je=null;case 7:if(t){e.next=10;break}return Ot("setAudioMediaProcessorConnector","Success",{message:"clearing the connector"}),e.abrupt("return");case 10:if(Ie.isValidConnector(t)){e.next=13;break}throw Ot("setAudioMediaProcessorConnector","Failure",{message:"Invalid MediaProcessorConnector"}),le(ie.INVALID_PARAMETER,new Error("setAudioMediaProcessorConnector:  Tried to set invalid MediaProcessorConnector"));case 13:if(a=Z.getAudioTracks(),s=a[0]){e.next=20;break}return Ot("setAudioMediaProcessorConnector","Failure",{message:c="Connector not set as no audio track is present."}),ue.warn("setAudioMediaProcessorConnector: "+c),Je=null,e.abrupt("return");case 20:return Je=new Ie(t),e.prev=21,e.next=24,Je.setTrack(s);case 24:return o=e.sent,e.next=27,Hn(n.getAudioSource(),o);case 27:e.next=35;break;case 29:throw e.prev=29,e.t0=e.catch(21),Je=null,ue.error("setAudioMediaProcessorConnector: Error getting track from MediaProcessorConnector: "+e.t0),Ot("setAudioMediaProcessorConnector","Failure",{message:e.t0.message}),e.t0;case 35:Ot("setAudioMediaProcessorConnector","Success");case 36:case"end":return e.stop()}}),e,null,[[21,29]])})));return function(t){return e.apply(this,arguments)}}(),this.clearVideoFilter=(0,o.default)(i.default.mark((function e(){var t,n,r,o,a;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ot("clearVideoFilter","Attempt"),Tt.publishVideo||it.getVideoFilter()){e.next=5;break}return Ln=null,Ot("clearVideoFilter","Success"),e.abrupt("return");case 5:if(it.getVideoFilter()||Ln){e.next=10;break}return Ot("clearVideoFilter","Success",{message:t="Ignoring. No video filter applied"}),ue.debug(t),e.abrupt("return");case 10:if(Re.isSupported()){e.next=15;break}return Ot("clearVideoFilter","Success",{message:t='Ignoring. "clearVideoFilter" not supported.'}),ue.warn(t),e.abrupt("return");case 15:if(Z){e.next=20;break}return Ot("clearVideoFilter","Success",{message:t="Ignoring. No mediaStream"}),ue.warn(t),e.abrupt("return");case 20:return n=Ln,Ln=null,r=Z.getVideoTracks(),o=r[0],e.prev=23,e.next=26,Gn(Nn);case 26:a=e.sent,e.next=33;break;case 29:return e.prev=29,e.t0=e.catch(23),ue.error(e.t0),e.abrupt("return");case 33:if(a){e.next=36;break}return ue.warn("Failed to clear filter because there is no video track."),e.abrupt("return");case 36:return e.prev=36,e.next=39,Wn(o,a);case 39:return e.next=41,An();case 41:e.next=46;break;case 43:e.prev=43,e.t1=e.catch(36),Ln=n;case 46:Ot("clearVideoFilter","Success");case 47:case"end":return e.stop()}}),e,null,[[23,29],[36,43]])})))}}}).call(this,n(2))},function(e,t,n){"use strict";const r=n(52).once;e.exports=function(e,t){void 0===t&&(t={});const i=t.hasE2eeCapability||n(110),o=t.hasOpenTokSupport||r;this.publish=-1!==e.indexOf("publish")?1:0,this.subscribe=-1!==e.indexOf("subscribe")?1:0,this.forceUnpublish=-1!==e.indexOf("forceunpublish")?1:0,this.forceDisconnect=-1!==e.indexOf("forcedisconnect")?1:0,this.forceMute=-1!==e.indexOf("forcemute")?1:0,this.supportsE2ee=i()?1:0,this.supportsWebRTC=o()?1:0,this.permittedTo=e=>Object.prototype.hasOwnProperty.call(this,e)&&1===this[e]}},function(e,t,n){"use strict";const r=n(0)("Stream"),i=n(8),o=n(22),a=n(6),s=n(24)(),c=["name","archiving"];e.exports=function(e,t,n,u,d,l,f){const p=this;let h;this.id=e,this.streamId=e,this.name=t,this.creationTime=Number(n),this.initials=f||"",this.connection=u,this.channel=l,this.publisher=o.publishers.find({streamId:this.id}),a(this);const m=function(e,t,n,r){let i=t;switch(i){case"active":i="audio"===e.type?"hasAudio":"hasVideo",p[i]=r;break;case"disableWarning":if(i="audio"===e.type?"audioDisableWarning":"videoDisableWarning",p[i]=r,!p["audio"===e.type?"hasAudio":"hasVideo"])return;break;case"fitMode":i="defaultFitMode",p[i]=r;break;case"source":i="audio"===e.type?"audioType":"videoType",p[i]=r;break;case"videoDimensions":p.videoDimensions=r;break;case"orientation":case"width":case"height":return}p.dispatchEvent(new s.StreamUpdatedEvent(p,i,n,r))},g=function(){return p.publisher?p.publisher:o.subscribers.find(e=>e.stream&&e.stream.id===p.id&&e.session.id===d.id)},v=function(){return!p.publisher};this.getChannelsOfType=function(e){return p.channel.filter(t=>t.type===e)},this.getChannel=function(e){for(let t=0;t<p.channel.length;++t)if(p.channel[t].id===e)return p.channel[t];return null};const y=this.getChannelsOfType("audio")[0],b=this.getChannelsOfType("video")[0];this.hasAudio=null!=y&&y.active,this.hasVideo=null!=b&&b.active,this.videoType=b&&b.source,this.defaultFitMode=b&&b.fitMode,this.videoDimensions={},b&&(this.videoDimensions.width=b.width,this.videoDimensions.height=b.height,this.videoDimensions.orientation=b.orientation,b.on("update",m),this.frameRate=b.frameRate),y&&y.on("update",m),this.setChannelActiveState=function(e,t,n,r,i){const o={active:t};n&&(o.activeReason=n),void 0!==r&&(o.congestionLevel=r),i&&(o.subscriberId=i),S(e,o)},this.setVideoDimensions=function(e,t){S("video",{width:e,height:t,orientation:0})},this.setRestrictFrameRate=function(e){S("video",{restrictFrameRate:e})},this.setPreferredResolution=function(e){if(!v())return void r.warn("setPreferredResolution has no affect when called by a publisher");if(d.sessionInfo.p2pEnabled)return void r.warn("Stream.setPreferredResolution will not work in a P2P Session");if(e&&void 0===e.width&&void 0===e.height)return;const t=p.getChannelsOfType("video")[0];if(t){if(e&&e.width){if(isNaN(parseInt(e.width,10)))throw new i.Error("stream preferred width must be an integer","Subscriber");t.preferredWidth=parseInt(e.width,10)}else t.preferredWidth=void 0;if(e&&e.height){if(isNaN(parseInt(e.height,10)))throw new i.Error("stream preferred height must be an integer","Subscriber");t.preferredHeight=parseInt(e.height,10)}else t.preferredHeight=void 0;d._.subscriberChannelUpdate(p,g(),t,{preferredWidth:t.preferredWidth||0,preferredHeight:t.preferredHeight||0})}},this.getPreferredResolution=function(){const e=p.getChannelsOfType("video")[0];if(e&&(e.preferredWidth||e.preferredHeight))return{width:e.preferredWidth,height:e.preferredHeight}},this.setPreferredFrameRate=function(e){if(!v())return void r.warn("setPreferredFrameRate has no affect when called by a publisher");if(d.sessionInfo.p2pEnabled)return void r.warn("Stream.setPreferredFrameRate will not work in a P2P Session");if(e&&isNaN(parseFloat(e)))throw new i.Error("stream preferred frameRate must be a number","Subscriber");const t=p.getChannelsOfType("video")[0];t&&(t.preferredFrameRate=e?parseFloat(e):null,d._.subscriberChannelUpdate(p,g(),t,{preferredFrameRate:t.preferredFrameRate||0}))},this.getPreferredFrameRate=function(){const e=p.getChannelsOfType("video")[0];return e?e.preferredFrameRate:null};let S=function(e,t){let n;if(p.publisher)n=e=>d._.streamChannelUpdate(p,e,t);else{const e=g();n=n=>d._.subscriberChannelUpdate(p,e,n,t)}p.getChannelsOfType(e).forEach(n)};this.destroyed=!1,this.destroyedReason=void 0,this.destroy=function(e,t){void 0===e&&(e="clientDisconnected"),h=e,p.destroyed=!0,p.destroyedReason=h,!0!==t&&p.dispatchEvent(new s.DestroyedEvent("destroyed",p,h))},this._={},this._.updateProperty=function(e,t){if(-1===c.indexOf(e))return void r.warn(`Unknown stream property "${e}" was modified to "${t}".`);const n=p[e],i=t;switch(e){case"name":p[e]=i;break;case"archiving":var o=g();p.publisher&&o&&o._.archivingStatus(i),p[e]=i}const a=new s.StreamUpdatedEvent(p,e,n,i);p.dispatchEvent(a)},this._.update=function(e){for(const t in e)e.hasOwnProperty(t)&&p._.updateProperty(t,e[t])},this._.forceMute=function(e){e.hasOwnProperty("channels")&&e.channels.includes("audio")&&p.publisher&&p.publisher._.forceMuteAudio()},this._.updateChannel=function(e,t){const n=p.getChannel(e);n&&n.update(t)}}},function(e,t,n){"use strict";t.__esModule=!0,t.UNSUBSCRIBE=t.SUBSCRIBE=t.STATUS=t.PONG=t.PING=t.MESSAGE=t.DISCONNECT=t.CONNECT=void 0,t.SUBSCRIBE=0,t.UNSUBSCRIBE=1,t.MESSAGE=2,t.CONNECT=3,t.DISCONNECT=4,t.PING=7,t.PONG=8,t.STATUS=9},function(e,t,n){"use strict";const r=n(9),i=n(170),o=n(6),a=n(24)(),s=n(765);function c(e,t,n,r,c){let u;this.id=e,this.connectionId=e,this.creationTime=t?Number(t):null,this.data=n,this.capabilities=s(r),this.permissions=new i(c),this.quality=null,o(this),this.destroy=(e,t)=>{u=e||"clientDisconnected",!0!==t&&this.dispatchEvent(new a.DestroyedEvent("destroyed",this,u))},this.destroyed=()=>void 0!==u,this.destroyedReason=()=>u}c.fromHash=e=>{let t=e.id,n=e.creationTime,i=e.data,o=e.capablities,a=e.permissions;return new c(t,n,i,r(o||{},{supportsWebRTC:!0}),a||[])},e.exports=c},function(e,t){var n="object"==typeof(void 0!==typeof window?window:global)&&(void 0!==typeof window?window:global)&&(void 0!==typeof window?window:global).Object===Object&&(void 0!==typeof window?window:global);e.exports=n},function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t,n){var r=n(39),i=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=i},function(e,t,n){var r=n(41),i=n(31);e.exports=function(e,t){return e&&r(t,i(t),e)}},function(e,t,n){var r=n(385),i=n(64),o=n(12),a=n(65),s=n(66),c=n(86),u=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=o(e),d=!n&&i(e),l=!n&&!d&&a(e),f=!n&&!d&&!l&&c(e),p=n||d||l||f,h=p?r(e.length,String):[],m=h.length;for(var g in e)!t&&!u.call(e,g)||p&&("length"==g||l&&("offset"==g||"parent"==g)||f&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||s(g,m))||h.push(g);return h}},function(e,t){e.exports=function(e,t){return function(n){return e(t(n))}}},function(e,t,n){(function(e){var r=n(15),i=t&&!t.nodeType&&t,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,a=o&&o.exports===i?r.Buffer:void 0,s=a?a.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=s?s(n):new e.constructor(n);return e.copy(r),r}}).call(this,n(85)(e))},function(e,t){e.exports=function(){return[]}},function(e,t,n){var r=n(118),i=n(119),o=n(117),a=n(181),s=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)r(t,o(e)),e=i(e);return t}:a;e.exports=s},function(e,t,n){var r=n(184),i=n(117),o=n(31);e.exports=function(e){return r(e,o,i)}},function(e,t,n){var r=n(118),i=n(12);e.exports=function(e,t,n){var o=t(e);return i(e)?o:r(o,n(e))}},function(e,t,n){var r=n(184),i=n(182),o=n(54);e.exports=function(e){return r(e,o,i)}},function(e,t,n){var r=n(39)(n(15),"Set");e.exports=r},function(e,t,n){var r=n(39)(n(15),"WeakMap");e.exports=r},function(e,t,n){var r=n(15).Uint8Array;e.exports=r},function(e,t,n){var r=n(120);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},function(e,t,n){var r=n(87),i=n(119),o=n(68);e.exports=function(e){return"function"!=typeof e.constructor||o(e)?{}:r(i(e))}},function(e,t,n){var r=n(112);function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(i.Cache||r),n}i.Cache=r,e.exports=i},function(e,t,n){var r=n(88),i=n(124);e.exports=function(e){return r((function(t,n){var r=-1,o=n.length,a=o>1?n[o-1]:void 0,s=o>2?n[2]:void 0;for(a=e.length>3&&"function"==typeof a?(o--,a):void 0,s&&i(n[0],n[1],s)&&(a=o<3?void 0:a,o=1),t=Object(t);++r<o;){var c=n[r];c&&e(t,c,r,a)}return t}))}},function(e,t,n){var r=n(122),i=Math.max;e.exports=function(e,t,n){return t=i(void 0===t?e.length-1:t,0),function(){for(var o=arguments,a=-1,s=i(o.length-t,0),c=Array(s);++a<s;)c[a]=o[t+a];a=-1;for(var u=Array(t+1);++a<t;)u[a]=o[a];return u[t]=n(c),r(e,this,u)}}},function(e,t){var n=Date.now;e.exports=function(e){var t=0,r=0;return function(){var i=n(),o=16-(i-r);if(r=i,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},function(e,t,n){"use strict";e.exports=n(413)()?WeakMap:n(414)},function(e,t,n){"use strict";var r=Object.create,i=Object.getPrototypeOf,o={};e.exports=function(){var e=Object.setPrototypeOf,t=arguments[0]||r;return"function"==typeof e&&i(e(t(null),o))===o}},function(e,t,n){"use strict";var r,i=n(198),o=n(32),a=Object.prototype.isPrototypeOf,s=Object.defineProperty,c={configurable:!0,enumerable:!1,writable:!0,value:void 0};r=function(e,t){if(o(e),null===t||i(t))return e;throw new TypeError("Prototype must be null or an object")},e.exports=function(e){var t,n;return e?(2===e.level?e.set?(n=e.set,t=function(e,t){return n.call(r(e,t),t),e}):t=function(e,t){return r(e,t).__proto__=t,e}:t=function e(t,n){var i;return r(t,n),(i=a.call(e.nullPolyfill,t))&&delete e.nullPolyfill.__proto__,null===n&&(n=e.nullPolyfill),t.__proto__=n,i&&s(e.nullPolyfill,"__proto__",c),t},Object.defineProperty(t,"level",{configurable:!1,enumerable:!1,writable:!1,value:e.level})):null}(function(){var e,t=Object.create(null),n={},r=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(r){try{(e=r.set).call(t,n)}catch(e){}if(Object.getPrototypeOf(t)===n)return{set:e,level:2}}return t.__proto__=n,Object.getPrototypeOf(t)===n?{level:2}:((t={}).__proto__=n,Object.getPrototypeOf(t)===n&&{level:1})}()),n(416)},function(e,t,n){"use strict";var r=n(44),i={function:!0,object:!0};e.exports=function(e){return r(e)&&i[typeof e]||!1}},function(e,t,n){"use strict";var r=n(419),i=/^\s*class[\s{/}]/,o=Function.prototype.toString;e.exports=function(e){return!!r(e)&&!i.test(o.call(e))}},function(e,t,n){"use strict";var r=n(44),i=Array.prototype.forEach,o=Object.create,a=function(e,t){var n;for(n in e)t[n]=e[n]};e.exports=function(e){var t=o(null);return i.call(arguments,(function(e){r(e)&&a(Object(e),t)})),t}},function(e,t,n){"use strict";e.exports=n(426)()?String.prototype.contains:n(427)},function(e,t,n){"use strict";var r=n(90),i=n(91),o=n(428),a=n(457),s=n(458),c=n(45).iterator;e.exports=function(e){return"function"==typeof s(e)[c]?e[c]():r(e)?new o(e):i(e)?new a(e):new o(e)}},function(e,t,n){"use strict";var r=n(433);e.exports=function(e){if(!r(e))throw new TypeError(e+" is not a symbol");return e}},function(e,t,n){"use strict";var r,i=n(437),o=n(127),a=n(69),s=n(32),c=n(33),u=n(438),d=n(45),l=Object.defineProperty,f=Object.defineProperties;e.exports=r=function(e,t){if(!(this instanceof r))throw new TypeError("Constructor requires 'new'");f(this,{__list__:c("w",s(e)),__context__:c("w",t),__nextIndex__:c("w",0)}),t&&(a(t.on),t.on("_add",this._onAdd),t.on("_delete",this._onDelete),t.on("_clear",this._onClear))},delete r.prototype.constructor,f(r.prototype,o({_next:c((function(){var e;if(this.__list__)return this.__redo__&&void 0!==(e=this.__redo__.shift())?e:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()})),next:c((function(){return this._createResult(this._next())})),_createResult:c((function(e){return void 0===e?{done:!0,value:void 0}:{done:!1,value:this._resolve(e)}})),_resolve:c((function(e){return this.__list__[e]})),_unBind:c((function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)})),toString:c((function(){return"[object "+(this[d.toStringTag]||"Object")+"]"}))},u({_onAdd:c((function(e){e>=this.__nextIndex__||(++this.__nextIndex__,this.__redo__?(this.__redo__.forEach((function(t,n){t>=e&&(this.__redo__[n]=++t)}),this),this.__redo__.push(e)):l(this,"__redo__",c("c",[e])))})),_onDelete:c((function(e){var t;e>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(-1!==(t=this.__redo__.indexOf(e))&&this.__redo__.splice(t,1),this.__redo__.forEach((function(t,n){t>e&&(this.__redo__[n]=--t)}),this)))})),_onClear:c((function(){this.__redo__&&i.call(this.__redo__),this.__nextIndex__=0}))}))),l(r.prototype,d.iterator,c((function(){return this})))},function(e,t,n){"use strict";var r=n(56),i=n(126),o=n(440),a=n(441),s=function(e,t){return e.replace("%v",a(t))};e.exports=function(e,t,n){if(!i(n))throw new TypeError(s(t,e));if(!r(e)){if("default"in n)return n.default;if(n.isOptional)return null}var a=o(n.errorMessage);throw r(a)||(a=t),new TypeError(s(a,e))}},function(e,t){e.exports=function(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}},function(e,t,n){e.exports=n(469)},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},function(e,t,n){"use strict";var r=n(19);function i(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var o;if(n)o=n(t);else if(r.isURLSearchParams(t))o=t.toString();else{var a=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),a.push(i(t)+"="+i(e))})))})),o=a.join("&")}if(o){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,i){return e.config=t,n&&(e.code=n),e.request=r,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},function(e,t,n){"use strict";(function(t){var r=n(19),i=n(475),o=n(476),a=n(209),s=n(477),c=n(480),u=n(481),d=n(212);e.exports=function(e){return new t((function(t,n){var l=e.data,f=e.headers,p=e.responseType;r.isFormData(l)&&delete f["Content-Type"];var h=new XMLHttpRequest;if(e.auth){var m=e.auth.username||"",g=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";f.Authorization="Basic "+btoa(m+":"+g)}var v=s(e.baseURL,e.url);function y(){if(h){var r="getAllResponseHeaders"in h?c(h.getAllResponseHeaders()):null,o={data:p&&"text"!==p&&"json"!==p?h.response:h.responseText,status:h.status,statusText:h.statusText,headers:r,config:e,request:h};i(t,n,o),h=null}}if(h.open(e.method.toUpperCase(),a(v,e.params,e.paramsSerializer),!0),h.timeout=e.timeout,"onloadend"in h?h.onloadend=y:h.onreadystatechange=function(){h&&4===h.readyState&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))&&setTimeout(y)},h.onabort=function(){h&&(n(d("Request aborted",e,"ECONNABORTED",h)),h=null)},h.onerror=function(){n(d("Network Error",e,null,h)),h=null},h.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(d(t,e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",h)),h=null},r.isStandardBrowserEnv()){var b=(e.withCredentials||u(v))&&e.xsrfCookieName?o.read(e.xsrfCookieName):void 0;b&&(f[e.xsrfHeaderName]=b)}"setRequestHeader"in h&&r.forEach(f,(function(e,t){void 0===l&&"content-type"===t.toLowerCase()?delete f[t]:h.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(h.withCredentials=!!e.withCredentials),p&&"json"!==p&&(h.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&h.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&h.upload&&h.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){h&&(h.abort(),n(e),h=null)})),l||(l=null),h.send(l)}))}}).call(this,n(2))},function(e,t,n){"use strict";var r=n(210);e.exports=function(e,t,n,i,o){var a=new Error(e);return r(a,t,n,i,o)}},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";var r=n(19);e.exports=function(e,t){t=t||{};var n={},i=["url","method","data"],o=["headers","auth","proxy","params"],a=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],s=["validateStatus"];function c(e,t){return r.isPlainObject(e)&&r.isPlainObject(t)?r.merge(e,t):r.isPlainObject(t)?r.merge({},t):r.isArray(t)?t.slice():t}function u(i){r.isUndefined(t[i])?r.isUndefined(e[i])||(n[i]=c(void 0,e[i])):n[i]=c(e[i],t[i])}r.forEach(i,(function(e){r.isUndefined(t[e])||(n[e]=c(void 0,t[e]))})),r.forEach(o,u),r.forEach(a,(function(i){r.isUndefined(t[i])?r.isUndefined(e[i])||(n[i]=c(void 0,e[i])):n[i]=c(void 0,t[i])})),r.forEach(s,(function(r){r in t?n[r]=c(e[r],t[r]):r in e&&(n[r]=c(void 0,e[r]))}));var d=i.concat(o).concat(a).concat(s),l=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===d.indexOf(e)}));return r.forEach(l,u),n}},function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},function(e,t,n){var r=n(488),i=n(490);e.exports=function(e,t,n){return r(i,e,t,n)}},function(e,t,n){var r=n(89),i=n(218),o=i?function(e,t){return i.set(e,t),e}:r;e.exports=o},function(e,t,n){var r=n(187),i=r&&new r;e.exports=i},function(e,t,n){var r=n(220),i=n(221),o=n(494),a=n(96),s=n(222),c=n(228),u=n(503),d=n(137),l=n(15);e.exports=function e(t,n,f,p,h,m,g,v,y,b){var S=128&n,E=1&n,_=2&n,T=24&n,R=512&n,I=_?void 0:a(t);return function w(){for(var C=arguments.length,O=Array(C),A=C;A--;)O[A]=arguments[A];if(T)var x=c(w),k=o(O,x);if(p&&(O=r(O,p,h,T)),m&&(O=i(O,m,g,T)),C-=k,T&&C<b){var N=d(O,x);return s(t,n,e,w.placeholder,f,O,N,v,y,b-C)}var L=E?f:this,M=_?L[t]:t;return C=O.length,v?O=u(O,v):R&&C>1&&O.reverse(),S&&y<C&&(O.length=y),this&&this!==l&&this instanceof w&&(M=I||a(M)),M.apply(L,O)}}},function(e,t){var n=Math.max;e.exports=function(e,t,r,i){for(var o=-1,a=e.length,s=r.length,c=-1,u=t.length,d=n(a-s,0),l=Array(u+d),f=!i;++c<u;)l[c]=t[c];for(;++o<s;)(f||o<a)&&(l[r[o]]=e[o]);for(;d--;)l[c++]=e[o++];return l}},function(e,t){var n=Math.max;e.exports=function(e,t,r,i){for(var o=-1,a=e.length,s=-1,c=r.length,u=-1,d=t.length,l=n(a-c,0),f=Array(l+d),p=!i;++o<l;)f[o]=e[o];for(var h=o;++u<d;)f[h+u]=t[u];for(;++s<c;)(p||o<a)&&(f[h+r[s]]=e[o++]);return f}},function(e,t,n){var r=n(495),i=n(226),o=n(227);e.exports=function(e,t,n,a,s,c,u,d,l,f){var p=8&t;t|=p?32:64,4&(t&=~(p?64:32))||(t&=-4);var h=[e,t,s,p?c:void 0,p?u:void 0,p?void 0:c,p?void 0:u,d,l,f],m=n.apply(void 0,h);return r(e)&&i(m,h),m.placeholder=a,o(m,e,t)}},function(e,t,n){var r=n(218),i=n(224),o=r?function(e){return r.get(e)}:i;e.exports=o},function(e,t){e.exports=function(){}},function(e,t,n){var r=n(87),i=n(136);function o(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}o.prototype=r(i.prototype),o.prototype.constructor=o,e.exports=o},function(e,t,n){var r=n(217),i=n(194)(r);e.exports=i},function(e,t,n){var r=n(500),i=n(501),o=n(123),a=n(502);e.exports=function(e,t,n){var s=t+"";return o(e,i(s,a(r(s),n)))}},function(e,t){e.exports=function(e){return e.placeholder}},function(e,t,n){var r=n(507),i=n(11),o=n(70),a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,c=/^0o[0-7]+$/i,u=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return NaN;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=s.test(e);return n||c.test(e)?u(e.slice(2),n?2:8):a.test(e)?NaN:+e}},function(e,t,n){var r=n(515),i=n(18);e.exports=function e(t,n,o,a,s){return t===n||(null==t||null==n||!i(t)&&!i(n)?t!=t&&n!=n:r(t,n,o,a,e,s))}},function(e,t,n){var r=n(93),i=n(232),o=n(95);e.exports=function(e,t,n,a,s,c){var u=1&n,d=e.length,l=t.length;if(d!=l&&!(u&&l>d))return!1;var f=c.get(e),p=c.get(t);if(f&&p)return f==t&&p==e;var h=-1,m=!0,g=2&n?new r:void 0;for(c.set(e,t),c.set(t,e);++h<d;){var v=e[h],y=t[h];if(a)var b=u?a(y,v,h,t,e,c):a(v,y,h,e,t,c);if(void 0!==b){if(b)continue;m=!1;break}if(g){if(!i(t,(function(e,t){if(!o(g,t)&&(v===e||s(v,e,n,a,c)))return g.push(t)}))){m=!1;break}}else if(v!==y&&!s(v,y,n,a,c)){m=!1;break}}return c.delete(e),c.delete(t),m}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}},function(e,t,n){var r=n(11);e.exports=function(e){return e==e&&!r(e)}},function(e,t){e.exports=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}}},function(e,t,n){var r=n(520),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,a=r((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(i,(function(e,n,r,i){t.push(r?i.replace(o,"$1"):n||e)})),t}));e.exports=a},function(e,t,n){var r=n(522),i=n(523);e.exports=function(e,t){return null!=e&&i(e,t,r)}},function(e,t,n){var r=n(118),i=n(529);e.exports=function e(t,n,o,a,s){var c=-1,u=t.length;for(o||(o=i),s||(s=[]);++c<u;){var d=t[c];n>0&&o(d)?n>1?e(d,n-1,o,a,s):r(s,d):a||(s[s.length]=d)}return s}},function(e,t,n){var r=n(536)();e.exports=r},function(e,t,n){"use strict";var r=n(537),i=n(538);function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=b,t.resolve=function(e,t){return b(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?b(e,!1,!0).resolveObject(t):t},t.format=function(e){return i.isString(e)&&(e=b(e)),e instanceof o?e.format():o.prototype.format.call(e)},t.Url=o;var a=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,c=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,u=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),d=["'"].concat(u),l=["%","/","?",";","#"].concat(d),f=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,h=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},v={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=n(539);function b(e,t,n){if(e&&i.isObject(e)&&e instanceof o)return e;var r=new o;return r.parse(e,t,n),r}o.prototype.parse=function(e,t,n){if(!i.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o=e.indexOf("?"),s=-1!==o&&o<e.indexOf("#")?"?":"#",u=e.split(s);u[0]=u[0].replace(/\\/g,"/");var b=e=u.join(s);if(b=b.trim(),!n&&1===e.split("#").length){var S=c.exec(b);if(S)return this.path=b,this.href=b,this.pathname=S[1],S[2]?(this.search=S[2],this.query=t?y.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var E=a.exec(b);if(E){var _=(E=E[0]).toLowerCase();this.protocol=_,b=b.substr(E.length)}if(n||E||b.match(/^\/\/[^@\/]+@[^@\/]+/)){var T="//"===b.substr(0,2);!T||E&&g[E]||(b=b.substr(2),this.slashes=!0)}if(!g[E]&&(T||E&&!v[E])){for(var R,I,w=-1,C=0;C<f.length;C++)-1!==(O=b.indexOf(f[C]))&&(-1===w||O<w)&&(w=O);for(-1!==(I=-1===w?b.lastIndexOf("@"):b.lastIndexOf("@",w))&&(R=b.slice(0,I),b=b.slice(I+1),this.auth=decodeURIComponent(R)),w=-1,C=0;C<l.length;C++){var O;-1!==(O=b.indexOf(l[C]))&&(-1===w||O<w)&&(w=O)}-1===w&&(w=b.length),this.host=b.slice(0,w),b=b.slice(w),this.parseHost(),this.hostname=this.hostname||"";var A="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!A)for(var x=this.hostname.split(/\./),k=(C=0,x.length);C<k;C++){var N=x[C];if(N&&!N.match(p)){for(var L="",M=0,V=N.length;M<V;M++)N.charCodeAt(M)>127?L+="x":L+=N[M];if(!L.match(p)){var P=x.slice(0,C),D=x.slice(C+1),Z=N.match(h);Z&&(P.push(Z[1]),D.unshift(Z[2])),D.length&&(b="/"+D.join(".")+b),this.hostname=P.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),A||(this.hostname=r.toASCII(this.hostname));var j=this.port?":"+this.port:"",W=this.hostname||"";this.host=W+j,this.href+=this.host,A&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==b[0]&&(b="/"+b))}if(!m[_])for(C=0,k=d.length;C<k;C++){var G=d[C];if(-1!==b.indexOf(G)){var F=encodeURIComponent(G);F===G&&(F=escape(G)),b=b.split(G).join(F)}}var U=b.indexOf("#");-1!==U&&(this.hash=b.substr(U),b=b.slice(0,U));var X=b.indexOf("?");if(-1!==X?(this.search=b.substr(X),this.query=b.substr(X+1),t&&(this.query=y.parse(this.query)),b=b.slice(0,X)):t&&(this.search="",this.query={}),b&&(this.pathname=b),v[_]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){j=this.pathname||"";var B=this.search||"";this.path=j+B}return this.href=this.format(),this},o.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,a="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(a=y.stringify(this.query));var s=this.search||a&&"?"+a||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||v[t])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),s&&"?"!==s.charAt(0)&&(s="?"+s),t+o+(n=n.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(s=s.replace("#","%23"))+r},o.prototype.resolve=function(e){return this.resolveObject(b(e,!1,!0)).format()},o.prototype.resolveObject=function(e){if(i.isString(e)){var t=new o;t.parse(e,!1,!0),e=t}for(var n=new o,r=Object.keys(this),a=0;a<r.length;a++){var s=r[a];n[s]=this[s]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var c=Object.keys(e),u=0;u<c.length;u++){var d=c[u];"protocol"!==d&&(n[d]=e[d])}return v[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!v[e.protocol]){for(var l=Object.keys(e),f=0;f<l.length;f++){var p=l[f];n[p]=e[p]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||g[e.protocol])n.pathname=e.pathname;else{for(var h=(e.pathname||"").split("/");h.length&&!(e.host=h.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==h[0]&&h.unshift(""),h.length<2&&h.unshift(""),n.pathname=h.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var m=n.pathname||"",y=n.search||"";n.path=m+y}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var b=n.pathname&&"/"===n.pathname.charAt(0),S=e.host||e.pathname&&"/"===e.pathname.charAt(0),E=S||b||n.host&&e.pathname,_=E,T=n.pathname&&n.pathname.split("/")||[],R=(h=e.pathname&&e.pathname.split("/")||[],n.protocol&&!v[n.protocol]);if(R&&(n.hostname="",n.port=null,n.host&&(""===T[0]?T[0]=n.host:T.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===h[0]?h[0]=e.host:h.unshift(e.host)),e.host=null),E=E&&(""===h[0]||""===T[0])),S)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,T=h;else if(h.length)T||(T=[]),T.pop(),T=T.concat(h),n.search=e.search,n.query=e.query;else if(!i.isNullOrUndefined(e.search))return R&&(n.hostname=n.host=T.shift(),(A=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=A.shift(),n.host=n.hostname=A.shift())),n.search=e.search,n.query=e.query,i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n;if(!T.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var I=T.slice(-1)[0],w=(n.host||e.host||T.length>1)&&("."===I||".."===I)||""===I,C=0,O=T.length;O>=0;O--)"."===(I=T[O])?T.splice(O,1):".."===I?(T.splice(O,1),C++):C&&(T.splice(O,1),C--);if(!E&&!_)for(;C--;C)T.unshift("..");!E||""===T[0]||T[0]&&"/"===T[0].charAt(0)||T.unshift(""),w&&"/"!==T.join("/").substr(-1)&&T.push("");var A,x=""===T[0]||T[0]&&"/"===T[0].charAt(0);return R&&(n.hostname=n.host=x?"":T.length?T.shift():"",(A=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=A.shift(),n.host=n.hostname=A.shift())),(E=E||n.host&&T.length)&&!x&&T.unshift(""),T.length?n.pathname=T.join("/"):(n.pathname=null,n.path=null),i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},o.prototype.parseHost=function(){var e=this.host,t=s.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,n){"use strict";(function(t){const r=n(17),i=n(16),o=n(0)("guidStorage"),a={};let s,c;e.exports=a,a.override=e=>{if(function(e){return!(r(e.get)&&r(e.set))}(e))throw new Error("The storageInterface argument does not seem to be valid, it must implement get and set methods");s!==e&&(s=e,c&&s.set(c,e=>{e&&o.error(`Failed to send initial Guid value (${c}) to the newly assigned Guid Storage. The error was: ${e}`)}))},a.get=e=>{!function(e){c?e(null,c):s.get(e)}((t,n)=>{t?e(t):(n?c||(c=n):(n=i(),s.set(n,t=>{t?e(t):c=n})),e(null,c))})},a.getAsync=()=>new t((e,t)=>{a.get((n,r)=>n?t(n):e(r))}),a.override({get(e){let t;try{t=(void 0!==typeof window?window:global).localStorage.getItem("opentok_client_id")}catch(e){t||(t=i())}e(null,t)},set(e,t){try{(void 0!==typeof window?window:global).localStorage.setItem("opentok_client_id",e)}catch(e){}t(null)}}),a.set=e=>{c=e}}).call(this,n(2))},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},function(e,t,n){"use strict";const r=n(245),i=n(3),o=n(247),a=n(9),s={};e.exports=s,"Node"!==i.name&&(s.request=function(e,t,n){const i=new(void 0!==typeof window?window:global).XMLHttpRequest,o=t||{};if(o.method){t.overrideMimeType&&(i.overrideMimeType&&i.overrideMimeType(t.overrideMimeType),delete t.overrideMimeType),n&&(r(i).on("load",e=>{const t=e.target.status;t>=200&&(t<300||304===t)?n(null,e):n(e)}),r(i).on("error",n)),i.open(t.method,e,!0),o.headers||(o.headers={});for(const e in o.headers)Object.prototype.hasOwnProperty.call(o.headers,e)&&i.setRequestHeader(e,o.headers[e]);i.send(t.body&&function(e){if("string"==typeof e)return e;const t=[];return Object.keys(e).forEach(n=>{t.push(`${encodeURIComponent(n)}=${encodeURIComponent(e[n])}`)}),t.join("&").replace(/\+/g,"%20")}(t.body))}else n(new Error("No HTTP method specified in options"))},s.get=function(e,t,n){const r=a(t||{},{method:"GET"});s.request(e,r,n)},s.post=function(e,t,n){const r=a(t||{},{method:"POST"});s.request(e,r,n)},s.getJSON=function(e,t,n){const r=a({Accept:"application/json"},(t=t||{}).headers||{});s.get(e,a(t||{},{headers:r}),(function(e,t){if(e)n(e,t&&t.target&&t.target.responseText);else{let e;try{e=JSON.parse(t.target.responseText)}catch(e){return void n(e,t&&t.target&&t.target.responseText)}n(null,e,t)}}))},o(s))},function(e,t,n){"use strict";const r=n(246);e.exports=function(e,t){return new r(e,t)}},function(e,t,n){"use strict";const r=n(17),i={attributes:n(548),css:n(549),classNames:n(554),observers:n(556)},o=/^#([\w-]*)$/,a=function(e){return Array.prototype.slice.call(e)},s=function(e,t){const n=function(e,t){let n;if(void 0===e)return[];if("string"==typeof e){n=[];const r=o.exec(e);if(t=t||document,r&&r[1]){const e=t.getElementById(r[1]);e&&n.push(e)}else n=t.querySelectorAll(e)}else e&&(e.nodeType||(void 0!==typeof window?window:global).XMLHttpRequest&&e instanceof(void 0!==typeof window?window:global).XMLHttpRequest||e===(void 0!==typeof window?window:global))?(n=[e],t=e):Array.isArray(e)?(n=e.slice(),t=null):n=a(n);return n}(e,t);this.context=t,this.toArray=function(){return n},this.length=n.length,this.first=n[0],this.last=n[n.length-1],this.get=function(e){return void 0===e?n:n[e]}};e.exports=s,(s._attachToOTHelpers={}).removeElement=function(e){return new s(e).remove()},s.prototype.getAsArray=function(){let e=this.get();return r(e.forEach)||(e=a(e)),e},s.prototype.some=function(e,t){return this.getAsArray().some(e,t)},s.prototype.forEach=function(e,t){return this.getAsArray().forEach(e,t),this},s.prototype.map=function(e,t){return new s(this.getAsArray().map(e,t),this.context)},s.prototype.filter=function(e,t){return new s(this.getAsArray().filter(e,t),this.context)},s.prototype.find=function(e){return new s(e,this.first)},s.prototype.on=function(e,t){return this.forEach(n=>{n.addEventListener(e,t,!1)})},s.prototype.off=function(e,t){return this.forEach(n=>{n.removeEventListener(e,t,!1)})},s.prototype.once=function(e,t){const n=function(){this.off(e,n),t(...arguments)}.bind(this);return this.on(e,n)},s.prototype.appendTo=function(e){if(!e)throw new Error("appendTo requires a DOMElement to append to.");return this.forEach(t=>{e.appendChild(t)})},s.prototype.append=function(){const e=this.first;return e?(Array.prototype.forEach.call(arguments,t=>{e.appendChild(t)}),this):this},s.prototype.prepend=function(){if(0===arguments.length)return this;const e=this.first;let t;return e?(t=Array.prototype.slice.call(arguments),e.firstElementChild||e.appendChild(t.shift()),t.forEach(t=>{e.insertBefore(t,e.firstElementChild)}),this):this},s.prototype.after=function(e){if(!e)throw new Error("after requires a DOMElement to insert after");return this.forEach(t=>{t.parentElement&&(e!==t.parentNode.lastChild?t.parentElement.insertBefore(t,e):t.parentElement.appendChild(t))})},s.prototype.before=function(e){if(!e)throw new Error("before requires a DOMElement to insert before");return this.forEach(t=>{t.parentElement&&t.parentElement.insertBefore(t,e)})},s.prototype.remove=function(){return this.forEach(e=>{e.parentNode&&e.parentNode.removeChild(e)})},s.prototype.empty=function(){return this.forEach(e=>{for(;e.firstChild;)e.removeChild(e.firstChild)})},s.prototype.isDisplayNone=function(){return this.some(e=>(0===e.offsetWidth||0===e.offsetHeight)&&"none"===new s(e).css("display")||!(!e.parentNode||!e.parentNode.style)&&new s(e.parentNode).isDisplayNone())};const c=function e(t){return 0!==t.offsetWidth&&0!==t.offsetHeight||"none"!==new s(t).css("display")?t.parentNode&&t.parentNode.style?e(t.parentNode):null:t};s._attachToOTHelpers.emptyElement=function(e){return new s(e).empty()},s._attachToOTHelpers._findElementWithDisplayNone=c,i.css(s,c),i.attributes(s),i.classNames(s),i.observers(s),["on","off","isDisplayNone","show","hide","css","makeVisibleAndYield","addClass","removeClass"].forEach(e=>{s._attachToOTHelpers[e]=function(){const t=Array.prototype.slice.apply(arguments),n=t.shift(),r=new s(n);return s.prototype[e].apply(r,t)}})},function(e,t,n){"use strict";e.exports=function(e){const t={};Object.keys(e).forEach(n=>{t[n]=e[n]}),e._attachToOTHelpers=t}},function(e,t,n){"use strict";const r=n(17),i=n(6),o=n(0)("Collection");e.exports=function(e){let t=[],n={};const a=e||"id";i(this);const s=function(e,t){return r(e[t])?e[t]():e[t]},c=function(e){this.trigger("update",e),this.trigger("update:"+e.target.id,e)}.bind(this),u=function(e){this.remove(e.target,e.reason)}.bind(this);this.reset=function(){t.forEach((function(e){e.off("updated",c,this),e.off("destroyed",u,this)}),this),t=[],n={}},this.destroy=function(e){t.forEach(t=>{t&&"function"==typeof t.destroy&&t.destroy(e,!0)}),this.reset(),this.off()},this.get=function(e){return e&&void 0!==n[e]?t[n[e]]:void 0},this.has=function(e){return e&&void 0!==n[e]},this.toString=function(){return t.toString()},this.where=function(e,n){return r(e)?t.filter(e,n):t.filter(t=>{for(const n in e)if(e.hasOwnProperty(n)&&s(t,n)!==e[n])return!1;return!0})},this.find=function(e,n){let i;i=r(e)?e:function(t){for(const n in e)if(e.hasOwnProperty(n)&&s(t,n)!==e[n])return!1;return!0},i=i.bind(n);for(let e=0;e<t.length;++e)if(!0===i(t[e]))return t[e];return null},this.forEach=function(e,n){return t.forEach(e,n),this},this.map=function(e){return t.map(e)},this.add=function(e){const r=s(e,a);return this.has(r)?(o.warn(`Model ${r} is already in the collection`,t),this):(n[r]=t.push(e)-1,e.on("updated",c,this),e.on("destroyed",u,this),this.trigger("add",e),this.trigger("add:"+r,e),this)},this.remove=function(e,r){const i=s(e,a);t.splice(n[i],1);for(let e=n[i];e<t.length;++e)n[s(t[e],a)]=e;return delete n[i],e.off("updated",c,this),e.off("destroyed",u,this),this.trigger("remove",e,r),this.trigger("remove:"+i,e,r),this},this._triggerAddEvents=function(){this.where.apply(this,arguments).forEach((function(e){this.trigger("add",e),this.trigger("add:"+s(e,a),e)}),this)},this.length=function(){return t.length}}},function(e,t,n){"use strict";const r=n(0)("deprecation");e.exports=function(e,t,n){let i=void 0===n?{}:n,o=i.value,a=i.name,s=void 0===a?""+t:a,c=i.getWarning,u=void 0===c?"":c,d=i.setWarning,l=void 0===d?"":d,f=i.canSet,p=void 0!==f&&f,h=i.warnOnSet,m=o,g=!1,v=!(void 0!==h&&h);const y={get:()=>(g||(g=!0,r.warn(`${s} is deprecated, and will be removed in the future. ${u}`.trim())),m),set(e){p&&(m=e),v||(v=!0,p?r.warn(`${s} is deprecated. ${l}`.trim()):r.warn(`${s} is deprecated, and will be removed in the future. ${l}`.trim()))}};Object.defineProperty(e,t,y)}},function(e,t,n){"use strict";const r=n(3),i=n(11);let o;const a=["description","fileName","lineNumber","message","name","number","stack"],s=function(e,t,n){switch(arguments.length){case 1:i(e)&&(n=e,t=void 0,e=void 0);break;case 2:i(t)&&(n=t,t=void 0)}if(n instanceof Error)for(let e=0,t=a.length;e<t;++e)this[a[e]]=n[a[e]];else if(i(n))for(const e in n)n.hasOwnProperty(e)&&(this[e]=n[e]);if(!(this.fileName&&this.lineNumber&&this.columnNumber&&this.stack)){const e=o();!this.fileName&&e.fileName&&(this.fileName=e.fileName),!this.lineNumber&&e.lineNumber&&(this.lineNumber=e.lineNumber),!this.columnNumber&&e.columnNumber&&(this.columnNumber=e.columnNumber),!this.stack&&e.stack&&(this.stack=e.stack)}!this.message&&e&&(this.message=e),this.name&&"Error"!==this.name||!t||(this.name=t)};e.exports=s,(s.prototype=Object.create(Error.prototype)).toString=function(){let e="";return this.fileName&&(e+=" "+this.fileName),this.lineNumber&&(e+=" "+this.lineNumber,this.columnNumber&&(e+=":"+this.columnNumber)),`<${this.name?this.name+" ":""}${this.message}${e}>`},s.prototype.valueOf=s.prototype.toString;const c=function(e,t){return t.slice(2).map(e=>{const t={fileName:e.getFileName(),linenumber:e.getLineNumber(),columnNumber:e.getColumnNumber()};return e.getFunctionName()&&(t.functionName=e.getFunctionName()),e.getMethodName()&&(t.methodName=e.getMethodName()),e.getThis()&&(t.self=e.getThis()),t})};o=function(){const e={};let t,n,i;switch(r.name){case"Firefox":case"Safari":try{(void 0!==typeof window?window:global).call.js.is.explody()}catch(e){i=e}t=(i.stack||"").split("\n"),t.shift(),t.shift(),e.stack=t,n=/@(.+?):([0-9]+)(:([0-9]+))?$/.exec(t[0]),n&&(e.fileName=n[1],e.lineNumber=parseInt(n[2],10),n.length>3&&(e.columnNumber=parseInt(n[4],10)));break;case"Chrome":case"Node":case"Opera":var o=Error.prepareStackTrace;Error.prepareStackTrace=c,i=new Error,e.stack=i.stack,Error.prepareStackTrace=o;var a=e.stack[0];e.lineNumber=a.lineNumber,e.columnNumber=a.columnNumber,e.fileName=a.fileName,a.functionName&&(e.functionName=a.functionName),a.methodName&&(e.methodName=a.methodName),a.self&&(e.self=a.self);break;default:i=new Error,i.stack&&(e.stack=i.stack.split("\n"))}return i.message&&(e.message=i.message),e}},function(e,t,n){"use strict";var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},r.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},r.getDescription=function(e){var t=r.splitSections(e);return t&&t[0]},r.getMediaSections=function(e){var t=r.splitSections(e);return t.shift(),t},r.matchPrefix=function(e,t){return r.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},r.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:n[t[r]]=t[r+1]}return n},r.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},r.parseIceOptions=function(e){return e.substr(14).split(" ")},r.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},r.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},r.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},r.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)n[(t=r[i].trim().split("="))[0].trim()]=t[1];return n},r.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)})),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},r.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},r.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},r.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},r.getMid=function(e){var t=r.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},r.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},r.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:r.matchPrefix(e+t,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},r.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},r.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?r.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},r.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},r.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},r.getCryptoParameters=function(e,t){return r.matchPrefix(e+t,"a=crypto:").map(r.parseCryptoLine)},r.getIceParameters=function(e,t){var n=r.matchPrefix(e+t,"a=ice-ufrag:")[0],i=r.matchPrefix(e+t,"a=ice-pwd:")[0];return n&&i?{usernameFragment:n.substr(12),password:i.substr(10)}:null},r.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(e)[0].split(" "),i=3;i<n.length;i++){var o=n[i],a=r.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){var s=r.parseRtpMap(a),c=r.matchPrefix(e,"a=fmtp:"+o+" ");switch(s.parameters=c.length?r.parseFmtp(c[0]):{},s.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(r.parseRtcpFb),t.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(s.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(r.parseExtmap(e))})),t},r.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach((function(e){n+=r.writeRtpMap(e),n+=r.writeFmtp(e),n+=r.writeRtcpFb(e)}));var i=0;return t.codecs.forEach((function(e){e.maxptime>i&&(i=e.maxptime)})),i>0&&(n+="a=maxptime:"+i+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach((function(e){n+=r.writeExtmap(e)})),n},r.parseRtpEncodingParameters=function(e){var t,n=[],i=r.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),a=-1!==i.fecMechanisms.indexOf("ULPFEC"),s=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=s.length>0&&s[0].ssrc,u=r.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));u.length>0&&u[0].length>1&&u[0][0]===c&&(t=u[0][1]),i.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&t&&(r.rtx={ssrc:t}),n.push(r),o&&((r=JSON.parse(JSON.stringify(r))).fec={ssrc:c,mechanism:a?"red+ulpfec":"red"},n.push(r))}})),0===n.length&&c&&n.push({ssrc:c});var d=r.matchPrefix(e,"b=");return d.length&&(d=0===d[0].indexOf("b=TIAS:")?parseInt(d[0].substr(7),10):0===d[0].indexOf("b=AS:")?1e3*parseInt(d[0].substr(5),10)*.95-16e3:void 0,n.forEach((function(e){e.maxBitrate=d}))),n},r.parseRtcpParameters=function(e){var t={},n=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var i=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=i.length>0,t.compound=0===i.length;var o=r.matchPrefix(e,"a=rtcp-mux");return t.mux=o.length>0,t},r.parseMsid=function(e){var t,n=r.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};var i=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return i.length>0?{stream:(t=i[0].value.split(" "))[0],track:t[1]}:void 0},r.parseSctpDescription=function(e){var t,n=r.parseMLine(e),i=r.matchPrefix(e,"a=max-message-size:");i.length>0&&(t=parseInt(i[0].substr(19),10)),isNaN(t)&&(t=65536);var o=r.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:n.fmt,maxMessageSize:t};if(r.matchPrefix(e,"a=sctpmap:").length>0){var a=r.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(a[0],10),protocol:a[1],maxMessageSize:t}}},r.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(e,t,n){var i=void 0!==t?t:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||r.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(e,t,n,i){var o=r.writeRtpDescription(e.kind,t);if(o+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var a="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),o},r.getDirection=function(e,t){for(var n=r.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return t?r.getDirection(t):"sendrecv"},r.getKind=function(e){return r.splitLines(e)[0].split(" ")[0].substr(2)},r.isRejected=function(e){return"0"===e.split(" ",2)[1]},r.parseMLine=function(e){var t=r.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},r.parseOLine=function(e){var t=r.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},r.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=r.splitLines(e),n=0;n<t.length;n++)if(t[n].length<2||"="!==t[n].charAt(1))return!1;return!0},e.exports=r},function(e,t,n){"use strict";e.exports=function(e){return-1===["Chrome","Safari","Edge","Opera"].indexOf(e.browserName)||"Edge"===e.browserName&&!e.isChromiumEdge||e.isScreenSharing&&!e.capableSimulcastScreenshare||e.sessionInfo.p2pEnabled||!e.constraints.video&&!e.isCustomVideoTrack||!1===e.scalableVideo?1:e.videoDimensions.width>640&&e.videoDimensions.height>480?3:2}},function(e,t,n){"use strict";const r=n(50);e.exports=function(){function e(e,t){var n;let i=(void 0===t?{}:t).requestAnimationFrame,o=void 0===i?(n=window).requestAnimationFrame.bind(n):i;this._lastCalled=r(),this._audioLevel=void 0,this._running=!1,this._requestAnimationFrame=o,this._getAudioLevel=e,this._startLoop()}var t=e.prototype;return t._startLoop=function(){this._running||(this._running=!0,this._requestAnimationFrame(this._loop.bind(this)))},t._loop=function(){this._getAudioLevel((e,t)=>{let n=null;if(!e){for(let e=0;e<t.length;e+=1){const r=t[e];let i=null;if(void 0!==r.audioOutputLevel){const e=parseFloat(r.audioOutputLevel)/32768;isNaN(e)||(i=e)}else void 0!==r.audioLevel&&(i=r.audioLevel);null!==i&&(null===n||i>n)&&(n=i)}this._audioLevel=n,this._running&&r()-this._lastCalled<1e4?this._requestAnimationFrame(this._loop.bind(this)):this._running=!1}})},t.destroy=function(){this._running=!1},t.sample=function(e){if("function"==typeof e)throw new Error("sample no longer takes a callback");return this._startLoop(),this._lastCalled=r(),this._audioLevel},e}()},function(e,t,n){"use strict";const r=n(255),i=n(586),o=n(149);function a(e,t,n){return!(!e.publish&&t)&&("boolean"==typeof e.source?e.source:n?{mandatory:{sourceId:e.source}}:o(e.source)?{}:{deviceId:{exact:e.source}})}function s(e){let t=a(e.audio,e.enableRenegotiation,e.usingOptionalMandatoryStyle);if(!1===t)return!1;const n=e.usingOptionalMandatoryStyle,i=e.enableStereo,o=e.echoCancellation,s=e.noiseSuppression,c=e.autoGainControl,u=e.disableAudioProcessing,d=e=>{"object"==typeof t&&(n?(r(t,{optional:[]}),t.optional.push(e)):r(t,e))};return!i&&!u&&o&&s&&c||!0!==t||(t={}),i&&d({channelCount:2}),["echoCancellation","autoGainControl","noiseSuppression"].forEach(t=>{const n=!u&&e[t];d({[t]:n})}),t}function c(e){let t=a(e.video,e.enableRenegotiation,e.usingOptionalMandatoryStyle);if(!1===t)return!1;const n=e.videoDimensions,i=e.frameRate,o=e.maxResolution,s=e.facingMode,c=e.usingOptionalMandatoryStyle;if((n||i||o||s)&&!0===t&&(t={}),n){const e=n.width,i=n.height;c?(r(t,{optional:[]}),t.optional.push({minWidth:e},{maxWidth:e},{minHeight:i},{maxHeight:i})):r(t,{width:{ideal:e},height:{ideal:i}})}return i&&(c?(r(t,{optional:[]}),t.optional.push({minFrameRate:i},{maxFrameRate:i})):r(t,{frameRate:{ideal:i}})),o&&r(t,c?{mandatory:{maxWidth:o.width,maxHeight:o.height}}:{width:{max:o.width},height:{max:o.height}}),s&&(c?(r(t,{optional:[]}),t.optional.push({facingMode:s})):r(t,{facingMode:{ideal:s}})),t}e.exports=function(e){const t=i(e);return{constraints:function(e){return{audio:s(e),video:c(e)}}(t),publishAudio:t.audio.publish,publishVideo:t.video.publish,frameRate:t.frameRate,videoDimensions:t.videoDimensions,audioDeviceId:"string"==typeof t.audio.source?t.audio.source:void 0,videoDeviceId:"string"==typeof t.video.source?t.video.source:void 0}}},function(e,t,n){var r=n(583),i=n(192)((function(e,t,n){r(e,t,n)}));e.exports=i},function(e,t,n){var r=n(63),i=n(53);e.exports=function(e,t,n){(void 0!==n&&!i(e[t],n)||void 0===n&&!(t in e))&&r(e,t,n)}},function(e,t){e.exports=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}},function(e,t,n){"use strict";const r=n(3),i=r.name,o=r.version,a=r.isChromiumEdge;e.exports=a||"Chrome"===i&&o>=72||"Firefox"===i&&o>=66||"Opera"===i&&o>=60||"Safari"===i},function(e,t,n){var r=n(60),i=n(260);e.exports=function(e){return i(r(e).toLowerCase())}},function(e,t,n){var r=n(591)("toUpperCase");e.exports=r},function(e,t){e.exports=function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o}},function(e,t){var n=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return n.test(e)}},function(e,t,n){var r=n(593),i=n(262),o=n(594);e.exports=function(e){return i(e)?o(e):r(e)}},function(e,t,n){"use strict";const r=n(3);e.exports=Boolean(r.isChrome&&r.version>=74||r.isEdge&&r.version>=79)},function(e,t,n){"use strict";const r=n(3);e.exports=e=>!!r.isElectron&&e instanceof MediaStreamTrack&&"Screen"===e.label},function(e,t,n){var r=n(100),i=n(600)(r);e.exports=i},function(e,t,n){"use strict";e.exports=15e3},function(e,t,n){"use strict";e.exports=function(e,t){return void 0===t&&(t=!1),void 0===e?t:"true"===e||!0===e}},function(e,t,n){"use strict";const r=n(57);e.exports=function(e){const t=r(e);if(t.backgroundImageURI){const e=t.backgroundImageURI.split(":")[0];t.backgroundImageURI=-1!==["http","https","data"].indexOf(e)?e:"other"}return t}},function(e,t,n){"use strict";const r=n(3);e.exports=()=>!r.isNode&&!r.isElectron&&((r.isChrome||r.isOpera||r.isChromiumEdge)&&r.version>=74||r.isFirefox&&r.version>=68||r.isSafari&&r.version>=11)},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},function(e,t,n){var r=n(34),i=n(78),o=n(616),a=n(59),s=n(41),c=n(619),u=n(140),d=n(185),l=u((function(e,t){var n={};if(null==e)return n;var u=!1;t=r(t,(function(t){return t=a(t,e),u||(u=t.length>1),t})),s(e,d(e),n),u&&(n=i(n,7,c));for(var l=t.length;l--;)o(n,t[l]);return n}));e.exports=l},function(e,t,n){var r=n(206),i=n(36),o=n(97),a=Math.max;e.exports=function(e,t,n){var s=null==e?0:e.length;if(!s)return-1;var c=null==n?0:o(n);return c<0&&(c=a(s+c,0)),r(e,i(t,3),c)}},function(e,t,n){var r=n(621);e.exports=function(e){return e&&e.length?r(e):[]}},function(e,t,n){"use strict";const r=n(628),i=n(278),o=n(104)();e.exports=(e,t)=>{i(e,(e,n)=>{let i=[];o?"function"==typeof n.values?i=r(n.values()):"function"!=typeof n.forEach?i=Object.keys(n).map(e=>n[e]):n.forEach(e=>{i.push(e)}):n.result().forEach(e=>{const t={};e.names().forEach(n=>{t[n]=e.stat(n)}),t.id=e.id,t.type=e.type,t.timestamp=e.timestamp,i.push(t)}),t(null,i)})}},function(e,t,n){var r=n(30),i=n(12),o=n(18);e.exports=function(e){return"string"==typeof e||!i(e)&&o(e)&&"[object String]"==r(e)}},function(e,t,n){var r=n(630),i=n(31);e.exports=function(e){return null==e?[]:r(e,i(e))}},function(e,t,n){"use strict";const r=n(104)(),i=(e,t)=>{e.getStats(null).then(e=>t(null,e)).catch(t)},o=(e,t)=>{e.getStats(e=>{t(null,e)},t)};e.exports=(e,t)=>{(r?i:o)(e,t)}},function(e,t,n){"use strict";var r=n(1);t.__esModule=!0,t.default=void 0;var i=r(n(49)),o=n(14),a=r(n(38)),s=r(n(642)),c=r(n(644)),u=r(n(50));const d=(0,r(n(0)).default)("QoS");let l=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=e.call(this,...r)||this)._peerConnection=void 0,t._isPublisher=void 0,t.timeoutId=void 0,t._creationTime=(0,u.default)(),t.offerMessagesReceived=0,t.prevStats={timeStamp:(0,u.default)()},t.changeCounters={videoCodec:new c.default,audioCodec:new c.default},t}(0,i.default)(t,e);var n=t.prototype;return n.startCollecting=function(e,n){if(!e||!e.getStats)return;this._isPublisher=n;const r=Boolean(this._peerConnection);if(this._peerConnection=e,r)return;const i=e=>{const n=(0,u.default)(),r={timeStamp:n,duration:Math.round((n-this._creationTime)/1e3),period:Math.round((n-this.prevStats.timeStamp)/1e3)};(0,s.default)(this._peerConnection,this.prevStats,r,this._isPublisher,(n,r)=>{n?d.error("Failed to Parse QOS Stats:",n):(this.handleParsedStats(r),clearTimeout(this.timeoutId),this.timeoutId=setTimeout(()=>i(t.INTERVAL),e))})};this.timeoutId=setTimeout(()=>i(t.INTERVAL-t.INITIAL_INTERVAL),t.INITIAL_INTERVAL)},n.stopCollecting=function(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),this._peerConnection=null},n.handleOfferMessageReceived=function(){this.offerMessagesReceived+=1},n.handleParsedStats=function(e){Object.keys(this.changeCounters).forEach(t=>{this.changeCounters[t].onValue(e[t]),e[t+"ChangeCount"]=this.changeCounters[t].changeCount}),e.offerMessagesReceived=this.offerMessagesReceived;const t=(0,a.default)(e);if(["audioSentBytes","audioSentPackets","audioSentPacketsLost","videoSentBytes","videoSentPackets","videoSentPacketsLost","audioRecvBytes","audioRecvPackets","audioRecvPacketsLost","videoRecvBytes","videoRecvPackets","videoRecvPacketsLost"].forEach(n=>{t[n]=this.prevStats&&this.prevStats[n]?e[n]-this.prevStats[n]:e[n]}),this.prevStats&&this.prevStats.videoFramesReceived){const n=e.videoFramesReceived-this.prevStats.videoFramesReceived,r=e.period;t.videoFrameRateReceived=Math.round(n/r)}this.prevStats=e,delete t.framesDecoded,delete t.framesEncoded,this.emit("stats",t)},t}(o.EventEmitter);l.INITIAL_INTERVAL=1e3,l.INTERVAL=3e4;var f=l;t.default=f},function(e,t,n){"use strict";e.exports=e=>{switch(e>>24){case 0:return"TURN/TLS";case 1:return"TURN/TCP";case 2:return"TURN/UDP";default:return""}}},function(e,t,n){"use strict";const r=n(16),i=n(159).default,o=n(7),a=n(13);e.exports=function(e){let t=void 0===e?{}:e,n=t.haveGetDisplayMedia,s=void 0===n?i:n,c=t.global,u=void 0===c?void 0!==typeof window?window:global:c,d=t.Errors,l=void 0===d?o:d,f=t.otError,p=void 0===f?a():f;const h=!s&&!!u.navigator.webkitGetUserMedia&&!u.navigator.userAgent.match(/android/i)&&void 0!==u.chrome;return{isSupportedInThisBrowser:h,autoRegisters:!1,extensionRequired:!0,getConstraintsShowsPermissionUI:!0,sources:{screen:!0,application:!1,window:!0,browser:!0},register(e,t){return 2===t?this.registerVersion2(e):this.registerVersion1(e)},registerVersion1(e){if(!e)throw new Error("initChromeScreenSharingExtensionHelper: extensionID is required.");const t=h,n={};let i=void 0;const o="com.tokbox.screenSharing."+e,a=function(e,t){const n={payload:t,from:"jsapi"};return n[o]=e,n},s=function(e,t){let i;const o=r();return n[o]=function(){clearTimeout(i),i=null,e(...arguments)},t&&(i=setTimeout(()=>{delete n[o],e(p(l.TIMEOUT,new Error("Timeout waiting for response to screensharing request.")))},t)),o},c=function(e){if(!e)throw new Error("isAvailable: callback is required.");if(t)if(void 0!==i)setTimeout(e.bind(null,i));else{const t=s(t=>{!0!==i&&(i="extensionLoaded"===t),e(i)},2e3),n=a("isExtensionInstalled",{requestId:t});u.postMessage(n,"*")}else setTimeout(e.bind(null,!1))};return u.addEventListener("message",e=>{if(e.origin!==u.location.origin)return;if(null==e.data||"object"!=typeof e.data)return;if("extension"!==e.data.from)return;const t=e.data[o],r=e.data.payload;if(r&&r.requestId){const e=n[r.requestId];delete n[r.requestId],e&&e(t,r)}"extensionLoaded"===t&&(i=!0)}),{extensionAPIVersion:1,extensionID:e,isInstalled:c,getConstraints:function(e,t,n){if(!n)throw new Error("getSourceId: callback is required");c(r=>{if(!r)return n(p(l.SCREEN_SHARING_EXTENSION_NOT_INSTALLED,new Error("Extension is not installed")));const i=s((e,r)=>{"object"==typeof e&&e.name&&e.stack?n(e):"permissionDenied"===e?n(p(l.USER_MEDIA_ACCESS_DENIED,new Error("User denied access to screensharing"))):(t.video||(t.video={}),t.video.mandatory||(t.video.mandatory={}),t.video.mandatory.chromeMediaSource="desktop",t.video.mandatory.chromeMediaSourceId=r.sourceId,n(void 0,t))});u.postMessage(a("getSourceId",{requestId:i,source:e}),"*")})}}},registerVersion2(e){const t=h&&void 0!==u.chrome.runtime,n=function(n){if(!n)throw new Error("isAvailable: callback is required.");t?u.chrome.runtime.sendMessage(e,{type:"isInstalled"},null,e=>{setTimeout(n.bind(null,!!e))}):setTimeout(n.bind(null,!1))};return{extensionAPIVersion:2,extensionID:e,isInstalled:n,getConstraints:function(t,r,i){if(!i)throw new Error("getSourceId: callback is required");n(n=>{if(!n)return i(p(l.SCREEN_SHARING_EXTENSION_NOT_INSTALLED,new Error("Extension is not installed")));u.chrome.runtime.sendMessage(e,{type:"getSourceId",source:t},null,e=>{"permissionDenied"===e.error?i(p(l.USER_MEDIA_ACCESS_DENIED,new Error("User denied access to screensharing"))):e.error?i(new Error("UnexpectError: "+e.error)):(r.video||(r.video={}),r.video.mandatory||(r.video.mandatory={}),r.video.mandatory.chromeMediaSource="desktop",r.video.mandatory.chromeMediaSourceId=e.sourceId,i(void 0,r))})})}}}}}},function(e,t,n){"use strict";(function(t){const r=n(155),i=n(105);e.exports=function(e){void 0===e&&(e={});const o=e.Archiving||n(649),a=e.AudioLevelMeter||n(283),s=e.AudioLevelTransformer||n(144),c=e.BackingBar||n(284),u=e.Chrome||n(145),d=e.MuteButton||n(285)(),l=e.NamePanel||n(286),f=e.VideoDisabledIndicator||n(287),p=e.StylableComponent||n(152),h=e.logging||n(0)("createChromeMixin");return function(e,n){let m,g,v,y=void 0===n?{}:n,b=y.name,S=y.publishAudio,E=y.publishVideo,_=y.audioSource,T=y.showControls,R=y.shouldAllowAudio,I=y.logAnalyticsEvent;const w={},C=r(),O=t=>{if(!1===t)return"off";const n=e.getStyle("buttonDisplayMode");return!1===n?"on":n};let A=new t((t,n)=>{w.init=n=>{e.getStyle("showArchiveStatus")||I("showArchiveStatus","createChrome",{mode:"off"});const r={backingBar:new c({nameMode:b?e.getStyle("nameDisplayMode"):"off",muteMode:O(e.getStyle("buttonDisplayMode"))}),name:new l({name:b,mode:e.getStyle("nameDisplayMode")}),archive:new o({show:Boolean(e.getStyle("showArchiveStatus"))&&"off"!==e.getStyle("archiveStatusDisplayMode"),archiving:!1}),muteButton:new d({muted:!1===S,mode:O.call(null,e.getStyle("buttonDisplayMode"))})};m=new a({mode:e.getStyle("audioLevelDisplayMode")});const p=new s,h=new i(()=>{const t=S?p.transform(e.loudness):0;m.setValue(t)});m.watchVisibilityChanged(e=>{e?h.start():h.stop()}),m.audioOnly(!E&&S),r.audioLevel=m,r.videoDisabledIndicator=new f({mode:e.getStyle("videoDisabledDisplayMode")}),n&&n.domElement&&(v=n,g=new u({parent:v.domElement}).set(r).on({muted:()=>e.publishAudio(!1),unmuted:()=>e.publishAudio(!0)}),null!==_&&!1!==_||w.removeAudioTrack(),t())},w.reset=()=>{n(new Error("Chrome still being created")),g&&(g.destroy(),g=null)},w.destroy=()=>{w.reset(),C.releaseAll(),A=null}});A.catch(e=>{e&&"Chrome still being created"===e.message||h.error("createChromeMixin failed to setup UI",e)}),w.setAudioOnly=e=>{m&&m.audioOnly(e)},w.setArchivingStatus=e=>{g&&g.archive.setArchiving(e)},w.setMuted=e=>{g&&g.muteButton&&g.muteButton.muted(e)},w.removeAudioTrack=()=>{g&&g.muteButton&&g.muteButton.remove()},w.addAudioTrack=()=>{g&&g.muteButton&&g.muteButton.add()},w.videoDisabledIndicator={disableVideo:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return null==(e=g)?void 0:e.videoDisabledIndicator.disableVideo(...n)},setWarning:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return null==(e=g)?void 0:e.videoDisabledIndicator.setWarning(...n)}},p(e,{showArchiveStatus:!0,nameDisplayMode:"auto",buttonDisplayMode:"auto",videoDisabledDisplayMode:"auto",audioLevelDisplayMode:R?"auto":"off",archiveStatusDisplayMode:"auto",backgroundImageURI:null},T,e=>{I("SetStyle","Publisher",e,null,.1)});const x=(e,t)=>{A.then(()=>{switch(e){case"nameDisplayMode":g.name.setDisplayMode(t),g.backingBar.setNameMode(t);break;case"showArchiveStatus":I("showArchiveStatus","styleChange",{mode:t?"on":"off"}),g.archive.setShowArchiveStatus(Boolean(t));break;case"archiveStatusDisplayMode":g.archive.setShowArchiveStatus("off"!==t);break;case"buttonDisplayMode":g.muteButton.setDisplayMode(t),g.backingBar.setMuteMode(t);break;case"audioLevelDisplayMode":g.audioLevel.setDisplayMode(t);break;case"backgroundImageURI":v.setBackgroundImageURI(t)}})};return e.on("styleValueChanged",x),C.add(()=>e.off("styleValueChanged",x)),w}}}).call(this,n(2))},function(e,t,n){"use strict";(function(t){const r=n(106),i=n(37),o=n(8),a=n(14);e.exports=function(e){const n=this,s=new a;let c,u,d,l,f=!0,p=!1,h="auto";const m=e.maxValue||1,g=e.minValue||0;function v(){const e=(p&&"auto"===h||"on"===h)&&f;l!==e&&(l=e,s.emit("visibilityChanged",e))}r(n,{audioOnly:{get:()=>p,set(e){p=e,v()}}}),n.setValue=function(e){d=e,function(){const e=(d-g)/(m-g);u.style.transform=`scale(${Math.sqrt(e)})`}()},n.watchVisibilityChanged=function(e){return s.on("visibilityChanged",e),t.resolve().then(()=>{e(l)}),function(){s.removeListener("visibilityChanged",e)}};const y={mode:e?e.mode:"auto",nodeName:"div",htmlAttributes:{className:"OT_audio-level-meter"},onCreate:function(){u=o.createElement("div",{className:"OT_audio-level-meter__value"},""),c=o.createElement("div",{className:"OT_audio-level-meter__audio-only-img"},"");const e=n.domElement;e.appendChild(c),e.appendChild(u),n.watchVisibilityChanged(e=>{e?o.removeClass(n.domElement,"OT_hide-forced"):o.addClass(n.domElement,"OT_hide-forced")})},onDestroy:function(){s.removeAllListeners("visibilityChanged")}};i(this,y),n.setDisplayMode=function(e){h=e,v()},n.getDisplayMode=function(){return h},n.showAfterLoading=function(){f=!0,v()},n.hideWhileLoading=function(){f=!1,v()},v()}}).call(this,n(2))},function(e,t,n){"use strict";const r=n(37);e.exports=function(e){let t=e.nameMode,n=e.muteMode;function i(){return"on"===t||"on"===n?"on":"mini"===t||"mini"===n?"mini":"mini-auto"===t||"mini-auto"===n?"mini-auto":"auto"===t||"auto"===n?"auto":"off"}r(this,{mode:i(),nodeName:"div",htmlContent:"",htmlAttributes:{className:"OT_bar OT_edge-bar-item"}}),this.setNameMode=function(e){t=e,this.setDisplayMode(i())},this.setMuteMode=function(e){n=e,this.setDisplayMode(i())}}},function(e,t,n){"use strict";const r=n(8),i=n(37),o=n(106);e.exports=function(e){void 0===e&&(e={});const t=e.OTHelpers||r,n=e.Widget||i;return function(e){let r=e.muted||!1;const i=()=>{r?t.addClass(this.domElement,"OT_active"):t.removeClass(this.domElement,"OT_active ")},a=()=>(r=!r,i(),r?this.parent.trigger("muted",this):this.parent.trigger("unmuted",this),!1);o(this,{muted:{get:()=>r,set(e){r=e,i()}}});const s=r?"OT_edge-bar-item OT_mute OT_active":"OT_edge-bar-item OT_mute";let c;n(this,{mode:e.mode,nodeName:"button",htmlContent:"Mute",htmlAttributes:{className:s,type:"button"},onCreate:e=>{t.on(e,"click",a)},onDestroy:e=>{t.off(e,"click",a)}}),this.remove=()=>{this.domElement&&this.domElement.parentNode&&(c=this.domElement.parentNode,this.domElement.parentNode.removeChild(this.domElement))},this.add=()=>{c&&this.domElement&&!this.domElement.parentNode&&c.appendChild(this.domElement)}}}},function(e,t,n){"use strict";const r=n(37),i=e=>{const t=document.createElement("div");return t.textContent=e,t.innerHTML};e.exports=function(e){let t=e.name;t&&""!==t.trim().length||(t=null,e.mode="off"),this.setName=function(e){t||this.setDisplayMode("auto"),t=i(e),this.domElement.innerHTML=t}.bind(this),t=i(t),r(this,{mode:e.mode,nodeName:"h1",htmlContent:t,htmlAttributes:{className:"OT_name OT_edge-bar-item"}})}},function(e,t,n){"use strict";const r=n(37),i=n(8);e.exports=function(e){let t=!1,n=!1;const o=function(e){const r=["auto","on"].indexOf(this.getDisplayMode())>-1;i.removeClass(e,"OT_video-disabled OT_video-disabled-warning OT_active"),r&&(t?i.addClass(e,"OT_video-disabled"):n&&i.addClass(e,"OT_video-disabled-warning"),i.addClass(e,"OT_active"))}.bind(this);this.disableVideo=function(e){t=e,!0===e&&(n=!1),o(this.domElement)},this.setWarning=function(e){n=e,o(this.domElement)},r(this,{mode:e.mode||"auto",nodeName:"div",htmlAttributes:{className:"OT_video-disabled-indicator"}});const a=this.setDisplayMode.bind(this);this.setDisplayMode=function(e){a(e),o(this.domElement)}}},function(e,t,n){"use strict";e.exports=function(e){void 0===e&&(e={});const t=e.global||(void 0!==typeof window?window:global);return function(){if(t.navigator.mediaDevices){const e=t.navigator.mediaDevices;return e.enumerateDevices&&e.enumerateDevices.bind(e)}}}},function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;let r="";var i={getCurrentAudioInputDevice:()=>r,setCurrentAudioInputDevice:e=>{r=e}};t.default=i},function(e,t,n){"use strict";const r=n(3),i=n(159).default;e.exports={isSupportedInThisBrowser:!r.isLegacyEdge&&!r.isElectron&&i&&!r.isAndroid,autoRegisters:!0,extensionRequired:!1,getConstraintsShowsPermissionUI:!1,sources:{screen:!0,application:!1,window:"Safari"!==r.name,browser:"Safari"!==r.name},register:()=>({isInstalled(e){e(void 0)},getConstraints(e,t,n){n(void 0,{video:t.video,audio:t.audio})}})}},function(e,t,n){"use strict";t.isMediaStreamTrack=e=>e&&"object"==typeof e&&"string"==typeof e.kind&&"function"==typeof e.stop&&"boolean"==typeof e.enabled},function(e,t,n){"use strict";n.r(t),function(e){var n=function(t,n,r,i){return new(r||(r=e))((function(e,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(t){t.done?e(t.value):new r((function(e){e(t.value)})).then(a,s)}c((i=i.apply(t,n||[])).next())}))},r=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function i(){return"undefined"!=typeof window||void 0!==typeof window?window:global}t.default=function(t,o,a){return void 0===a&&(a=10),function(){for(var s=[],c=0;c<arguments.length;c++)s[c]=arguments[c];return n(this,void 0,void 0,(function(){var n,c,u;return r(this,(function(d){switch(d.label){case 0:n=0,c=function(){var c,u,d;return r(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,6]),c={},[4,t.apply(void 0,s)];case 1:return[2,(c.value=r.sent(),c)];case 2:if(u=r.sent(),!1===(d=o(u,n))||null==d||n>=a)throw u;return"number"!=typeof d?[3,4]:[4,new e((function(e){return i().setTimeout(e,d)}))];case 3:return r.sent(),[3,5];case 4:if(!0!==d)throw new Error("onFailure must return boolean, or delay in ms");r.label=5;case 5:return[3,6];case 6:return[2]}}))},d.label=1;case 1:return(n+=1)?[5,c()]:[3,3];case 2:return"object"==typeof(u=d.sent())?[2,u.value]:[3,1];case 3:return[2]}}))}))}}}.call(this,n(2))},function(e,t,n){"use strict";const r=n(0)("videoContentHint"),i=["","text","motion","detail"],o=e=>i.includes(e),a=e=>{var t;return null==e||null==(t=e.getVideoTracks())?void 0:t[0]};e.exports={isValidVideoContentHint:o,setVideoContentHint:(e,t)=>{if(!o(t))return void r.warn('Invalid content hint. Valid content hints are "text", "detail", "motion", or ""');const n=a(e);n?void 0!==n.contentHint?n.contentHint=t:r.warn("contentHint not supported by this browser"):r.warn("Tried to set contentHint but no video track is present")},getVideoContentHint:e=>{const t=a(e);return(null==t?void 0:t.contentHint)||""}}},function(e,t,n){"use strict";const r=n(106);e.exports=function(){return function(e,t){let n;r(this,{muted:{get:()=>n,set(t){if(n===t)return;n=t;const r=e.getAudioTracks();for(let e=0,t=r.length;e<t;++e)r[e].enabled=!n}}}),void 0!==t?this.muted(!0===t):e.getAudioTracks().length?this.muted(!e.getAudioTracks()[0].enabled):this.muted(!1)}}},function(e,t,n){"use strict";e.exports=function(e){void 0===e&&(e={});const t=e.Errors||n(7),r=e.otError||n(13)(),i={};return(void 0!==typeof window?window:global).MediaError&&(i[(void 0!==typeof window?window:global).MediaError.MEDIA_ERR_ABORTED]={name:t.MEDIA_ERR_ABORTED,message:"The fetching process for the media resource was aborted by the user agent at the user's request."},i[(void 0!==typeof window?window:global).MediaError.MEDIA_ERR_NETWORK]={name:t.MEDIA_ERR_NETWORK,message:"A network error of some description caused the user agent to stop fetching the media resource, after the resource was established to be usable."},i[(void 0!==typeof window?window:global).MediaError.MEDIA_ERR_DECODE]={name:t.MEDIA_ERR_DECODE,message:"An error of some description occurred while decoding the media resource, after the resource was established to be usable."},i[(void 0!==typeof window?window:global).MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED]={name:t.MEDIA_ERR_SRC_NOT_SUPPORTED,message:"The media resource indicated by the src attribute was not suitable."}),function(e){const t=i[e.code];return t?r(t.name,new Error("There was an unexpected problem with the Video Stream: "+t.message)):new Error("An unknown error occurred"+(e.message?": "+e.message:"."))}}},function(e,t,n){"use strict";(function(t){var r=n(1),i=r(n(4)),o=r(n(5));const a=n(6),s=n(62),c=n(660),u=n(661),d=n(662),l=n(108),f=n(3),p=n(20)().hasAudioOutputApiSupport,h=n(297),m=n(107).getCurrentAudioOutputDeviceId;function g(e,t){const n=document.createElement("video");return u(n),n.autoplay=!0,n.playsinline=!0,n.innerHTML=e,n.setAttribute("autoplay",""),n.setAttribute("playsinline",""),!0===t&&(n.muted="true"),n}function v(){const e=g("");return e.setAttribute("style","display:none"),e}e.exports=function(e){void 0===e&&(e={});const r=e.audioContext||n(158)(),u=e.canBeOrientatedMixin||n(663),y=e.document||(void 0!==typeof window?window:global).document,b=e.listenForTracksEnded||n(664)(),S=e.logging||n(0),E=e.OTHelpers||n(8),_=e.videoElementErrorMap||n(295)(),T=e.WebaudioAudioLevelSampler||n(146),R=e.global||(void 0!==typeof window?window:global);let I=1;return function(){function e(e,t){var n=this;let r=e._inject,c=void 0===r?{}:r,d=c.createVideoElement,l=void 0===d?g:d,p=c.createAudioOnlyVideoElement,m=void 0===p?v:p,y=e.muted,b=e.fallbackText,E=e.widgetType;this._domElement=void 0,this._domAudioOnlyVideoElement=void 0,this._blockedVolume=void 0,this._mediaStoppedListener=void 0,this._audioLevelSampler=void 0,this._playInterrupts=0,this._isVideoLoadedMetaData=!1,this._audioOnlyVideoElementWatcher=void 0,this._blinkStartTime=null,this.logging=S("NativeVideoElementWrapper:"+I),I+=1,a(this),this._defaultAudioVolume=t,this._widgetType=E,this._emitVideoPlayAttempt=()=>{this._blinkStartTime=(new Date).getTime(),this.trigger("amrLogEvent","AMRTransitionVideo","Attempt")},this._emitVideoPlaySuccess=()=>{const e=(new Date).getTime()-this._blinkStartTime;this.trigger("amrLogEvent","AMRTransitionVideo","Success",{attemptDuration:e}),this._blinkStartTime=null},this._emitVideoPlayFailure=()=>{this.trigger("amrLogEvent","AMRTransitionVideo","Failure")};let T=!1;this._domElement=l(b,y),this.trigger("videoElementCreated",this._domElement),this._domElementEvents=s(this._domElement),this._domElementEvents.on("loadstart",()=>this._onDomElementLoadStart()),this._domElementEvents.on("timeupdate",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.trigger("timeupdate",...t)})),this._domElementEvents.on("loadedmetadata",(0,o.default)(i.default.mark((function e(){var t,r,o,a,s=arguments;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n._isVideoLoadedMetaData=!0,t=s.length,r=new Array(t),o=0;o<t;o++)r[o]=s[o];if(n.trigger("loadedmetadata",...r),!n._domAudioOnlyVideoElement){e.next=10;break}if(a=n._domAudioOnlyVideoElement.srcObject,n._removeAudioOnlyVideoElement(),!a){e.next=10;break}return e.next=9,h();case 9:n.play();case 10:case"end":return e.stop()}}),e)})))),this._domElementEvents.on("error",e=>{this.trigger("error",_(e.target.error))},!1),this._domElementEvents.on("pause",()=>{T||(this.logging.warn("Video element paused, auto-resuming. If you intended to do this, use publishVideo(false) or subscribeToVideo(false) instead."),T=!0),this.play()}),this.on("destroyed",()=>{this._domElementEvents.removeAll(),this._domAudioOnlyVideoElementEvents&&this._domAudioOnlyVideoElementEvents.removeAll()}),u(this,()=>this._domElement),f.isSafari&&"subscriber"===this._widgetType&&(this._domAudioOnlyVideoElement=m(),this._bindAudioOnlyVideoElementEvents())}var n=e.prototype;return n._onDomElementLoadStart=function(){var e=(0,o.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("subscriber"!==this._widgetType||!p()){e.next=3;break}return e.next=3,this._setActiveAudioOutputDevice();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n._setActiveAudioOutputDevice=function(){var e=(0,o.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==(t=m())&&"default"!==t){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.setSinkId(t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n._rebindSrcObject=function(){this._domElement&&(this._domElement.srcObject=this._domElement.srcObject)},n._pauseAndPlay=function(){this._domElement&&(this._domElement.pause(),this._domElement.play())},n._startAudioOnlyVideoElementWatcher=function(){var e=(0,o.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=f.isiOS,this._audioOnlyVideoElementWatcher=setInterval(()=>{this._domAudioOnlyVideoElement&&this._domAudioOnlyVideoElement.paused&&(this._domAudioOnlyVideoElement.srcObject=this._domAudioOnlyVideoElement.srcObject,t&&this._domAudioOnlyVideoElement.play())},100),e.next=5,l(1e3);case 5:clearInterval(this._audioOnlyVideoElementWatcher),this._audioOnlyVideoElementWatcher=null;case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n._removeAudioOnlyVideoElement=function(){var e=(0,o.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._domAudioOnlyVideoElement.srcObject=null,this._domAudioOnlyVideoElement.parentNode.removeChild(this._domAudioOnlyVideoElement),this._domAudioOnlyVideoElementEvents&&this._domAudioOnlyVideoElementEvents.removeAll(),this._domAudioOnlyVideoElement=null;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.bindAudioTrackOnly=function(){var e=(0,o.default)(i.default.mark((function e(){var t,n,r,o,a,s,c;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._stream.getVideoTracks(),n=this._stream.getAudioTracks(),r=t[0],o=void 0===r?{}:r,a=n[0],s=void 0===a?{}:a,e.next=6,h();case 6:c=!o.enabled&&s.enabled,!this._isVideoLoadedMetaData&&c&&this._domAudioOnlyVideoElement&&(this._domAudioOnlyVideoElement.srcObject=new R.MediaStream(n),this._startAudioOnlyVideoElementWatcher());case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n._bindAudioOnlyVideoElementEvents=function(){var e=this;this._domAudioOnlyVideoElementEvents=s(this._domAudioOnlyVideoElement),this._domAudioOnlyVideoElementEvents.on("pause",()=>this.play()),this._domAudioOnlyVideoElementEvents.on("timeupdate",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.trigger("timeupdate",...n)})),this._domAudioOnlyVideoElementEvents.on("loadedmetadata",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.trigger("loadedmetadata",...n)}))},n.whenTimeIncrements=function(e,t){this.once("timeupdate",()=>{e.call(t,this)})},n.domElement=function(){return this._domElement},n.videoWidth=function(){return this._domElement?Number(this._domElement["video"+(this.isRotated()?"Height":"Width")]):0},n.videoHeight=function(){return this._domElement?Number(this._domElement["video"+(this.isRotated()?"Width":"Height")]):0},n.aspectRatio=function(){return this.videoWidth()/this.videoHeight()},n.imgData=function(){const e=E.createElement("canvas",{width:this.videoWidth(),height:this.videoHeight(),style:{display:"none"}});y.body.appendChild(e);let t=null;try{e.getContext("2d").drawImage(this._domElement,0,0,e.width,e.height),t=e.toDataURL("image/png")}catch(e){}return E.removeElement(e),null===t||"data:,"===t?(this.logging.warn("Cannot get image data yet"),null):t.replace("data:image/png;base64,","").trim()},n.appendTo=function(e){return e.appendChild(this._domElement),this._domAudioOnlyVideoElement&&e.appendChild(this._domAudioOnlyVideoElement),this},n.isAudioBlocked=function(){return void 0!==this._blockedVolume},n.unblockAudio=function(){var e=(0,o.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isAudioBlocked()){e.next=3;break}return this.logging.warn("Unexpected call to unblockAudio() without blocked audio"),e.abrupt("return");case 3:return t=this._blockedVolume,this._blockedVolume=void 0,this.setAudioVolume(t),e.prev=6,e.next=9,this.play();case 9:e.next=16;break;case 11:throw e.prev=11,e.t0=e.catch(6),this._blockedVolume=t,this._domElement.muted=!0,e.t0;case 16:this.trigger("audioUnblocked");case 17:case"end":return e.stop()}}),e,this,[[6,11]])})));return function(){return e.apply(this,arguments)}}(),n.rebind=function(){var e=(0,o.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._domElement){e.next=2;break}throw new Error("Can't rebind because _domElement no longer exists");case 2:this._playInterrupts++,this._domElement.srcObject=this._domElement.srcObject,this._hasAudioOnlyVideoElement()&&(this._domAudioOnlyVideoElement.srcObject=this._domAudioOnlyVideoElement.srcObject);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n._createAudioLevelSampler=function(){if(this._removeAudioLevelSampler(),this._stream.getAudioTracks().length>0){try{this._audioContext=r()}catch(e){this.logging.warn("Failed to get AudioContext(), audio level visualisation will not work",e)}this._audioContext&&(this._audioLevelSampler=new T(this._audioContext),this._audioLevelSampler.webRTCStream(this._stream))}},n._removeAudioLevelSampler=function(){this._audioContext&&(delete this._audioContext,delete this._audioLevelSampler)},n._toggleVideoTracks=function(){var e=(0,o.default)(i.default.mark((function e(){var t,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((t=this._domElement.srcObject.getTracks().filter(e=>e.enabled)).length>1)){e.next=8;break}return(n=t.filter(e=>"video"===e.kind)).forEach(e=>{e.enabled=!1}),e.next=7,h();case 7:n.forEach(e=>{e.enabled=!0});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n._hasAudioOnlyVideoElement=function(){return this._domAudioOnlyVideoElement&&this._domAudioOnlyVideoElement.srcObject},n.play=function(){var e=(0,o.default)(i.default.mark((function e(){var t,n,r,o,a,s,c,u,l,p;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._playInterrupts,n=this._hasAudioOnlyVideoElement()?this._domAudioOnlyVideoElement:this._domElement,!f.isSafari){e.next=5;break}return e.next=5,h();case 5:if(!f.isiOS||!f.isSafari){e.next=15;break}if("publisher"!==this._widgetType){e.next=14;break}if(r=f.iOSVersion>=14&&f.iOSVersion<=14.2,o=this._stream.getVideoTracks(),a=o[0],s=void 0===a?{}:a,c=this._stream.getAudioTracks(),u=c[0],l=void 0===u?{}:u,!r||d(n)||!s.enabled){e.next=12;break}return e.abrupt("return");case 12:if(!l.muted){e.next=14;break}return e.abrupt("return");case 14:this._toggleVideoTracks();case 15:return e.prev=15,this._emitVideoPlayAttempt(),e.next=19,n.play();case 19:return this._emitVideoPlaySuccess(),e.abrupt("return");case 23:if(e.prev=23,e.t0=e.catch(15),this._emitVideoPlayFailure(),p=e.t0||{},"AbortError"===p.name&&this._playInterrupts++,!(this._playInterrupts>t)){e.next=33;break}return e.next=32,this.play();case 32:return e.abrupt("return");case 33:throw e.t0;case 34:case"end":return e.stop()}}),e,this,[[15,23]])})));return function(){return e.apply(this,arguments)}}(),n._bindToStream=function(e){this._stream=e,this._domElement.srcObject=e,this._domAudioOnlyVideoElement&&this.bindAudioTrackOnly()},n.bindToStream=function(){var e=(0,o.default)(i.default.mark((function e(t){var n,r,a,s=this;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._domElement){e.next=2;break}throw new Error("Can't bind because _domElement no longer exists");case 2:return this._bindToStream(t),(0,o.default)(i.default.mark((function e(){var n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.play();case 3:e.next=26;break;case 5:if(e.prev=5,e.t0=e.catch(0),n=!!t.getAudioTracks().length,!s._hasAudioOnlyVideoElement()||"NotAllowedError"!==e.t0.name){e.next=15;break}return s._domAudioOnlyVideoElement.muted=!0,e.next=12,s.play();case 12:s._domAudioOnlyVideoElement.muted=!1,e.next=26;break;case 15:if(!n){e.next=23;break}return s._blockedVolume=s.getAudioVolume(),s._domElement.muted=!0,e.next=20,s.play();case 20:s.trigger("audioBlocked"),e.next=26;break;case 23:return s._domElement.muted=!0,e.next=26,s.play();case 26:case"end":return e.stop()}}),e,null,[[0,5]])})))().catch(e=>{this.logging.debug(".play() failed: ",e)}),n={width:this._domElement.videoWidth,height:this._domElement.videoHeight},this.trigger("videoDimensionsChanged",Object.assign({},n),Object.assign({},n)),this._domElementEvents.on("resize",()=>{const e=this._domElement,t=e.videoWidth,r=e.videoHeight,i=t!==n.width,o=r!==n.height;(i||o)&&(this.trigger("videoDimensionsChanged",Object.assign({},n),{width:t,height:r}),n.width=t,n.height=r)}),r=()=>{this._mediaStoppedListener.stop(),this._domElement&&(this._domElement.onended=null),this.trigger("mediaStopped")},a=e=>{this.trigger("mediaStopped",e)},this._domElement.onended=()=>r(),this._mediaStoppedListener=b(t,r,a),this._createAudioLevelSampler(),e.abrupt("return",void 0);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.unbindStream=function(){return this._domElement&&(this._domElement.srcObject=null),this._domAudioOnlyVideoElement&&(this._domAudioOnlyVideoElement.srcObject=null),this._removeAudioLevelSampler(),this},n.setAudioVolume=function(e){if(this.isAudioBlocked())return void(this._blockedVolume=e);const t=parseFloat(e)/100,n=[this.domElement()];this._domAudioOnlyVideoElement&&n.push(this._domAudioOnlyVideoElement),n.forEach(e=>{e&&(e.volume=t,e.muted=0===t)})},n.getAudioVolume=function(){if(this.isAudioBlocked())return this._blockedVolume;const e=this.domElement();return e?e.muted?0:100*e.volume:this._defaultAudioVolume},n.audioChannelType=function(e){const t=this.domElement();return void 0!==e&&(t.mozAudioChannelType=e),"mozAudioChannelType"in this._domElement?t.mozAudioChannelType:"unknown"},n.getAudioInputLevel=function(){return this._audioLevelSampler.sample()},n.refreshTracks=function(){this._mediaStoppedListener&&this._mediaStoppedListener.refresh(),this._createAudioLevelSampler()},n.destroy=function(){this._mediaStoppedListener&&this._mediaStoppedListener.stop(),this.logging.debug("removing domElementEvents"),this._domElementEvents.removeAll(),this._domAudioOnlyVideoElementEvents&&this._domAudioOnlyVideoElementEvents.removeAll(),this._audioOnlyVideoElementWatcher&&clearInterval(this._audioOnlyVideoElementWatcher),this.unbindStream(),this._domElement&&(E.removeElement(this._domElement),this._domElement=null),this._domAudioOnlyVideoElement&&(E.removeElement(this._domAudioOnlyVideoElement),this._domAudioOnlyVideoElement=null),this.trigger("destroyed"),c("NativeVideoElementWrapper",this)},n.setSinkId=function(e){const n=[this._domElement,this._domAudioOnlyVideoElement].map(t=>{if(t)return t.setSinkId(e)});return t.all(n)},e}()}}).call(this,n(2))},function(e,t,n){"use strict";(function(t){e.exports=()=>new t(e=>setTimeout(e))}).call(this,n(2))},function(e,t,n){"use strict";(function(t){var r=n(1),i=r(n(4)),o=r(n(5)),a=r(n(665)),s=r(n(666)),c=r(n(671)),u=r(n(0)),d=n(29),l=r(n(75)),f=r(n(675));const p=l.default.ACTIVE_VIDEO,h=l.default.SUSPENDED_VIDEO,m=n(9),g=n(48),v=n(61),y=n(6),b=n(303),S=n(304),E=n(677),_=(0,u.default)("PublisherPeerConnection");e.exports=function(e){void 0===e&&(e={});const r=e.getStatsHelpers||n(76),u=e.OTHelpers||n(8),l=e.PeerConnection||n(72)(),T=e.setCertificates||n(163)(),R=e.watchAudioAcquisition||n(679),I=e.createAudioFallbackStateMachine||a.default,w=e.createCongestionLevelEstimator||s.default,C=e.createNetworkQualityMonitor||c.default,O=e.getDelayForAmrProbe||f.default;return function(e){var n=this;let a,s,c,f,A,x=e.iceConfig,k=e.webRTCStream,N=e.channels,L=e.sendMessage,M=e.capableSimulcastStreams,V=e.overrideSimulcastEnabled,P=e.logAnalyticsEvent,D=e.offerOverrides,Z=e.answerOverrides,j=e.sourceStreamId,W=e.isP2pEnabled,G=e.sessionId,F=e.keyStore,U=e.sFrameClientStore,X=e.isE2ee,B=e.audioFallbackEnabled,H=e.resolution,Y=!1;const J=function(){this.destroy(),Y&&(Y=!1,this.trigger("iceRestartFailure")),this.trigger("disconnected")},z=function(e){let t=e.reason,n=e.prefix;this.trigger("error",{reason:t,prefix:n})},K=function(e){Y&&a.iceConnectionStateIsConnected()&&(Y=!1,this.trigger("iceRestartSuccess")),"connected"===e&&("Chrome"===u.env.name&&(s&&s(),s=R(a.getStats.bind(a),()=>this.trigger("audioAcquisitionProblem"))),this.trigger("connected")),this.trigger("iceConnectionStateChange",e)};this._setVideoTrackEncodingActiveState=function(){var e=(0,o.default)(i.default.mark((function e(t){var r,o;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.getSenders().find(e=>"video"===e.track.kind),(o=r.getParameters()).encodings.forEach(e=>{e.active=t}),e.prev=3,e.next=6,r.setParameters(o);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),_.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[3,8]])})));return function(t){return e.apply(this,arguments)}}(),y(this),this.setCongestionLevel=e=>{var t;null==(t=c)||t.setCongestionLevel(e)},this.getAudioFallbackState=()=>{var e;return null==(e=c)?void 0:e.getState()},this.startEncryption=e=>{a&&a.startEncryption(e)},this.changeMediaDirectionToInactive=()=>{a&&a.changeMediaDirectionToInactive()},this.changeMediaDirectionToRecvOnly=()=>{a&&a.changeMediaDirectionToRecvOnly()},this.getDataChannel=function(e,t,n){a.getDataChannel(e,t,n)},this.getSourceStreamId=()=>a.getSourceStreamId(),this.destroy=function(){var e,t;null==(e=f)||e.stop(),null==(t=A)||t.stop(),s&&(s(),s=null),a&&(a.disconnect(),a=null),this.off()},this.processMessage=function(e,t){a.processMessage(e,t)},this.addTrack=function(e,t,n){return a.addTrack(e,t,n)},this.removeTrack=function(e){return a.removeTrack(e)},this.getLocalStreams=function(){return a.getLocalStreams()},this.init=function(e,t){b(j)&&S(x);const n={iceConfig:x.needRumorIceServersFallback?m(x,{servers:[...e,...x.servers]}):x,channels:N,capableSimulcastStreams:M,overrideSimulcastEnabled:V};T(n,(e,n)=>{if(e)return void t(e);const r=m({logAnalyticsEvent:P,isPublisher:!0,offerOverrides:D,answerOverrides:Z,sourceStreamId:j,p2p:W,sessionId:G,keyStore:F,sFrameClientStore:U,isE2ee:X},n);a=new l(m({sendMessage:L},r)),a.on({close:J,error:z,qos:e=>this.trigger("qos",e),iceConnectionStateChange:K},this),a.addLocalStream(k).then(()=>{t(void 0)}).catch(t)})},this.setIceConfig=e=>{a.setIceConfig(e)},this.generateOffer=()=>{a.generateOfferAndSend()},this.getSenders=function(){return a.getSenders()},this.iceRestart=function(){a&&(Y=!0,a.iceRestart())},this.hasRelayCandidates=()=>a.hasRelayCandidates(),this.iceConnectionStateIsConnected=function(){return a.iceConnectionStateIsConnected()},this.findAndReplaceTrack=(e,t)=>a.findAndReplaceTrack(e,t),this._testOnlyGetFramesEncoded=()=>new t((e,t)=>{a.getStats((n,i)=>{if(n)return void t(n);const o=v(i,e=>r.isVideoStat(e,i)&&r.isOutboundStat(e));o?e(g(o,["timestamp","framesEncoded"])):t(new Error("Could not find framesEncoded in getStats report"))})}),this.getStats=e=>a.getStats(e),this.getRtcStatsReport=e=>a.getRtcStatsReport(e),this.setVideoActiveState=e=>{this._setVideoTrackEncodingActiveState(e),B&&(e?this.enableCongestionLevelEstimation():this.disableCongestionLevelEstimation())},this.setP2PMaxBitrate=(0,o.default)(i.default.mark((function e(){var t,r,o,a,s,c,u;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("P2P"===n.getSourceStreamId()){e.next=2;break}return e.abrupt("return");case 2:if(r=n.getSenders().find(e=>"video"===e.track.kind)){e.next=5;break}return e.abrupt("return");case 5:return o=(null==r||null==(t=r.track)||null==t.getSettings?void 0:t.getSettings())||{},a=o.width,s=o.height,c=E(a,s),(u=r.getParameters()).encodings.forEach(e=>{e.maxBitrate=c}),e.prev=9,e.next=12,r.setParameters(u);case 12:e.next=16;break;case 14:e.prev=14,e.t0=e.catch(9);case 16:case"end":return e.stop()}}),e,null,[[9,14]])})));const Q=function(e){var t,r;let i=(void 0===e?{}:e).isAmrTransition,o=void 0!==i&&i;n._setVideoTrackEncodingActiveState(!1),null==(t=f)||t.stop(),null==(r=A)||r.start(o?{getDelayForProbeNumber:O}:{})};this.disableCongestionLevelEstimation=()=>{var e,t,n;B&&(null==(e=f)||e.stop(),null==(t=A)||t.stop(),null==(n=c)||n.reset())},this.enableCongestionLevelEstimation=e=>{if(B){var t,n;if(null==(t=A)||t.stop(),e){if(c.setInternalState(e),e.videoState===h)return void Q({isAmrTransition:!0})}else c.setCongestionLevel(d.CongestionLevels.LOW);null==(n=f)||n.start()}};const q=()=>{c=I(),c.on("stateChange",e=>{let t=e.state;switch(t){case p:this._setVideoTrackEncodingActiveState(!0);break;case h:Q()}this.trigger("audioFallbackStateChange",{state:t})}),f.on("congestionLevel",e=>{var t;null==(t=c)||t.setCongestionLevel(e)}),A.on("networkRecovered",()=>{var e,t;null==(e=c)||e.setCongestionLevel(d.CongestionLevels.LOW),null==(t=f)||t.start()})},$=()=>{f=w({resolution:H,getStats:this.getStats}),this.on("connected",()=>{f.start()})};B&&((()=>{A=C({getStats:this.getStats,setVideoActive:this._setVideoTrackEncodingActiveState})})(),$(),q())}}}).call(this,n(2))},function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}(n(669));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}const o=n(14);var a=function(e,t){void 0===t&&(t={});const n=t.StatsUtils||r,i=new o;let a;const s=()=>{e((e,t)=>{e||(e=>{const t=n.parseStats(e);if(!a)return void(a=t);const r=n.getAudioPacketLoss(t,a),o=n.getVideoPacketLoss(t,a),s=t.bandwidth;a=t,i.emit("statsAvailable",{audioPacketLoss:r,videoPacketLoss:o,bandwidth:s})})(t)})};let c;return Object.assign(i,{start(){c||(c=setTimeout(()=>{s(),c=setInterval(()=>{s()},500)},1e3))},stop(){clearInterval(c),c=void 0,a=void 0}})};t.default=a},function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=function(e){void 0===e&&(e=0);let t,n=e,r=1e4;return{setPeriod(e){r=e},getMovingAverageValue:()=>n,addValue(e){const i=(()=>{const e=Date.now();if(!t)return t=e,1;const n=e-t,i=1-Math.exp(-n/r);return t=e,i})();n=e*i+n*(1-i)},reset(){n=e,t=void 0}}};t.default=r},function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=n(302);const i=30*r.ONE_SECOND_IN_MS,o=2*r.ONE_MINUTE_IN_MS,a=[i,r.ONE_MINUTE_IN_MS,o];var s=e=>{var t;return null!=(t=a[e])?t:a[a.length-1]};t.default=s},function(e,t,n){"use strict";t.__esModule=!0,t.ONE_SECOND_IN_MS=t.ONE_MINUTE_IN_MS=void 0,t.ONE_SECOND_IN_MS=1e3,t.ONE_MINUTE_IN_MS=6e4},function(e,t,n){"use strict";const r=n(676);e.exports=e=>"P2P"===e&&r()},function(e,t,n){"use strict";e.exports=e=>{e.transportPolicy="relay",e.customServers=e.customServers||[]}},function(e,t,n){"use strict";const r=n(9),i=n(6),o=n(303),a=n(304);e.exports=function(e){void 0===e&&(e={});const t=e.OTHelpers||n(8),s=e.PeerConnection||n(72)(),c=e.SinglePeerConnectionAdapter||n(680)(),u=e.setCertificates||n(163)(),d=e.Errors||n(7),l=e.ExceptionCodes||n(10),f=e.OTErrorClass||n(23),p=e.watchSubscriberAudio||n(681);return function(e){let n=e.clientCandidates,h=e.iceConfig,m=e.send,g=e.logAnalyticsEvent,v=e.p2p,y=e.codecFlags,b=e.sourceStreamId,S=e.remoteConnectionId,E=e._singlePeerConnectionController,_=e.keyStore,T=e.sFrameClientStore,R=e.isE2ee;const I=this;let w,C=!1,O=!1,A=null;const x=!!E;let k=!1;const N=[],L=[],M=function(){this.destroy(),O&&this.trigger("iceRestartFailure",this),this.trigger("disconnected",this)},V=e=>{this.trigger("remoteStreamRemoved",e,this)},P=e=>{k||(e.onremovetrack=t=>{let n=t.track;(e=>{const t="video"===e.kind?N:L,n=t.indexOf(e);n>-1&&t.splice(n,1)})(n),x&&w&&w.removeTrack(n),setTimeout(()=>{N.length||L.length||V(e)},100)},k=!0)},D=e=>{const t=e.stream;(e=>{const t="video"===e.kind?N:L;t.includes(e)||t.push(e)})(e.track),P(t),this.trigger("remoteTrackAdded",e,this)},Z=e=>{this.trigger("remoteVideoSupported",e)},j=()=>{this.trigger("decryptFailed")},W=()=>{this.trigger("decryptRestored")},G=function(e){let t=e.reason,n=e.prefix;this.trigger("error",null,t,this,n)},F=function(e){!O||"connected"!==e&&"completed"!==e||(O=!1,this.trigger("iceRestartSuccess")),"connected"===e&&this.trigger("connected"),this.trigger("iceConnectionStateChange",e)},U=function(e){this.trigger("signalingStateChange",e)},X=function(e){this.trigger("signalingStateStable",e)},B=(e,t)=>{"answer"!==e&&"pranswer"!==e||this.trigger("connected"),m(e,t)};i(this),this._hasAudioTracks=()=>L.length>0,this._hasVideoTracks=()=>N.length>0,this._getVideoTracks=()=>N,this._getAudioTracks=()=>L,this._getTracks=()=>[...L,...N],this.close=function(){C||(C=!0,w&&(w.disconnect(),w=null),this.off())},this.destroy=function(){this.stopAudioStatsWatcher(),C||this.close()},this.getDataChannel=function(e,t,n){w.getDataChannel(e,t,n)},this.getSourceStreamId=()=>w.getSourceStreamId(),this.processMessage=function(e,t){w.processMessage(e,t)},this.remoteDescription=function(){return w.remoteDescription()},this.getStats=function(e){if(w)w.getStats(e);else{const n=l.PEER_CONNECTION_NOT_CONNECTED;e(new t.Error(f.getTitleByCode(n),d.PEER_CONNECTION_NOT_CONNECTED,{code:n}))}},this.getSynchronizationSources=function(e){if(w)w.getSynchronizationSources(e);else{const n=l.PEER_CONNECTION_NOT_CONNECTED;e(new t.Error(f.getTitleByCode(n),d.PEER_CONNECTION_NOT_CONNECTED,{code:n}))}},this.getRtcStatsReport=function(e){if(w)w.getRtcStatsReport(e);else{const n=l.PEER_CONNECTION_NOT_CONNECTED;e(new t.Error(f.getTitleByCode(n),d.PEER_CONNECTION_NOT_CONNECTED,{code:n}))}},this.setIceConfig=e=>{w.setIceConfig(e)},this.generateOffer=()=>{w.generateOfferAndSend()},this.startAudioStatsWatcher=function(e){A||(A=p(w.getStats.bind(w),e=>{this.stopAudioStatsWatcher(),this.trigger("audioLevelStuckWarning",e)},e))},this.stopAudioStatsWatcher=function(){A&&A.stop(),A=null};const H=function(e){return function(t){const n="video"===e?N:L;w&&w.remoteTracks().forEach(r=>{r.kind===e&&r.enabled!==t&&n.includes(r)&&(r.enabled=t)})}};this.subscribeToAudio=H("audio"),this.subscribeToVideo=H("video"),this.hasRelayCandidates=function(){return w.hasRelayCandidates()},this.iceRestart=function(){return O=!0,w.iceRestart()},this.iceConnectionStateIsConnected=function(){return w.iceConnectionStateIsConnected()},this.init=function(e){o(b)&&a(h),u({iceConfig:h},(t,i)=>{if(t)return void e(t);const o=r({logAnalyticsEvent:g,clientCandidates:n,codecFlags:y,sourceStreamId:b,keyStore:_,sFrameClientStore:T,isE2ee:R},i),a=r({sendMessage:B,p2p:v},o,{remoteConnectionId:S});w=x?new c(a,E):new s(a),w.on({iceConnected:()=>I.emit("iceConnected"),close:M,trackAdded:D,signalingStateChange:U,signalingStateStable:X,error:G,qos:e=>this.trigger("qos",e),iceConnectionStateChange:F,remoteVideoSupported:Z,decryptFailed:j,decryptRestored:W},I),!x&&w.remoteTracks().length>0?w.remoteStreams().forEach(e=>{e.getTracks().forEach(t=>D({stream:e,track:t}))}):e(void 0,I)})}}}},function(e,t,n){"use strict";e.exports=(e,t)=>{e.forEach((n,r)=>{(n.id||n)===(t.id||t)&&e.splice(r,1)})}},function(e,t,n){"use strict";e.exports=function(e){void 0===e&&(e={});const t=(e.generateSimpleStateMachine||n(160)())("NotPublishing",["NotPublishing","GetUserMedia","BindingMedia","MediaBound","PublishingToSession","Publishing","Failed","Destroyed"],{NotPublishing:["NotPublishing","GetUserMedia","Destroyed"],GetUserMedia:["BindingMedia","Failed","NotPublishing","Destroyed"],BindingMedia:["MediaBound","Failed","NotPublishing","Destroyed"],MediaBound:["NotPublishing","PublishingToSession","Failed","Destroyed"],PublishingToSession:["NotPublishing","Publishing","Failed","Destroyed","MediaBound"],Publishing:["NotPublishing","MediaBound","Failed","Destroyed"],Failed:["Destroyed"],Destroyed:[]});return t.prototype.isDestroyed=function(){return"Destroyed"===this.current},t.prototype.isAttemptingToPublish=function(){return-1!==["GetUserMedia","BindingMedia","MediaBound","PublishingToSession"].indexOf(this.current)},t.prototype.isPublishing=function(){return"Publishing"===this.current},t}},function(e,t,n){"use strict";function r(e){this.message=e||"Operation has been canceled.",this.name="CancellationError",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,r.prototype=Object.create(Error.prototype),r.prototype.constructor=r},function(e,t,n){var r=n(2);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return r.resolve(e).then(e=>r.resolve(t()).then(()=>e),e=>r.resolve(t()).then(()=>r.reject(e)))}},function(e,t,n){"use strict";(function(t){var r=n(1),i=r(n(4)),o=r(n(5)),a=r(n(691));const s=n(141),c=n(255),u=n(9),d=n(277),l=n(58),f=n(51),p=n(166).CancellationError,h=n(16),m=n(14),g=n(50),v=n(268),y=n(26),b=n(6),S=n(105),E=n(62),_=n(692),T=n(7),R=n(165)(),I=n(693),w=n(283),C=n(144),O=n(284),A=n(145),x=n(3),k=n(7),N=n(24)(),L=n(10),M=n(76),V=n(311),P=n(312),D=n(694),Z=n(162)(),j=n(0)("Subscriber"),W=n(285)(),G=n(286),F=n(13)(),U=n(23),X=n(8),B=n(152),H=n(143)(void 0!==typeof window?window:global),Y=n(72)({global:H}),J=n(305)({PeerConnection:Y}),z=n(313),K=n(287),Q=n(697),q=n(698),$=n(699),ee=n(314),te=n(103).parseIceServers,ne=n(700),re=n(701),ie=n(702),oe=n(316),ae=n(168),se=n(317),ce=(e,t)=>e.connection.id===t.connection.id,ue=(0,a.default)();e.exports=function(e){let n=void 0===e?{}:e,r=n.AudioLevelMeter,a=void 0===r?w:r,H=n.AudioLevelTransformer,Y=void 0===H?C:H,de=n.BackingBar,le=void 0===de?O:de,fe=n.Chrome,pe=void 0===fe?A:fe,he=n.env,me=void 0===he?x:he,ge=n.Errors,ve=void 0===ge?k:ge,ye=n.Events,be=void 0===ye?N:ye,Se=n.ExceptionCodes,Ee=void 0===Se?L:Se,_e=n.audioLevelSampler,Te=void 0===_e?D:_e,Re=n.getStatsHelpers,Ie=void 0===Re?M:Re,we=n.hasAudioOutputLevelStatCapability,Ce=void 0===we?V:we,Oe=n.hasRemoteStreamsWithWebAudio,Ae=void 0===Oe?P:Oe,xe=n.interpretPeerConnectionError,ke=void 0===xe?Z:xe,Ne=n.logging,Le=void 0===Ne?j:Ne,Me=n.MuteButton,Ve=void 0===Me?W:Me,Pe=n.NamePanel,De=void 0===Pe?G:Pe,Ze=n.otError,je=void 0===Ze?F:Ze,We=n.OTErrorClass,Ge=void 0===We?U:We,Fe=n.OTHelpers,Ue=void 0===Fe?X:Fe,Xe=n.StylableComponent,Be=void 0===Xe?B:Xe,He=n.SubscriberPeerConnection,Ye=void 0===He?J:He,Je=n.SubscribingState,ze=void 0===Je?z:Je,Ke=n.VideoDisabledIndicator,Qe=void 0===Ke?K:Ke,qe=n.AudioBlockedIndicator,$e=void 0===qe?Q:qe,et=n.VideoUnsupportedIndicator,tt=void 0===et?q:et,nt=n.watchFrameRate,rt=void 0===nt?$:nt,it=n.createSendMethod,ot=void 0===it?ee:it,at=n.parseIceServers,st=void 0===at?te:at,ct=n.document,ut=void 0===ct?(void 0!==typeof window?window:global).document:ct,dt=n.WidgetView,lt=void 0===dt?R:dt;const ft=function e(n,r,R){var w,C=this;if(void 0===r&&(r={}),void 0===R&&(R=()=>{}),void 0===r.analytics)throw new Error("Subscriber requires an instance of analytics");const O=r.analytics,A=h(),x=e.hasAudioOutputLevelStatCapability()||Ae(),k=this,N={},L={},M={},V={},P={},D=new se;let Z,j,W,G,F,U,X,B,H,J,z,K,Q,q,$=!1,ee=n||A,te=r.session,de=r.stream;const fe=r._singlePeerConnectionController,he=void 0!==fe;let ge,ye,Se,_e,Re,we,Ce=!1,Oe={},xe=null,Ne=!1,Me=!0,Pe=[],Ze=s({},r,{showControls:!0,testNetwork:!1,fitMode:de.defaultFitMode||"cover",insertDefaultUI:!0,initials:de.initials});const We=te.sessionInfo.isAdaptiveEnabled,Fe={P2P:y.SUBSCRIBER_DISCONNECTED,MANTIS:y.SUBSCRIBER_DISCONNECTED},Xe="Chrome"===me.name&&me.version>=58||me.isChromiumEdge||me.isOpera,He=te._.getSocket(),Ye=()=>d(L),Je=e=>L[e],Ke=()=>L[we],qe=function(){var e=(0,o.default)(i.default.mark((function e(t){var n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L[t];case 2:null==(n=e.sent)||n.close(),delete L[t];case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),et=e=>{delete M[e]},nt=()=>{Ye().forEach(function(){var e=(0,o.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:e.sent.destroy();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Object.keys(L).forEach(e=>{delete L[e]})},it=function(){var e=(0,o.default)(i.default.mark((function e(t){var n,r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return n={error:Tt,audioVolume:ye},r=We&&"P2P"===we,e.prev=4,e.next=7,Z.bindVideo(t,n,r);case 7:e.next=18;break;case 9:if(e.prev=9,e.t0=e.catch(4),!(e.t0 instanceof p||U.isDestroyed())){e.next=13;break}return e.abrupt("return");case 13:if(!e.t0.message.includes("bufferFailed")){e.next=16;break}return C._.startRelayedToRoutedTransition(),e.abrupt("return");case 16:throw Tt(e.t0),e.t0;case 18:case"end":return e.stop()}}),e,null,[[4,9]])})));return function(t){return e.apply(this,arguments)}}(),at=function(){var e=(0,o.default)(i.default.mark((function e(t,n){var r,o,a;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!1,"function"==typeof t?n=t:r="rtcStatsReport"===t,r?Wt():jt(),!r||oe){e.next=7;break}return o=Ee.GET_RTC_STATS_REPORT_NOT_SUPPORTED,n(je(T.GET_RTC_STATS_REPORT_NOT_SUPPORTED,new Error(Ge.getTitleByCode(o)),o)),e.abrupt("return");case 7:if(Ke()){e.next=11;break}return o=Ee.PEER_CONNECTION_NOT_CONNECTED,n(je(ve.PEER_CONNECTION_NOT_CONNECTED,new Error(Ge.getTitleByCode(o)),o)),e.abrupt("return");case 11:return e.next=13,Ke();case 13:a=e.sent,(r?a.getRtcStatsReport:a.getStats)((e,t)=>{e?(e.code===Ee.PEER_CONNECTION_NOT_CONNECTED&&(e=je(ve.PEER_CONNECTION_NOT_CONNECTED,e,Ee.PEER_CONNECTION_NOT_CONNECTED)),n(e)):n(null,t)});case 16:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ct=e=>!(!H||!ge)&&("video"===e?H.getVideoTracks().length>0&&ge.getVideoTracks().length>0:H.getAudioTracks().length>0&&ge.getAudioTracks().length>0),dt=(e,t,n,r,i)=>{let o=u({action:e,variation:t,payload:n,streamId:de?de.id:null,sessionId:te?te.sessionId:null,connectionId:te&&te.isConnected()?te.connection.connectionId:null,partnerId:te&&te.sessionInfo?te.sessionInfo.partnerId:null,subscriberId:A,widgetType:"Subscriber"},r);("Failure"===t||"iceconnectionstatechange"===t&&"closed"===n)&&(o=u(o,Oe));const a=[o];i&&a.push(i),O.logEvent(...a)},lt=(e,t,n)=>{"Attempt"===t?(V[e]=(new Date).getTime(),dt(e,t,n)):"Failure"!==t&&"Success"!==t||dt(e,t,n,{attemptDuration:(new Date).getTime()-V[e]})},ft=function(e,t){void 0===t&&(t={}),lt("RoutedToRelayedTransition",e,t)},pt=function(e,t){void 0===t&&(t={}),lt("RelayedToRoutedTransition",e,t)},ht=re({onInvalidTransition(e,t){const n=`Invalid state transition: Event '${e}' not possible in state '${t}'`;Le.error(n),dt("Subscriber:InvalidStateTransition","Event",{details:n})}});{const e="Unable to subscribe to stream in a reasonable amount of time";ne({connectivityState:ht,onWarning(){mt("Warning",{})},onTimeout:()=>{if(Z&&Z.addError(e),U.isAttemptingToSubscribe()){U.set("Failed"),this._disconnect({noStateTransition:!0});const t=je(T.TIMEOUT,new Error(e),Ee.UNABLE_TO_SUBSCRIBE);ht.fail({options:{failureReason:"Subscribe",failureMessage:e,failureCode:Ee.UNABLE_TO_SUBSCRIBE},error:t})}},warningMs:15e3,timeoutMs:3e4})}if(N.promise=new t((e,t)=>{N.resolve=e,N.reject=t}),Ze.testNetwork&&te.sessionInfo.p2pEnabled&&Le.warn("You cannot test your network with a relayed session. Use a routed session."),this.id=ee,this.widgetId=A,this.session=te,this.stream=Ze.stream,de=Ze.stream,this.streamId=de.id,!te)return Ge.handleJsException({errorMsg:"OT.Subscriber must be passed a session option",code:2e3,target:this,analytics:O}),null;b(this),k.once("subscribeComplete",(function(){try{R(...arguments)}catch(e){Le.error("Completion handler threw an exception",e)}})),te.on("captionReceived",e=>{e.streamId===k.streamId&&(this.dispatchEvent(e),this.trigger(y.SUBSCRIBER_CAPTION_RECEIVED,e))}),ht.observe({onEnterConnecting(){mt("Attempt",null,{})},onEnterConnected(){mt("Success",null,{})},onEnterDisconnected(e,t){let n=void 0===t?{}:t,r=n.options,i=void 0===r?{}:r,o=n.payload,a=void 0===o?null:o;mt((e=>{let t=e.transition,n=e.from;return"fail"===t?"connected"===n?"Disconnect":"Failure":"disconnect"===t&&"connected"===n?"Disconnect":"Cancel"})(e),a,i)}}),ht.observe({onEnterConnected:()=>{this.trigger("subscribeComplete",void 0,this)},onEnterDisconnected:function(e,t){let n=e.from,r=(void 0===t?{}:t).error;"connecting"===n&&C.trigger("subscribeComplete",r||new Error("An unknown error occurred"),C)}}),ie({connectivityState:ht,logAttempt(){dt("Subscribe","Attempting",null,{connectionId:te&&te.isConnected()?te.connection.connectionId:null})}});const mt=function(e,t,n){void 0===t&&(t={}),"Failure"===e||"Success"===e||"Cancel"===e?dt("Subscribe",e,t,Object.assign({},n,{attemptDuration:(new Date).getTime()-K})):"Attempt"===e?(K=(new Date).getTime(),dt("Subscribe",e,Object.assign({},t,{testNetwork:Ze.testNetwork}),n)):dt("Subscribe",e,t,n)},gt=(e,t)=>{dt("ICERestart",e,t)},vt=e=>{var t,n;let r=e.parsedStats,i=e.remoteConnectionId,o=e.peerId,a=e.sourceStreamId;const s={widgetType:"Subscriber",width:Z.width,height:Z.height,audioTrack:ct("audio"),hasAudio:de&&de.hasAudio,subscribeToAudio:q,audioVolume:this.getAudioVolume(),videoTrack:ct("video"),connectionId:te?te.connection.connectionId:null,hasVideo:de&&de.hasVideo,subscribeToVideo:Ze.subscribeToVideo,congestionLevel:xe,streamId:de.id,subscriberId:A,duration:Math.round((g()-F)/1e3),remoteConnectionId:i,peerId:o,sourceStreamId:ae(a),preferredResolutionHeight:null==(t=Ze.preferredResolution)?void 0:t.height,preferredResolutionWidth:null==(n=Ze.preferredResolution)?void 0:n.width,preferredFrameRate:Ze.preferredFrameRate,audioFallback:!J&&"auto"===z,initials:de.initials},c=u(s,r);O.logQOS(c),this.trigger("qos",Object.assign({},O.commonQoSFields(),c))},yt=()=>{!U.isSubscribing()&&Z&&Z.video()&&($=!0,Ne||(ht.connect(),Ne=!0),Le.debug("OT.Subscriber.onLoaded"),U.set("Subscribing"),F=g(),Z.loading(!1),j&&j.showAfterLoading(),Ce&&de.setRestrictFrameRate(!0),G&&G.audioOnly(Z.audioOnly()),this.setAudioVolume(ye),this.trigger("loaded",this))},bt=()=>de&&de.hasAudio&&q&&this.getAudioVolume()>0&&!this.isAudioBlocked(),St=e=>{let t=!1;if(("audioLevelStuckAt0"!==e||!(!bt()||de&&de.hasVideo))&&(dt("subscriber:onAudioWarning","Event",{reason:e}),Z)){if(Z.rebindSrcObject(),dt("subscriber:rebindSrcObject","Called"),"audioLevelStuck"===e)return;t=!0}Et(t)},Et=function(){var e=(0,o.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=!1),!Xe){e.next=6;break}return e.next=4,Ke();case 4:e.sent.startAudioStatsWatcher(t);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_t=()=>{Le.debug("OT.Subscriber has been disconnected from the Publisher's PeerConnection"),ht.fail({options:{failureReason:"PeerConnectionError",failureCode:Ee.UNABLE_TO_PUBLISH,failureMessage:"PeerConnection disconnected"},error:je(ve.DISCONNECTED,new Error("ClientDisconnected"))}),this._disconnect({noStateTransition:!0}),(U.isAttemptingToSubscribe()||U.isSubscribing())&&U.set("Failed")},Tt=e=>{const t=je(ve.MEDIA_ERR_DECODE,e,e.code||Ee.P2P_CONNECTION_FAILED);t.message="OT.Subscriber while playing stream: "+t.message,Le.error("OT.Subscriber.onVideoError"),ht.fail({options:{failureReason:"VideoElement",failureMessage:t.message,failureCode:t.code||Ee.P2P_CONNECTION_FAILED},error:t});const n=U.isAttemptingToSubscribe();U.set("Failed"),n||k.trigger("error",t.message),Ge.handleJsException({error:t,code:Ee.UNABLE_TO_SUBSCRIBE,target:k,analytics:O})},Rt=e=>{const t=_(e);Ge.handleJsException({error:t,code:t.code,target:k,analytics:O}),this._disconnect({noStateTransition:!0});const n={failureReason:"Subscribe",failureMessage:"OT.Subscriber PeerConnection Error: "+t.message,failureCode:Ee.P2P_CONNECTION_FAILED};Dt(t.code,t.message),ht.fail({options:n,error:je(t.name,new Error("Subscribe: Subscriber PeerConnection with connection (not found) failed: "+t.message),t.code)}),t.name===T.STREAM_NOT_FOUND&&this._destroy({reason:"streamNotFound",noStateTransition:!0})},It=(e,t,n,r)=>{if("SetRemoteDescription"===r&&!Me&&t.match(/Unsupported video without audio for fallback/)){let e;return Z&&Z.addError("The stream is unable to be played.","Your browser does not support the video format."),e="Safari"===Ue.env.name?new Error("VP8 is not supported in this version of Safari. You might want to consider switching to an H264 project. See https://tokbox.com/safari for more information."):new Error("Video format not supported in this browser."),e.code=Ee.UNSUPPORTED_VIDEO_CODEC,void Tt(e)}if("ICEWorkflow"===r&&te.sessionInfo.reconnection&&$)return void Le.debug("Ignoring peer connection failure due to possibility of reconnection.");let i;i="ICEWorkflow"===r?Ee.SUBSCRIBER_ICE_WORKFLOW_FAILED:e===Ee.STREAM_LIMIT_EXCEEDED?e:Ee.P2P_CONNECTION_FAILED;const o={failureReason:r||"PeerConnectionError",failureMessage:"OT.Subscriber PeerConnection Error: "+t,failureCode:i},a=ke(e,t,r,"(not found)","Subscriber");if(ht.fail({options:o,error:a}),U.isAttemptingToSubscribe()){const e={hasRelayCandidates:n&&n.hasRelayCandidates()};dt("createPeerConnection","Failure",e,o),U.set("Failed")}else U.isSubscribing()&&(U.set("Failed"),this.trigger("error",t));this._disconnect({noStateTransition:!0}),404===Number(e)&&this._destroy({noStateTransition:!0}),Ge.handleJsException({error:a,errorMsg:"OT.Subscriber PeerConnection Error: "+t,code:i,target:this,analytics:O}),Dt(e)},wt=e=>{const t=e._hasVideoTracks(),n=e._hasAudioTracks(),r=de&&de.hasVideo&&!t,i=de&&de.hasAudio&&!n;return!(r||i)},Ct=function(){var e=(0,o.default)(i.default.mark((function e(t,n){var r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ue(()=>wt(n));case 3:e.next=12;break;case 5:if(e.prev=5,e.t0=e.catch(0),"TIMEOUT"!==e.t0.message){e.next=11;break}Le.error("The expected tracks never arrived"),e.next=12;break;case 11:throw e.t0;case 12:return r=n.getSourceStreamId(),he&&"MANTIS"===r&&fe.subscriberComplete(),e.next=16,Ot(t.stream,n);case 16:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,n){return e.apply(this,arguments)}}(),Ot=function(){var e=(0,o.default)(i.default.mark((function e(n,r){var o,a,s,c,u,d,l;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ge=n,he&&(ge=new MediaStream(r._getTracks())),o=1===Object.keys(M).length,a=null==r?void 0:r.getSourceStreamId(),s=te.sessionInfo,H=n,a&&(M[a]=n),Le.debug("OT.Subscriber.onRemoteStreamAdded with sourceStreamId",a),U.set("BindingRemoteStream"),C.subscribeToAudio(q),("auto"!==z||Ze.subscribeToVideo)&&(z="loading",C.subscribeToVideo(Ze.subscribeToVideo,"loading")),s.p2pEnabled||"P2P"===a||(C.setPreferredResolution(Ze.preferredResolution),C.setPreferredFrameRate(Ze.preferredFrameRate)),r&&r._getVideoTracks().forEach(e=>{(void 0!==typeof window?window:global).webkitMediaStream?e.enabled=!1:e.enabled=de.hasVideo&&Ze.subscribeToVideo}),e.next=15,it(ge);case 15:if(Et(),!U.isDestroyed()){e.next=18;break}throw new Error("Subscriber destroyed");case 18:return r&&(void 0!==typeof window?window:global).webkitMediaStream&&r._getVideoTracks().forEach(e=>{e.enabled=de.hasVideo&&Ze.subscribeToVideo}),(c=Z&&Z.video())&&c.orientation({width:de.videoDimensions.width,height:de.videoDimensions.height,videoOrientation:de.videoDimensions.orientation}),(u=j&&j.videoUnsupportedIndicator)&&u.setVideoUnsupported(!Me),d=new t((e,t)=>{const n=Z&&Z.video();n&&n.domElement()?e():(Z.once("videoElementCreated",e),k.once("destroyed",t))}),e.next=26,d;case 26:return e.next=28,N.promise;case 28:o?U.set("Subscribing"):yt(),X&&"webRTCStream"in X&&r._hasAudioTracks()&&X.webRTCStream(n),((l=Ue.env).isSafari||l.isChromiumEdge||l.isOpera||"Chrome"===l.name&&l.version>=58||l.isFirefox&&l.version>=96)&&(_e&&(_e.destroy(),_e=null),r&&(_e=rt(r.getStats.bind(r)))),o||C.trigger("streamAdded",C),D.finishTransitionTo(we);case 34:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),At=e=>{Le.debug("OT.Subscriber.onStreamRemoved");const t=Z&&Z.video();t&&t.stream===e&&Z.destroyVideo(),et(we),ge=null,this.trigger("streamRemoved",this)},xt=e=>{Me!==e&&this.dispatchEvent(new be.VideoEnabledChangedEvent(e?"videoEnabled":"videoDisabled",{reason:e?"codecChanged":"codecNotSupported"})),Me=e},kt=e=>{Z.setAudioBlockedUi(e);const t=j&&j.audioBlockedIndicator;t&&t.setAudioBlocked(e);const n=j&&j.videoUnsupportedIndicator;n&&n.setVideoUnsupported(!e&&!Me)};this.on("audioBlocked",()=>{kt(!0)}),this.on("audioUnblocked",()=>{kt(!1)});const Nt={new:y.SUBSCRIBER_DISCONNECTED,checking:y.SUBSCRIBER_DISCONNECTED,connected:y.SUBSCRIBER_CONNECTED,completed:y.SUBSCRIBER_CONNECTED,disconnected:y.SUBSCRIBER_DISCONNECTED},Lt=(e,t)=>{const n=Nt[e],r=t.getSourceStreamId(),a=Fe[r];n&&n!==a&&(Fe[r]=n,"disconnected"===e&&"P2P"!==r&&setTimeout((0,o.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=te._.isSocketReconnecting,"disconnected"!==Fe[r]||!He.is("connected")||t()){e.next=4;break}return e.next=4,C._.iceRestart("peer connection disconnected");case 4:case"end":return e.stop()}}),e)}))),2e3),Z&&Z.loading(n!==y.SUBSCRIBER_CONNECTED),Le.debug("OT.Subscriber.connectionStateChanged to "+e),this.dispatchEvent(new be.ConnectionStateChangedEvent(n,this)))},Mt=()=>{gt("Success")},Vt=()=>{gt("Failure",{reason:"ICEWorkflow",message:"OT.Subscriber PeerConnection Error: The stream was unable to connect due to a network error. Make sure your connection isn't blocked by a firewall."})};W={get:()=>de.getChannelsOfType("audio").length>0?k.getStyle("buttonDisplayMode"):"off",update(){const e=W.get();j&&(j.muteButton.setDisplayMode(e),j.backingBar.setMuteMode(e))}};const Pt=()=>{const e={backingBar:new le({nameMode:Ze.name?this.getStyle("nameDisplayMode"):"off",muteMode:W.get()}),name:new De({name:Ze.name,mode:this.getStyle("nameDisplayMode")}),muteButton:new Ve({muted:0===ye,mode:W.get()})};if(x){const t=new Y;G=new a({mode:k.getStyle("audioLevelDisplayMode")});const n=new S(()=>{G.setValue(t.transform(this.loudness))});G.watchVisibilityChanged(e=>{e?n.start():n.stop()}),G.setDisplayMode(this.getStyle("audioLevelDisplayMode")),G.audioOnly(!1),e.audioLevel=G}e.videoDisabledIndicator=new Qe({mode:this.getStyle("videoDisabledDisplayMode")}),e.audioBlockedIndicator=new $e({mode:this.getStyle("audioBlockedDisplayMode")}),e.videoUnsupportedIndicator=new tt({mode:this.getStyle("videoUnsupportedDisplayMode")}),Z&&Z.domElement&&(j=new pe({parent:Z.domElement}).set(e).on({muted(){k.setAudioVolume(0)},unmuted(){k.setAudioVolume(Se)}},this),j.hideWhileLoading())},Dt=(e,t)=>{let n,r;Z&&(e===Ee.STREAM_LIMIT_EXCEEDED?(n="The stream was unable to connect.",r="The limit for the number of media streams has been reached."):"Tried to subscribe to an encrypted stream without enabling encryption"===t?(n="Unable to subscribe to an encrypted stream without enabling encryption.",r=""):(n="The stream was unable to connect due to a network error.",r=Ne?"Ensure you have a stable connection and try again.":"Make sure you have a stable network connection and that it isn't blocked by a firewall."),Z.addError(n,r))};function Zt(e){Ye().forEach(function(){var t=(0,o.default)(i.default.mark((function t(n){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n;case 2:t.sent.subscribeToVideo(!e);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());const t=e||!ge||!ge.getVideoTracks().length;Z&&(Z.audioOnly(t),Z.showPoster(t)),G&&G.audioOnly(t)}Be(this,{nameDisplayMode:"auto",buttonDisplayMode:"auto",audioLevelDisplayMode:"auto",videoDisabledDisplayMode:"auto",audioBlockedDisplayMode:"auto",backgroundImageURI:null,showArchiveStatus:!0,showMicButton:!0},Ze.showControls,e=>{dt("SetStyle","Subscriber",e,null,.1)});const jt=f(()=>{dt("GetStats","Called")}),Wt=f(()=>{dt("GetRtcStatsReport","Called")}),Gt=function(){var e=(0,o.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B&&(B.destroy(),B=void 0),e.prev=1,e.next=4,ue(()=>t._hasAudioTracks());case 4:e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return");case 9:X=Te(t),X?B=I({subscriber:C,audioLevelSampler:X}):Object.prototype.hasOwnProperty.call(C,"loudness")||(Object.defineProperty(C,"loudness",{value:void 0,configurable:!0,writable:!1}),Le.error("No suitable audio level samplers found, audio level visualisation will not work"));case 11:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}(),Ft=(e,t)=>{if(P[t]){P[t].removeAll();const n=()=>{e.off("error",n),e.off("disconnected",n)};e.on("error",n),e.on("disconnected",n)}const n=E(e);n.once("connected",()=>(e=>{We&&"P2P"===e.getSourceStreamId()&&ft("Success")})(e)),n.on("disconnected",_t),n.on("error",It),n.once("remoteTrackAdded",(0,o.default)(i.default.mark((function t(){var n=arguments;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Gt(e);case 2:return t.prev=2,t.next=5,Ct(...n);case 5:t.next=10;break;case 7:t.prev=7,t.t0=t.catch(2),Le.error(t.t0);case 10:case"end":return t.stop()}}),t,null,[[2,7]])})))),n.on("audioLevelStuckWarning",St),n.on("signalingStateStable",(0,o.default)(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:k.trigger("signalingStateStable"),Z&&Z.video()&&H&&X&&"webRTCStream"in X&&e._hasAudioTracks()&&X.webRTCStream(H);case 3:case"end":return t.stop()}}),t)})))),n.on("iceConnectionStateChange",t=>Lt(t,e)),n.on("iceRestartSuccess",Mt),n.on("iceRestartFailure",Vt),n.on("remoteVideoSupported",xt),n.on("remoteStreamRemoved",At),n.on("decryptFailed",()=>{this.trigger("encryptionSecretMismatch"),dt("encryptionSecretMismatch","Event"),Le.warn("Media cannot be decrypted due to an encryption secret mismatch.")}),n.on("decryptRestored",()=>{this.trigger("encryptionSecretMatch"),dt("encryptionSecretMatch","Event")}),P[t]=P},Ut=function(){var e=(0,o.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ft("Attempt"),e.next=3,Je("MANTIS");case 3:if(null!=(t=e.sent)&&t.iceConnectionStateIsConnected()){e.next=7;break}return ft("Failure",{reason:"Attempted to transition to Relayed without being connected in Routed mode."}),e.abrupt("return");case 7:He.subscriberCreate(de.id,A,en,"P2P",te._.isE2ee(),(e,t)=>{e&&!ht.is("disconnected")&&ft("Failure",e),Le.debug("message received when created a subscriber with source",t)});case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Xt=function(){var e=(0,o.default)(i.default.mark((function e(){var t,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ze.testNetwork&&!ce(de,te)&&"P2P"===we){e.next=2;break}return e.abrupt("return");case 2:if(pt("Attempt"),H=M.MANTIS,ge=H,!he){e.next=10;break}return e.next=8,Je("MANTIS");case 8:t=e.sent,ge=new MediaStream(t._getTracks());case 10:return e.next=12,it(ge);case 12:return Z.loading(!1),qe("P2P"),we="MANTIS",et("P2P"),e.next=18,Ke();case 18:return n=e.sent,e.next=21,Gt(n);case 21:pt("Success");case 22:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();this._destroy=e=>{let t=e.reason,n=void 0===t?"Unknown":t,r=e.quiet,i=e.noStateTransition,o=void 0!==i&&i;return U.isDestroyed()||(U.set("Destroyed"),_e&&(_e.destroy(),_e=null),Oe={sessionId:te.sessionId,connectionId:te&&te.isConnected()?te.connection.connectionId:null,partnerId:te&&te.sessionInfo?te.sessionInfo.partnerId:null,streamId:de&&!de.destroyed?de.id:null},this._disconnect({reason:n,noStateTransition:o}),j&&(j.destroy(),j=null),Z&&(Z.destroy(),Z.off(),Z=null,this.element=null),de&&!de.destroyed&&dt("unsubscribe",null,{streamId:de.id}),de.off(Q,this),this.id=null,ee=null,this.stream=null,de=null,this.streamId=null,this.session=null,te=null,Ze=null,!0!==r&&(this.dispatchEvent(new be.DestroyedEvent(y.SUBSCRIBER_DESTROYED,this,n)),this.off())),this},this.destroy=function(e,t){void 0===e&&(e="Unsubscribe"),Le.warn("Subscriber#destroy is deprecated and will be removed. Please use Session#unsubscribe instead"),C._destroy({reason:e,quiet:t})},this._disconnect=function(e){let t=void 0===e?{}:e,n=t.reason,r=void 0===n?"Unknown":n;if(!t.noStateTransition&&!ht.is("disconnected")){const e="Unsubscribe"===r?void 0:je(ve.STREAM_DESTROYED,new Error("Stream was destroyed before it could be subscribed to"));ht.disconnect({payload:{reason:r},error:e})}U.isDestroyed()||U.isFailed()||U.set("NotSubscribing"),Z&&Z.destroyVideo(),He.is("connected")&&de&&!de.destroyed&&He.subscriberDestroy(de.id,C.widgetId),nt()},this.disconnect=()=>{Le.warn("Subscriber#disconnect is deprecated and will be removed. Please use Session#unsubscribe instead"),this._disconnect({reason:"Unsubscribe"})};const Bt=function(){var e=(0,o.default)(i.default.mark((function e(t){var n,r,o,a,s,c,u;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.peerId,r=t.fromConnectionId,o=t.sourceStreamId,i={apiKey:te.apiKey,sessionId:te.sessionId,streamId:de.id,subscriberId:C.widgetId},a=["/v2/partner",i.apiKey,"session",i.sessionId,"stream",i.streamId,"subscriber",i.subscriberId].join("/"),s=ot({socket:C.session._.getSocket(),uri:a,content:{peerId:n,sourceStreamId:o}}),c=function(e,t,r,i,a){void 0===i&&(i={});const s=Object.assign({peerId:n,sourceStreamId:ae(o)},i);return dt(e,t,r,s,a)},u=e=>{we===o&&vt(Object.assign({},e,{peerId:n,remoteConnectionId:r,sourceStreamId:o}))},e.abrupt("return",C._setupPeerConnection({send:s,log:c,logQoS:u,sourceStreamId:o}));case 6:case"end":return e.stop()}var i}),e)})));return function(t){return e.apply(this,arguments)}}();function Ht(e){const t=Z&&Z.video();if(t)try{t.setAudioVolume(e)}catch(e){Le.warn("setAudioVolume: "+e),0===ye&&(Le.info("Using subscribeToAudio to mute Audio because setAudioVolume(0) failed"),k.subscribeToAudio(!1))}j&&j.muteButton.muted(0===e)}this.processMessage=function(){var e=(0,o.default)(i.default.mark((function e(t,n,r){var o,a,s;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Le.debug(`OT.Subscriber.processMessage: Received ${t} message from ${n}`),Le.debug(r),o=l(r,"content.peerId"),a=l(r,"content.sourceStreamId"),e.next=6,Je(a);case 6:if(!(s=e.sent)){e.next=11;break}s.processMessage(t,r),e.next=16;break;case 11:if("offer"!==t){e.next=16;break}return e.next=14,Bt({peerId:o,fromConnectionId:n,sourceStreamId:a});case 14:s=e.sent,he?s.processMessage("offer",r):C.session._.addSubscriberToPeerConnectionsQueue(s,r);case 16:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),this.disableVideo=e=>{if(e){if("auto"!==z||!1!==Re)return Le.info("Video was not re-enabled because it was manually disabled"),void(j&&j.videoDisabledIndicator&&j.videoDisabledIndicator.disableVideo(!1));Le.info("Video has been re-enabled")}else Le.warn("Due to high packet loss and low bandwidth, video has been disabled");this.subscribeToVideo(e,"auto"),dt("updateQuality","video",e?{videoEnabled:!0}:{videoDisabled:!0})},this.getImgData=()=>{if(!this.isSubscribing())return Le.error("OT.Subscriber.getImgData: Cannot getImgData before the Subscriber is subscribing."),null;const e=Z&&Z.video();return e?e.imgData():null},this.getStats=e=>{(e=>{at(e)})((t,n)=>{if(t)return void e(t);const r={timestamp:0};n.forEach(e=>{if(Ie.isInboundStat(e)){const t=Ie.isVideoStat(e,n),i=Ie.isAudioStat(e,n);(i||t)&&(r.timestamp=Ie.normalizeTimestamp(e.timestamp)),t?(c(r,{video:Ie.parseStatCategory(e)}),_e&&c(r,{video:{frameRate:_e.getFrameRateFromStat(e)}})):i&&c(r,{audio:Ie.parseStatCategory(e)})}}),e(null,r)})},this.getRtcStatsReport=()=>new t((e,t)=>{at("rtcStatsReport",(n,r)=>{n?t(n):e(r)})}),this.setAudioVolume=e=>{const t=function(e){return Math.max(0,Math.min(100,parseInt(e,10)))}(e);return dt("setAudioVolume","Attempt",{audioVolume:t}),isNaN(t)?(Le.error("OT.Subscriber.setAudioVolume: value should be an integer between 0 and 100"),dt("setAudioVolume","Failure",{message:"value should be an integer between 0 and 100"}),this):(t!==e&&Le.warn("OT.Subscriber.setAudioVolume: value should be an integer between 0 and 100"),t===ye?(Ht(ye),dt("setAudioVolume","Success",{audioVolume:ye,message:"Requested volume is same as already set audioVolume"}),this):(ye>0&&(Se=ye),ye=t,Ht(ye),ye>0&&!q&&(Se=ye,this.subscribeToAudio(!0)),dt("setAudioVolume","Success",{audioVolume:ye}),this))},this.getAudioVolume=()=>{const e=Z&&Z.video();if(e)try{return e.getAudioVolume()}catch(e){Le.warn("getAudioVolume "+e)}return ye},this.subscribeToAudio=e=>{const t=v(e,!0);Ye().forEach(function(){var e=(0,o.default)(i.default.mark((function e(n){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n;case 2:e.sent.subscribeToAudio(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),de&&0!==Ye().length&&de.setChannelActiveState("audio",t);const n=q!==t;return q=t,n&&this.setAudioVolume(t?Se:0),dt("subscribeToAudio","Event",{subscribeToAudio:t}),this};const Yt={auto:"quality",publishVideo:"publishVideo",subscribeToVideo:"subscribeToVideo"};if("Safari"===me.name){const e=()=>{!ut.hidden&&Ze.subscribeToVideo&&(Le.debug("document visibility restored in Safari - resubscribing to video"),this.subscribeToVideo(!1),this.subscribeToVideo(!0))};ut.addEventListener("visibilitychange",e),this.once("destroyed",()=>{ut.removeEventListener("visibilitychange",e)})}var Jt,zt;if(this.subscribeToVideo=(e,t)=>{const n=v(e,!0),r=!n&&"auto"===t;return t||(Re=!n),r&&(xe=2),dt("subscribeToVideo","Attempt",{subscribeToVideo:n,reason:t}),Zt(!n||!de.hasVideo||!H),de.hasVideo&&!ct("video")?(n&&Le.info("Subscriber is audio-only due to incompatibility, can't subscribeToVideo."),Ze.subscribeToVideo=!1,dt("subscribeToVideo","Failure",{message:"No video tracks available"}),this):(j&&j.videoDisabledIndicator&&j.videoDisabledIndicator.disableVideo(r),Ye().length>0&&te&&de&&(n!==Ze.subscribeToVideo||t!==z)&&de.setChannelActiveState("video",n,t),Ze.subscribeToVideo=n,z=t,J=n,dt("subscribeToVideo","Success",{subscribeToVideo:n,reason:t}),"loading"!==t&&this.dispatchEvent(new be.VideoEnabledChangedEvent(n?"videoEnabled":"videoDisabled",{reason:Yt[t]||"subscribeToVideo"})),this)},this.setPreferredResolution=e=>{if(U.isDestroyed()||0===Ye().length&&"Connecting"===!U.current)return void Le.warn("Cannot set the max Resolution when not subscribing to a publisher");if(Ze.preferredResolution=e,te.sessionInfo.p2pEnabled)return void Le.warn("OT.Subscriber.setPreferredResolution will not work in a P2P Session");if(!U.isStreamAdded())return;const t=de.getPreferredResolution();t&&e&&t.width===e.width&&t.height===e.height||!t&&!e||de.setPreferredResolution(e)},this.setPreferredFrameRate=e=>{if(U.isDestroyed()||0===Ye().length&&"Connecting"===!U.current)return void Le.warn("Cannot set the max frameRate when not subscribing to a publisher");if(Ze.preferredFrameRate=e,te.sessionInfo.p2pEnabled)return void Le.warn("OT.Subscriber.setPreferredFrameRate will not work in a P2P Session");const t=de.getPreferredFrameRate();e&&t&&t===e||!t&&!e||de.setPreferredFrameRate(e)},this.isSubscribing=()=>U.isSubscribing(),this.isWebRTC=!0,this.isLoading=()=>Z&&Z.loading(),this.isAudioBlocked=()=>Boolean(Z&&Z.isAudioBlocked()),this.videoElement=()=>{const e=Z&&Z.video();return e?e.domElement():null},this.videoWidth=()=>{const e=Z&&Z.video();return e?e.videoWidth():void 0},this.videoHeight=()=>{const e=Z&&Z.video();return e?e.videoHeight():void 0},this._subscribeToSelf=(0,o.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=te.getPublisherForStream(de))&&t._.webRtcStream()){e.next=5;break}ht.fail({payload:{reason:"streamNotFound"},error:je(ve.STREAM_DESTROYED,new Error("Tried to subscribe to a local publisher, but its stream no longer exists"))}),e.next=14;break;case 5:return N.resolve(),e.prev=6,e.next=9,Ot(t._.webRtcStream());case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(6),Le.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[6,11]])}))),this._setupPeerConnection=function(){var n=(0,o.default)(i.default.mark((function n(r){var o,a,s,c;return i.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=r.send,a=r.log,s=r.logQoS,c=r.sourceStreamId,Ze.testNetwork&&C.setAudioVolume(0),0===Ye().length&&U.set("Connecting"),we=c,L[c]=new t((t,n)=>{te._.getIceConfig().then(r=>{r.needRumorIceServersFallback&&(r.servers=[...Pe||[],...r.servers||[]]);const i={iceConfig:r,subscriberId:C.widgetId,send:o,logAnalyticsEvent:a,p2p:te.sessionInfo.p2pEnabled,sourceStreamId:c,remoteConnectionId:de.connection.id,_singlePeerConnectionController:"MANTIS"===c&&fe,keyStore:te.keyStore,sFrameClientStore:te.sFrameClientStore,isE2ee:te._.isE2ee()};Object.prototype.hasOwnProperty.call(Ze,"codecFlags")&&(i.codecFlags=Ze.codecFlags);const u=new e.SubscriberPeerConnection(i);u.once("iceConnected",N.resolve),u.once("error",N.reject),u.on("qos",s),Ft(u,c),u.init(e=>{e?n(e):t(u)})})}),n.abrupt("return",L[c]);case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),this.restrictFrameRate=e=>(Le.debug(`OT.Subscriber.restrictFrameRate(${e})`),dt("restrictFrameRate",e.toString(),{streamId:de.id}),te.sessionInfo.p2pEnabled&&Le.warn("OT.Subscriber.restrictFrameRate: Cannot restrictFrameRate on a P2P session"),"boolean"!=typeof e?Le.error("OT.Subscriber.restrictFrameRate: expected a boolean value got a "+typeof e):(Ce=e,de.setRestrictFrameRate(e)),this),this.on("styleValueChanged",(e,t)=>{if(j)switch(e){case"nameDisplayMode":j.name.setDisplayMode(t),j.backingBar.setNameMode(t);break;case"videoUnsupportedDisplayMode":j.videoUnsupportedIndicator.setDisplayMode(t);break;case"videoDisabledDisplayMode":j.videoDisabledIndicator.setDisplayMode(t);break;case"audioBlockedDisplayMode":j.audioBlockedIndicator.setDisplayMode(t);break;case"showArchiveStatus":j.archive.setShowArchiveStatus(t);break;case"buttonDisplayMode":W.update();break;case"audioLevelDisplayMode":j.audioLevel.setDisplayMode(t);break;case"bugDisplayMode":break;case"backgroundImageURI":Z.setBackgroundImageURI(t)}},this),this._={getDataChannel:(e,t,n)=>(0,o.default)(i.default.mark((function r(){return i.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(Ke()){r.next=3;break}return n(new Ue.Error("Cannot create a DataChannel before there is a publisher connection.")),r.abrupt("return");case 3:return r.next=5,Ke();case 5:r.sent.getDataChannel(e,t,n);case 6:case"end":return r.stop()}}),r)})))(),iceRestart:(e,t)=>(0,o.default)(i.default.mark((function n(){var r;return i.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return void 0===t&&(t=!1),n.next=3,Je("MANTIS");case 3:(r=n.sent)?(gt("Attempt",{reason:e}),Le.debug("Subscriber: iceRestart attempt"),r.iceRestart(),t&&r.generateOffer()):Le.debug("Subscriber: Skipping ice restart, we have no peer connection");case 5:case"end":return n.stop()}}),n)})))(),unblockAudio:()=>Z&&Z.unblockAudio(),webRtcStream:()=>H,setIceConfig:(Jt=(0,o.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ye().forEach(function(){var e=(0,o.default)(i.default.mark((function e(n){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n;case 2:return e.abrupt("return",e.sent.setIceConfig(t));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)}))),function(e){return Jt.apply(this,arguments)}),privateEvents:new m,startRoutedToRelayedTransition(){Ze.testNetwork||ce(de,te)||(D.startTransitionTo("P2P"),Ut())},startRelayedToRoutedTransition(){D.startTransitionTo("MANTIS",()=>Xt())},setSinkId(e){if(Z&&Z.video())return Z.setSinkId(e);Le.debug("Called setAudioOutputDevice on a subscriber without a video element")},pauseAndPlayVideoElement(){Z&&Z.pauseAndPlayVideoElement()},get isSubscribingToVideo(){return Ze.subscribeToVideo}},U=new ze(e=>{Le.error("OT.Subscriber State Change Failed: ",e.message),Le.debug(e)}),Le.debug("OT.Subscriber: subscribe to "+de.id),U.set("Init"),!de)return Le.error("OT.Subscriber: No stream parameter."),!1;Q={updated:e=>{const t=Z&&Z.video();switch(e.changedProperty){case"videoDimensions":if(!t)break;t.orientation({width:e.newValue.width,height:e.newValue.height,videoOrientation:e.newValue.orientation}),this.dispatchEvent(new be.VideoDimensionsChangedEvent(this,e.oldValue,e.newValue));break;case"videoDisableWarning":j&&j.videoDisabledIndicator.setWarning(e.newValue),this.dispatchEvent(new be.VideoDisableWarningEvent(e.newValue?"videoDisableWarning":"videoDisableWarningLifted")),xe=e.newValue?1:null;break;case"hasVideo":Zt(!de.hasVideo||!Ze.subscribeToVideo),me.isSafari&&!de.hasVideo&&Z&&Z.bindAudioTrackOnly(),this.dispatchEvent(new be.VideoEnabledChangedEvent(de.hasVideo?"videoEnabled":"videoDisabled",{reason:"publishVideo"}));break;case"hasAudio":W.update()}}},de.on(Q,this),Ze.name=Ze.name||de.name,Ze.classNames="OT_root OT_subscriber",Ze.style&&this.setStyle(Ze.style,null,!0),Se=100,Ze.subscribeToVideo=v(Ze.subscribeToVideo,!0),Re=!Ze.subscribeToVideo,Ze.subscribeToAudio=v(Ze.subscribeToAudio,!0),this.subscribeToAudio(Ze.subscribeToAudio),this.setAudioVolume(void 0!==(zt=Ze).audioVolume?zt.audioVolume:!1===zt.subscribeToAudio?0:100),Z=new e.WidgetView(n,Object.assign({},Ze,{widgetType:"subscriber"})),Z.on("error",Tt),Z.on("audioBlocked",()=>this.trigger("audioBlocked")),Z.on("audioUnblocked",()=>this.trigger("audioUnblocked")),Z.on("amrLogEvent",(e,t,n)=>{dt(e,t,{},n)}),this.id=Z.domId(),ee=Z.domId(),this.element=Z.domElement,Z.on("videoElementCreated",e=>{const t=new be.VideoElementCreatedEvent(e),n=this;$?this.dispatchEvent(t):this.once("loaded",()=>{n.dispatchEvent(t)})}),this.element&&Pt.call(this);const Kt=de.getChannelsOfType("audio"),Qt=de.getChannelsOfType("video"),qt=de.getChannelsOfType("data");let $t=qt.some(e=>"caption1"===e.id&&e.active);this.subscribeToCaptions=function(){var e=(0,o.default)(i.default.mark((function e(t){var n,r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=v(t,!0),r={active:n},$t=n,dt("subscribeToCaptions","Attempt",{subscribeToCaptions:n}),He.subscriberChannelUpdate(de.id,C.widgetId,"caption1",r),dt("subscribeToCaptions","Success",{subscribeToCaptions:n});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.isSubscribedToCaptions=()=>$t;const en=Kt.map(e=>({id:e.id,type:e.type,active:Ze.subscribeToAudio})).concat(Qt.map(e=>{const t={id:e.id,type:e.type,active:Ze.subscribeToVideo,restrictFrameRate:void 0!==Ze.restrictFrameRate&&Ze.restrictFrameRate};return void 0!==Ze.preferredFrameRate&&(t.preferredFrameRate=parseFloat(Ze.preferredFrameRate)),void 0!==Ze.preferredHeight&&(t.preferredHeight=parseInt(Ze.preferredHeight,10)),void 0!==Ze.preferredWidth&&(t.preferredWidth=parseInt(Ze.preferredWidth,10)),t})).concat(qt.map(e=>({id:e.id,type:e.type,active:e.active}))),tn=null==(w=de.getChannelsOfType("data")[0])?void 0:w.active,nn=!Ze.testNetwork&&ce(de,te)&&!tn;(()=>{var e;const t=te.getPublisherForStream(de);if(null!=t&&null!=(e=t._)&&e.privateEvents&&nn){let e=!1;t._.privateEvents.on("publisherCaptionsEnabled",t=>{!e&&t.captionsEnabled&&(en.find(e=>"caption1"===e.id).active=!0,rn(),e=!0)})}})();const rn=()=>{ht.beginConnect(),He.subscriberCreate(de.id,A,en,null,te._.isE2ee(),(e,t)=>{const n=Object.assign({status:null==t?void 0:t.status},(null==e?void 0:e.message)&&{error:null==e?void 0:e.message});dt("subscriberCreate","Event",n),e&&!ht.is("disconnected")&&Rt(e),Pe=st(t)})};return nn?(ht.beginConnect(),this._subscribeToSelf(),this):(he?fe.addSubscriber(rn):rn(),this)};return ft.hasAudioOutputLevelStatCapability=Ce,ft.WidgetView=lt,ft.SubscriberPeerConnection=Ye,ft}}).call(this,n(2))},function(e,t,n){"use strict";const r=n(3);e.exports=()=>["Chrome","Opera","Safari"].indexOf(r.name)>-1},function(e,t,n){"use strict";const r=n(3).name;e.exports=()=>["Firefox","Safari","Edge","Chrome","Opera"].indexOf(r)>-1},function(e,t,n){"use strict";const r=n(160)()("NotSubscribing",["NotSubscribing","Init","Connecting","BindingRemoteStream","Subscribing","Failed","Destroyed"],{NotSubscribing:["NotSubscribing","Init","Destroyed"],Init:["NotSubscribing","Connecting","BindingRemoteStream","Destroyed"],Connecting:["NotSubscribing","BindingRemoteStream","Failed","Destroyed"],BindingRemoteStream:["NotSubscribing","Subscribing","Failed","Destroyed","BindingRemoteStream"],Subscribing:["NotSubscribing","Failed","Destroyed","BindingRemoteStream"],Failed:["Destroyed"],Destroyed:[]});r.prototype.isDestroyed=function(){return"Destroyed"===this.current},r.prototype.isFailed=function(){return"Failed"===this.current},r.prototype.isSubscribing=function(){return"Subscribing"===this.current},r.prototype.isAttemptingToSubscribe=function(){return-1!==["Init","Connecting","BindingRemoteStream"].indexOf(this.current)},r.prototype.isStreamAdded=function(){return"BindingRemoteStream"===this.current||this.isSubscribing()},e.exports=r},function(e,t,n){"use strict";e.exports=e=>{let t=e.socket,n=e.uri,r=e.content;return(e,i)=>t.send({uri:n,method:e,content:Object.assign({},r,i)})}},function(e,t,n){var r;r=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t,n){"use strict";e.exports=function(e,t){var n,r,i;for(n=1;n<arguments.length;n++)for(i in r=arguments[n])r.hasOwnProperty(i)&&(e[i]=r[i]);return e}},function(e,t,n){"use strict";var r=n(0);e.exports={build:function(e,t){var n,i,o,a=t.plugins;for(n=0,i=a.length;n<i;n++)(o=a[n]).methods&&r(e,o.methods),o.properties&&Object.defineProperties(e,o.properties)},hook:function(e,t,n){var r,i,o,a,s=e.config.plugins,c=[e.context];for(n&&(c=c.concat(n)),r=0,i=s.length;r<i;r++)a=s[r],(o=s[r][t])&&o.apply(a,c)}}},function(e,t,n){"use strict";function r(e){if(0===e.length)return e;var t,n,r=e.split(/[_-]/);if(1===r.length&&r[0][0].toLowerCase()===r[0][0])return e;for(n=r[0].toLowerCase(),t=1;t<r.length;t++)n=n+r[t].charAt(0).toUpperCase()+r[t].substring(1).toLowerCase();return n}r.prepended=function(e,t){return e+(t=r(t))[0].toUpperCase()+t.substring(1)},e.exports=r},function(e,t,n){"use strict";var r=n(0),i=n(2);function o(e,t){e=e||{},this.options=e,this.defaults=t.defaults,this.states=[],this.transitions=[],this.map={},this.lifecycle=this.configureLifecycle(),this.init=this.configureInitTransition(e.init),this.data=this.configureData(e.data),this.methods=this.configureMethods(e.methods),this.map[this.defaults.wildcard]={},this.configureTransitions(e.transitions||[]),this.plugins=this.configurePlugins(e.plugins,t.plugin)}r(o.prototype,{addState:function(e){this.map[e]||(this.states.push(e),this.addStateLifecycleNames(e),this.map[e]={})},addStateLifecycleNames:function(e){this.lifecycle.onEnter[e]=i.prepended("onEnter",e),this.lifecycle.onLeave[e]=i.prepended("onLeave",e),this.lifecycle.on[e]=i.prepended("on",e)},addTransition:function(e){this.transitions.indexOf(e)<0&&(this.transitions.push(e),this.addTransitionLifecycleNames(e))},addTransitionLifecycleNames:function(e){this.lifecycle.onBefore[e]=i.prepended("onBefore",e),this.lifecycle.onAfter[e]=i.prepended("onAfter",e),this.lifecycle.on[e]=i.prepended("on",e)},mapTransition:function(e){var t=e.name,n=e.from,r=e.to;return this.addState(n),"function"!=typeof r&&this.addState(r),this.addTransition(t),this.map[n][t]=e,e},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(e){return"string"==typeof e?this.mapTransition(r({},this.defaults.init,{to:e,active:!0})):"object"==typeof e?this.mapTransition(r({},this.defaults.init,e,{active:!0})):(this.addState(this.defaults.init.from),this.defaults.init)},configureData:function(e){return"function"==typeof e?e:"object"==typeof e?function(){return e}:function(){return{}}},configureMethods:function(e){return e||{}},configurePlugins:function(e,t){var n,r,i;for(n=0,r=(e=e||[]).length;n<r;n++)"function"==typeof(i=e[n])&&(e[n]=i=i()),i.configure&&i.configure(this);return e},configureTransitions:function(e){var t,n,r,i,o,a=this.defaults.wildcard;for(n=0;n<e.length;n++)for(r=e[n],i=Array.isArray(r.from)?r.from:[r.from||a],o=r.to||a,t=0;t<i.length;t++)this.mapTransition({name:r.name,from:i[t],to:o})},transitionFor:function(e,t){var n=this.defaults.wildcard;return this.map[e][t]||this.map[n][t]},transitionsFor:function(e){var t=this.defaults.wildcard;return Object.keys(this.map[e]).concat(Object.keys(this.map[t]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}}),e.exports=o},function(e,t,n){var r=n(0),i=n(6),o=n(1),a=[null,[]];function s(e,t){this.context=e,this.config=t,this.state=t.init.from,this.observers=[e]}r(s.prototype,{init:function(e){if(r(this.context,this.config.data.apply(this.context,e)),o.hook(this,"init"),this.config.init.active)return this.fire(this.config.init.name,[])},is:function(e){return Array.isArray(e)?e.indexOf(this.state)>=0:this.state===e},isPending:function(){return this.pending},can:function(e){return!this.isPending()&&!!this.seek(e)},cannot:function(e){return!this.can(e)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(e,t){var n=this.config.defaults.wildcard,r=this.config.transitionFor(this.state,e),i=r&&r.to;return"function"==typeof i?i.apply(this.context,t):i===n?this.state:i},fire:function(e,t){return this.transit(e,this.state,this.seek(e,t),t)},transit:function(e,t,n,r){var i=this.config.lifecycle,o=this.config.options.observeUnchangedState||t!==n;return n?this.isPending()?this.context.onPendingTransition(e,t,n):(this.config.addState(n),this.beginTransit(),r.unshift({transition:e,from:t,to:n,fsm:this.context}),this.observeEvents([this.observersForEvent(i.onBefore.transition),this.observersForEvent(i.onBefore[e]),o?this.observersForEvent(i.onLeave.state):a,o?this.observersForEvent(i.onLeave[t]):a,this.observersForEvent(i.on.transition),o?["doTransit",[this]]:a,o?this.observersForEvent(i.onEnter.state):a,o?this.observersForEvent(i.onEnter[n]):a,o?this.observersForEvent(i.on[n]):a,this.observersForEvent(i.onAfter.transition),this.observersForEvent(i.onAfter[e]),this.observersForEvent(i.on[e])],r)):this.context.onInvalidTransition(e,t,n)},beginTransit:function(){this.pending=!0},endTransit:function(e){return this.pending=!1,e},failTransit:function(e){throw this.pending=!1,e},doTransit:function(e){this.state=e.to},observe:function(e){if(2===e.length){var t={};t[e[0]]=e[1],this.observers.push(t)}else this.observers.push(e[0])},observersForEvent:function(e){for(var t,n=0,r=this.observers.length,i=[];n<r;n++)(t=this.observers[n])[e]&&i.push(t);return[e,i,!0]},observeEvents:function(e,t,n,r){if(0===e.length)return this.endTransit(void 0===r||r);var i=e[0][0],a=e[0][1],s=e[0][2];if(t[0].event=i,i&&s&&i!==n&&o.hook(this,"lifecycle",t),0===a.length)return e.shift(),this.observeEvents(e,t,i,r);var c=a.shift(),u=c[i].apply(c,t);return u&&"function"==typeof u.then?u.then(this.observeEvents.bind(this,e,t,i)).catch(this.failTransit.bind(this)):!1===u?this.endTransit(!1):this.observeEvents(e,t,i,u)},onInvalidTransition:function(e,t,n){throw new i("transition is invalid in current state",e,t,n,this.state)},onPendingTransition:function(e,t,n){throw new i("transition is invalid while previous transition is still in progress",e,t,n,this.state)}}),e.exports=s},function(e,t,n){"use strict";var r=n(0),i=n(2),o=n(1),a=n(3),s=n(4),c={is:function(e){return this._fsm.is(e)},can:function(e){return this._fsm.can(e)},cannot:function(e){return this._fsm.cannot(e)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(e,t,n){return this._fsm.onInvalidTransition(e,t,n)},onPendingTransition:function(e,t,n){return this._fsm.onPendingTransition(e,t,n)}},u={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(e){throw Error("use transitions to change state")}}};function d(e){return l(this||{},e)}function l(e,t){return f(e,new a(t,d)),e._fsm(),e}function f(e,t){if("object"!=typeof e||Array.isArray(e))throw Error("StateMachine can only be applied to objects");o.build(e,t),Object.defineProperties(e,u),r(e,c),r(e,t.methods),t.allTransitions().forEach((function(t){e[i(t)]=function(){return this._fsm.fire(t,[].slice.call(arguments))}})),e._fsm=function(){this._fsm=new s(this,t),this._fsm.init(arguments)}}d.version="3.0.1",d.factory=function(){var e,t;"function"==typeof arguments[0]?(e=arguments[0],t=arguments[1]||{}):(e=function(){this._fsm.apply(this,arguments)},t=arguments[0]||{});var n=new a(t,d);return f(e.prototype,n),e.prototype._fsm.config=n,e},d.apply=l,d.defaults={wildcard:"*",init:{name:"init",from:"none"}},e.exports=d},function(e,t,n){"use strict";e.exports=function(e,t,n,r,i){this.message=e,this.transition=t,this.from=n,this.to=r,this.current=i}}])},e.exports=r()},function(e,t,n){"use strict";const r=n(104)();e.exports=r},function(e,t,n){"use strict";let r=function(){function e(){this.processTransition=()=>{},this.routedToRelayedOngoing=!1,this.relayedToRoutedPending=!1}var t=e.prototype;return t.startTransitionTo=function(e,t){void 0===t&&(t=()=>{}),"P2P"===e?this.startRoutedToRelayed():"MANTIS"===e&&this.startRelayedToRouted(t)},t.finishTransitionTo=function(e){"P2P"===e&&this.finishRoutedToRelayed()},t.startRoutedToRelayed=function(){this.routedToRelayedOngoing=!0},t.finishRoutedToRelayed=function(){this.routedToRelayedOngoing=!1,this.relayedToRoutedPending&&(this.relayedToRoutedPending=!1,this.processTransition())},t.startRelayedToRouted=function(e){this.routedToRelayedOngoing?(this.relayedToRoutedPending=!0,this.processTransition=e):e()},e}();e.exports=r},function(e,t,n){"use strict";(function(t){e.exports=function(e){return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return new t((t,n)=>{e(...r,(function(e){if(e)n(e);else{for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];1!==i.length?t(i):t(i[0])}}))})}}}).call(this,n(2))},function(e,t,n){"use strict";e.exports=e=>{var t;const n=Object.assign({},e);return(null==e||null==(t=e.backgroundImgUrl)?void 0:t.includes("base64"))&&delete n.backgroundImgUrl,n}},function(e,t,n){"use strict";const r={isSupported:()=>"undefined"!=typeof MediaStreamTrackProcessor&&"undefined"!=typeof MediaStreamTrackGenerator,setMetadata:n(726).setVonageMetadata,createProcessor:n(321).createVonageMediaProcessor};e.exports=r},function(e,t,n){"use strict";n.r(t),function(e,r){n.d(t,"BackgroundTransformer",(function(){return Oi})),n.d(t,"BackgroundTransformerType",(function(){return de})),n.d(t,"BlurRadius",(function(){return ue})),n.d(t,"ErrorFunction",(function(){return ne})),n.d(t,"MediapipeHelper",(function(){return Ae})),n.d(t,"PipelineInfoData",(function(){return re})),n.d(t,"RenderingType",(function(){return fe})),n.d(t,"VonageMediaProcessor",(function(){return Di})),n.d(t,"WarningType",(function(){return te})),n.d(t,"WebglSelfieSegmentationType",(function(){return le})),n.d(t,"createVonageMediaProcessor",(function(){return Bi})),n.d(t,"getSupportedBrowserFeatures",(function(){return be})),n.d(t,"getVonageFaceDetection",(function(){return Gi})),n.d(t,"getVonageFaceMash",(function(){return Fi})),n.d(t,"getVonageHands",(function(){return ji})),n.d(t,"getVonageHolistic",(function(){return Wi})),n.d(t,"getVonageObjectron",(function(){return Ui})),n.d(t,"getVonagePose",(function(){return Xi})),n.d(t,"getVonageSelfieSegmentation",(function(){return Zi})),n.d(t,"isSupported",(function(){return ye}));var i=Object.defineProperty,o=(e,t,n)=>(((e,t,n)=>{t in e?i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n),a=Object.defineProperty,s=(e,t,n)=>(((e,t,n)=>{t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class c{}s(c,"updates",{transformer_new:"New transformer",transformer_null:"Null transformer"}),s(c,"errors",{transformer_none:"No transformers provided",transformer_start:"Cannot start transformer",transformer_transform:"Cannot transform frame",transformer_flush:"Cannot flush transformer",readable_null:"Readable is null",writable_null:"Writable is null"});const u=new WeakMap,d=new WeakMap,l=new WeakMap,f=Symbol("anyProducer"),p=e.resolve(),h=Symbol("listenerAdded"),m=Symbol("listenerRemoved");let g=!1;function v(e){if("string"!=typeof e&&"symbol"!=typeof e)throw new TypeError("eventName must be a string or a symbol")}function y(e){if("function"!=typeof e)throw new TypeError("listener must be a function")}function b(e,t){const n=d.get(e);return n.has(t)||n.set(t,new Set),n.get(t)}function S(e,t){const n="string"==typeof t||"symbol"==typeof t?t:f,r=l.get(e);return r.has(n)||r.set(n,new Set),r.get(n)}function E(t,n){n=Array.isArray(n)?n:[n];let r=!1,i=()=>{},o=[];const a={enqueue(e){o.push(e),i()},finish(){r=!0,i()}};for(const e of n)S(t,e).add(a);return{async next(){return o?0===o.length?r?(o=void 0,this.next()):(await new e(e=>{i=e}),this.next()):{done:!1,value:await o.shift()}:{done:!0}},async return(e){o=void 0;for(const e of n)S(t,e).delete(a);return i(),arguments.length>0?{done:!0,value:await e}:{done:!0}},[Symbol.asyncIterator](){return this}}}function _(e){if(void 0===e)return I;if(!Array.isArray(e))throw new TypeError("`methodNames` must be an array of strings");for(const t of e)if(!I.includes(t))throw"string"!=typeof t?new TypeError("`methodNames` element must be a string"):new Error(t+" is not Emittery method");return e}const T=e=>e===h||e===m;class R{static mixin(e,t){return t=_(t),n=>{if("function"!=typeof n)throw new TypeError("`target` must be function");for(const e of t)if(void 0!==n.prototype[e])throw new Error(`The property \`${e}\` already exists on \`target\``);Object.defineProperty(n.prototype,e,{enumerable:!1,get:function(){return Object.defineProperty(this,e,{enumerable:!1,value:new R}),this[e]}});const r=t=>function(...n){return this[e][t](...n)};for(const e of t)Object.defineProperty(n.prototype,e,{enumerable:!1,value:r(e)});return n}}static get isDebugEnabled(){if("object"!=typeof r)return g;const{env:e}=r||{env:{}};return"emittery"===e.DEBUG||"*"===e.DEBUG||g}static set isDebugEnabled(e){g=e}constructor(e={}){u.set(this,new Set),d.set(this,new Map),l.set(this,new Map),this.debug=e.debug||{},void 0===this.debug.enabled&&(this.debug.enabled=!1),this.debug.logger||(this.debug.logger=(e,t,n,r)=>{try{r=JSON.stringify(r)}catch{r="Object with the following keys failed to stringify: "+Object.keys(r).join(",")}"symbol"==typeof n&&(n=n.toString());const i=new Date,o=`${i.getHours()}:${i.getMinutes()}:${i.getSeconds()}.${i.getMilliseconds()}`;console.log(`[${o}][emittery:${e}][${t}] Event Name: ${n}\n\tdata: ${r}`)})}logIfDebugEnabled(e,t,n){(R.isDebugEnabled||this.debug.enabled)&&this.debug.logger(e,this.debug.name,t,n)}on(e,t){y(t),e=Array.isArray(e)?e:[e];for(const n of e)v(n),b(this,n).add(t),this.logIfDebugEnabled("subscribe",n,void 0),T(n)||this.emit(h,{eventName:n,listener:t});return this.off.bind(this,e,t)}off(e,t){y(t),e=Array.isArray(e)?e:[e];for(const n of e)v(n),b(this,n).delete(t),this.logIfDebugEnabled("unsubscribe",n,void 0),T(n)||this.emit(m,{eventName:n,listener:t})}once(t){return new e(e=>{const n=this.on(t,t=>{n(),e(t)})})}events(e){e=Array.isArray(e)?e:[e];for(const t of e)v(t);return E(this,e)}async emit(t,n){v(t),this.logIfDebugEnabled("emit",t,n),function(t,n,r){const i=l.get(t);if(i.has(n))for(const e of i.get(n))e.enqueue(r);if(i.has(f)){const t=e.all([n,r]);for(const e of i.get(f))e.enqueue(t)}}(this,t,n);const r=b(this,t),i=u.get(this),o=[...r],a=T(t)?[]:[...i];await p,await e.all([...o.map(async e=>{if(r.has(e))return e(n)}),...a.map(async e=>{if(i.has(e))return e(t,n)})])}async emitSerial(e,t){v(e),this.logIfDebugEnabled("emitSerial",e,t);const n=b(this,e),r=u.get(this),i=[...n],o=[...r];await p;for(const e of i)n.has(e)&&await e(t);for(const n of o)r.has(n)&&await n(e,t)}onAny(e){return y(e),this.logIfDebugEnabled("subscribeAny",void 0,void 0),u.get(this).add(e),this.emit(h,{listener:e}),this.offAny.bind(this,e)}anyEvent(){return E(this)}offAny(e){y(e),this.logIfDebugEnabled("unsubscribeAny",void 0,void 0),this.emit(m,{listener:e}),u.get(this).delete(e)}clearListeners(e){e=Array.isArray(e)?e:[e];for(const t of e)if(this.logIfDebugEnabled("clear",t,void 0),"string"==typeof t||"symbol"==typeof t){b(this,t).clear();const e=S(this,t);for(const t of e)t.finish();e.clear()}else{u.get(this).clear();for(const e of d.get(this).values())e.clear();for(const e of l.get(this).values()){for(const t of e)t.finish();e.clear()}}}listenerCount(e){e=Array.isArray(e)?e:[e];let t=0;for(const n of e)if("string"!=typeof n){typeof n<"u"&&v(n),t+=u.get(this).size;for(const e of d.get(this).values())t+=e.size;for(const e of l.get(this).values())t+=e.size}else t+=u.get(this).size+b(this,n).size+S(this,n).size+S(this).size;return t}bindMethods(e,t){if("object"!=typeof e||null===e)throw new TypeError("`target` must be an object");t=_(t);for(const n of t){if(void 0!==e[n])throw new Error(`The property \`${n}\` already exists on \`target\``);Object.defineProperty(e,n,{enumerable:!1,value:this[n].bind(this)})}}}const I=Object.getOwnPropertyNames(R.prototype).filter(e=>"constructor"!==e);Object.defineProperty(R,"listenerAdded",{value:h,writable:!1,enumerable:!0,configurable:!1}),Object.defineProperty(R,"listenerRemoved",{value:m,writable:!1,enumerable:!0,configurable:!1});var w=R;function C(e){return function(e){if(function(e){return"object"==typeof e&&null!==e&&"message"in e&&"string"==typeof e.message}(e))return e;try{return new Error(JSON.stringify(e))}catch{return new Error(String(e))}}(e).message}var O=Object.defineProperty,A=(e,t,n)=>(((e,t,n)=>{t in e?O(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);let x;const k=new Uint8Array(16);function N(){if(!x&&(x=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!x))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return x(k)}const L=[];for(let e=0;e<256;++e)L.push((e+256).toString(16).slice(1));const M={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function V(e,t,n){if(M.randomUUID&&!t&&!e)return M.randomUUID();const r=(e=e||{}).random||(e.rng||N)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return function(e,t=0){return(L[e[t+0]]+L[e[t+1]]+L[e[t+2]]+L[e[t+3]]+"-"+L[e[t+4]]+L[e[t+5]]+"-"+L[e[t+6]]+L[e[t+7]]+"-"+L[e[t+8]]+L[e[t+9]]+"-"+L[e[t+10]]+L[e[t+11]]+L[e[t+12]]+L[e[t+13]]+L[e[t+14]]+L[e[t+15]]).toLowerCase()}(r)}function P(e,t){globalThis.vonage||(globalThis.vonage={}),globalThis.vonage.workerizer||(globalThis.vonage.workerizer={});let n=globalThis.vonage.workerizer;return n[e]||(n[e]=t),n[e]}const D=P("globals",{});var Z=(e=>(e.INIT="INIT",e.FORWARD="FORWARD",e.TERMINATE="TERMINATE",e.GLOBALS_SYNC="GLOBALS_SYNC",e))(Z||{});function j(e){return[ImageBitmap,ReadableStream,WritableStream].some(t=>e instanceof t)}let W=0;function G(t,n,r,i,o){const a=W++;return t.postMessage({id:a,type:n,functionName:r,args:i},i.filter(e=>j(e))),new e(e=>{null==o||o.set(a,e)})}function F(e,t){const{id:n,type:r}=e,i=Array.isArray(t)?t:[t];postMessage({id:n,type:r,result:t},i.filter(e=>j(e)))}const U=P("workerized",{});function X(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}function B(e,t){if(Array.isArray(t))t.splice(0,t.length);else if("object"==typeof t)for(const e in t)delete t[e];for(const n in e)Array.isArray(e[n])?(t[n]=[],B(e[n],t[n])):"object"==typeof e[n]?(t[n]={},B(e[n],t[n])):t[n]=e[n]}const H=P("registeredWorkers",{});function Y(t,n){return D[t]||(D[t]=n),[()=>D[t],async n=>{D[t]=n,await async function(){if(X())F({type:Z.GLOBALS_SYNC},D);else{const t=[];for(const e in U){const{worker:n,resolvers:r}=U[e].workerContext;n&&t.push(G(n,Z.GLOBALS_SYNC,"",[D],r))}await e.all(t)}}()}]}X()&&function(){const e={};onmessage=async t=>{const n=t.data;switch(n.type){case Z.INIT:!function(e,t){if(!e.args)throw"Missing className while initializing worker";const[n,r]=e.args,i=H[n];if(!i)throw"unknown worker class "+n;t.instance=new i(e.args.slice(1)),B(r,D),F(e,void 0!==typeof t.instance)}(n,e);break;case Z.FORWARD:!async function(e,t){const{functionName:n,args:r}=e;if(!t.instance)throw"instance not initialized";if(!n)throw"missing function name to call";if(!t.instance[n])throw`undefined function [${n}] in class ${t.instance.constructor.workerId}`;F(e,await t.instance[n](...null!=r?r:[]))}(n,e);break;case Z.TERMINATE:!async function(e,t){const{args:n}=e;if(!t.instance)throw"instance not initialized";let r;t.instance.terminate&&(r=await t.instance.terminate(...null!=n?n:[])),F(e,r)}(n,e);break;case Z.GLOBALS_SYNC:!function(e){if(!e.args)throw"Missing globals while syncing";B(e.args[0],D),F(e,{})}(n)}}}();const[J,z]=Y("metadata",K);var K;function Q(){return J()}class q{constructor(e){A(this,"uuid",V()),this.config=e}async send(e){var t,n,r;const{appId:i,sourceType:o}=null!=(t=Q())?t:{};if(!i||!o)return"metadata missing";const a=new AbortController,s=setTimeout(()=>a.abort(),1e4);return await(null!=(r=null==(n=this.config)?void 0:n.fetch)?r:fetch)(this.getUrl(),{method:"POST",headers:this.getHeaders(),body:JSON.stringify(this.buildReport(e)),signal:a.signal}),clearTimeout(s),"success"}getUrl(){var e;let t=null!=(e=Q().proxyUrl)?e:"https://";return t+=("/"===t.at(-1)?"":"/")+"hlg.tokbox.com/prod/logging/vcp_webrtc",t}getHeaders(){return{"Content-Type":"application/json"}}buildReport(e){const t=Q();return{guid:this.uuid,...e,applicationId:t.appId,timestamp:Date.now(),proxyUrl:t.proxyUrl,source:t.sourceType}}}const $="2.0.3";class ee{constructor(e){s(this,"frameTransformedCount",0),s(this,"frameFromSourceCount",0),s(this,"startAt",0),s(this,"reporter"),this.config=e,this.reporter=new q(e)}async onFrameFromSource(){this.frameFromSourceCount++}get fps(){const{startAt:e,frameFromSourceCount:t}=this;return t/((Date.now()-e)/1e3)}async onFrameTransformed(e={},t=!1){0===this.startAt&&(this.startAt=Date.now()),this.frameTransformedCount++;const{startAt:n,frameTransformedCount:r,frameFromSourceCount:i}=this,o=Date.now(),a=(o-n)/1e3,s=r/a,c=i/a;return t||this.frameTransformedCount>=this.config.loggingIntervalFrameCount?(this.frameFromSourceCount=0,this.frameTransformedCount=0,this.startAt=o,this.reporter.config=this.config,this.reporter.send({...this.config.report,variation:"QoS",fps:c,transformedFps:s,framesTransformed:r,...e})):"success"}}var te=(e=>(e.FPS_DROP="fps_drop",e))(te||{}),ne=(e=>(e.start="start",e.transform="transform",e.flush="flush",e))(ne||{}),re=(e=>(e.pipeline_ended="pipeline_ended",e.pipeline_ended_with_error="pipeline_ended_with_error",e.pipeline_started="pipeline_started",e.pipeline_started_with_error="pipeline_started_with_error",e.pipeline_restarted="pipeline_restarted",e.pipeline_restarted_with_error="pipeline_restarted_with_error",e))(re||{});class ie extends w{constructor(e,t){super(),s(this,"reporter_",new q),s(this,"reporterQos_",new ee({loggingIntervalFrameCount:500,report:{version:$}})),s(this,"transformerType_"),s(this,"transformer_"),s(this,"shouldStop_"),s(this,"isFlashed_"),s(this,"mediaTransformerQosReportStartTimestamp_"),s(this,"videoHeight_"),s(this,"videoWidth_"),s(this,"trackExpectedRate_"),s(this,"index_"),s(this,"controller_"),this.index_=t,this.transformer_=e,this.shouldStop_=!1,this.isFlashed_=!1,this.mediaTransformerQosReportStartTimestamp_=0,this.videoHeight_=0,this.videoWidth_=0,this.trackExpectedRate_=-1,this.transformerType_="Custom","getTransformerType"in e&&(this.transformerType_=e.getTransformerType()),this.report({variation:"Create"})}setTrackExpectedRate(e){this.trackExpectedRate_=e}async start(e){if(this.controller_=e,this.transformer_&&"function"==typeof this.transformer_.start)try{await this.transformer_.start(e)}catch(e){this.report({message:c.errors.transformer_start,variation:"Error",error:C(e)});const t={eventMetaData:{transformerIndex:this.index_},error:e,function:"start"};this.emit("error",t)}}async transform(e,t){var n,r,i,o;if(0===this.mediaTransformerQosReportStartTimestamp_&&(this.mediaTransformerQosReportStartTimestamp_=Date.now()),e instanceof VideoFrame&&(this.videoHeight_=null!=(n=null==e?void 0:e.displayHeight)?n:0,this.videoWidth_=null!=(r=null==e?void 0:e.displayWidth)?r:0),this.reporterQos_.onFrameFromSource(),this.transformer_)if(this.shouldStop_)console.warn("[Pipeline] flush from transform"),e.close(),this.flush(t),t.terminate();else{try{await(null==(o=(i=this.transformer_).transform)?void 0:o.call(i,e,t)),this.reportQos()}catch(e){this.report({message:c.errors.transformer_transform,variation:"Error",error:C(e)});const t={eventMetaData:{transformerIndex:this.index_},error:e,function:"transform"};this.emit("error",t)}if(-1!=this.trackExpectedRate_&&.8*this.trackExpectedRate_>this.reporterQos_.fps){const e={eventMetaData:{transformerIndex:this.index_},warningType:"fps_drop",dropInfo:{requested:this.trackExpectedRate_,current:this.reporterQos_.fps}};this.emit("warn",e)}}}async flush(e){if(this.transformer_&&"function"==typeof this.transformer_.flush&&!this.isFlashed_){this.isFlashed_=!0;try{await this.transformer_.flush(e)}catch(e){this.report({message:c.errors.transformer_flush,variation:"Error",error:C(e)});const t={eventMetaData:{transformerIndex:this.index_},error:e,function:"flush"};this.emit("error",t)}}this.reportQos(!0),this.report({variation:"Delete"})}stop(){console.log("[Pipeline] Stop stream."),this.controller_&&(this.flush(this.controller_),this.controller_.terminate()),this.shouldStop_=!0}report(e){this.reporter_.send({version:$,action:"MediaTransformer",transformerType:this.transformerType_,...e})}reportQos(e=!1){this.reporterQos_.config={...this.reporterQos_.config},this.reporterQos_.onFrameTransformed({version:$,action:"MediaTransformer",transformerType:this.transformerType_,videoWidth:this.videoWidth_,videoHeight:this.videoHeight_},e)}}class oe extends w{constructor(e){super(),s(this,"transformers_"),s(this,"trackExpectedRate_"),this.transformers_=[],this.trackExpectedRate_=-1;for(let t=0;t<e.length;t++){let n=new ie(e[t],t);n.on("error",e=>{this.emit("error",e)}),n.on("warn",e=>{this.emit("warn",e)}),this.transformers_.push(n)}}setTrackExpectedRate(e){this.trackExpectedRate_=e;for(let e of this.transformers_)e.setTrackExpectedRate(this.trackExpectedRate_)}async start(e,t){if(this.transformers_&&0!==this.transformers_.length){try{let n=e;for(let t of this.transformers_)e=e.pipeThrough(new TransformStream(t));e.pipeTo(t).then(async()=>{console.log("[Pipeline] Setup."),await t.abort(),await n.cancel(),this.emit("pipelineInfo","pipeline_ended")}).catch(async r=>{e.cancel().then(()=>{console.log("[Pipeline] Shutting down streams after abort.")}).catch(e=>{console.error("[Pipeline] Error from stream transform:",e)}),await t.abort(r),await n.cancel(r),this.emit("pipelineInfo","pipeline_ended_with_error")})}catch{return this.emit("pipelineInfo","pipeline_started_with_error"),void this.destroy()}this.emit("pipelineInfo","pipeline_started"),console.log("[Pipeline] Pipeline started.")}else console.log("[Pipeline] No transformers.")}async destroy(){console.log("[Pipeline] Destroying Pipeline.");for(let e of this.transformers_)e.stop()}}class ae extends w{constructor(){super(),s(this,"reporter_"),s(this,"pipeline_"),s(this,"transformers_"),s(this,"readable_"),s(this,"writable_"),s(this,"trackExpectedRate_"),this.reporter_=new q,this.trackExpectedRate_=-1,this.report({variation:"Create"})}setTrackExpectedRate(e){this.trackExpectedRate_=e,this.pipeline_&&this.pipeline_.setTrackExpectedRate(this.trackExpectedRate_)}transform(e,t){return this.readable_=e,this.writable_=t,this.transformInternal()}transformInternal(){return new e(async(e,t)=>{if(!this.transformers_||0===this.transformers_.length)return this.report({message:c.errors.transformer_none,variation:"Error"}),void t("[MediaProcessor] Need to set transformers.");if(!this.readable_)return this.report({variation:"Error",message:c.errors.readable_null}),void t("[MediaProcessor] Readable is null.");if(!this.writable_)return this.report({variation:"Error",message:c.errors.writable_null}),void t("[MediaProcessor] Writable is null.");let n=!1;this.pipeline_&&(n=!0,this.pipeline_.clearListeners(),this.pipeline_.destroy()),this.pipeline_=new oe(this.transformers_),this.pipeline_.on("warn",e=>{this.emit("warn",e)}),this.pipeline_.on("error",e=>{this.emit("error",e)}),this.pipeline_.on("pipelineInfo",e=>{n&&("pipeline_started"===e?e=re.pipeline_restarted:"pipeline_started_with_error"===e&&(e=re.pipeline_restarted_with_error)),this.emit("pipelineInfo",e)}),-1!=this.trackExpectedRate_&&this.pipeline_.setTrackExpectedRate(this.trackExpectedRate_),this.pipeline_.start(this.readable_,this.writable_).then(()=>{e()}).catch(e=>{t(e)})})}setTransformers(t){return this.report({variation:"Update",message:c.updates.transformer_new}),this.transformers_=t,this.readable_&&this.writable_?this.transformInternal():e.resolve()}destroy(){return new e(async e=>{this.pipeline_&&this.pipeline_.destroy(),this.report({variation:"Delete"}),e()})}report(e){this.reporter_.send({version:$,action:"MediaProcessor",...e})}}class se{constructor(){s(this,"processor_"),s(this,"generator_"),this.processor_=null,this.generator_=null}init(t){return new e((e,n)=>{try{this.processor_=new MediaStreamTrackProcessor(t)}catch(e){console.log("[InsertableStreamHelper] MediaStreamTrackProcessor failed: "+e),n(e)}try{"audio"===t.kind?this.generator_=new MediaStreamTrackGenerator({kind:"audio"}):"video"===t.kind?this.generator_=new MediaStreamTrackGenerator({kind:"video"}):n("kind not supported")}catch(e){console.log("[InsertableStreamHelper] MediaStreamTrackGenerator failed: "+e),n(e)}e()})}getReadable(){return this.processor_.readable}getWriteable(){return this.generator_.writable}getProccesorTrack(){return this.generator_}}class ce{constructor(e){s(this,"insertableStreamHelper_"),s(this,"mediaProcessor_"),this.insertableStreamHelper_=new se,this.mediaProcessor_=e}setTrack(t){return new e((e,n)=>{this.insertableStreamHelper_.init(t).then(()=>{this.mediaProcessor_.transform(this.insertableStreamHelper_.getReadable(),this.insertableStreamHelper_.getWriteable()).then(()=>{e(this.insertableStreamHelper_.getProccesorTrack())}).catch(e=>{n(e)})}).catch(e=>{n(e)})})}destroy(){return new e((e,t)=>{this.mediaProcessor_?this.mediaProcessor_.destroy().then(()=>{e()}).catch(e=>{t(e)}):t("no processor")})}}var ue=(e=>(e.Low="Low",e.High="High",e))(ue||{}),de=(e=>(e.BackgroundBlur="BackgroundBlur",e.VirtualBackground="VirtualBackground",e.VideoBackground="VideoBackground",e.SilhouetteBlur="SilhouetteBlur",e))(de||{}),le=(e=>(e.FAST="FAST",e.PRECISE="PRECISE",e))(le||{}),fe=(e=>(e.CANVAS="CANVAS",e.WEBGL="WEBGL",e))(fe||{});const pe=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]));var he=function(){var t=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return function(n){var r,i,o=typeof(n=n||{})<"u"?n:{};o.ready=new e((function(e,t){r=e,i=t}));var a,s={};for(a in o)o.hasOwnProperty(a)&&(s[a]=o[a]);var c="./this.program",u=function(e,t){throw t},d="";typeof document<"u"&&document.currentScript&&(d=document.currentScript.src),t&&(d=t),d=0!==d.indexOf("blob:")?d.substr(0,d.replace(/[?#].*/,"").lastIndexOf("/")+1):"";var l,f=o.print||console.log.bind(console),p=o.printErr||console.warn.bind(console);for(a in s)s.hasOwnProperty(a)&&(o[a]=s[a]);s=null,o.arguments&&o.arguments,o.thisProgram&&(c=o.thisProgram),o.quit&&(u=o.quit),o.wasmBinary&&(l=o.wasmBinary);var h=o.noExitRuntime||!0;"object"!=typeof WebAssembly&&V("no native wasm support detected");var m,g,v,y,b,S=!1,E=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function _(e,t,n){for(var r=t+n,i=t;e[i]&&!(i>=r);)++i;if(i-t>16&&e.subarray&&E)return E.decode(e.subarray(t,i));for(var o="";t<i;){var a=e[t++];if(128&a){var s=63&e[t++];if(192!=(224&a)){var c=63&e[t++];if((a=224==(240&a)?(15&a)<<12|s<<6|c:(7&a)<<18|s<<12|c<<6|63&e[t++])<65536)o+=String.fromCharCode(a);else{var u=a-65536;o+=String.fromCharCode(55296|u>>10,56320|1023&u)}}else o+=String.fromCharCode((31&a)<<6|s)}else o+=String.fromCharCode(a)}return o}function T(e,t){return e?_(y,e,t):""}function R(e,t){return e%t>0&&(e+=t-e%t),e}function I(e){g=e,o.HEAP8=v=new Int8Array(e),o.HEAP16=new Int16Array(e),o.HEAP32=b=new Int32Array(e),o.HEAPU8=y=new Uint8Array(e),o.HEAPU16=new Uint16Array(e),o.HEAPU32=new Uint32Array(e),o.HEAPF32=new Float32Array(e),o.HEAPF64=new Float64Array(e)}o.INITIAL_MEMORY;var w,C,O,A,x=[],k=[],N=[],L=0,M=null;function V(e){o.onAbort&&o.onAbort(e),p(e="Aborted("+e+")"),S=!0,e+=". Build with -s ASSERTIONS=1 for more info.";var t=new WebAssembly.RuntimeError(e);throw i(t),t}function P(e){return e.startsWith("data:application/octet-stream;base64,")}function D(e){try{if(e==C&&l)return new Uint8Array(l);throw"both async and sync fetching of the wasm failed"}catch(e){V(e)}}function Z(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var n=t.func;"number"==typeof n?void 0===t.arg?w.get(n)():w.get(n)(t.arg):n(void 0===t.arg?null:t.arg)}else t(o)}}function j(e){try{return m.grow(e-g.byteLength+65535>>>16),I(m.buffer),1}catch{}}o.preloadedImages={},o.preloadedAudios={},P(C="tflite-simd.wasm")||(O=C,C=o.locateFile?o.locateFile(O,d):d+O),A=function(){return performance.now()};var W={};function G(){if(!G.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:c||"./this.program"};for(var t in W)void 0===W[t]?delete e[t]:e[t]=W[t];var n=[];for(var t in e)n.push(t+"="+e[t]);G.strings=n}return G.strings}var F={mappings:{},buffers:[null,[],[]],printChar:function(e,t){var n=F.buffers[e];0===t||10===t?((1===e?f:p)(_(n,0)),n.length=0):n.push(t)},varargs:void 0,get:function(){return F.varargs+=4,b[F.varargs-4>>2]},getStr:function(e){return T(e)},get64:function(e,t){return e}},U={a:function(e,t,n,r){V("Assertion failed: "+T(e)+", at: "+[t?T(t):"unknown filename",n,r?T(r):"unknown function"])},e:function(e,t){V("To use dlopen, you need to use Emscripten's linking support, see https://github.com/emscripten-core/emscripten/wiki/Linking")},d:function(e,t){V("To use dlopen, you need to use Emscripten's linking support, see https://github.com/emscripten-core/emscripten/wiki/Linking")},b:function(){V("")},n:function(e,t){var n;if(0===e)n=Date.now();else{if(1!==e&&4!==e)return function(e){b[B()>>2]=e}(28),-1;n=A()}return b[t>>2]=n/1e3|0,b[t+4>>2]=n%1e3*1e3*1e3|0,0},h:function(){return 2147483648},l:function(e,t,n){y.copyWithin(e,t,t+n)},m:function(e){var t=y.length,n=2147483648;if((e>>>=0)>n)return!1;for(var r=1;r<=4;r*=2){var i=t*(1+.2/r);if(i=Math.min(i,e+100663296),j(Math.min(n,R(Math.max(e,i),65536))))return!0}return!1},p:function(e){for(var t=A();A()-t<e;);},f:function(e,t){var n=0;return G().forEach((function(r,i){var o=t+n;b[e+4*i>>2]=o,function(e,t,n){for(var r=0;r<e.length;++r)v[t++>>0]=e.charCodeAt(r);n||(v[t>>0]=0)}(r,o),n+=r.length+1})),0},g:function(e,t){var n=G();b[e>>2]=n.length;var r=0;return n.forEach((function(e){r+=e.length+1})),b[t>>2]=r,0},j:function(e){!function(e,t){!function(e){h||(o.onExit&&o.onExit(e),S=!0),u(e,new H(e))}(e)}(e)},i:function(e){return 0},k:function(e,t,n,r,i){},c:function(e,t,n,r){for(var i=0,o=0;o<n;o++){for(var a=b[t+8*o>>2],s=b[t+(8*o+4)>>2],c=0;c<s;c++)F.printChar(e,y[a+c]);i+=s}return b[r>>2]=i,0},o:function e(t,n){e.randomDevice||(e.randomDevice=function(){if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var e=new Uint8Array(1);return function(){return crypto.getRandomValues(e),e[0]}}return function(){V("randomDevice")}}());for(var r=0;r<n;r++)v[t+r>>0]=e.randomDevice();return 0}};(function(){var t={a:U};function n(e,t){var n=e.exports;o.asm=n,I((m=o.asm.q).buffer),w=o.asm.E,function(e){k.unshift(e)}(o.asm.r),function(e){if(L--,o.monitorRunDependencies&&o.monitorRunDependencies(L),0==L&&M){var t=M;M=null,t()}}()}function r(e){n(e.instance)}function a(n){return(l||"function"!=typeof fetch?e.resolve().then((function(){return D(C)})):fetch(C,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+C+"'";return e.arrayBuffer()})).catch((function(){return D(C)}))).then((function(e){return WebAssembly.instantiate(e,t)})).then((function(e){return e})).then(n,(function(e){p("failed to asynchronously prepare wasm: "+e),V(e)}))}if(L++,o.monitorRunDependencies&&o.monitorRunDependencies(L),o.instantiateWasm)try{return o.instantiateWasm(t,n)}catch(e){return p("Module.instantiateWasm callback failed with error: "+e),!1}(l||"function"!=typeof WebAssembly.instantiateStreaming||P(C)||"function"!=typeof fetch?a(r):fetch(C,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,t).then(r,(function(e){return p("wasm streaming compile failed: "+e),p("falling back to ArrayBuffer instantiation"),a(r)}))}))).catch(i)})(),o.___wasm_call_ctors=function(){return(o.___wasm_call_ctors=o.asm.r).apply(null,arguments)},o._getModelBufferMemoryOffset=function(){return(o._getModelBufferMemoryOffset=o.asm.s).apply(null,arguments)},o._getInputMemoryOffset=function(){return(o._getInputMemoryOffset=o.asm.t).apply(null,arguments)},o._getInputHeight=function(){return(o._getInputHeight=o.asm.u).apply(null,arguments)},o._getInputWidth=function(){return(o._getInputWidth=o.asm.v).apply(null,arguments)},o._getInputChannelCount=function(){return(o._getInputChannelCount=o.asm.w).apply(null,arguments)},o._getOutputMemoryOffset=function(){return(o._getOutputMemoryOffset=o.asm.x).apply(null,arguments)},o._getOutputHeight=function(){return(o._getOutputHeight=o.asm.y).apply(null,arguments)},o._getOutputWidth=function(){return(o._getOutputWidth=o.asm.z).apply(null,arguments)},o._getOutputChannelCount=function(){return(o._getOutputChannelCount=o.asm.A).apply(null,arguments)},o._loadModel=function(){return(o._loadModel=o.asm.B).apply(null,arguments)},o._runInference=function(){return(o._runInference=o.asm.C).apply(null,arguments)},o._isGPUEnabled=function(){return(o._isGPUEnabled=o.asm.D).apply(null,arguments)};var X,B=o.___errno_location=function(){return(B=o.___errno_location=o.asm.F).apply(null,arguments)};function H(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function Y(e){function t(){X||(X=!0,o.calledRun=!0,!S&&(Z(k),r(o),o.onRuntimeInitialized&&o.onRuntimeInitialized(),function(){if(o.postRun)for("function"==typeof o.postRun&&(o.postRun=[o.postRun]);o.postRun.length;)e=o.postRun.shift(),N.unshift(e);var e;Z(N)}()))}L>0||(function(){if(o.preRun)for("function"==typeof o.preRun&&(o.preRun=[o.preRun]);o.preRun.length;)e=o.preRun.shift(),x.unshift(e);var e;Z(x)}(),L>0)||(o.setStatus?(o.setStatus("Running..."),setTimeout((function(){setTimeout((function(){o.setStatus("")}),1),t()}),1)):t())}if(M=function e(){X||Y(),X||(M=e)},o.run=Y,o.preInit)for("function"==typeof o.preInit&&(o.preInit=[o.preInit]);o.preInit.length>0;)o.preInit.pop()();return Y(),n.ready}}();class me{constructor(){o(this,"selectedTFLite"),o(this,"isSIMDSupported",!1),o(this,"isThreadsSupported",!1),o(this,"inputWidth",0),o(this,"inputHeight",0),o(this,"inputChannelCount",0),o(this,"inputMemoryOffset",0),o(this,"outputWidth",0),o(this,"outputHeight",0),o(this,"outputChannelCount",0),o(this,"outputMemoryOffset",0)}}async function ge(t="https://d3opqjmqzxf057.cloudfront.net/vonage-tensorflow-wasm/tflite-simd-wasm/1.1.3/",n="https://d3opqjmqzxf057.cloudfront.net/ml/selfie_segmentation/4.0.0/"){let r=new me;return new e((function(i,o){(async function(){return he({locateFile:function(e){return t+e}})})().then(t=>{if(null===t)throw console.error("loadTFLite null"),"loadTFLite null";(async function(t){return new e(async(e,i)=>{const o=t;if(typeof o>"u")return i("TFLite backend unavailable: wasmSimd");const a="selfie_segmentation_landscape";console.log("Loading tflite model:",a);let s=n+(a+".tflite");console.log("TFLite modelUrl: "+s);try{const e=await(await fetch(s)).arrayBuffer();console.log("Model buffer size:",e.byteLength);const t=o._getModelBufferMemoryOffset();console.log("Model buffer memory offset:",t),console.log("Loading model buffer..."),o.HEAPU8.set(new Uint8Array(e),t);const n=o._loadModel(e.byteLength);if(console.log("Load model result:",n),0!==n)return void i("Cannot load model");r.inputWidth=o._getInputWidth(),r.inputHeight=o._getInputHeight(),r.inputChannelCount=o._getInputChannelCount(),r.inputMemoryOffset=o._getInputMemoryOffset(),console.log("Input memory offset:",r.inputMemoryOffset),console.log("Input height:",r.inputHeight),console.log("Input width:",r.inputWidth),console.log("Input channels:",r.inputChannelCount),r.outputMemoryOffset=o._getOutputMemoryOffset(),r.outputWidth=o._getOutputWidth(),r.outputHeight=o._getOutputHeight(),r.outputChannelCount=o._getOutputChannelCount(),console.log("Output memory offset:",r.outputMemoryOffset),console.log("Output height:",r.outputHeight),console.log("Output width:",r.outputWidth),console.log("Output channels:",r.outputChannelCount),r.selectedTFLite=o}catch(e){return void i(e)}e()})})(t).then(e=>{i(r)}).catch(e=>{console.error("loadTFLiteModel error"),o("loadTFLiteModel error")})}).catch(e=>{console.error("loadTFLite error:",e),o("loadTFLite error:"+e)})}))}class ve{constructor(){o(this,"canvas",new OffscreenCanvas(0,0)),o(this,"context",this.canvas.getContext("2d",{willReadFrequently:!0})),o(this,"pixelCount",0),o(this,"inputOffset",0),o(this,"outputOffset",0),o(this,"infos"),o(this,"mask")}async init(e,t){await this.initWasm(e,t),this.infos&&(this.canvas.width=this.infos.inputWidth,this.canvas.height=this.infos.inputHeight,this.pixelCount=this.infos.inputWidth*this.infos.inputHeight,this.mask=new ImageData(this.infos.inputWidth,this.infos.inputHeight),this.inputOffset=this.infos.inputMemoryOffset/4,this.outputOffset=this.infos.outputMemoryOffset/4)}async initWasm(e,t){this.infos=await ge(e,t)}getOutputDimensions(){var e,t,n,r;return{width:null!=(t=null==(e=this.infos)?void 0:e.outputWidth)?t:0,height:null!=(r=null==(n=this.infos)?void 0:n.outputHeight)?r:0}}async process(e){if(!this.mask||!this.infos)return;const t=this.infos.inputWidth,n=this.infos.inputHeight;this.context.drawImage(e,0,0,e.width,e.height,0,0,t,n);const r=this.context.getImageData(0,0,t,n),i=this.infos.selectedTFLite.HEAPF32;for(let e=0;e<this.pixelCount;e++){const t=this.inputOffset+3*e;i[t]=r.data[4*e]/255,i[t+1]=r.data[4*e+1]/255,i[t+2]=r.data[4*e+2]/255}this.infos.selectedTFLite._runInference();for(let e=0;e<this.pixelCount;e++){const t=this.infos.selectedTFLite.HEAPF32[this.outputOffset+e];this.mask.data[4*e]=this.mask.data[4*e+3]=255*t}return createImageBitmap(this.mask)}isGpuSupported(){var e,t,n;return null!=(n=null==(t=null==(e=this.infos)?void 0:e.selectedTFLite)?void 0:t._isGPUEnabled())&&n}}async function ye(e,t){const{wasm:n,insertableStreams:r,simd:i,webgl:o}=await be(e,t);if(!n.supported)throw n.message;if(!r.supported)throw r.message;if(!i.supported)throw i.message;if(!o.supported)throw o.message}async function be(t,n){const r=new ve;await r.initWasm(t,n);const i={wasm:{supported:"object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate,message:"Your browser does not support WebAssembly features."},simd:{supported:await pe(),message:"Your browser does not support simd features."},insertableStreams:{supported:!0},gpu:{supported:r.isGpuSupported(),message:"Your browser does not support gpu features."},webgl:OffscreenCanvas?new OffscreenCanvas(0,0).getContext("webgl2")?{supported:!0}:{supported:!1,message:"Your browser does not support webgl 2"}:{supported:!1,message:"Your browser does not support offscreen canvas"},performance:Se()};try{await new e((e,t)=>{typeof MediaStreamTrackProcessor>"u"||typeof MediaStreamTrackGenerator>"u"?t("Your browser does not support the MediaStreamTrack API for Insertable Streams of Media."):e()})}catch(e){i.insertableStreams.supported=!1,i.insertableStreams.message=e}return i}function Se(){return new OffscreenCanvas(0,0).getContext("webgl2",{failIfMajorPerformanceCaveat:!0})?{supported:!0}:{supported:!1,message:"Your hardware does not perform good enough to run the library efficiently"}}const Ee={};(function(){var t;function n(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var r="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},i=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof(void 0!==typeof window?window:global)&&(void 0!==typeof window?window:global)];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function o(e,t){if(t)e:{var n=i;e=e.split(".");for(var o=0;o<e.length-1;o++){var a=e[o];if(!(a in n))break e;n=n[a]}(t=t(o=n[e=e[e.length-1]]))!=o&&null!=t&&r(n,e,{configurable:!0,writable:!0,value:t})}}function a(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function s(e){var t=typeof Symbol<"u"&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:n(e)}}function c(e){if(!(e instanceof Array)){e=s(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}o("Symbol",(function(e){function t(e,t){this.g=e,r(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.g};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",i=0;return function e(r){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(r||"")+"_"+i++,r)}})),o("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),o=0;o<t.length;o++){var s=i[t[o]];"function"==typeof s&&"function"!=typeof s.prototype[e]&&r(s.prototype,e,{configurable:!0,writable:!0,value:function(){return a(n(this))}})}return e}));var u,d="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)u=Object.setPrototypeOf;else{var l;e:{var f={};try{f.__proto__={a:!0},l=f.a;break e}catch{}l=!1}u=l?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var p=u;function h(e,t){if(e.prototype=d(t.prototype),e.prototype.constructor=e,p)p(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var r=Object.getOwnPropertyDescriptor(t,n);r&&Object.defineProperty(e,n,r)}else e[n]=t[n];e.ea=t.prototype}function m(){this.l=!1,this.i=null,this.h=void 0,this.g=1,this.s=this.m=0,this.j=null}function g(e){if(e.l)throw new TypeError("Generator is already running");e.l=!0}function v(e,t){e.j={U:t,V:!0},e.g=e.m||e.s}function y(e,t,n){return e.g=n,{value:t}}function b(e){this.g=new m,this.h=e}function S(e,t,n,r){try{var i=t.call(e.g.i,n);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return e.g.l=!1,i;var o=i.value}catch(t){return e.g.i=null,v(e.g,t),E(e)}return e.g.i=null,r.call(e.g,o),E(e)}function E(e){for(;e.g.g;)try{var t=e.h(e.g);if(t)return e.g.l=!1,{value:t.value,done:!1}}catch(t){e.g.h=void 0,v(e.g,t)}if(e.g.l=!1,e.g.j){if(t=e.g.j,e.g.j=null,t.V)throw t.U;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function _(e){this.next=function(t){return g(e.g),e.g.i?t=S(e,e.g.i.next,t,e.g.o):(e.g.o(t),t=E(e)),t},this.throw=function(t){return g(e.g),e.g.i?t=S(e,e.g.i.throw,t,e.g.o):(v(e.g,t),t=E(e)),t},this.return=function(t){return function(e,t){g(e.g);var n=e.g.i;return n?S(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),E(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function T(e,t){return t=new _(new b(t)),p&&e.prototype&&p(t,e.prototype),t}m.prototype.o=function(e){this.h=e},m.prototype.return=function(e){this.j={return:e},this.g=this.s};var R="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e};o("Object.assign",(function(e){return e||R})),o("Promise",(function(e){function t(e){this.h=0,this.i=void 0,this.g=[],this.o=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function n(){this.g=null}function r(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;n.prototype.h=function(e){if(null==this.g){this.g=[];var t=this;this.i((function(){t.l()}))}this.g.push(e)};var o=i.setTimeout;n.prototype.i=function(e){o(e,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.j(e)}}}this.g=null},n.prototype.j=function(e){this.i((function(){throw e}))},t.prototype.j=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.C),reject:e(this.l)}},t.prototype.C=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.F(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.u(e):this.m(e)}},t.prototype.u=function(e){var t=void 0;try{t=e.then}catch(e){return void this.l(e)}"function"==typeof t?this.G(t,e):this.m(e)},t.prototype.l=function(e){this.s(2,e)},t.prototype.m=function(e){this.s(1,e)},t.prototype.s=function(e,t){if(0!=this.h)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.h);this.h=e,this.i=t,2===this.h&&this.D(),this.A()},t.prototype.D=function(){var e=this;o((function(){if(e.B()){var t=i.console;typeof t<"u"&&t.error(e.i)}}),1)},t.prototype.B=function(){if(this.o)return!1;var e=i.CustomEvent,t=i.Event,n=i.dispatchEvent;return typeof n>"u"||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=i.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.i,n(e))},t.prototype.A=function(){if(null!=this.g){for(var e=0;e<this.g.length;++e)a.h(this.g[e]);this.g=null}};var a=new n;return t.prototype.F=function(e){var t=this.j();e.J(t.resolve,t.reject)},t.prototype.G=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(e){o(e)}}:t}var i,o,a=new t((function(e,t){i=e,o=t}));return this.J(r(e,i),r(n,o)),a},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.J=function(e,t){function n(){switch(r.h){case 1:e(r.i);break;case 2:t(r.i);break;default:throw Error("Unexpected state: "+r.h)}}var r=this;null==this.g?a.h(n):this.g.push(n),this.o=!0},t.resolve=r,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var i=s(e),o=i.next();!o.done;o=i.next())r(o.value).J(t,n)}))},t.all=function(e){var n=s(e),i=n.next();return i.done?r([]):new t((function(e,t){function o(t){return function(n){a[t]=n,0==--s&&e(a)}}var a=[],s=0;do{a.push(void 0),s++,r(i.value).J(o(a.length-1),t),i=n.next()}while(!i.done)}))},t})),o("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}})),o("Array.prototype.includes",(function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var r=n.length;for(0>(t=t||0)&&(t=Math.max(t+r,0));t<r;t++){var i=n[t];if(i===e||Object.is(i,e))return!0}return!1}})),o("String.prototype.includes",(function(e){return e||function(e,t){if(null==this)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return-1!==this.indexOf(e,t||0)}})),o("Array.prototype.keys",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,(function(e){return e}))}}));var I=this||self;function w(e,t){e=e.split(".");var n,r=I;e[0]in r||typeof r.execScript>"u"||r.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)e.length||void 0===t?r=r[n]&&r[n]!==Object.prototype[n]?r[n]:r[n]={}:r[n]=t}function C(e,t){return t=String.fromCharCode.apply(null,t),null==e?t:e+t}var O,A,x=typeof TextDecoder<"u",k=typeof TextEncoder<"u";function N(e){if(k)e=(A||(A=new TextEncoder)).encode(e);else{var t=void 0;t=void 0!==t&&t;for(var n=0,r=new Uint8Array(3*e.length),i=0;i<e.length;i++){var o=e.charCodeAt(i);if(128>o)r[n++]=o;else{if(2048>o)r[n++]=o>>6|192;else{if(55296<=o&&57343>=o){if(56319>=o&&i<e.length){var a=e.charCodeAt(++i);if(56320<=a&&57343>=a){o=1024*(o-55296)+a-56320+65536,r[n++]=o>>18|240,r[n++]=o>>12&63|128,r[n++]=o>>6&63|128,r[n++]=63&o|128;continue}i--}if(t)throw Error("Found an unpaired surrogate");o=65533}r[n++]=o>>12|224,r[n++]=o>>6&63|128}r[n++]=63&o|128}}e=r.subarray(0,n)}return e}var L={},M=null;function V(e,t){void 0===t&&(t=0),D(),t=L[t];for(var n=Array(Math.floor(e.length/3)),r=t[64]||"",i=0,o=0;i<e.length-2;i+=3){var a=e[i],s=e[i+1],c=e[i+2],u=t[a>>2];a=t[(3&a)<<4|s>>4],s=t[(15&s)<<2|c>>6],c=t[63&c],n[o++]=u+a+s+c}switch(u=0,c=r,e.length-i){case 2:c=t[(15&(u=e[i+1]))<<2]||r;case 1:e=e[i],n[o]=t[e>>2]+t[(3&e)<<4|u>>4]+c+r}return n.join("")}function P(e){var t=e.length,n=3*t/4;n%3?n=Math.floor(n):-1!="=.".indexOf(e[t-1])&&(n=-1!="=.".indexOf(e[t-2])?n-2:n-1);var r=new Uint8Array(n),i=0;return function(e,t){function n(t){for(;r<e.length;){var n=e.charAt(r++),i=M[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return t}D();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;t(i<<2|o>>4),64!=a&&(t(o<<4&240|a>>2),64!=s&&t(a<<6&192|s))}}(e,(function(e){r[i++]=e})),r.subarray(0,i)}function D(){if(!M){M={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++){var r=e.concat(t[n].split(""));L[n]=r;for(var i=0;i<r.length;i++){var o=r[i];void 0===M[o]&&(M[o]=i)}}}}var Z,j="function"==typeof Uint8Array.prototype.slice;function W(e,t,n){return t===n?Z||(Z=new Uint8Array(0)):j?e.slice(t,n):new Uint8Array(e.subarray(t,n))}var G=0;function F(e,t){t=void 0!==(t=void 0===t?{}:t).v&&t.v,this.h=null,this.g=this.i=this.j=0,this.l=!1,this.v=t,e&&U(this,e)}function U(e,t){t=t.constructor===Uint8Array?t:t.constructor===ArrayBuffer||t.constructor===Array?new Uint8Array(t):t.constructor===String?P(t):t instanceof Uint8Array?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(0),e.h=t,e.j=0,e.i=e.h.length,e.g=e.j}function X(e){var t=e.h,n=t[e.g],r=127&n;return 128>n?(e.g+=1,r):(r|=(127&(n=t[e.g+1]))<<7,128>n?(e.g+=2,r):(r|=(127&(n=t[e.g+2]))<<14,128>n?(e.g+=3,r):(r|=(127&(n=t[e.g+3]))<<21,128>n?(e.g+=4,r):(r|=(15&(n=t[e.g+4]))<<28,128>n?(e.g+=5,r>>>0):(e.g+=5,128<=t[e.g++]&&128<=t[e.g++]&&128<=t[e.g++]&&128<=t[e.g++]&&e.g++,r)))))}function B(e){var t=e.h[e.g],n=e.h[e.g+1],r=e.h[e.g+2],i=e.h[e.g+3];return e.g+=4,e=2*((n=(t<<0|n<<8|r<<16|i<<24)>>>0)>>31)+1,t=n>>>23&255,n&=8388607,255==t?n?NaN:1/0*e:0==t?e*Math.pow(2,-149)*n:e*Math.pow(2,t-150)*(n+Math.pow(2,23))}F.prototype.reset=function(){this.g=this.j};var H=[];function Y(){this.g=new Uint8Array(64),this.h=0}function J(e,t){for(;127<t;)e.push(127&t|128),t>>>=7;e.push(t)}function z(e){var t={},n=void 0!==t.N&&t.N;this.o={v:void 0!==t.v&&t.v},this.N=n,t=this.o,H.length?(n=H.pop(),t&&(n.v=t.v),e&&U(n,e),e=n):e=new F(e,t),this.g=e,this.m=this.g.g,this.h=this.i=this.l=-1,this.j=!1}function K(e){var t=e.g;if((t=t.g==t.i)||(t=e.j)||(t=(t=e.g).l||0>t.g||t.g>t.i),t)return!1;e.m=e.g.g;var n=7&(t=X(e.g));return 0!=n&&5!=n&&1!=n&&2!=n&&3!=n&&4!=n?(e.j=!0,!1):(e.i=t,e.l=t>>>3,e.h=n,!0)}function Q(e,t,n){var r=e.g.i,i=X(e.g);return i=e.g.g+i,e.g.i=i,n(t,e),e.g.g=i,e.g.i=r,t}function q(e){var t,n=X(e.g),r=(e=e.g).g;if(e.g+=n,e=e.h,x)(t=O)||(t=O=new TextDecoder("utf-8",{fatal:!1})),t=t.decode(e.subarray(r,r+n));else{n=r+n;for(var i,o,a,s=[],c=null;r<n;)128>(i=e[r++])?s.push(i):224>i?r>=n?s.push(65533):(o=e[r++],194>i||128!=(192&o)?(r--,s.push(65533)):s.push((31&i)<<6|63&o)):240>i?r>=n-1?s.push(65533):128!=(192&(o=e[r++]))||224===i&&160>o||237===i&&160<=o||128!=(192&(t=e[r++]))?(r--,s.push(65533)):s.push((15&i)<<12|(63&o)<<6|63&t):244>=i?r>=n-2?s.push(65533):128!=(192&(o=e[r++]))||o-144+(i<<28)>>30!=0||128!=(192&(t=e[r++]))||128!=(192&(a=e[r++]))?(r--,s.push(65533)):(i=(7&i)<<18|(63&o)<<12|(63&t)<<6|63&a,i-=65536,s.push(55296+(i>>10&1023),56320+(1023&i))):s.push(65533),8192<=s.length&&(c=C(c,s),s.length=0);t=C(c,s)}return t}function $(){this.h=[],this.i=0,this.g=new Y}function ee(e,t){0!==t.length&&(e.h.push(t),e.i+=t.length)}function te(e){var t=e.i+e.g.length();if(0===t)return new Uint8Array(0);t=new Uint8Array(t);for(var n=e.h,r=n.length,i=0,o=0;o<r;o++){var a=n[o];0!==a.length&&(t.set(a,i),i+=a.length)}return 0!==(r=(n=e.g).h)&&(t.set(n.g.subarray(0,r),i),n.h=0),e.h=[t],t}function ne(e,t,n){if(null!=n){J(e.g,8*t+5),e=e.g;var r=n;0===(r=(n=0>r?1:0)?-r:r)?G=0<1/r?0:2147483648:isNaN(r)?G=2147483647:34028234663852886e22<r?G=(n<<31|2139095040)>>>0:11754943508222875e-54>r?(r=Math.round(r/Math.pow(2,-149)),G=(n<<31|r)>>>0):(t=Math.floor(Math.log(r)/Math.LN2),r*=Math.pow(2,-t),r=8388607&Math.round(8388608*r),G=(n<<31|t+127<<23|r)>>>0),n=G,e.push(n>>>0&255),e.push(n>>>8&255),e.push(n>>>16&255),e.push(n>>>24&255)}}Y.prototype.push=function(e){if(!(this.h+1<this.g.length)){var t=this.g;this.g=new Uint8Array(Math.ceil(1+2*this.g.length)),this.g.set(t)}this.g[this.h++]=e},Y.prototype.length=function(){return this.h},Y.prototype.end=function(){var e=this.g,t=this.h;return this.h=0,W(e,0,t)},z.prototype.reset=function(){this.g.reset(),this.h=this.l=-1};var re="function"==typeof Uint8Array;function ie(e,t,n){if(null!=e)return"object"==typeof e?re&&e instanceof Uint8Array?n(e):oe(e,t,n):t(e)}function oe(e,t,n){if(Array.isArray(e)){for(var r=Array(e.length),i=0;i<e.length;i++)r[i]=ie(e[i],t,n);return Array.isArray(e)&&e.W&&ue(r),r}for(i in r={},e)r[i]=ie(e[i],t,n);return r}function ae(e){return"number"==typeof e?isFinite(e)?e:String(e):e}var se,ce={W:{value:!0,configurable:!0}};function ue(e){return Array.isArray(e)&&!Object.isFrozen(e)&&Object.defineProperties(e,ce),e}function de(e,t,n){var r=se;if(se=null,e||(e=r),r=this.constructor.ca,e||(e=r?[r]:[]),this.j=r?0:-1,this.i=null,this.g=e,e=(r=this.g.length)-1,r&&null!==(r=this.g[e])&&"object"==typeof r&&r.constructor===Object?(this.l=e-this.j,this.h=r):void 0!==t&&-1<t?(this.l=Math.max(t,e+1-this.j),this.h=null):this.l=Number.MAX_VALUE,n)for(t=0;t<n.length;t++)(e=n[t])<this.l?(e+=this.j,(r=this.g[e])?ue(r):this.g[e]=le):(fe(this),(r=this.h[e])?ue(r):this.h[e]=le)}var le=Object.freeze(ue([]));function fe(e){var t=e.l+e.j;e.g[t]||(e.h=e.g[t]={})}function pe(e,t,n){return-1===t?null:void 0!==n&&n||t>=e.l?e.h?e.h[t]:void 0:e.g[t+e.j]}function he(e){var t=void 0!==t&&t,n=pe(e,1,t);return null==n&&(n=le),n===le&&ge(e,1,n=ue([]),t),n}function me(e,t,n){return null==(e=null==(e=pe(e,t))?e:+e)?void 0===n?0:n:e}function ge(e,t,n,r){void 0!==r&&r||t>=e.l?(fe(e),e.h[t]=n):e.g[t+e.j]=n}function ve(e,t){e.i||(e.i={});var n=e.i[1];if(!n){var r=he(e);n=[];for(var i=0;i<r.length;i++)n[i]=new t(r[i]);e.i[1]=n}return n}function ye(e,t,n,r){var i=ve(e,n);t=t||new n,e=he(e),null!=r?(i.splice(r,0,t),e.splice(r,0,be(t))):(i.push(t),e.push(be(t)))}function be(e,t){if(e.i)for(var n in e.i){var r=e.i[n];if(Array.isArray(r))for(var i=0;i<r.length;i++)r[i]&&be(r[i]);else r&&be(r)}return e.g}function Se(e,t){return null==(e=pe(e,t))?0:e}function Ee(e,t){return null==(e=pe(e,t))?"":e}function _e(e,t){if(e=e.m){ee(t,t.g.end());for(var n=0;n<e.length;n++)ee(t,e[n])}}function Te(e,t){if(4==t.h)return!1;var n=t.m;return function e(t){switch(t.h){case 0:if(0!=t.h)e(t);else{for(t=t.g;128&t.h[t.g];)t.g++;t.g++}break;case 1:1!=t.h?e(t):(t=t.g).g+=8;break;case 2:if(2!=t.h)e(t);else{var n=X(t.g);(t=t.g).g+=n}break;case 5:5!=t.h?e(t):(t=t.g).g+=4;break;case 3:for(n=t.l;;){if(!K(t)){t.j=!0;break}if(4==t.h){t.l!=n&&(t.j=!0);break}e(t)}break;default:t.j=!0}}(t),t.N||(t=W(t.g.h,n,t.g.g),(n=e.m)?n.push(t):e.m=[t]),!0}function Re(t,n){var r=void 0;return new(r||(r=e))((function(e,i){function o(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(t){t.done?e(t.value):new r((function(e){e(t.value)})).then(o,a)}s((n=n.apply(t,void 0)).next())}))}function Ie(e){de.call(this,e)}function we(e,t){for(;K(t);)switch(t.i){case 8:var n=X(t.g);ge(e,1,n);break;case 21:ge(e,2,n=B(t.g));break;case 26:ge(e,3,n=q(t));break;case 34:ge(e,4,n=q(t));break;default:if(!Te(e,t))return e}return e}function Ce(e){de.call(this,e,-1,Oe)}de.prototype.toJSON=function(){return oe(be(this),ae,V)},de.prototype.toString=function(){return be(this).toString()},h(Ie,de),h(Ce,de),Ce.prototype.addClassification=function(e,t){ye(this,e,Ie,t)};var Oe=[1];function Ae(e){de.call(this,e)}function xe(e,t){for(;K(t);)switch(t.i){case 13:var n=B(t.g);ge(e,1,n);break;case 21:ge(e,2,n=B(t.g));break;case 29:ge(e,3,n=B(t.g));break;case 37:ge(e,4,n=B(t.g));break;case 45:ge(e,5,n=B(t.g));break;default:if(!Te(e,t))return e}return e}function ke(e){de.call(this,e,-1,Ne)}h(Ae,de),h(ke,de);var Ne=[1];function Le(e){de.call(this,e)}function Me(e,t,n){if(n=e.createShader(0===n?e.VERTEX_SHADER:e.FRAGMENT_SHADER),e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw Error("Could not compile WebGL shader.\n\n"+e.getShaderInfoLog(n));return n}function Ve(e){return ve(e,Ie).map((function(e){return{index:Se(e,1),Y:me(e,2),label:null!=pe(e,3)?Ee(e,3):void 0,displayName:null!=pe(e,4)?Ee(e,4):void 0}}))}function Pe(e){return{x:me(e,1),y:me(e,2),z:me(e,3),visibility:null!=pe(e,4)?me(e,4):void 0}}function De(e,t){this.h=e,this.g=t,this.l=0}function Ze(t,n,r){return function(e,t){var n=e.g;if(void 0===e.m){var r=Me(n,"\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }",0),i=Me(n,"\n  precision mediump float;\n  varying vec2 vTex;\n  uniform sampler2D sampler0;\n  void main(){\n    gl_FragColor = texture2D(sampler0, vTex);\n  }",1),o=n.createProgram();if(n.attachShader(o,r),n.attachShader(o,i),n.linkProgram(o),!n.getProgramParameter(o,n.LINK_STATUS))throw Error("Could not compile WebGL program.\n\n"+n.getProgramInfoLog(o));r=e.m=o,n.useProgram(r),i=n.getUniformLocation(r,"sampler0"),e.j={I:n.getAttribLocation(r,"aVertex"),H:n.getAttribLocation(r,"aTex"),da:i},e.s=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,e.s),n.enableVertexAttribArray(e.j.I),n.vertexAttribPointer(e.j.I,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),e.o=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,e.o),n.enableVertexAttribArray(e.j.H),n.vertexAttribPointer(e.j.H,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.uniform1i(i,0)}r=e.j,n.useProgram(e.m),n.canvas.width=t.width,n.canvas.height=t.height,n.viewport(0,0,t.width,t.height),n.activeTexture(n.TEXTURE0),e.h.bindTexture2d(t.glName),n.enableVertexAttribArray(r.I),n.bindBuffer(n.ARRAY_BUFFER,e.s),n.vertexAttribPointer(r.I,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(r.H),n.bindBuffer(n.ARRAY_BUFFER,e.o),n.vertexAttribPointer(r.H,2,n.FLOAT,!1,0,0),n.bindFramebuffer(n.DRAW_FRAMEBUFFER?n.DRAW_FRAMEBUFFER:n.FRAMEBUFFER,null),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.colorMask(!0,!0,!0,!0),n.drawArrays(n.TRIANGLE_FAN,0,4),n.disableVertexAttribArray(r.I),n.disableVertexAttribArray(r.H),n.bindBuffer(n.ARRAY_BUFFER,null),e.h.bindTexture2d(0)}(t,n),"function"==typeof t.g.canvas.transferToImageBitmap?e.resolve(t.g.canvas.transferToImageBitmap()):r?e.resolve(t.g.canvas):"function"==typeof createImageBitmap?createImageBitmap(t.g.canvas):(void 0===t.i&&(t.i=document.createElement("canvas")),new e((function(e){t.i.height=t.g.canvas.height,t.i.width=t.g.canvas.width,t.i.getContext("2d",{}).drawImage(t.g.canvas,0,0,t.g.canvas.width,t.g.canvas.height),e(t.i)})))}function je(e){this.g=e}h(Le,de);var We=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function Ge(e,t){return t+e}function Fe(e,t){window[e]=t}function Ue(t){if(this.g=t,this.listeners={},this.j={},this.F={},this.m={},this.s={},this.G=this.o=this.R=!0,this.C=e.resolve(),this.P="",this.B={},this.locateFile=t&&t.locateFile||Ge,"object"==typeof window)var n=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if(!(typeof location<"u"))throw Error("solutions can only be loaded on a web page or in a web worker");n=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}if(this.S=n,t.options)for(var r=(n=s(Object.keys(t.options))).next();!r.done;r=n.next()){r=r.value;var i=t.options[r].default;void 0!==i&&(this.j[r]="function"==typeof i?i():i)}}function Xe(t){return Re(t,(function t(){var n,r,i,o,a,s,u,d,l,f,p,h=this;return T(t,(function(t){switch(t.g){case 1:return n=h,h.R?(r=function(e,t){return void 0===e.g.files?[]:"function"==typeof e.g.files?e.g.files(t):e.g.files}(h,h.j),y(t,function(){return Re(this,(function e(){return T(e,(function(e){switch(e.g){case 1:return e.m=2,y(e,WebAssembly.instantiate(We),4);case 4:e.g=3,e.m=0;break;case 2:return e.m=0,e.j=null,e.return(!1);case 3:return e.return(!0)}}))}))}(),2)):t.return();case 2:if(i=t.h,"object"==typeof window)return Fe("createMediapipeSolutionsWasm",{locateFile:h.locateFile}),Fe("createMediapipeSolutionsPackedAssets",{locateFile:h.locateFile}),s=r.filter((function(e){return void 0!==e.data})),u=r.filter((function(e){return void 0===e.data})),d=e.all(s.map((function(t){var r=Be(n,t.url);if(void 0!==t.path){var i=t.path;r=r.then((function(t){return n.overrideFile(i,t),e.resolve(t)}))}return r}))),l=e.all(u.map((function(t){return void 0===t.simd||t.simd&&i||!t.simd&&!i?function(t){var n=document.createElement("script");return n.setAttribute("src",t),n.setAttribute("crossorigin","anonymous"),new e((function(e){n.addEventListener("load",(function(){e()}),!1),n.addEventListener("error",(function(){e()}),!1),document.body.appendChild(n)}))}(n.locateFile(t.url,n.S)):e.resolve()}))).then((function(){return Re(n,(function e(){var t,n,r=this;return T(e,(function(e){if(1==e.g)return t=window.createMediapipeSolutionsWasm,n=window.createMediapipeSolutionsPackedAssets,y(e,t(n),2);r.h=e.h,e.g=0}))}))})),f=Re(n,(function e(){var t=this;return T(e,(function(e){return t.g.graph&&t.g.graph.url?e=y(e,Be(t,t.g.graph.url),0):(e.g=0,e=void 0),e}))})),y(t,e.all([l,d,f]),7);if("function"!=typeof importScripts)throw Error("solutions can only be loaded on a web page or in a web worker");return o=r.filter((function(e){return void 0===e.simd||e.simd&&i||!e.simd&&!i})).map((function(e){return n.locateFile(e.url,n.S)})),importScripts.apply(null,c(o)),y(t,createMediapipeSolutionsWasm(Module),6);case 6:h.h=t.h,h.l=new OffscreenCanvas(1,1),h.h.canvas=h.l,a=h.h.GL.createContext(h.l,{antialias:!1,alpha:!1,ba:typeof WebGL2RenderingContext<"u"?2:1}),h.h.GL.makeContextCurrent(a),t.g=4;break;case 7:if(h.l=document.createElement("canvas"),!(p=h.l.getContext("webgl2",{}))&&!(p=h.l.getContext("webgl",{})))return alert("Failed to create WebGL canvas context when passing video frame."),t.return();h.D=p,h.h.canvas=h.l,h.h.createContext(h.l,!0,!0,{});case 4:h.i=new h.h.SolutionWasm,h.R=!1,t.g=0}}))}))}function Be(e,t){return Re(e,(function e(){var n,r,i=this;return T(e,(function(e){return t in i.F?e.return(i.F[t]):(n=i.locateFile(t,""),r=fetch(n).then((function(e){return e.arrayBuffer()})),i.F[t]=r,e.return(r))}))}))}function He(e,t,n){return Re(e,(function e(){var r,i,o,a,c,u,d,l,f,p,h,m,g,v,b=this;return T(e,(function(e){switch(e.g){case 1:if(!n)return e.return(t);for(r={},i=0,o=s(Object.keys(n)),a=o.next();!a.done;a=o.next())c=a.value,"string"!=typeof(u=n[c])&&"texture"===u.type&&void 0!==t[u.stream]&&++i;1<i&&(b.G=!1),d=s(Object.keys(n)),a=d.next();case 2:if(a.done){e.g=4;break}if(l=a.value,"string"==typeof(f=n[l]))return g=r,v=l,y(e,function(e,t,n){return Re(e,(function e(){var r,i=this;return T(e,(function(e){return"number"==typeof n||n instanceof Uint8Array||n instanceof i.h.Uint8BlobList?e.return(n):n instanceof i.h.Texture2dDataOut?((r=i.s[t])||(r=new De(i.h,i.D),i.s[t]=r),e.return(Ze(r,n,i.G))):e.return(void 0)}))}))}(b,l,t[f]),14);if(p=t[f.stream],"detection_list"===f.type){if(p){for(var S=p.getRectList(),E=p.getLandmarksList(),_=p.getClassificationsList(),R=[],I=0;I<S.size();++I){var w=S.get(I);e:{var C=new Le;for(w=new z(w);K(w);)switch(w.i){case 13:var O=B(w.g);ge(C,1,O);break;case 21:ge(C,2,O=B(w.g));break;case 29:ge(C,3,O=B(w.g));break;case 37:ge(C,4,O=B(w.g));break;case 45:ge(C,5,O=B(w.g));break;case 48:for(var A=w.g,x=128,k=0,N=O=0;4>N&&128<=x;N++)k|=(127&(x=A.h[A.g++]))<<7*N;if(128<=x&&(k|=(127&(x=A.h[A.g++]))<<28,O|=(127&x)>>4),128<=x)for(N=0;5>N&&128<=x;N++)O|=(127&(x=A.h[A.g++]))<<7*N+3;128>x?(A=k>>>0,(O=2147483648&(x=O>>>0))&&(x=~x>>>0,0==(A=1+~A>>>0)&&(x=x+1>>>0)),A=4294967296*x+(A>>>0),O=O?-A:A):(A.l=!0,O=void 0),ge(C,6,O);break;default:if(!Te(C,w))break e}}C={Z:me(C,1),$:me(C,2),height:me(C,3),width:me(C,4),rotation:me(C,5,0),X:Se(C,6)},O=E.get(I);e:for(w=new ke,O=new z(O);K(O);)switch(O.i){case 10:ye(w,A=Q(O,new Ae,xe),Ae,void 0);break;default:if(!Te(w,O))break e}w=ve(w,Ae).map(Pe),A=_.get(I);e:for(O=new Ce,A=new z(A);K(A);)switch(A.i){case 10:O.addClassification(Q(A,new Ie,we));break;default:if(!Te(O,A))break e}C={T:C,O:w,M:Ve(O)},R.push(C)}S=R}else S=[];r[l]=S,e.g=7;break}if("proto_list"===f.type){if(p){for(S=Array(p.size()),E=0;E<p.size();E++)S[E]=p.get(E);p.delete()}else S=[];r[l]=S,e.g=7;break}if(void 0===p){e.g=3;break}if("float_list"===f.type){r[l]=p,e.g=7;break}if("proto"===f.type){r[l]=p,e.g=7;break}if("texture"!==f.type)throw Error("Unknown output config type: '"+f.type+"'");return(h=b.s[l])||(h=new De(b.h,b.D),b.s[l]=h),y(e,Ze(h,p,b.G),13);case 13:m=e.h,r[l]=m;case 7:f.transform&&r[l]&&(r[l]=f.transform(r[l])),e.g=3;break;case 14:g[v]=e.h;case 3:a=d.next(),e.g=2;break;case 4:return e.return(r)}}))}))}function Ye(e,t){for(var n=t.name||"$",r=[].concat(c(t.wants)),i=new e.h.StringList,o=s(t.wants),a=o.next();!a.done;a=o.next())i.push_back(a.value);o=e.h.PacketListener.implement({onResults:function(i){for(var o={},a=0;a<t.wants.length;++a)o[r[a]]=i.get(a);var s=e.listeners[n];s&&(e.C=He(e,o,t.outs).then((function(n){n=s(n);for(var i=0;i<t.wants.length;++i){var a=o[r[i]];"object"==typeof a&&a.hasOwnProperty&&a.hasOwnProperty("delete")&&a.delete()}n&&(e.C=n)})))}}),e.i.attachMultiListener(i,o),i.delete()}function Je(e){switch(void 0===e&&(e=0),e){case 1:return"selfie_segmentation_landscape.tflite";default:return"selfie_segmentation.tflite"}}function ze(e){var t=this;e=e||{},this.g=new Ue({locateFile:e.locateFile,files:function(e){return[{simd:!0,url:"selfie_segmentation_solution_simd_wasm_bin.js"},{simd:!1,url:"selfie_segmentation_solution_wasm_bin.js"},{data:!0,url:Je(e.modelSelection)}]},graph:{url:"selfie_segmentation.binarypb"},listeners:[{wants:["segmentation_mask","image_transformed"],outs:{image:{type:"texture",stream:"image_transformed"},segmentationMask:{type:"texture",stream:"segmentation_mask"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},modelSelection:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelSelection",fieldName:"int_value"},onChange:function(e){return Re(t,(function t(){var n,r,i,o=this;return T(t,(function(t){return 1==t.g?(n=Je(e),r="third_party/mediapipe/modules/selfie_segmentation/"+n,y(t,Be(o.g,n),2)):(i=t.h,o.g.overrideFile(r,i),t.return(!0))}))}))}}}})}(t=Ue.prototype).close=function(){return this.i&&this.i.delete(),e.resolve()},t.reset=function(){return Re(this,(function e(){var t=this;return T(e,(function(e){t.i&&(t.i.reset(),t.m={},t.s={}),e.g=0}))}))},t.setOptions=function(e,t){var n=this;if(t=t||this.g.options){for(var r=[],i=[],o={},a=s(Object.keys(e)),c=a.next();!c.done;o={K:o.K,L:o.L},c=a.next()){var u=c.value;u in this.j&&this.j[u]===e[u]||(this.j[u]=e[u],void 0!==(c=t[u])&&(c.onChange&&(o.K=c.onChange,o.L=e[u],r.push(function(e){return function(){return Re(n,(function t(){var n=this;return T(t,(function(t){if(1==t.g)return y(t,e.K(e.L),2);!0===t.h&&(n.o=!0),t.g=0}))}))}}(o))),c.graphOptionXref&&(u={valueNumber:1===c.type?e[u]:0,valueBoolean:0===c.type&&e[u],valueString:2===c.type?e[u]:""},c=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),c.graphOptionXref),u),i.push(c))))}(0!==r.length||0!==i.length)&&(this.o=!0,this.A=(void 0===this.A?[]:this.A).concat(i),this.u=(void 0===this.u?[]:this.u).concat(r))}},t.initialize=function(){return Re(this,(function e(){var t=this;return T(e,(function(e){return 1==e.g?y(e,Xe(t),2):3!=e.g?y(e,function(e){return Re(e,(function e(){var t,n,r,i,o,a,c,u,d=this;return T(e,(function(e){if(1==e.g)return d.g.graph&&d.g.graph.url&&d.P===d.g.graph.url?e.return():(d.o=!0,d.g.graph&&d.g.graph.url?(d.P=d.g.graph.url,y(e,Be(d,d.g.graph.url),3)):void(e.g=2));for(2!=e.g&&(t=e.h,d.i.loadGraph(t)),n=s(Object.keys(d.B)),r=n.next();!r.done;r=n.next())i=r.value,d.i.overrideFile(i,d.B[i]);if(d.B={},d.g.listeners)for(o=s(d.g.listeners),a=o.next();!a.done;a=o.next())c=a.value,Ye(d,c);u=d.j,d.j={},d.setOptions(u),e.g=0}))}))}(t),3):y(e,function(e){return Re(e,(function e(){var t,n,r,i,o,a,c=this;return T(e,(function(e){switch(e.g){case 1:if(!c.o)return e.return();if(!c.u){e.g=2;break}t=s(c.u),n=t.next();case 3:if(n.done){e.g=5;break}return y(e,(0,n.value)(),4);case 4:n=t.next(),e.g=3;break;case 5:c.u=void 0;case 2:if(c.A){for(r=new c.h.GraphOptionChangeRequestList,i=s(c.A),o=i.next();!o.done;o=i.next())a=o.value,r.push_back(a);c.i.changeOptions(r),r.delete(),c.A=void 0}c.o=!1,e.g=0}}))}))}(t),0)}))}))},t.overrideFile=function(e,t){this.i?this.i.overrideFile(e,t):this.B[e]=t},t.clearOverriddenFiles=function(){this.B={},this.i&&this.i.clearOverriddenFiles()},t.send=function(e,t){return Re(this,(function n(){var r,i,o,a,c,u,d,l,f,p=this;return T(n,(function(n){switch(n.g){case 1:return p.g.inputs?(r=1e3*(null==t?performance.now():t),y(n,p.C,2)):n.return();case 2:return y(n,p.initialize(),3);case 3:for(i=new p.h.PacketDataList,o=s(Object.keys(e)),a=o.next();!a.done;a=o.next())if(c=a.value,u=p.g.inputs[c]){e:{var h=p,m=e[c];switch(u.type){case"video":var g=h.m[u.stream];if(g||(g=new De(h.h,h.D),h.m[u.stream]=g),0===(h=g).l&&(h.l=h.h.createTexture()),typeof HTMLVideoElement<"u"&&m instanceof HTMLVideoElement){var v=m.videoWidth;g=m.videoHeight}else typeof HTMLImageElement<"u"&&m instanceof HTMLImageElement?(v=m.naturalWidth,g=m.naturalHeight):(v=m.width,g=m.height);g={glName:h.l,width:v,height:g},(v=h.g).canvas.width=g.width,v.canvas.height=g.height,v.activeTexture(v.TEXTURE0),h.h.bindTexture2d(h.l),v.texImage2D(v.TEXTURE_2D,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,m),h.h.bindTexture2d(0),h=g;break e;case"detections":for((g=h.m[u.stream])||(g=new je(h.h),h.m[u.stream]=g),(h=g).data||(h.data=new h.g.DetectionListData),h.data.reset(m.length),g=0;g<m.length;++g){v=m[g];var b=h.data,S=b.setBoundingBox,E=g,_=v.T,T=new Le;ge(T,1,_.Z),ge(T,2,_.$),ge(T,3,_.height),ge(T,4,_.width),ge(T,5,_.rotation),ge(T,6,_.X);var R=_=new $;ne(R,1,pe(T,1)),ne(R,2,pe(T,2)),ne(R,3,pe(T,3)),ne(R,4,pe(T,4)),ne(R,5,pe(T,5));var I=pe(T,6);if(null!=I&&null!=I){J(R.g,48);var w=R.g,C=I;I=0>C;var O=(C=Math.abs(C))>>>0;for(C=Math.floor((C-O)/4294967296),C>>>=0,I&&(C=~C>>>0,4294967295<(O=1+(~O>>>0))&&(O=0,4294967295<++C&&(C=0))),I=G=O,O=C;0<O||127<I;)w.push(127&I|128),I=(I>>>7|O<<25)>>>0,O>>>=7;w.push(I)}if(_e(T,R),_=te(_),S.call(b,E,_),v.O)for(b=0;b<v.O.length;++b)R=!!(T=v.O[b]).visibility,E=(S=h.data).addNormalizedLandmark,_=g,T=Object.assign(Object.assign({},T),{visibility:R?T.visibility:0}),ge(R=new Ae,1,T.x),ge(R,2,T.y),ge(R,3,T.z),T.visibility&&ge(R,4,T.visibility),ne(w=T=new $,1,pe(R,1)),ne(w,2,pe(R,2)),ne(w,3,pe(R,3)),ne(w,4,pe(R,4)),ne(w,5,pe(R,5)),_e(R,w),T=te(T),E.call(S,_,T);if(v.M)for(b=0;b<v.M.length;++b){if(E=(S=h.data).addClassification,_=g,T=v.M[b],ge(R=new Ie,2,T.Y),T.index&&ge(R,1,T.index),T.label&&ge(R,3,T.label),T.displayName&&ge(R,4,T.displayName),w=T=new $,null!=(O=pe(R,1))&&null!=O)if(J(w.g,8),I=w.g,0<=O)J(I,O);else{for(C=0;9>C;C++)I.push(127&O|128),O>>=7;I.push(1)}ne(w,2,pe(R,2)),null!=(I=pe(R,3))&&(I=N(I),J(w.g,26),J(w.g,I.length),ee(w,w.g.end()),ee(w,I)),null!=(I=pe(R,4))&&(I=N(I),J(w.g,34),J(w.g,I.length),ee(w,w.g.end()),ee(w,I)),_e(R,w),T=te(T),E.call(S,_,T)}}h=h.data;break e;default:h={}}}switch(d=h,l=u.stream,u.type){case"video":i.pushTexture2d(Object.assign(Object.assign({},d),{stream:l,timestamp:r}));break;case"detections":(f=d).stream=l,f.timestamp=r,i.pushDetectionList(f);break;default:throw Error("Unknown input config type: '"+u.type+"'")}}return p.i.send(i),y(n,p.C,4);case 4:i.delete(),n.g=0}}))}))},t.onResults=function(e,t){this.listeners[t||"$"]=e},w("Solution",Ue),w("OptionType",{BOOL:0,NUMBER:1,aa:2,0:"BOOL",1:"NUMBER",2:"STRING"}),(t=ze.prototype).close=function(){return this.g.close(),e.resolve()},t.onResults=function(e){this.g.onResults(e)},t.initialize=function(){return Re(this,(function e(){var t=this;return T(e,(function(e){return y(e,t.g.initialize(),0)}))}))},t.reset=function(){this.g.reset()},t.send=function(e){return Re(this,(function t(){var n=this;return T(t,(function(t){return y(t,n.g.send(e),0)}))}))},t.setOptions=function(e){this.g.setOptions(e)},w("SelfieSegmentation",ze),w("VERSION","0.1.1632777926")}).call(Ee);const _e={};(function(){var t;function n(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var r="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},i=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof(void 0!==typeof window?window:global)&&(void 0!==typeof window?window:global)];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function o(e,t){if(t)e:{var n=i;e=e.split(".");for(var o=0;o<e.length-1;o++){var a=e[o];if(!(a in n))break e;n=n[a]}(t=t(o=n[e=e[e.length-1]]))!=o&&null!=t&&r(n,e,{configurable:!0,writable:!0,value:t})}}function a(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function s(e){var t=typeof Symbol<"u"&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:n(e)}}function c(e){if(!(e instanceof Array)){e=s(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}o("Symbol",(function(e){function t(e,t){this.g=e,r(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.g};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",i=0;return function e(r){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(r||"")+"_"+i++,r)}})),o("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),o=0;o<t.length;o++){var s=i[t[o]];"function"==typeof s&&"function"!=typeof s.prototype[e]&&r(s.prototype,e,{configurable:!0,writable:!0,value:function(){return a(n(this))}})}return e}));var u,d="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)u=Object.setPrototypeOf;else{var l;e:{var f={};try{f.__proto__={a:!0},l=f.a;break e}catch{}l=!1}u=l?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var p=u;function h(e,t){if(e.prototype=d(t.prototype),e.prototype.constructor=e,p)p(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var r=Object.getOwnPropertyDescriptor(t,n);r&&Object.defineProperty(e,n,r)}else e[n]=t[n];e.ra=t.prototype}function m(){this.l=!1,this.i=null,this.h=void 0,this.g=1,this.u=this.o=0,this.j=null}function g(e){if(e.l)throw new TypeError("Generator is already running");e.l=!0}function v(e,t){e.j={fa:t,ga:!0},e.g=e.o||e.u}function y(e,t,n){return e.g=n,{value:t}}function b(e){this.g=new m,this.h=e}function S(e,t,n,r){try{var i=t.call(e.g.i,n);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return e.g.l=!1,i;var o=i.value}catch(t){return e.g.i=null,v(e.g,t),E(e)}return e.g.i=null,r.call(e.g,o),E(e)}function E(e){for(;e.g.g;)try{var t=e.h(e.g);if(t)return e.g.l=!1,{value:t.value,done:!1}}catch(t){e.g.h=void 0,v(e.g,t)}if(e.g.l=!1,e.g.j){if(t=e.g.j,e.g.j=null,t.ga)throw t.fa;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function _(e){this.next=function(t){return g(e.g),e.g.i?t=S(e,e.g.i.next,t,e.g.s):(e.g.s(t),t=E(e)),t},this.throw=function(t){return g(e.g),e.g.i?t=S(e,e.g.i.throw,t,e.g.s):(v(e.g,t),t=E(e)),t},this.return=function(t){return function(e,t){g(e.g);var n=e.g.i;return n?S(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),E(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function T(t){return function(t){function n(e){return t.next(e)}function r(e){return t.throw(e)}return new e((function(i,o){!function t(a){a.done?i(a.value):e.resolve(a.value).then(n,r).then(t,o)}(t.next())}))}(new _(new b(t)))}m.prototype.s=function(e){this.h=e},m.prototype.return=function(e){this.j={return:e},this.g=this.u},o("Promise",(function(e){function t(e){this.h=0,this.i=void 0,this.g=[],this.s=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function n(){this.g=null}function r(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;n.prototype.h=function(e){if(null==this.g){this.g=[];var t=this;this.i((function(){t.l()}))}this.g.push(e)};var o=i.setTimeout;n.prototype.i=function(e){o(e,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.j(e)}}}this.g=null},n.prototype.j=function(e){this.i((function(){throw e}))},t.prototype.j=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.D),reject:e(this.l)}},t.prototype.D=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.H(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.A(e):this.o(e)}},t.prototype.A=function(e){var t=void 0;try{t=e.then}catch(e){return void this.l(e)}"function"==typeof t?this.I(t,e):this.o(e)},t.prototype.l=function(e){this.u(2,e)},t.prototype.o=function(e){this.u(1,e)},t.prototype.u=function(e,t){if(0!=this.h)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.h);this.h=e,this.i=t,2===this.h&&this.G(),this.B()},t.prototype.G=function(){var e=this;o((function(){if(e.C()){var t=i.console;typeof t<"u"&&t.error(e.i)}}),1)},t.prototype.C=function(){if(this.s)return!1;var e=i.CustomEvent,t=i.Event,n=i.dispatchEvent;return typeof n>"u"||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=i.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.i,n(e))},t.prototype.B=function(){if(null!=this.g){for(var e=0;e<this.g.length;++e)a.h(this.g[e]);this.g=null}};var a=new n;return t.prototype.H=function(e){var t=this.j();e.M(t.resolve,t.reject)},t.prototype.I=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(e){o(e)}}:t}var i,o,a=new t((function(e,t){i=e,o=t}));return this.M(r(e,i),r(n,o)),a},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.M=function(e,t){function n(){switch(r.h){case 1:e(r.i);break;case 2:t(r.i);break;default:throw Error("Unexpected state: "+r.h)}}var r=this;null==this.g?a.h(n):this.g.push(n),this.s=!0},t.resolve=r,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var i=s(e),o=i.next();!o.done;o=i.next())r(o.value).M(t,n)}))},t.all=function(e){var n=s(e),i=n.next();return i.done?r([]):new t((function(e,t){function o(t){return function(n){a[t]=n,0==--s&&e(a)}}var a=[],s=0;do{a.push(void 0),s++,r(i.value).M(o(a.length-1),t),i=n.next()}while(!i.done)}))},t}));var R="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e};o("Object.assign",(function(e){return e||R})),o("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}})),o("Array.prototype.includes",(function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var r=n.length;for(0>(t=t||0)&&(t=Math.max(t+r,0));t<r;t++){var i=n[t];if(i===e||Object.is(i,e))return!0}return!1}})),o("String.prototype.includes",(function(e){return e||function(e,t){if(null==this)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return-1!==this.indexOf(e,t||0)}})),o("Array.prototype.keys",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,(function(e){return e}))}}));var I=this||self;function w(e,t){e=e.split(".");var n,r=I;e[0]in r||typeof r.execScript>"u"||r.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)e.length||void 0===t?r=r[n]&&r[n]!==Object.prototype[n]?r[n]:r[n]={}:r[n]=t}function C(){throw Error("Invalid UTF8")}function O(e,t){return t=String.fromCharCode.apply(null,t),null==e?t:e+t}var A,x,k=typeof TextDecoder<"u",N=typeof TextEncoder<"u",L={},M=null;function V(e){var t;void 0===t&&(t=0),D(),t=L[t];for(var n=Array(Math.floor(e.length/3)),r=t[64]||"",i=0,o=0;i<e.length-2;i+=3){var a=e[i],s=e[i+1],c=e[i+2],u=t[a>>2];a=t[(3&a)<<4|s>>4],s=t[(15&s)<<2|c>>6],c=t[63&c],n[o++]=u+a+s+c}switch(u=0,c=r,e.length-i){case 2:c=t[(15&(u=e[i+1]))<<2]||r;case 1:e=e[i],n[o]=t[e>>2]+t[(3&e)<<4|u>>4]+c+r}return n.join("")}function P(e){var t=e.length,n=3*t/4;n%3?n=Math.floor(n):-1!="=.".indexOf(e[t-1])&&(n=-1!="=.".indexOf(e[t-2])?n-2:n-1);var r=new Uint8Array(n),i=0;return function(e,t){function n(t){for(;r<e.length;){var n=e.charAt(r++),i=M[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return t}D();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;t(i<<2|o>>4),64!=a&&(t(o<<4&240|a>>2),64!=s&&t(a<<6&192|s))}}(e,(function(e){r[i++]=e})),i!==n?r.subarray(0,i):r}function D(){if(!M){M={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++){var r=e.concat(t[n].split(""));L[n]=r;for(var i=0;i<r.length;i++){var o=r[i];void 0===M[o]&&(M[o]=i)}}}}var Z,j="function"==typeof Uint8Array;function W(e){return j&&null!=e&&e instanceof Uint8Array}function G(e){if(this.L=e,null!==e&&0===e.length)throw Error("ByteString should be constructed with non-empty values")}var F="function"==typeof Uint8Array.prototype.slice,U=0;function X(e,t){return Error("Invalid wire type: "+e+" (at position "+t+")")}function B(){return Error("Failed to read varint, encoding is invalid.")}function H(e,t){t=void 0!==(t=void 0===t?{}:t).v&&t.v,this.h=null,this.g=this.i=this.j=0,this.v=t,e&&Y(this,e)}function Y(e,t){e.h=function(e,t){if(e.constructor===Uint8Array)return e;if(e.constructor===ArrayBuffer)return new Uint8Array(e);if(e.constructor===Array)return new Uint8Array(e);if(e.constructor===String)return P(e);if(e.constructor===G)return!t&&(t=e.L)&&t.constructor===Uint8Array?t:(t=null==(t=e.L)||W(t)?t:"string"==typeof t?P(t):null,(e=e.L=t)?new Uint8Array(e):Z||(Z=new Uint8Array(0)));if(e instanceof Uint8Array)return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, or Array of numbers")}(t,e.v),e.j=0,e.i=e.h.length,e.g=e.j}function J(e){if(e.g>e.i)throw Error("Tried to read past the end of the data "+e.g+" > "+e.i)}function z(e){var t=e.h,n=t[e.g],r=127&n;if(128>n)return e.g+=1,J(e),r;if(r|=(127&(n=t[e.g+1]))<<7,128>n)return e.g+=2,J(e),r;if(r|=(127&(n=t[e.g+2]))<<14,128>n)return e.g+=3,J(e),r;if(r|=(127&(n=t[e.g+3]))<<21,128>n)return e.g+=4,J(e),r;if(n=t[e.g+4],e.g+=5,r|=(15&n)<<28,128>n)return J(e),r;if(128<=t[e.g++]&&128<=t[e.g++]&&128<=t[e.g++]&&128<=t[e.g++]&&128<=t[e.g++])throw B();return J(e),r}H.prototype.reset=function(){this.g=this.j};var K=[];function Q(){this.g=[]}function q(e,t){for(;127<t;)e.g.push(127&t|128),t>>>=7;e.g.push(t)}function $(e){var t={},n=void 0!==t.W&&t.W;this.l={v:void 0!==t.v&&t.v},this.W=n,t=this.l,K.length?(n=K.pop(),t&&(n.v=t.v),e&&Y(n,e),e=n):e=new H(e,t),this.g=e,this.j=this.g.g,this.h=this.i=-1}function ee(e){var t=e.g;if(t.g==t.i)return!1;e.j=e.g.g;var n=z(e.g)>>>0;if(t=n>>>3,!(0<=(n&=7)&&5>=n))throw X(n,e.j);if(1>t)throw Error("Invalid field number: "+t+" (at position "+e.j+")");return e.i=t,e.h=n,!0}function te(e){switch(e.h){case 0:if(0!=e.h)te(e);else e:{for(var t=(e=e.g).g,n=t+10;t<n;)if(0==(128&e.h[t++])){e.g=t,J(e);break e}throw B()}break;case 1:(e=e.g).g+=8,J(e);break;case 2:2!=e.h?te(e):(t=z(e.g)>>>0,(e=e.g).g+=t,J(e));break;case 5:(e=e.g).g+=4,J(e);break;case 3:for(t=e.i;;){if(!ee(e))throw Error("Unmatched start-group tag: stream EOF");if(4==e.h){if(e.i!=t)throw Error("Unmatched end-group tag");break}te(e)}break;default:throw X(e.h,e.j)}}Q.prototype.length=function(){return this.g.length},Q.prototype.end=function(){var e=this.g;return this.g=[],e},$.prototype.reset=function(){this.g.reset(),this.j=this.g.g,this.h=this.i=-1};var ne=[];function re(){this.i=[],this.h=0,this.g=new Q}function ie(e,t){0!==t.length&&(e.i.push(t),e.h+=t.length)}var oe="function"==typeof Symbol&&"symbol"==typeof Symbol()?Symbol(void 0):void 0;function ae(e,t){Object.isFrozen(e)||(oe?e[oe]|=t:void 0!==e.N?e.N|=t:Object.defineProperties(e,{N:{value:t,configurable:!0,writable:!0,enumerable:!1}}))}function se(e){var t;return null==(t=oe?e[oe]:e.N)?0:t}function ce(e){return ae(e,1),e}function ue(e){return!!Array.isArray(e)&&!!(2&se(e))}function de(e){if(!Array.isArray(e))throw Error("cannot mark non-array as immutable");ae(e,2)}function le(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)&&e.constructor===Object}var fe=Object.freeze(ce([]));function pe(e){if(ue(e.m))throw Error("Cannot mutate an immutable Message")}var he,me=typeof Symbol<"u"&&typeof Symbol.hasInstance<"u";function ge(e){return{value:e,configurable:!1,writable:!1,enumerable:!1}}function ve(e,t,n){return-1===t?null:t>=e.i?e.g?e.g[t]:void 0:void 0!==n&&n&&e.g&&null!=(n=e.g[t])?n:e.m[t+e.h]}function ye(e,t,n,r){r=void 0!==r&&r,pe(e),t<e.i&&!r?e.m[t+e.h]=n:(e.g||(e.g=e.m[e.i+e.h]={}))[t]=n}function be(e,t,n,r){n=void 0===n||n;var i=ve(e,t,r=void 0!==r&&r);return null==i&&(i=fe),ue(e.m)?n&&(de(i),Object.freeze(i)):(i===fe||ue(i))&&ye(e,t,i=ce(i.slice()),r),i}function Se(e,t,n){return null==(e=null==(e=ve(e,t))?e:+e)?void 0===n?0:n:e}function Ee(e,t,n,r){e.j||(e.j={});var i=ue(e.m),o=e.j[n];if(!o){r=be(e,n,!0,void 0!==r&&r),o=[],i=i||ue(r);for(var a=0;a<r.length;a++)o[a]=new t(r[a]),i&&de(o[a].m);i&&(de(o),Object.freeze(o)),e.j[n]=o}return o}function _e(e,t,n,r,i){var o=void 0!==o&&o;return pe(e),o=Ee(e,n,t,o),n=r||new n,e=be(e,t),null!=i?(o.splice(i,0,n),e.splice(i,0,n.m)):(o.push(n),e.push(n.m)),n}function Te(e,t){return null==(e=ve(e,t))?0:e}function Re(e,t){return null==(e=ve(e,t))?"":e}function Ie(e){var t=Oe;return Ce(e,t=void 0===t?Ae:t)}function we(e,t){if(null!=e){if(Array.isArray(e))e=Ce(e,t);else if(le(e)){var n,r={};for(n in e)r[n]=we(e[n],t);e=r}else e=t(e);return e}}function Ce(e,t){for(var n=e.slice(),r=0;r<n.length;r++)n[r]=we(n[r],t);return Array.isArray(e)&&1&se(e)&&ce(n),n}function Oe(e){return e&&"object"==typeof e&&e.toJSON?e.toJSON():(e=function(e){switch(typeof e){case"number":return isFinite(e)?e:String(e);case"object":if(e&&!Array.isArray(e)){if(W(e))return V(e);if(e instanceof G){var t=e.L;return t=null==t||"string"==typeof t?t:j&&t instanceof Uint8Array?V(t):null,(e.L=t)||""}}}return e}(e),Array.isArray(e)?Ie(e):e)}function Ae(e){return W(e)?new Uint8Array(e):e}function xe(e,t,n){e||(e=he),he=null;var r=this.constructor.h;if(e||(e=r?[r]:[]),this.h=(r?0:-1)-(this.constructor.g||0),this.j=void 0,this.m=e,e=(r=this.m.length)-1,r&&le(r=this.m[e])?(this.i=e-this.h,this.g=r):void 0!==t&&-1<t?(this.i=Math.max(t,e+1-this.h),this.g=void 0):this.i=Number.MAX_VALUE,n)for(t=0;t<n.length;t++)if((e=n[t])<this.i)e+=this.h,(r=this.m[e])?Array.isArray(r)&&ce(r):this.m[e]=fe;else{var i=(r=this.g||(this.g=this.m[this.i+this.h]={}))[e];i?Array.isArray(i)&&ce(i):r[e]=fe}}function ke(){xe.apply(this,arguments)}if(xe.prototype.toJSON=function(){return Ie(this.m)},xe.prototype.toString=function(){return this.m.toString()},h(ke,xe),me){var Ne={};Object.defineProperties(ke,(Ne[Symbol.hasInstance]=ge((function(){throw Error("Cannot perform instanceof checks for MutableMessage")})),Ne))}function Le(e,t,n){if(n){var r,i={};for(r in n){var o=n[r],a=o.ja;a||(i.F=o.pa||o.ha.P,o.ba?(i.U=We(o.ba),a=function(e){return function(t,n,r){return e.F(t,n,r,e.U)}}(i)):o.da?(i.T=Ge(o.X.g,o.da),a=function(e){return function(t,n,r){return e.F(t,n,r,e.T)}}(i)):a=i.F,o.ja=a),a(t,e,o.X),i={F:i.F,U:i.U,T:i.T}}}!function(e,t){if(t=t.ca){ie(e,e.g.end());for(var n=0;n<t.length;n++)ie(e,t[n])}}(t,e)}var Me=Symbol();function Ve(e,t,n){return e[Me]||(e[Me]=function(e,r){return t(e,r,n)})}function Pe(e){var t=e[Me];if(!t){var n=$e(e);t=function(e,t){return et(e,t,n)},e[Me]=t}return t}function De(e){var t=function(e){var t=e.ba;return t?Pe(t):(t=e.oa)?Ve(e.X.g,t,e.da):void 0}(e),n=e.X,r=e.ha.O;return t?function(e,i){return r(e,i,n,t)}:function(e,t){return r(e,t,n)}}function Ze(e,t,n,r,i,o){var a=0;for((e=e()).length&&"number"!=typeof e[0]&&(n(t,e[0]),a++);a<e.length;){n=e[a++];for(var s=a+1;s<e.length&&"number"!=typeof e[s];)s++;var c=e[a++];switch(s-=a){case 0:r(t,n,c);break;case 1:r(t,n,c,e[a++]);break;case 2:i(t,n,c,e[a++],e[a++]);break;case 3:s=e[a++];var u=e[a++],d=e[a++];Array.isArray(d)?i(t,n,c,s,u,d):o(t,n,c,s,u,d);break;case 4:o(t,n,c,e[a++],e[a++],e[a++],e[a++]);break;default:throw Error("unexpected number of binary field arguments: "+s)}}return t}var je=Symbol();function We(e){var t=e[je];if(!t){var n=Ye(e);t=function(e,t){return nt(e,t,n)},e[je]=t}return t}function Ge(e,t){var n=e[je];return n||(n=function(e,n){return Le(e,n,t)},e[je]=n),n}var Fe=Symbol();function Ue(e,t){e.push(t)}function Xe(e,t,n){e.push(t,n.P)}function Be(e,t,n,r,i){var o=We(i),a=n.P;e.push(t,(function(e,t,n){return a(e,t,n,r,o)}))}function He(e,t,n,r,i,o){var a=Ge(r,o),s=n.P;e.push(t,(function(e,t,n){return s(e,t,n,r,a)}))}function Ye(e){return e[Fe]||Ze(e,e[Fe]=[],Ue,Xe,Be,He)}var Je=Symbol();function ze(e,t){e[0]=t}function Ke(e,t,n,r){var i=n.O;e[t]=r?function(e,t,n){return i(e,t,n,r)}:i}function Qe(e,t,n,r,i,o){var a=n.O,s=Pe(i);e[t]=function(e,t,n){return a(e,t,n,r,s,o)}}function qe(e,t,n,r,i,o,a){var s=n.O,c=Ve(r,i,o);e[t]=function(e,t,n){return s(e,t,n,r,c,a)}}function $e(e){return e[Je]||Ze(e,e[Je]={},ze,Ke,Qe,qe)}function et(e,t,n){for(;ee(t)&&4!=t.h;){var r=t.i,i=n[r];if(!i){var o=n[0];o&&(o=o[r])&&(i=n[r]=De(o))}if(!(i&&i(t,e,r)||(i=t,r=e,o=i.j,te(i),i.W))){var a=i.g.h;i=o===(i=i.g.g)?Z||(Z=new Uint8Array(0)):F?a.slice(o,i):new Uint8Array(a.subarray(o,i)),(o=r.ca)?o.push(i):r.ca=[i]}}return e}function tt(e,t,n){if(ne.length){var r=ne.pop();e&&(Y(r.g,e),r.i=-1,r.h=-1),e=r}else e=new $(e);try{return et(new t,e,$e(n))}finally{(t=e.g).h=null,t.j=0,t.i=0,t.g=0,t.v=!1,e.i=-1,e.h=-1,100>ne.length&&ne.push(e)}}function nt(e,t,n){for(var r=n.length,i=r%2==1,o=i?1:0;o<r;o+=2)(0,n[o+1])(t,e,n[o]);Le(e,t,i?n[0]:void 0)}function rt(e,t){var n=new re;nt(e,n,Ye(t)),ie(n,n.g.end()),e=new Uint8Array(n.h);for(var r=(t=n.i).length,i=0,o=0;o<r;o++){var a=t[o];e.set(a,i),i+=a.length}return n.i=[e],e}function it(e,t){return{O:e,P:t}}var ot=it((function(e,t,n){if(5!==e.h)return!1;var r=(e=e.g).h[e.g],i=e.h[e.g+1],o=e.h[e.g+2],a=e.h[e.g+3];return e.g+=4,J(e),e=2*((i=(r<<0|i<<8|o<<16|a<<24)>>>0)>>31)+1,r=i>>>23&255,i&=8388607,ye(t,n,255==r?i?NaN:1/0*e:0==r?e*Math.pow(2,-149)*i:e*Math.pow(2,r-150)*(i+Math.pow(2,23))),!0}),(function(e,t,n){if(null!=(t=ve(t,n))){q(e.g,8*n+5),e=e.g;var r=t;0===(r=(n=0>r?1:0)?-r:r)?U=0<1/r?0:2147483648:isNaN(r)?U=2147483647:34028234663852886e22<r?U=(n<<31|2139095040)>>>0:11754943508222875e-54>r?(r=Math.round(r/Math.pow(2,-149)),U=(n<<31|r)>>>0):(t=Math.floor(Math.log(r)/Math.LN2),r*=Math.pow(2,-t),16777216<=(r=Math.round(8388608*r))&&++t,U=(n<<31|t+127<<23|8388607&r)>>>0),n=U,e.g.push(n>>>0&255),e.g.push(n>>>8&255),e.g.push(n>>>16&255),e.g.push(n>>>24&255)}})),at=it((function(e,t,n){if(0!==e.h)return!1;for(var r=e.g,i=128,o=0,a=e=0;4>a&&128<=i;a++)i=r.h[r.g++],J(r),o|=(127&i)<<7*a;if(128<=i&&(i=r.h[r.g++],J(r),o|=(127&i)<<28,e|=(127&i)>>4),128<=i)for(a=0;5>a&&128<=i;a++)i=r.h[r.g++],J(r),e|=(127&i)<<7*a+3;if(!(128>i))throw B();return r=o>>>0,(e=2147483648&(i=e>>>0))&&(i=~i>>>0,0==(r=1+~r>>>0)&&(i=i+1>>>0)),r=4294967296*i+(r>>>0),ye(t,n,e?-r:r),!0}),(function(e,t,n){if(null!=(t=ve(t,n))&&null!=t){q(e.g,8*n),e=e.g;var r=t;for(n=0>r,t=(r=Math.abs(r))>>>0,r=Math.floor((r-t)/4294967296),r>>>=0,n&&(r=~r>>>0,4294967295<(t=1+(~t>>>0))&&(t=0,4294967295<++r&&(r=0))),n=U=t,t=r;0<t||127<n;)e.g.push(127&n|128),n=(n>>>7|t<<25)>>>0,t>>>=7;e.g.push(n)}})),st=it((function(e,t,n){return 0===e.h&&(ye(t,n,z(e.g)),!0)}),(function(e,t,n){if(null!=(t=ve(t,n))&&null!=t)if(q(e.g,8*n),e=e.g,0<=(n=t))q(e,n);else{for(t=0;9>t;t++)e.g.push(127&n|128),n>>=7;e.g.push(1)}})),ct=it((function(e,t,n){if(2!==e.h)return!1;var r,i=z(e.g)>>>0,o=(e=e.g).g;if(e.g+=i,J(e),e=e.h,k)(r=A)||(r=A=new TextDecoder("utf-8",{fatal:!0})),r=r.decode(e.subarray(o,o+i));else{i=o+i;for(var a,s,c,u=[],d=null;o<i;)128>(a=e[o++])?u.push(a):224>a?o>=i?C():(s=e[o++],194>a||128!=(192&s)?(o--,C()):u.push((31&a)<<6|63&s)):240>a?o>=i-1?C():128!=(192&(s=e[o++]))||224===a&&160>s||237===a&&160<=s||128!=(192&(r=e[o++]))?(o--,C()):u.push((15&a)<<12|(63&s)<<6|63&r):244>=a?o>=i-2?C():128!=(192&(s=e[o++]))||s-144+(a<<28)>>30!=0||128!=(192&(r=e[o++]))||128!=(192&(c=e[o++]))?(o--,C()):(a=(7&a)<<18|(63&s)<<12|(63&r)<<6|63&c,a-=65536,u.push(55296+(a>>10&1023),56320+(1023&a))):C(),8192<=u.length&&(d=O(d,u),u.length=0);r=O(d,u)}return ye(t,n,r),!0}),(function(e,t,n){if(null!=(t=ve(t,n))){var r=!1;if(r=void 0!==r&&r,N){if(r&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(t))throw Error("Found an unpaired surrogate");t=(x||(x=new TextEncoder)).encode(t)}else{for(var i=0,o=new Uint8Array(3*t.length),a=0;a<t.length;a++){var s=t.charCodeAt(a);if(128>s)o[i++]=s;else{if(2048>s)o[i++]=s>>6|192;else{if(55296<=s&&57343>=s){if(56319>=s&&a<t.length){var c=t.charCodeAt(++a);if(56320<=c&&57343>=c){s=1024*(s-55296)+c-56320+65536,o[i++]=s>>18|240,o[i++]=s>>12&63|128,o[i++]=s>>6&63|128,o[i++]=63&s|128;continue}a--}if(r)throw Error("Found an unpaired surrogate");s=65533}o[i++]=s>>12|224,o[i++]=s>>6&63|128}o[i++]=63&s|128}}t=o.subarray(0,i)}q(e.g,8*n+2),q(e.g,t.length),ie(e,e.g.end()),ie(e,t)}})),ut=it((function(e,t,n,r,i){if(2!==e.h)return!1;t=_e(t,n,r),n=e.g.i,r=z(e.g)>>>0;var o=e.g.g+r,a=o-n;if(0>=a&&(e.g.i=o,i(t,e),a=o-e.g.g),a)throw Error("Message parsing ended unexpectedly. Expected to read "+r+" bytes, instead read "+(r-a)+" bytes, either the data ended unexpectedly or the message misreported its own length");return e.g.g=o,e.g.i=n,!0}),(function(e,t,n,r,i){if(null!=(t=Ee(t,r,n)))for(r=0;r<t.length;r++){var o=e;q(o.g,8*n+2);var a=o.g.end();ie(o,a),a.push(o.h),o=a,i(t[r],e),a=e;var s=o.pop();for(s=a.h+a.g.length()-s;127<s;)o.push(127&s|128),s>>>=7,a.h++;o.push(s),a.h++}}));function dt(){ke.apply(this,arguments)}if(h(dt,ke),me){var lt={};Object.defineProperties(dt,(lt[Symbol.hasInstance]=ge(Object[Symbol.hasInstance]),lt))}function ft(e){dt.call(this,e)}function pt(){return[1,st,2,ot,3,ct,4,ct]}function ht(e){dt.call(this,e,-1,gt)}function mt(){return[1,ut,ft,pt]}h(ft,dt),h(ht,dt),ht.prototype.addClassification=function(e,t){return _e(this,1,ft,e,t),this};var gt=[1];function vt(e){dt.call(this,e)}function yt(){return[1,ot,2,ot,3,ot,4,ot,5,ot]}function bt(e){dt.call(this,e,-1,Et)}function St(){return[1,ut,vt,yt]}h(vt,dt),h(bt,dt);var Et=[1];function _t(e){dt.call(this,e)}function Tt(){return[1,ot,2,ot,3,ot,4,ot,5,ot,6,at]}function Rt(e,t,n){if(n=e.createShader(0===n?e.VERTEX_SHADER:e.FRAGMENT_SHADER),e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw Error("Could not compile WebGL shader.\n\n"+e.getShaderInfoLog(n));return n}function It(e){return Ee(e,ft,1).map((function(e){return{index:Te(e,1),score:Se(e,2),label:null!=ve(e,3)?Re(e,3):void 0,displayName:null!=ve(e,4)?Re(e,4):void 0}}))}function wt(e){return{x:Se(e,1),y:Se(e,2),z:Se(e,3),visibility:null!=ve(e,4)?Se(e,4):void 0}}function Ct(e){return e.map((function(e){return Ee(tt(e,bt,St),vt,1).map(wt)}))}function Ot(e,t){this.h=e,this.g=t,this.l=0}function At(t,n,r){return function(e,t){var n=e.g;if(void 0===e.o){var r=Rt(n,"\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }",0),i=Rt(n,"\n  precision mediump float;\n  varying vec2 vTex;\n  uniform sampler2D sampler0;\n  void main(){\n    gl_FragColor = texture2D(sampler0, vTex);\n  }",1),o=n.createProgram();if(n.attachShader(o,r),n.attachShader(o,i),n.linkProgram(o),!n.getProgramParameter(o,n.LINK_STATUS))throw Error("Could not compile WebGL program.\n\n"+n.getProgramInfoLog(o));r=e.o=o,n.useProgram(r),i=n.getUniformLocation(r,"sampler0"),e.j={K:n.getAttribLocation(r,"aVertex"),J:n.getAttribLocation(r,"aTex"),qa:i},e.u=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,e.u),n.enableVertexAttribArray(e.j.K),n.vertexAttribPointer(e.j.K,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),e.s=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,e.s),n.enableVertexAttribArray(e.j.J),n.vertexAttribPointer(e.j.J,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.uniform1i(i,0)}r=e.j,n.useProgram(e.o),n.canvas.width=t.width,n.canvas.height=t.height,n.viewport(0,0,t.width,t.height),n.activeTexture(n.TEXTURE0),e.h.bindTexture2d(t.glName),n.enableVertexAttribArray(r.K),n.bindBuffer(n.ARRAY_BUFFER,e.u),n.vertexAttribPointer(r.K,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(r.J),n.bindBuffer(n.ARRAY_BUFFER,e.s),n.vertexAttribPointer(r.J,2,n.FLOAT,!1,0,0),n.bindFramebuffer(n.DRAW_FRAMEBUFFER?n.DRAW_FRAMEBUFFER:n.FRAMEBUFFER,null),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.colorMask(!0,!0,!0,!0),n.drawArrays(n.TRIANGLE_FAN,0,4),n.disableVertexAttribArray(r.K),n.disableVertexAttribArray(r.J),n.bindBuffer(n.ARRAY_BUFFER,null),e.h.bindTexture2d(0)}(t,n),"function"==typeof t.g.canvas.transferToImageBitmap?e.resolve(t.g.canvas.transferToImageBitmap()):r?e.resolve(t.g.canvas):"function"==typeof createImageBitmap?createImageBitmap(t.g.canvas):(void 0===t.i&&(t.i=document.createElement("canvas")),new e((function(e){t.i.height=t.g.canvas.height,t.i.width=t.g.canvas.width,t.i.getContext("2d",{}).drawImage(t.g.canvas,0,0,t.g.canvas.width,t.g.canvas.height),e(t.i)})))}function xt(e){this.g=e}h(_t,dt);var kt=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function Nt(e,t){return t+e}function Lt(e,t){window[e]=t}function Mt(t){if(this.g=t,this.listeners={},this.j={},this.H={},this.o={},this.u={},this.I=this.s=this.$=!0,this.D=e.resolve(),this.Z="",this.C={},this.locateFile=t&&t.locateFile||Nt,"object"==typeof window)var n=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if(!(typeof location<"u"))throw Error("solutions can only be loaded on a web page or in a web worker");n=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}if(this.aa=n,t.options)for(var r=(n=s(Object.keys(t.options))).next();!r.done;r=n.next()){r=r.value;var i=t.options[r].default;void 0!==i&&(this.j[r]="function"==typeof i?i():i)}}function Vt(t){var n,r,i,o,a,s,u,d,l,f,p;return T((function(h){switch(h.g){case 1:return t.$?(n=void 0===t.g.files?[]:"function"==typeof t.g.files?t.g.files(t.j):t.g.files,y(h,T((function(e){switch(e.g){case 1:return e.o=2,y(e,WebAssembly.instantiate(kt),4);case 4:e.g=3,e.o=0;break;case 2:return e.o=0,e.j=null,e.return(!1);case 3:return e.return(!0)}})),2)):h.return();case 2:if(r=h.h,"object"==typeof window)return Lt("createMediapipeSolutionsWasm",{locateFile:t.locateFile}),Lt("createMediapipeSolutionsPackedAssets",{locateFile:t.locateFile}),s=n.filter((function(e){return void 0!==e.data})),u=n.filter((function(e){return void 0===e.data})),d=e.all(s.map((function(n){var r=Pt(t,n.url);if(void 0!==n.path){var i=n.path;r=r.then((function(n){return t.overrideFile(i,n),e.resolve(n)}))}return r}))),l=e.all(u.map((function(n){return void 0===n.simd||n.simd&&r||!n.simd&&!r?function(t){var n=document.createElement("script");return n.setAttribute("src",t),n.setAttribute("crossorigin","anonymous"),new e((function(e){n.addEventListener("load",(function(){e()}),!1),n.addEventListener("error",(function(){e()}),!1),document.body.appendChild(n)}))}(t.locateFile(n.url,t.aa)):e.resolve()}))).then((function(){var e,n,r;return T((function(i){if(1==i.g)return e=window.createMediapipeSolutionsWasm,n=window.createMediapipeSolutionsPackedAssets,r=t,y(i,e(n),2);r.h=i.h,i.g=0}))})),f=T((function(e){return t.g.graph&&t.g.graph.url?e=y(e,Pt(t,t.g.graph.url),0):(e.g=0,e=void 0),e})),y(h,e.all([l,d,f]),7);if("function"!=typeof importScripts)throw Error("solutions can only be loaded on a web page or in a web worker");return i=n.filter((function(e){return void 0===e.simd||e.simd&&r||!e.simd&&!r})).map((function(e){return t.locateFile(e.url,t.aa)})),importScripts.apply(null,c(i)),o=t,y(h,createMediapipeSolutionsWasm(Module),6);case 6:o.h=h.h,t.l=new OffscreenCanvas(1,1),t.h.canvas=t.l,a=t.h.GL.createContext(t.l,{antialias:!1,alpha:!1,na:typeof WebGL2RenderingContext<"u"?2:1}),t.h.GL.makeContextCurrent(a),h.g=4;break;case 7:if(t.l=document.createElement("canvas"),!(p=t.l.getContext("webgl2",{}))&&!(p=t.l.getContext("webgl",{})))return alert("Failed to create WebGL canvas context when passing video frame."),h.return();t.G=p,t.h.canvas=t.l,t.h.createContext(t.l,!0,!0,{});case 4:t.i=new t.h.SolutionWasm,t.$=!1,h.g=0}}))}function Pt(e,t){var n,r;return T((function(i){return t in e.H?i.return(e.H[t]):(n=e.locateFile(t,""),r=fetch(n).then((function(e){return e.arrayBuffer()})),e.H[t]=r,i.return(r))}))}function Dt(e,t,n){var r,i,o,a,c,u,d,l,f,p,h,m,g,v;return T((function(b){switch(b.g){case 1:if(!n)return b.return(t);for(r={},i=0,o=s(Object.keys(n)),a=o.next();!a.done;a=o.next())c=a.value,"string"!=typeof(u=n[c])&&"texture"===u.type&&void 0!==t[u.stream]&&++i;1<i&&(e.I=!1),d=s(Object.keys(n)),a=d.next();case 2:if(a.done){b.g=4;break}if(l=a.value,"string"==typeof(f=n[l]))return g=r,v=l,y(b,function(e,t,n){var r;return T((function(i){return"number"==typeof n||n instanceof Uint8Array||n instanceof e.h.Uint8BlobList?i.return(n):n instanceof e.h.Texture2dDataOut?((r=e.u[t])||(r=new Ot(e.h,e.G),e.u[t]=r),i.return(At(r,n,e.I))):i.return(void 0)}))}(e,l,t[f]),14);if(p=t[f.stream],"detection_list"===f.type){if(p){for(var S=p.getRectList(),E=p.getLandmarksList(),_=p.getClassificationsList(),R=[],I=0;I<S.size();++I){var w=tt(S.get(I),_t,Tt);w={ea:{ka:Se(w,1),la:Se(w,2),height:Se(w,3),width:Se(w,4),rotation:Se(w,5,0),ia:Te(w,6)},Y:Ee(tt(E.get(I),bt,St),vt,1).map(wt),V:It(tt(_.get(I),ht,mt))},R.push(w)}S=R}else S=[];r[l]=S,b.g=7;break}if("proto_list"===f.type){if(p){for(S=Array(p.size()),E=0;E<p.size();E++)S[E]=p.get(E);p.delete()}else S=[];r[l]=S,b.g=7;break}if(void 0===p){b.g=3;break}if("float_list"===f.type){r[l]=p,b.g=7;break}if("proto"===f.type){r[l]=p,b.g=7;break}if("texture"!==f.type)throw Error("Unknown output config type: '"+f.type+"'");return(h=e.u[l])||(h=new Ot(e.h,e.G),e.u[l]=h),y(b,At(h,p,e.I),13);case 13:m=b.h,r[l]=m;case 7:f.transform&&r[l]&&(r[l]=f.transform(r[l])),b.g=3;break;case 14:g[v]=b.h;case 3:a=d.next(),b.g=2;break;case 4:return b.return(r)}}))}function Zt(e,t){for(var n=t.name||"$",r=[].concat(c(t.wants)),i=new e.h.StringList,o=s(t.wants),a=o.next();!a.done;a=o.next())i.push_back(a.value);o=e.h.PacketListener.implement({onResults:function(i){for(var o={},a=0;a<t.wants.length;++a)o[r[a]]=i.get(a);var s=e.listeners[n];s&&(e.D=Dt(e,o,t.outs).then((function(n){n=s(n);for(var i=0;i<t.wants.length;++i){var a=o[r[i]];"object"==typeof a&&a.hasOwnProperty&&a.hasOwnProperty("delete")&&a.delete()}n&&(e.D=n)})))}}),e.i.attachMultiListener(i,o),i.delete()}function jt(e){return void 0===e&&(e=0),1===e?"hand_landmark_full.tflite":"hand_landmark_lite.tflite"}function Wt(e){var t=this;e=e||{},this.g=new Mt({locateFile:e.locateFile,files:function(e){return[{url:"hands_solution_packed_assets_loader.js"},{simd:!1,url:"hands_solution_wasm_bin.js"},{simd:!0,url:"hands_solution_simd_wasm_bin.js"},{data:!0,url:jt(e.modelComplexity)}]},graph:{url:"hands.binarypb"},inputs:{image:{type:"video",stream:"input_frames_gpu"}},listeners:[{wants:["multi_hand_landmarks","multi_hand_world_landmarks","image_transformed","multi_handedness"],outs:{image:"image_transformed",multiHandLandmarks:{type:"proto_list",stream:"multi_hand_landmarks",transform:Ct},multiHandWorldLandmarks:{type:"proto_list",stream:"multi_hand_world_landmarks",transform:Ct},multiHandedness:{type:"proto_list",stream:"multi_handedness",transform:function(e){return e.map((function(e){return It(tt(e,ht,mt))[0]}))}}}}],options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:"object"==typeof window&&void 0!==window.navigator&&("iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document)},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},maxNumHands:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculator",fieldName:"int_value"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(e){var n,r,i;return T((function(o){return 1==o.g?(n=jt(e),r="third_party/mediapipe/modules/hand_landmark/"+n,y(o,Pt(t.g,n),2)):(i=o.h,t.g.overrideFile(r,i),o.return(!0))}))}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"handlandmarktrackinggpu__palmdetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"handlandmarktrackinggpu__handlandmarkgpu__ThresholdingCalculator",fieldName:"threshold"}}}})}(t=Mt.prototype).close=function(){return this.i&&this.i.delete(),e.resolve()},t.reset=function(){var e=this;return T((function(t){e.i&&(e.i.reset(),e.o={},e.u={}),t.g=0}))},t.setOptions=function(e,t){var n=this;if(t=t||this.g.options){for(var r=[],i=[],o={},a=s(Object.keys(e)),c=a.next();!c.done;o={R:o.R,S:o.S},c=a.next()){var u=c.value;u in this.j&&this.j[u]===e[u]||(this.j[u]=e[u],void 0!==(c=t[u])&&(c.onChange&&(o.R=c.onChange,o.S=e[u],r.push(function(e){return function(){return T((function(t){if(1==t.g)return y(t,e.R(e.S),2);!0===t.h&&(n.s=!0),t.g=0}))}}(o))),c.graphOptionXref&&(u={valueNumber:1===c.type?e[u]:0,valueBoolean:0===c.type&&e[u],valueString:2===c.type?e[u]:""},c=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),c.graphOptionXref),u),i.push(c))))}(0!==r.length||0!==i.length)&&(this.s=!0,this.B=(void 0===this.B?[]:this.B).concat(i),this.A=(void 0===this.A?[]:this.A).concat(r))}},t.initialize=function(){var e=this;return T((function(t){return 1==t.g?y(t,Vt(e),2):3!=t.g?y(t,function(e){var t,n,r,i,o,a,c,u;return T((function(d){if(1==d.g)return e.g.graph&&e.g.graph.url&&e.Z===e.g.graph.url?d.return():(e.s=!0,e.g.graph&&e.g.graph.url?(e.Z=e.g.graph.url,y(d,Pt(e,e.g.graph.url),3)):void(d.g=2));for(2!=d.g&&(t=d.h,e.i.loadGraph(t)),n=s(Object.keys(e.C)),r=n.next();!r.done;r=n.next())i=r.value,e.i.overrideFile(i,e.C[i]);if(e.C={},e.g.listeners)for(o=s(e.g.listeners),a=o.next();!a.done;a=o.next())c=a.value,Zt(e,c);u=e.j,e.j={},e.setOptions(u),d.g=0}))}(e),3):y(t,function(e){var t,n,r,i,o,a;return T((function(c){switch(c.g){case 1:if(!e.s)return c.return();if(!e.A){c.g=2;break}t=s(e.A),n=t.next();case 3:if(n.done){c.g=5;break}return y(c,(0,n.value)(),4);case 4:n=t.next(),c.g=3;break;case 5:e.A=void 0;case 2:if(e.B){for(r=new e.h.GraphOptionChangeRequestList,i=s(e.B),o=i.next();!o.done;o=i.next())a=o.value,r.push_back(a);e.i.changeOptions(r),r.delete(),e.B=void 0}e.s=!1,c.g=0}}))}(e),0)}))},t.overrideFile=function(e,t){this.i?this.i.overrideFile(e,t):this.C[e]=t},t.clearOverriddenFiles=function(){this.C={},this.i&&this.i.clearOverriddenFiles()},t.send=function(e,t){var n,r,i,o,a,c,u,d,l,f=this;return T((function(p){switch(p.g){case 1:return f.g.inputs?(n=1e3*(null==t?performance.now():t),y(p,f.D,2)):p.return();case 2:return y(p,f.initialize(),3);case 3:for(r=new f.h.PacketDataList,i=s(Object.keys(e)),o=i.next();!o.done;o=i.next())if(a=o.value,c=f.g.inputs[a]){e:{var h=e[a];switch(c.type){case"video":var m=f.o[c.stream];if(m||(m=new Ot(f.h,f.G),f.o[c.stream]=m),0===m.l&&(m.l=m.h.createTexture()),typeof HTMLVideoElement<"u"&&h instanceof HTMLVideoElement)var g=h.videoWidth,v=h.videoHeight;else typeof HTMLImageElement<"u"&&h instanceof HTMLImageElement?(g=h.naturalWidth,v=h.naturalHeight):(g=h.width,v=h.height);v={glName:m.l,width:g,height:v},(g=m.g).canvas.width=v.width,g.canvas.height=v.height,g.activeTexture(g.TEXTURE0),m.h.bindTexture2d(m.l),g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,h),m.h.bindTexture2d(0),m=v;break e;case"detections":for((m=f.o[c.stream])||(m=new xt(f.h),f.o[c.stream]=m),m.data||(m.data=new m.g.DetectionListData),m.data.reset(h.length),v=0;v<h.length;++v){g=h[v];var b=m.data,S=b.setBoundingBox,E=v,_=g.ea,T=new _t;if(ye(T,1,_.ka),ye(T,2,_.la),ye(T,3,_.height),ye(T,4,_.width),ye(T,5,_.rotation),ye(T,6,_.ia),_=rt(T,Tt),S.call(b,E,_),g.Y)for(b=0;b<g.Y.length;++b){var R=!!(T=g.Y[b]).visibility;E=(S=m.data).addNormalizedLandmark,_=v,T=Object.assign(Object.assign({},T),{visibility:R?T.visibility:0}),ye(R=new vt,1,T.x),ye(R,2,T.y),ye(R,3,T.z),T.visibility&&ye(R,4,T.visibility),T=rt(R,yt),E.call(S,_,T)}if(g.V)for(b=0;b<g.V.length;++b)E=(S=m.data).addClassification,_=v,T=g.V[b],ye(R=new ft,2,T.score),T.index&&ye(R,1,T.index),T.label&&ye(R,3,T.label),T.displayName&&ye(R,4,T.displayName),T=rt(R,pt),E.call(S,_,T)}m=m.data;break e;default:m={}}}switch(u=m,d=c.stream,c.type){case"video":r.pushTexture2d(Object.assign(Object.assign({},u),{stream:d,timestamp:n}));break;case"detections":(l=u).stream=d,l.timestamp=n,r.pushDetectionList(l);break;default:throw Error("Unknown input config type: '"+c.type+"'")}}return f.i.send(r),y(p,f.D,4);case 4:r.delete(),p.g=0}}))},t.onResults=function(e,t){this.listeners[t||"$"]=e},w("Solution",Mt),w("OptionType",{BOOL:0,NUMBER:1,ma:2,0:"BOOL",1:"NUMBER",2:"STRING"}),(t=Wt.prototype).close=function(){return this.g.close(),e.resolve()},t.onResults=function(e){this.g.onResults(e)},t.initialize=function(){var e=this;return T((function(t){return y(t,e.g.initialize(),0)}))},t.reset=function(){this.g.reset()},t.send=function(e){var t=this;return T((function(n){return y(n,t.g.send(e),0)}))},t.setOptions=function(e){this.g.setOptions(e)},w("Hands",Wt),w("HAND_CONNECTIONS",[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]]),w("VERSION","0.4.1646424915")}).call(_e);var Te={};(function(){var t;function n(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var r="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},i=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof(void 0!==typeof window?window:global)&&(void 0!==typeof window?window:global)];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function o(e,t){if(t)e:{var n=i;e=e.split(".");for(var o=0;o<e.length-1;o++){var a=e[o];if(!(a in n))break e;n=n[a]}(t=t(o=n[e=e[e.length-1]]))!=o&&null!=t&&r(n,e,{configurable:!0,writable:!0,value:t})}}function a(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function s(e){var t=typeof Symbol<"u"&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:n(e)}}function c(e){if(!(e instanceof Array)){e=s(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}o("Symbol",(function(e){function t(e,t){this.g=e,r(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.g};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",i=0;return function e(r){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(r||"")+"_"+i++,r)}})),o("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),o=0;o<t.length;o++){var s=i[t[o]];"function"==typeof s&&"function"!=typeof s.prototype[e]&&r(s.prototype,e,{configurable:!0,writable:!0,value:function(){return a(n(this))}})}return e}));var u,d="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)u=Object.setPrototypeOf;else{var l;e:{var f={};try{f.__proto__={a:!0},l=f.a;break e}catch{}l=!1}u=l?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var p=u;function h(e,t){if(e.prototype=d(t.prototype),e.prototype.constructor=e,p)p(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var r=Object.getOwnPropertyDescriptor(t,n);r&&Object.defineProperty(e,n,r)}else e[n]=t[n];e.da=t.prototype}function m(){this.l=!1,this.i=null,this.h=void 0,this.g=1,this.s=this.m=0,this.j=null}function g(e){if(e.l)throw new TypeError("Generator is already running");e.l=!0}function v(e,t){e.j={U:t,V:!0},e.g=e.m||e.s}function y(e,t,n){return e.g=n,{value:t}}function b(e){this.g=new m,this.h=e}function S(e,t,n,r){try{var i=t.call(e.g.i,n);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return e.g.l=!1,i;var o=i.value}catch(t){return e.g.i=null,v(e.g,t),E(e)}return e.g.i=null,r.call(e.g,o),E(e)}function E(e){for(;e.g.g;)try{var t=e.h(e.g);if(t)return e.g.l=!1,{value:t.value,done:!1}}catch(t){e.g.h=void 0,v(e.g,t)}if(e.g.l=!1,e.g.j){if(t=e.g.j,e.g.j=null,t.V)throw t.U;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function _(e){this.next=function(t){return g(e.g),e.g.i?t=S(e,e.g.i.next,t,e.g.o):(e.g.o(t),t=E(e)),t},this.throw=function(t){return g(e.g),e.g.i?t=S(e,e.g.i.throw,t,e.g.o):(v(e.g,t),t=E(e)),t},this.return=function(t){return function(e,t){g(e.g);var n=e.g.i;return n?S(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),E(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function T(t){return function(t){function n(e){return t.next(e)}function r(e){return t.throw(e)}return new e((function(i,o){!function t(a){a.done?i(a.value):e.resolve(a.value).then(n,r).then(t,o)}(t.next())}))}(new _(new b(t)))}m.prototype.o=function(e){this.h=e},m.prototype.return=function(e){this.j={return:e},this.g=this.s},o("Promise",(function(e){function t(e){this.h=0,this.i=void 0,this.g=[],this.o=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function n(){this.g=null}function r(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;n.prototype.h=function(e){if(null==this.g){this.g=[];var t=this;this.i((function(){t.l()}))}this.g.push(e)};var o=i.setTimeout;n.prototype.i=function(e){o(e,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.j(e)}}}this.g=null},n.prototype.j=function(e){this.i((function(){throw e}))},t.prototype.j=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.C),reject:e(this.l)}},t.prototype.C=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.F(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.v(e):this.m(e)}},t.prototype.v=function(e){var t=void 0;try{t=e.then}catch(e){return void this.l(e)}"function"==typeof t?this.G(t,e):this.m(e)},t.prototype.l=function(e){this.s(2,e)},t.prototype.m=function(e){this.s(1,e)},t.prototype.s=function(e,t){if(0!=this.h)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.h);this.h=e,this.i=t,2===this.h&&this.D(),this.A()},t.prototype.D=function(){var e=this;o((function(){if(e.B()){var t=i.console;typeof t<"u"&&t.error(e.i)}}),1)},t.prototype.B=function(){if(this.o)return!1;var e=i.CustomEvent,t=i.Event,n=i.dispatchEvent;return typeof n>"u"||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=i.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.i,n(e))},t.prototype.A=function(){if(null!=this.g){for(var e=0;e<this.g.length;++e)a.h(this.g[e]);this.g=null}};var a=new n;return t.prototype.F=function(e){var t=this.j();e.J(t.resolve,t.reject)},t.prototype.G=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(e){o(e)}}:t}var i,o,a=new t((function(e,t){i=e,o=t}));return this.J(r(e,i),r(n,o)),a},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.J=function(e,t){function n(){switch(r.h){case 1:e(r.i);break;case 2:t(r.i);break;default:throw Error("Unexpected state: "+r.h)}}var r=this;null==this.g?a.h(n):this.g.push(n),this.o=!0},t.resolve=r,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var i=s(e),o=i.next();!o.done;o=i.next())r(o.value).J(t,n)}))},t.all=function(e){var n=s(e),i=n.next();return i.done?r([]):new t((function(e,t){function o(t){return function(n){a[t]=n,0==--s&&e(a)}}var a=[],s=0;do{a.push(void 0),s++,r(i.value).J(o(a.length-1),t),i=n.next()}while(!i.done)}))},t}));var R="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e};o("Object.assign",(function(e){return e||R})),o("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}})),o("Array.prototype.includes",(function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var r=n.length;for(0>(t=t||0)&&(t=Math.max(t+r,0));t<r;t++){var i=n[t];if(i===e||Object.is(i,e))return!0}return!1}})),o("String.prototype.includes",(function(e){return e||function(e,t){if(null==this)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return-1!==this.indexOf(e,t||0)}})),o("Array.prototype.keys",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,(function(e){return e}))}}));var I=this||self;function w(e,t){e=e.split(".");var n,r=I;e[0]in r||typeof r.execScript>"u"||r.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)e.length||void 0===t?r=r[n]&&r[n]!==Object.prototype[n]?r[n]:r[n]={}:r[n]=t}function C(e){!function(e){I.setTimeout((function(){throw e}),0)}(e)}function O(e,t){C(Error("Invalid wire type: "+e+" (at position "+t+")"))}function A(){C(Error("Failed to read varint, encoding is invalid."))}function x(e,t){return t=String.fromCharCode.apply(null,t),null==e?t:e+t}var k,N,L=typeof TextDecoder<"u",M=typeof TextEncoder<"u";function V(e){if(M)e=(N||(N=new TextEncoder)).encode(e);else{var t=void 0;t=void 0!==t&&t;for(var n=0,r=new Uint8Array(3*e.length),i=0;i<e.length;i++){var o=e.charCodeAt(i);if(128>o)r[n++]=o;else{if(2048>o)r[n++]=o>>6|192;else{if(55296<=o&&57343>=o){if(56319>=o&&i<e.length){var a=e.charCodeAt(++i);if(56320<=a&&57343>=a){o=1024*(o-55296)+a-56320+65536,r[n++]=o>>18|240,r[n++]=o>>12&63|128,r[n++]=o>>6&63|128,r[n++]=63&o|128;continue}i--}if(t)throw Error("Found an unpaired surrogate");o=65533}r[n++]=o>>12|224,r[n++]=o>>6&63|128}r[n++]=63&o|128}}e=r.subarray(0,n)}return e}var P={},D=null;function Z(e){var t;void 0===t&&(t=0),W(),t=P[t];for(var n=Array(Math.floor(e.length/3)),r=t[64]||"",i=0,o=0;i<e.length-2;i+=3){var a=e[i],s=e[i+1],c=e[i+2],u=t[a>>2];a=t[(3&a)<<4|s>>4],s=t[(15&s)<<2|c>>6],c=t[63&c],n[o++]=u+a+s+c}switch(u=0,c=r,e.length-i){case 2:c=t[(15&(u=e[i+1]))<<2]||r;case 1:e=e[i],n[o]=t[e>>2]+t[(3&e)<<4|u>>4]+c+r}return n.join("")}function j(e){var t=e.length,n=3*t/4;n%3?n=Math.floor(n):-1!="=.".indexOf(e[t-1])&&(n=-1!="=.".indexOf(e[t-2])?n-2:n-1);var r=new Uint8Array(n),i=0;return function(e,t){function n(t){for(;r<e.length;){var n=e.charAt(r++),i=D[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return t}W();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;t(i<<2|o>>4),64!=a&&(t(o<<4&240|a>>2),64!=s&&t(a<<6&192|s))}}(e,(function(e){r[i++]=e})),r.subarray(0,i)}function W(){if(!D){D={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++){var r=e.concat(t[n].split(""));P[n]=r;for(var i=0;i<r.length;i++){var o=r[i];void 0===D[o]&&(D[o]=i)}}}}var G,F="function"==typeof Uint8Array;function U(e){if(this.g=e,null!==e&&0===e.length)throw Error("ByteString should be constructed with non-empty values")}U.prototype.toJSON=function(){if(null==this.g)var e="";else e=this.g,e=this.g=null==e||"string"==typeof e?e:F&&e instanceof Uint8Array?Z(e):null;return e};var X="function"==typeof Uint8Array.prototype.slice;function B(e,t,n){return t===n?G||(G=new Uint8Array(0)):X?e.slice(t,n):new Uint8Array(e.subarray(t,n))}var H=0;function Y(e,t){t=void 0!==(t=void 0===t?{}:t).u&&t.u,this.h=null,this.g=this.i=this.m=0,this.l=!1,this.u=t,e&&J(this,e)}function J(e,t){e.h=function(e){if(e.constructor===Uint8Array)return e;if(e.constructor===ArrayBuffer)return new Uint8Array(e);if(e.constructor===Array)return new Uint8Array(e);if(e.constructor===String)return j(e);if(e.constructor===U){if(null==e.g)var t=G||(G=new Uint8Array(0));else{t=Uint8Array;var n=e.g;n=null==n||F&&null!=n&&n instanceof Uint8Array?n:"string"==typeof n?j(n):null,t=new t(e=e.g=n)}return t}if(e instanceof Uint8Array)return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, or Array of numbers")}(t),e.m=0,e.i=e.h.length,e.g=e.m}function z(e){for(var t=128,n=0,r=0,i=0;4>i&&128<=t;i++)n|=(127&(t=e.h[e.g++]))<<7*i;if(128<=t&&(n|=(127&(t=e.h[e.g++]))<<28,r|=(127&t)>>4),128<=t)for(i=0;5>i&&128<=t;i++)r|=(127&(t=e.h[e.g++]))<<7*i+3;if(128>t)return e=n>>>0,(r=2147483648&(t=r>>>0))&&(t=~t>>>0,0==(e=1+~e>>>0)&&(t=t+1>>>0)),e=4294967296*t+(e>>>0),r?-e:e;e.l=!0,A()}function K(e){e.g>e.i&&(e.l=!0,C(Error("Tried to read past the end of the data "+e.g+" > "+e.i)))}Y.prototype.reset=function(){this.g=this.m},Y.prototype.j=function(){var e=this.h,t=e[this.g],n=127&t;return 128>t?(this.g+=1,K(this),n):(n|=(127&(t=e[this.g+1]))<<7,128>t?(this.g+=2,K(this),n):(n|=(127&(t=e[this.g+2]))<<14,128>t?(this.g+=3,K(this),n):(n|=(127&(t=e[this.g+3]))<<21,128>t?(this.g+=4,K(this),n):(n|=(15&(t=e[this.g+4]))<<28,128>t?(this.g+=5,K(this),n>>>0):(this.g+=5,128<=e[this.g++]&&128<=e[this.g++]&&128<=e[this.g++]&&128<=e[this.g++]&&128<=e[this.g++]?(this.l=!0,A(),n):(K(this),n))))))},Y.prototype.o=function(){var e=this.h[this.g],t=this.h[this.g+1],n=this.h[this.g+2],r=this.h[this.g+3];return this.g+=4,K(this),e=2*((n=(e<<0|t<<8|n<<16|r<<24)>>>0)>>31)+1,t=n>>>23&255,n&=8388607,255==t?n?NaN:1/0*e:0==t?e*Math.pow(2,-149)*n:e*Math.pow(2,t-150)*(n+Math.pow(2,23))};var Q=[];function q(){this.g=new Uint8Array(64),this.h=0}function $(e,t){if(!(e.h+1<e.g.length)){var n=e.g;e.g=new Uint8Array(Math.ceil(1+2*e.g.length)),e.g.set(n)}e.g[e.h++]=t}function ee(e,t){for(;127<t;)$(e,127&t|128),t>>>=7;$(e,t)}function te(e){var t={},n=void 0!==t.N&&t.N;this.m={u:void 0!==t.u&&t.u},this.N=n,t=this.m,Q.length?(n=Q.pop(),t&&(n.u=t.u),e&&J(n,e),e=n):e=new Y(e,t),this.g=e,this.l=this.g.g,this.h=this.i=-1,this.j=!1}function ne(e){var t=e.g;if((t=t.g==t.i)||(t=e.j)||(t=(t=e.g).l||0>t.g||t.g>t.i),t)return!1;e.l=e.g.g;var n=e.g.j();return t=n>>>3,0<=(n&=7)&&5>=n?(e.i=t,e.h=n,!0):(e.j=!0,O(n,e.l),!1)}function re(e){switch(e.h){case 0:if(0!=e.h)re(e);else e:{for(var t=(e=e.g).g,n=0;10>n;n++){if(0==(128&e.h[t])){e.g=t+1,K(e);break e}t++}e.l=!0,A()}break;case 1:(e=e.g).g+=8,K(e);break;case 2:2!=e.h?re(e):(t=e.g.j(),(e=e.g).g+=t,K(e));break;case 5:(e=e.g).g+=4,K(e);break;case 3:for(t=e.i;;){if(!ne(e)){e.j=!0,C(Error("Unmatched start-group tag: stream EOF"));break}if(4==e.h){e.i!=t&&(e.j=!0,C(Error("Unmatched end-group tag")));break}re(e)}break;default:e.j=!0,O(e.h,e.l)}}function ie(e,t,n){e.N||(e=B(e.g.h,n,e.g.g),(n=t.o)?n.push(e):t.o=[e])}function oe(e,t,n){var r=e.g.i,i=e.g.j(),o=e.g.g+i;if(e.g.i=o,n(t,e),0!=(n=o-e.g.g))throw Error("Message parsing ended unexpectedly. Expected to read "+i+" bytes, instead read "+(i-n)+" bytes, either the data ended unexpectedly or the message misreported its own length");return e.g.g=o,e.g.i=r,t}function ae(e,t,n){var r=e.g.j();for(r=e.g.g+r;e.g.g<r;)n.push(t.call(e.g))}q.prototype.length=function(){return this.h},q.prototype.end=function(){var e=this.g,t=this.h;return this.h=0,B(e,0,t)},te.prototype.reset=function(){this.g.reset(),this.h=this.i=-1};var se=[];function ce(){this.h=[],this.i=0,this.g=new q}function ue(e,t){0!==t.length&&(e.h.push(t),e.i+=t.length)}function de(e,t,n){ee(e.g,8*t+2),ee(e.g,n.length),ue(e,e.g.end()),ue(e,n)}var le,fe="function"==typeof Symbol&&"symbol"==typeof Symbol()?Symbol(void 0):void 0;function pe(e,t){Object.isFrozen(e)||(fe?e[fe]|=t:void 0!==e.g?e.g|=t:Object.defineProperties(e,{g:{value:t,configurable:!0,writable:!0,enumerable:!1}}))}function he(e){return e?null==(t=fe?e[fe]:e.g)?0:t:0;var t}function me(e){return Array.isArray(e)&&pe(e,1),e}function ge(e){if(!Array.isArray(e))throw Error("cannot mark non-array as immutable");pe(e,2)}function ve(e){return null!==e&&"object"==typeof e&&e.constructor===Object}function ye(e){switch(typeof e){case"number":return isFinite(e)?e:String(e);case"object":return F&&null!=e&&e instanceof Uint8Array?Z(e):e;default:return e}}function be(e,t){if(null!=e)return Array.isArray(e)||ve(e)?Se(e,t):t(e)}function Se(e,t){if(Array.isArray(e)){for(var n=Array(e.length),r=0;r<e.length;r++)n[r]=be(e[r],t);return 1&he(e)&&me(n),n}for(r in n={},e)n[r]=be(e[r],t);return n}function Ee(e,t,n){var r=le;if(le=null,e||(e=r),r=this.constructor.ba,e||(e=r?[r]:[]),this.j=(r?0:-1)-(this.constructor.$||0),this.m=this.g=null,this.h=e,e=(r=this.h.length)-1,r&&ve(r=this.h[e])?(this.l=e-this.j,this.i=r):void 0!==t&&-1<t?(this.l=Math.max(t,e+1-this.j),this.i=null):this.l=Number.MAX_VALUE,n)for(t=0;t<n.length;t++)(e=n[t])<this.l?(e+=this.j,(r=this.h[e])?me(r):this.h[e]=Te):(Re(this),(r=this.i[e])?me(r):this.i[e]=Te)}var _e,Te=Object.freeze(me([]));function Re(e){var t=e.l+e.j;e.h[t]||(e.i=e.h[t]={})}function Ie(e,t,n){return-1===t?null:void 0!==n&&n||t>=e.l?e.i?e.i[t]:void 0:e.h[t+e.j]}function we(e,t,n){n=void 0===n||n;var r=void 0!==r&&r,i=Ie(e,t,r);return null==i&&(i=Te),i===Te?xe(e,t,i=me([]),r):n&&Array.isArray(i)&&2&he(i)&&xe(e,t,i=i.slice(),r),i}function Ce(e){var t=we(e,3,!1);if(e.m||(e.m={}),!e.m[3]){for(var n=0;n<t.length;n++)t[n]=+t[n];e.m[3]=!0}return t}function Oe(e,t,n){return null==(e=Ie(e,t))?n:e}function Ae(e,t,n){return null==(e=null==(e=Ie(e,t))?e:+e)?void 0===n?0:n:e}function xe(e,t,n,r){void 0!==r&&r||t>=e.l?(Re(e),e.i[t]=n):e.h[t+e.j]=n}function ke(e,t,n){if(-1===n)return null;e.g||(e.g={});var r=e.g[n];if(r)return r;var i=Ie(e,n,!1);return null==i?r:(t=new t(i),e.g[n]=t)}function Ne(e,t,n){e.g||(e.g={});var r=e.g[n];if(!r){var i=we(e,n,!1);r=[];for(var o=!!Array.isArray(i)&&!!(2&he(i)),a=0;a<i.length;a++)r[a]=new t(i[a]),o&&ge(r[a].h);o&&(ge(r),Object.freeze(r)),e.g[n]=r}return r}function Le(e,t,n,r,i){var o=Ne(e,r,t);n=n||new r,e=we(e,t),null!=i?(o.splice(i,0,n),e.splice(i,0,Me(n))):(o.push(n),e.push(Me(n)))}function Me(e){if(e.g)for(var t in e.g){var n=e.g[t];if(Array.isArray(n))for(var r=0;r<n.length;r++)n[r]&&Me(n[r]);else n&&Me(n)}return e.h}function Ve(e,t){if(e=e.o){ue(t,t.g.end());for(var n=0;n<e.length;n++)ue(t,e[n])}}function Pe(e){var t=e[0];switch(e.length){case 2:var n=e[1];return function(e,r,i){return t(e,r,i,n)};case 3:var r=e[1],i=e[2];return function(e,n,o){return t(e,n,o,r,i)};case 4:var o=e[1],a=e[2],s=e[3];return function(e,n,r){return t(e,n,r,o,a,s)};default:throw Error("unsupported number of parameters, expected [2-4], got "+e.length)}}function De(e,t,n){for(;ne(t)&&4!=t.h;){var r=t.i,i=n[r];if(i){if(Array.isArray(i)&&(i=n[r]=Pe(i)),!i(t,e,r)){i=e;var o=(r=t).l;re(r),ie(r,i,o)}}else i=e,o=(r=t).l,re(r),ie(r,i,o)}return e}function Ze(e,t){var n=new ce;if(t(e,n),0===(e=n.i+n.g.length()))n=new Uint8Array(0);else{e=new Uint8Array(e);for(var r=n.h,i=r.length,o=t=0;o<i;o++){var a=r[o];0!==a.length&&(e.set(a,t),t+=a.length)}0!==(i=(r=n.g).h)&&(e.set(r.g.subarray(0,i),t),r.h=0),n.h=[e],n=e}return n}function je(e,t,n){if(se.length){var r=se.pop();e&&(J(r.g,e),r.i=-1,r.h=-1),e=r}else e=new te(e);try{return n(new t,e)}finally{(t=e.g).h=null,t.m=0,t.i=0,t.g=0,t.l=!1,t.u=!1,e.i=-1,e.h=-1,e.j=!1,100>se.length&&se.push(e)}}function We(e,t,n){if(null!=(t=Ie(t,n))){ee(e.g,8*n+5),e=e.g;var r=t;0===(r=(n=0>r?1:0)?-r:r)?H=0<1/r?0:2147483648:isNaN(r)?H=2147483647:34028234663852886e22<r?H=(n<<31|2139095040)>>>0:11754943508222875e-54>r?(r=Math.round(r/Math.pow(2,-149)),H=(n<<31|r)>>>0):(t=Math.floor(Math.log(r)/Math.LN2),r*=Math.pow(2,-t),16777216<=(r=Math.round(8388608*r))&&++t,H=(n<<31|t+127<<23|8388607&r)>>>0),$(e,(n=H)>>>0&255),$(e,n>>>8&255),$(e,n>>>16&255),$(e,n>>>24&255)}}function Ge(e,t,n){return 5===e.h&&(xe(t,n,e.g.o()),!0)}function Fe(e,t,n){return(5===e.h||2===e.h)&&(t=we(t,n),2==e.h?ae(e,Y.prototype.o,t):t.push(e.g.o()),!0)}function Ue(e,t,n){return 0===e.h&&(xe(t,n,z(e.g)),!0)}function Xe(e,t,n){return 0===e.h&&(xe(t,n,e.g.j()),!0)}function Be(e,t,n){if(2!==e.h)return!1;var r,i=e.g.j(),o=(e=e.g).g;if(e.g+=i,K(e),e=e.h,L)(r=k)||(r=k=new TextDecoder("utf-8",{fatal:!1})),r=r.decode(e.subarray(o,o+i));else{i=o+i;for(var a,s,c,u=[],d=null;o<i;)128>(a=e[o++])?u.push(a):224>a?o>=i?u.push(65533):(s=e[o++],194>a||128!=(192&s)?(o--,u.push(65533)):u.push((31&a)<<6|63&s)):240>a?o>=i-1?u.push(65533):128!=(192&(s=e[o++]))||224===a&&160>s||237===a&&160<=s||128!=(192&(r=e[o++]))?(o--,u.push(65533)):u.push((15&a)<<12|(63&s)<<6|63&r):244>=a?o>=i-2?u.push(65533):128!=(192&(s=e[o++]))||s-144+(a<<28)>>30!=0||128!=(192&(r=e[o++]))||128!=(192&(c=e[o++]))?(o--,u.push(65533)):(a=(7&a)<<18|(63&s)<<12|(63&r)<<6|63&c,a-=65536,u.push(55296+(a>>10&1023),56320+(1023&a))):u.push(65533),8192<=u.length&&(d=x(d,u),u.length=0);r=x(d,u)}return xe(t,n,r),!0}function He(e,t,n,r,i){if(2!==e.h)return!1;e=oe(e,new r,i);var o=void 0!==o&&o;return t.g||(t.g={}),r=e&&Me(e),t.g[n]=e,xe(t,n,r,o),!0}function Ye(e,t,n,r,i){return 2===e.h&&(Le(t,n,e=oe(e,new r,i),r,void 0),!0)}function Je(e,t,n){return(0===e.h||2===e.h)&&(t=we(t,n),2==e.h?ae(e,Y.prototype.j,t):t.push(e.g.j()),!0)}function ze(e,t,n){return 0===e.h&&(xe(t,n,z(e.g)),!0)}function Ke(e){Ee.call(this,e,-1,et)}function Qe(e,t){return De(e,t,_e||(_e={1:Xe,2:Xe,3:Fe,4:ze}))}Ee.prototype.toJSON=function(){return Se(Me(this),ye)},Ee.prototype.toString=function(){return Me(this).toString()},h(Ke,Ee),Ke.prototype.getRows=function(){return Ie(this,1)},Ke.prototype.getCols=function(){return Ie(this,2)},Ke.prototype.getPackedDataList=function(){return Ce(this)},Ke.prototype.getLayout=function(){return Oe(this,4,0)};var qe,$e,et=[3];function tt(e){Ee.call(this,e)}function nt(e,t){var n=Ie(e,1);if(null!=n&&null!=n){ee(t.g,8);var r=t.g;if(0<=n)ee(r,n);else{for(var i=0;9>i;i++)$(r,127&n|128),n>>=7;$(r,1)}}We(t,e,2),null!=(r=Ie(e,3))&&de(t,3,V(r)),null!=(r=Ie(e,4))&&de(t,4,V(r)),Ve(e,t)}function rt(e,t){return De(e,t,qe||(qe={1:Xe,2:Ge,3:Be,4:Be}))}function it(e){Ee.call(this,e,-1,ct)}function ot(e,t){return De(e,t,$e||($e={1:[Ye,tt,rt]}))}h(tt,Ee),h(it,Ee),it.prototype.addClassification=function(e,t){return Le(this,1,e,tt,t),this};var at,st,ct=[1];function ut(e){Ee.call(this,e)}function dt(e,t){We(t,e,1),We(t,e,2),We(t,e,3),We(t,e,4),We(t,e,5),Ve(e,t)}function lt(e,t){return De(e,t,at||(at={1:Ge,2:Ge,3:Ge,4:Ge,5:Ge}))}function ft(e){Ee.call(this,e,-1,gt)}function pt(e,t){return De(e,t,st||(st={1:[Ye,ut,lt]}))}h(ut,Ee),h(ft,Ee);var ht,mt,gt=[1];function vt(e){Ee.call(this,e)}function yt(e,t){We(t,e,1),We(t,e,2),We(t,e,3),We(t,e,4),We(t,e,5);var n=Ie(e,6);if(null!=n&&null!=n){ee(t.g,48);var r=t.g,i=n;n=0>i;var o=(i=Math.abs(i))>>>0;for(i=Math.floor((i-o)/4294967296),i>>>=0,n&&(i=~i>>>0,4294967295<(o=1+(~o>>>0))&&(o=0,4294967295<++i&&(i=0))),n=H=o,o=i;0<o||127<n;)$(r,127&n|128),n=(n>>>7|o<<25)>>>0,o>>>=7;$(r,n)}Ve(e,t)}function bt(e,t){return De(e,t,ht||(ht={1:Ge,2:Ge,3:Ge,4:Ge,5:Ge,6:Ue}))}function St(e){Ee.call(this,e,-1,Tt)}function Et(e,t){return De(e,t,mt||(mt={1:ze,2:ze,3:Fe,4:Je}))}h(vt,Ee),h(St,Ee),St.prototype.getVertexType=function(){return Oe(this,1,0)},St.prototype.getPrimitiveType=function(){return Oe(this,2,0)},St.prototype.getVertexBufferList=function(){return Ce(this)},St.prototype.getIndexBufferList=function(){return we(this,4)};var _t,Tt=[3,4];function Rt(e){Ee.call(this,e)}function It(e,t){return De(e,t,_t||(_t={1:[He,St,Et],2:[He,Ke,Qe]}))}h(Rt,Ee),Rt.prototype.getMesh=function(){return ke(this,St,1)},Rt.prototype.getPoseTransformMatrix=function(){return ke(this,Ke,2)};var wt=[[61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]],Ct=[[263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]],Ot=[[276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]],At=[[33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]],xt=[[46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]],kt=[[10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]],Nt=[].concat(c(wt),c(Ct),c(Ot),c(At),c(xt),c(kt));function Lt(e,t,n){if(n=e.createShader(0===n?e.VERTEX_SHADER:e.FRAGMENT_SHADER),e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw Error("Could not compile WebGL shader.\n\n"+e.getShaderInfoLog(n));return n}function Mt(e){return Ne(e,tt,1).map((function(e){return{index:Oe(e,1,0),score:Ae(e,2),label:null!=Ie(e,3)?Oe(e,3,""):void 0,displayName:null!=Ie(e,4)?Oe(e,4,""):void 0}}))}function Vt(e){return{x:Ae(e,1),y:Ae(e,2),z:Ae(e,3),visibility:null!=Ie(e,4)?Ae(e,4):void 0}}function Pt(e){return Ne(je(e,ft,pt),ut,1).map(Vt)}function Dt(e,t){this.h=e,this.g=t,this.l=0}function Zt(t,n,r){return function(e,t){var n=e.g;if(void 0===e.m){var r=Lt(n,"\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }",0),i=Lt(n,"\n  precision mediump float;\n  varying vec2 vTex;\n  uniform sampler2D sampler0;\n  void main(){\n    gl_FragColor = texture2D(sampler0, vTex);\n  }",1),o=n.createProgram();if(n.attachShader(o,r),n.attachShader(o,i),n.linkProgram(o),!n.getProgramParameter(o,n.LINK_STATUS))throw Error("Could not compile WebGL program.\n\n"+n.getProgramInfoLog(o));r=e.m=o,n.useProgram(r),i=n.getUniformLocation(r,"sampler0"),e.j={I:n.getAttribLocation(r,"aVertex"),H:n.getAttribLocation(r,"aTex"),ca:i},e.s=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,e.s),n.enableVertexAttribArray(e.j.I),n.vertexAttribPointer(e.j.I,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),e.o=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,e.o),n.enableVertexAttribArray(e.j.H),n.vertexAttribPointer(e.j.H,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.uniform1i(i,0)}r=e.j,n.useProgram(e.m),n.canvas.width=t.width,n.canvas.height=t.height,n.viewport(0,0,t.width,t.height),n.activeTexture(n.TEXTURE0),e.h.bindTexture2d(t.glName),n.enableVertexAttribArray(r.I),n.bindBuffer(n.ARRAY_BUFFER,e.s),n.vertexAttribPointer(r.I,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(r.H),n.bindBuffer(n.ARRAY_BUFFER,e.o),n.vertexAttribPointer(r.H,2,n.FLOAT,!1,0,0),n.bindFramebuffer(n.DRAW_FRAMEBUFFER?n.DRAW_FRAMEBUFFER:n.FRAMEBUFFER,null),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.colorMask(!0,!0,!0,!0),n.drawArrays(n.TRIANGLE_FAN,0,4),n.disableVertexAttribArray(r.I),n.disableVertexAttribArray(r.H),n.bindBuffer(n.ARRAY_BUFFER,null),e.h.bindTexture2d(0)}(t,n),"function"==typeof t.g.canvas.transferToImageBitmap?e.resolve(t.g.canvas.transferToImageBitmap()):r?e.resolve(t.g.canvas):"function"==typeof createImageBitmap?createImageBitmap(t.g.canvas):(void 0===t.i&&(t.i=document.createElement("canvas")),new e((function(e){t.i.height=t.g.canvas.height,t.i.width=t.g.canvas.width,t.i.getContext("2d",{}).drawImage(t.g.canvas,0,0,t.g.canvas.width,t.g.canvas.height),e(t.i)})))}function jt(e){this.g=e}var Wt=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function Gt(e,t){return t+e}function Ft(e,t){window[e]=t}function Ut(t){if(this.g=t,this.listeners={},this.j={},this.F={},this.m={},this.s={},this.G=this.o=this.R=!0,this.C=e.resolve(),this.P="",this.B={},this.locateFile=t&&t.locateFile||Gt,"object"==typeof window)var n=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if(!(typeof location<"u"))throw Error("solutions can only be loaded on a web page or in a web worker");n=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}if(this.S=n,t.options)for(var r=(n=s(Object.keys(t.options))).next();!r.done;r=n.next()){r=r.value;var i=t.options[r].default;void 0!==i&&(this.j[r]="function"==typeof i?i():i)}}function Xt(t){var n,r,i,o,a,s,u,d,l,f,p;return T((function(h){switch(h.g){case 1:return t.R?(n=void 0===t.g.files?[]:"function"==typeof t.g.files?t.g.files(t.j):t.g.files,y(h,T((function(e){switch(e.g){case 1:return e.m=2,y(e,WebAssembly.instantiate(Wt),4);case 4:e.g=3,e.m=0;break;case 2:return e.m=0,e.j=null,e.return(!1);case 3:return e.return(!0)}})),2)):h.return();case 2:if(r=h.h,"object"==typeof window)return Ft("createMediapipeSolutionsWasm",{locateFile:t.locateFile}),Ft("createMediapipeSolutionsPackedAssets",{locateFile:t.locateFile}),s=n.filter((function(e){return void 0!==e.data})),u=n.filter((function(e){return void 0===e.data})),d=e.all(s.map((function(n){var r=Bt(t,n.url);if(void 0!==n.path){var i=n.path;r=r.then((function(n){return t.overrideFile(i,n),e.resolve(n)}))}return r}))),l=e.all(u.map((function(n){return void 0===n.simd||n.simd&&r||!n.simd&&!r?function(t){var n=document.createElement("script");return n.setAttribute("src",t),n.setAttribute("crossorigin","anonymous"),new e((function(e){n.addEventListener("load",(function(){e()}),!1),n.addEventListener("error",(function(){e()}),!1),document.body.appendChild(n)}))}(t.locateFile(n.url,t.S)):e.resolve()}))).then((function(){var e,n,r;return T((function(i){if(1==i.g)return e=window.createMediapipeSolutionsWasm,n=window.createMediapipeSolutionsPackedAssets,r=t,y(i,e(n),2);r.h=i.h,i.g=0}))})),f=T((function(e){return t.g.graph&&t.g.graph.url?e=y(e,Bt(t,t.g.graph.url),0):(e.g=0,e=void 0),e})),y(h,e.all([l,d,f]),7);if("function"!=typeof importScripts)throw Error("solutions can only be loaded on a web page or in a web worker");return i=n.filter((function(e){return void 0===e.simd||e.simd&&r||!e.simd&&!r})).map((function(e){return t.locateFile(e.url,t.S)})),importScripts.apply(null,c(i)),o=t,y(h,createMediapipeSolutionsWasm(Module),6);case 6:o.h=h.h,t.l=new OffscreenCanvas(1,1),t.h.canvas=t.l,a=t.h.GL.createContext(t.l,{antialias:!1,alpha:!1,aa:typeof WebGL2RenderingContext<"u"?2:1}),t.h.GL.makeContextCurrent(a),h.g=4;break;case 7:if(t.l=document.createElement("canvas"),!(p=t.l.getContext("webgl2",{}))&&!(p=t.l.getContext("webgl",{})))return alert("Failed to create WebGL canvas context when passing video frame."),h.return();t.D=p,t.h.canvas=t.l,t.h.createContext(t.l,!0,!0,{});case 4:t.i=new t.h.SolutionWasm,t.R=!1,h.g=0}}))}function Bt(e,t){var n,r;return T((function(i){return t in e.F?i.return(e.F[t]):(n=e.locateFile(t,""),r=fetch(n).then((function(e){return e.arrayBuffer()})),e.F[t]=r,i.return(r))}))}function Ht(e,t,n){var r,i,o,a,c,u,d,l,f,p,h,m,g,v;return T((function(b){switch(b.g){case 1:if(!n)return b.return(t);for(r={},i=0,o=s(Object.keys(n)),a=o.next();!a.done;a=o.next())c=a.value,"string"!=typeof(u=n[c])&&"texture"===u.type&&void 0!==t[u.stream]&&++i;1<i&&(e.G=!1),d=s(Object.keys(n)),a=d.next();case 2:if(a.done){b.g=4;break}if(l=a.value,"string"==typeof(f=n[l]))return g=r,v=l,y(b,function(e,t,n){var r;return T((function(i){return"number"==typeof n||n instanceof Uint8Array||n instanceof e.h.Uint8BlobList?i.return(n):n instanceof e.h.Texture2dDataOut?((r=e.s[t])||(r=new Dt(e.h,e.D),e.s[t]=r),i.return(Zt(r,n,e.G))):i.return(void 0)}))}(e,l,t[f]),14);if(p=t[f.stream],"detection_list"===f.type){if(p){for(var S=p.getRectList(),E=p.getLandmarksList(),_=p.getClassificationsList(),R=[],I=0;I<S.size();++I){var w=je(S.get(I),vt,bt);w={T:{X:Ae(w,1),Y:Ae(w,2),height:Ae(w,3),width:Ae(w,4),rotation:Ae(w,5,0),W:Oe(w,6,0)},O:Pt(E.get(I)),M:Mt(je(_.get(I),it,ot))},R.push(w)}S=R}else S=[];r[l]=S,b.g=7;break}if("proto_list"===f.type){if(p){for(S=Array(p.size()),E=0;E<p.size();E++)S[E]=p.get(E);p.delete()}else S=[];r[l]=S,b.g=7;break}if(void 0===p){b.g=3;break}if("float_list"===f.type){r[l]=p,b.g=7;break}if("proto"===f.type){r[l]=p,b.g=7;break}if("texture"!==f.type)throw Error("Unknown output config type: '"+f.type+"'");return(h=e.s[l])||(h=new Dt(e.h,e.D),e.s[l]=h),y(b,Zt(h,p,e.G),13);case 13:m=b.h,r[l]=m;case 7:f.transform&&r[l]&&(r[l]=f.transform(r[l])),b.g=3;break;case 14:g[v]=b.h;case 3:a=d.next(),b.g=2;break;case 4:return b.return(r)}}))}function Yt(e,t){for(var n=t.name||"$",r=[].concat(c(t.wants)),i=new e.h.StringList,o=s(t.wants),a=o.next();!a.done;a=o.next())i.push_back(a.value);o=e.h.PacketListener.implement({onResults:function(i){for(var o={},a=0;a<t.wants.length;++a)o[r[a]]=i.get(a);var s=e.listeners[n];s&&(e.C=Ht(e,o,t.outs).then((function(n){n=s(n);for(var i=0;i<t.wants.length;++i){var a=o[r[i]];"object"==typeof a&&a.hasOwnProperty&&a.hasOwnProperty("delete")&&a.delete()}n&&(e.C=n)})))}}),e.i.attachMultiListener(i,o),i.delete()}function Jt(e){return e.map(zt)}function zt(e){var t=(e=je(e,Rt,It)).getMesh();if(!t)return e;var n=new Float32Array(t.getVertexBufferList());t.getVertexBufferList=function(){return n};var r=new Uint32Array(t.getIndexBufferList());return t.getIndexBufferList=function(){return r},e}function Kt(e){var t=this;e=e||{},this.g=new Ut({locateFile:e.locateFile,files:[{url:"holistic_solution_packed_assets_loader.js"},{simd:!1,url:"holistic_solution_wasm_bin.js"},{simd:!0,url:"holistic_solution_simd_wasm_bin.js"}],graph:{url:"holistic.binarypb"},inputs:{image:{type:"video",stream:"input_frames_gpu"}},listeners:[{wants:"left_hand_landmarks right_hand_landmarks face_landmarks pose_landmarks world_landmarks segmentation_mask image_transformed multi_face_geometry".split(" "),outs:{image:{type:"texture",stream:"image_transformed"},leftHandLandmarks:{type:"proto",stream:"left_hand_landmarks",transform:Pt},rightHandLandmarks:{type:"proto",stream:"right_hand_landmarks",transform:Pt},faceLandmarks:{type:"proto",stream:"face_landmarks",transform:Pt},poseLandmarks:{type:"proto",stream:"pose_landmarks",transform:Pt},ea:{type:"proto",stream:"world_landmarks",transform:Pt},segmentationMask:{type:"texture",stream:"segmentation_mask"},multiFaceGeometry:{type:"proto_list",stream:"multi_face_geometry",transform:Jt}}}],options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},enableFaceGeometry:{type:0,graphOptionXref:{calculatorName:"EnableFaceGeometryConstant",calculatorType:"ConstantSidePacketCalculator",fieldName:"bool_value"}},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},modelComplexity:{type:1,default:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(e){var n,r,i,o;return T((function(a){if(1==a.g){switch(n="",e){case 1:n="pose_landmark_full.tflite";break;case 2:n="pose_landmark_heavy.tflite";break;default:n="pose_landmark_lite.tflite"}return r="third_party/mediapipe/modules/pose_landmark/"+n,i=t.g.locateFile(n,""),y(a,fetch(i),3)}return 2!=a.g?y(a,a.h.arrayBuffer(),2):(o=a.h,t.g.overrideFile(r,o),y(a,t.g.reset(),0))}))}},smoothLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothLandmarks",fieldName:"bool_value"}},enableSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorEnableSegmentation",fieldName:"bool_value"}},smoothSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothSegmentation",fieldName:"bool_value"}},refineFaceLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorRefineFaceLandmarks",fieldName:"bool_value"}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"holisticlandmarkgpu__poselandmarkgpu__posedetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"holisticlandmarkgpu__poselandmarkgpu__poselandmarkbyroigpu__tensorstoposelandmarksandsegmentation__ThresholdingCalculator",fieldName:"threshold"}},cameraNear:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"near"}},cameraFar:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"far"}},cameraVerticalFovDegrees:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"vertical_fov_degrees"}}}})}(t=Ut.prototype).close=function(){return this.i&&this.i.delete(),e.resolve()},t.reset=function(){var e=this;return T((function(t){e.i&&(e.i.reset(),e.m={},e.s={}),t.g=0}))},t.setOptions=function(e,t){var n=this;if(t=t||this.g.options){for(var r=[],i=[],o={},a=s(Object.keys(e)),c=a.next();!c.done;o={K:o.K,L:o.L},c=a.next()){var u=c.value;u in this.j&&this.j[u]===e[u]||(this.j[u]=e[u],void 0!==(c=t[u])&&(c.onChange&&(o.K=c.onChange,o.L=e[u],r.push(function(e){return function(){return T((function(t){if(1==t.g)return y(t,e.K(e.L),2);!0===t.h&&(n.o=!0),t.g=0}))}}(o))),c.graphOptionXref&&(u={valueNumber:1===c.type?e[u]:0,valueBoolean:0===c.type&&e[u],valueString:2===c.type?e[u]:""},c=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),c.graphOptionXref),u),i.push(c))))}(0!==r.length||0!==i.length)&&(this.o=!0,this.A=(void 0===this.A?[]:this.A).concat(i),this.v=(void 0===this.v?[]:this.v).concat(r))}},t.initialize=function(){var e=this;return T((function(t){return 1==t.g?y(t,Xt(e),2):3!=t.g?y(t,function(e){var t,n,r,i,o,a,c,u;return T((function(d){if(1==d.g)return e.g.graph&&e.g.graph.url&&e.P===e.g.graph.url?d.return():(e.o=!0,e.g.graph&&e.g.graph.url?(e.P=e.g.graph.url,y(d,Bt(e,e.g.graph.url),3)):void(d.g=2));for(2!=d.g&&(t=d.h,e.i.loadGraph(t)),n=s(Object.keys(e.B)),r=n.next();!r.done;r=n.next())i=r.value,e.i.overrideFile(i,e.B[i]);if(e.B={},e.g.listeners)for(o=s(e.g.listeners),a=o.next();!a.done;a=o.next())c=a.value,Yt(e,c);u=e.j,e.j={},e.setOptions(u),d.g=0}))}(e),3):y(t,function(e){var t,n,r,i,o,a;return T((function(c){switch(c.g){case 1:if(!e.o)return c.return();if(!e.v){c.g=2;break}t=s(e.v),n=t.next();case 3:if(n.done){c.g=5;break}return y(c,(0,n.value)(),4);case 4:n=t.next(),c.g=3;break;case 5:e.v=void 0;case 2:if(e.A){for(r=new e.h.GraphOptionChangeRequestList,i=s(e.A),o=i.next();!o.done;o=i.next())a=o.value,r.push_back(a);e.i.changeOptions(r),r.delete(),e.A=void 0}e.o=!1,c.g=0}}))}(e),0)}))},t.overrideFile=function(e,t){this.i?this.i.overrideFile(e,t):this.B[e]=t},t.clearOverriddenFiles=function(){this.B={},this.i&&this.i.clearOverriddenFiles()},t.send=function(e,t){var n,r,i,o,a,c,u,d,l,f=this;return T((function(p){switch(p.g){case 1:return f.g.inputs?(n=1e3*(null==t?performance.now():t),y(p,f.C,2)):p.return();case 2:return y(p,f.initialize(),3);case 3:for(r=new f.h.PacketDataList,i=s(Object.keys(e)),o=i.next();!o.done;o=i.next())if(a=o.value,c=f.g.inputs[a]){e:{var h=e[a];switch(c.type){case"video":var m=f.m[c.stream];if(m||(m=new Dt(f.h,f.D),f.m[c.stream]=m),0===m.l&&(m.l=m.h.createTexture()),typeof HTMLVideoElement<"u"&&h instanceof HTMLVideoElement)var g=h.videoWidth,v=h.videoHeight;else typeof HTMLImageElement<"u"&&h instanceof HTMLImageElement?(g=h.naturalWidth,v=h.naturalHeight):(g=h.width,v=h.height);v={glName:m.l,width:g,height:v},(g=m.g).canvas.width=v.width,g.canvas.height=v.height,g.activeTexture(g.TEXTURE0),m.h.bindTexture2d(m.l),g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,h),m.h.bindTexture2d(0),m=v;break e;case"detections":for((m=f.m[c.stream])||(m=new jt(f.h),f.m[c.stream]=m),m.data||(m.data=new m.g.DetectionListData),m.data.reset(h.length),v=0;v<h.length;++v){g=h[v];var b=m.data,S=b.setBoundingBox,E=v,_=g.T,T=new vt;if(xe(T,1,_.X),xe(T,2,_.Y),xe(T,3,_.height),xe(T,4,_.width),xe(T,5,_.rotation),xe(T,6,_.W),_=Ze(T,yt),S.call(b,E,_),g.O)for(b=0;b<g.O.length;++b){var R=!!(T=g.O[b]).visibility;E=(S=m.data).addNormalizedLandmark,_=v,T=Object.assign(Object.assign({},T),{visibility:R?T.visibility:0}),xe(R=new ut,1,T.x),xe(R,2,T.y),xe(R,3,T.z),T.visibility&&xe(R,4,T.visibility),T=Ze(R,dt),E.call(S,_,T)}if(g.M)for(b=0;b<g.M.length;++b)E=(S=m.data).addClassification,_=v,T=g.M[b],xe(R=new tt,2,T.score),T.index&&xe(R,1,T.index),T.label&&xe(R,3,T.label),T.displayName&&xe(R,4,T.displayName),T=Ze(R,nt),E.call(S,_,T)}m=m.data;break e;default:m={}}}switch(u=m,d=c.stream,c.type){case"video":r.pushTexture2d(Object.assign(Object.assign({},u),{stream:d,timestamp:n}));break;case"detections":(l=u).stream=d,l.timestamp=n,r.pushDetectionList(l);break;default:throw Error("Unknown input config type: '"+c.type+"'")}}return f.i.send(r),y(p,f.C,4);case 4:r.delete(),p.g=0}}))},t.onResults=function(e,t){this.listeners[t||"$"]=e},w("Solution",Ut),w("OptionType",{BOOL:0,NUMBER:1,Z:2,0:"BOOL",1:"NUMBER",2:"STRING"}),(t=Kt.prototype).close=function(){return this.g.close(),e.resolve()},t.onResults=function(e){this.g.onResults(e)},t.initialize=function(){var e=this;return T((function(t){return y(t,e.g.initialize(),0)}))},t.reset=function(){this.g.reset()},t.send=function(e){var t=this;return T((function(n){return y(n,t.g.send(e),0)}))},t.setOptions=function(e){this.g.setOptions(e)},w("Holistic",Kt),w("FACE_GEOMETRY",{Layout:{COLUMN_MAJOR:0,ROW_MAJOR:1,0:"COLUMN_MAJOR",1:"ROW_MAJOR"},PrimitiveType:{TRIANGLE:0,0:"TRIANGLE"},VertexType:{VERTEX_PT:0,0:"VERTEX_PT"},DEFAULT_CAMERA_PARAMS:{verticalFovDegrees:63,near:1,far:1e4}}),w("FACEMESH_LIPS",wt),w("FACEMESH_LEFT_EYE",Ct),w("FACEMESH_LEFT_EYEBROW",Ot),w("FACEMESH_LEFT_IRIS",[[474,475],[475,476],[476,477],[477,474]]),w("FACEMESH_RIGHT_EYE",At),w("FACEMESH_RIGHT_EYEBROW",xt),w("FACEMESH_RIGHT_IRIS",[[469,470],[470,471],[471,472],[472,469]]),w("FACEMESH_FACE_OVAL",kt),w("FACEMESH_CONTOURS",Nt),w("FACEMESH_TESSELATION",[[127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]]),w("HAND_CONNECTIONS",[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]]),w("POSE_CONNECTIONS",[[0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]]),w("POSE_LANDMARKS",{NOSE:0,LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,LEFT_EAR:7,RIGHT_EAR:8,LEFT_RIGHT:9,RIGHT_LEFT:10,LEFT_SHOULDER:11,RIGHT_SHOULDER:12,LEFT_ELBOW:13,RIGHT_ELBOW:14,LEFT_WRIST:15,RIGHT_WRIST:16,LEFT_PINKY:17,RIGHT_PINKY:18,LEFT_INDEX:19,RIGHT_INDEX:20,LEFT_THUMB:21,RIGHT_THUMB:22,LEFT_HIP:23,RIGHT_HIP:24,LEFT_KNEE:25,RIGHT_KNEE:26,LEFT_ANKLE:27,RIGHT_ANKLE:28,LEFT_HEEL:29,RIGHT_HEEL:30,LEFT_FOOT_INDEX:31,RIGHT_FOOT_INDEX:32}),w("POSE_LANDMARKS_LEFT",{LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,LEFT_EAR:7,LEFT_RIGHT:9,LEFT_SHOULDER:11,LEFT_ELBOW:13,LEFT_WRIST:15,LEFT_PINKY:17,LEFT_INDEX:19,LEFT_THUMB:21,LEFT_HIP:23,LEFT_KNEE:25,LEFT_ANKLE:27,LEFT_HEEL:29,LEFT_FOOT_INDEX:31}),w("POSE_LANDMARKS_RIGHT",{RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,RIGHT_EAR:8,RIGHT_LEFT:10,RIGHT_SHOULDER:12,RIGHT_ELBOW:14,RIGHT_WRIST:16,RIGHT_PINKY:18,RIGHT_INDEX:20,RIGHT_THUMB:22,RIGHT_HIP:24,RIGHT_KNEE:26,RIGHT_ANKLE:28,RIGHT_HEEL:30,RIGHT_FOOT_INDEX:32}),w("POSE_LANDMARKS_NEUTRAL",{NOSE:0}),w("matrixDataToMatrix",(function(e){for(var t=e.getCols(),n=e.getRows(),r=e.getPackedDataList(),i=[],o=0;o<n;o++)i.push(Array(t));for(o=0;o<n;o++)for(var a=0;a<t;a++){var s=1===e.getLayout()?o*t+a:a*n+o;i[o][a]=r[s]}return i})),w("VERSION","0.5.1635989137")}).call(Te);const Re={};(function(){var t;function n(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var r="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},i=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof(void 0!==typeof window?window:global)&&(void 0!==typeof window?window:global)];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function o(e,t){if(t)e:{var n=i;e=e.split(".");for(var o=0;o<e.length-1;o++){var a=e[o];if(!(a in n))break e;n=n[a]}(t=t(o=n[e=e[e.length-1]]))!=o&&null!=t&&r(n,e,{configurable:!0,writable:!0,value:t})}}function a(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function s(e){var t=typeof Symbol<"u"&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:n(e)}}function c(e){if(!(e instanceof Array)){e=s(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}o("Symbol",(function(e){function t(e,t){this.g=e,r(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.g};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",i=0;return function e(r){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(r||"")+"_"+i++,r)}})),o("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),o=0;o<t.length;o++){var s=i[t[o]];"function"==typeof s&&"function"!=typeof s.prototype[e]&&r(s.prototype,e,{configurable:!0,writable:!0,value:function(){return a(n(this))}})}return e}));var u,d="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)u=Object.setPrototypeOf;else{var l;e:{var f={};try{f.__proto__={a:!0},l=f.a;break e}catch{}l=!1}u=l?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var p=u;function h(e,t){if(e.prototype=d(t.prototype),e.prototype.constructor=e,p)p(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var r=Object.getOwnPropertyDescriptor(t,n);r&&Object.defineProperty(e,n,r)}else e[n]=t[n];e.na=t.prototype}function m(){this.l=!1,this.i=null,this.h=void 0,this.g=1,this.u=this.o=0,this.j=null}function g(e){if(e.l)throw new TypeError("Generator is already running");e.l=!0}function v(e,t){e.j={da:t,ea:!0},e.g=e.o||e.u}function y(e,t,n){return e.g=n,{value:t}}function b(e){this.g=new m,this.h=e}function S(e,t,n,r){try{var i=t.call(e.g.i,n);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return e.g.l=!1,i;var o=i.value}catch(t){return e.g.i=null,v(e.g,t),E(e)}return e.g.i=null,r.call(e.g,o),E(e)}function E(e){for(;e.g.g;)try{var t=e.h(e.g);if(t)return e.g.l=!1,{value:t.value,done:!1}}catch(t){e.g.h=void 0,v(e.g,t)}if(e.g.l=!1,e.g.j){if(t=e.g.j,e.g.j=null,t.ea)throw t.da;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function _(e){this.next=function(t){return g(e.g),e.g.i?t=S(e,e.g.i.next,t,e.g.s):(e.g.s(t),t=E(e)),t},this.throw=function(t){return g(e.g),e.g.i?t=S(e,e.g.i.throw,t,e.g.s):(v(e.g,t),t=E(e)),t},this.return=function(t){return function(e,t){g(e.g);var n=e.g.i;return n?S(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),E(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function T(t){return function(t){function n(e){return t.next(e)}function r(e){return t.throw(e)}return new e((function(i,o){!function t(a){a.done?i(a.value):e.resolve(a.value).then(n,r).then(t,o)}(t.next())}))}(new _(new b(t)))}m.prototype.s=function(e){this.h=e},m.prototype.return=function(e){this.j={return:e},this.g=this.u},o("Promise",(function(e){function t(e){this.h=0,this.i=void 0,this.g=[],this.s=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function n(){this.g=null}function r(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;n.prototype.h=function(e){if(null==this.g){this.g=[];var t=this;this.i((function(){t.l()}))}this.g.push(e)};var o=i.setTimeout;n.prototype.i=function(e){o(e,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.j(e)}}}this.g=null},n.prototype.j=function(e){this.i((function(){throw e}))},t.prototype.j=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.D),reject:e(this.l)}},t.prototype.D=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.H(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.A(e):this.o(e)}},t.prototype.A=function(e){var t=void 0;try{t=e.then}catch(e){return void this.l(e)}"function"==typeof t?this.I(t,e):this.o(e)},t.prototype.l=function(e){this.u(2,e)},t.prototype.o=function(e){this.u(1,e)},t.prototype.u=function(e,t){if(0!=this.h)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.h);this.h=e,this.i=t,2===this.h&&this.G(),this.B()},t.prototype.G=function(){var e=this;o((function(){if(e.C()){var t=i.console;typeof t<"u"&&t.error(e.i)}}),1)},t.prototype.C=function(){if(this.s)return!1;var e=i.CustomEvent,t=i.Event,n=i.dispatchEvent;return typeof n>"u"||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=i.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.i,n(e))},t.prototype.B=function(){if(null!=this.g){for(var e=0;e<this.g.length;++e)a.h(this.g[e]);this.g=null}};var a=new n;return t.prototype.H=function(e){var t=this.j();e.M(t.resolve,t.reject)},t.prototype.I=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(e){o(e)}}:t}var i,o,a=new t((function(e,t){i=e,o=t}));return this.M(r(e,i),r(n,o)),a},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.M=function(e,t){function n(){switch(r.h){case 1:e(r.i);break;case 2:t(r.i);break;default:throw Error("Unexpected state: "+r.h)}}var r=this;null==this.g?a.h(n):this.g.push(n),this.s=!0},t.resolve=r,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var i=s(e),o=i.next();!o.done;o=i.next())r(o.value).M(t,n)}))},t.all=function(e){var n=s(e),i=n.next();return i.done?r([]):new t((function(e,t){function o(t){return function(n){a[t]=n,0==--s&&e(a)}}var a=[],s=0;do{a.push(void 0),s++,r(i.value).M(o(a.length-1),t),i=n.next()}while(!i.done)}))},t}));var R="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e};o("Object.assign",(function(e){return e||R})),o("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}})),o("Array.prototype.includes",(function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var r=n.length;for(0>(t=t||0)&&(t=Math.max(t+r,0));t<r;t++){var i=n[t];if(i===e||Object.is(i,e))return!0}return!1}})),o("String.prototype.includes",(function(e){return e||function(e,t){if(null==this)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return-1!==this.indexOf(e,t||0)}})),o("Array.prototype.keys",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,(function(e){return e}))}}));var I=this||self;function w(e,t){e=e.split(".");var n,r=I;e[0]in r||typeof r.execScript>"u"||r.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)e.length||void 0===t?r=r[n]&&r[n]!==Object.prototype[n]?r[n]:r[n]={}:r[n]=t}function C(){throw Error("Invalid UTF8")}function O(e,t){return t=String.fromCharCode.apply(null,t),null==e?t:e+t}var A,x,k=typeof TextDecoder<"u",N=typeof TextEncoder<"u",L={},M=null;function V(e){var t;void 0===t&&(t=0),D(),t=L[t];for(var n=Array(Math.floor(e.length/3)),r=t[64]||"",i=0,o=0;i<e.length-2;i+=3){var a=e[i],s=e[i+1],c=e[i+2],u=t[a>>2];a=t[(3&a)<<4|s>>4],s=t[(15&s)<<2|c>>6],c=t[63&c],n[o++]=u+a+s+c}switch(u=0,c=r,e.length-i){case 2:c=t[(15&(u=e[i+1]))<<2]||r;case 1:e=e[i],n[o]=t[e>>2]+t[(3&e)<<4|u>>4]+c+r}return n.join("")}function P(e){var t=e.length,n=3*t/4;n%3?n=Math.floor(n):-1!="=.".indexOf(e[t-1])&&(n=-1!="=.".indexOf(e[t-2])?n-2:n-1);var r=new Uint8Array(n),i=0;return function(e,t){function n(t){for(;r<e.length;){var n=e.charAt(r++),i=M[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return t}D();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;t(i<<2|o>>4),64!=a&&(t(o<<4&240|a>>2),64!=s&&t(a<<6&192|s))}}(e,(function(e){r[i++]=e})),i!==n?r.subarray(0,i):r}function D(){if(!M){M={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++){var r=e.concat(t[n].split(""));L[n]=r;for(var i=0;i<r.length;i++){var o=r[i];void 0===M[o]&&(M[o]=i)}}}}var Z,j="function"==typeof Uint8Array;function W(e){return j&&null!=e&&e instanceof Uint8Array}function G(e){if(this.L=e,null!==e&&0===e.length)throw Error("ByteString should be constructed with non-empty values")}var F="function"==typeof Uint8Array.prototype.slice,U=0;function X(e,t){return Error("Invalid wire type: "+e+" (at position "+t+")")}function B(){return Error("Failed to read varint, encoding is invalid.")}function H(e,t){t=void 0!==(t=void 0===t?{}:t).v&&t.v,this.h=null,this.g=this.i=this.j=0,this.v=t,e&&Y(this,e)}function Y(e,t){e.h=function(e,t){if(e.constructor===Uint8Array)return e;if(e.constructor===ArrayBuffer)return new Uint8Array(e);if(e.constructor===Array)return new Uint8Array(e);if(e.constructor===String)return P(e);if(e.constructor===G)return!t&&(t=e.L)&&t.constructor===Uint8Array?t:(t=null==(t=e.L)||W(t)?t:"string"==typeof t?P(t):null,(e=e.L=t)?new Uint8Array(e):Z||(Z=new Uint8Array(0)));if(e instanceof Uint8Array)return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, or Array of numbers")}(t,e.v),e.j=0,e.i=e.h.length,e.g=e.j}function J(e){if(e.g>e.i)throw Error("Tried to read past the end of the data "+e.g+" > "+e.i)}function z(e){var t=e.h,n=t[e.g],r=127&n;if(128>n)return e.g+=1,J(e),r;if(r|=(127&(n=t[e.g+1]))<<7,128>n)return e.g+=2,J(e),r;if(r|=(127&(n=t[e.g+2]))<<14,128>n)return e.g+=3,J(e),r;if(r|=(127&(n=t[e.g+3]))<<21,128>n)return e.g+=4,J(e),r;if(n=t[e.g+4],e.g+=5,r|=(15&n)<<28,128>n)return J(e),r;if(128<=t[e.g++]&&128<=t[e.g++]&&128<=t[e.g++]&&128<=t[e.g++]&&128<=t[e.g++])throw B();return J(e),r}H.prototype.reset=function(){this.g=this.j};var K=[];function Q(){this.g=[]}function q(e,t){for(;127<t;)e.g.push(127&t|128),t>>>=7;e.g.push(t)}function $(e){var t={},n=void 0!==t.W&&t.W;this.l={v:void 0!==t.v&&t.v},this.W=n,t=this.l,K.length?(n=K.pop(),t&&(n.v=t.v),e&&Y(n,e),e=n):e=new H(e,t),this.g=e,this.j=this.g.g,this.h=this.i=-1}function ee(e){var t=e.g;if(t.g==t.i)return!1;e.j=e.g.g;var n=z(e.g)>>>0;if(t=n>>>3,!(0<=(n&=7)&&5>=n))throw X(n,e.j);if(1>t)throw Error("Invalid field number: "+t+" (at position "+e.j+")");return e.i=t,e.h=n,!0}function te(e){switch(e.h){case 0:if(0!=e.h)te(e);else e:{for(var t=(e=e.g).g,n=t+10;t<n;)if(0==(128&e.h[t++])){e.g=t,J(e);break e}throw B()}break;case 1:(e=e.g).g+=8,J(e);break;case 2:2!=e.h?te(e):(t=z(e.g)>>>0,(e=e.g).g+=t,J(e));break;case 5:(e=e.g).g+=4,J(e);break;case 3:for(t=e.i;;){if(!ee(e))throw Error("Unmatched start-group tag: stream EOF");if(4==e.h){if(e.i!=t)throw Error("Unmatched end-group tag");break}te(e)}break;default:throw X(e.h,e.j)}}Q.prototype.length=function(){return this.g.length},Q.prototype.end=function(){var e=this.g;return this.g=[],e},$.prototype.reset=function(){this.g.reset(),this.j=this.g.g,this.h=this.i=-1};var ne=[];function re(){this.i=[],this.h=0,this.g=new Q}function ie(e,t){0!==t.length&&(e.i.push(t),e.h+=t.length)}var oe="function"==typeof Symbol&&"symbol"==typeof Symbol()?Symbol(void 0):void 0;function ae(e,t){Object.isFrozen(e)||(oe?e[oe]|=t:void 0!==e.N?e.N|=t:Object.defineProperties(e,{N:{value:t,configurable:!0,writable:!0,enumerable:!1}}))}function se(e){var t;return null==(t=oe?e[oe]:e.N)?0:t}function ce(e){return ae(e,1),e}function ue(e){return!!Array.isArray(e)&&!!(2&se(e))}function de(e){if(!Array.isArray(e))throw Error("cannot mark non-array as immutable");ae(e,2)}function le(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)&&e.constructor===Object}var fe=Object.freeze(ce([]));function pe(e){if(ue(e.m))throw Error("Cannot mutate an immutable Message")}var he,me=typeof Symbol<"u"&&typeof Symbol.hasInstance<"u";function ge(e){return{value:e,configurable:!1,writable:!1,enumerable:!1}}function ve(e,t,n){return-1===t?null:t>=e.i?e.g?e.g[t]:void 0:void 0!==n&&n&&e.g&&null!=(n=e.g[t])?n:e.m[t+e.h]}function ye(e,t,n,r){r=void 0!==r&&r,pe(e),t<e.i&&!r?e.m[t+e.h]=n:(e.g||(e.g=e.m[e.i+e.h]={}))[t]=n}function be(e,t,n,r){n=void 0===n||n;var i=ve(e,t,r=void 0!==r&&r);return null==i&&(i=fe),ue(e.m)?n&&(de(i),Object.freeze(i)):(i===fe||ue(i))&&ye(e,t,i=ce(i.slice()),r),i}function Se(e,t,n){return null==(e=null==(e=ve(e,t))?e:+e)?void 0===n?0:n:e}function Ee(e,t,n,r){e.j||(e.j={});var i=ue(e.m),o=e.j[n];if(!o){r=be(e,n,!0,void 0!==r&&r),o=[],i=i||ue(r);for(var a=0;a<r.length;a++)o[a]=new t(r[a]),i&&de(o[a].m);i&&(de(o),Object.freeze(o)),e.j[n]=o}return o}function _e(e,t,n,r,i){var o=void 0!==o&&o;return pe(e),o=Ee(e,n,t,o),n=r||new n,e=be(e,t),null!=i?(o.splice(i,0,n),e.splice(i,0,n.m)):(o.push(n),e.push(n.m)),n}function Te(e,t){return null==(e=ve(e,t))?0:e}function Re(e,t){return null==(e=ve(e,t))?"":e}function Ie(e){var t=Oe;return Ce(e,t=void 0===t?Ae:t)}function we(e,t){if(null!=e){if(Array.isArray(e))e=Ce(e,t);else if(le(e)){var n,r={};for(n in e)r[n]=we(e[n],t);e=r}else e=t(e);return e}}function Ce(e,t){for(var n=e.slice(),r=0;r<n.length;r++)n[r]=we(n[r],t);return Array.isArray(e)&&1&se(e)&&ce(n),n}function Oe(e){return e&&"object"==typeof e&&e.toJSON?e.toJSON():(e=function(e){switch(typeof e){case"number":return isFinite(e)?e:String(e);case"object":if(e&&!Array.isArray(e)){if(W(e))return V(e);if(e instanceof G){var t=e.L;return t=null==t||"string"==typeof t?t:j&&t instanceof Uint8Array?V(t):null,(e.L=t)||""}}}return e}(e),Array.isArray(e)?Ie(e):e)}function Ae(e){return W(e)?new Uint8Array(e):e}function xe(e,t,n){e||(e=he),he=null;var r=this.constructor.h;if(e||(e=r?[r]:[]),this.h=(r?0:-1)-(this.constructor.g||0),this.j=void 0,this.m=e,e=(r=this.m.length)-1,r&&le(r=this.m[e])?(this.i=e-this.h,this.g=r):void 0!==t&&-1<t?(this.i=Math.max(t,e+1-this.h),this.g=void 0):this.i=Number.MAX_VALUE,n)for(t=0;t<n.length;t++)if((e=n[t])<this.i)e+=this.h,(r=this.m[e])?Array.isArray(r)&&ce(r):this.m[e]=fe;else{var i=(r=this.g||(this.g=this.m[this.i+this.h]={}))[e];i?Array.isArray(i)&&ce(i):r[e]=fe}}function ke(){xe.apply(this,arguments)}if(xe.prototype.toJSON=function(){return Ie(this.m)},xe.prototype.toString=function(){return this.m.toString()},h(ke,xe),me){var Ne={};Object.defineProperties(ke,(Ne[Symbol.hasInstance]=ge((function(){throw Error("Cannot perform instanceof checks for MutableMessage")})),Ne))}function Le(e,t,n){if(n){var r,i={};for(r in n){var o=n[r],a=o.ha;a||(i.F=o.la||o.fa.P,o.aa?(i.U=We(o.aa),a=function(e){return function(t,n,r){return e.F(t,n,r,e.U)}}(i)):o.ca?(i.T=Ge(o.X.g,o.ca),a=function(e){return function(t,n,r){return e.F(t,n,r,e.T)}}(i)):a=i.F,o.ha=a),a(t,e,o.X),i={F:i.F,U:i.U,T:i.T}}}!function(e,t){if(t=t.ba){ie(e,e.g.end());for(var n=0;n<t.length;n++)ie(e,t[n])}}(t,e)}var Me=Symbol();function Ve(e,t,n){return e[Me]||(e[Me]=function(e,r){return t(e,r,n)})}function Pe(e){var t=e[Me];if(!t){var n=$e(e);t=function(e,t){return et(e,t,n)},e[Me]=t}return t}function De(e){var t=function(e){var t=e.aa;return t?Pe(t):(t=e.ka)?Ve(e.X.g,t,e.ca):void 0}(e),n=e.X,r=e.fa.O;return t?function(e,i){return r(e,i,n,t)}:function(e,t){return r(e,t,n)}}function Ze(e,t,n,r,i,o){var a=0;for((e=e()).length&&"number"!=typeof e[0]&&(n(t,e[0]),a++);a<e.length;){n=e[a++];for(var s=a+1;s<e.length&&"number"!=typeof e[s];)s++;var c=e[a++];switch(s-=a){case 0:r(t,n,c);break;case 1:r(t,n,c,e[a++]);break;case 2:i(t,n,c,e[a++],e[a++]);break;case 3:s=e[a++];var u=e[a++],d=e[a++];Array.isArray(d)?i(t,n,c,s,u,d):o(t,n,c,s,u,d);break;case 4:o(t,n,c,e[a++],e[a++],e[a++],e[a++]);break;default:throw Error("unexpected number of binary field arguments: "+s)}}return t}var je=Symbol();function We(e){var t=e[je];if(!t){var n=Ye(e);t=function(e,t){return nt(e,t,n)},e[je]=t}return t}function Ge(e,t){var n=e[je];return n||(n=function(e,n){return Le(e,n,t)},e[je]=n),n}var Fe=Symbol();function Ue(e,t){e.push(t)}function Xe(e,t,n){e.push(t,n.P)}function Be(e,t,n,r,i){var o=We(i),a=n.P;e.push(t,(function(e,t,n){return a(e,t,n,r,o)}))}function He(e,t,n,r,i,o){var a=Ge(r,o),s=n.P;e.push(t,(function(e,t,n){return s(e,t,n,r,a)}))}function Ye(e){return e[Fe]||Ze(e,e[Fe]=[],Ue,Xe,Be,He)}var Je=Symbol();function ze(e,t){e[0]=t}function Ke(e,t,n,r){var i=n.O;e[t]=r?function(e,t,n){return i(e,t,n,r)}:i}function Qe(e,t,n,r,i,o){var a=n.O,s=Pe(i);e[t]=function(e,t,n){return a(e,t,n,r,s,o)}}function qe(e,t,n,r,i,o,a){var s=n.O,c=Ve(r,i,o);e[t]=function(e,t,n){return s(e,t,n,r,c,a)}}function $e(e){return e[Je]||Ze(e,e[Je]={},ze,Ke,Qe,qe)}function et(e,t,n){for(;ee(t)&&4!=t.h;){var r=t.i,i=n[r];if(!i){var o=n[0];o&&(o=o[r])&&(i=n[r]=De(o))}if(!(i&&i(t,e,r)||(i=t,r=e,o=i.j,te(i),i.W))){var a=i.g.h;i=o===(i=i.g.g)?Z||(Z=new Uint8Array(0)):F?a.slice(o,i):new Uint8Array(a.subarray(o,i)),(o=r.ba)?o.push(i):r.ba=[i]}}return e}function tt(e,t,n){if(ne.length){var r=ne.pop();e&&(Y(r.g,e),r.i=-1,r.h=-1),e=r}else e=new $(e);try{return et(new t,e,$e(n))}finally{(t=e.g).h=null,t.j=0,t.i=0,t.g=0,t.v=!1,e.i=-1,e.h=-1,100>ne.length&&ne.push(e)}}function nt(e,t,n){for(var r=n.length,i=r%2==1,o=i?1:0;o<r;o+=2)(0,n[o+1])(t,e,n[o]);Le(e,t,i?n[0]:void 0)}function rt(e,t){var n=new re;nt(e,n,Ye(t)),ie(n,n.g.end()),e=new Uint8Array(n.h);for(var r=(t=n.i).length,i=0,o=0;o<r;o++){var a=t[o];e.set(a,i),i+=a.length}return n.i=[e],e}function it(e,t){return{O:e,P:t}}var ot=it((function(e,t,n){if(5!==e.h)return!1;var r=(e=e.g).h[e.g],i=e.h[e.g+1],o=e.h[e.g+2],a=e.h[e.g+3];return e.g+=4,J(e),e=2*((i=(r<<0|i<<8|o<<16|a<<24)>>>0)>>31)+1,r=i>>>23&255,i&=8388607,ye(t,n,255==r?i?NaN:1/0*e:0==r?e*Math.pow(2,-149)*i:e*Math.pow(2,r-150)*(i+Math.pow(2,23))),!0}),(function(e,t,n){if(null!=(t=ve(t,n))){q(e.g,8*n+5),e=e.g;var r=t;0===(r=(n=0>r?1:0)?-r:r)?U=0<1/r?0:2147483648:isNaN(r)?U=2147483647:34028234663852886e22<r?U=(n<<31|2139095040)>>>0:11754943508222875e-54>r?(r=Math.round(r/Math.pow(2,-149)),U=(n<<31|r)>>>0):(t=Math.floor(Math.log(r)/Math.LN2),r*=Math.pow(2,-t),16777216<=(r=Math.round(8388608*r))&&++t,U=(n<<31|t+127<<23|8388607&r)>>>0),n=U,e.g.push(n>>>0&255),e.g.push(n>>>8&255),e.g.push(n>>>16&255),e.g.push(n>>>24&255)}})),at=it((function(e,t,n){if(0!==e.h)return!1;for(var r=e.g,i=128,o=0,a=e=0;4>a&&128<=i;a++)i=r.h[r.g++],J(r),o|=(127&i)<<7*a;if(128<=i&&(i=r.h[r.g++],J(r),o|=(127&i)<<28,e|=(127&i)>>4),128<=i)for(a=0;5>a&&128<=i;a++)i=r.h[r.g++],J(r),e|=(127&i)<<7*a+3;if(!(128>i))throw B();return r=o>>>0,(e=2147483648&(i=e>>>0))&&(i=~i>>>0,0==(r=1+~r>>>0)&&(i=i+1>>>0)),r=4294967296*i+(r>>>0),ye(t,n,e?-r:r),!0}),(function(e,t,n){if(null!=(t=ve(t,n))&&null!=t){q(e.g,8*n),e=e.g;var r=t;for(n=0>r,t=(r=Math.abs(r))>>>0,r=Math.floor((r-t)/4294967296),r>>>=0,n&&(r=~r>>>0,4294967295<(t=1+(~t>>>0))&&(t=0,4294967295<++r&&(r=0))),n=U=t,t=r;0<t||127<n;)e.g.push(127&n|128),n=(n>>>7|t<<25)>>>0,t>>>=7;e.g.push(n)}})),st=it((function(e,t,n){return 0===e.h&&(ye(t,n,z(e.g)),!0)}),(function(e,t,n){if(null!=(t=ve(t,n))&&null!=t)if(q(e.g,8*n),e=e.g,0<=(n=t))q(e,n);else{for(t=0;9>t;t++)e.g.push(127&n|128),n>>=7;e.g.push(1)}})),ct=it((function(e,t,n){if(2!==e.h)return!1;var r,i=z(e.g)>>>0,o=(e=e.g).g;if(e.g+=i,J(e),e=e.h,k)(r=A)||(r=A=new TextDecoder("utf-8",{fatal:!0})),r=r.decode(e.subarray(o,o+i));else{i=o+i;for(var a,s,c,u=[],d=null;o<i;)128>(a=e[o++])?u.push(a):224>a?o>=i?C():(s=e[o++],194>a||128!=(192&s)?(o--,C()):u.push((31&a)<<6|63&s)):240>a?o>=i-1?C():128!=(192&(s=e[o++]))||224===a&&160>s||237===a&&160<=s||128!=(192&(r=e[o++]))?(o--,C()):u.push((15&a)<<12|(63&s)<<6|63&r):244>=a?o>=i-2?C():128!=(192&(s=e[o++]))||s-144+(a<<28)>>30!=0||128!=(192&(r=e[o++]))||128!=(192&(c=e[o++]))?(o--,C()):(a=(7&a)<<18|(63&s)<<12|(63&r)<<6|63&c,a-=65536,u.push(55296+(a>>10&1023),56320+(1023&a))):C(),8192<=u.length&&(d=O(d,u),u.length=0);r=O(d,u)}return ye(t,n,r),!0}),(function(e,t,n){if(null!=(t=ve(t,n))){var r=!1;if(r=void 0!==r&&r,N){if(r&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(t))throw Error("Found an unpaired surrogate");t=(x||(x=new TextEncoder)).encode(t)}else{for(var i=0,o=new Uint8Array(3*t.length),a=0;a<t.length;a++){var s=t.charCodeAt(a);if(128>s)o[i++]=s;else{if(2048>s)o[i++]=s>>6|192;else{if(55296<=s&&57343>=s){if(56319>=s&&a<t.length){var c=t.charCodeAt(++a);if(56320<=c&&57343>=c){s=1024*(s-55296)+c-56320+65536,o[i++]=s>>18|240,o[i++]=s>>12&63|128,o[i++]=s>>6&63|128,o[i++]=63&s|128;continue}a--}if(r)throw Error("Found an unpaired surrogate");s=65533}o[i++]=s>>12|224,o[i++]=s>>6&63|128}o[i++]=63&s|128}}t=o.subarray(0,i)}q(e.g,8*n+2),q(e.g,t.length),ie(e,e.g.end()),ie(e,t)}})),ut=it((function(e,t,n,r,i){if(2!==e.h)return!1;t=_e(t,n,r),n=e.g.i,r=z(e.g)>>>0;var o=e.g.g+r,a=o-n;if(0>=a&&(e.g.i=o,i(t,e),a=o-e.g.g),a)throw Error("Message parsing ended unexpectedly. Expected to read "+r+" bytes, instead read "+(r-a)+" bytes, either the data ended unexpectedly or the message misreported its own length");return e.g.g=o,e.g.i=n,!0}),(function(e,t,n,r,i){if(null!=(t=Ee(t,r,n)))for(r=0;r<t.length;r++){var o=e;q(o.g,8*n+2);var a=o.g.end();ie(o,a),a.push(o.h),o=a,i(t[r],e),a=e;var s=o.pop();for(s=a.h+a.g.length()-s;127<s;)o.push(127&s|128),s>>>=7,a.h++;o.push(s),a.h++}}));function dt(){ke.apply(this,arguments)}if(h(dt,ke),me){var lt={};Object.defineProperties(dt,(lt[Symbol.hasInstance]=ge(Object[Symbol.hasInstance]),lt))}function ft(e){dt.call(this,e)}function pt(){return[1,st,2,ot,3,ct,4,ct]}function ht(e){dt.call(this,e,-1,gt)}function mt(){return[1,ut,ft,pt]}h(ft,dt),h(ht,dt),ht.prototype.addClassification=function(e,t){return _e(this,1,ft,e,t),this};var gt=[1];function vt(e){dt.call(this,e)}function yt(){return[1,ot,2,ot,3,ot,4,ot,5,ot]}function bt(e){dt.call(this,e,-1,Et)}function St(){return[1,ut,vt,yt]}h(vt,dt),h(bt,dt);var Et=[1];function _t(e){dt.call(this,e)}function Tt(){return[1,ot,2,ot,3,ot,4,ot,5,ot,6,at]}h(_t,dt);var Rt=[[61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]],It=[[263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]],wt=[[276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]],Ct=[[33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]],Ot=[[46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]],At=[[10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]],xt=[].concat(c(Rt),c(It),c(wt),c(Ct),c(Ot),c(At));function kt(e,t,n){if(n=e.createShader(0===n?e.VERTEX_SHADER:e.FRAGMENT_SHADER),e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw Error("Could not compile WebGL shader.\n\n"+e.getShaderInfoLog(n));return n}function Nt(e){return Ee(e,ft,1).map((function(e){return{index:Te(e,1),ga:Se(e,2),label:null!=ve(e,3)?Re(e,3):void 0,displayName:null!=ve(e,4)?Re(e,4):void 0}}))}function Lt(e){return{x:Se(e,1),y:Se(e,2),z:Se(e,3),visibility:null!=ve(e,4)?Se(e,4):void 0}}function Mt(e,t){this.h=e,this.g=t,this.l=0}function Vt(t,n,r){return function(e,t){var n=e.g;if(void 0===e.o){var r=kt(n,"\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }",0),i=kt(n,"\n  precision mediump float;\n  varying vec2 vTex;\n  uniform sampler2D sampler0;\n  void main(){\n    gl_FragColor = texture2D(sampler0, vTex);\n  }",1),o=n.createProgram();if(n.attachShader(o,r),n.attachShader(o,i),n.linkProgram(o),!n.getProgramParameter(o,n.LINK_STATUS))throw Error("Could not compile WebGL program.\n\n"+n.getProgramInfoLog(o));r=e.o=o,n.useProgram(r),i=n.getUniformLocation(r,"sampler0"),e.j={K:n.getAttribLocation(r,"aVertex"),J:n.getAttribLocation(r,"aTex"),ma:i},e.u=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,e.u),n.enableVertexAttribArray(e.j.K),n.vertexAttribPointer(e.j.K,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),e.s=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,e.s),n.enableVertexAttribArray(e.j.J),n.vertexAttribPointer(e.j.J,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.uniform1i(i,0)}r=e.j,n.useProgram(e.o),n.canvas.width=t.width,n.canvas.height=t.height,n.viewport(0,0,t.width,t.height),n.activeTexture(n.TEXTURE0),e.h.bindTexture2d(t.glName),n.enableVertexAttribArray(r.K),n.bindBuffer(n.ARRAY_BUFFER,e.u),n.vertexAttribPointer(r.K,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(r.J),n.bindBuffer(n.ARRAY_BUFFER,e.s),n.vertexAttribPointer(r.J,2,n.FLOAT,!1,0,0),n.bindFramebuffer(n.DRAW_FRAMEBUFFER?n.DRAW_FRAMEBUFFER:n.FRAMEBUFFER,null),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.colorMask(!0,!0,!0,!0),n.drawArrays(n.TRIANGLE_FAN,0,4),n.disableVertexAttribArray(r.K),n.disableVertexAttribArray(r.J),n.bindBuffer(n.ARRAY_BUFFER,null),e.h.bindTexture2d(0)}(t,n),"function"==typeof t.g.canvas.transferToImageBitmap?e.resolve(t.g.canvas.transferToImageBitmap()):r?e.resolve(t.g.canvas):"function"==typeof createImageBitmap?createImageBitmap(t.g.canvas):(void 0===t.i&&(t.i=document.createElement("canvas")),new e((function(e){t.i.height=t.g.canvas.height,t.i.width=t.g.canvas.width,t.i.getContext("2d",{}).drawImage(t.g.canvas,0,0,t.g.canvas.width,t.g.canvas.height),e(t.i)})))}function Pt(e){this.g=e}var Dt=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function Zt(e,t){return t+e}function jt(e,t){window[e]=t}function Wt(t){if(this.g=t,this.listeners={},this.j={},this.H={},this.o={},this.u={},this.I=this.s=this.Z=!0,this.D=e.resolve(),this.Y="",this.C={},this.locateFile=t&&t.locateFile||Zt,"object"==typeof window)var n=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if(!(typeof location<"u"))throw Error("solutions can only be loaded on a web page or in a web worker");n=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}if(this.$=n,t.options)for(var r=(n=s(Object.keys(t.options))).next();!r.done;r=n.next()){r=r.value;var i=t.options[r].default;void 0!==i&&(this.j[r]="function"==typeof i?i():i)}}function Gt(t){var n,r,i,o,a,s,u,d,l,f,p;return T((function(h){switch(h.g){case 1:return t.Z?(n=void 0===t.g.files?[]:"function"==typeof t.g.files?t.g.files(t.j):t.g.files,y(h,T((function(e){switch(e.g){case 1:return e.o=2,y(e,WebAssembly.instantiate(Dt),4);case 4:e.g=3,e.o=0;break;case 2:return e.o=0,e.j=null,e.return(!1);case 3:return e.return(!0)}})),2)):h.return();case 2:if(r=h.h,"object"==typeof window)return jt("createMediapipeSolutionsWasm",{locateFile:t.locateFile}),jt("createMediapipeSolutionsPackedAssets",{locateFile:t.locateFile}),s=n.filter((function(e){return void 0!==e.data})),u=n.filter((function(e){return void 0===e.data})),d=e.all(s.map((function(n){var r=Ft(t,n.url);if(void 0!==n.path){var i=n.path;r=r.then((function(n){return t.overrideFile(i,n),e.resolve(n)}))}return r}))),l=e.all(u.map((function(n){return void 0===n.simd||n.simd&&r||!n.simd&&!r?function(t){var n=document.createElement("script");return n.setAttribute("src",t),n.setAttribute("crossorigin","anonymous"),new e((function(e){n.addEventListener("load",(function(){e()}),!1),n.addEventListener("error",(function(){e()}),!1),document.body.appendChild(n)}))}(t.locateFile(n.url,t.$)):e.resolve()}))).then((function(){var e,n,r;return T((function(i){if(1==i.g)return e=window.createMediapipeSolutionsWasm,n=window.createMediapipeSolutionsPackedAssets,r=t,y(i,e(n),2);r.h=i.h,i.g=0}))})),f=T((function(e){return t.g.graph&&t.g.graph.url?e=y(e,Ft(t,t.g.graph.url),0):(e.g=0,e=void 0),e})),y(h,e.all([l,d,f]),7);if("function"!=typeof importScripts)throw Error("solutions can only be loaded on a web page or in a web worker");return i=n.filter((function(e){return void 0===e.simd||e.simd&&r||!e.simd&&!r})).map((function(e){return t.locateFile(e.url,t.$)})),importScripts.apply(null,c(i)),o=t,y(h,createMediapipeSolutionsWasm(Module),6);case 6:o.h=h.h,t.l=new OffscreenCanvas(1,1),t.h.canvas=t.l,a=t.h.GL.createContext(t.l,{antialias:!1,alpha:!1,ja:typeof WebGL2RenderingContext<"u"?2:1}),t.h.GL.makeContextCurrent(a),h.g=4;break;case 7:if(t.l=document.createElement("canvas"),!(p=t.l.getContext("webgl2",{}))&&!(p=t.l.getContext("webgl",{})))return alert("Failed to create WebGL canvas context when passing video frame."),h.return();t.G=p,t.h.canvas=t.l,t.h.createContext(t.l,!0,!0,{});case 4:t.i=new t.h.SolutionWasm,t.Z=!1,h.g=0}}))}function Ft(e,t){var n,r;return T((function(i){return t in e.H?i.return(e.H[t]):(n=e.locateFile(t,""),r=fetch(n).then((function(e){return e.arrayBuffer()})),e.H[t]=r,i.return(r))}))}function Ut(e,t,n){var r,i,o,a,c,u,d,l,f,p,h,m,g,v;return T((function(b){switch(b.g){case 1:if(!n)return b.return(t);for(r={},i=0,o=s(Object.keys(n)),a=o.next();!a.done;a=o.next())c=a.value,"string"!=typeof(u=n[c])&&"texture"===u.type&&void 0!==t[u.stream]&&++i;1<i&&(e.I=!1),d=s(Object.keys(n)),a=d.next();case 2:if(a.done){b.g=4;break}if(l=a.value,"string"==typeof(f=n[l]))return g=r,v=l,y(b,function(e,t,n){var r;return T((function(i){return"number"==typeof n||n instanceof Uint8Array||n instanceof e.h.Uint8BlobList?i.return(n):n instanceof e.h.Texture2dDataOut?((r=e.u[t])||(r=new Mt(e.h,e.G),e.u[t]=r),i.return(Vt(r,n,e.I))):i.return(void 0)}))}(e,l,t[f]),14);if(p=t[f.stream],"detection_list"===f.type){if(p){for(var S=p.getRectList(),E=p.getLandmarksList(),_=p.getClassificationsList(),R=[],I=0;I<S.size();++I){var w=tt(S.get(I),_t,Tt);w={boundingBox:{xCenter:Se(w,1),yCenter:Se(w,2),height:Se(w,3),width:Se(w,4),rotation:Se(w,5,0),rectId:Te(w,6)},landmarks:Ee(tt(E.get(I),bt,St),vt,1).map(Lt),V:Nt(tt(_.get(I),ht,mt))},R.push(w)}S=R}else S=[];r[l]=S,b.g=7;break}if("proto_list"===f.type){if(p){for(S=Array(p.size()),E=0;E<p.size();E++)S[E]=p.get(E);p.delete()}else S=[];r[l]=S,b.g=7;break}if(void 0===p){b.g=3;break}if("float_list"===f.type){r[l]=p,b.g=7;break}if("proto"===f.type){r[l]=p,b.g=7;break}if("texture"!==f.type)throw Error("Unknown output config type: '"+f.type+"'");return(h=e.u[l])||(h=new Mt(e.h,e.G),e.u[l]=h),y(b,Vt(h,p,e.I),13);case 13:m=b.h,r[l]=m;case 7:f.transform&&r[l]&&(r[l]=f.transform(r[l])),b.g=3;break;case 14:g[v]=b.h;case 3:a=d.next(),b.g=2;break;case 4:return b.return(r)}}))}function Xt(e,t){for(var n=t.name||"$",r=[].concat(c(t.wants)),i=new e.h.StringList,o=s(t.wants),a=o.next();!a.done;a=o.next())i.push_back(a.value);o=e.h.PacketListener.implement({onResults:function(i){for(var o={},a=0;a<t.wants.length;++a)o[r[a]]=i.get(a);var s=e.listeners[n];s&&(e.D=Ut(e,o,t.outs).then((function(n){n=s(n);for(var i=0;i<t.wants.length;++i){var a=o[r[i]];"object"==typeof a&&a.hasOwnProperty&&a.hasOwnProperty("delete")&&a.delete()}n&&(e.D=n)})))}}),e.i.attachMultiListener(i,o),i.delete()}function Bt(e){var t=this;e=e||{};var n={url:"face_detection_short.binarypb"},r={type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"facedetectionshortrangegpu__facedetectionshortrangecommon__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}};this.g=new Wt({locateFile:e.locateFile,files:[{data:!0,url:"face_detection_short.binarypb"},{data:!0,url:"face_detection_short_range.tflite"},{simd:!0,url:"face_detection_solution_simd_wasm_bin.js"},{simd:!1,url:"face_detection_solution_wasm_bin.js"}],graph:n,listeners:[{wants:["detections","image_transformed"],outs:{image:"image_transformed",detections:{type:"detection_list",stream:"detections"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:"object"==typeof window&&void 0!==window.navigator&&("iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document)},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},model:{type:0,onChange:function(e){var i,o,a,c,u;return T((function(d){switch(d.g){case 1:i=s("short"===e?["face_detection_short_range.tflite"]:["face_detection_full_range_sparse.tflite"]),o=i.next();case 2:if(o.done){d.g=4;break}return a=o.value,c="third_party/mediapipe/modules/face_detection/"+a,y(d,Ft(t.g,a),5);case 5:u=d.h,t.g.overrideFile(c,u),o=i.next(),d.g=2;break;case 4:return n.url="short"===e?"face_detection_short.binarypb":"face_detection_full.binarypb",r.graphOptionXref.calculatorName="short"===e?"facedetectionshortrangegpu__facedetectionshortrangecommon__TensorsToDetectionsCalculator":"facedetectionfullrangegpu__facedetectionfullrangecommon__TensorsToDetectionsCalculator",d.return(!0)}}))}},minDetectionConfidence:r}})}(t=Wt.prototype).close=function(){return this.i&&this.i.delete(),e.resolve()},t.reset=function(){var e=this;return T((function(t){e.i&&(e.i.reset(),e.o={},e.u={}),t.g=0}))},t.setOptions=function(e,t){var n=this;if(t=t||this.g.options){for(var r=[],i=[],o={},a=s(Object.keys(e)),c=a.next();!c.done;o={R:o.R,S:o.S},c=a.next()){var u=c.value;u in this.j&&this.j[u]===e[u]||(this.j[u]=e[u],void 0!==(c=t[u])&&(c.onChange&&(o.R=c.onChange,o.S=e[u],r.push(function(e){return function(){return T((function(t){if(1==t.g)return y(t,e.R(e.S),2);!0===t.h&&(n.s=!0),t.g=0}))}}(o))),c.graphOptionXref&&(u={valueNumber:1===c.type?e[u]:0,valueBoolean:0===c.type&&e[u],valueString:2===c.type?e[u]:""},c=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),c.graphOptionXref),u),i.push(c))))}(0!==r.length||0!==i.length)&&(this.s=!0,this.B=(void 0===this.B?[]:this.B).concat(i),this.A=(void 0===this.A?[]:this.A).concat(r))}},t.initialize=function(){var e=this;return T((function(t){return 1==t.g?y(t,Gt(e),2):3!=t.g?y(t,function(e){var t,n,r,i,o,a,c,u;return T((function(d){if(1==d.g)return e.g.graph&&e.g.graph.url&&e.Y===e.g.graph.url?d.return():(e.s=!0,e.g.graph&&e.g.graph.url?(e.Y=e.g.graph.url,y(d,Ft(e,e.g.graph.url),3)):void(d.g=2));for(2!=d.g&&(t=d.h,e.i.loadGraph(t)),n=s(Object.keys(e.C)),r=n.next();!r.done;r=n.next())i=r.value,e.i.overrideFile(i,e.C[i]);if(e.C={},e.g.listeners)for(o=s(e.g.listeners),a=o.next();!a.done;a=o.next())c=a.value,Xt(e,c);u=e.j,e.j={},e.setOptions(u),d.g=0}))}(e),3):y(t,function(e){var t,n,r,i,o,a;return T((function(c){switch(c.g){case 1:if(!e.s)return c.return();if(!e.A){c.g=2;break}t=s(e.A),n=t.next();case 3:if(n.done){c.g=5;break}return y(c,(0,n.value)(),4);case 4:n=t.next(),c.g=3;break;case 5:e.A=void 0;case 2:if(e.B){for(r=new e.h.GraphOptionChangeRequestList,i=s(e.B),o=i.next();!o.done;o=i.next())a=o.value,r.push_back(a);e.i.changeOptions(r),r.delete(),e.B=void 0}e.s=!1,c.g=0}}))}(e),0)}))},t.overrideFile=function(e,t){this.i?this.i.overrideFile(e,t):this.C[e]=t},t.clearOverriddenFiles=function(){this.C={},this.i&&this.i.clearOverriddenFiles()},t.send=function(e,t){var n,r,i,o,a,c,u,d,l,f=this;return T((function(p){switch(p.g){case 1:return f.g.inputs?(n=1e3*(null==t?performance.now():t),y(p,f.D,2)):p.return();case 2:return y(p,f.initialize(),3);case 3:for(r=new f.h.PacketDataList,i=s(Object.keys(e)),o=i.next();!o.done;o=i.next())if(a=o.value,c=f.g.inputs[a]){e:{var h=e[a];switch(c.type){case"video":var m=f.o[c.stream];if(m||(m=new Mt(f.h,f.G),f.o[c.stream]=m),0===m.l&&(m.l=m.h.createTexture()),typeof HTMLVideoElement<"u"&&h instanceof HTMLVideoElement)var g=h.videoWidth,v=h.videoHeight;else typeof HTMLImageElement<"u"&&h instanceof HTMLImageElement?(g=h.naturalWidth,v=h.naturalHeight):(g=h.width,v=h.height);v={glName:m.l,width:g,height:v},(g=m.g).canvas.width=v.width,g.canvas.height=v.height,g.activeTexture(g.TEXTURE0),m.h.bindTexture2d(m.l),g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,h),m.h.bindTexture2d(0),m=v;break e;case"detections":for((m=f.o[c.stream])||(m=new Pt(f.h),f.o[c.stream]=m),m.data||(m.data=new m.g.DetectionListData),m.data.reset(h.length),v=0;v<h.length;++v){g=h[v];var b=m.data,S=b.setBoundingBox,E=v,_=g.boundingBox,T=new _t;if(ye(T,1,_.xCenter),ye(T,2,_.yCenter),ye(T,3,_.height),ye(T,4,_.width),ye(T,5,_.rotation),ye(T,6,_.rectId),_=rt(T,Tt),S.call(b,E,_),g.landmarks)for(b=0;b<g.landmarks.length;++b){var R=!!(T=g.landmarks[b]).visibility;E=(S=m.data).addNormalizedLandmark,_=v,T=Object.assign(Object.assign({},T),{visibility:R?T.visibility:0}),ye(R=new vt,1,T.x),ye(R,2,T.y),ye(R,3,T.z),T.visibility&&ye(R,4,T.visibility),T=rt(R,yt),E.call(S,_,T)}if(g.V)for(b=0;b<g.V.length;++b)E=(S=m.data).addClassification,_=v,T=g.V[b],ye(R=new ft,2,T.ga),T.index&&ye(R,1,T.index),T.label&&ye(R,3,T.label),T.displayName&&ye(R,4,T.displayName),T=rt(R,pt),E.call(S,_,T)}m=m.data;break e;default:m={}}}switch(u=m,d=c.stream,c.type){case"video":r.pushTexture2d(Object.assign(Object.assign({},u),{stream:d,timestamp:n}));break;case"detections":(l=u).stream=d,l.timestamp=n,r.pushDetectionList(l);break;default:throw Error("Unknown input config type: '"+c.type+"'")}}return f.i.send(r),y(p,f.D,4);case 4:r.delete(),p.g=0}}))},t.onResults=function(e,t){this.listeners[t||"$"]=e},w("Solution",Wt),w("OptionType",{BOOL:0,NUMBER:1,ia:2,0:"BOOL",1:"NUMBER",2:"STRING"}),(t=Bt.prototype).close=function(){return this.g.close(),e.resolve()},t.onResults=function(e){this.g.onResults(e)},t.initialize=function(){var e=this;return T((function(t){return y(t,e.g.initialize(),0)}))},t.reset=function(){this.g.reset()},t.send=function(e){var t=this;return T((function(n){return y(n,t.g.send(e),0)}))},t.setOptions=function(e){this.g.setOptions(e)},w("FaceDetection",Bt),w("FACEDETECTION_LIPS",Rt),w("FACEDETECTION_LEFT_EYE",It),w("FACEDETECTION_LEFT_EYEBROW",wt),w("FACEDETECTION_RIGHT_EYE",Ct),w("FACEDETECTION_RIGHT_EYEBROW",Ot),w("FACEDETECTION_FACE_OVAL",At),w("FACEDETECTION_CONTOURS",xt),w("FACEDETECTION_TESSELATION",[[127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]]),w("VERSION","0.4.1646425229")}).call(Re);const Ie={};(function(){var t;function n(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var r="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},i=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof(void 0!==typeof window?window:global)&&(void 0!==typeof window?window:global)];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function o(e,t){if(t)e:{var n=i;e=e.split(".");for(var o=0;o<e.length-1;o++){var a=e[o];if(!(a in n))break e;n=n[a]}(t=t(o=n[e=e[e.length-1]]))!=o&&null!=t&&r(n,e,{configurable:!0,writable:!0,value:t})}}function a(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function s(e){var t=typeof Symbol<"u"&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:n(e)}}function c(e){if(!(e instanceof Array)){e=s(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}o("Symbol",(function(e){function t(e,t){this.g=e,r(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.g};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",i=0;return function e(r){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(r||"")+"_"+i++,r)}})),o("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),o=0;o<t.length;o++){var s=i[t[o]];"function"==typeof s&&"function"!=typeof s.prototype[e]&&r(s.prototype,e,{configurable:!0,writable:!0,value:function(){return a(n(this))}})}return e}));var u,d="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)u=Object.setPrototypeOf;else{var l;e:{var f={};try{f.__proto__={a:!0},l=f.a;break e}catch{}l=!1}u=l?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var p=u;function h(e,t){if(e.prototype=d(t.prototype),e.prototype.constructor=e,p)p(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var r=Object.getOwnPropertyDescriptor(t,n);r&&Object.defineProperty(e,n,r)}else e[n]=t[n];e.ea=t.prototype}function m(){this.l=!1,this.i=null,this.h=void 0,this.g=1,this.s=this.m=0,this.j=null}function g(e){if(e.l)throw new TypeError("Generator is already running");e.l=!0}function v(e,t){e.j={U:t,V:!0},e.g=e.m||e.s}function y(e,t,n){return e.g=n,{value:t}}function b(e){this.g=new m,this.h=e}function S(e,t,n,r){try{var i=t.call(e.g.i,n);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return e.g.l=!1,i;var o=i.value}catch(t){return e.g.i=null,v(e.g,t),E(e)}return e.g.i=null,r.call(e.g,o),E(e)}function E(e){for(;e.g.g;)try{var t=e.h(e.g);if(t)return e.g.l=!1,{value:t.value,done:!1}}catch(t){e.g.h=void 0,v(e.g,t)}if(e.g.l=!1,e.g.j){if(t=e.g.j,e.g.j=null,t.V)throw t.U;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function _(e){this.next=function(t){return g(e.g),e.g.i?t=S(e,e.g.i.next,t,e.g.o):(e.g.o(t),t=E(e)),t},this.throw=function(t){return g(e.g),e.g.i?t=S(e,e.g.i.throw,t,e.g.o):(v(e.g,t),t=E(e)),t},this.return=function(t){return function(e,t){g(e.g);var n=e.g.i;return n?S(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),E(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function T(e,t){return t=new _(new b(t)),p&&e.prototype&&p(t,e.prototype),t}m.prototype.o=function(e){this.h=e},m.prototype.return=function(e){this.j={return:e},this.g=this.s};var R="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e};o("Object.assign",(function(e){return e||R})),o("Promise",(function(e){function t(e){this.h=0,this.i=void 0,this.g=[],this.o=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function n(){this.g=null}function r(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;n.prototype.h=function(e){if(null==this.g){this.g=[];var t=this;this.i((function(){t.l()}))}this.g.push(e)};var o=i.setTimeout;n.prototype.i=function(e){o(e,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.j(e)}}}this.g=null},n.prototype.j=function(e){this.i((function(){throw e}))},t.prototype.j=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.C),reject:e(this.l)}},t.prototype.C=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.F(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.u(e):this.m(e)}},t.prototype.u=function(e){var t=void 0;try{t=e.then}catch(e){return void this.l(e)}"function"==typeof t?this.G(t,e):this.m(e)},t.prototype.l=function(e){this.s(2,e)},t.prototype.m=function(e){this.s(1,e)},t.prototype.s=function(e,t){if(0!=this.h)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.h);this.h=e,this.i=t,2===this.h&&this.D(),this.A()},t.prototype.D=function(){var e=this;o((function(){if(e.B()){var t=i.console;typeof t<"u"&&t.error(e.i)}}),1)},t.prototype.B=function(){if(this.o)return!1;var e=i.CustomEvent,t=i.Event,n=i.dispatchEvent;return typeof n>"u"||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=i.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.i,n(e))},t.prototype.A=function(){if(null!=this.g){for(var e=0;e<this.g.length;++e)a.h(this.g[e]);this.g=null}};var a=new n;return t.prototype.F=function(e){var t=this.j();e.J(t.resolve,t.reject)},t.prototype.G=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(e){o(e)}}:t}var i,o,a=new t((function(e,t){i=e,o=t}));return this.J(r(e,i),r(n,o)),a},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.J=function(e,t){function n(){switch(r.h){case 1:e(r.i);break;case 2:t(r.i);break;default:throw Error("Unexpected state: "+r.h)}}var r=this;null==this.g?a.h(n):this.g.push(n),this.o=!0},t.resolve=r,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var i=s(e),o=i.next();!o.done;o=i.next())r(o.value).J(t,n)}))},t.all=function(e){var n=s(e),i=n.next();return i.done?r([]):new t((function(e,t){function o(t){return function(n){a[t]=n,0==--s&&e(a)}}var a=[],s=0;do{a.push(void 0),s++,r(i.value).J(o(a.length-1),t),i=n.next()}while(!i.done)}))},t})),o("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}})),o("Array.prototype.includes",(function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var r=n.length;for(0>(t=t||0)&&(t=Math.max(t+r,0));t<r;t++){var i=n[t];if(i===e||Object.is(i,e))return!0}return!1}})),o("String.prototype.includes",(function(e){return e||function(e,t){if(null==this)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return-1!==this.indexOf(e,t||0)}})),o("Array.prototype.keys",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,(function(e){return e}))}}));var I=this||self;function w(e,t){e=e.split(".");var n,r=I;e[0]in r||typeof r.execScript>"u"||r.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)e.length||void 0===t?r=r[n]&&r[n]!==Object.prototype[n]?r[n]:r[n]={}:r[n]=t}function C(e,t){return t=String.fromCharCode.apply(null,t),null==e?t:e+t}var O,A,x=typeof TextDecoder<"u",k=typeof TextEncoder<"u";function N(e){if(k)e=(A||(A=new TextEncoder)).encode(e);else{var t=void 0;t=void 0!==t&&t;for(var n=0,r=new Uint8Array(3*e.length),i=0;i<e.length;i++){var o=e.charCodeAt(i);if(128>o)r[n++]=o;else{if(2048>o)r[n++]=o>>6|192;else{if(55296<=o&&57343>=o){if(56319>=o&&i<e.length){var a=e.charCodeAt(++i);if(56320<=a&&57343>=a){o=1024*(o-55296)+a-56320+65536,r[n++]=o>>18|240,r[n++]=o>>12&63|128,r[n++]=o>>6&63|128,r[n++]=63&o|128;continue}i--}if(t)throw Error("Found an unpaired surrogate");o=65533}r[n++]=o>>12|224,r[n++]=o>>6&63|128}r[n++]=63&o|128}}e=r.subarray(0,n)}return e}var L={},M=null;function V(e,t){void 0===t&&(t=0),D(),t=L[t];for(var n=Array(Math.floor(e.length/3)),r=t[64]||"",i=0,o=0;i<e.length-2;i+=3){var a=e[i],s=e[i+1],c=e[i+2],u=t[a>>2];a=t[(3&a)<<4|s>>4],s=t[(15&s)<<2|c>>6],c=t[63&c],n[o++]=u+a+s+c}switch(u=0,c=r,e.length-i){case 2:c=t[(15&(u=e[i+1]))<<2]||r;case 1:e=e[i],n[o]=t[e>>2]+t[(3&e)<<4|u>>4]+c+r}return n.join("")}function P(e){var t=e.length,n=3*t/4;n%3?n=Math.floor(n):-1!="=.".indexOf(e[t-1])&&(n=-1!="=.".indexOf(e[t-2])?n-2:n-1);var r=new Uint8Array(n),i=0;return function(e,t){function n(t){for(;r<e.length;){var n=e.charAt(r++),i=M[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return t}D();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;t(i<<2|o>>4),64!=a&&(t(o<<4&240|a>>2),64!=s&&t(a<<6&192|s))}}(e,(function(e){r[i++]=e})),r.subarray(0,i)}function D(){if(!M){M={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++){var r=e.concat(t[n].split(""));L[n]=r;for(var i=0;i<r.length;i++){var o=r[i];void 0===M[o]&&(M[o]=i)}}}}var Z,j="function"==typeof Uint8Array.prototype.slice;function W(e,t,n){return t===n?Z||(Z=new Uint8Array(0)):j?e.slice(t,n):new Uint8Array(e.subarray(t,n))}var G=0;function F(e,t){t=void 0!==(t=void 0===t?{}:t).v&&t.v,this.h=null,this.g=this.j=this.l=0,this.m=!1,this.v=t,e&&U(this,e)}function U(e,t){t=t.constructor===Uint8Array?t:t.constructor===ArrayBuffer||t.constructor===Array?new Uint8Array(t):t.constructor===String?P(t):t instanceof Uint8Array?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(0),e.h=t,e.l=0,e.j=e.h.length,e.g=e.l}function X(e){for(var t=128,n=0,r=0,i=0;4>i&&128<=t;i++)n|=(127&(t=e.h[e.g++]))<<7*i;if(128<=t&&(n|=(127&(t=e.h[e.g++]))<<28,r|=(127&t)>>4),128<=t)for(i=0;5>i&&128<=t;i++)r|=(127&(t=e.h[e.g++]))<<7*i+3;if(128>t)return e=n>>>0,(r=2147483648&(t=r>>>0))&&(t=~t>>>0,0==(e=1+~e>>>0)&&(t=t+1>>>0)),e=4294967296*t+(e>>>0),r?-e:e;e.m=!0}F.prototype.reset=function(){this.g=this.l},F.prototype.i=function(){var e=this.h,t=e[this.g],n=127&t;return 128>t?(this.g+=1,n):(n|=(127&(t=e[this.g+1]))<<7,128>t?(this.g+=2,n):(n|=(127&(t=e[this.g+2]))<<14,128>t?(this.g+=3,n):(n|=(127&(t=e[this.g+3]))<<21,128>t?(this.g+=4,n):(n|=(15&(t=e[this.g+4]))<<28,128>t?(this.g+=5,n>>>0):(this.g+=5,128<=e[this.g++]&&128<=e[this.g++]&&128<=e[this.g++]&&128<=e[this.g++]&&this.g++,n)))))},F.prototype.o=function(){var e=this.h[this.g],t=this.h[this.g+1],n=this.h[this.g+2],r=this.h[this.g+3];return this.g+=4,e=2*((n=(e<<0|t<<8|n<<16|r<<24)>>>0)>>31)+1,t=n>>>23&255,n&=8388607,255==t?n?NaN:1/0*e:0==t?e*Math.pow(2,-149)*n:e*Math.pow(2,t-150)*(n+Math.pow(2,23))};var B=[];function H(){this.g=new Uint8Array(64),this.h=0}function Y(e,t){for(;127<t;)e.push(127&t|128),t>>>=7;e.push(t)}function J(e){var t={},n=void 0!==t.N&&t.N;this.o={v:void 0!==t.v&&t.v},this.N=n,t=this.o,B.length?(n=B.pop(),t&&(n.v=t.v),e&&U(n,e),e=n):e=new F(e,t),this.g=e,this.m=this.g.g,this.h=this.i=this.l=-1,this.j=!1}function z(e){var t=e.g;if((t=t.g==t.j)||(t=e.j)||(t=(t=e.g).m||0>t.g||t.g>t.j),t)return!1;e.m=e.g.g;var n=7&(t=e.g.i());return 0!=n&&5!=n&&1!=n&&2!=n&&3!=n&&4!=n?(e.j=!0,!1):(e.i=t,e.l=t>>>3,e.h=n,!0)}function K(e,t,n){var r=e.g.j,i=e.g.i(),o=e.g.g+i;if(e.g.j=o,n(t,e),0!=(n=o-e.g.g))throw Error("Message parsing ended unexpectedly. Expected to read "+i+" bytes, instead read "+(i-n)+" bytes, either the data ended unexpectedly or the message misreported its own length");return e.g.g=o,e.g.j=r,t}function Q(e){return e.g.o()}function q(e){var t,n=e.g.i(),r=(e=e.g).g;if(e.g+=n,e=e.h,x)(t=O)||(t=O=new TextDecoder("utf-8",{fatal:!1})),t=t.decode(e.subarray(r,r+n));else{n=r+n;for(var i,o,a,s=[],c=null;r<n;)128>(i=e[r++])?s.push(i):224>i?r>=n?s.push(65533):(o=e[r++],194>i||128!=(192&o)?(r--,s.push(65533)):s.push((31&i)<<6|63&o)):240>i?r>=n-1?s.push(65533):128!=(192&(o=e[r++]))||224===i&&160>o||237===i&&160<=o||128!=(192&(t=e[r++]))?(r--,s.push(65533)):s.push((15&i)<<12|(63&o)<<6|63&t):244>=i?r>=n-2?s.push(65533):128!=(192&(o=e[r++]))||o-144+(i<<28)>>30!=0||128!=(192&(t=e[r++]))||128!=(192&(a=e[r++]))?(r--,s.push(65533)):(i=(7&i)<<18|(63&o)<<12|(63&t)<<6|63&a,i-=65536,s.push(55296+(i>>10&1023),56320+(1023&i))):s.push(65533),8192<=s.length&&(c=C(c,s),s.length=0);t=C(c,s)}return t}function $(e,t,n){var r=e.g.i();for(r=e.g.g+r;e.g.g<r;)n.push(t.call(e.g))}function ee(e,t){2==e.h?$(e,F.prototype.o,t):t.push(Q(e))}function te(){this.h=[],this.i=0,this.g=new H}function ne(e,t){0!==t.length&&(e.h.push(t),e.i+=t.length)}function re(e){var t=e.i+e.g.length();if(0===t)return new Uint8Array(0);t=new Uint8Array(t);for(var n=e.h,r=n.length,i=0,o=0;o<r;o++){var a=n[o];0!==a.length&&(t.set(a,i),i+=a.length)}return 0!==(r=(n=e.g).h)&&(t.set(n.g.subarray(0,r),i),n.h=0),e.h=[t],t}function ie(e,t,n){if(null!=n){Y(e.g,8*t+5),e=e.g;var r=n;0===(r=(n=0>r?1:0)?-r:r)?G=0<1/r?0:2147483648:isNaN(r)?G=2147483647:34028234663852886e22<r?G=(n<<31|2139095040)>>>0:11754943508222875e-54>r?(r=Math.round(r/Math.pow(2,-149)),G=(n<<31|r)>>>0):(t=Math.floor(Math.log(r)/Math.LN2),r*=Math.pow(2,-t),16777216<=(r=Math.round(8388608*r))&&++t,G=(n<<31|t+127<<23|8388607&r)>>>0),n=G,e.push(n>>>0&255),e.push(n>>>8&255),e.push(n>>>16&255),e.push(n>>>24&255)}}H.prototype.push=function(e){if(!(this.h+1<this.g.length)){var t=this.g;this.g=new Uint8Array(Math.ceil(1+2*this.g.length)),this.g.set(t)}this.g[this.h++]=e},H.prototype.length=function(){return this.h},H.prototype.end=function(){var e=this.g,t=this.h;return this.h=0,W(e,0,t)},J.prototype.reset=function(){this.g.reset(),this.h=this.l=-1};var oe="function"==typeof Uint8Array;function ae(e,t,n){if(null!=e)return"object"==typeof e?oe&&e instanceof Uint8Array?n(e):se(e,t,n):t(e)}function se(e,t,n){if(Array.isArray(e)){for(var r=Array(e.length),i=0;i<e.length;i++)r[i]=ae(e[i],t,n);return Array.isArray(e)&&e.W&&le(r),r}for(i in r={},e)r[i]=ae(e[i],t,n);return r}function ce(e){return"number"==typeof e?isFinite(e)?e:String(e):e}var ue,de={W:{value:!0,configurable:!0}};function le(e){return Array.isArray(e)&&!Object.isFrozen(e)&&Object.defineProperties(e,de),e}function fe(e,t,n){var r=ue;if(ue=null,e||(e=r),r=this.constructor.ca,e||(e=r?[r]:[]),this.j=r?0:-1,this.m=this.g=null,this.h=e,e=(r=this.h.length)-1,!r||null===(r=this.h[e])||"object"!=typeof r||Array.isArray(r)||oe&&r instanceof Uint8Array?void 0!==t&&-1<t?(this.l=Math.max(t,e+1-this.j),this.i=null):this.l=Number.MAX_VALUE:(this.l=e-this.j,this.i=r),n)for(t=0;t<n.length;t++)(e=n[t])<this.l?(e+=this.j,(r=this.h[e])?le(r):this.h[e]=pe):(he(this),(r=this.i[e])?le(r):this.i[e]=pe)}var pe=Object.freeze(le([]));function he(e){var t=e.l+e.j;e.h[t]||(e.i=e.h[t]={})}function me(e,t,n){return-1===t?null:void 0!==n&&n||t>=e.l?e.i?e.i[t]:void 0:e.h[t+e.j]}function ge(e,t){var n=void 0!==n&&n,r=me(e,t,n);return null==r&&(r=pe),r===pe&&Se(e,t,r=le([]),n),r}function ve(e){var t=ge(e,3);if(e.m||(e.m={}),!e.m[3]){for(var n=0;n<t.length;n++)t[n]=+t[n];e.m[3]=!0}return t}function ye(e,t,n){return null==(e=me(e,t))?n:e}function be(e,t,n){return null==(e=null==(e=me(e,t))?e:+e)?void 0===n?0:n:e}function Se(e,t,n,r){void 0!==r&&r||t>=e.l?(he(e),e.i[t]=n):e.h[t+e.j]=n}function Ee(e,t,n){if(-1===n)return null;if(e.g||(e.g={}),!e.g[n]){var r=me(e,n,!1);r&&(e.g[n]=new t(r))}return e.g[n]}function _e(e,t){e.g||(e.g={});var n=e.g[1];if(!n){var r=ge(e,1);n=[];for(var i=0;i<r.length;i++)n[i]=new t(r[i]);e.g[1]=n}return n}function Te(e,t,n){var r=void 0!==r&&r;e.g||(e.g={});var i=n&&Ie(n);e.g[t]=n,Se(e,t,i,r)}function Re(e,t,n,r){var i=_e(e,n);t=t||new n,e=ge(e,1),null!=r?(i.splice(r,0,t),e.splice(r,0,Ie(t))):(i.push(t),e.push(Ie(t)))}function Ie(e,t){if(e.g)for(var n in e.g){var r=e.g[n];if(Array.isArray(r))for(var i=0;i<r.length;i++)r[i]&&Ie(r[i]);else r&&Ie(r)}return e.h}function we(e,t){if(e=e.o){ne(t,t.g.end());for(var n=0;n<e.length;n++)ne(t,e[n])}}function Ce(e,t){if(4==t.h)return!1;var n=t.m;return function e(t){switch(t.h){case 0:if(0!=t.h)e(t);else{for(t=t.g;128&t.h[t.g];)t.g++;t.g++}break;case 1:1!=t.h?e(t):(t=t.g).g+=8;break;case 2:if(2!=t.h)e(t);else{var n=t.g.i();(t=t.g).g+=n}break;case 5:5!=t.h?e(t):(t=t.g).g+=4;break;case 3:for(n=t.l;;){if(!z(t)){t.j=!0;break}if(4==t.h){t.l!=n&&(t.j=!0);break}e(t)}break;default:t.j=!0}}(t),t.N||(t=W(t.g.h,n,t.g.g),(n=e.o)?n.push(t):e.o=[t]),!0}function Oe(e){fe.call(this,e,-1,xe)}function Ae(e,t){for(;z(t);)switch(t.i){case 8:var n=t.g.i();Se(e,1,n);break;case 16:Se(e,2,n=t.g.i());break;case 29:case 26:ee(t,e.getPackedDataList());break;case 32:Se(e,4,n=X(t.g));break;default:if(!Ce(e,t))return e}return e}fe.prototype.toJSON=function(){return se(Ie(this),ce,V)},fe.prototype.toString=function(){return Ie(this).toString()},h(Oe,fe),Oe.prototype.getRows=function(){return me(this,1)},Oe.prototype.getCols=function(){return me(this,2)},Oe.prototype.getPackedDataList=function(){return ve(this)},Oe.prototype.getLayout=function(){return ye(this,4,0)};var xe=[3];function ke(t,n){var r=void 0;return new(r||(r=e))((function(e,i){function o(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(t){t.done?e(t.value):new r((function(e){e(t.value)})).then(o,a)}s((n=n.apply(t,void 0)).next())}))}function Ne(e){fe.call(this,e)}function Le(e,t){for(;z(t);)switch(t.i){case 8:var n=t.g.i();Se(e,1,n);break;case 21:Se(e,2,n=Q(t));break;case 26:Se(e,3,n=q(t));break;case 34:Se(e,4,n=q(t));break;default:if(!Ce(e,t))return e}return e}function Me(e){fe.call(this,e,-1,Ve)}h(Ne,fe),h(Me,fe),Me.prototype.addClassification=function(e,t){return Re(this,e,Ne,t),this};var Ve=[1];function Pe(e){fe.call(this,e)}function De(e,t){for(;z(t);)switch(t.i){case 13:var n=Q(t);Se(e,1,n);break;case 21:Se(e,2,n=Q(t));break;case 29:Se(e,3,n=Q(t));break;case 37:Se(e,4,n=Q(t));break;case 45:Se(e,5,n=Q(t));break;default:if(!Ce(e,t))return e}return e}function Ze(e){fe.call(this,e,-1,We)}function je(e){e:{var t=new Ze;for(e=new J(e);z(e);)switch(e.i){case 10:Re(t,K(e,new Pe,De),Pe,void 0);break;default:if(!Ce(t,e))break e}}return t}h(Pe,fe),h(Ze,fe);var We=[1];function Ge(e){fe.call(this,e)}function Fe(e){fe.call(this,e,-1,Xe)}function Ue(e,t){for(;z(t);)switch(t.i){case 8:var n=X(t.g);Se(e,1,n);break;case 16:Se(e,2,n=X(t.g));break;case 29:case 26:ee(t,e.getVertexBufferList());break;case 32:case 34:n=t;var r=e.getIndexBufferList();2==n.h?$(n,F.prototype.i,r):r.push(n.g.i());break;default:if(!Ce(e,t))return e}return e}h(Ge,fe),h(Fe,fe),Fe.prototype.getVertexType=function(){return ye(this,1,0)},Fe.prototype.getPrimitiveType=function(){return ye(this,2,0)},Fe.prototype.getVertexBufferList=function(){return ve(this)},Fe.prototype.getIndexBufferList=function(){return ge(this,4)};var Xe=[3,4];function Be(e){fe.call(this,e)}function He(e,t,n){if(n=e.createShader(0===n?e.VERTEX_SHADER:e.FRAGMENT_SHADER),e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw Error("Could not compile WebGL shader.\n\n"+e.getShaderInfoLog(n));return n}function Ye(e){return _e(e,Ne).map((function(e){return{index:ye(e,1,0),Y:be(e,2),label:null!=me(e,3)?ye(e,3,""):void 0,displayName:null!=me(e,4)?ye(e,4,""):void 0}}))}function Je(e){return{x:be(e,1),y:be(e,2),z:be(e,3),visibility:null!=me(e,4)?be(e,4):void 0}}function ze(e,t){this.h=e,this.g=t,this.l=0}function Ke(t,n,r){return function(e,t){var n=e.g;if(void 0===e.m){var r=He(n,"\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }",0),i=He(n,"\n  precision mediump float;\n  varying vec2 vTex;\n  uniform sampler2D sampler0;\n  void main(){\n    gl_FragColor = texture2D(sampler0, vTex);\n  }",1),o=n.createProgram();if(n.attachShader(o,r),n.attachShader(o,i),n.linkProgram(o),!n.getProgramParameter(o,n.LINK_STATUS))throw Error("Could not compile WebGL program.\n\n"+n.getProgramInfoLog(o));r=e.m=o,n.useProgram(r),i=n.getUniformLocation(r,"sampler0"),e.j={I:n.getAttribLocation(r,"aVertex"),H:n.getAttribLocation(r,"aTex"),da:i},e.s=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,e.s),n.enableVertexAttribArray(e.j.I),n.vertexAttribPointer(e.j.I,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),e.o=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,e.o),n.enableVertexAttribArray(e.j.H),n.vertexAttribPointer(e.j.H,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.uniform1i(i,0)}r=e.j,n.useProgram(e.m),n.canvas.width=t.width,n.canvas.height=t.height,n.viewport(0,0,t.width,t.height),n.activeTexture(n.TEXTURE0),e.h.bindTexture2d(t.glName),n.enableVertexAttribArray(r.I),n.bindBuffer(n.ARRAY_BUFFER,e.s),n.vertexAttribPointer(r.I,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(r.H),n.bindBuffer(n.ARRAY_BUFFER,e.o),n.vertexAttribPointer(r.H,2,n.FLOAT,!1,0,0),n.bindFramebuffer(n.DRAW_FRAMEBUFFER?n.DRAW_FRAMEBUFFER:n.FRAMEBUFFER,null),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.colorMask(!0,!0,!0,!0),n.drawArrays(n.TRIANGLE_FAN,0,4),n.disableVertexAttribArray(r.I),n.disableVertexAttribArray(r.H),n.bindBuffer(n.ARRAY_BUFFER,null),e.h.bindTexture2d(0)}(t,n),"function"==typeof t.g.canvas.transferToImageBitmap?e.resolve(t.g.canvas.transferToImageBitmap()):r?e.resolve(t.g.canvas):"function"==typeof createImageBitmap?createImageBitmap(t.g.canvas):(void 0===t.i&&(t.i=document.createElement("canvas")),new e((function(e){t.i.height=t.g.canvas.height,t.i.width=t.g.canvas.width,t.i.getContext("2d",{}).drawImage(t.g.canvas,0,0,t.g.canvas.width,t.g.canvas.height),e(t.i)})))}function Qe(e){this.g=e}h(Be,fe),Be.prototype.getMesh=function(){return Ee(this,Fe,1)},Be.prototype.getPoseTransformMatrix=function(){return Ee(this,Oe,2)};var qe=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function $e(e,t){return t+e}function et(e,t){window[e]=t}function tt(t){if(this.g=t,this.listeners={},this.j={},this.F={},this.m={},this.s={},this.G=this.o=this.R=!0,this.C=e.resolve(),this.P="",this.B={},this.locateFile=t&&t.locateFile||$e,"object"==typeof window)var n=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if(!(typeof location<"u"))throw Error("solutions can only be loaded on a web page or in a web worker");n=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}if(this.S=n,t.options)for(var r=(n=s(Object.keys(t.options))).next();!r.done;r=n.next()){r=r.value;var i=t.options[r].default;void 0!==i&&(this.j[r]="function"==typeof i?i():i)}}function nt(t){return ke(t,(function t(){var n,r,i,o,a,s,u,d,l,f,p,h=this;return T(t,(function(t){switch(t.g){case 1:return n=h,h.R?(r=function(e,t){return void 0===e.g.files?[]:"function"==typeof e.g.files?e.g.files(t):e.g.files}(h,h.j),y(t,function(){return ke(this,(function e(){return T(e,(function(e){switch(e.g){case 1:return e.m=2,y(e,WebAssembly.instantiate(qe),4);case 4:e.g=3,e.m=0;break;case 2:return e.m=0,e.j=null,e.return(!1);case 3:return e.return(!0)}}))}))}(),2)):t.return();case 2:if(i=t.h,"object"==typeof window)return et("createMediapipeSolutionsWasm",{locateFile:h.locateFile}),et("createMediapipeSolutionsPackedAssets",{locateFile:h.locateFile}),s=r.filter((function(e){return void 0!==e.data})),u=r.filter((function(e){return void 0===e.data})),d=e.all(s.map((function(t){var r=rt(n,t.url);if(void 0!==t.path){var i=t.path;r=r.then((function(t){return n.overrideFile(i,t),e.resolve(t)}))}return r}))),l=e.all(u.map((function(t){return void 0===t.simd||t.simd&&i||!t.simd&&!i?function(t){var n=document.createElement("script");return n.setAttribute("src",t),n.setAttribute("crossorigin","anonymous"),new e((function(e){n.addEventListener("load",(function(){e()}),!1),n.addEventListener("error",(function(){e()}),!1),document.body.appendChild(n)}))}(n.locateFile(t.url,n.S)):e.resolve()}))).then((function(){return ke(n,(function e(){var t,n,r=this;return T(e,(function(e){if(1==e.g)return t=window.createMediapipeSolutionsWasm,n=window.createMediapipeSolutionsPackedAssets,y(e,t(n),2);r.h=e.h,e.g=0}))}))})),f=ke(n,(function e(){var t=this;return T(e,(function(e){return t.g.graph&&t.g.graph.url?e=y(e,rt(t,t.g.graph.url),0):(e.g=0,e=void 0),e}))})),y(t,e.all([l,d,f]),7);if("function"!=typeof importScripts)throw Error("solutions can only be loaded on a web page or in a web worker");return o=r.filter((function(e){return void 0===e.simd||e.simd&&i||!e.simd&&!i})).map((function(e){return n.locateFile(e.url,n.S)})),importScripts.apply(null,c(o)),y(t,createMediapipeSolutionsWasm(Module),6);case 6:h.h=t.h,h.l=new OffscreenCanvas(1,1),h.h.canvas=h.l,a=h.h.GL.createContext(h.l,{antialias:!1,alpha:!1,ba:typeof WebGL2RenderingContext<"u"?2:1}),h.h.GL.makeContextCurrent(a),t.g=4;break;case 7:if(h.l=document.createElement("canvas"),!(p=h.l.getContext("webgl2",{}))&&!(p=h.l.getContext("webgl",{})))return alert("Failed to create WebGL canvas context when passing video frame."),t.return();h.D=p,h.h.canvas=h.l,h.h.createContext(h.l,!0,!0,{});case 4:h.i=new h.h.SolutionWasm,h.R=!1,t.g=0}}))}))}function rt(e,t){return ke(e,(function e(){var n,r,i=this;return T(e,(function(e){return t in i.F?e.return(i.F[t]):(n=i.locateFile(t,""),r=fetch(n).then((function(e){return e.arrayBuffer()})),i.F[t]=r,e.return(r))}))}))}function it(e,t,n){return ke(e,(function e(){var r,i,o,a,c,u,d,l,f,p,h,m,g,v,b=this;return T(e,(function(e){switch(e.g){case 1:if(!n)return e.return(t);for(r={},i=0,o=s(Object.keys(n)),a=o.next();!a.done;a=o.next())c=a.value,"string"!=typeof(u=n[c])&&"texture"===u.type&&void 0!==t[u.stream]&&++i;1<i&&(b.G=!1),d=s(Object.keys(n)),a=d.next();case 2:if(a.done){e.g=4;break}if(l=a.value,"string"==typeof(f=n[l]))return g=r,v=l,y(e,function(e,t,n){return ke(e,(function e(){var r,i=this;return T(e,(function(e){return"number"==typeof n||n instanceof Uint8Array||n instanceof i.h.Uint8BlobList?e.return(n):n instanceof i.h.Texture2dDataOut?((r=i.s[t])||(r=new ze(i.h,i.D),i.s[t]=r),e.return(Ke(r,n,i.G))):e.return(void 0)}))}))}(b,l,t[f]),14);if(p=t[f.stream],"detection_list"===f.type){if(p){for(var S=p.getRectList(),E=p.getLandmarksList(),_=p.getClassificationsList(),R=[],I=0;I<S.size();++I){var w=S.get(I);e:{var C=new Ge;for(w=new J(w);z(w);)switch(w.i){case 13:var O=Q(w);Se(C,1,O);break;case 21:Se(C,2,O=Q(w));break;case 29:Se(C,3,O=Q(w));break;case 37:Se(C,4,O=Q(w));break;case 45:Se(C,5,O=Q(w));break;case 48:Se(C,6,O=X(w.g));break;default:if(!Ce(C,w))break e}}C={Z:be(C,1),$:be(C,2),height:be(C,3),width:be(C,4),rotation:be(C,5,0),X:ye(C,6,0)},w=_e(je(E.get(I)),Pe).map(Je);var A=_.get(I);e:for(O=new Me,A=new J(A);z(A);)switch(A.i){case 10:O.addClassification(K(A,new Ne,Le));break;default:if(!Ce(O,A))break e}C={T:C,O:w,M:Ye(O)},R.push(C)}S=R}else S=[];r[l]=S,e.g=7;break}if("proto_list"===f.type){if(p){for(S=Array(p.size()),E=0;E<p.size();E++)S[E]=p.get(E);p.delete()}else S=[];r[l]=S,e.g=7;break}if(void 0===p){e.g=3;break}if("float_list"===f.type){r[l]=p,e.g=7;break}if("proto"===f.type){r[l]=p,e.g=7;break}if("texture"!==f.type)throw Error("Unknown output config type: '"+f.type+"'");return(h=b.s[l])||(h=new ze(b.h,b.D),b.s[l]=h),y(e,Ke(h,p,b.G),13);case 13:m=e.h,r[l]=m;case 7:f.transform&&r[l]&&(r[l]=f.transform(r[l])),e.g=3;break;case 14:g[v]=e.h;case 3:a=d.next(),e.g=2;break;case 4:return e.return(r)}}))}))}function ot(e,t){for(var n=t.name||"$",r=[].concat(c(t.wants)),i=new e.h.StringList,o=s(t.wants),a=o.next();!a.done;a=o.next())i.push_back(a.value);o=e.h.PacketListener.implement({onResults:function(i){for(var o={},a=0;a<t.wants.length;++a)o[r[a]]=i.get(a);var s=e.listeners[n];s&&(e.C=it(e,o,t.outs).then((function(n){n=s(n);for(var i=0;i<t.wants.length;++i){var a=o[r[i]];"object"==typeof a&&a.hasOwnProperty&&a.hasOwnProperty("delete")&&a.delete()}n&&(e.C=n)})))}}),e.i.attachMultiListener(i,o),i.delete()}function at(e){var t=(e=function(e){e:{var t=new Be;for(e=new J(e);z(e);)switch(e.i){case 10:var n=K(e,new Fe,Ue);Te(t,1,n);break;case 18:Te(t,2,n=K(e,new Oe,Ae));break;default:if(!Ce(t,e))break e}}return t}(e)).getMesh();if(!t)return e;var n=new Float32Array(t.getVertexBufferList());t.getVertexBufferList=function(){return n};var r=new Uint32Array(t.getIndexBufferList());return t.getIndexBufferList=function(){return r},e}(t=tt.prototype).close=function(){return this.i&&this.i.delete(),e.resolve()},t.reset=function(){return ke(this,(function e(){var t=this;return T(e,(function(e){t.i&&(t.i.reset(),t.m={},t.s={}),e.g=0}))}))},t.setOptions=function(e,t){var n=this;if(t=t||this.g.options){for(var r=[],i=[],o={},a=s(Object.keys(e)),c=a.next();!c.done;o={K:o.K,L:o.L},c=a.next()){var u=c.value;u in this.j&&this.j[u]===e[u]||(this.j[u]=e[u],void 0!==(c=t[u])&&(c.onChange&&(o.K=c.onChange,o.L=e[u],r.push(function(e){return function(){return ke(n,(function t(){var n=this;return T(t,(function(t){if(1==t.g)return y(t,e.K(e.L),2);!0===t.h&&(n.o=!0),t.g=0}))}))}}(o))),c.graphOptionXref&&(u={valueNumber:1===c.type?e[u]:0,valueBoolean:0===c.type&&e[u],valueString:2===c.type?e[u]:""},c=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),c.graphOptionXref),u),i.push(c))))}(0!==r.length||0!==i.length)&&(this.o=!0,this.A=(void 0===this.A?[]:this.A).concat(i),this.u=(void 0===this.u?[]:this.u).concat(r))}},t.initialize=function(){return ke(this,(function e(){var t=this;return T(e,(function(e){return 1==e.g?y(e,nt(t),2):3!=e.g?y(e,function(e){return ke(e,(function e(){var t,n,r,i,o,a,c,u,d=this;return T(e,(function(e){if(1==e.g)return d.g.graph&&d.g.graph.url&&d.P===d.g.graph.url?e.return():(d.o=!0,d.g.graph&&d.g.graph.url?(d.P=d.g.graph.url,y(e,rt(d,d.g.graph.url),3)):void(e.g=2));for(2!=e.g&&(t=e.h,d.i.loadGraph(t)),n=s(Object.keys(d.B)),r=n.next();!r.done;r=n.next())i=r.value,d.i.overrideFile(i,d.B[i]);if(d.B={},d.g.listeners)for(o=s(d.g.listeners),a=o.next();!a.done;a=o.next())c=a.value,ot(d,c);u=d.j,d.j={},d.setOptions(u),e.g=0}))}))}(t),3):y(e,function(e){return ke(e,(function e(){var t,n,r,i,o,a,c=this;return T(e,(function(e){switch(e.g){case 1:if(!c.o)return e.return();if(!c.u){e.g=2;break}t=s(c.u),n=t.next();case 3:if(n.done){e.g=5;break}return y(e,(0,n.value)(),4);case 4:n=t.next(),e.g=3;break;case 5:c.u=void 0;case 2:if(c.A){for(r=new c.h.GraphOptionChangeRequestList,i=s(c.A),o=i.next();!o.done;o=i.next())a=o.value,r.push_back(a);c.i.changeOptions(r),r.delete(),c.A=void 0}c.o=!1,e.g=0}}))}))}(t),0)}))}))},t.overrideFile=function(e,t){this.i?this.i.overrideFile(e,t):this.B[e]=t},t.clearOverriddenFiles=function(){this.B={},this.i&&this.i.clearOverriddenFiles()},t.send=function(e,t){return ke(this,(function n(){var r,i,o,a,c,u,d,l,f,p=this;return T(n,(function(n){switch(n.g){case 1:return p.g.inputs?(r=1e3*(null==t?performance.now():t),y(n,p.C,2)):n.return();case 2:return y(n,p.initialize(),3);case 3:for(i=new p.h.PacketDataList,o=s(Object.keys(e)),a=o.next();!a.done;a=o.next())if(c=a.value,u=p.g.inputs[c]){e:{var h=p,m=e[c];switch(u.type){case"video":var g=h.m[u.stream];if(g||(g=new ze(h.h,h.D),h.m[u.stream]=g),0===(h=g).l&&(h.l=h.h.createTexture()),typeof HTMLVideoElement<"u"&&m instanceof HTMLVideoElement){var v=m.videoWidth;g=m.videoHeight}else typeof HTMLImageElement<"u"&&m instanceof HTMLImageElement?(v=m.naturalWidth,g=m.naturalHeight):(v=m.width,g=m.height);g={glName:h.l,width:v,height:g},(v=h.g).canvas.width=g.width,v.canvas.height=g.height,v.activeTexture(v.TEXTURE0),h.h.bindTexture2d(h.l),v.texImage2D(v.TEXTURE_2D,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,m),h.h.bindTexture2d(0),h=g;break e;case"detections":for((g=h.m[u.stream])||(g=new Qe(h.h),h.m[u.stream]=g),(h=g).data||(h.data=new h.g.DetectionListData),h.data.reset(m.length),g=0;g<m.length;++g){v=m[g];var b=h.data,S=b.setBoundingBox,E=g,_=v.T,T=new Ge;Se(T,1,_.Z),Se(T,2,_.$),Se(T,3,_.height),Se(T,4,_.width),Se(T,5,_.rotation),Se(T,6,_.X);var R=_=new te;ie(R,1,me(T,1)),ie(R,2,me(T,2)),ie(R,3,me(T,3)),ie(R,4,me(T,4)),ie(R,5,me(T,5));var I=me(T,6);if(null!=I&&null!=I){Y(R.g,48);var w=R.g,C=I;I=0>C;var O=(C=Math.abs(C))>>>0;for(C=Math.floor((C-O)/4294967296),C>>>=0,I&&(C=~C>>>0,4294967295<(O=1+(~O>>>0))&&(O=0,4294967295<++C&&(C=0))),I=G=O,O=C;0<O||127<I;)w.push(127&I|128),I=(I>>>7|O<<25)>>>0,O>>>=7;w.push(I)}if(we(T,R),_=re(_),S.call(b,E,_),v.O)for(b=0;b<v.O.length;++b)R=!!(T=v.O[b]).visibility,E=(S=h.data).addNormalizedLandmark,_=g,T=Object.assign(Object.assign({},T),{visibility:R?T.visibility:0}),Se(R=new Pe,1,T.x),Se(R,2,T.y),Se(R,3,T.z),T.visibility&&Se(R,4,T.visibility),ie(w=T=new te,1,me(R,1)),ie(w,2,me(R,2)),ie(w,3,me(R,3)),ie(w,4,me(R,4)),ie(w,5,me(R,5)),we(R,w),T=re(T),E.call(S,_,T);if(v.M)for(b=0;b<v.M.length;++b){if(E=(S=h.data).addClassification,_=g,T=v.M[b],Se(R=new Ne,2,T.Y),T.index&&Se(R,1,T.index),T.label&&Se(R,3,T.label),T.displayName&&Se(R,4,T.displayName),w=T=new te,null!=(O=me(R,1))&&null!=O)if(Y(w.g,8),I=w.g,0<=O)Y(I,O);else{for(C=0;9>C;C++)I.push(127&O|128),O>>=7;I.push(1)}ie(w,2,me(R,2)),null!=(I=me(R,3))&&(I=N(I),Y(w.g,26),Y(w.g,I.length),ne(w,w.g.end()),ne(w,I)),null!=(I=me(R,4))&&(I=N(I),Y(w.g,34),Y(w.g,I.length),ne(w,w.g.end()),ne(w,I)),we(R,w),T=re(T),E.call(S,_,T)}}h=h.data;break e;default:h={}}}switch(d=h,l=u.stream,u.type){case"video":i.pushTexture2d(Object.assign(Object.assign({},d),{stream:l,timestamp:r}));break;case"detections":(f=d).stream=l,f.timestamp=r,i.pushDetectionList(f);break;default:throw Error("Unknown input config type: '"+u.type+"'")}}return p.i.send(i),y(n,p.C,4);case 4:i.delete(),n.g=0}}))}))},t.onResults=function(e,t){this.listeners[t||"$"]=e},w("Solution",tt),w("OptionType",{BOOL:0,NUMBER:1,aa:2,0:"BOOL",1:"NUMBER",2:"STRING"});var st={files:[{url:"face_mesh_solution_packed_assets_loader.js"},{simd:!0,url:"face_mesh_solution_simd_wasm_bin.js"},{simd:!1,url:"face_mesh_solution_wasm_bin.js"}],graph:{url:"face_mesh.binarypb"},listeners:[{wants:["multi_face_geometry","image_transformed","multi_face_landmarks"],outs:{image:"image_transformed",multiFaceGeometry:{type:"proto_list",stream:"multi_face_geometry",transform:function(e){return e.map(at)}},multiFaceLandmarks:{type:"proto_list",stream:"multi_face_landmarks",transform:function(e){return e.map((function(e){return _e(je(e),Pe).map(Je)}))}}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},enableFaceGeometry:{type:0,graphOptionXref:{calculatorName:"EnableFaceGeometryConstant",calculatorType:"ConstantSidePacketCalculator",fieldName:"bool_value"}},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},maxNumFaces:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorNumFaces",fieldName:"int_value"}},refineLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorRefineLandmarks",fieldName:"bool_value"}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"facelandmarkfrontgpu__facedetectionshortrangegpu__facedetectionshortrangecommon__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"facelandmarkfrontgpu__facelandmarkgpu__ThresholdingCalculator",fieldName:"threshold"}},cameraNear:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"near"}},cameraFar:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"far"}},cameraVerticalFovDegrees:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"vertical_fov_degrees"}}}},ct=[[61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]],ut=[[263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]],dt=[[276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]],lt=[[33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]],ft=[[46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]],pt=[[10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]],ht=[].concat(c(ct),c(ut),c(dt),c(lt),c(ft),c(pt));function mt(e){e=e||{},e=Object.assign(Object.assign({},st),e),this.g=new tt(e)}(t=mt.prototype).close=function(){return this.g.close(),e.resolve()},t.onResults=function(e){this.g.onResults(e)},t.initialize=function(){return ke(this,(function e(){var t=this;return T(e,(function(e){return y(e,t.g.initialize(),0)}))}))},t.reset=function(){this.g.reset()},t.send=function(e){return ke(this,(function t(){var n=this;return T(t,(function(t){return y(t,n.g.send(e),0)}))}))},t.setOptions=function(e){this.g.setOptions(e)},w("FACE_GEOMETRY",{Layout:{COLUMN_MAJOR:0,ROW_MAJOR:1,0:"COLUMN_MAJOR",1:"ROW_MAJOR"},PrimitiveType:{TRIANGLE:0,0:"TRIANGLE"},VertexType:{VERTEX_PT:0,0:"VERTEX_PT"},DEFAULT_CAMERA_PARAMS:{verticalFovDegrees:63,near:1,far:1e4}}),w("FaceMesh",mt),w("FACEMESH_LIPS",ct),w("FACEMESH_LEFT_EYE",ut),w("FACEMESH_LEFT_EYEBROW",dt),w("FACEMESH_LEFT_IRIS",[[474,475],[475,476],[476,477],[477,474]]),w("FACEMESH_RIGHT_EYE",lt),w("FACEMESH_RIGHT_EYEBROW",ft),w("FACEMESH_RIGHT_IRIS",[[469,470],[470,471],[471,472],[472,469]]),w("FACEMESH_FACE_OVAL",pt),w("FACEMESH_CONTOURS",ht),w("FACEMESH_TESSELATION",[[127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]]),w("matrixDataToMatrix",(function(e){for(var t=e.getCols(),n=e.getRows(),r=e.getPackedDataList(),i=[],o=0;o<n;o++)i.push(Array(t));for(o=0;o<n;o++)for(var a=0;a<t;a++){var s=1===e.getLayout()?o*t+a:a*n+o;i[o][a]=r[s]}return i})),w("VERSION","0.4.1633559619")}).call(Ie);const we={};(function(){var t;function n(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var r="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},i=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof(void 0!==typeof window?window:global)&&(void 0!==typeof window?window:global)];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function o(e,t){if(t)e:{var n=i;e=e.split(".");for(var o=0;o<e.length-1;o++){var a=e[o];if(!(a in n))break e;n=n[a]}(t=t(o=n[e=e[e.length-1]]))!=o&&null!=t&&r(n,e,{configurable:!0,writable:!0,value:t})}}function a(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function s(e){var t=typeof Symbol<"u"&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:n(e)}}function c(e){if(!(e instanceof Array)){e=s(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}o("Symbol",(function(e){function t(e,t){this.g=e,r(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.g};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",i=0;return function e(r){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(r||"")+"_"+i++,r)}})),o("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),o=0;o<t.length;o++){var s=i[t[o]];"function"==typeof s&&"function"!=typeof s.prototype[e]&&r(s.prototype,e,{configurable:!0,writable:!0,value:function(){return a(n(this))}})}return e}));var u,d="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)u=Object.setPrototypeOf;else{var l;e:{var f={};try{f.__proto__={a:!0},l=f.a;break e}catch{}l=!1}u=l?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var p=u;function h(e,t){if(e.prototype=d(t.prototype),e.prototype.constructor=e,p)p(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var r=Object.getOwnPropertyDescriptor(t,n);r&&Object.defineProperty(e,n,r)}else e[n]=t[n];e.ka=t.prototype}function m(){this.l=!1,this.i=null,this.h=void 0,this.g=1,this.s=this.m=0,this.j=null}function g(e){if(e.l)throw new TypeError("Generator is already running");e.l=!0}function v(e,t){e.j={V:t,X:!0},e.g=e.m||e.s}function y(e,t,n){return e.g=n,{value:t}}function b(e){this.g=new m,this.h=e}function S(e,t,n,r){try{var i=t.call(e.g.i,n);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return e.g.l=!1,i;var o=i.value}catch(t){return e.g.i=null,v(e.g,t),E(e)}return e.g.i=null,r.call(e.g,o),E(e)}function E(e){for(;e.g.g;)try{var t=e.h(e.g);if(t)return e.g.l=!1,{value:t.value,done:!1}}catch(t){e.g.h=void 0,v(e.g,t)}if(e.g.l=!1,e.g.j){if(t=e.g.j,e.g.j=null,t.X)throw t.V;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function _(e){this.next=function(t){return g(e.g),e.g.i?t=S(e,e.g.i.next,t,e.g.o):(e.g.o(t),t=E(e)),t},this.throw=function(t){return g(e.g),e.g.i?t=S(e,e.g.i.throw,t,e.g.o):(v(e.g,t),t=E(e)),t},this.return=function(t){return function(e,t){g(e.g);var n=e.g.i;return n?S(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),E(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function T(t){return function(t){function n(e){return t.next(e)}function r(e){return t.throw(e)}return new e((function(i,o){!function t(a){a.done?i(a.value):e.resolve(a.value).then(n,r).then(t,o)}(t.next())}))}(new _(new b(t)))}m.prototype.o=function(e){this.h=e},m.prototype.return=function(e){this.j={return:e},this.g=this.s},o("Promise",(function(e){function t(e){this.h=0,this.i=void 0,this.g=[],this.o=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function n(){this.g=null}function r(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;n.prototype.h=function(e){if(null==this.g){this.g=[];var t=this;this.i((function(){t.l()}))}this.g.push(e)};var o=i.setTimeout;n.prototype.i=function(e){o(e,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.j(e)}}}this.g=null},n.prototype.j=function(e){this.i((function(){throw e}))},t.prototype.j=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.D),reject:e(this.l)}},t.prototype.D=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.G(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.A(e):this.m(e)}},t.prototype.A=function(e){var t=void 0;try{t=e.then}catch(e){return void this.l(e)}"function"==typeof t?this.H(t,e):this.m(e)},t.prototype.l=function(e){this.s(2,e)},t.prototype.m=function(e){this.s(1,e)},t.prototype.s=function(e,t){if(0!=this.h)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.h);this.h=e,this.i=t,2===this.h&&this.F(),this.B()},t.prototype.F=function(){var e=this;o((function(){if(e.C()){var t=i.console;typeof t<"u"&&t.error(e.i)}}),1)},t.prototype.C=function(){if(this.o)return!1;var e=i.CustomEvent,t=i.Event,n=i.dispatchEvent;return typeof n>"u"||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=i.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.i,n(e))},t.prototype.B=function(){if(null!=this.g){for(var e=0;e<this.g.length;++e)a.h(this.g[e]);this.g=null}};var a=new n;return t.prototype.G=function(e){var t=this.j();e.K(t.resolve,t.reject)},t.prototype.H=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(e){o(e)}}:t}var i,o,a=new t((function(e,t){i=e,o=t}));return this.K(r(e,i),r(n,o)),a},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.K=function(e,t){function n(){switch(r.h){case 1:e(r.i);break;case 2:t(r.i);break;default:throw Error("Unexpected state: "+r.h)}}var r=this;null==this.g?a.h(n):this.g.push(n),this.o=!0},t.resolve=r,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var i=s(e),o=i.next();!o.done;o=i.next())r(o.value).K(t,n)}))},t.all=function(e){var n=s(e),i=n.next();return i.done?r([]):new t((function(e,t){function o(t){return function(n){a[t]=n,0==--s&&e(a)}}var a=[],s=0;do{a.push(void 0),s++,r(i.value).K(o(a.length-1),t),i=n.next()}while(!i.done)}))},t}));var R="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e};o("Object.assign",(function(e){return e||R})),o("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}})),o("Array.prototype.includes",(function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var r=n.length;for(0>(t=t||0)&&(t=Math.max(t+r,0));t<r;t++){var i=n[t];if(i===e||Object.is(i,e))return!0}return!1}})),o("String.prototype.includes",(function(e){return e||function(e,t){if(null==this)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return-1!==this.indexOf(e,t||0)}})),o("Array.prototype.keys",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,(function(e){return e}))}}));var I=this||self;function w(e,t){e=e.split(".");var n,r=I;e[0]in r||typeof r.execScript>"u"||r.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)e.length||void 0===t?r=r[n]&&r[n]!==Object.prototype[n]?r[n]:r[n]={}:r[n]=t}function C(e){throw e}function O(e,t){C(Error("Invalid wire type: "+e+" (at position "+t+")"))}function A(){C(Error("Failed to read varint, encoding is invalid."))}function x(e,t){return t=String.fromCharCode.apply(null,t),null==e?t:e+t}var k,N,L=typeof TextDecoder<"u",M=typeof TextEncoder<"u";function V(e){if(M)e=(N||(N=new TextEncoder)).encode(e);else{var t=void 0;t=void 0!==t&&t;for(var n=0,r=new Uint8Array(3*e.length),i=0;i<e.length;i++){var o=e.charCodeAt(i);if(128>o)r[n++]=o;else{if(2048>o)r[n++]=o>>6|192;else{if(55296<=o&&57343>=o){if(56319>=o&&i<e.length){var a=e.charCodeAt(++i);if(56320<=a&&57343>=a){o=1024*(o-55296)+a-56320+65536,r[n++]=o>>18|240,r[n++]=o>>12&63|128,r[n++]=o>>6&63|128,r[n++]=63&o|128;continue}i--}if(t)throw Error("Found an unpaired surrogate");o=65533}r[n++]=o>>12|224,r[n++]=o>>6&63|128}r[n++]=63&o|128}}e=r.subarray(0,n)}return e}var P={},D=null;function Z(e){var t;void 0===t&&(t=0),W(),t=P[t];for(var n=Array(Math.floor(e.length/3)),r=t[64]||"",i=0,o=0;i<e.length-2;i+=3){var a=e[i],s=e[i+1],c=e[i+2],u=t[a>>2];a=t[(3&a)<<4|s>>4],s=t[(15&s)<<2|c>>6],c=t[63&c],n[o++]=u+a+s+c}switch(u=0,c=r,e.length-i){case 2:c=t[(15&(u=e[i+1]))<<2]||r;case 1:e=e[i],n[o]=t[e>>2]+t[(3&e)<<4|u>>4]+c+r}return n.join("")}function j(e){var t=e.length,n=3*t/4;n%3?n=Math.floor(n):-1!="=.".indexOf(e[t-1])&&(n=-1!="=.".indexOf(e[t-2])?n-2:n-1);var r=new Uint8Array(n),i=0;return function(e,t){function n(t){for(;r<e.length;){var n=e.charAt(r++),i=D[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return t}W();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;t(i<<2|o>>4),64!=a&&(t(o<<4&240|a>>2),64!=s&&t(a<<6&192|s))}}(e,(function(e){r[i++]=e})),r.subarray(0,i)}function W(){if(!D){D={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++){var r=e.concat(t[n].split(""));P[n]=r;for(var i=0;i<r.length;i++){var o=r[i];void 0===D[o]&&(D[o]=i)}}}}var G,F="function"==typeof Uint8Array;function U(e){if(this.g=e,null!==e&&0===e.length)throw Error("ByteString should be constructed with non-empty values")}var X="function"==typeof Uint8Array.prototype.slice;function B(e,t,n){return t===n?G||(G=new Uint8Array(0)):X?e.slice(t,n):new Uint8Array(e.subarray(t,n))}var H=0;function Y(e,t){t=void 0!==(t=void 0===t?{}:t).v&&t.v,this.h=null,this.g=this.i=this.l=0,this.j=!1,this.v=t,e&&J(this,e)}function J(e,t){e.h=function(e){if(e.constructor===Uint8Array)return e;if(e.constructor===ArrayBuffer)return new Uint8Array(e);if(e.constructor===Array)return new Uint8Array(e);if(e.constructor===String)return j(e);if(e.constructor===U){if(null==e.g)var t=G||(G=new Uint8Array(0));else{t=Uint8Array;var n=e.g;n=null==n||F&&null!=n&&n instanceof Uint8Array?n:"string"==typeof n?j(n):null,t=new t(e=e.g=n)}return t}if(e instanceof Uint8Array)return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, or Array of numbers")}(t),e.l=0,e.i=e.h.length,e.g=e.l}function z(e){for(var t=128,n=0,r=0,i=0;4>i&&128<=t;i++)n|=(127&(t=e.h[e.g++]))<<7*i;if(128<=t&&(n|=(127&(t=e.h[e.g++]))<<28,r|=(127&t)>>4),128<=t)for(i=0;5>i&&128<=t;i++)r|=(127&(t=e.h[e.g++]))<<7*i+3;if(128>t)return e=n>>>0,(r=2147483648&(t=r>>>0))&&(t=~t>>>0,0==(e=1+~e>>>0)&&(t=t+1>>>0)),e=4294967296*t+(e>>>0),r?-e:e;e.j=!0,A()}function K(e){e.g>e.i&&(e.j=!0,C(Error("Tried to read past the end of the data "+e.g+" > "+e.i)))}function Q(e){var t=e.h,n=t[e.g],r=127&n;return 128>n?(e.g+=1,K(e),r):(r|=(127&(n=t[e.g+1]))<<7,128>n?(e.g+=2,K(e),r):(r|=(127&(n=t[e.g+2]))<<14,128>n?(e.g+=3,K(e),r):(r|=(127&(n=t[e.g+3]))<<21,128>n?(e.g+=4,K(e),r):(r|=(15&(n=t[e.g+4]))<<28,128>n?(e.g+=5,K(e),r>>>0):(e.g+=5,128<=t[e.g++]&&128<=t[e.g++]&&128<=t[e.g++]&&128<=t[e.g++]&&128<=t[e.g++]?(e.j=!0,A(),r):(K(e),r))))))}function q(e){var t=e.h[e.g],n=e.h[e.g+1],r=e.h[e.g+2],i=e.h[e.g+3];return e.g+=4,K(e),(t<<0|n<<8|r<<16|i<<24)>>>0}Y.prototype.reset=function(){this.g=this.l},Y.prototype.m=function(){var e=q(this),t=2*(e>>31)+1,n=e>>>23&255;return e&=8388607,255==n?e?NaN:1/0*t:0==n?t*Math.pow(2,-149)*e:t*Math.pow(2,n-150)*(e+Math.pow(2,23))};var $=[];function ee(){this.g=new Uint8Array(64),this.h=0}function te(e,t){if(!(e.h+1<e.g.length)){var n=e.g;e.g=new Uint8Array(Math.ceil(1+2*e.g.length)),e.g.set(n)}e.g[e.h++]=t}function ne(e,t){for(;127<t;)te(e,127&t|128),t>>>=7;te(e,t)}function re(e){var t={},n=void 0!==t.O&&t.O;this.m={v:void 0!==t.v&&t.v},this.O=n,t=this.m,$.length?(n=$.pop(),t&&(n.v=t.v),e&&J(n,e),e=n):e=new Y(e,t),this.g=e,this.l=this.g.g,this.h=this.i=-1,this.j=!1}function ie(e){var t=e.g;if((t=t.g==t.i)||(t=e.j)||(t=(t=e.g).j||0>t.g||t.g>t.i),t)return!1;e.l=e.g.g;var n=Q(e.g);return t=n>>>3,0<=(n&=7)&&5>=n?(e.i=t,e.h=n,!0):(e.j=!0,O(n,e.l),!1)}function oe(e){switch(e.h){case 0:if(0!=e.h)oe(e);else e:{for(var t=(e=e.g).g,n=0;10>n;n++){if(0==(128&e.h[t])){e.g=t+1,K(e);break e}t++}e.j=!0,A()}break;case 1:(e=e.g).g+=8,K(e);break;case 2:2!=e.h?oe(e):(t=Q(e.g),(e=e.g).g+=t,K(e));break;case 5:(e=e.g).g+=4,K(e);break;case 3:for(t=e.i;;){if(!ie(e)){e.j=!0,C(Error("Unmatched start-group tag: stream EOF"));break}if(4==e.h){e.i!=t&&(e.j=!0,C(Error("Unmatched end-group tag")));break}oe(e)}break;default:e.j=!0,O(e.h,e.l)}}function ae(e,t,n){var r=e.g.i,i=Q(e.g),o=e.g.g+i;if(e.g.i=o,n(t,e),0!=(n=o-e.g.g))throw Error("Message parsing ended unexpectedly. Expected to read "+i+" bytes, instead read "+(i-n)+" bytes, either the data ended unexpectedly or the message misreported its own length");return e.g.g=o,e.g.i=r,t}ee.prototype.length=function(){return this.h},ee.prototype.end=function(){var e=this.g,t=this.h;return this.h=0,B(e,0,t)},re.prototype.reset=function(){this.g.reset(),this.h=this.i=-1};var se=[];function ce(){this.h=[],this.i=0,this.g=new ee}function ue(e,t){0!==t.length&&(e.h.push(t),e.i+=t.length)}function de(e,t,n){ne(e.g,8*t+2),ne(e.g,n.length),ue(e,e.g.end()),ue(e,n)}var le,fe="function"==typeof Symbol&&"symbol"==typeof Symbol()?Symbol(void 0):void 0;function pe(e){return Object.isFrozen(e)||(fe?e[fe]|=1:void 0!==e.g?e.g|=1:Object.defineProperties(e,{g:{value:1,configurable:!0,writable:!0,enumerable:!1}})),e}function he(e){return null!==e&&"object"==typeof e&&e.constructor===Object}function me(e,t){if(null!=e)return Array.isArray(e)||he(e)?ge(e,t):t(e)}function ge(e,t){if(Array.isArray(e)){for(var n=Array(e.length),r=0;r<e.length;r++)n[r]=me(e[r],t);var i;return(t=Array.isArray(e))&&(t=1&(null==(i=fe?e[fe]:e.g)?0:i)),t&&pe(n),n}for(n in i={},e)i[n]=me(e[n],t);return i}function ve(e){return e=function(e){switch(typeof e){case"number":return isFinite(e)?e:String(e);case"object":if(F&&null!=e&&e instanceof Uint8Array)return Z(e);if(e instanceof U){if(null==e.g)e="";else{var t=e.g;t=null==t||"string"==typeof t?t:F&&t instanceof Uint8Array?Z(t):null,e=e.g=t}return e}}return e}(e),Array.isArray(e)?ge(e,ve):e}function ye(e,t,n){var r=le;if(le=null,e||(e=r),r=this.constructor.ha,e||(e=r?[r]:[]),this.i=(r?0:-1)-(this.constructor.fa||0),this.l=this.g=null,this.u=e,e=(r=this.u.length)-1,r&&he(r=this.u[e])?(this.j=e-this.i,this.h=r):void 0!==t&&-1<t?(this.j=Math.max(t,e+1-this.i),this.h=null):this.j=Number.MAX_VALUE,n)for(t=0;t<n.length;t++)(e=n[t])<this.j?(e+=this.i,(r=this.u[e])?Array.isArray(r)&&pe(r):this.u[e]=be):(Se(this),(r=this.h[e])?Array.isArray(r)&&pe(r):this.h[e]=be)}var be=Object.freeze(pe([]));function Se(e){var t=e.j+e.i;e.u[t]||(e.h=e.u[t]={})}function Ee(e,t,n){return-1===t?null:void 0!==n&&n||t>=e.j?e.h?e.h[t]:void 0:e.u[t+e.i]}function _e(e,t,n){var r=Ee(e,t,n=void 0!==n&&n);return null==r&&(r=be),r===be&&Ie(e,t,r=pe(r.slice()),n),r}function Te(e,t){var n=_e(e,t);if(e.l||(e.l={}),!e.l[t]){for(var r=0;r<n.length;r++)n[r]=+n[r];e.l[t]=!0}return n}function Re(e,t,n){return null==(e=null==(e=Ee(e,t))?e:+e)?void 0===n?0:n:e}function Ie(e,t,n,r){void 0!==r&&r||t>=e.j?(Se(e),e.h[t]=n):e.u[t+e.i]=n}function we(e,t,n,r){n!==r?Ie(e,t,n):Ie(e,t,void 0,!1)}function Ce(e,t,n){if(-1===n)return null;e.g||(e.g={});var r=e.g[n];if(r)return r;var i=Ee(e,n,!1);return null==i?r:(t=new t(i),e.g[n]=t)}function Oe(e,t,n){e.g||(e.g={});var r=e.g[n];if(!r){var i=_e(e,n,!1);r=[];for(var o=0;o<i.length;o++)r[o]=new t(i[o]);e.g[n]=r}return r}function Ae(e,t,n,r,i){var o=Oe(e,r,t);n=n||new r,e=_e(e,t),null!=i?(o.splice(i,0,n),e.splice(i,0,n.u)):(o.push(n),e.push(n.u))}function xe(e,t){return null==(e=Ee(e,t))?0:e}function ke(e,t){return null==(e=Ee(e,t))?"":e}function Ne(e,t){if(e=e.m){ue(t,t.g.end());for(var n=0;n<e.length;n++)ue(t,e[n])}}ye.prototype.toJSON=function(){return ge(this.u,ve)},ye.prototype.toString=function(){return this.u.toString()};var Le=Symbol();function Me(e,t,n){return e[Le]||(e[Le]=function(e,r){return t(e,r,n)})}function Ve(e){var t=e[Le];if(!t){var n=e[Ze]||(e[Ze]=e());t=function(e,t){return je(e,t,n)},e[Le]=t}return t}function Pe(e){var t=function(e){var t=e.da;if(t)return Ve(t);if(t=e.ia){var n=e.Y;return delete e.Y,Me(e.W.g,t,n)}}(e),n=e.W,r=e.ea;return t?function(e,i){return r(e,i,n,t)}:function(e,t){return r(e,t,n)}}function De(e){var t=e[0];switch(e.length){case 2:var n=e[1];return function(e,r,i){return t(e,r,i,n)};case 3:var r=e[1],i=Ve(e[2]);return function(e,n,o){return t(e,n,o,r,i)};case 4:var o=e[1],a=e[3],s=Ve(e[2]);return function(e,n,r){return t(e,n,r,o,s,a)};case 5:var c=e[1],u=Me(c,e[3],e[4]);return function(e,n,r){return t(e,n,r,c,u)};case 6:var d=e[1],l=e[5],f=Me(d,e[3],e[4]);return function(e,n,r){return t(e,n,r,d,f,l)};default:throw Error("Unsupported number of parameters, expected [2-6], got "+e.length)}}var Ze=Symbol();function je(e,t,n){for(;ie(t)&&4!=t.h;){var r=t.i,i=n[r];if(i)Array.isArray(i)&&(i=n[r]=De(i));else{var o=n[0];o&&(o=o[r])&&(i=n[r]=Pe(o))}i&&i(t,e,r)||(r=e,o=(i=t).l,oe(i),i.O||(i=B(i.g.h,o,i.g.g),(o=r.m)?o.push(i):r.m=[i]))}return e}function We(e,t){var n=new ce;if(t(e,n),0===(e=n.i+n.g.length()))n=new Uint8Array(0);else{e=new Uint8Array(e);for(var r=n.h,i=r.length,o=t=0;o<i;o++){var a=r[o];0!==a.length&&(e.set(a,t),t+=a.length)}0!==(i=(r=n.g).h)&&(e.set(r.g.subarray(0,i),t),r.h=0),n.h=[e],n=e}return n}function Ge(e,t,n){if(se.length){var r=se.pop();e&&(J(r.g,e),r.i=-1,r.h=-1),e=r}else e=new re(e);try{return je(new t,e,n[Ze]||(n[Ze]=n()))}finally{(t=e.g).h=null,t.l=0,t.i=0,t.g=0,t.j=!1,t.v=!1,e.i=-1,e.h=-1,e.j=!1,100>se.length&&se.push(e)}}function Fe(e,t,n){if(null!=(t=Ee(t,n))){ne(e.g,8*n+5),e=e.g;var r=t;0===(r=(n=0>r?1:0)?-r:r)?H=0<1/r?0:2147483648:isNaN(r)?H=2147483647:34028234663852886e22<r?H=(n<<31|2139095040)>>>0:11754943508222875e-54>r?(r=Math.round(r/Math.pow(2,-149)),H=(n<<31|r)>>>0):(t=Math.floor(Math.log(r)/Math.LN2),r*=Math.pow(2,-t),16777216<=(r=Math.round(8388608*r))&&++t,H=(n<<31|t+127<<23|8388607&r)>>>0),te(e,(n=H)>>>0&255),te(e,n>>>8&255),te(e,n>>>16&255),te(e,n>>>24&255)}}function Ue(e,t,n){if(1!==e.h)return!1;var r=e.g;e=q(r);var i=q(r);r=2*(i>>31)+1;var o=i>>>20&2047;return e=4294967296*(1048575&i)+e,we(t,n,2047==o?e?NaN:1/0*r:0==o?r*Math.pow(2,-1074)*e:r*Math.pow(2,o-1075)*(e+4503599627370496),0),!0}function Xe(e,t,n){return 5===e.h&&(Ie(t,n,e.g.m()),!0)}function Be(e,t,n){if(5!==e.h&&2!==e.h)return!1;if(t=_e(t,n),2==e.h){n=Y.prototype.m;var r=Q(e.g);for(r=e.g.g+r;e.g.g<r;)t.push(n.call(e.g))}else t.push(e.g.m());return!0}function He(e,t,n){return 5===e.h&&(we(t,n,e=e.g.m(),0),!0)}function Ye(e,t,n){return 0===e.h&&(Ie(t,n,z(e.g)),!0)}function Je(e,t,n){return 0===e.h&&(Ie(t,n,Q(e.g)),!0)}function ze(e,t,n){return 0===e.h&&(we(t,n,e=Q(e.g),0),!0)}function Ke(e,t,n){return 0===e.h&&(we(t,n,e=!!Q(e.g),!1),!0)}function Qe(e,t,n){if(2!==e.h)return!1;var r,i=Q(e.g),o=(e=e.g).g;if(e.g+=i,K(e),e=e.h,L)(r=k)||(r=k=new TextDecoder("utf-8",{fatal:!1})),r=r.decode(e.subarray(o,o+i));else{i=o+i;for(var a,s,c,u=[],d=null;o<i;)128>(a=e[o++])?u.push(a):224>a?o>=i?u.push(65533):(s=e[o++],194>a||128!=(192&s)?(o--,u.push(65533)):u.push((31&a)<<6|63&s)):240>a?o>=i-1?u.push(65533):128!=(192&(s=e[o++]))||224===a&&160>s||237===a&&160<=s||128!=(192&(r=e[o++]))?(o--,u.push(65533)):u.push((15&a)<<12|(63&s)<<6|63&r):244>=a?o>=i-2?u.push(65533):128!=(192&(s=e[o++]))||s-144+(a<<28)>>30!=0||128!=(192&(r=e[o++]))||128!=(192&(c=e[o++]))?(o--,u.push(65533)):(a=(7&a)<<18|(63&s)<<12|(63&r)<<6|63&c,a-=65536,u.push(55296+(a>>10&1023),56320+(1023&a))):u.push(65533),8192<=u.length&&(d=x(d,u),u.length=0);r=x(d,u)}return Ie(t,n,r),!0}function qe(e,t,n,r,i){return 2===e.h&&(e=ae(e,new r,i),t.g||(t.g={}),r=e&&e.u,t.g[n]=e,Ie(t,n,r,!1),!0)}function $e(e,t,n,r,i){return 2===e.h&&(Ae(t,n,e=ae(e,new r,i),r,void 0),!0)}function et(e,t,n){return 0===e.h&&(Ie(t,n,z(e.g)),!0)}function tt(e){ye.call(this,e)}function nt(){return{1:Je,2:Xe,3:Qe,4:Qe}}function rt(e,t){var n=Ee(e,1);if(null!=n&&null!=n){ne(t.g,8);var r=t.g;if(0<=n)ne(r,n);else{for(var i=0;9>i;i++)te(r,127&n|128),n>>=7;te(r,1)}}Fe(t,e,2),null!=(r=Ee(e,3))&&de(t,3,V(r)),null!=(r=Ee(e,4))&&de(t,4,V(r)),Ne(e,t)}function it(e){ye.call(this,e,-1,at)}function ot(){return{1:[$e,tt,nt]}}h(tt,ye),h(it,ye),it.prototype.addClassification=function(e,t){return Ae(this,1,e,tt,t),this};var at=[1];function st(e){ye.call(this,e)}function ct(){return{1:Xe,2:Xe,3:Xe,4:Xe,5:Xe}}function ut(e,t){Fe(t,e,1),Fe(t,e,2),Fe(t,e,3),Fe(t,e,4),Fe(t,e,5),Ne(e,t)}function dt(e){ye.call(this,e,-1,ft)}function lt(){return{1:[$e,st,ct]}}h(st,ye),h(dt,ye);var ft=[1];function pt(e){ye.call(this,e)}function ht(){return{1:Xe,2:Xe,3:Xe,4:Xe,5:Xe,6:Ye}}function mt(e,t){Fe(t,e,1),Fe(t,e,2),Fe(t,e,3),Fe(t,e,4),Fe(t,e,5);var n=Ee(e,6);if(null!=n&&null!=n){ne(t.g,48);var r=t.g,i=n;n=0>i;var o=(i=Math.abs(i))>>>0;for(i=Math.floor((i-o)/4294967296),i>>>=0,n&&(i=~i>>>0,4294967295<(o=1+(~o>>>0))&&(o=0,4294967295<++i&&(i=0))),n=H=o,o=i;0<o||127<n;)te(r,127&n|128),n=(n>>>7|o<<25)>>>0,o>>>=7;te(r,n)}Ne(e,t)}function gt(e){ye.call(this,e,-1,St)}function vt(){return{1:et,2:et,3:Be,4:[qe,yt,bt],5:Je,6:Je,7:Be,8:Be,9:Be}}function yt(e){ye.call(this,e)}function bt(){return{1:Xe,2:Xe,3:Xe}}h(pt,ye),h(gt,ye),h(yt,ye);var St=[3,7,8,9];function Et(e){ye.call(this,e)}function _t(){return{1:He,2:He,3:He}}function Tt(e){ye.call(this,e)}function Rt(){return{1:He,2:He,3:He}}function It(e){ye.call(this,e)}function wt(){return{1:ze,2:[qe,Tt,Rt],3:[qe,Et,_t],4:Ke}}function Ct(e){ye.call(this,e,-1,At)}function Ot(){return{1:ze,2:[$e,It,wt],3:He,4:Be,5:Be,6:Be}}h(Et,ye),h(Tt,ye),h(It,ye),h(Ct,ye);var At=[2,4,5,6];function xt(e){ye.call(this,e,-1,Nt)}function kt(){return{1:ze,2:[$e,Ct,Ot],3:[qe,gt,vt],4:Ue,5:Be,6:Be}}h(xt,ye);var Nt=[2,5,6];function Lt(e,t,n){if(n=e.createShader(0===n?e.VERTEX_SHADER:e.FRAGMENT_SHADER),e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw Error("Could not compile WebGL shader.\n\n"+e.getShaderInfoLog(n));return n}function Mt(e){return Oe(e,tt,1).map((function(e){return{index:xe(e,1),$:Re(e,2),label:null!=Ee(e,3)?ke(e,3):void 0,displayName:null!=Ee(e,4)?ke(e,4):void 0}}))}function Vt(e){return{x:Re(e,1),y:Re(e,2),z:Re(e,3),visibility:null!=Ee(e,4)?Re(e,4):void 0}}function Pt(e,t){this.h=e,this.g=t,this.l=0}function Dt(t,n,r){return function(e,t){var n=e.g;if(void 0===e.m){var r=Lt(n,"\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }",0),i=Lt(n,"\n  precision mediump float;\n  varying vec2 vTex;\n  uniform sampler2D sampler0;\n  void main(){\n    gl_FragColor = texture2D(sampler0, vTex);\n  }",1),o=n.createProgram();if(n.attachShader(o,r),n.attachShader(o,i),n.linkProgram(o),!n.getProgramParameter(o,n.LINK_STATUS))throw Error("Could not compile WebGL program.\n\n"+n.getProgramInfoLog(o));r=e.m=o,n.useProgram(r),i=n.getUniformLocation(r,"sampler0"),e.j={J:n.getAttribLocation(r,"aVertex"),I:n.getAttribLocation(r,"aTex"),ja:i},e.s=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,e.s),n.enableVertexAttribArray(e.j.J),n.vertexAttribPointer(e.j.J,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),e.o=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,e.o),n.enableVertexAttribArray(e.j.I),n.vertexAttribPointer(e.j.I,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.uniform1i(i,0)}r=e.j,n.useProgram(e.m),n.canvas.width=t.width,n.canvas.height=t.height,n.viewport(0,0,t.width,t.height),n.activeTexture(n.TEXTURE0),e.h.bindTexture2d(t.glName),n.enableVertexAttribArray(r.J),n.bindBuffer(n.ARRAY_BUFFER,e.s),n.vertexAttribPointer(r.J,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(r.I),n.bindBuffer(n.ARRAY_BUFFER,e.o),n.vertexAttribPointer(r.I,2,n.FLOAT,!1,0,0),n.bindFramebuffer(n.DRAW_FRAMEBUFFER?n.DRAW_FRAMEBUFFER:n.FRAMEBUFFER,null),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.colorMask(!0,!0,!0,!0),n.drawArrays(n.TRIANGLE_FAN,0,4),n.disableVertexAttribArray(r.J),n.disableVertexAttribArray(r.I),n.bindBuffer(n.ARRAY_BUFFER,null),e.h.bindTexture2d(0)}(t,n),"function"==typeof t.g.canvas.transferToImageBitmap?e.resolve(t.g.canvas.transferToImageBitmap()):r?e.resolve(t.g.canvas):"function"==typeof createImageBitmap?createImageBitmap(t.g.canvas):(void 0===t.i&&(t.i=document.createElement("canvas")),new e((function(e){t.i.height=t.g.canvas.height,t.i.width=t.g.canvas.width,t.i.getContext("2d",{}).drawImage(t.g.canvas,0,0,t.g.canvas.width,t.g.canvas.height),e(t.i)})))}function Zt(e){this.g=e}var jt=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function Wt(e,t){return t+e}function Gt(e,t){window[e]=t}function Ft(t){if(this.g=t,this.listeners={},this.j={},this.G={},this.m={},this.s={},this.H=this.o=this.S=!0,this.D=e.resolve(),this.R="",this.C={},this.locateFile=t&&t.locateFile||Wt,"object"==typeof window)var n=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if(!(typeof location<"u"))throw Error("solutions can only be loaded on a web page or in a web worker");n=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}if(this.T=n,t.options)for(var r=(n=s(Object.keys(t.options))).next();!r.done;r=n.next()){r=r.value;var i=t.options[r].default;void 0!==i&&(this.j[r]="function"==typeof i?i():i)}}function Ut(t){var n,r,i,o,a,s,u,d,l,f,p;return T((function(h){switch(h.g){case 1:return t.S?(n=void 0===t.g.files?[]:"function"==typeof t.g.files?t.g.files(t.j):t.g.files,y(h,T((function(e){switch(e.g){case 1:return e.m=2,y(e,WebAssembly.instantiate(jt),4);case 4:e.g=3,e.m=0;break;case 2:return e.m=0,e.j=null,e.return(!1);case 3:return e.return(!0)}})),2)):h.return();case 2:if(r=h.h,"object"==typeof window)return Gt("createMediapipeSolutionsWasm",{locateFile:t.locateFile}),Gt("createMediapipeSolutionsPackedAssets",{locateFile:t.locateFile}),s=n.filter((function(e){return void 0!==e.data})),u=n.filter((function(e){return void 0===e.data})),d=e.all(s.map((function(n){var r=Xt(t,n.url);if(void 0!==n.path){var i=n.path;r=r.then((function(n){return t.overrideFile(i,n),e.resolve(n)}))}return r}))),l=e.all(u.map((function(n){return void 0===n.simd||n.simd&&r||!n.simd&&!r?function(t){var n=document.createElement("script");return n.setAttribute("src",t),n.setAttribute("crossorigin","anonymous"),new e((function(e){n.addEventListener("load",(function(){e()}),!1),n.addEventListener("error",(function(){e()}),!1),document.body.appendChild(n)}))}(t.locateFile(n.url,t.T)):e.resolve()}))).then((function(){var e,n,r;return T((function(i){if(1==i.g)return e=window.createMediapipeSolutionsWasm,n=window.createMediapipeSolutionsPackedAssets,r=t,y(i,e(n),2);r.h=i.h,i.g=0}))})),f=T((function(e){return t.g.graph&&t.g.graph.url?e=y(e,Xt(t,t.g.graph.url),0):(e.g=0,e=void 0),e})),y(h,e.all([l,d,f]),7);if("function"!=typeof importScripts)throw Error("solutions can only be loaded on a web page or in a web worker");return i=n.filter((function(e){return void 0===e.simd||e.simd&&r||!e.simd&&!r})).map((function(e){return t.locateFile(e.url,t.T)})),importScripts.apply(null,c(i)),o=t,y(h,createMediapipeSolutionsWasm(Module),6);case 6:o.h=h.h,t.l=new OffscreenCanvas(1,1),t.h.canvas=t.l,a=t.h.GL.createContext(t.l,{antialias:!1,alpha:!1,ga:typeof WebGL2RenderingContext<"u"?2:1}),t.h.GL.makeContextCurrent(a),h.g=4;break;case 7:if(t.l=document.createElement("canvas"),!(p=t.l.getContext("webgl2",{}))&&!(p=t.l.getContext("webgl",{})))return alert("Failed to create WebGL canvas context when passing video frame."),h.return();t.F=p,t.h.canvas=t.l,t.h.createContext(t.l,!0,!0,{});case 4:t.i=new t.h.SolutionWasm,t.S=!1,h.g=0}}))}function Xt(e,t){var n,r;return T((function(i){return t in e.G?i.return(e.G[t]):(n=e.locateFile(t,""),r=fetch(n).then((function(e){return e.arrayBuffer()})),e.G[t]=r,i.return(r))}))}function Bt(e,t,n){var r,i,o,a,c,u,d,l,f,p,h,m,g,v;return T((function(b){switch(b.g){case 1:if(!n)return b.return(t);for(r={},i=0,o=s(Object.keys(n)),a=o.next();!a.done;a=o.next())c=a.value,"string"!=typeof(u=n[c])&&"texture"===u.type&&void 0!==t[u.stream]&&++i;1<i&&(e.H=!1),d=s(Object.keys(n)),a=d.next();case 2:if(a.done){b.g=4;break}if(l=a.value,"string"==typeof(f=n[l]))return g=r,v=l,y(b,function(e,t,n){var r;return T((function(i){return"number"==typeof n||n instanceof Uint8Array||n instanceof e.h.Uint8BlobList?i.return(n):n instanceof e.h.Texture2dDataOut?((r=e.s[t])||(r=new Pt(e.h,e.F),e.s[t]=r),i.return(Dt(r,n,e.H))):i.return(void 0)}))}(e,l,t[f]),14);if(p=t[f.stream],"detection_list"===f.type){if(p){for(var S=p.getRectList(),E=p.getLandmarksList(),_=p.getClassificationsList(),R=[],I=0;I<S.size();++I){var w=Ge(S.get(I),pt,ht);w={U:{aa:Re(w,1),ba:Re(w,2),height:Re(w,3),width:Re(w,4),rotation:Re(w,5,0),Z:xe(w,6)},P:Oe(Ge(E.get(I),dt,lt),st,1).map(Vt),N:Mt(Ge(_.get(I),it,ot))},R.push(w)}S=R}else S=[];r[l]=S,b.g=7;break}if("proto_list"===f.type){if(p){for(S=Array(p.size()),E=0;E<p.size();E++)S[E]=p.get(E);p.delete()}else S=[];r[l]=S,b.g=7;break}if(void 0===p){b.g=3;break}if("float_list"===f.type){r[l]=p,b.g=7;break}if("proto"===f.type){r[l]=p,b.g=7;break}if("texture"!==f.type)throw Error("Unknown output config type: '"+f.type+"'");return(h=e.s[l])||(h=new Pt(e.h,e.F),e.s[l]=h),y(b,Dt(h,p,e.H),13);case 13:m=b.h,r[l]=m;case 7:f.transform&&r[l]&&(r[l]=f.transform(r[l])),b.g=3;break;case 14:g[v]=b.h;case 3:a=d.next(),b.g=2;break;case 4:return b.return(r)}}))}function Ht(e,t){for(var n=t.name||"$",r=[].concat(c(t.wants)),i=new e.h.StringList,o=s(t.wants),a=o.next();!a.done;a=o.next())i.push_back(a.value);o=e.h.PacketListener.implement({onResults:function(i){for(var o={},a=0;a<t.wants.length;++a)o[r[a]]=i.get(a);var s=e.listeners[n];s&&(e.D=Bt(e,o,t.outs).then((function(n){n=s(n);for(var i=0;i<t.wants.length;++i){var a=o[r[i]];"object"==typeof a&&a.hasOwnProperty&&a.hasOwnProperty("delete")&&a.delete()}n&&(e.D=n)})))}}),e.i.attachMultiListener(i,o),i.delete()}function Yt(e){var t=xe(e,1),n=Ce(e,Et,3);return{id:t,point2d:n={x:Re(n,1),y:Re(n,2),depth:Re(n,3)},point3d:{x:Re(e=Ce(e,Tt,2),1),y:Re(e,2),z:Re(e,3)}}}function Jt(e){var t=Ge(e,xt,kt);e=[],t=Oe(t,Ct,2);for(var n=0;n<t.length;n++)e.push({id:xe(t[n],1),keypoints:Oe(t[n],It,2).map(Yt),visibility:Re(t[n],3),scale:Te(t[n],6),translation:Te(t[n],5),rotation:Te(t[n],4)});return e}function zt(e){switch(e){case"Camera":return"Camera";case"Chair":return"Chair";case"Cup":return"Coffee cup, Mug";default:return"Footwear"}}(t=Ft.prototype).close=function(){return this.i&&this.i.delete(),e.resolve()},t.reset=function(){var e=this;return T((function(t){e.i&&(e.i.reset(),e.m={},e.s={}),t.g=0}))},t.setOptions=function(e,t){var n=this;if(t=t||this.g.options){for(var r=[],i=[],o={},a=s(Object.keys(e)),c=a.next();!c.done;o={L:o.L,M:o.M},c=a.next()){var u=c.value;u in this.j&&this.j[u]===e[u]||(this.j[u]=e[u],void 0!==(c=t[u])&&(c.onChange&&(o.L=c.onChange,o.M=e[u],r.push(function(e){return function(){return T((function(t){if(1==t.g)return y(t,e.L(e.M),2);!0===t.h&&(n.o=!0),t.g=0}))}}(o))),c.graphOptionXref&&(u={valueNumber:1===c.type?e[u]:0,valueBoolean:0===c.type&&e[u],valueString:2===c.type?e[u]:""},c=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),c.graphOptionXref),u),i.push(c))))}(0!==r.length||0!==i.length)&&(this.o=!0,this.B=(void 0===this.B?[]:this.B).concat(i),this.A=(void 0===this.A?[]:this.A).concat(r))}},t.initialize=function(){var e=this;return T((function(t){return 1==t.g?y(t,Ut(e),2):3!=t.g?y(t,function(e){var t,n,r,i,o,a,c,u;return T((function(d){if(1==d.g)return e.g.graph&&e.g.graph.url&&e.R===e.g.graph.url?d.return():(e.o=!0,e.g.graph&&e.g.graph.url?(e.R=e.g.graph.url,y(d,Xt(e,e.g.graph.url),3)):void(d.g=2));for(2!=d.g&&(t=d.h,e.i.loadGraph(t)),n=s(Object.keys(e.C)),r=n.next();!r.done;r=n.next())i=r.value,e.i.overrideFile(i,e.C[i]);if(e.C={},e.g.listeners)for(o=s(e.g.listeners),a=o.next();!a.done;a=o.next())c=a.value,Ht(e,c);u=e.j,e.j={},e.setOptions(u),d.g=0}))}(e),3):y(t,function(e){var t,n,r,i,o,a;return T((function(c){switch(c.g){case 1:if(!e.o)return c.return();if(!e.A){c.g=2;break}t=s(e.A),n=t.next();case 3:if(n.done){c.g=5;break}return y(c,(0,n.value)(),4);case 4:n=t.next(),c.g=3;break;case 5:e.A=void 0;case 2:if(e.B){for(r=new e.h.GraphOptionChangeRequestList,i=s(e.B),o=i.next();!o.done;o=i.next())a=o.value,r.push_back(a);e.i.changeOptions(r),r.delete(),e.B=void 0}e.o=!1,c.g=0}}))}(e),0)}))},t.overrideFile=function(e,t){this.i?this.i.overrideFile(e,t):this.C[e]=t},t.clearOverriddenFiles=function(){this.C={},this.i&&this.i.clearOverriddenFiles()},t.send=function(e,t){var n,r,i,o,a,c,u,d,l,f=this;return T((function(p){switch(p.g){case 1:return f.g.inputs?(n=1e3*(null==t?performance.now():t),y(p,f.D,2)):p.return();case 2:return y(p,f.initialize(),3);case 3:for(r=new f.h.PacketDataList,i=s(Object.keys(e)),o=i.next();!o.done;o=i.next())if(a=o.value,c=f.g.inputs[a]){e:{var h=e[a];switch(c.type){case"video":var m=f.m[c.stream];if(m||(m=new Pt(f.h,f.F),f.m[c.stream]=m),0===m.l&&(m.l=m.h.createTexture()),typeof HTMLVideoElement<"u"&&h instanceof HTMLVideoElement)var g=h.videoWidth,v=h.videoHeight;else typeof HTMLImageElement<"u"&&h instanceof HTMLImageElement?(g=h.naturalWidth,v=h.naturalHeight):(g=h.width,v=h.height);v={glName:m.l,width:g,height:v},(g=m.g).canvas.width=v.width,g.canvas.height=v.height,g.activeTexture(g.TEXTURE0),m.h.bindTexture2d(m.l),g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,h),m.h.bindTexture2d(0),m=v;break e;case"detections":for((m=f.m[c.stream])||(m=new Zt(f.h),f.m[c.stream]=m),m.data||(m.data=new m.g.DetectionListData),m.data.reset(h.length),v=0;v<h.length;++v){g=h[v];var b=m.data,S=b.setBoundingBox,E=v,_=g.U,T=new pt;if(Ie(T,1,_.aa),Ie(T,2,_.ba),Ie(T,3,_.height),Ie(T,4,_.width),Ie(T,5,_.rotation),Ie(T,6,_.Z),_=We(T,mt),S.call(b,E,_),g.P)for(b=0;b<g.P.length;++b){var R=!!(T=g.P[b]).visibility;E=(S=m.data).addNormalizedLandmark,_=v,T=Object.assign(Object.assign({},T),{visibility:R?T.visibility:0}),Ie(R=new st,1,T.x),Ie(R,2,T.y),Ie(R,3,T.z),T.visibility&&Ie(R,4,T.visibility),T=We(R,ut),E.call(S,_,T)}if(g.N)for(b=0;b<g.N.length;++b)E=(S=m.data).addClassification,_=v,T=g.N[b],Ie(R=new tt,2,T.$),T.index&&Ie(R,1,T.index),T.label&&Ie(R,3,T.label),T.displayName&&Ie(R,4,T.displayName),T=We(R,rt),E.call(S,_,T)}m=m.data;break e;default:m={}}}switch(u=m,d=c.stream,c.type){case"video":r.pushTexture2d(Object.assign(Object.assign({},u),{stream:d,timestamp:n}));break;case"detections":(l=u).stream=d,l.timestamp=n,r.pushDetectionList(l);break;default:throw Error("Unknown input config type: '"+c.type+"'")}}return f.i.send(r),y(p,f.D,4);case 4:r.delete(),p.g=0}}))},t.onResults=function(e,t){this.listeners[t||"$"]=e},w("Solution",Ft),w("OptionType",{BOOL:0,NUMBER:1,ca:2,0:"BOOL",1:"NUMBER",2:"STRING"});var Kt={focalX:{type:1,graphOptionXref:{calculatorType:"Lift2DFrameAnnotationTo3DCalculator",fieldName:"normalized_focal_x"}},focalY:{type:1,graphOptionXref:{calculatorType:"Lift2DFrameAnnotationTo3DCalculator",fieldName:"normalized_focal_y"}},principalX:{type:1,graphOptionXref:{calculatorType:"Lift2DFrameAnnotationTo3DCalculator",fieldName:"normalized_principal_point_x"}},principalY:{type:1,graphOptionXref:{calculatorType:"Lift2DFrameAnnotationTo3DCalculator",fieldName:"normalized_principal_point_y"}},allowedLabels:{type:2,graphOptionXref:{calculatorName:"ConstantSidePacketCalculatorAllowedLabels",calculatorType:"ConstantSidePacketCalculator",fieldName:"string_value"}}};function Qt(e){var t=this;e=e||{},this.g=new Ft({locateFile:e.locateFile,files:[{url:"objectron_solution_packed_assets_loader.js"},{simd:!1,url:"objectron_solution_wasm_bin.js"},{simd:!0,url:"objectron_solution_simd_wasm_bin.js"}],graph:{url:"objectron.binarypb"},inputs:{image:{type:"video",stream:"input_frames_gpu"}},listeners:[{wants:["lifted_objects","image_transformed"],outs:{image:"image_transformed",objectDetections:{type:"proto",stream:"lifted_objects",transform:Jt}}}],options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:"object"==typeof window&&void 0!==window.navigator&&("iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document)},selfieMode:{type:0,default:!1,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},maxNumObjects:{type:1,default:5,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorMaxNumObjects",fieldName:"int_value"}},staticImageMode:{type:0,default:!0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"objectrongpusubgraph__ConstantSidePacketCalculator",fieldName:"bool_value"}},minDetectionConfidence:{type:1,default:.5,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"objectrongpusubgraph__objectdetectionoidv4subgraph__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,default:.99,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"objectrongpusubgraph__boxlandmarksubgraph__ThresholdingCalculator",fieldName:"threshold"}},modelName:{default:"Shoe",onChange:function(e){var n,r,i,o;return T((function(a){return 1==a.g?(n=e,t.g.setOptions({allowedLabels:zt(n)},Kt),r=function(e){switch(e){case"Camera":return"object_detection_3d_camera.tflite";case"Chair":return"object_detection_3d_chair.tflite";case"Cup":return"object_detection_3d_cup.tflite";default:return"object_detection_3d_sneakers.tflite"}}(n),i="object_detection_3d.tflite",y(a,Xt(t.g,r),2)):(o=a.h,t.g.overrideFile(i,o),a.return(!0))}))}},focalLength:{default:[1,1],onChange:function(e){var n;return T((function(r){return n=e,t.h=n,t.g.setOptions({focalX:n[0],focalY:n[1]},Kt),r.return(!0)}))}},principalPoint:{default:[0,0],onChange:function(e){var n;return T((function(r){return n=e,t.i=n,t.g.setOptions({principalX:n[0],principalY:n[1]},Kt),r.return(!0)}))}},imageSize:{onChange:function(e){var n,r,i,o;return T((function(a){if(void 0===t.h||void 0===t.i)return console.error('"focalLength" and "principalPoint" must be set if setting image size'),a.return();r=[(n=e)[0]/2,n[1]/2],i=[t.h[0]/r[0],t.h[1]/r[1]],o=[t.i[0]/r[0],t.i[1]/r[1]],t.setOptions({focalLength:i,principalPoint:o}),a.g=0}))}}}})}(t=Qt.prototype).close=function(){return this.g.close(),e.resolve()},t.onResults=function(e){this.g.onResults(e)},t.initialize=function(){var e=this;return T((function(t){return y(t,e.g.initialize(),0)}))},t.reset=function(){this.g.reset()},t.send=function(e){var t=this;return T((function(n){return y(n,t.g.send(e),0)}))},t.setOptions=function(e){this.g.setOptions(e)},w("Objectron",Qt),w("BOX_CONNECTIONS",[[1,2],[2,4],[4,3],[3,1],[5,6],[6,8],[8,7],[7,5],[1,5],[2,6],[3,7],[4,8]]),w("BOX_KEYPOINTS",{CENTER:0,BACK_BOTTOM_LEFT:1,FRONT_BOTTOM_LEFT:2,BACK_TOP_LEFT:3,FRONT_TOP_LEFT:4,BACK_BOTTOM_RIGHT:5,FRONT_BOTTOM_RIGHT:6,BACK_TOP_RIGHT:7,FRONT_TOP_RIGHT:8}),w("VERSION","0.4.1636596145")}).call(we);const Ce={};(function(){var t;function n(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var r="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},i=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof(void 0!==typeof window?window:global)&&(void 0!==typeof window?window:global)];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function o(e,t){if(t)e:{var n=i;e=e.split(".");for(var o=0;o<e.length-1;o++){var a=e[o];if(!(a in n))break e;n=n[a]}(t=t(o=n[e=e[e.length-1]]))!=o&&null!=t&&r(n,e,{configurable:!0,writable:!0,value:t})}}function a(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function s(e){var t=typeof Symbol<"u"&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:n(e)}}function c(e){if(!(e instanceof Array)){e=s(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}o("Symbol",(function(e){function t(e,t){this.g=e,r(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.g};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",i=0;return function e(r){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(r||"")+"_"+i++,r)}})),o("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),o=0;o<t.length;o++){var s=i[t[o]];"function"==typeof s&&"function"!=typeof s.prototype[e]&&r(s.prototype,e,{configurable:!0,writable:!0,value:function(){return a(n(this))}})}return e}));var u,d="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)u=Object.setPrototypeOf;else{var l;e:{var f={};try{f.__proto__={a:!0},l=f.a;break e}catch{}l=!1}u=l?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var p=u;function h(e,t){if(e.prototype=d(t.prototype),e.prototype.constructor=e,p)p(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var r=Object.getOwnPropertyDescriptor(t,n);r&&Object.defineProperty(e,n,r)}else e[n]=t[n];e.ea=t.prototype}function m(){this.l=!1,this.i=null,this.h=void 0,this.g=1,this.s=this.m=0,this.j=null}function g(e){if(e.l)throw new TypeError("Generator is already running");e.l=!0}function v(e,t){e.j={U:t,V:!0},e.g=e.m||e.s}function y(e,t,n){return e.g=n,{value:t}}function b(e){this.g=new m,this.h=e}function S(e,t,n,r){try{var i=t.call(e.g.i,n);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return e.g.l=!1,i;var o=i.value}catch(t){return e.g.i=null,v(e.g,t),E(e)}return e.g.i=null,r.call(e.g,o),E(e)}function E(e){for(;e.g.g;)try{var t=e.h(e.g);if(t)return e.g.l=!1,{value:t.value,done:!1}}catch(t){e.g.h=void 0,v(e.g,t)}if(e.g.l=!1,e.g.j){if(t=e.g.j,e.g.j=null,t.V)throw t.U;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function _(e){this.next=function(t){return g(e.g),e.g.i?t=S(e,e.g.i.next,t,e.g.o):(e.g.o(t),t=E(e)),t},this.throw=function(t){return g(e.g),e.g.i?t=S(e,e.g.i.throw,t,e.g.o):(v(e.g,t),t=E(e)),t},this.return=function(t){return function(e,t){g(e.g);var n=e.g.i;return n?S(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),E(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function T(t){return function(t){function n(e){return t.next(e)}function r(e){return t.throw(e)}return new e((function(i,o){!function t(a){a.done?i(a.value):e.resolve(a.value).then(n,r).then(t,o)}(t.next())}))}(new _(new b(t)))}m.prototype.o=function(e){this.h=e},m.prototype.return=function(e){this.j={return:e},this.g=this.s},o("Promise",(function(e){function t(e){this.h=0,this.i=void 0,this.g=[],this.o=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function n(){this.g=null}function r(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;n.prototype.h=function(e){if(null==this.g){this.g=[];var t=this;this.i((function(){t.l()}))}this.g.push(e)};var o=i.setTimeout;n.prototype.i=function(e){o(e,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.j(e)}}}this.g=null},n.prototype.j=function(e){this.i((function(){throw e}))},t.prototype.j=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.C),reject:e(this.l)}},t.prototype.C=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.F(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.v(e):this.m(e)}},t.prototype.v=function(e){var t=void 0;try{t=e.then}catch(e){return void this.l(e)}"function"==typeof t?this.G(t,e):this.m(e)},t.prototype.l=function(e){this.s(2,e)},t.prototype.m=function(e){this.s(1,e)},t.prototype.s=function(e,t){if(0!=this.h)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.h);this.h=e,this.i=t,2===this.h&&this.D(),this.A()},t.prototype.D=function(){var e=this;o((function(){if(e.B()){var t=i.console;typeof t<"u"&&t.error(e.i)}}),1)},t.prototype.B=function(){if(this.o)return!1;var e=i.CustomEvent,t=i.Event,n=i.dispatchEvent;return typeof n>"u"||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=i.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.i,n(e))},t.prototype.A=function(){if(null!=this.g){for(var e=0;e<this.g.length;++e)a.h(this.g[e]);this.g=null}};var a=new n;return t.prototype.F=function(e){var t=this.j();e.J(t.resolve,t.reject)},t.prototype.G=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(e){o(e)}}:t}var i,o,a=new t((function(e,t){i=e,o=t}));return this.J(r(e,i),r(n,o)),a},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.J=function(e,t){function n(){switch(r.h){case 1:e(r.i);break;case 2:t(r.i);break;default:throw Error("Unexpected state: "+r.h)}}var r=this;null==this.g?a.h(n):this.g.push(n),this.o=!0},t.resolve=r,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var i=s(e),o=i.next();!o.done;o=i.next())r(o.value).J(t,n)}))},t.all=function(e){var n=s(e),i=n.next();return i.done?r([]):new t((function(e,t){function o(t){return function(n){a[t]=n,0==--s&&e(a)}}var a=[],s=0;do{a.push(void 0),s++,r(i.value).J(o(a.length-1),t),i=n.next()}while(!i.done)}))},t}));var R="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e};o("Object.assign",(function(e){return e||R})),o("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}})),o("Array.prototype.includes",(function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var r=n.length;for(0>(t=t||0)&&(t=Math.max(t+r,0));t<r;t++){var i=n[t];if(i===e||Object.is(i,e))return!0}return!1}})),o("String.prototype.includes",(function(e){return e||function(e,t){if(null==this)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return-1!==this.indexOf(e,t||0)}})),o("Array.prototype.keys",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,(function(e){return e}))}}));var I=this||self;function w(e,t){e=e.split(".");var n,r=I;e[0]in r||typeof r.execScript>"u"||r.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)e.length||void 0===t?r=r[n]&&r[n]!==Object.prototype[n]?r[n]:r[n]={}:r[n]=t}function C(e){!function(e){I.setTimeout((function(){throw e}),0)}(e)}function O(e,t){C(Error("Invalid wire type: "+e+" (at position "+t+")"))}function A(){C(Error("Failed to read varint, encoding is invalid."))}function x(e,t){return t=String.fromCharCode.apply(null,t),null==e?t:e+t}var k,N,L=typeof TextDecoder<"u",M=typeof TextEncoder<"u";function V(e){if(M)e=(N||(N=new TextEncoder)).encode(e);else{var t=void 0;t=void 0!==t&&t;for(var n=0,r=new Uint8Array(3*e.length),i=0;i<e.length;i++){var o=e.charCodeAt(i);if(128>o)r[n++]=o;else{if(2048>o)r[n++]=o>>6|192;else{if(55296<=o&&57343>=o){if(56319>=o&&i<e.length){var a=e.charCodeAt(++i);if(56320<=a&&57343>=a){o=1024*(o-55296)+a-56320+65536,r[n++]=o>>18|240,r[n++]=o>>12&63|128,r[n++]=o>>6&63|128,r[n++]=63&o|128;continue}i--}if(t)throw Error("Found an unpaired surrogate");o=65533}r[n++]=o>>12|224,r[n++]=o>>6&63|128}r[n++]=63&o|128}}e=r.subarray(0,n)}return e}var P={},D=null;function Z(e){var t;void 0===t&&(t=0),W(),t=P[t];for(var n=Array(Math.floor(e.length/3)),r=t[64]||"",i=0,o=0;i<e.length-2;i+=3){var a=e[i],s=e[i+1],c=e[i+2],u=t[a>>2];a=t[(3&a)<<4|s>>4],s=t[(15&s)<<2|c>>6],c=t[63&c],n[o++]=u+a+s+c}switch(u=0,c=r,e.length-i){case 2:c=t[(15&(u=e[i+1]))<<2]||r;case 1:e=e[i],n[o]=t[e>>2]+t[(3&e)<<4|u>>4]+c+r}return n.join("")}function j(e){var t=e.length,n=3*t/4;n%3?n=Math.floor(n):-1!="=.".indexOf(e[t-1])&&(n=-1!="=.".indexOf(e[t-2])?n-2:n-1);var r=new Uint8Array(n),i=0;return function(e,t){function n(t){for(;r<e.length;){var n=e.charAt(r++),i=D[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return t}W();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;t(i<<2|o>>4),64!=a&&(t(o<<4&240|a>>2),64!=s&&t(a<<6&192|s))}}(e,(function(e){r[i++]=e})),r.subarray(0,i)}function W(){if(!D){D={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++){var r=e.concat(t[n].split(""));P[n]=r;for(var i=0;i<r.length;i++){var o=r[i];void 0===D[o]&&(D[o]=i)}}}}var G,F="function"==typeof Uint8Array;function U(e){if(this.g=e,null!==e&&0===e.length)throw Error("ByteString should be constructed with non-empty values")}U.prototype.toJSON=function(){if(null==this.g)var e="";else e=this.g,e=this.g=null==e||"string"==typeof e?e:F&&e instanceof Uint8Array?Z(e):null;return e};var X="function"==typeof Uint8Array.prototype.slice;function B(e,t,n){return t===n?G||(G=new Uint8Array(0)):X?e.slice(t,n):new Uint8Array(e.subarray(t,n))}var H=0;function Y(e,t){t=void 0!==(t=void 0===t?{}:t).u&&t.u,this.h=null,this.g=this.i=this.l=0,this.j=!1,this.u=t,e&&J(this,e)}function J(e,t){e.h=function(e){if(e.constructor===Uint8Array)return e;if(e.constructor===ArrayBuffer)return new Uint8Array(e);if(e.constructor===Array)return new Uint8Array(e);if(e.constructor===String)return j(e);if(e.constructor===U){if(null==e.g)var t=G||(G=new Uint8Array(0));else{t=Uint8Array;var n=e.g;n=null==n||F&&null!=n&&n instanceof Uint8Array?n:"string"==typeof n?j(n):null,t=new t(e=e.g=n)}return t}if(e instanceof Uint8Array)return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, or Array of numbers")}(t),e.l=0,e.i=e.h.length,e.g=e.l}function z(e){e.g>e.i&&(e.j=!0,C(Error("Tried to read past the end of the data "+e.g+" > "+e.i)))}function K(e){var t=e.h,n=t[e.g],r=127&n;return 128>n?(e.g+=1,z(e),r):(r|=(127&(n=t[e.g+1]))<<7,128>n?(e.g+=2,z(e),r):(r|=(127&(n=t[e.g+2]))<<14,128>n?(e.g+=3,z(e),r):(r|=(127&(n=t[e.g+3]))<<21,128>n?(e.g+=4,z(e),r):(r|=(15&(n=t[e.g+4]))<<28,128>n?(e.g+=5,z(e),r>>>0):(e.g+=5,128<=t[e.g++]&&128<=t[e.g++]&&128<=t[e.g++]&&128<=t[e.g++]&&128<=t[e.g++]?(e.j=!0,A(),r):(z(e),r))))))}Y.prototype.reset=function(){this.g=this.l};var Q=[];function q(){this.g=new Uint8Array(64),this.h=0}function $(e,t){if(!(e.h+1<e.g.length)){var n=e.g;e.g=new Uint8Array(Math.ceil(1+2*e.g.length)),e.g.set(n)}e.g[e.h++]=t}function ee(e,t){for(;127<t;)$(e,127&t|128),t>>>=7;$(e,t)}function te(e){var t={},n=void 0!==t.N&&t.N;this.m={u:void 0!==t.u&&t.u},this.N=n,t=this.m,Q.length?(n=Q.pop(),t&&(n.u=t.u),e&&J(n,e),e=n):e=new Y(e,t),this.g=e,this.l=this.g.g,this.h=this.i=-1,this.j=!1}function ne(e){var t=e.g;if((t=t.g==t.i)||(t=e.j)||(t=(t=e.g).j||0>t.g||t.g>t.i),t)return!1;e.l=e.g.g;var n=K(e.g);return t=n>>>3,0<=(n&=7)&&5>=n?(e.i=t,e.h=n,!0):(e.j=!0,O(n,e.l),!1)}function re(e){switch(e.h){case 0:if(0!=e.h)re(e);else e:{for(var t=(e=e.g).g,n=0;10>n;n++){if(0==(128&e.h[t])){e.g=t+1,z(e);break e}t++}e.j=!0,A()}break;case 1:(e=e.g).g+=8,z(e);break;case 2:2!=e.h?re(e):(t=K(e.g),(e=e.g).g+=t,z(e));break;case 5:(e=e.g).g+=4,z(e);break;case 3:for(t=e.i;;){if(!ne(e)){e.j=!0,C(Error("Unmatched start-group tag: stream EOF"));break}if(4==e.h){e.i!=t&&(e.j=!0,C(Error("Unmatched end-group tag")));break}re(e)}break;default:e.j=!0,O(e.h,e.l)}}function ie(e,t,n){e.N||(e=B(e.g.h,n,e.g.g),(n=t.m)?n.push(e):t.m=[e])}q.prototype.length=function(){return this.h},q.prototype.end=function(){var e=this.g,t=this.h;return this.h=0,B(e,0,t)},te.prototype.reset=function(){this.g.reset(),this.h=this.i=-1};var oe=[];function ae(){this.h=[],this.i=0,this.g=new q}function se(e,t){0!==t.length&&(e.h.push(t),e.i+=t.length)}function ce(e,t,n){ee(e.g,8*t+2),ee(e.g,n.length),se(e,e.g.end()),se(e,n)}var ue,de="function"==typeof Symbol&&"symbol"==typeof Symbol()?Symbol(void 0):void 0;function le(e,t){Object.isFrozen(e)||(de?e[de]|=t:void 0!==e.g?e.g|=t:Object.defineProperties(e,{g:{value:t,configurable:!0,writable:!0,enumerable:!1}}))}function fe(e){return e?null==(t=de?e[de]:e.g)?0:t:0;var t}function pe(e){return Array.isArray(e)&&le(e,1),e}function he(e){if(!Array.isArray(e))throw Error("cannot mark non-array as immutable");le(e,2)}function me(e){return null!==e&&"object"==typeof e&&e.constructor===Object}function ge(e){switch(typeof e){case"number":return isFinite(e)?e:String(e);case"object":return F&&null!=e&&e instanceof Uint8Array?Z(e):e;default:return e}}function ve(e,t){if(null!=e)return Array.isArray(e)||me(e)?ye(e,t):t(e)}function ye(e,t){if(Array.isArray(e)){for(var n=Array(e.length),r=0;r<e.length;r++)n[r]=ve(e[r],t);return 1&fe(e)&&pe(n),n}for(r in n={},e)n[r]=ve(e[r],t);return n}function be(e,t,n){var r=ue;if(ue=null,e||(e=r),r=this.constructor.ca,e||(e=r?[r]:[]),this.j=(r?0:-1)-(this.constructor.aa||0),this.i=null,this.g=e,e=(r=this.g.length)-1,r&&me(r=this.g[e])?(this.l=e-this.j,this.h=r):void 0!==t&&-1<t?(this.l=Math.max(t,e+1-this.j),this.h=null):this.l=Number.MAX_VALUE,n)for(t=0;t<n.length;t++)(e=n[t])<this.l?(e+=this.j,(r=this.g[e])?pe(r):this.g[e]=_e):(Te(this),(r=this.h[e])?pe(r):this.h[e]=_e)}var Se,Ee,_e=Object.freeze(pe([]));function Te(e){var t=e.l+e.j;e.g[t]||(e.h=e.g[t]={})}function Re(e,t,n){return-1===t?null:void 0!==n&&n||t>=e.l?e.h?e.h[t]:void 0:e.g[t+e.j]}function Ie(e,t,n){n=void 0===n||n;var r=void 0!==r&&r,i=Re(e,t,r);return null==i&&(i=_e),i===_e?Ce(e,t,i=pe([]),r):n&&Array.isArray(i)&&2&fe(i)&&Ce(e,t,i=i.slice(),r),i}function we(e,t,n){return null==(e=null==(e=Re(e,t))?e:+e)?void 0===n?0:n:e}function Ce(e,t,n,r){void 0!==r&&r||t>=e.l?(Te(e),e.h[t]=n):e.g[t+e.j]=n}function Oe(e,t,n){e.i||(e.i={});var r=e.i[n];if(!r){var i=Ie(e,n,!1);r=[];for(var o=!!Array.isArray(i)&&!!(2&fe(i)),a=0;a<i.length;a++)r[a]=new t(i[a]),o&&he(r[a].g);o&&(he(r),Object.freeze(r)),e.i[n]=r}return r}function Ae(e,t,n,r,i){var o=Oe(e,r,t);n=n||new r,e=Ie(e,t),null!=i?(o.splice(i,0,n),e.splice(i,0,xe(n))):(o.push(n),e.push(xe(n)))}function xe(e){if(e.i)for(var t in e.i){var n=e.i[t];if(Array.isArray(n))for(var r=0;r<n.length;r++)n[r]&&xe(n[r]);else n&&xe(n)}return e.g}function ke(e,t){return null==(e=Re(e,t))?0:e}function Ne(e,t){return null==(e=Re(e,t))?"":e}function Le(e,t){if(e=e.m){se(t,t.g.end());for(var n=0;n<e.length;n++)se(t,e[n])}}function Me(e){var t=e[0];switch(e.length){case 2:var n=e[1];return function(e,r,i){return t(e,r,i,n)};case 3:var r=e[1],i=e[2];return function(e,n,o){return t(e,n,o,r,i)};case 4:var o=e[1],a=e[2],s=e[3];return function(e,n,r){return t(e,n,r,o,a,s)};default:throw Error("unsupported number of parameters, expected [2-4], got "+e.length)}}function Ve(e,t,n){for(;ne(t)&&4!=t.h;){var r=t.i,i=n[r];if(i){if(Array.isArray(i)&&(i=n[r]=Me(i)),!i(t,e,r)){i=e;var o=(r=t).l;re(r),ie(r,i,o)}}else i=e,o=(r=t).l,re(r),ie(r,i,o)}return e}function Pe(e,t){var n=new ae;if(t(e,n),0===(e=n.i+n.g.length()))n=new Uint8Array(0);else{e=new Uint8Array(e);for(var r=n.h,i=r.length,o=t=0;o<i;o++){var a=r[o];0!==a.length&&(e.set(a,t),t+=a.length)}0!==(i=(r=n.g).h)&&(e.set(r.g.subarray(0,i),t),r.h=0),n.h=[e],n=e}return n}function De(e,t,n){if(oe.length){var r=oe.pop();e&&(J(r.g,e),r.i=-1,r.h=-1),e=r}else e=new te(e);try{return n(new t,e)}finally{(t=e.g).h=null,t.l=0,t.i=0,t.g=0,t.j=!1,t.u=!1,e.i=-1,e.h=-1,e.j=!1,100>oe.length&&oe.push(e)}}function Ze(e,t,n){if(null!=(t=Re(t,n))){ee(e.g,8*n+5),e=e.g;var r=t;0===(r=(n=0>r?1:0)?-r:r)?H=0<1/r?0:2147483648:isNaN(r)?H=2147483647:34028234663852886e22<r?H=(n<<31|2139095040)>>>0:11754943508222875e-54>r?(r=Math.round(r/Math.pow(2,-149)),H=(n<<31|r)>>>0):(t=Math.floor(Math.log(r)/Math.LN2),r*=Math.pow(2,-t),16777216<=(r=Math.round(8388608*r))&&++t,H=(n<<31|t+127<<23|8388607&r)>>>0),$(e,(n=H)>>>0&255),$(e,n>>>8&255),$(e,n>>>16&255),$(e,n>>>24&255)}}function je(e,t,n){if(5!==e.h)return!1;var r=(e=e.g).h[e.g],i=e.h[e.g+1],o=e.h[e.g+2],a=e.h[e.g+3];return e.g+=4,z(e),e=2*((i=(r<<0|i<<8|o<<16|a<<24)>>>0)>>31)+1,r=i>>>23&255,i&=8388607,Ce(t,n,255==r?i?NaN:1/0*e:0==r?e*Math.pow(2,-149)*i:e*Math.pow(2,r-150)*(i+Math.pow(2,23))),!0}function We(e,t,n){if(0!==e.h)return!1;for(var r=e.g,i=128,o=0,a=e=0;4>a&&128<=i;a++)o|=(127&(i=r.h[r.g++]))<<7*a;if(128<=i&&(o|=(127&(i=r.h[r.g++]))<<28,e|=(127&i)>>4),128<=i)for(a=0;5>a&&128<=i;a++)e|=(127&(i=r.h[r.g++]))<<7*a+3;return 128>i?(r=o>>>0,(e=2147483648&(i=e>>>0))&&(i=~i>>>0,0==(r=1+~r>>>0)&&(i=i+1>>>0)),r=4294967296*i+(r>>>0),e=e?-r:r):(r.j=!0,A(),e=void 0),Ce(t,n,e),!0}function Ge(e,t,n){return 0===e.h&&(Ce(t,n,K(e.g)),!0)}function Fe(e,t,n){if(2!==e.h)return!1;var r,i=K(e.g),o=(e=e.g).g;if(e.g+=i,z(e),e=e.h,L)(r=k)||(r=k=new TextDecoder("utf-8",{fatal:!1})),r=r.decode(e.subarray(o,o+i));else{i=o+i;for(var a,s,c,u=[],d=null;o<i;)128>(a=e[o++])?u.push(a):224>a?o>=i?u.push(65533):(s=e[o++],194>a||128!=(192&s)?(o--,u.push(65533)):u.push((31&a)<<6|63&s)):240>a?o>=i-1?u.push(65533):128!=(192&(s=e[o++]))||224===a&&160>s||237===a&&160<=s||128!=(192&(r=e[o++]))?(o--,u.push(65533)):u.push((15&a)<<12|(63&s)<<6|63&r):244>=a?o>=i-2?u.push(65533):128!=(192&(s=e[o++]))||s-144+(a<<28)>>30!=0||128!=(192&(r=e[o++]))||128!=(192&(c=e[o++]))?(o--,u.push(65533)):(a=(7&a)<<18|(63&s)<<12|(63&r)<<6|63&c,a-=65536,u.push(55296+(a>>10&1023),56320+(1023&a))):u.push(65533),8192<=u.length&&(d=x(d,u),u.length=0);r=x(d,u)}return Ce(t,n,r),!0}function Ue(e,t,n,r,i){if(2!==e.h)return!1;var o=new r,a=e.g.i,s=K(e.g),c=e.g.g+s;if(e.g.i=c,i(o,e),0!=(i=c-e.g.g))throw Error("Message parsing ended unexpectedly. Expected to read "+s+" bytes, instead read "+(s-i)+" bytes, either the data ended unexpectedly or the message misreported its own length");return e.g.g=c,e.g.i=a,Ae(t,n,o,r,void 0),!0}function Xe(e){be.call(this,e)}function Be(e,t){var n=Re(e,1);if(null!=n&&null!=n){ee(t.g,8);var r=t.g;if(0<=n)ee(r,n);else{for(var i=0;9>i;i++)$(r,127&n|128),n>>=7;$(r,1)}}Ze(t,e,2),null!=(r=Re(e,3))&&ce(t,3,V(r)),null!=(r=Re(e,4))&&ce(t,4,V(r)),Le(e,t)}function He(e,t){return Ve(e,t,Se||(Se={1:Ge,2:je,3:Fe,4:Fe}))}function Ye(e){be.call(this,e,-1,Qe)}function Je(e,t){return Ve(e,t,Ee||(Ee={1:[Ue,Xe,He]}))}be.prototype.toJSON=function(){return ye(xe(this),ge)},be.prototype.toString=function(){return xe(this).toString()},h(Xe,be),h(Ye,be),Ye.prototype.addClassification=function(e,t){return Ae(this,1,e,Xe,t),this};var ze,Ke,Qe=[1];function qe(e){be.call(this,e)}function $e(e,t){Ze(t,e,1),Ze(t,e,2),Ze(t,e,3),Ze(t,e,4),Ze(t,e,5),Le(e,t)}function et(e,t){return Ve(e,t,ze||(ze={1:je,2:je,3:je,4:je,5:je}))}function tt(e){be.call(this,e,-1,it)}function nt(e,t){return Ve(e,t,Ke||(Ke={1:[Ue,qe,et]}))}h(qe,be),h(tt,be);var rt,it=[1];function ot(e){be.call(this,e)}function at(e,t){Ze(t,e,1),Ze(t,e,2),Ze(t,e,3),Ze(t,e,4),Ze(t,e,5);var n=Re(e,6);if(null!=n&&null!=n){ee(t.g,48);var r=t.g,i=n;n=0>i;var o=(i=Math.abs(i))>>>0;for(i=Math.floor((i-o)/4294967296),i>>>=0,n&&(i=~i>>>0,4294967295<(o=1+(~o>>>0))&&(o=0,4294967295<++i&&(i=0))),n=H=o,o=i;0<o||127<n;)$(r,127&n|128),n=(n>>>7|o<<25)>>>0,o>>>=7;$(r,n)}Le(e,t)}function st(e,t){return Ve(e,t,rt||(rt={1:je,2:je,3:je,4:je,5:je,6:We}))}function ct(e,t,n){if(n=e.createShader(0===n?e.VERTEX_SHADER:e.FRAGMENT_SHADER),e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw Error("Could not compile WebGL shader.\n\n"+e.getShaderInfoLog(n));return n}function ut(e){return Oe(e,Xe,1).map((function(e){return{index:ke(e,1),X:we(e,2),label:null!=Re(e,3)?Ne(e,3):void 0,displayName:null!=Re(e,4)?Ne(e,4):void 0}}))}function dt(e){return{x:we(e,1),y:we(e,2),z:we(e,3),visibility:null!=Re(e,4)?we(e,4):void 0}}function lt(e){return Oe(De(e,tt,nt),qe,1).map(dt)}function ft(e,t){this.h=e,this.g=t,this.l=0}function pt(t,n,r){return function(e,t){var n=e.g;if(void 0===e.m){var r=ct(n,"\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }",0),i=ct(n,"\n  precision mediump float;\n  varying vec2 vTex;\n  uniform sampler2D sampler0;\n  void main(){\n    gl_FragColor = texture2D(sampler0, vTex);\n  }",1),o=n.createProgram();if(n.attachShader(o,r),n.attachShader(o,i),n.linkProgram(o),!n.getProgramParameter(o,n.LINK_STATUS))throw Error("Could not compile WebGL program.\n\n"+n.getProgramInfoLog(o));r=e.m=o,n.useProgram(r),i=n.getUniformLocation(r,"sampler0"),e.j={I:n.getAttribLocation(r,"aVertex"),H:n.getAttribLocation(r,"aTex"),da:i},e.s=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,e.s),n.enableVertexAttribArray(e.j.I),n.vertexAttribPointer(e.j.I,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),e.o=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,e.o),n.enableVertexAttribArray(e.j.H),n.vertexAttribPointer(e.j.H,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.uniform1i(i,0)}r=e.j,n.useProgram(e.m),n.canvas.width=t.width,n.canvas.height=t.height,n.viewport(0,0,t.width,t.height),n.activeTexture(n.TEXTURE0),e.h.bindTexture2d(t.glName),n.enableVertexAttribArray(r.I),n.bindBuffer(n.ARRAY_BUFFER,e.s),n.vertexAttribPointer(r.I,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(r.H),n.bindBuffer(n.ARRAY_BUFFER,e.o),n.vertexAttribPointer(r.H,2,n.FLOAT,!1,0,0),n.bindFramebuffer(n.DRAW_FRAMEBUFFER?n.DRAW_FRAMEBUFFER:n.FRAMEBUFFER,null),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.colorMask(!0,!0,!0,!0),n.drawArrays(n.TRIANGLE_FAN,0,4),n.disableVertexAttribArray(r.I),n.disableVertexAttribArray(r.H),n.bindBuffer(n.ARRAY_BUFFER,null),e.h.bindTexture2d(0)}(t,n),"function"==typeof t.g.canvas.transferToImageBitmap?e.resolve(t.g.canvas.transferToImageBitmap()):r?e.resolve(t.g.canvas):"function"==typeof createImageBitmap?createImageBitmap(t.g.canvas):(void 0===t.i&&(t.i=document.createElement("canvas")),new e((function(e){t.i.height=t.g.canvas.height,t.i.width=t.g.canvas.width,t.i.getContext("2d",{}).drawImage(t.g.canvas,0,0,t.g.canvas.width,t.g.canvas.height),e(t.i)})))}function ht(e){this.g=e}h(ot,be);var mt=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function gt(e,t){return t+e}function vt(e,t){window[e]=t}function yt(t){if(this.g=t,this.listeners={},this.j={},this.F={},this.m={},this.s={},this.G=this.o=this.R=!0,this.C=e.resolve(),this.P="",this.B={},this.locateFile=t&&t.locateFile||gt,"object"==typeof window)var n=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if(!(typeof location<"u"))throw Error("solutions can only be loaded on a web page or in a web worker");n=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}if(this.S=n,t.options)for(var r=(n=s(Object.keys(t.options))).next();!r.done;r=n.next()){r=r.value;var i=t.options[r].default;void 0!==i&&(this.j[r]="function"==typeof i?i():i)}}function bt(t){var n,r,i,o,a,s,u,d,l,f,p;return T((function(h){switch(h.g){case 1:return t.R?(n=void 0===t.g.files?[]:"function"==typeof t.g.files?t.g.files(t.j):t.g.files,y(h,T((function(e){switch(e.g){case 1:return e.m=2,y(e,WebAssembly.instantiate(mt),4);case 4:e.g=3,e.m=0;break;case 2:return e.m=0,e.j=null,e.return(!1);case 3:return e.return(!0)}})),2)):h.return();case 2:if(r=h.h,"object"==typeof window)return vt("createMediapipeSolutionsWasm",{locateFile:t.locateFile}),vt("createMediapipeSolutionsPackedAssets",{locateFile:t.locateFile}),s=n.filter((function(e){return void 0!==e.data})),u=n.filter((function(e){return void 0===e.data})),d=e.all(s.map((function(n){var r=St(t,n.url);if(void 0!==n.path){var i=n.path;r=r.then((function(n){return t.overrideFile(i,n),e.resolve(n)}))}return r}))),l=e.all(u.map((function(n){return void 0===n.simd||n.simd&&r||!n.simd&&!r?function(t){var n=document.createElement("script");return n.setAttribute("src",t),n.setAttribute("crossorigin","anonymous"),new e((function(e){n.addEventListener("load",(function(){e()}),!1),n.addEventListener("error",(function(){e()}),!1),document.body.appendChild(n)}))}(t.locateFile(n.url,t.S)):e.resolve()}))).then((function(){var e,n,r;return T((function(i){if(1==i.g)return e=window.createMediapipeSolutionsWasm,n=window.createMediapipeSolutionsPackedAssets,r=t,y(i,e(n),2);r.h=i.h,i.g=0}))})),f=T((function(e){return t.g.graph&&t.g.graph.url?e=y(e,St(t,t.g.graph.url),0):(e.g=0,e=void 0),e})),y(h,e.all([l,d,f]),7);if("function"!=typeof importScripts)throw Error("solutions can only be loaded on a web page or in a web worker");return i=n.filter((function(e){return void 0===e.simd||e.simd&&r||!e.simd&&!r})).map((function(e){return t.locateFile(e.url,t.S)})),importScripts.apply(null,c(i)),o=t,y(h,createMediapipeSolutionsWasm(Module),6);case 6:o.h=h.h,t.l=new OffscreenCanvas(1,1),t.h.canvas=t.l,a=t.h.GL.createContext(t.l,{antialias:!1,alpha:!1,ba:typeof WebGL2RenderingContext<"u"?2:1}),t.h.GL.makeContextCurrent(a),h.g=4;break;case 7:if(t.l=document.createElement("canvas"),!(p=t.l.getContext("webgl2",{}))&&!(p=t.l.getContext("webgl",{})))return alert("Failed to create WebGL canvas context when passing video frame."),h.return();t.D=p,t.h.canvas=t.l,t.h.createContext(t.l,!0,!0,{});case 4:t.i=new t.h.SolutionWasm,t.R=!1,h.g=0}}))}function St(e,t){var n,r;return T((function(i){return t in e.F?i.return(e.F[t]):(n=e.locateFile(t,""),r=fetch(n).then((function(e){return e.arrayBuffer()})),e.F[t]=r,i.return(r))}))}function Et(e,t,n){var r,i,o,a,c,u,d,l,f,p,h,m,g,v;return T((function(b){switch(b.g){case 1:if(!n)return b.return(t);for(r={},i=0,o=s(Object.keys(n)),a=o.next();!a.done;a=o.next())c=a.value,"string"!=typeof(u=n[c])&&"texture"===u.type&&void 0!==t[u.stream]&&++i;1<i&&(e.G=!1),d=s(Object.keys(n)),a=d.next();case 2:if(a.done){b.g=4;break}if(l=a.value,"string"==typeof(f=n[l]))return g=r,v=l,y(b,function(e,t,n){var r;return T((function(i){return"number"==typeof n||n instanceof Uint8Array||n instanceof e.h.Uint8BlobList?i.return(n):n instanceof e.h.Texture2dDataOut?((r=e.s[t])||(r=new ft(e.h,e.D),e.s[t]=r),i.return(pt(r,n,e.G))):i.return(void 0)}))}(e,l,t[f]),14);if(p=t[f.stream],"detection_list"===f.type){if(p){for(var S=p.getRectList(),E=p.getLandmarksList(),_=p.getClassificationsList(),R=[],I=0;I<S.size();++I){var w=De(S.get(I),ot,st);w={T:{Y:we(w,1),Z:we(w,2),height:we(w,3),width:we(w,4),rotation:we(w,5,0),W:ke(w,6)},O:lt(E.get(I)),M:ut(De(_.get(I),Ye,Je))},R.push(w)}S=R}else S=[];r[l]=S,b.g=7;break}if("proto_list"===f.type){if(p){for(S=Array(p.size()),E=0;E<p.size();E++)S[E]=p.get(E);p.delete()}else S=[];r[l]=S,b.g=7;break}if(void 0===p){b.g=3;break}if("float_list"===f.type){r[l]=p,b.g=7;break}if("proto"===f.type){r[l]=p,b.g=7;break}if("texture"!==f.type)throw Error("Unknown output config type: '"+f.type+"'");return(h=e.s[l])||(h=new ft(e.h,e.D),e.s[l]=h),y(b,pt(h,p,e.G),13);case 13:m=b.h,r[l]=m;case 7:f.transform&&r[l]&&(r[l]=f.transform(r[l])),b.g=3;break;case 14:g[v]=b.h;case 3:a=d.next(),b.g=2;break;case 4:return b.return(r)}}))}function _t(e,t){for(var n=t.name||"$",r=[].concat(c(t.wants)),i=new e.h.StringList,o=s(t.wants),a=o.next();!a.done;a=o.next())i.push_back(a.value);o=e.h.PacketListener.implement({onResults:function(i){for(var o={},a=0;a<t.wants.length;++a)o[r[a]]=i.get(a);var s=e.listeners[n];s&&(e.C=Et(e,o,t.outs).then((function(n){n=s(n);for(var i=0;i<t.wants.length;++i){var a=o[r[i]];"object"==typeof a&&a.hasOwnProperty&&a.hasOwnProperty("delete")&&a.delete()}n&&(e.C=n)})))}}),e.i.attachMultiListener(i,o),i.delete()}function Tt(e){switch(void 0===e&&(e=0),e){case 1:return"pose_landmark_full.tflite";case 2:return"pose_landmark_heavy.tflite";default:return"pose_landmark_lite.tflite"}}function Rt(e){var t=this;e=e||{},this.g=new yt({locateFile:e.locateFile,files:function(e){return[{url:"pose_solution_packed_assets_loader.js"},{simd:!1,url:"pose_solution_wasm_bin.js"},{simd:!0,url:"pose_solution_simd_wasm_bin.js"},{data:!0,url:Tt(e.modelComplexity)}]},graph:{url:"pose_web.binarypb"},listeners:[{wants:["pose_landmarks","world_landmarks","segmentation_mask","image_transformed"],outs:{image:{type:"texture",stream:"image_transformed"},poseLandmarks:{type:"proto",stream:"pose_landmarks",transform:lt},poseWorldLandmarks:{type:"proto",stream:"world_landmarks",transform:lt},segmentationMask:{type:"texture",stream:"segmentation_mask"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(e){var n,r,i;return T((function(o){return 1==o.g?(n=Tt(e),r="third_party/mediapipe/modules/pose_landmark/"+n,y(o,St(t.g,n),2)):(i=o.h,t.g.overrideFile(r,i),o.return(!0))}))}},smoothLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothLandmarks",fieldName:"bool_value"}},enableSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorEnableSegmentation",fieldName:"bool_value"}},smoothSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothSegmentation",fieldName:"bool_value"}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"poselandmarkgpu__posedetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"poselandmarkgpu__poselandmarkbyroigpu__tensorstoposelandmarksandsegmentation__ThresholdingCalculator",fieldName:"threshold"}}}})}(t=yt.prototype).close=function(){return this.i&&this.i.delete(),e.resolve()},t.reset=function(){var e=this;return T((function(t){e.i&&(e.i.reset(),e.m={},e.s={}),t.g=0}))},t.setOptions=function(e,t){var n=this;if(t=t||this.g.options){for(var r=[],i=[],o={},a=s(Object.keys(e)),c=a.next();!c.done;o={K:o.K,L:o.L},c=a.next()){var u=c.value;u in this.j&&this.j[u]===e[u]||(this.j[u]=e[u],void 0!==(c=t[u])&&(c.onChange&&(o.K=c.onChange,o.L=e[u],r.push(function(e){return function(){return T((function(t){if(1==t.g)return y(t,e.K(e.L),2);!0===t.h&&(n.o=!0),t.g=0}))}}(o))),c.graphOptionXref&&(u={valueNumber:1===c.type?e[u]:0,valueBoolean:0===c.type&&e[u],valueString:2===c.type?e[u]:""},c=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),c.graphOptionXref),u),i.push(c))))}(0!==r.length||0!==i.length)&&(this.o=!0,this.A=(void 0===this.A?[]:this.A).concat(i),this.v=(void 0===this.v?[]:this.v).concat(r))}},t.initialize=function(){var e=this;return T((function(t){return 1==t.g?y(t,bt(e),2):3!=t.g?y(t,function(e){var t,n,r,i,o,a,c,u;return T((function(d){if(1==d.g)return e.g.graph&&e.g.graph.url&&e.P===e.g.graph.url?d.return():(e.o=!0,e.g.graph&&e.g.graph.url?(e.P=e.g.graph.url,y(d,St(e,e.g.graph.url),3)):void(d.g=2));for(2!=d.g&&(t=d.h,e.i.loadGraph(t)),n=s(Object.keys(e.B)),r=n.next();!r.done;r=n.next())i=r.value,e.i.overrideFile(i,e.B[i]);if(e.B={},e.g.listeners)for(o=s(e.g.listeners),a=o.next();!a.done;a=o.next())c=a.value,_t(e,c);u=e.j,e.j={},e.setOptions(u),d.g=0}))}(e),3):y(t,function(e){var t,n,r,i,o,a;return T((function(c){switch(c.g){case 1:if(!e.o)return c.return();if(!e.v){c.g=2;break}t=s(e.v),n=t.next();case 3:if(n.done){c.g=5;break}return y(c,(0,n.value)(),4);case 4:n=t.next(),c.g=3;break;case 5:e.v=void 0;case 2:if(e.A){for(r=new e.h.GraphOptionChangeRequestList,i=s(e.A),o=i.next();!o.done;o=i.next())a=o.value,r.push_back(a);e.i.changeOptions(r),r.delete(),e.A=void 0}e.o=!1,c.g=0}}))}(e),0)}))},t.overrideFile=function(e,t){this.i?this.i.overrideFile(e,t):this.B[e]=t},t.clearOverriddenFiles=function(){this.B={},this.i&&this.i.clearOverriddenFiles()},t.send=function(e,t){var n,r,i,o,a,c,u,d,l,f=this;return T((function(p){switch(p.g){case 1:return f.g.inputs?(n=1e3*(null==t?performance.now():t),y(p,f.C,2)):p.return();case 2:return y(p,f.initialize(),3);case 3:for(r=new f.h.PacketDataList,i=s(Object.keys(e)),o=i.next();!o.done;o=i.next())if(a=o.value,c=f.g.inputs[a]){e:{var h=e[a];switch(c.type){case"video":var m=f.m[c.stream];if(m||(m=new ft(f.h,f.D),f.m[c.stream]=m),0===m.l&&(m.l=m.h.createTexture()),typeof HTMLVideoElement<"u"&&h instanceof HTMLVideoElement)var g=h.videoWidth,v=h.videoHeight;else typeof HTMLImageElement<"u"&&h instanceof HTMLImageElement?(g=h.naturalWidth,v=h.naturalHeight):(g=h.width,v=h.height);v={glName:m.l,width:g,height:v},(g=m.g).canvas.width=v.width,g.canvas.height=v.height,g.activeTexture(g.TEXTURE0),m.h.bindTexture2d(m.l),g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,h),m.h.bindTexture2d(0),m=v;break e;case"detections":for((m=f.m[c.stream])||(m=new ht(f.h),f.m[c.stream]=m),m.data||(m.data=new m.g.DetectionListData),m.data.reset(h.length),v=0;v<h.length;++v){g=h[v];var b=m.data,S=b.setBoundingBox,E=v,_=g.T,T=new ot;if(Ce(T,1,_.Y),Ce(T,2,_.Z),Ce(T,3,_.height),Ce(T,4,_.width),Ce(T,5,_.rotation),Ce(T,6,_.W),_=Pe(T,at),S.call(b,E,_),g.O)for(b=0;b<g.O.length;++b){var R=!!(T=g.O[b]).visibility;E=(S=m.data).addNormalizedLandmark,_=v,T=Object.assign(Object.assign({},T),{visibility:R?T.visibility:0}),Ce(R=new qe,1,T.x),Ce(R,2,T.y),Ce(R,3,T.z),T.visibility&&Ce(R,4,T.visibility),T=Pe(R,$e),E.call(S,_,T)}if(g.M)for(b=0;b<g.M.length;++b)E=(S=m.data).addClassification,_=v,T=g.M[b],Ce(R=new Xe,2,T.X),T.index&&Ce(R,1,T.index),T.label&&Ce(R,3,T.label),T.displayName&&Ce(R,4,T.displayName),T=Pe(R,Be),E.call(S,_,T)}m=m.data;break e;default:m={}}}switch(u=m,d=c.stream,c.type){case"video":r.pushTexture2d(Object.assign(Object.assign({},u),{stream:d,timestamp:n}));break;case"detections":(l=u).stream=d,l.timestamp=n,r.pushDetectionList(l);break;default:throw Error("Unknown input config type: '"+c.type+"'")}}return f.i.send(r),y(p,f.C,4);case 4:r.delete(),p.g=0}}))},t.onResults=function(e,t){this.listeners[t||"$"]=e},w("Solution",yt),w("OptionType",{BOOL:0,NUMBER:1,$:2,0:"BOOL",1:"NUMBER",2:"STRING"}),(t=Rt.prototype).reset=function(){this.g.reset()},t.close=function(){return this.g.close(),e.resolve()},t.onResults=function(e){this.g.onResults(e)},t.initialize=function(){var e=this;return T((function(t){return y(t,e.g.initialize(),0)}))},t.send=function(e,t){var n=this;return T((function(r){return y(r,n.g.send(e,t),0)}))},t.setOptions=function(e){this.g.setOptions(e)},w("Pose",Rt),w("POSE_CONNECTIONS",[[0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]]),w("POSE_LANDMARKS",{NOSE:0,LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,LEFT_EAR:7,RIGHT_EAR:8,LEFT_RIGHT:9,RIGHT_LEFT:10,LEFT_SHOULDER:11,RIGHT_SHOULDER:12,LEFT_ELBOW:13,RIGHT_ELBOW:14,LEFT_WRIST:15,RIGHT_WRIST:16,LEFT_PINKY:17,RIGHT_PINKY:18,LEFT_INDEX:19,RIGHT_INDEX:20,LEFT_THUMB:21,RIGHT_THUMB:22,LEFT_HIP:23,RIGHT_HIP:24,LEFT_KNEE:25,RIGHT_KNEE:26,LEFT_ANKLE:27,RIGHT_ANKLE:28,LEFT_HEEL:29,RIGHT_HEEL:30,LEFT_FOOT_INDEX:31,RIGHT_FOOT_INDEX:32}),w("POSE_LANDMARKS_LEFT",{LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,LEFT_EAR:7,LEFT_RIGHT:9,LEFT_SHOULDER:11,LEFT_ELBOW:13,LEFT_WRIST:15,LEFT_PINKY:17,LEFT_INDEX:19,LEFT_THUMB:21,LEFT_HIP:23,LEFT_KNEE:25,LEFT_ANKLE:27,LEFT_HEEL:29,LEFT_FOOT_INDEX:31}),w("POSE_LANDMARKS_RIGHT",{RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,RIGHT_EAR:8,RIGHT_LEFT:10,RIGHT_SHOULDER:12,RIGHT_ELBOW:14,RIGHT_WRIST:16,RIGHT_PINKY:18,RIGHT_INDEX:20,RIGHT_THUMB:22,RIGHT_HIP:24,RIGHT_KNEE:26,RIGHT_ANKLE:28,RIGHT_HEEL:30,RIGHT_FOOT_INDEX:32}),w("POSE_LANDMARKS_NEUTRAL",{NOSE:0}),w("VERSION","0.5.1635988162")}).call(Ce);const Oe=class{constructor(){o(this,"mediapipeMap_",new Map)}getVersion(e){switch(e){case"face_detection":return Re.VERSION;case"face_mesh":return Ie.VERSION;case"hands":return _e.VERSION;case"holistic":return Te.VERSION;case"objectron":return we.VERSION;case"selfie_segmentation":return Ee.VERSION;case"pose":return Ce.VERSION;default:return""}}initialize(t){return new e(async(e,n)=>{if(0!=t.mediaPipeModelConfigArray.length){for(let e=0;e<t.mediaPipeModelConfigArray.length;e++){const r=t.mediaPipeModelConfigArray[e];if(this.mediapipeMap_.has(r.modelType))return void n("setting same type is not supported");if("function"!=typeof r.listener)return void n(`[${r.modelType}] ResultsListener must be provided`);let i;switch(r.modelType){case"face_mesh":i=new Ie.FaceMesh({locateFile:(e,t)=>(r.assetsUri||Oe.defaultAssetsBaseUrl+"face_mesh/"+this.getVersion("face_mesh"))+"/"+e});break;case"face_detection":i=new Re.FaceDetection({locateFile:(e,t)=>(r.assetsUri||Oe.defaultAssetsBaseUrl+"face_detection/"+this.getVersion("face_detection"))+"/"+e});break;case"hands":i=new _e.Hands({locateFile:(e,t)=>(r.assetsUri||Oe.defaultAssetsBaseUrl+"hands/"+this.getVersion("hands"))+"/"+e});break;case"holistic":i=new Te.Holistic({locateFile:(e,t)=>(r.assetsUri||Oe.defaultAssetsBaseUrl+"holistic/"+this.getVersion("holistic"))+"/"+e});break;case"objectron":i=new we.Objectron({locateFile:(e,t)=>(r.assetsUri||Oe.defaultAssetsBaseUrl+"objectron/"+this.getVersion("objectron"))+"/"+e});break;case"selfie_segmentation":i=new Ee.SelfieSegmentation({locateFile:(e,t)=>(r.assetsUri||Oe.defaultAssetsBaseUrl+"selfie_segmentation/"+this.getVersion("selfie_segmentation"))+"/"+e});break;case"pose":i=new Ce.Pose({locateFile:(e,t)=>(r.assetsUri||Oe.defaultAssetsBaseUrl+"pose/"+this.getVersion("pose"))+"/"+e});break;default:return void n("unknown model type")}i.onResults(r.listener),r.options&&i.setOptions(r.options);try{await i.initialize(),this.mediapipeMap_.set(r.modelType,i)}catch(e){return void n(e)}}e()}else n("no model was selected")})}close(t){return new e((n,r)=>{let i=[];if(t){let e=this.mediapipeMap_.get(t);if(!e)return void r("model not exit");this.mediapipeMap_.delete(t),i.push(e.close())}else{for(const[e,t]of this.mediapipeMap_.entries())i.push(t.close());this.mediapipeMap_.clear()}e.all(i).then(()=>{n()}).catch(e=>{r(e)})})}send(t,n){return new e((r,i)=>{let o=[];if(n){let e=this.mediapipeMap_.get(n);if(!e)return void i("model not exit");o.push(e.send({image:t}))}else for(const[e,n]of this.mediapipeMap_.entries())o.push(n.send({image:t}));e.all(o).then(()=>{r()}).catch(e=>{i(e)})})}reset(e){if(e){let t=this.mediapipeMap_.get(e);t&&"function"==typeof t.reset&&t.reset()}else for(const[e,t]of this.mediapipeMap_.entries())t&&"function"==typeof t.reset&&t.reset()}};let Ae=Oe;o(Ae,"defaultAssetsBaseUrl","https://d3opqjmqzxf057.cloudfront.net/ml/mediapipe/");const xe=new WeakMap,ke=new WeakMap,Ne=new WeakMap,Le=Symbol("anyProducer"),Me=e.resolve(),Ve=Symbol("listenerAdded"),Pe=Symbol("listenerRemoved");let De=!1;function Ze(e){if("string"!=typeof e&&"symbol"!=typeof e)throw new TypeError("eventName must be a string or a symbol")}function je(e){if("function"!=typeof e)throw new TypeError("listener must be a function")}function We(e,t){const n=ke.get(e);return n.has(t)||n.set(t,new Set),n.get(t)}function Ge(e,t){const n="string"==typeof t||"symbol"==typeof t?t:Le,r=Ne.get(e);return r.has(n)||r.set(n,new Set),r.get(n)}function Fe(t,n){n=Array.isArray(n)?n:[n];let r=!1,i=()=>{},o=[];const a={enqueue(e){o.push(e),i()},finish(){r=!0,i()}};for(const e of n)Ge(t,e).add(a);return{async next(){return o?0===o.length?r?(o=void 0,this.next()):(await new e(e=>{i=e}),this.next()):{done:!1,value:await o.shift()}:{done:!0}},async return(e){o=void 0;for(const e of n)Ge(t,e).delete(a);return i(),arguments.length>0?{done:!0,value:await e}:{done:!0}},[Symbol.asyncIterator](){return this}}}function Ue(e){if(void 0===e)return He;if(!Array.isArray(e))throw new TypeError("`methodNames` must be an array of strings");for(const t of e)if(!He.includes(t))throw"string"!=typeof t?new TypeError("`methodNames` element must be a string"):new Error(t+" is not Emittery method");return e}const Xe=e=>e===Ve||e===Pe;class Be{static mixin(e,t){return t=Ue(t),n=>{if("function"!=typeof n)throw new TypeError("`target` must be function");for(const e of t)if(void 0!==n.prototype[e])throw new Error(`The property \`${e}\` already exists on \`target\``);Object.defineProperty(n.prototype,e,{enumerable:!1,get:function(){return Object.defineProperty(this,e,{enumerable:!1,value:new Be}),this[e]}});const r=t=>function(...n){return this[e][t](...n)};for(const e of t)Object.defineProperty(n.prototype,e,{enumerable:!1,value:r(e)});return n}}static get isDebugEnabled(){if("object"!=typeof r)return De;const{env:e}=r||{env:{}};return"emittery"===e.DEBUG||"*"===e.DEBUG||De}static set isDebugEnabled(e){De=e}constructor(e={}){xe.set(this,new Set),ke.set(this,new Map),Ne.set(this,new Map),this.debug=e.debug||{},void 0===this.debug.enabled&&(this.debug.enabled=!1),this.debug.logger||(this.debug.logger=(e,t,n,r)=>{try{r=JSON.stringify(r)}catch{r="Object with the following keys failed to stringify: "+Object.keys(r).join(",")}"symbol"==typeof n&&(n=n.toString());const i=new Date,o=`${i.getHours()}:${i.getMinutes()}:${i.getSeconds()}.${i.getMilliseconds()}`;console.log(`[${o}][emittery:${e}][${t}] Event Name: ${n}\n\tdata: ${r}`)})}logIfDebugEnabled(e,t,n){(Be.isDebugEnabled||this.debug.enabled)&&this.debug.logger(e,this.debug.name,t,n)}on(e,t){je(t),e=Array.isArray(e)?e:[e];for(const n of e)Ze(n),We(this,n).add(t),this.logIfDebugEnabled("subscribe",n,void 0),Xe(n)||this.emit(Ve,{eventName:n,listener:t});return this.off.bind(this,e,t)}off(e,t){je(t),e=Array.isArray(e)?e:[e];for(const n of e)Ze(n),We(this,n).delete(t),this.logIfDebugEnabled("unsubscribe",n,void 0),Xe(n)||this.emit(Pe,{eventName:n,listener:t})}once(t){return new e(e=>{const n=this.on(t,t=>{n(),e(t)})})}events(e){e=Array.isArray(e)?e:[e];for(const t of e)Ze(t);return Fe(this,e)}async emit(t,n){Ze(t),this.logIfDebugEnabled("emit",t,n),function(t,n,r){const i=Ne.get(t);if(i.has(n))for(const e of i.get(n))e.enqueue(r);if(i.has(Le)){const t=e.all([n,r]);for(const e of i.get(Le))e.enqueue(t)}}(this,t,n);const r=We(this,t),i=xe.get(this),o=[...r],a=Xe(t)?[]:[...i];await Me,await e.all([...o.map(async e=>{if(r.has(e))return e(n)}),...a.map(async e=>{if(i.has(e))return e(t,n)})])}async emitSerial(e,t){Ze(e),this.logIfDebugEnabled("emitSerial",e,t);const n=We(this,e),r=xe.get(this),i=[...n],o=[...r];await Me;for(const e of i)n.has(e)&&await e(t);for(const n of o)r.has(n)&&await n(e,t)}onAny(e){return je(e),this.logIfDebugEnabled("subscribeAny",void 0,void 0),xe.get(this).add(e),this.emit(Ve,{listener:e}),this.offAny.bind(this,e)}anyEvent(){return Fe(this)}offAny(e){je(e),this.logIfDebugEnabled("unsubscribeAny",void 0,void 0),this.emit(Pe,{listener:e}),xe.get(this).delete(e)}clearListeners(e){e=Array.isArray(e)?e:[e];for(const t of e)if(this.logIfDebugEnabled("clear",t,void 0),"string"==typeof t||"symbol"==typeof t){We(this,t).clear();const e=Ge(this,t);for(const t of e)t.finish();e.clear()}else{xe.get(this).clear();for(const e of ke.get(this).values())e.clear();for(const e of Ne.get(this).values()){for(const t of e)t.finish();e.clear()}}}listenerCount(e){e=Array.isArray(e)?e:[e];let t=0;for(const n of e)if("string"!=typeof n){typeof n<"u"&&Ze(n),t+=xe.get(this).size;for(const e of ke.get(this).values())t+=e.size;for(const e of Ne.get(this).values())t+=e.size}else t+=xe.get(this).size+We(this,n).size+Ge(this,n).size+Ge(this).size;return t}bindMethods(e,t){if("object"!=typeof e||null===e)throw new TypeError("`target` must be an object");t=Ue(t);for(const n of t){if(void 0!==e[n])throw new Error(`The property \`${n}\` already exists on \`target\``);Object.defineProperty(e,n,{enumerable:!1,value:this[n].bind(this)})}}}const He=Object.getOwnPropertyNames(Be.prototype).filter(e=>"constructor"!==e);Object.defineProperty(Be,"listenerAdded",{value:Ve,writable:!1,enumerable:!0,configurable:!1}),Object.defineProperty(Be,"listenerRemoved",{value:Pe,writable:!1,enumerable:!0,configurable:!1});var Ye=Be;function Je(e,t){globalThis.vonage||(globalThis.vonage={}),globalThis.vonage.workerizer||(globalThis.vonage.workerizer={});let n=globalThis.vonage.workerizer;return n[e]||(n[e]=t),n[e]}const ze=Je("globals",{});var Ke=(e=>(e.INIT="INIT",e.FORWARD="FORWARD",e.TERMINATE="TERMINATE",e.GLOBALS_SYNC="GLOBALS_SYNC",e))(Ke||{});function Qe(e){return[ImageBitmap,ReadableStream,WritableStream].some(t=>e instanceof t)}let qe=0;function $e(t,n,r,i,o){const a=qe++;return t.postMessage({id:a,type:n,functionName:r,args:i},i.filter(e=>Qe(e))),new e(e=>{null==o||o.set(a,e)})}function et(e,t){const{id:n,type:r}=e,i=Array.isArray(t)?t:[t];postMessage({id:n,type:r,result:t},i.filter(e=>Qe(e)))}const tt=Je("workerized",{});function nt(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}function rt(e,t){if(Array.isArray(t))t.splice(0,t.length);else if("object"==typeof t)for(const e in t)delete t[e];for(const n in e)Array.isArray(e[n])?(t[n]=[],rt(e[n],t[n])):"object"==typeof e[n]?(t[n]={},rt(e[n],t[n])):t[n]=e[n]}async function it(t,n,r){const i=new n;if(i.addEventListener("message",async({data:t})=>{var n,i,o,a,s,c,u;switch(t.type){case Ke.GLOBALS_SYNC:t.id?(null==(i=r.get(null!=(n=t.id)?n:-1))||i(t.result),r.delete(null!=(o=t.id)?o:-1)):(rt(null!=(a=t.result)?a:{},ze),await async function(){if(nt())et({type:Ke.GLOBALS_SYNC},ze);else{const t=[];for(const e in tt){const{worker:n,resolvers:r}=tt[e].workerContext;n&&t.push($e(n,Ke.GLOBALS_SYNC,"",[ze],r))}await e.all(t)}}());break;default:null==(c=r.get(null!=(s=t.id)?s:-1))||c(t.result),r.delete(null!=(u=t.id)?u:-1)}}),!await $e(i,Ke.INIT,"",[t.workerId,ze],r))throw"Failed to instantiate workerized class";return i}let ot=0;async function at(e,t){const n=new Map;return async function(e,t,n){const r={},i=ot++;return Object.getOwnPropertyNames(e.prototype).forEach(e=>{r[e]=(...r)=>$e(t,Ke.FORWARD,e,r,n)}),r.terminate=async(...e)=>{const o=await $e(t,Ke.TERMINATE,"",e,n);return delete tt[i],t.terminate(),r.workerContext.worker=void 0,o},r.workerContext={id:i,worker:t,resolvers:n},tt[i]=r,r}(e,await it(e,t,n),n)}const st=Je("registeredWorkers",{});nt()&&function(){const e={};onmessage=async t=>{const n=t.data;switch(n.type){case Ke.INIT:!function(e,t){if(!e.args)throw"Missing className while initializing worker";const[n,r]=e.args,i=st[n];if(!i)throw"unknown worker class "+n;t.instance=new i(e.args.slice(1)),rt(r,ze),et(e,void 0!==typeof t.instance)}(n,e);break;case Ke.FORWARD:!async function(e,t){const{functionName:n,args:r}=e;if(!t.instance)throw"instance not initialized";if(!n)throw"missing function name to call";if(!t.instance[n])throw`undefined function [${n}] in class ${t.instance.constructor.workerId}`;et(e,await t.instance[n](...null!=r?r:[]))}(n,e);break;case Ke.TERMINATE:!async function(e,t){const{args:n}=e;if(!t.instance)throw"instance not initialized";let r;t.instance.terminate&&(r=await t.instance.terminate(...null!=n?n:[])),et(e,r)}(n,e);break;case Ke.GLOBALS_SYNC:!function(e){if(!e.args)throw"Missing globals while syncing";rt(e.args[0],ze),et(e,{})}(n)}}}();class ct{static async createVideoReadable(t){return new e((e,n)=>{const r=document.createElement("video");let i=new AbortController,o=new AbortController;r.addEventListener("canplay",()=>{i.abort(),r.muted=!0,r.loop=!0,r.play().then(()=>{try{const t=r.captureStream(),n=new MediaStreamTrackProcessor(t.getVideoTracks()[0]);e(n.readable)}catch(e){n(e)}})},{once:!0,signal:o.signal}),r.addEventListener("error",e=>{o.abort(),n("loading error:"+e)},{once:!0,signal:i.signal}),r.crossOrigin="anonymous",r.src=t})}static async createImageCanvas(e){const t=await(await fetch(e)).blob();return await createImageBitmap(t)}}var ut=Object.defineProperty,dt=(e,t,n)=>(((e,t,n)=>{t in e?ut(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);let lt;const ft=new Uint8Array(16);function pt(){if(!lt&&(lt=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!lt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return lt(ft)}const ht=[];for(let e=0;e<256;++e)ht.push((e+256).toString(16).slice(1));const mt={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function gt(e,t,n){if(mt.randomUUID&&!t&&!e)return mt.randomUUID();const r=(e=e||{}).random||(e.rng||pt)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return function(e,t=0){return(ht[e[t+0]]+ht[e[t+1]]+ht[e[t+2]]+ht[e[t+3]]+"-"+ht[e[t+4]]+ht[e[t+5]]+"-"+ht[e[t+6]]+ht[e[t+7]]+"-"+ht[e[t+8]]+ht[e[t+9]]+"-"+ht[e[t+10]]+ht[e[t+11]]+ht[e[t+12]]+ht[e[t+13]]+ht[e[t+14]]+ht[e[t+15]]).toLowerCase()}(r)}function vt(e,t){globalThis.vonage||(globalThis.vonage={}),globalThis.vonage.workerizer||(globalThis.vonage.workerizer={});let n=globalThis.vonage.workerizer;return n[e]||(n[e]=t),n[e]}const yt=vt("globals",{});var bt=(e=>(e.INIT="INIT",e.FORWARD="FORWARD",e.TERMINATE="TERMINATE",e.GLOBALS_SYNC="GLOBALS_SYNC",e))(bt||{});function St(e){return[ImageBitmap,ReadableStream,WritableStream].some(t=>e instanceof t)}let Et=0;function _t(t,n,r,i,o){const a=Et++;return t.postMessage({id:a,type:n,functionName:r,args:i},i.filter(e=>St(e))),new e(e=>{null==o||o.set(a,e)})}function Tt(e,t){const{id:n,type:r}=e,i=Array.isArray(t)?t:[t];postMessage({id:n,type:r,result:t},i.filter(e=>St(e)))}const Rt=vt("workerized",{});function It(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}function wt(e,t){if(Array.isArray(t))t.splice(0,t.length);else if("object"==typeof t)for(const e in t)delete t[e];for(const n in e)Array.isArray(e[n])?(t[n]=[],wt(e[n],t[n])):"object"==typeof e[n]?(t[n]={},wt(e[n],t[n])):t[n]=e[n]}const Ct=vt("registeredWorkers",{});function Ot(t,n){return yt[t]||(yt[t]=n),[()=>yt[t],async n=>{yt[t]=n,await async function(){if(It())Tt({type:bt.GLOBALS_SYNC},yt);else{const t=[];for(const e in Rt){const{worker:n,resolvers:r}=Rt[e].workerContext;n&&t.push(_t(n,bt.GLOBALS_SYNC,"",[yt],r))}await e.all(t)}}()}]}It()&&function(){const e={};onmessage=async t=>{const n=t.data;switch(n.type){case bt.INIT:!function(e,t){if(!e.args)throw"Missing className while initializing worker";const[n,r]=e.args,i=Ct[n];if(!i)throw"unknown worker class "+n;t.instance=new i(e.args.slice(1)),wt(r,yt),Tt(e,void 0!==typeof t.instance)}(n,e);break;case bt.FORWARD:!async function(e,t){const{functionName:n,args:r}=e;if(!t.instance)throw"instance not initialized";if(!n)throw"missing function name to call";if(!t.instance[n])throw`undefined function [${n}] in class ${t.instance.constructor.workerId}`;Tt(e,await t.instance[n](...null!=r?r:[]))}(n,e);break;case bt.TERMINATE:!async function(e,t){const{args:n}=e;if(!t.instance)throw"instance not initialized";let r;t.instance.terminate&&(r=await t.instance.terminate(...null!=n?n:[])),Tt(e,r)}(n,e);break;case bt.GLOBALS_SYNC:!function(e){if(!e.args)throw"Missing globals while syncing";wt(e.args[0],yt),Tt(e,{})}(n)}}}();const[At,xt]=function(e,t){return Ot(e,t)}("metadata");function kt(){return At()}class Nt{constructor(e){dt(this,"uuid",gt()),this.config=e}async send(e){var t,n,r;const{appId:i,sourceType:o}=null!=(t=kt())?t:{};if(!i||!o)return"metadata missing";const a=new AbortController,s=setTimeout(()=>a.abort(),1e4);return await(null!=(r=null==(n=this.config)?void 0:n.fetch)?r:fetch)(this.getUrl(),{method:"POST",headers:this.getHeaders(),body:JSON.stringify(this.buildReport(e)),signal:a.signal}),clearTimeout(s),"success"}getUrl(){var e;let t=null!=(e=kt().proxyUrl)?e:"https://";return t+=("/"===t.at(-1)?"":"/")+"hlg.tokbox.com/prod/logging/vcp_webrtc",t}getHeaders(){return{"Content-Type":"application/json"}}buildReport(e){const t=kt();return{guid:this.uuid,...e,applicationId:t.appId,timestamp:Date.now(),proxyUrl:t.proxyUrl,source:t.sourceType}}}class Lt{constructor(){o(this,"canvas"),o(this,"context");const e=new OffscreenCanvas(0,0),t=e.getContext("2d");if(!t)throw"Fail to retrieve webgl2 context";this.canvas=e,this.context=t}setFlickeringOptions(e){}enablePostProcessing(){}disablePostProcessing(){}async profileWebgl(e){return[]}async render(e,t){return this.canvas}resizeCanvas(e){const{width:t,height:n}=e;this.canvas.width=t,this.canvas.height=n}renderSilhouette(e,t,n="none"){const{width:r,height:i}=e;this.context.save(),this.context.drawImage(t,0,0,t.width,t.height,0,0,r,i),this.context.globalCompositeOperation="source-in",this.context.filter=n,this.context.drawImage(e,0,0,r,i,0,0,this.canvas.width,this.canvas.height),this.context.restore()}}class Mt extends Lt{constructor(e){super(),this.radius=e}async render(e,t){return super.resizeCanvas(e),this.renderSilhouette(e,t),this.context.save(),this.context.filter=`blur(${this.radius}px)`,this.context.globalCompositeOperation="destination-over",this.context.drawImage(e,0,0,e.width,e.height),this.context.restore(),super.render(e,t)}}class Vt extends Lt{constructor(e){super(),this.radius=e}async render(e,t){return super.resizeCanvas(e),this.renderSilhouette(e,t,`blur(${this.radius}px)`),this.context.save(),this.context.filter="none",this.context.globalCompositeOperation="destination-over",this.context.drawImage(e,0,0,e.width,e.height),this.context.restore(),super.render(e,t)}}class Pt extends Lt{constructor(){super(...arguments),o(this,"backgroundImage")}setBackgroundImage(e){this.backgroundImage=e}async render(e,t){return super.resizeCanvas(e),this.renderSilhouette(e,t),this.backgroundImage&&(this.context.save(),this.context.filter="none",this.context.globalCompositeOperation="destination-over",this.context.drawImage(this.backgroundImage,0,0,this.backgroundImage.width,this.backgroundImage.height,0,0,e.width,e.height),this.context.restore()),super.render(e,t)}}
/* @license twgl.js 5.2.0 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
Available via the MIT license.
see: http://github.com/greggman/twgl.js for details */const Dt={};{const e=Dt;e[5120]=Int8Array,e[5121]=Uint8Array,e[5122]=Int16Array,e[5123]=Uint16Array,e[5124]=Int32Array,e[5125]=Uint32Array,e[5126]=Float32Array,e[32819]=Uint16Array,e[32820]=Uint16Array,e[33635]=Uint16Array,e[5131]=Uint16Array,e[33640]=Uint32Array,e[35899]=Uint32Array,e[35902]=Uint32Array,e[36269]=Uint32Array,e[34042]=Uint32Array}function Zt(e){if(e instanceof Int8Array)return 5120;if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)return 5121;if(e instanceof Int16Array)return 5122;if(e instanceof Uint16Array)return 5123;if(e instanceof Int32Array)return 5124;if(e instanceof Uint32Array)return 5125;if(e instanceof Float32Array)return 5126;throw new Error("unsupported typed array type")}function jt(e){if(e===Int8Array)return 5120;if(e===Uint8Array||e===Uint8ClampedArray)return 5121;if(e===Int16Array)return 5122;if(e===Uint16Array)return 5123;if(e===Int32Array)return 5124;if(e===Uint32Array)return 5125;if(e===Float32Array)return 5126;throw new Error("unsupported typed array type")}function Wt(e){const t=Dt[e];if(!t)throw new Error("unknown gl type");return t}const Gt=typeof SharedArrayBuffer<"u"?function(e){return e&&e.buffer&&(e.buffer instanceof ArrayBuffer||e.buffer instanceof SharedArrayBuffer)}:function(e){return e&&e.buffer&&e.buffer instanceof ArrayBuffer};function Ft(...e){console.error(...e)}const Ut=new Map;function Xt(e,t){if(!e||"object"!=typeof e)return!1;let n=Ut.get(t);n||(n=new WeakMap,Ut.set(t,n));let r=n.get(e);if(void 0===r){const i=Object.prototype.toString.call(e);r=i.substring(8,i.length-1)===t,n.set(e,r)}return r}function Bt(e,t){return typeof WebGLTexture<"u"&&Xt(t,"WebGLTexture")}const Ht=34962,Yt="";function Jt(e,t,n,r){if(function(e,t){return typeof WebGLBuffer<"u"&&Xt(t,"WebGLBuffer")}(0,t))return t;n=n||Ht;const i=e.createBuffer();return function(e,t,n,r,i){e.bindBuffer(t,n),e.bufferData(t,r,i||35044)}(e,n,i,t,r),i}function zt(e){return"indices"===e}const Kt=/coord|texture/i,Qt=/color|colour/i;function qt(e,t,n){return e.numComponents||e.size||function(e,t){let n;if(n=Kt.test(e)?2:Qt.test(e)?4:3,t%n>0)throw new Error(`Can not guess numComponents for attribute '${e}'. Tried ${n} but ${t} values is not evenly divisible by ${n}. You should specify it.`);return n}(t,n||function(e){return e.length?e:e.data}(e).length)}function $t(e,t){if(Gt(e))return e;if(Gt(e.data))return e.data;Array.isArray(e)&&(e={data:e});let n=e.type?tn(e.type):void 0;return n||(n=zt(t)?Uint16Array:Float32Array),new n(e.data)}function en(e){return"number"==typeof e?e:e?jt(e):5126}function tn(e){return"number"==typeof e?Wt(e):e||Float32Array}function nn(e,t){return{buffer:t.buffer,numValues:24,type:en(t.type),arrayType:tn(t.type)}}function rn(e,t){const n=t.data||t,r=tn(t.type),i=n*r.BYTES_PER_ELEMENT,o=e.createBuffer();return e.bindBuffer(Ht,o),e.bufferData(Ht,i,t.drawType||35044),{buffer:o,numValues:n,type:jt(r),arrayType:r}}function on(e,t,n){const r=$t(t,n);return{arrayType:r.constructor,buffer:Jt(e,r,void 0,t.drawType),type:Zt(r),numValues:0}}function an(e,t){const n={};return Object.keys(t).forEach((function(r){if(!zt(r)){const i=t[r],o=i.attrib||i.name||i.attribName||Yt+r;if(i.value){if(!Array.isArray(i.value)&&!Gt(i.value))throw new Error("array.value is not array or typedarray");n[o]={value:i.value}}else{let t;t=i.buffer&&i.buffer instanceof WebGLBuffer?nn:"number"==typeof i||"number"==typeof i.data?rn:on;const{buffer:a,type:s,numValues:c,arrayType:u}=t(e,i,r),d=void 0!==i.normalize?i.normalize:function(e){return e===Int8Array||e===Uint8Array}(u),l=qt(i,r,c);n[o]={buffer:a,numComponents:l,type:s,normalize:d,stride:i.stride||0,offset:i.offset||0,divisor:void 0===i.divisor?void 0:i.divisor,drawType:i.drawType}}}})),e.bindBuffer(Ht,null),n}const sn=["position","positions","a_position"];function cn(e,t,n){const r=an(e,t),i=Object.assign({},n||{});i.attribs=Object.assign({},n?n.attribs:{},r);const o=t.indices;if(o){const t=$t(o,"indices");i.indices=Jt(e,t,34963),i.numElements=t.length,i.elementType=Zt(t)}else i.numElements||(i.numElements=function(e,t){let n,r;for(r=0;r<sn.length&&(n=sn[r],!(n in t)&&(n=Yt+n,!(n in t)));++r);r===sn.length&&(n=Object.keys(t)[0]);const i=t[n];if(!i.buffer)return 1;e.bindBuffer(Ht,i.buffer);const o=e.getBufferParameter(Ht,34660);e.bindBuffer(Ht,null);const a=o/function(e,t){return 5120===t||5121===t?1:5122===t||5123===t?2:5124===t||5125===t||5126===t?4:0}(0,i.type),s=i.numComponents||i.size,c=a/s;if(c%1!=0)throw new Error(`numComponents ${s} not correct for length ${length}`);return c}(e,i.attribs));return i}function un(e){return!!e.texStorage2D}const dn=function(){const e={},t={};return function(n,r){return function(n){const r=n.constructor.name;if(!e[r]){for(const e in n)if("number"==typeof n[e]){const r=t[n[e]];t[n[e]]=r?`${r} | ${e}`:e}e[r]=!0}}(n),t[r]||("number"==typeof r?"0x"+r.toString(16):r)}}(),ln={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},fn=Gt,pn=function(){let e;return function(){return e=e||(typeof document<"u"&&document.createElement?document.createElement("canvas").getContext("2d"):null),e}}(),hn=6407,mn=6408,gn=6402,vn=33071,yn=3553,bn=34067,Sn=32879,En=35866,_n=10242,Tn=10243,Rn=5120,In=5121,wn=5123,Cn=5125,On=5126,An=5131,xn=36193,kn=33319,Nn=33320,Ln=36244,Mn=36248,Vn=36249;let Pn;function Dn(e){if(!Pn){const e={};e[6406]={textureFormat:6406,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[In,An,xn,On]},e[6409]={textureFormat:6409,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[In,An,xn,On]},e[6410]={textureFormat:6410,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[In,An,xn,On]},e[hn]={textureFormat:hn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[In,An,xn,On,33635]},e[mn]={textureFormat:mn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[In,An,xn,On,32819,32820]},e[gn]={textureFormat:gn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[Cn,wn]},e[33321]={textureFormat:6403,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1],type:[In]},e[36756]={textureFormat:6403,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[1],type:[Rn]},e[33325]={textureFormat:6403,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[On,An]},e[33326]={textureFormat:6403,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[4],type:[On]},e[33330]={textureFormat:Ln,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[In]},e[33329]={textureFormat:Ln,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[Rn]},e[33332]={textureFormat:Ln,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[wn]},e[33331]={textureFormat:Ln,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[5122]},e[33334]={textureFormat:Ln,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Cn]},e[33333]={textureFormat:Ln,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[5124]},e[33323]={textureFormat:kn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2],type:[In]},e[36757]={textureFormat:kn,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[2],type:[Rn]},e[33327]={textureFormat:kn,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[On,An]},e[33328]={textureFormat:kn,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[8],type:[On]},e[33336]={textureFormat:Nn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[In]},e[33335]={textureFormat:Nn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Rn]},e[33338]={textureFormat:Nn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[wn]},e[33337]={textureFormat:Nn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[5122]},e[33340]={textureFormat:Nn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Cn]},e[33339]={textureFormat:Nn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[5124]},e[32849]={textureFormat:hn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3],type:[In]},e[35905]={textureFormat:hn,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[In]},e[36194]={textureFormat:hn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[In,33635]},e[36758]={textureFormat:hn,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[Rn]},e[35898]={textureFormat:hn,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[On,An,35899]},e[35901]={textureFormat:hn,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[On,An,35902]},e[34843]={textureFormat:hn,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[On,An]},e[34837]={textureFormat:hn,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[On]},e[36221]={textureFormat:Mn,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[In]},e[36239]={textureFormat:Mn,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[Rn]},e[36215]={textureFormat:Mn,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[wn]},e[36233]={textureFormat:Mn,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[5122]},e[36209]={textureFormat:Mn,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[Cn]},e[36227]={textureFormat:Mn,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[5124]},e[32856]={textureFormat:mn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[In]},e[35907]={textureFormat:mn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[In]},e[36759]={textureFormat:mn,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4],type:[Rn]},e[32855]={textureFormat:mn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[In,32820,33640]},e[32854]={textureFormat:mn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[In,32819]},e[32857]={textureFormat:mn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[33640]},e[34842]={textureFormat:mn,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[On,An]},e[34836]={textureFormat:mn,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[16],type:[On]},e[36220]={textureFormat:Vn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[In]},e[36238]={textureFormat:Vn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Rn]},e[36975]={textureFormat:Vn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[33640]},e[36214]={textureFormat:Vn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[wn]},e[36232]={textureFormat:Vn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[5122]},e[36226]={textureFormat:Vn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[5124]},e[36208]={textureFormat:Vn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[Cn]},e[33189]={textureFormat:gn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[wn,Cn]},e[33190]={textureFormat:gn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Cn]},e[36012]={textureFormat:gn,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[On]},e[35056]={textureFormat:34041,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[34042]},e[36013]={textureFormat:34041,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[36269]},Object.keys(e).forEach((function(t){const n=e[t];n.bytesPerElementMap={},n.bytesPerElement.forEach((function(e,t){const r=n.type[t];n.bytesPerElementMap[r]=e}))})),Pn=e}return Pn[e]}function Zn(e){const t=Dn(e);if(!t)throw"unknown internal format";return{format:t.textureFormat,type:t.type[0]}}function jn(e){return 0==(e&e-1)}function Wn(e,t,n,r,i){if(i%1!=0)throw"can't guess dimensions";if(n||r){if(r){if(!n&&(n=i/r)%1)throw"can't guess dimensions"}else if((r=i/n)%1)throw"can't guess dimensions"}else{const e=Math.sqrt(i/(t===bn?6:1));e%1==0?(n=e,r=e):(n=i,r=1)}return{width:n,height:r}}function Gn(e,t){void 0!==t.colorspaceConversion&&e.pixelStorei(37443,t.colorspaceConversion),void 0!==t.premultiplyAlpha&&e.pixelStorei(37441,t.premultiplyAlpha),void 0!==t.flipY&&e.pixelStorei(37440,t.flipY)}function Fn(e){e.pixelStorei(3317,4),un(e)&&(e.pixelStorei(3314,0),e.pixelStorei(32878,0),e.pixelStorei(3316,0),e.pixelStorei(3315,0),e.pixelStorei(32877,0))}function Un(e,t,n,r){r.minMag&&(n.call(e,t,10241,r.minMag),n.call(e,t,10240,r.minMag)),r.min&&n.call(e,t,10241,r.min),r.mag&&n.call(e,t,10240,r.mag),r.wrap&&(n.call(e,t,_n,r.wrap),n.call(e,t,Tn,r.wrap),(t===Sn||function(e,t){return typeof WebGLSampler<"u"&&Xt(t,"WebGLSampler")}(0,t))&&n.call(e,t,32882,r.wrap)),r.wrapR&&n.call(e,t,32882,r.wrapR),r.wrapS&&n.call(e,t,_n,r.wrapS),r.wrapT&&n.call(e,t,Tn,r.wrapT),r.minLod&&n.call(e,t,33082,r.minLod),r.maxLod&&n.call(e,t,33083,r.maxLod),r.baseLevel&&n.call(e,t,33084,r.baseLevel),r.maxLevel&&n.call(e,t,33085,r.maxLevel)}function Xn(e,t,n){const r=n.target||yn;e.bindTexture(r,t),Un(e,r,e.texParameteri,n)}function Bn(e,t,n,r,i,o){o=o||mn;const a=(n=n||ln.textureOptions).target||yn;if(r=r||n.width,i=i||n.height,e.bindTexture(a,t),function(e,t,n,r){if(!un(e))return jn(t)&&jn(n);const i=Dn(r);if(!i)throw"unknown internal format";return i.colorRenderable&&i.textureFilterable}(e,r,i,o))e.generateMipmap(a);else{const t=function(e){const t=Dn(e);if(!t)throw"unknown internal format";return t.textureFilterable}(o)?9729:9728;e.texParameteri(a,10241,t),e.texParameteri(a,10240,t),e.texParameteri(a,_n,vn),e.texParameteri(a,Tn,vn)}}function Hn(e){return!0===e.auto||void 0===e.auto&&void 0===e.level}function Yn(e,t){return(t=t||{}).cubeFaceOrder||[34069,34070,34071,34072,34073,34074]}function Jn(e,t){const n=Yn(0,t).map((function(e,t){return{face:e,ndx:t}}));return n.sort((function(e,t){return e.face-t.face})),n}function zn(e,t,n,r){const i=(r=r||ln.textureOptions).target||yn,o=r.level||0;let a=n.width,s=n.height;const c=r.internalFormat||r.format||mn,u=Zn(c),d=r.format||u.format,l=r.type||u.type;if(Gn(e,r),e.bindTexture(i,t),i===bn){const u=n.width,f=n.height;let p,h;if(u/6===f)p=f,h=[0,0,1,0,2,0,3,0,4,0,5,0];else if(f/6===u)p=u,h=[0,0,0,1,0,2,0,3,0,4,0,5];else if(u/3==f/2)p=u/3,h=[0,0,1,0,2,0,0,1,1,1,2,1];else{if(u/2!=f/3)throw"can't figure out cube map from element: "+(n.src?n.src:n.nodeName);p=u/2,h=[0,0,1,0,0,1,1,1,0,2,1,2]}const m=pn();m?(m.canvas.width=p,m.canvas.height=p,a=p,s=p,Jn(0,r).forEach((function(t){const r=h[2*t.ndx+0]*p,i=h[2*t.ndx+1]*p;m.drawImage(n,r,i,p,p,0,0,p,p),e.texImage2D(t.face,o,c,d,l,m.canvas)})),m.canvas.width=1,m.canvas.height=1):typeof createImageBitmap<"u"&&(a=p,s=p,Jn(0,r).forEach((function(u){const f=h[2*u.ndx+0]*p,m=h[2*u.ndx+1]*p;e.texImage2D(u.face,o,c,p,p,0,d,l,null),createImageBitmap(n,f,m,p,p,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then((function(n){Gn(e,r),e.bindTexture(i,t),e.texImage2D(u.face,o,c,d,l,n),Hn(r)&&Bn(e,t,r,a,s,c)}))})))}else if(i===Sn||i===En){const t=Math.min(n.width,n.height),r=Math.max(n.width,n.height),a=r/t;if(a%1!=0)throw"can not compute 3D dimensions of element";const s=n.width===r?1:0,u=n.height===r?1:0;e.pixelStorei(3317,1),e.pixelStorei(3314,n.width),e.pixelStorei(32878,0),e.pixelStorei(32877,0),e.texImage3D(i,o,c,t,t,t,0,d,l,null);for(let r=0;r<a;++r){const a=r*t*s,c=r*t*u;e.pixelStorei(3316,a),e.pixelStorei(3315,c),e.texSubImage3D(i,o,0,0,r,t,t,1,d,l,n)}Fn(e)}else e.texImage2D(i,o,c,d,l,n);Hn(r)&&Bn(e,t,r,a,s,c),Xn(e,t,r)}function Kn(){}function Qn(e,t){return void 0!==t||function(e){if(typeof document<"u"){const t=document.createElement("a");return t.href=e,t.hostname===location.hostname&&t.port===location.port&&t.protocol===location.protocol}{const t=new URL(location.href).origin;return new URL(e,location.href).origin===t}}(e)?t:"anonymous"}function qn(e){return typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof ImageData<"u"&&e instanceof ImageData||typeof HTMLElement<"u"&&e instanceof HTMLElement}function $n(e,t,n){return qn(e)?(setTimeout((function(){n(null,e)})),e):function(e,t,n){let r;if(n=n||Kn,t=Qn(e,t=void 0!==t?t:ln.crossOrigin),typeof Image<"u"){r=new Image,void 0!==t&&(r.crossOrigin=t);const i=function(){r.removeEventListener("error",o),r.removeEventListener("load",a),r=null},o=function(){const t="couldn't load image: "+e;Ft(t),n(t,r),i()},a=function(){n(null,r),i()};return r.addEventListener("error",o),r.addEventListener("load",a),r.src=e,r}if(typeof ImageBitmap<"u"){let i,o;const a=function(){n(i,o)},s={};t&&(s.mode="cors"),fetch(e,s).then((function(e){if(!e.ok)throw e;return e.blob()})).then((function(e){return createImageBitmap(e,{premultiplyAlpha:"none",colorSpaceConversion:"none"})})).then((function(e){o=e,setTimeout(a)})).catch((function(e){i=e,setTimeout(a)})),r=null}return r}(e,t,n)}function er(e,t,n){const r=(n=n||ln.textureOptions).target||yn;if(e.bindTexture(r,t),!1===n.color)return;const i=function(e){return fn(e=e||ln.textureColor)?e:new Uint8Array([255*e[0],255*e[1],255*e[2],255*e[3]])}(n.color);if(r===bn)for(let t=0;t<6;++t)e.texImage2D(34069+t,0,mn,1,1,0,mn,In,i);else r===Sn||r===En?e.texImage3D(r,0,mn,1,1,1,0,mn,In,i):e.texImage2D(r,0,mn,1,1,0,mn,In,i)}function tr(e,t,n,r){r=r||Kn;const i=n.src;if(6!==i.length)throw"there must be 6 urls for a cubemap";const o=n.level||0,a=n.internalFormat||n.format||mn,s=Zn(a),c=n.format||s.format,u=n.type||In,d=n.target||yn;if(d!==bn)throw"target must be TEXTURE_CUBE_MAP";er(e,t,n),n=Object.assign({},n);let l=6;const f=[],p=Yn(0,n);let h;h=i.map((function(i,s){return $n(i,n.crossOrigin,function(i){return function(s,p){--l,s?f.push(s):p.width!==p.height?f.push("cubemap face img is not a square: "+p.src):(Gn(e,n),e.bindTexture(d,t),5===l?Yn().forEach((function(t){e.texImage2D(t,o,a,c,u,p)})):e.texImage2D(i,o,a,c,u,p),Hn(n)&&e.generateMipmap(d)),0===l&&r(f.length?f:void 0,t,h)}}(p[s]))}))}function nr(e,t,n,r){r=r||Kn;const i=n.src,o=n.internalFormat||n.format||mn,a=Zn(o),s=n.format||a.format,c=n.type||In,u=n.target||En;if(u!==Sn&&u!==En)throw"target must be TEXTURE_3D or TEXTURE_2D_ARRAY";er(e,t,n),n=Object.assign({},n);let d=i.length;const l=[];let f;const p=n.level||0;let h=n.width,m=n.height;const g=i.length;let v=!0;f=i.map((function(i,a){return $n(i,n.crossOrigin,function(i){return function(a,y){if(--d,a)l.push(a);else{if(Gn(e,n),e.bindTexture(u,t),v){v=!1,h=n.width||y.width,m=n.height||y.height,e.texImage3D(u,p,o,h,m,g,0,s,c,null);for(let t=0;t<g;++t)e.texSubImage3D(u,p,0,0,t,h,m,1,s,c,y)}else{let t,n=y;(y.width!==h||y.height!==m)&&(t=pn(),n=t.canvas,t.canvas.width=h,t.canvas.height=m,t.drawImage(y,0,0,h,m)),e.texSubImage3D(u,p,0,0,i,h,m,1,s,c,n),t&&n===t.canvas&&(t.canvas.width=0,t.canvas.height=0)}Hn(n)&&e.generateMipmap(u)}0===d&&r(l.length?l:void 0,t,f)}}(a))}))}function rr(e,t,n,r){const i=(r=r||ln.textureOptions).target||yn;e.bindTexture(i,t);let o=r.width,a=r.height,s=r.depth;const c=r.level||0,u=r.internalFormat||r.format||mn,d=Zn(u),l=r.format||d.format,f=r.type||function(e,t,n){return fn(t)?Zt(t):n||In}(0,n,d.type);if(fn(n))n instanceof Uint8ClampedArray&&(n=new Uint8Array(n.buffer));else{const e=Wt(f);n=new e(n)}const p=function(e,t){const n=Dn(e);if(!n)throw"unknown internal format";const r=n.bytesPerElementMap[t];if(void 0===r)throw"unknown internal format";return r}(u,f),h=n.byteLength/p;if(h%1)throw"length wrong size for format: "+dn(e,l);let m;if(i===Sn||i===En)if(o||a||s)!o||a&&s?!a||o&&s?(m=Wn(0,i,o,a,h/s),o=m.width,a=m.height):(m=Wn(0,i,o,s,h/a),o=m.width,s=m.height):(m=Wn(0,i,a,s,h/o),a=m.width,s=m.height);else{const e=Math.cbrt(h);if(e%1!=0)throw"can't guess cube size of array of numElements: "+h;o=e,a=e,s=e}else m=Wn(0,i,o,a,h),o=m.width,a=m.height;if(Fn(e),e.pixelStorei(3317,r.unpackAlignment||1),Gn(e,r),i===bn){const t=h/6*(p/n.BYTES_PER_ELEMENT);Jn(0,r).forEach(r=>{const i=t*r.ndx,s=n.subarray(i,i+t);e.texImage2D(r.face,c,u,o,a,0,l,f,s)})}else i===Sn||i===En?e.texImage3D(i,c,u,o,a,s,0,l,f,n):e.texImage2D(i,c,u,o,a,0,l,f,n);return{width:o,height:a,depth:s,type:f}}function ir(e,t,n){n=n||Kn,t=t||ln.textureOptions;const r=e.createTexture(),i=t.target||yn;let o=t.width||1,a=t.height||1;const s=t.internalFormat||mn;e.bindTexture(i,r),i===bn&&(e.texParameteri(i,_n,vn),e.texParameteri(i,Tn,vn));let c=t.src;if(c)if("function"==typeof c&&(c=c(e,t)),"string"==typeof c)!function(e,t,n,r){r=r||Kn,er(e,t,n=n||ln.textureOptions),$n((n=Object.assign({},n)).src,n.crossOrigin,(function(i,o){i?r(i,t,o):(zn(e,t,o,n),r(null,t,o))}))}(e,r,t,n);else if(fn(c)||Array.isArray(c)&&("number"==typeof c[0]||Array.isArray(c[0])||fn(c[0]))){const n=rr(e,r,c,t);o=n.width,a=n.height}else Array.isArray(c)&&("string"==typeof c[0]||qn(c[0]))?i===bn?tr(e,r,t,n):nr(e,r,t,n):(zn(e,r,c,t),o=c.width,a=c.height);else!function(e,t,n){const r=n.target||yn;e.bindTexture(r,t);const i=n.level||0,o=n.internalFormat||n.format||mn,a=Zn(o),s=n.format||a.format,c=n.type||a.type;if(Gn(e,n),r===bn)for(let t=0;t<6;++t)e.texImage2D(34069+t,i,o,n.width,n.height,0,s,c,null);else r===Sn||r===En?e.texImage3D(r,i,o,n.width,n.height,n.depth,0,s,c,null):e.texImage2D(r,i,o,n.width,n.height,0,s,c,null)}(e,r,t);return Hn(t)&&Bn(e,r,t,o,a,s),Xn(e,r,t),r}const or=Ft;function ar(e){return typeof document<"u"&&document.getElementById?document.getElementById(e):null}const sr=33984,cr=34962,ur=34067,dr=35866,lr={};function fr(e,t){return lr[t].bindPoint}function pr(e,t){return function(n){e.uniform1i(t,n)}}function hr(e,t){return function(n){e.uniform1iv(t,n)}}function mr(e,t){return function(n){e.uniform2iv(t,n)}}function gr(e,t){return function(n){e.uniform3iv(t,n)}}function vr(e,t){return function(n){e.uniform4iv(t,n)}}function yr(e,t,n,r){const i=fr(0,t);return un(e)?function(t){let o,a;Bt(0,t)?(o=t,a=null):(o=t.texture,a=t.sampler),e.uniform1i(r,n),e.activeTexture(sr+n),e.bindTexture(i,o),e.bindSampler(n,a)}:function(t){e.uniform1i(r,n),e.activeTexture(sr+n),e.bindTexture(i,t)}}function br(e,t,n,r,i){const o=fr(0,t),a=new Int32Array(i);for(let e=0;e<i;++e)a[e]=n+e;return un(e)?function(t){e.uniform1iv(r,a),t.forEach((function(t,r){let i,s;e.activeTexture(sr+a[r]),Bt(0,t)?(i=t,s=null):(i=t.texture,s=t.sampler),e.bindSampler(n,s),e.bindTexture(o,i)}))}:function(t){e.uniform1iv(r,a),t.forEach((function(t,n){e.activeTexture(sr+a[n]),e.bindTexture(o,t)}))}}function Sr(e,t){return function(n){if(n.value)switch(e.disableVertexAttribArray(t),n.value.length){case 4:e.vertexAttrib4fv(t,n.value);break;case 3:e.vertexAttrib3fv(t,n.value);break;case 2:e.vertexAttrib2fv(t,n.value);break;case 1:e.vertexAttrib1fv(t,n.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else e.bindBuffer(cr,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,n.numComponents||n.size,n.type||5126,n.normalize||!1,n.stride||0,n.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,n.divisor||0)}}function Er(e,t){return function(n){if(n.value){if(e.disableVertexAttribArray(t),4!==n.value.length)throw new Error("The length of an integer constant value must be 4!");e.vertexAttrib4iv(t,n.value)}else e.bindBuffer(cr,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,n.numComponents||n.size,n.type||5124,n.stride||0,n.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,n.divisor||0)}}function _r(e,t){return function(n){if(n.value){if(e.disableVertexAttribArray(t),4!==n.value.length)throw new Error("The length of an unsigned integer constant value must be 4!");e.vertexAttrib4uiv(t,n.value)}else e.bindBuffer(cr,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,n.numComponents||n.size,n.type||5125,n.stride||0,n.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,n.divisor||0)}}function Tr(e,t,n){const r=n.size,i=n.count;return function(n){e.bindBuffer(cr,n.buffer);const o=n.size||n.numComponents||r,a=o/i,s=n.type||5126,c=lr[s].size*o,u=n.normalize||!1,d=n.offset||0,l=c/i;for(let r=0;r<i;++r)e.enableVertexAttribArray(t+r),e.vertexAttribPointer(t+r,a,s,u,c,d+l*r),e.vertexAttribDivisor&&e.vertexAttribDivisor(t+r,n.divisor||0)}}lr[5126]={Type:Float32Array,size:4,setter:function(e,t){return function(n){e.uniform1f(t,n)}},arraySetter:function(e,t){return function(n){e.uniform1fv(t,n)}}},lr[35664]={Type:Float32Array,size:8,setter:function(e,t){return function(n){e.uniform2fv(t,n)}},cols:2},lr[35665]={Type:Float32Array,size:12,setter:function(e,t){return function(n){e.uniform3fv(t,n)}},cols:3},lr[35666]={Type:Float32Array,size:16,setter:function(e,t){return function(n){e.uniform4fv(t,n)}},cols:4},lr[5124]={Type:Int32Array,size:4,setter:pr,arraySetter:hr},lr[35667]={Type:Int32Array,size:8,setter:mr,cols:2},lr[35668]={Type:Int32Array,size:12,setter:gr,cols:3},lr[35669]={Type:Int32Array,size:16,setter:vr,cols:4},lr[5125]={Type:Uint32Array,size:4,setter:function(e,t){return function(n){e.uniform1ui(t,n)}},arraySetter:function(e,t){return function(n){e.uniform1uiv(t,n)}}},lr[36294]={Type:Uint32Array,size:8,setter:function(e,t){return function(n){e.uniform2uiv(t,n)}},cols:2},lr[36295]={Type:Uint32Array,size:12,setter:function(e,t){return function(n){e.uniform3uiv(t,n)}},cols:3},lr[36296]={Type:Uint32Array,size:16,setter:function(e,t){return function(n){e.uniform4uiv(t,n)}},cols:4},lr[35670]={Type:Uint32Array,size:4,setter:pr,arraySetter:hr},lr[35671]={Type:Uint32Array,size:8,setter:mr,cols:2},lr[35672]={Type:Uint32Array,size:12,setter:gr,cols:3},lr[35673]={Type:Uint32Array,size:16,setter:vr,cols:4},lr[35674]={Type:Float32Array,size:32,setter:function(e,t){return function(n){e.uniformMatrix2fv(t,!1,n)}},rows:2,cols:2},lr[35675]={Type:Float32Array,size:48,setter:function(e,t){return function(n){e.uniformMatrix3fv(t,!1,n)}},rows:3,cols:3},lr[35676]={Type:Float32Array,size:64,setter:function(e,t){return function(n){e.uniformMatrix4fv(t,!1,n)}},rows:4,cols:4},lr[35685]={Type:Float32Array,size:32,setter:function(e,t){return function(n){e.uniformMatrix2x3fv(t,!1,n)}},rows:2,cols:3},lr[35686]={Type:Float32Array,size:32,setter:function(e,t){return function(n){e.uniformMatrix2x4fv(t,!1,n)}},rows:2,cols:4},lr[35687]={Type:Float32Array,size:48,setter:function(e,t){return function(n){e.uniformMatrix3x2fv(t,!1,n)}},rows:3,cols:2},lr[35688]={Type:Float32Array,size:48,setter:function(e,t){return function(n){e.uniformMatrix3x4fv(t,!1,n)}},rows:3,cols:4},lr[35689]={Type:Float32Array,size:64,setter:function(e,t){return function(n){e.uniformMatrix4x2fv(t,!1,n)}},rows:4,cols:2},lr[35690]={Type:Float32Array,size:64,setter:function(e,t){return function(n){e.uniformMatrix4x3fv(t,!1,n)}},rows:4,cols:3},lr[35678]={Type:null,size:0,setter:yr,arraySetter:br,bindPoint:3553},lr[35680]={Type:null,size:0,setter:yr,arraySetter:br,bindPoint:ur},lr[35679]={Type:null,size:0,setter:yr,arraySetter:br,bindPoint:32879},lr[35682]={Type:null,size:0,setter:yr,arraySetter:br,bindPoint:3553},lr[36289]={Type:null,size:0,setter:yr,arraySetter:br,bindPoint:dr},lr[36292]={Type:null,size:0,setter:yr,arraySetter:br,bindPoint:dr},lr[36293]={Type:null,size:0,setter:yr,arraySetter:br,bindPoint:ur},lr[36298]={Type:null,size:0,setter:yr,arraySetter:br,bindPoint:3553},lr[36299]={Type:null,size:0,setter:yr,arraySetter:br,bindPoint:32879},lr[36300]={Type:null,size:0,setter:yr,arraySetter:br,bindPoint:ur},lr[36303]={Type:null,size:0,setter:yr,arraySetter:br,bindPoint:dr},lr[36306]={Type:null,size:0,setter:yr,arraySetter:br,bindPoint:3553},lr[36307]={Type:null,size:0,setter:yr,arraySetter:br,bindPoint:32879},lr[36308]={Type:null,size:0,setter:yr,arraySetter:br,bindPoint:ur},lr[36311]={Type:null,size:0,setter:yr,arraySetter:br,bindPoint:dr};const Rr={};Rr[5126]={size:4,setter:Sr},Rr[35664]={size:8,setter:Sr},Rr[35665]={size:12,setter:Sr},Rr[35666]={size:16,setter:Sr},Rr[5124]={size:4,setter:Er},Rr[35667]={size:8,setter:Er},Rr[35668]={size:12,setter:Er},Rr[35669]={size:16,setter:Er},Rr[5125]={size:4,setter:_r},Rr[36294]={size:8,setter:_r},Rr[36295]={size:12,setter:_r},Rr[36296]={size:16,setter:_r},Rr[35670]={size:4,setter:Er},Rr[35671]={size:8,setter:Er},Rr[35672]={size:12,setter:Er},Rr[35673]={size:16,setter:Er},Rr[35674]={size:4,setter:Tr,count:2},Rr[35675]={size:9,setter:Tr,count:3},Rr[35676]={size:16,setter:Tr,count:4};const Ir=/ERROR:\s*\d+:(\d+)/gi,wr=/^[ \t]*\n/;function Cr(e){let t=0;return wr.test(e)&&(t=1,e=e.replace(wr,"")),{lineOffset:t,shaderSource:e}}function Or(e,t,n,r){if(r=r||or,!e.getShaderParameter(n,35713)){const i=e.getShaderInfoLog(n),{lineOffset:o,shaderSource:a}=Cr(e.getShaderSource(n)),s=`${function(e,t="",n=0){const r=[...t.matchAll(Ir)],i=new Map(r.map((e,n)=>{const i=parseInt(e[1]),o=r[n+1],a=o?o.index:t.length;return[i-1,t.substring(e.index,a)]}));return e.split("\n").map((e,t)=>{const r=i.get(t);return`${t+1+n}: ${e}${r?"\n\n^^^ "+r:""}`}).join("\n")}(a,i,o)}\nError compiling ${dn(e,t)}: ${i}`;return r(s),s}return""}function Ar(e,t,n){let r,i,o;if("function"==typeof t&&(n=t,t=void 0),"function"==typeof e)n=e,e=void 0;else if(e&&!Array.isArray(e)){const t=e;n=t.errorCallback,e=t.attribLocations,r=t.transformFeedbackVaryings,i=t.transformFeedbackMode,o=t.callback}const a=n||or,s=[],c={errorCallback(e,...t){s.push(e),a(e,...t)},transformFeedbackVaryings:r,transformFeedbackMode:i,callback:o,errors:s};{let n={};Array.isArray(e)?e.forEach((function(e,r){n[e]=t?t[r]:r})):n=e||{},c.attribLocations=n}return c}const xr=["VERTEX_SHADER","FRAGMENT_SHADER"];function kr(e,t){return t.indexOf("frag")>=0?35632:t.indexOf("vert")>=0?35633:void 0}const Nr=(t=0)=>new e(e=>setTimeout(e,t));function Lr(e,t,n,r,i){const o=Ar(n,r,i),a=new Set(t),s=function(e,t,n){const r=e.createProgram(),{attribLocations:i,transformFeedbackVaryings:o,transformFeedbackMode:a}=Ar(n);for(let n=0;n<t.length;++n){let i=t[n];if("string"==typeof i){const t=ar(i),o=t?t.text:i;let a=e[xr[n]];t&&t.type&&(a=kr(0,t.type)||a),i=e.createShader(a),e.shaderSource(i,Cr(o).shaderSource),e.compileShader(i),e.attachShader(r,i)}}Object.entries(i).forEach(([t,n])=>e.bindAttribLocation(r,n,t));{let t=o;t&&(t.attribs&&(t=t.attribs),Array.isArray(t)||(t=Object.keys(t)),e.transformFeedbackVaryings(r,t,a||35981))}return e.linkProgram(r),r}(e,t,o);function c(e,t){const n=function(e,t,n){if(n=n||or,!e.getProgramParameter(t,35714)){const r=e.getProgramInfoLog(t);n("Error in program linking: "+r);const i=e.getAttachedShaders(t).map(t=>Or(e,e.getShaderParameter(t,e.SHADER_TYPE),t,n));return`${r}\n${i.filter(e=>e).join("\n")}`}}(e,t,o.errorCallback);return n&&function(e,t,n){const r=e.getAttachedShaders(t);for(const t of r)n.has(t)&&e.deleteShader(t);e.deleteProgram(t)}(e,t,a),n}if(!o.callback)return c(e,s)?void 0:s;(async function(e,t){const n=e.getExtension("KHR_parallel_shader_compile"),r=n?(e,t)=>e.getProgramParameter(t,n.COMPLETION_STATUS_KHR):()=>!0;let i=0;do{await Nr(i),i=1e3/60}while(!r(e,t))})(e,s).then(()=>{const t=c(e,s);o.callback(t,t?void 0:s)})}function Mr(e){const t=e.name;return t.startsWith("gl_")||t.startsWith("webgl_")}const Vr=/(\.|\[|]|\w+)/g,Pr=e=>e>="0"&&e<="9";function Dr(e,t,n,r){const i=e.split(Vr).filter(e=>""!==e);let o=0,a="";for(;;){const e=i[o++];a+=e;const s=Pr(e[0]),c=s?parseInt(e):e;if(s&&(a+=i[o++]),o===i.length){n[c]=t;break}{const e=i[o++],t="["===e,s=n[c]||(t?[]:{});n[c]=s,n=s,r[a]=r[a]||function(e){return function(t){Zr(e,t)}}(s),a+=e}}}function Zr(e,t){for(const n in t){const r=e[n];"function"==typeof r?r(t[n]):Zr(e[n],t[n])}}function jr(e,t){const n=function(e,t){let n=0;function r(t,r,i){const o=r.name.endsWith("[0]"),a=r.type,s=lr[a];if(!s)throw new Error("unknown type: 0x"+a.toString(16));let c;if(s.bindPoint){const t=n;n+=r.size,c=o?s.arraySetter(e,a,t,i,r.size):s.setter(e,a,t,i,r.size)}else c=s.arraySetter&&o?s.arraySetter(e,i):s.setter(e,i);return c.location=i,c}const i={},o={},a=e.getProgramParameter(t,35718);for(let n=0;n<a;++n){const a=e.getActiveUniform(t,n);if(Mr(a))continue;let s=a.name;s.endsWith("[0]")&&(s=s.substr(0,s.length-3));const c=e.getUniformLocation(t,a.name);if(c){const e=r(0,a,c);i[s]=e,Dr(s,e,o,i)}}return i}(e,t),r=function(e,t){const n={},r=e.getProgramParameter(t,35721);for(let i=0;i<r;++i){const r=e.getActiveAttrib(t,i);if(Mr(r))continue;const o=e.getAttribLocation(t,r.name),a=Rr[r.type],s=a.setter(e,o,a);s.location=o,n[r.name]=s}return n}(e,t),i={program:t,uniformSetters:n,attribSetters:r};return un(e)&&(i.uniformBlockSpec=function(e,t){const n=e.getProgramParameter(t,35718),r=[],i=[];for(let o=0;o<n;++o){i.push(o),r.push({});const n=e.getActiveUniform(t,o);r[o].name=n.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach((function(n){const o=n[0],a=n[1];e.getActiveUniforms(t,i,e[o]).forEach((function(e,t){r[t][a]=e}))}));const o={},a=e.getProgramParameter(t,35382);for(let n=0;n<a;++n){const r=e.getActiveUniformBlockName(t,n),i={index:e.getUniformBlockIndex(t,r),usedByVertexShader:e.getActiveUniformBlockParameter(t,n,35396),usedByFragmentShader:e.getActiveUniformBlockParameter(t,n,35398),size:e.getActiveUniformBlockParameter(t,n,35392),uniformIndices:e.getActiveUniformBlockParameter(t,n,35395)};i.used=i.usedByVertexShader||i.usedByFragmentShader,o[r]=i}return{blockSpecs:o,uniformData:r}}(e,t),i.transformFeedbackInfo=function(e,t){const n={},r=e.getProgramParameter(t,35971);for(let i=0;i<r;++i){const r=e.getTransformFeedbackVarying(t,i);n[r.name]={index:i,type:r.type,size:r.size}}return n}(e,t)),i}const Wr=/\s|{|}|;/;function Gr(e,t,n,r,i){const o=Ar(n,r,i),a=[];if(t=t.map((function(e){if(!Wr.test(e)){const t=ar(e);if(t)e=t.text;else{const t="no element with id: "+e;o.errorCallback(t),a.push(t)}}return e})),a.length)return function(e,t){return e.errorCallback(t),e.callback&&setTimeout(()=>{e.callback(`${t}\n${e.errors.join("\n")}`)}),null}(o,"");const s=o.callback;s&&(o.callback=(t,n)=>{s(t,t?void 0:jr(e,n))});const c=function(e,t,n,r,i){return Lr(e,t,n,r,i)}(e,t,o);return c?jr(e,c):null}const Fr=36161,Ur=36096,Xr=[{format:6408,type:5121,min:9729,wrap:33071},{format:34041}],Br={34041:33306,6401:36128,36168:36128};Br[6402]=Ur,Br[33189]=Ur,Br[33190]=Ur,Br[36012]=Ur,Br[35056]=33306,Br[36013]=33306;const Hr={};function Yr(e,t,n,r){const i=36160,o=e.createFramebuffer();e.bindFramebuffer(i,o),n=n||e.drawingBufferWidth,r=r||e.drawingBufferHeight;const a=[],s={framebuffer:o,attachments:[],width:n,height:r};return(t=t||Xr).forEach((function(t,o){let c=t.attachment;const u=t.samples,d=t.format;let l=t.attachmentPoint||function(e,t){return Br[e]||Br[t]}(d,t.internalFormat);if(l||(l=36064+o),function(e){return e>=36064&&e<36096}(l)&&a.push(l),!c)if(void 0!==u||function(e){return Hr[e]}(d))c=e.createRenderbuffer(),e.bindRenderbuffer(Fr,c),u>1?e.renderbufferStorageMultisample(Fr,u,d,n,r):e.renderbufferStorage(Fr,d,n,r);else{const i=Object.assign({},t);i.width=n,i.height=r,void 0===i.auto&&(i.auto=!1,i.min=i.min||i.minMag||9729,i.mag=i.mag||i.minMag||9729,i.wrapS=i.wrapS||i.wrap||33071,i.wrapT=i.wrapT||i.wrap||33071),c=ir(e,i)}if(function(e,t){return typeof WebGLRenderbuffer<"u"&&Xt(t,"WebGLRenderbuffer")}(0,c))e.framebufferRenderbuffer(i,l,Fr,c);else{if(!Bt(0,c))throw new Error("unknown attachment type");void 0!==t.layer?e.framebufferTextureLayer(i,l,c,t.level||0,t.layer):e.framebufferTexture2D(i,l,t.target||3553,c,t.level||0)}s.attachments.push(c)})),e.drawBuffers&&e.drawBuffers(a),s}function Jr(e,t){return()=>t instanceof WebGLTexture?t:ir(e,{src:t,wrap:e.CLAMP_TO_EDGE})}Hr[32854]=!0,Hr[32855]=!0,Hr[36194]=!0,Hr[34041]=!0,Hr[33189]=!0,Hr[6401]=!0,Hr[36168]=!0;class zr{constructor(e){o(this,"id","_"),o(this,"context"),o(this,"output"),o(this,"fbi"),o(this,"options"),o(this,"programInfo"),o(this,"bufferInfo"),o(this,"profiler"),o(this,"lastRun");const{context:t,width:n,height:r}=e;this.context=t,this.options=e;const i=this.buildDefines();this.programInfo=Gr(this.context,[i+this.getVertexShader(),i+this.getFragmentShader()]),this.bufferInfo=cn(this.context,this.getBuffers()),this.fbi=Yr(this.context,[{format:this.context.RGBA,type:this.context.UNSIGNED_BYTE,min:this.context.LINEAR,wrap:this.context.CLAMP_TO_EDGE}],n,r),this.output=this.fbi.attachments[0]}resizeOutput(e,t){this.fbi=Yr(this.context,[{format:this.context.RGBA,type:this.context.UNSIGNED_BYTE,min:this.context.LINEAR,wrap:this.context.CLAMP_TO_EDGE}],e,t),this.options.width=e,this.options.height=t,this.output=this.fbi.attachments[0]}getDefines(){return{}}getBuffers(){return{position:{numComponents:2,data:[-1,-1,-1,1,1,-1,1,1,-1,1,1,-1]},texture_coord:{numComponents:2,data:[0,0,0,1,1,0,1,1,0,1,1,0]}}}buildDefines(){let e="";const t=this.getDefines();for(let n in t)e+=`#define ${n} ${t[n].toFixed(1)}\n`;return e}run(e){var t,n,r,i,o,a;null==(t=this.profiler)||t.pushContext(`[${this.id}] PROG : ${this.constructor.name}`),null==(n=this.profiler)||n.pushContext(`[${this.id}] UNIFORMS`);for(const t in e)"function"==typeof e[t]&&(null==(r=this.profiler)||r.pushContext(`[${this.id}] UNI : ${t}`),e[t]=e[t](),null==(i=this.profiler)||i.popContext(`[${this.id}] UNI : ${t}`));null==(o=this.profiler)||o.popContext(`[${this.id}] UNIFORMS`);const s=Date.now();let c=0;this.lastRun&&(c=(s-this.lastRun)/1e3),this.lastRun=s,this.context.viewport(0,0,this.context.canvas.width,this.context.canvas.height),this.context.useProgram(this.programInfo.program),function(e,t,n){n.vertexArrayObject?e.bindVertexArray(n.vertexArrayObject):(function(e,t){for(const n in t){const r=e[n];r&&r(t[n])}}(t.attribSetters||t,n.attribs),n.indices&&e.bindBuffer(34963,n.indices))}(this.context,this.programInfo,this.bufferInfo),function e(t,...n){const r=t.uniformSetters||t,i=n.length;for(let t=0;t<i;++t){const i=n[t];if(Array.isArray(i)){const t=i.length;for(let n=0;n<t;++n)e(r,i[n])}else for(const e in i){const t=r[e];t&&t(i[e])}}}(this.programInfo,{delta:c,canvas:[this.context.canvas.width,this.context.canvas.height],...e}),function(e,t,n){n=n||36160,t?(e.bindFramebuffer(n,t.framebuffer),e.viewport(0,0,t.width,t.height)):(e.bindFramebuffer(n,null),e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight))}(this.context,this.options.disableFramebuffer?null:this.fbi),function(e,t,n,r,i,o){n=void 0===n?4:n;const a=t.indices,s=t.elementType,c=void 0===r?t.numElements:r;i=void 0===i?0:i,s||a?void 0!==o?e.drawElementsInstanced(n,c,void 0===s?5123:t.elementType,i,o):e.drawElements(n,c,void 0===s?5123:t.elementType,i):void 0!==o?e.drawArraysInstanced(n,i,c,o):e.drawArrays(n,i,c)}(this.context,this.bufferInfo),null==(a=this.profiler)||a.popContext(`[${this.id}] PROG : ${this.constructor.name}`)}setProfiler(e){this.profiler=e}}class Kr extends zr{getFragmentShader(){return"precision mediump float;\n\nvarying vec2 _texture_coord;\n\nuniform sampler2D background;\nuniform sampler2D foreground;\nuniform sampler2D threshold;\n\nvoid main() {\n  vec4 backgroundColor = texture2D(background, _texture_coord);\n  vec4 foregroundColor = texture2D(foreground, _texture_coord);\n  vec4 tresholdColor = texture2D(threshold, _texture_coord);\n  gl_FragColor = foregroundColor * tresholdColor.a +\n                 backgroundColor * (1. - tresholdColor.a);\n}\n"}getVertexShader(){return"varying vec2 _texture_coord;\n\nattribute vec2 position;\nattribute vec2 texture_coord;\n\nvoid main() {\n  gl_Position = vec4(position, 0., 1.);\n  _texture_coord = texture_coord;\n  _texture_coord.y = 1. - texture_coord.y;\n}\n"}}class Qr{constructor(){o(this,"steps",[]),o(this,"profiler")}addStep(e){this.steps.push(e)}async run(){for(const e of this.steps)e.program.run(e.getUniforms())}resizeOutput(e,t){var n,r;null==(n=this.profiler)||n.pushContext(`PIP [${this.constructor.name}]`);for(const n of this.steps)n.preventResize||n.program.resizeOutput(e,t);null==(r=this.profiler)||r.popContext(`PIP [${this.constructor.name}]`)}setProfiler(e){this.profiler=e;for(const t of this.steps)t.program.setProfiler(e)}setId(e){for(const t of this.steps)t.program.id=e}}class qr extends Qr{constructor(){super(...arguments),o(this,"preciseMaskEnabled",!1)}}class $r extends qr{constructor(e){super(),o(this,"inputImage"),o(this,"inputBackgroundImage"),o(this,"inputMask"),o(this,"preciseMaskEnabled",!0),this.context=e;const t={context:e,height:e.canvas.height,width:e.canvas.width},n=new Kr({...t,disableFramebuffer:!0});this.addStep({program:n,getUniforms:()=>({background:Jr(e,this.inputBackgroundImage),foreground:Jr(e,this.inputImage),threshold:Jr(e,this.inputMask)})})}setData(e,t){this.inputImage=e,this.inputMask=t}}class ei extends zr{getFragmentShader(){return"precision mediump float;\n\nvarying vec2 _texture_coord;\nuniform sampler2D texture;\n\nvoid main() { gl_FragColor = texture2D(texture, _texture_coord); }\n"}getVertexShader(){return"varying vec2 _texture_coord;\n\nattribute vec2 position;\nattribute vec2 texture_coord;\nuniform bool invert_y;\n\nvoid main() {\n  gl_Position = vec4(position, 0., 1.);\n  _texture_coord = texture_coord;\n  if (invert_y) {\n    _texture_coord.y = 1. - texture_coord.y;\n  }\n}\n"}}class ti extends Qr{constructor(e,t,n){super(),o(this,"inputImage"),this.context=e;const r={context:e,height:n,width:t};this.addStep({program:new ei({...r,disableFramebuffer:!0}),getUniforms:()=>({texture:Jr(e,this.inputImage),invert_y:!0})})}setData(e){this.inputImage=e}}async function ni(t){return new e(e=>{setTimeout(()=>{e()},t)})}var ri=(e=>(e[e.LINEAR=0]="LINEAR",e[e.GAUSSIAN=1]="GAUSSIAN",e))(ri||{});class ii extends zr{getDefines(){var e;return{RADIUS:null!=(e=this.options.radius)?e:1}}getFragmentShader(){return"precision mediump float;\n\nvarying vec2 _texture_coord;\n\nuniform vec2 canvas;\nuniform sampler2D texture;\n\nvec4 loop();\n\nvoid main() { gl_FragColor = loop(); }\n"+this.createLoopFunction()}getVertexShader(){return"varying vec2 _texture_coord;\n\nattribute vec2 position;\nattribute vec2 texture_coord;\n\nvoid main() {\n  gl_Position = vec4(position, 0., 1.);\n  _texture_coord = texture_coord;\n}\n"}createLoopFunction(){var e;let t=null!=(e=this.options.radius)?e:1;return`\n\n        vec4 loop() { \n            vec4 result = vec4(0,0,0,0);\n            float factorSum = 0.;\n\n            vec2 normalizedRadius = vec2(-${t}.) / canvas;\n            vec2 normalizedIncrement = vec2(1.) / canvas;\n            vec2 diff = normalizedRadius;\n\n            for(int y=-${t}; y<${t+1}; ++y) {\n                for(int x=-${t}; x<${t+1}; ++x) {\n                    float factor = 1.;\n                    result += factor * texture2D(texture, _texture_coord + diff);\n                    factorSum += factor;\n                    diff.x += normalizedIncrement.x;\n                }\n                diff.y += normalizedIncrement.y;\n                diff.x = normalizedRadius.x;\n            }\n            return result / factorSum;\n        }`}getFactor(e,t){switch(this.options.type){case 1:return this.getLinearFactor(e,t);case 0:default:return this.getLinearFactor(e,t)}}getLinearFactor(e,t){return 1}getGaussianFactor(e,t){var n;const r=1/(2*Math.PI*Math.max(null!=(n=this.options.radius)?n:1,1)**2),i=r*-(e**2+t**2);return r*Math.E**i}}class oi extends zr{constructor(e){super(e),o(this,"fbi2"),this.fbi2=Yr(e.context,[{format:e.context.RGBA,type:e.context.UNSIGNED_BYTE,min:e.context.LINEAR,mag:e.context.LINEAR,wrap:e.context.CLAMP_TO_EDGE}],e.width,e.height)}run(e){const t=this.fbi;this.fbi=this.fbi2,this.fbi2=t,this.output=this.fbi.attachments[0],super.run({...e,previous_rendering:this.fbi2.attachments[0]})}resizeOutput(e,t){super.resizeOutput(e,t),this.fbi2=Yr(this.context,[{format:this.context.RGBA,type:this.context.UNSIGNED_BYTE,min:this.context.LINEAR,wrap:this.context.CLAMP_TO_EDGE}],e,t)}}class ai extends oi{getFragmentShader(){return"precision mediump float;\n\nvarying vec2 _texture_coord;\n\n// uniform float treshold;\nuniform sampler2D image_now;\nuniform sampler2D image_before;\nuniform sampler2D mask_now;\nuniform sampler2D mask_before;\nuniform sampler2D previous_rendering;\nuniform vec2 canvas;\n\nuniform float delta;\n\nfloat current_factor = 0.69;\nfloat previous_factor = 0.74;\nfloat threshold_activation = 0.54;\n\nfloat map(float value, float min1, float max1, float min2, float max2) {\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\n\nfloat getThreshold() {\n  vec4 color = vec4(0.);\n  for (float y = -6.; y < 7.; y += 1.) {\n    for (float x = -6.; x < 7.; x += 1.) {\n      vec4 image_now_color =\n          texture2D(image_now, _texture_coord + vec2(x, y) / canvas);\n      vec4 image_before_color =\n          texture2D(image_before, _texture_coord + vec2(x, y) / canvas);\n      color += abs(image_before_color - image_now_color);\n    }\n  }\n  return (color.x + color.y + color.z) / (3. * 9.);\n}\n\nvoid main() {\n  float treshold_input = .4;\n  float treshold_previous_rendering = .98;\n\n  vec4 mask_now_color = texture2D(mask_now, _texture_coord);\n  vec4 mask_before_color = texture2D(mask_before, _texture_coord);\n  vec4 previous_rendering_color = texture2D(previous_rendering, _texture_coord);\n\n  vec3 mask_diff = abs(mask_before_color.xyz - mask_now_color.xyz);\n  float flickering = mask_diff.x;\n  float threshold = getThreshold();\n  if (threshold < threshold_activation) {\n    gl_FragColor = vec4(flickering, 0., 0., 1.) * current_factor +\n                   previous_rendering_color * previous_factor;\n    gl_FragColor *= (1. - threshold);\n  }\n}\n"}getVertexShader(){return"varying vec2 _texture_coord;\n\nattribute vec2 position;\nattribute vec2 texture_coord;\n\nvoid main() {\n  gl_Position = vec4(position, 0., 1.);\n  _texture_coord = texture_coord;\n}\n"}}class si extends zr{getFragmentShader(){return"#version 300 es\n// https://github.com/Volcomix/virtual-background/blob/main/src/pipelines/webgl2/jointBilateralFilterStage.ts\n\nprecision highp float;\nuniform sampler2D input_frame;\nuniform sampler2D segmentation_mask;\nuniform sampler2D threshold;\nuniform vec2 texel_size;\nuniform float step;\nuniform float radius;\nuniform float offset;\nuniform float sigma_texel;\nuniform float sigma_color;\n\nin vec2 _texture_coord;\nout vec4 outColor;\n\nfloat gaussian(float x, float sigma) {\n  float coeff = -0.5 / (sigma * sigma * 4.0 + 1.0e-6);\n  return exp((x * x) * coeff);\n}\n\nvoid main() {\n  vec2 centerCoord = _texture_coord;\n  vec3 centerColor = texture(input_frame, centerCoord).rgb;\n  float newVal = 0.0;\n  float spaceWeight = 0.0;\n  float colorWeight = 0.0;\n  float totalWeight = 0.0;\n  // Subsample kernel space.\n  for (float i = -radius + offset; i <= radius; i += step) {\n    for (float j = -radius + offset; j <= radius; j += step) {\n      vec2 shift = vec2(j, i) * texel_size;\n      vec2 coord = vec2(centerCoord + shift);\n      vec3 frameColor = texture(input_frame, coord).rgb;\n      float threshold = texture(threshold, coord).a;\n      float outVal = texture(segmentation_mask, coord).a;\n\n      spaceWeight = gaussian(distance(centerCoord, coord), sigma_texel);\n      colorWeight = gaussian(distance(centerColor, frameColor), sigma_color);\n      totalWeight += spaceWeight * colorWeight;\n      newVal += spaceWeight * colorWeight * outVal * threshold;\n    }\n  }\n  newVal /= totalWeight;\n  outColor = vec4(vec3(0.), newVal);\n}"}getVertexShader(){return"#version 300 es\nin vec2 position;\nin vec2 texture_coord;\nout vec2 _texture_coord;\nvoid main() {\n  gl_Position = vec4(position, 0.0, 1.0);\n  _texture_coord = texture_coord;\n}"}}class ci extends zr{getFragmentShader(){return"precision mediump float;\n\nvarying vec2 _texture_coord;\n\nuniform vec2 canvas;\nuniform sampler2D texture;\n\nvoid main() {\n  int count = 0;\n  for (float y = -1.; y < 2.; y += 1.) {\n    for (float x = -1.; x < 2.; x += 1.) {\n      vec2 coord = _texture_coord + vec2(y, x) / canvas;\n      vec4 color = texture2D(texture, coord);\n      if (color.r > .1) {\n        count++;\n      }\n    }\n  }\n  if (count > 5) {\n    gl_FragColor = texture2D(texture, _texture_coord);\n  }\n}\n"}getVertexShader(){return"varying vec2 _texture_coord;\n\nattribute vec2 position;\nattribute vec2 texture_coord;\n\nvoid main() {\n  gl_Position = vec4(position, 0., 1.);\n  _texture_coord = texture_coord;\n}\n"}}class ui extends oi{getFragmentShader(){return"precision mediump float;\n\nvarying vec2 _texture_coord;\n\nuniform vec2 canvas;\nuniform sampler2D texture;\n\nvoid main() {\n  vec4 color = texture2D(texture, _texture_coord);\n  for (float y = -2.; y < 3.; y += 1.) {\n    for (float x = -2.; x < 3.; x += 1.) {\n      vec2 coord = _texture_coord;\n      coord += vec2(y, x) / canvas;\n      color += texture2D(texture, coord) * (1. / 4.);\n    }\n  }\n\n  gl_FragColor = color;\n}\n"}getVertexShader(){return"varying vec2 _texture_coord;\n\nattribute vec2 position;\nattribute vec2 texture_coord;\n\nvoid main() {\n  gl_Position = vec4(position, 0., 1.);\n  _texture_coord = texture_coord;\n}\n"}}class di extends oi{getFragmentShader(){return"precision mediump float;\n\nvarying vec2 _texture_coord;\n\nuniform sampler2D threshold;\nuniform sampler2D inputs;\n\nvoid main() {\n  vec4 inputs_color = texture2D(inputs, _texture_coord);\n  vec4 threshold_color = texture2D(threshold, _texture_coord);\n  if (threshold_color.r < .1 && inputs_color.r > .5) {\n    gl_FragColor = inputs_color;\n  }\n}\n"}getVertexShader(){return"varying vec2 _texture_coord;\n\nattribute vec2 position;\nattribute vec2 texture_coord;\n\nvoid main() {\n  gl_Position = vec4(position, 0., 1.);\n  _texture_coord = texture_coord;\n}\n"}}class li extends Qr{constructor(e,t,n){super(),o(this,"inputImage"),o(this,"inputMask"),o(this,"previousInputImage"),o(this,"previousInputMask"),o(this,"output"),o(this,"options",{currentThresholdMinimum:0,currentThresholdMaximum:1,previousThresholdMinimum:0,previousThresholdMaximum:1,thresholdMinimum:0,thresholdMaximum:1,thresholdFactor:1}),o(this,"jointBilateral"),this.context=e;const r={context:e,height:n,width:t},i=new ai(r),a=new ii({...r,radius:1,type:ri.GAUSSIAN}),s=new di(r),c=new ui(r),u=new ci(r);this.jointBilateral=new si(r),this.addStep({program:i,getUniforms:()=>({image_now:Jr(e,this.inputImage),image_before:Jr(e,this.previousInputImage),mask_now:Jr(e,this.inputMask),mask_before:Jr(e,this.previousInputMask),current_threshold_minimum:this.options.currentThresholdMinimum,current_threshold_maximum:this.options.currentThresholdMaximum,previous_threshold_minimum:this.options.previousThresholdMinimum,previous_threshold_maximum:this.options.previousThresholdMaximum,threshold_minimum:this.options.thresholdMinimum,threshold_maximum:this.options.thresholdMaximum,threshold_factor:this.options.thresholdFactor})}),this.addStep({program:s,getUniforms:()=>({inputs:Jr(e,this.inputMask),threshold:Jr(e,i.output)})}),this.addStep({program:u,getUniforms:()=>({texture:Jr(e,s.output)})}),this.addStep({program:c,getUniforms:()=>({texture:Jr(e,u.output)})}),this.addStep({program:a,getUniforms:()=>({texture:Jr(e,c.output)})}),this.addStep({program:this.jointBilateral,getUniforms:()=>{var t,n,r,i,o,s,c,u;const d=null!=(n=null==(t=this.inputImage)?void 0:t.width)?n:1,l=null!=(i=null==(r=this.inputImage)?void 0:r.height)?i:1,f=null!=(s=null==(o=this.inputMask)?void 0:o.width)?s:1,p=null!=(u=null==(c=this.inputMask)?void 0:c.height)?u:1,h=Math.max(d/f,l/p),m=Math.max(1,.66*Math.sqrt(h)),g=1/d,v=1/l;return{input_frame:Jr(e,this.inputImage),segmentation_mask:Jr(e,this.inputMask),threshold:Jr(e,a.output),texel_size:[g,v],step:m,radius:h,offset:m>1?.5*m:0,sigma_texel:Math.max(g,v)*h,sigma_color:.1}}}),this.output=this.jointBilateral.output}setData(e,t){this.previousInputImage=this.inputImage?this.inputImage:e,this.previousInputMask=this.inputMask?this.inputMask:t,this.inputImage=e,this.inputMask=t}setOptions(e){this.options=e}resizeOutput(e,t){super.resizeOutput(e,t),this.output=this.jointBilateral.output}}var fi=(e=>(e.PUSH="PUSH",e.POP="POP",e))(fi||{});class pi{constructor(e){o(this,"context"),o(this,"extension"),o(this,"queries",[]),o(this,"activeQuery"),this.context=e,this.extension=e.getExtension("EXT_disjoint_timer_query_webgl2")}start(){}stop(){this.activeQuery&&this.context.endQuery(this.extension.TIME_ELAPSED_EXT)}pushContext(e){this.createQuery("PUSH",e)}popContext(e){this.createQuery("POP",e)}createQuery(e,t){this.activeQuery&&this.context.endQuery(this.extension.TIME_ELAPSED_EXT),this.activeQuery=this.context.createQuery(),this.context.beginQuery(this.extension.TIME_ELAPSED_EXT,this.activeQuery),this.queries.push({name:t,action:e,query:this.activeQuery})}async getResolvedQueries(){const t=(await e.all([...this.queries].map(e=>this.resolveQuery(e)))).filter(e=>e);for(let e=1;e<t.length;++e)t[e].timestamp+=t[e-1].duration+t[e-1].timestamp;return t}async resolveQuery(e){if(await this.awaitQueryAvailable(e)){if(!this.context.getParameter(this.extension.GPU_DISJOINT_EXT))return{...e,duration:this.context.getQueryParameter(e.query,this.context.QUERY_RESULT),timestamp:0};console.log("Disjointed query",e)}else console.log("Unawaitable query",e)}async awaitQueryAvailable(e){for(let t=0;t<10;++t){if(this.context.getQueryParameter(e.query,this.context.QUERY_RESULT_AVAILABLE))return e;await ni(200)}}}class hi{constructor(){o(this,"canvas"),o(this,"context"),o(this,"pipeline"),o(this,"previousImageWidth",0),o(this,"previousImageHeight",0),o(this,"previousMaskWidth",2),o(this,"previousMaskHeight",2),o(this,"profiler"),o(this,"postProcessingEnabled",!0),o(this,"improveMask");const e=new OffscreenCanvas(0,0),t=e.getContext("webgl2");if(!t)throw"Fail to retrieve webgl2 context";this.canvas=e,this.context=t,this.improveMask=new li(this.context,2,2)}setFlickeringOptions(e){this.improveMask.setOptions(e)}enablePostProcessing(){this.postProcessingEnabled=!0}disablePostProcessing(){this.postProcessingEnabled=!1}async profileWebgl(e){const t=new pi(this.context);return this.profiler=t,t.start(),await ni(e),this.profiler=void 0,t.stop(),t.getResolvedQueries()}async render(e,t){var n,r;if(!this.pipeline)throw"missing pipeline";(this.previousImageHeight!==e.height||this.previousImageWidth!==e.width)&&this.resizeOutput(e.width,e.height),(this.previousMaskHeight!==t.height||this.previousMaskWidth!==t.width)&&(this.improveMask.resizeOutput(t.width,t.height),this.previousMaskWidth=t.width,this.previousMaskHeight=t.height);const i="renderer";null==(n=this.profiler)||n.pushContext(i),this.improveMask.setProfiler(this.profiler),this.pipeline.setProfiler(this.profiler);let o=t;return this.postProcessingEnabled&&(this.improveMask.setData(e,t),this.improveMask.run(),o=this.improveMask.output),this.pipeline.setData(e,o),await this.pipeline.run(),null==(r=this.profiler)||r.popContext(i),this.canvas}resizeOutput(e,t){var n;this.canvas.width=e,this.canvas.height=t,null==(n=this.pipeline)||n.resizeOutput(e,t),this.previousImageWidth=e,this.previousImageHeight=t}}class mi extends hi{constructor(){super(),o(this,"pipeline"),o(this,"backgroundImage"),o(this,"backgroundImageResizerCanvas"),o(this,"backgroundImageResizerContext"),o(this,"backgroundImageResizer"),this.pipeline=new $r(this.context);const e=new OffscreenCanvas(0,0),t=e.getContext("webgl2");if(!t)throw"Fail to retrieve webgl context";this.backgroundImageResizerCanvas=e,this.backgroundImageResizerContext=t,this.backgroundImageResizer=new ti(this.backgroundImageResizerContext,0,0)}setBackgroundImage(e){this.backgroundImage=e,this.updateBackgroundImage()}updateBackgroundImage(){const{width:e,height:t}=this.canvas;this.backgroundImageResizer.resizeOutput(e,t),this.backgroundImageResizer.setData(this.backgroundImage),this.backgroundImageResizer.run(),this.pipeline.inputBackgroundImage=this.backgroundImageResizerCanvas}resizeOutput(e,t){super.resizeOutput(e,t),this.backgroundImageResizerCanvas.width=e,this.backgroundImageResizerCanvas.height=t,this.backgroundImageResizer.resizeOutput(e,t),this.updateBackgroundImage()}}class gi extends mi{constructor(){super(...arguments),o(this,"frameReader")}setBackgroundVideo(e){this.frameReader=e.getReader(),this.readNextVideoFrame()}async render(e,t){return await this.readNextVideoFrame(),super.render(e,t)}async readNextVideoFrame(){var e;const t=await(null==(e=this.frameReader)?void 0:e.read());if(null!=t&&t.value){const e=await createImageBitmap(t.value);this.setBackgroundImage(e),t.value.close()}}}class vi{blurBackground(e){return new Mt(e)}blurSilhouette(e){return new Vt(e)}imageBackground(){return new Pt}videoBackground(){return new gi}}class yi extends zr{getDefines(){var e;return{RADIUS:null!=(e=this.options.radius)?e:1}}getFragmentShader(){return"precision mediump float;\n\nvarying vec2 _texture_coord;\n\nuniform vec2 canvas;\nuniform sampler2D texture;\nuniform sampler2D mask;\n\nvec4 loop();\n\nvoid main() { gl_FragColor = loop(); }\n"+this.createLoopFunction()}getVertexShader(){return"varying vec2 _texture_coord;\n\nattribute vec2 position;\nattribute vec2 texture_coord;\n\nvoid main() {\n  gl_Position = vec4(position, 0., 1.);\n  _texture_coord = texture_coord;\n}\n"}createLoopFunction(){var e;let t=null!=(e=this.options.radius)?e:1;return`\n\n        vec4 loop() { \n            vec4 result = vec4(0,0,0,0);\n            float factorSum = 0.;\n\n            vec2 normalizedRadius = vec2(-${t}.) / canvas;\n            vec2 normalizedIncrement = vec2(1.) / canvas;\n            vec2 diff = normalizedRadius;\n            float maxLength = length(normalizedRadius);\n\n            for(int y=-${t}; y<${t+1}; ++y) {\n                for(int x=-${t}; x<${t+1}; ++x) {\n                    float factor = (1.- texture2D(mask, _texture_coord + diff).a) * (maxLength - length(diff)) / maxLength;\n                    result += factor * texture2D(texture, _texture_coord + diff);\n                    factorSum += factor;\n                    diff.x += normalizedIncrement.x;\n                }\n                diff.y += normalizedIncrement.y;\n                diff.x = normalizedRadius.x;\n            }\n            return result / factorSum;\n        }`}}class bi extends qr{constructor(e,t){super(),o(this,"inputImage"),o(this,"inputMask"),o(this,"blur"),this.context=e,this.radius=t;const n={context:e,height:e.canvas.height,width:e.canvas.width};this.blur=new yi({...n,radius:t,...this.getBlurTextureSize(e.canvas.width,e.canvas.height)});const r=new Kr({...n,disableFramebuffer:!0});this.addStep({program:this.blur,preventResize:!0,getUniforms:()=>({texture:Jr(e,this.inputImage),mask:Jr(e,this.inputMask)})}),this.addStep({program:r,getUniforms:()=>({background:Jr(e,this.blur.output),foreground:Jr(e,this.inputImage),threshold:Jr(e,this.inputMask)})})}getBlurTextureSize(e,t){const n=this.radius>10?8:2;return{width:Math.max(2,e/n),height:Math.max(2,t/n)}}setData(e,t){this.inputImage=e,this.inputMask=t}resizeOutput(e,t){super.resizeOutput(e,t);const n=this.getBlurTextureSize(e,t);this.blur.resizeOutput(n.width,n.height)}}class Si extends hi{constructor(e){super(),o(this,"pipeline"),this.pipeline=new bi(this.context,e),this.disablePostProcessing()}}class Ei extends qr{constructor(e,t){super(),o(this,"inputImage"),o(this,"inputMask"),this.context=e;const n={context:e,height:e.canvas.height,width:e.canvas.width},r=new ii({...n,radius:t,type:ri.GAUSSIAN}),i=new Kr({...n,disableFramebuffer:!0});this.addStep({program:r,getUniforms:()=>({texture:Jr(e,this.inputImage)})}),this.addStep({program:i,getUniforms:()=>({background:Jr(e,this.inputImage),foreground:Jr(e,r.output),threshold:Jr(e,this.inputMask)})})}setData(e,t){this.inputImage=e,this.inputMask=t}}class _i extends hi{constructor(e){super(),o(this,"pipeline"),this.pipeline=new Ei(this.context,e),this.disablePostProcessing()}}class Ti extends $r{constructor(){super(...arguments),o(this,"frameReader"),o(this,"preciseMaskEnabled",!0)}set inputVideo(e){this.frameReader=e.getReader(),this.readNextVideoFrame()}async run(){this.frameReader&&(await super.run(),this.readNextVideoFrame())}async readNextVideoFrame(){var e;const t=await(null==(e=this.frameReader)?void 0:e.read());null!=t&&t.value&&(this.inputBackgroundImage=await createImageBitmap(t.value),t.value.close())}}class Ri extends hi{constructor(){super(),o(this,"pipeline"),this.pipeline=new Ti(this.context)}setBackgroundVideo(e){this.pipeline.inputVideo=e}}class Ii{blurBackground(e){return new Si(e)}blurSilhouette(e){return new _i(e)}imageBackground(){return new mi}videoBackground(){return new Ri}}class wi{constructor(e){switch(o(this,"factory"),e){case fe.CANVAS:this.factory=new vi;break;case fe.WEBGL:this.factory=new Ii;break;default:const e=Se();this.factory=e.supported?new Ii:new vi}}blurBackground(e){return this.getFactory().blurBackground(e)}blurSilhouette(e){return this.getFactory().blurSilhouette(e)}imageBackground(){return this.getFactory().imageBackground()}videoBackground(){return this.getFactory().videoBackground()}getFactory(){if(!this.factory)throw"Factory is not initialized";return this.factory}}class Ci{constructor(){o(this,"renderer")}setBackgroundOptions(e){var t,n;const r=new wi(null==(t=e.renderingOptions)?void 0:t.type);switch(e.transformerType){case"BackgroundBlur":this.renderer=r.blurBackground(this.getBlurSize(e.radius));break;case"SilhouetteBlur":this.renderer=r.blurSilhouette(this.getBlurSize(e.radius));break;case"VideoBackground":this.renderer=r.videoBackground();break;case"VirtualBackground":this.renderer=r.imageBackground();break;default:throw`Unknown rendering type [${e.transformerType}]`}(null==(n=e.renderingOptions)?void 0:n.type)===fe.WEBGL&&(e.renderingOptions.selfieSegmentationType===le.PRECISE?this.renderer.enablePostProcessing():e.renderingOptions.selfieSegmentationType===le.FAST&&this.renderer.disablePostProcessing())}setFlickeringOptions(e){var t;null==(t=this.renderer)||t.setFlickeringOptions(e)}setVideoBGReadable(e){const t=this.renderer;t.setBackgroundVideo&&t.setBackgroundVideo(e)}async setVirtualBGImage(e){const t=this.renderer;t.setBackgroundImage&&t.setBackgroundImage(e)}async process(e,t){if(this.renderer)return this.renderer.render(e,t)}async resizeForeground(e,t){}getBlurSize(e=ue.Low){switch(e){case ue.Low:return 5;case ue.High:return 12}return e}async profile(e){var t,n;return null!=(n=null==(t=this.renderer)?void 0:t.profileWebgl(e))?n:[]}}class Oi{constructor(){o(this,"selfieSegmentation",new ve),o(this,"backgroundFilter"),o(this,"reporter",new Nt),o(this,"backgroundOptions")}async init(e,t){await this.selfieSegmentation.init(t.wasmAssetUriPath,t.tfliteAssetUriPath),this.backgroundFilter=new Ci,this.report({variation:"Create"})}async transform(e,t){var n,r;let i;const o=null!=(n=e.timestamp)?n:0,a=await createImageBitmap(e),s=await this.selfieSegmentation.process(a);s&&(i=await(null==(r=this.backgroundFilter)?void 0:r.process(a,s))),i?(e.close(),t.enqueue(new VideoFrame(i,{timestamp:o,alpha:"discard"}))):t.enqueue(e)}async setBackgroundOptions(e){var t;this.backgroundOptions=e,await(null==(t=this.backgroundFilter)?void 0:t.setBackgroundOptions(e)),this.report({variation:"Update"})}async setVideoBGReadable(e){var t;await(null==(t=this.backgroundFilter)?void 0:t.setVideoBGReadable(e))}async setVirtualBGImage(e){var t;await(null==(t=this.backgroundFilter)?void 0:t.setVirtualBGImage(e))}setFlickeringOptions(e){var t;null==(t=this.backgroundFilter)||t.setFlickeringOptions(e),this.report({variation:"Update"})}async profile(e){var t,n;return null!=(n=null==(t=this.backgroundFilter)?void 0:t.profile(e))?n:[]}getTransformerType(){var e,t;return null!=(t=null==(e=this.backgroundOptions)?void 0:e.transformerType)?t:"Undefined"}report(e){var t;this.reporter.send({version:"5.0.1",action:"MlTransformers",transformerType:null==(t=this.backgroundOptions)?void 0:t.transformerType,config:JSON.stringify(this.backgroundOptions),...e})}}const Ai=class{constructor(){o(this,"backgroundTransformer",new Oi),o(this,"mediaProcessor",new ae),o(this,"rate",30),o(this,"resolveOnMediaProcessor"),o(this,"eventsQueue",[])}async init(e,t){await this.backgroundTransformer.init(e,t),await this.mediaProcessor.setTransformers([this.backgroundTransformer]),this.mediaProcessor.setTrackExpectedRate(this.rate),this.mediaProcessor.onAny((e,t)=>{this.resolveOnMediaProcessor?(this.resolveOnMediaProcessor({name:e,data:t}),this.resolveOnMediaProcessor=void 0):this.eventsQueue.push({name:e,data:t})})}async onMediaProcessorEvent(){return await new e(e=>{this.eventsQueue.length>0?e(this.eventsQueue.shift()):this.resolveOnMediaProcessor=e})}async setTrackExpectedRate(e){this.rate=e,this.mediaProcessor.setTrackExpectedRate(e)}async transform(e,t){this.mediaProcessor.transform(e,t)}async setBackgroundOptions(e){var t;await(null==(t=this.backgroundTransformer)?void 0:t.setBackgroundOptions(e))}setVideoBGReadable(e){this.backgroundTransformer.setVideoBGReadable(e)}async setVirtualBGImage(e){await this.backgroundTransformer.setVirtualBGImage(e)}async terminate(){await this.mediaProcessor.destroy()}setFlickeringOptions(e){this.backgroundTransformer.setFlickeringOptions(e)}setVonageMetadata(e){!function(e){z(e)}(e)}async profile(e){return JSON.stringify(await this.backgroundTransformer.profile(e))}};let xi=Ai;!function(e,t){t.workerId=e,nt()&&(st[t.workerId]=t)}("ProcessorWorker",Ai);const ki="dmFyIF9sPU9iamVjdC5kZWZpbmVQcm9wZXJ0eTt2YXIgYmw9KEosUSxIKT0+USBpbiBKP19sKEosUSx7ZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITAsdmFsdWU6SH0pOkpbUV09SDt2YXIgbD0oSixRLEgpPT4oYmwoSix0eXBlb2YgUSE9InN5bWJvbCI/USsiIjpRLEgpLEgpOyhmdW5jdGlvbigpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBKKHIsdCl7Z2xvYmFsVGhpcy52b25hZ2V8fChnbG9iYWxUaGlzLnZvbmFnZT17fSksZ2xvYmFsVGhpcy52b25hZ2Uud29ya2VyaXplcnx8KGdsb2JhbFRoaXMudm9uYWdlLndvcmtlcml6ZXI9e30pO2xldCBlPWdsb2JhbFRoaXMudm9uYWdlLndvcmtlcml6ZXI7cmV0dXJuIGVbcl18fChlW3JdPXQpLGVbcl19Y29uc3QgUT1KKCJnbG9iYWxzIix7fSk7dmFyIEg9KHI9PihyLklOSVQ9IklOSVQiLHIuRk9SV0FSRD0iRk9SV0FSRCIsci5URVJNSU5BVEU9IlRFUk1JTkFURSIsci5HTE9CQUxTX1NZTkM9IkdMT0JBTFNfU1lOQyIscikpKEh8fHt9KTtmdW5jdGlvbiBUbyhyKXtyZXR1cm5bSW1hZ2VCaXRtYXAsUmVhZGFibGVTdHJlYW0sV3JpdGFibGVTdHJlYW1dLnNvbWUodD0+ciBpbnN0YW5jZW9mIHQpfWZ1bmN0aW9uIEhlKHIsdCl7Y29uc3R7aWQ6ZSx0eXBlOm59PXIsbz1BcnJheS5pc0FycmF5KHQpP3Q6W3RdO3Bvc3RNZXNzYWdlKHtpZDplLHR5cGU6bixyZXN1bHQ6dH0sby5maWx0ZXIoaT0+VG8oaSkpKX1KKCJ3b3JrZXJpemVkIix7fSk7ZnVuY3Rpb24gRHIoKXtyZXR1cm4gdHlwZW9mIFdvcmtlckdsb2JhbFNjb3BlPCJ1IiYmc2VsZiBpbnN0YW5jZW9mIFdvcmtlckdsb2JhbFNjb3BlfWZ1bmN0aW9uIGplKHIsdCl7aWYoQXJyYXkuaXNBcnJheSh0KSl0LnNwbGljZSgwLHQubGVuZ3RoKTtlbHNlIGlmKHR5cGVvZiB0PT0ib2JqZWN0Iilmb3IoY29uc3QgZSBpbiB0KWRlbGV0ZSB0W2VdO2Zvcihjb25zdCBlIGluIHIpQXJyYXkuaXNBcnJheShyW2VdKT8odFtlXT1bXSxqZShyW2VdLHRbZV0pKTp0eXBlb2YgcltlXT09Im9iamVjdCI/KHRbZV09e30samUocltlXSx0W2VdKSk6dFtlXT1yW2VdfWFzeW5jIGZ1bmN0aW9uIEFvKHIsdCl7Y29uc3R7ZnVuY3Rpb25OYW1lOmUsYXJnczpufT1yO2lmKCF0Lmluc3RhbmNlKXRocm93Imluc3RhbmNlIG5vdCBpbml0aWFsaXplZCI7aWYoIWUpdGhyb3cibWlzc2luZyBmdW5jdGlvbiBuYW1lIHRvIGNhbGwiO2lmKCF0Lmluc3RhbmNlW2VdKXRocm93YHVuZGVmaW5lZCBmdW5jdGlvbiBbJHtlfV0gaW4gY2xhc3MgJHt0Lmluc3RhbmNlLmNvbnN0cnVjdG9yLndvcmtlcklkfWA7SGUocixhd2FpdCB0Lmluc3RhbmNlW2VdKC4uLm4hPW51bGw/bjpbXSkpfWNvbnN0IENyPUooInJlZ2lzdGVyZWRXb3JrZXJzIix7fSk7ZnVuY3Rpb24gd28ocix0KXt0LndvcmtlcklkPXIsRHIoKSYmKENyW3Qud29ya2VySWRdPXQpfWZ1bmN0aW9uIElvKHIsdCl7aWYoIXIuYXJncyl0aHJvdyJNaXNzaW5nIGNsYXNzTmFtZSB3aGlsZSBpbml0aWFsaXppbmcgd29ya2VyIjtjb25zdFtlLG5dPXIuYXJncyxvPUNyW2VdO2lmKG8pdC5pbnN0YW5jZT1uZXcgbyhyLmFyZ3Muc2xpY2UoMSkpO2Vsc2UgdGhyb3dgdW5rbm93biB3b3JrZXIgY2xhc3MgJHtlfWA7amUobixRKSxIZShyLHR5cGVvZiB0Lmluc3RhbmNlIT09dm9pZCAwKX1hc3luYyBmdW5jdGlvbiBTbyhyLHQpe2NvbnN0e2FyZ3M6ZX09cjtpZighdC5pbnN0YW5jZSl0aHJvdyJpbnN0YW5jZSBub3QgaW5pdGlhbGl6ZWQiO2xldCBuO3QuaW5zdGFuY2UudGVybWluYXRlJiYobj1hd2FpdCB0Lmluc3RhbmNlLnRlcm1pbmF0ZSguLi5lIT1udWxsP2U6W10pKSxIZShyLG4pfWZ1bmN0aW9uIFJvKHIpe2lmKCFyLmFyZ3MpdGhyb3ciTWlzc2luZyBnbG9iYWxzIHdoaWxlIHN5bmNpbmciO2plKHIuYXJnc1swXSxRKSxIZShyLHt9KX1mdW5jdGlvbiBGbygpe2NvbnN0IHI9e307b25tZXNzYWdlPWFzeW5jIHQ9Pntjb25zdCBlPXQuZGF0YTtzd2l0Y2goZS50eXBlKXtjYXNlIEguSU5JVDpJbyhlLHIpO2JyZWFrO2Nhc2UgSC5GT1JXQVJEOkFvKGUscik7YnJlYWs7Y2FzZSBILlRFUk1JTkFURTpTbyhlLHIpO2JyZWFrO2Nhc2UgSC5HTE9CQUxTX1NZTkM6Um8oZSk7YnJlYWt9fX1EcigpJiZGbygpO3ZhciBQbz1PYmplY3QuZGVmaW5lUHJvcGVydHksa289KHIsdCxlKT0+dCBpbiByP1BvKHIsdCx7ZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITAsdmFsdWU6ZX0pOnJbdF09ZSxBPShyLHQsZSk9PihrbyhyLHR5cGVvZiB0IT0ic3ltYm9sIj90KyIiOnQsZSksZSk7Y2xhc3MgWnt9QShaLCJ1cGRhdGVzIix7dHJhbnNmb3JtZXJfbmV3OiJOZXcgdHJhbnNmb3JtZXIiLHRyYW5zZm9ybWVyX251bGw6Ik51bGwgdHJhbnNmb3JtZXIifSksQShaLCJlcnJvcnMiLHt0cmFuc2Zvcm1lcl9ub25lOiJObyB0cmFuc2Zvcm1lcnMgcHJvdmlkZWQiLHRyYW5zZm9ybWVyX3N0YXJ0OiJDYW5ub3Qgc3RhcnQgdHJhbnNmb3JtZXIiLHRyYW5zZm9ybWVyX3RyYW5zZm9ybToiQ2Fubm90IHRyYW5zZm9ybSBmcmFtZSIsdHJhbnNmb3JtZXJfZmx1c2g6IkNhbm5vdCBmbHVzaCB0cmFuc2Zvcm1lciIscmVhZGFibGVfbnVsbDoiUmVhZGFibGUgaXMgbnVsbCIsd3JpdGFibGVfbnVsbDoiV3JpdGFibGUgaXMgbnVsbCJ9KTtjb25zdCBlZT1uZXcgV2Vha01hcCxZZT1uZXcgV2Vha01hcCxQZT1uZXcgV2Vha01hcCxrdD1TeW1ib2woImFueVByb2R1Y2VyIiksQnI9UHJvbWlzZS5yZXNvbHZlKCksWGU9U3ltYm9sKCJsaXN0ZW5lckFkZGVkIiksUWU9U3ltYm9sKCJsaXN0ZW5lclJlbW92ZWQiKTtsZXQgRHQ9ITE7ZnVuY3Rpb24gRWUocil7aWYodHlwZW9mIHIhPSJzdHJpbmciJiZ0eXBlb2YgciE9InN5bWJvbCIpdGhyb3cgbmV3IFR5cGVFcnJvcigiZXZlbnROYW1lIG11c3QgYmUgYSBzdHJpbmcgb3IgYSBzeW1ib2wiKX1mdW5jdGlvbiBLZShyKXtpZih0eXBlb2YgciE9ImZ1bmN0aW9uIil0aHJvdyBuZXcgVHlwZUVycm9yKCJsaXN0ZW5lciBtdXN0IGJlIGEgZnVuY3Rpb24iKX1mdW5jdGlvbiBUZShyLHQpe2NvbnN0IGU9WWUuZ2V0KHIpO3JldHVybiBlLmhhcyh0KXx8ZS5zZXQodCxuZXcgU2V0KSxlLmdldCh0KX1mdW5jdGlvbiBrZShyLHQpe2NvbnN0IGU9dHlwZW9mIHQ9PSJzdHJpbmcifHx0eXBlb2YgdD09InN5bWJvbCI/dDprdCxuPVBlLmdldChyKTtyZXR1cm4gbi5oYXMoZSl8fG4uc2V0KGUsbmV3IFNldCksbi5nZXQoZSl9ZnVuY3Rpb24gRG8ocix0LGUpe2NvbnN0IG49UGUuZ2V0KHIpO2lmKG4uaGFzKHQpKWZvcihjb25zdCBvIG9mIG4uZ2V0KHQpKW8uZW5xdWV1ZShlKTtpZihuLmhhcyhrdCkpe2NvbnN0IG89UHJvbWlzZS5hbGwoW3QsZV0pO2Zvcihjb25zdCBpIG9mIG4uZ2V0KGt0KSlpLmVucXVldWUobyl9fWZ1bmN0aW9uIE5yKHIsdCl7dD1BcnJheS5pc0FycmF5KHQpP3Q6W3RdO2xldCBlPSExLG49KCk9Pnt9LG89W107Y29uc3QgaT17ZW5xdWV1ZShzKXtvLnB1c2gocyksbigpfSxmaW5pc2goKXtlPSEwLG4oKX19O2Zvcihjb25zdCBzIG9mIHQpa2UocixzKS5hZGQoaSk7cmV0dXJue2FzeW5jIG5leHQoKXtyZXR1cm4gbz9vLmxlbmd0aD09PTA/ZT8obz12b2lkIDAsdGhpcy5uZXh0KCkpOihhd2FpdCBuZXcgUHJvbWlzZShzPT57bj1zfSksdGhpcy5uZXh0KCkpOntkb25lOiExLHZhbHVlOmF3YWl0IG8uc2hpZnQoKX06e2RvbmU6ITB9fSxhc3luYyByZXR1cm4ocyl7bz12b2lkIDA7Zm9yKGNvbnN0IGEgb2YgdClrZShyLGEpLmRlbGV0ZShpKTtyZXR1cm4gbigpLGFyZ3VtZW50cy5sZW5ndGg+MD97ZG9uZTohMCx2YWx1ZTphd2FpdCBzfTp7ZG9uZTohMH19LFtTeW1ib2wuYXN5bmNJdGVyYXRvcl0oKXtyZXR1cm4gdGhpc319fWZ1bmN0aW9uIE9yKHIpe2lmKHI9PT12b2lkIDApcmV0dXJuIE1yO2lmKCFBcnJheS5pc0FycmF5KHIpKXRocm93IG5ldyBUeXBlRXJyb3IoImBtZXRob2ROYW1lc2AgbXVzdCBiZSBhbiBhcnJheSBvZiBzdHJpbmdzIik7Zm9yKGNvbnN0IHQgb2YgcilpZighTXIuaW5jbHVkZXModCkpdGhyb3cgdHlwZW9mIHQhPSJzdHJpbmciP25ldyBUeXBlRXJyb3IoImBtZXRob2ROYW1lc2AgZWxlbWVudCBtdXN0IGJlIGEgc3RyaW5nIik6bmV3IEVycm9yKGAke3R9IGlzIG5vdCBFbWl0dGVyeSBtZXRob2RgKTtyZXR1cm4gcn1jb25zdCBDdD1yPT5yPT09WGV8fHI9PT1RZTtjbGFzcyBsZXtzdGF0aWMgbWl4aW4odCxlKXtyZXR1cm4gZT1PcihlKSxuPT57aWYodHlwZW9mIG4hPSJmdW5jdGlvbiIpdGhyb3cgbmV3IFR5cGVFcnJvcigiYHRhcmdldGAgbXVzdCBiZSBmdW5jdGlvbiIpO2Zvcihjb25zdCBzIG9mIGUpaWYobi5wcm90b3R5cGVbc10hPT12b2lkIDApdGhyb3cgbmV3IEVycm9yKGBUaGUgcHJvcGVydHkgXGAke3N9XGAgYWxyZWFkeSBleGlzdHMgb24gXGB0YXJnZXRcYGApO2Z1bmN0aW9uIG8oKXtyZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsdCx7ZW51bWVyYWJsZTohMSx2YWx1ZTpuZXcgbGV9KSx0aGlzW3RdfU9iamVjdC5kZWZpbmVQcm9wZXJ0eShuLnByb3RvdHlwZSx0LHtlbnVtZXJhYmxlOiExLGdldDpvfSk7Y29uc3QgaT1zPT5mdW5jdGlvbiguLi5hKXtyZXR1cm4gdGhpc1t0XVtzXSguLi5hKX07Zm9yKGNvbnN0IHMgb2YgZSlPYmplY3QuZGVmaW5lUHJvcGVydHkobi5wcm90b3R5cGUscyx7ZW51bWVyYWJsZTohMSx2YWx1ZTppKHMpfSk7cmV0dXJuIG59fXN0YXRpYyBnZXQgaXNEZWJ1Z0VuYWJsZWQoKXtpZih0eXBlb2YgcHJvY2VzcyE9Im9iamVjdCIpcmV0dXJuIER0O2NvbnN0e2Vudjp0fT1wcm9jZXNzfHx7ZW52Ont9fTtyZXR1cm4gdC5ERUJVRz09PSJlbWl0dGVyeSJ8fHQuREVCVUc9PT0iKiJ8fER0fXN0YXRpYyBzZXQgaXNEZWJ1Z0VuYWJsZWQodCl7RHQ9dH1jb25zdHJ1Y3Rvcih0PXt9KXtlZS5zZXQodGhpcyxuZXcgU2V0KSxZZS5zZXQodGhpcyxuZXcgTWFwKSxQZS5zZXQodGhpcyxuZXcgTWFwKSx0aGlzLmRlYnVnPXQuZGVidWd8fHt9LHRoaXMuZGVidWcuZW5hYmxlZD09PXZvaWQgMCYmKHRoaXMuZGVidWcuZW5hYmxlZD0hMSksdGhpcy5kZWJ1Zy5sb2dnZXJ8fCh0aGlzLmRlYnVnLmxvZ2dlcj0oZSxuLG8saSk9Pnt0cnl7aT1KU09OLnN0cmluZ2lmeShpKX1jYXRjaHtpPWBPYmplY3Qgd2l0aCB0aGUgZm9sbG93aW5nIGtleXMgZmFpbGVkIHRvIHN0cmluZ2lmeTogJHtPYmplY3Qua2V5cyhpKS5qb2luKCIsIil9YH10eXBlb2Ygbz09InN5bWJvbCImJihvPW8udG9TdHJpbmcoKSk7Y29uc3Qgcz1uZXcgRGF0ZSxhPWAke3MuZ2V0SG91cnMoKX06JHtzLmdldE1pbnV0ZXMoKX06JHtzLmdldFNlY29uZHMoKX0uJHtzLmdldE1pbGxpc2Vjb25kcygpfWA7Y29uc29sZS5sb2coYFske2F9XVtlbWl0dGVyeToke2V9XVske259XSBFdmVudCBOYW1lOiAke299CglkYXRhOiAke2l9YCl9KX1sb2dJZkRlYnVnRW5hYmxlZCh0LGUsbil7KGxlLmlzRGVidWdFbmFibGVkfHx0aGlzLmRlYnVnLmVuYWJsZWQpJiZ0aGlzLmRlYnVnLmxvZ2dlcih0LHRoaXMuZGVidWcubmFtZSxlLG4pfW9uKHQsZSl7S2UoZSksdD1BcnJheS5pc0FycmF5KHQpP3Q6W3RdO2Zvcihjb25zdCBuIG9mIHQpRWUobiksVGUodGhpcyxuKS5hZGQoZSksdGhpcy5sb2dJZkRlYnVnRW5hYmxlZCgic3Vic2NyaWJlIixuLHZvaWQgMCksQ3Qobil8fHRoaXMuZW1pdChYZSx7ZXZlbnROYW1lOm4sbGlzdGVuZXI6ZX0pO3JldHVybiB0aGlzLm9mZi5iaW5kKHRoaXMsdCxlKX1vZmYodCxlKXtLZShlKSx0PUFycmF5LmlzQXJyYXkodCk/dDpbdF07Zm9yKGNvbnN0IG4gb2YgdClFZShuKSxUZSh0aGlzLG4pLmRlbGV0ZShlKSx0aGlzLmxvZ0lmRGVidWdFbmFibGVkKCJ1bnN1YnNjcmliZSIsbix2b2lkIDApLEN0KG4pfHx0aGlzLmVtaXQoUWUse2V2ZW50TmFtZTpuLGxpc3RlbmVyOmV9KX1vbmNlKHQpe3JldHVybiBuZXcgUHJvbWlzZShlPT57Y29uc3Qgbj10aGlzLm9uKHQsbz0+e24oKSxlKG8pfSl9KX1ldmVudHModCl7dD1BcnJheS5pc0FycmF5KHQpP3Q6W3RdO2Zvcihjb25zdCBlIG9mIHQpRWUoZSk7cmV0dXJuIE5yKHRoaXMsdCl9YXN5bmMgZW1pdCh0LGUpe0VlKHQpLHRoaXMubG9nSWZEZWJ1Z0VuYWJsZWQoImVtaXQiLHQsZSksRG8odGhpcyx0LGUpO2NvbnN0IG49VGUodGhpcyx0KSxvPWVlLmdldCh0aGlzKSxpPVsuLi5uXSxzPUN0KHQpP1tdOlsuLi5vXTthd2FpdCBCcixhd2FpdCBQcm9taXNlLmFsbChbLi4uaS5tYXAoYXN5bmMgYT0+e2lmKG4uaGFzKGEpKXJldHVybiBhKGUpfSksLi4ucy5tYXAoYXN5bmMgYT0+e2lmKG8uaGFzKGEpKXJldHVybiBhKHQsZSl9KV0pfWFzeW5jIGVtaXRTZXJpYWwodCxlKXtFZSh0KSx0aGlzLmxvZ0lmRGVidWdFbmFibGVkKCJlbWl0U2VyaWFsIix0LGUpO2NvbnN0IG49VGUodGhpcyx0KSxvPWVlLmdldCh0aGlzKSxpPVsuLi5uXSxzPVsuLi5vXTthd2FpdCBCcjtmb3IoY29uc3QgYSBvZiBpKW4uaGFzKGEpJiZhd2FpdCBhKGUpO2Zvcihjb25zdCBhIG9mIHMpby5oYXMoYSkmJmF3YWl0IGEodCxlKX1vbkFueSh0KXtyZXR1cm4gS2UodCksdGhpcy5sb2dJZkRlYnVnRW5hYmxlZCgic3Vic2NyaWJlQW55Iix2b2lkIDAsdm9pZCAwKSxlZS5nZXQodGhpcykuYWRkKHQpLHRoaXMuZW1pdChYZSx7bGlzdGVuZXI6dH0pLHRoaXMub2ZmQW55LmJpbmQodGhpcyx0KX1hbnlFdmVudCgpe3JldHVybiBOcih0aGlzKX1vZmZBbnkodCl7S2UodCksdGhpcy5sb2dJZkRlYnVnRW5hYmxlZCgidW5zdWJzY3JpYmVBbnkiLHZvaWQgMCx2b2lkIDApLHRoaXMuZW1pdChRZSx7bGlzdGVuZXI6dH0pLGVlLmdldCh0aGlzKS5kZWxldGUodCl9Y2xlYXJMaXN0ZW5lcnModCl7dD1BcnJheS5pc0FycmF5KHQpP3Q6W3RdO2Zvcihjb25zdCBlIG9mIHQpaWYodGhpcy5sb2dJZkRlYnVnRW5hYmxlZCgiY2xlYXIiLGUsdm9pZCAwKSx0eXBlb2YgZT09InN0cmluZyJ8fHR5cGVvZiBlPT0ic3ltYm9sIil7VGUodGhpcyxlKS5jbGVhcigpO2NvbnN0IG49a2UodGhpcyxlKTtmb3IoY29uc3QgbyBvZiBuKW8uZmluaXNoKCk7bi5jbGVhcigpfWVsc2V7ZWUuZ2V0KHRoaXMpLmNsZWFyKCk7Zm9yKGNvbnN0IG4gb2YgWWUuZ2V0KHRoaXMpLnZhbHVlcygpKW4uY2xlYXIoKTtmb3IoY29uc3QgbiBvZiBQZS5nZXQodGhpcykudmFsdWVzKCkpe2Zvcihjb25zdCBvIG9mIG4pby5maW5pc2goKTtuLmNsZWFyKCl9fX1saXN0ZW5lckNvdW50KHQpe3Q9QXJyYXkuaXNBcnJheSh0KT90Olt0XTtsZXQgZT0wO2Zvcihjb25zdCBuIG9mIHQpe2lmKHR5cGVvZiBuPT0ic3RyaW5nIil7ZSs9ZWUuZ2V0KHRoaXMpLnNpemUrVGUodGhpcyxuKS5zaXplK2tlKHRoaXMsbikuc2l6ZStrZSh0aGlzKS5zaXplO2NvbnRpbnVlfXR5cGVvZiBuPCJ1IiYmRWUobiksZSs9ZWUuZ2V0KHRoaXMpLnNpemU7Zm9yKGNvbnN0IG8gb2YgWWUuZ2V0KHRoaXMpLnZhbHVlcygpKWUrPW8uc2l6ZTtmb3IoY29uc3QgbyBvZiBQZS5nZXQodGhpcykudmFsdWVzKCkpZSs9by5zaXplfXJldHVybiBlfWJpbmRNZXRob2RzKHQsZSl7aWYodHlwZW9mIHQhPSJvYmplY3QifHx0PT09bnVsbCl0aHJvdyBuZXcgVHlwZUVycm9yKCJgdGFyZ2V0YCBtdXN0IGJlIGFuIG9iamVjdCIpO2U9T3IoZSk7Zm9yKGNvbnN0IG4gb2YgZSl7aWYodFtuXSE9PXZvaWQgMCl0aHJvdyBuZXcgRXJyb3IoYFRoZSBwcm9wZXJ0eSBcYCR7bn1cYCBhbHJlYWR5IGV4aXN0cyBvbiBcYHRhcmdldFxgYCk7T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsbix7ZW51bWVyYWJsZTohMSx2YWx1ZTp0aGlzW25dLmJpbmQodGhpcyl9KX19fWNvbnN0IE1yPU9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGxlLnByb3RvdHlwZSkuZmlsdGVyKHI9PnIhPT0iY29uc3RydWN0b3IiKTtPYmplY3QuZGVmaW5lUHJvcGVydHkobGUsImxpc3RlbmVyQWRkZWQiLHt2YWx1ZTpYZSx3cml0YWJsZTohMSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShsZSwibGlzdGVuZXJSZW1vdmVkIix7dmFsdWU6UWUsd3JpdGFibGU6ITEsZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITF9KTt2YXIgQnQ9bGU7ZnVuY3Rpb24gQ28ocil7cmV0dXJuIHR5cGVvZiByPT0ib2JqZWN0IiYmciE9PW51bGwmJiJtZXNzYWdlImluIHImJnR5cGVvZiByLm1lc3NhZ2U9PSJzdHJpbmcifWZ1bmN0aW9uIEJvKHIpe2lmKENvKHIpKXJldHVybiByO3RyeXtyZXR1cm4gbmV3IEVycm9yKEpTT04uc3RyaW5naWZ5KHIpKX1jYXRjaHtyZXR1cm4gbmV3IEVycm9yKFN0cmluZyhyKSl9fWZ1bmN0aW9uIE50KHIpe3JldHVybiBCbyhyKS5tZXNzYWdlfXZhciBObz1PYmplY3QuZGVmaW5lUHJvcGVydHksT289KHIsdCxlKT0+dCBpbiByP05vKHIsdCx7ZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITAsdmFsdWU6ZX0pOnJbdF09ZSxNbz0ocix0LGUpPT4oT28ocix0eXBlb2YgdCE9InN5bWJvbCI/dCsiIjp0LGUpLGUpO2NvbnN0IFVvPSJobGcudG9rYm94LmNvbS9wcm9kL2xvZ2dpbmcvdmNwX3dlYnJ0YyIsTG89Imh0dHBzOi8vIix6bz0xZTQ7bGV0IHFlO2NvbnN0ICRvPW5ldyBVaW50OEFycmF5KDE2KTtmdW5jdGlvbiBHbygpe2lmKCFxZSYmKHFlPXR5cGVvZiBjcnlwdG88InUiJiZjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzJiZjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzLmJpbmQoY3J5cHRvKSwhcWUpKXRocm93IG5ldyBFcnJvcigiY3J5cHRvLmdldFJhbmRvbVZhbHVlcygpIG5vdCBzdXBwb3J0ZWQuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vdXVpZGpzL3V1aWQjZ2V0cmFuZG9tdmFsdWVzLW5vdC1zdXBwb3J0ZWQiKTtyZXR1cm4gcWUoJG8pfWNvbnN0IEM9W107Zm9yKGxldCByPTA7cjwyNTY7KytyKUMucHVzaCgocisyNTYpLnRvU3RyaW5nKDE2KS5zbGljZSgxKSk7ZnVuY3Rpb24gV28ocix0PTApe3JldHVybihDW3JbdCswXV0rQ1tyW3QrMV1dK0Nbclt0KzJdXStDW3JbdCszXV0rIi0iK0Nbclt0KzRdXStDW3JbdCs1XV0rIi0iK0Nbclt0KzZdXStDW3JbdCs3XV0rIi0iK0Nbclt0KzhdXStDW3JbdCs5XV0rIi0iK0Nbclt0KzEwXV0rQ1tyW3QrMTFdXStDW3JbdCsxMl1dK0Nbclt0KzEzXV0rQ1tyW3QrMTRdXStDW3JbdCsxNV1dKS50b0xvd2VyQ2FzZSgpfWNvbnN0IFZvPXR5cGVvZiBjcnlwdG88InUiJiZjcnlwdG8ucmFuZG9tVVVJRCYmY3J5cHRvLnJhbmRvbVVVSUQuYmluZChjcnlwdG8pLFVyPXtyYW5kb21VVUlEOlZvfTtmdW5jdGlvbiBIbyhyLHQsZSl7aWYoVXIucmFuZG9tVVVJRCYmIXQmJiFyKXJldHVybiBVci5yYW5kb21VVUlEKCk7cj1yfHx7fTtjb25zdCBuPXIucmFuZG9tfHwoci5ybmd8fEdvKSgpO2lmKG5bNl09bls2XSYxNXw2NCxuWzhdPW5bOF0mNjN8MTI4LHQpe2U9ZXx8MDtmb3IobGV0IG89MDtvPDE2Oysrbyl0W2Urb109bltvXTtyZXR1cm4gdH1yZXR1cm4gV28obil9ZnVuY3Rpb24gT3Qocix0KXtnbG9iYWxUaGlzLnZvbmFnZXx8KGdsb2JhbFRoaXMudm9uYWdlPXt9KSxnbG9iYWxUaGlzLnZvbmFnZS53b3JrZXJpemVyfHwoZ2xvYmFsVGhpcy52b25hZ2Uud29ya2VyaXplcj17fSk7bGV0IGU9Z2xvYmFsVGhpcy52b25hZ2Uud29ya2VyaXplcjtyZXR1cm4gZVtyXXx8KGVbcl09dCksZVtyXX1jb25zdCB0ZT1PdCgiZ2xvYmFscyIse30pO3ZhciBkZT0ocj0+KHIuSU5JVD0iSU5JVCIsci5GT1JXQVJEPSJGT1JXQVJEIixyLlRFUk1JTkFURT0iVEVSTUlOQVRFIixyLkdMT0JBTFNfU1lOQz0iR0xPQkFMU19TWU5DIixyKSkoZGV8fHt9KTtmdW5jdGlvbiBMcihyKXtyZXR1cm5bSW1hZ2VCaXRtYXAsUmVhZGFibGVTdHJlYW0sV3JpdGFibGVTdHJlYW1dLnNvbWUodD0+ciBpbnN0YW5jZW9mIHQpfWxldCBqbz0wO2Z1bmN0aW9uIFlvKHIsdCxlLG4sbyl7Y29uc3QgaT1qbysrO3JldHVybiByLnBvc3RNZXNzYWdlKHtpZDppLHR5cGU6dCxmdW5jdGlvbk5hbWU6ZSxhcmdzOm59LG4uZmlsdGVyKHM9PkxyKHMpKSksbmV3IFByb21pc2Uocz0+e289PW51bGx8fG8uc2V0KGkscyl9KX1mdW5jdGlvbiBEZShyLHQpe2NvbnN0e2lkOmUsdHlwZTpufT1yLG89QXJyYXkuaXNBcnJheSh0KT90Olt0XTtwb3N0TWVzc2FnZSh7aWQ6ZSx0eXBlOm4scmVzdWx0OnR9LG8uZmlsdGVyKGk9PkxyKGkpKSl9Y29uc3QgenI9T3QoIndvcmtlcml6ZWQiLHt9KTtmdW5jdGlvbiAkcigpe3JldHVybiB0eXBlb2YgV29ya2VyR2xvYmFsU2NvcGU8InUiJiZzZWxmIGluc3RhbmNlb2YgV29ya2VyR2xvYmFsU2NvcGV9YXN5bmMgZnVuY3Rpb24gWG8oKXtpZigkcigpKURlKHt0eXBlOmRlLkdMT0JBTFNfU1lOQ30sdGUpO2Vsc2V7Y29uc3Qgcj1bXTtmb3IoY29uc3QgdCBpbiB6cil7Y29uc3R7d29ya2VyOmUscmVzb2x2ZXJzOm59PXpyW3RdLndvcmtlckNvbnRleHQ7ZSYmci5wdXNoKFlvKGUsZGUuR0xPQkFMU19TWU5DLCIiLFt0ZV0sbikpfWF3YWl0IFByb21pc2UuYWxsKHIpfX1mdW5jdGlvbiBKZShyLHQpe2lmKEFycmF5LmlzQXJyYXkodCkpdC5zcGxpY2UoMCx0Lmxlbmd0aCk7ZWxzZSBpZih0eXBlb2YgdD09Im9iamVjdCIpZm9yKGNvbnN0IGUgaW4gdClkZWxldGUgdFtlXTtmb3IoY29uc3QgZSBpbiByKUFycmF5LmlzQXJyYXkocltlXSk/KHRbZV09W10sSmUocltlXSx0W2VdKSk6dHlwZW9mIHJbZV09PSJvYmplY3QiPyh0W2VdPXt9LEplKHJbZV0sdFtlXSkpOnRbZV09cltlXX1hc3luYyBmdW5jdGlvbiBRbyhyLHQpe2NvbnN0e2Z1bmN0aW9uTmFtZTplLGFyZ3M6bn09cjtpZighdC5pbnN0YW5jZSl0aHJvdyJpbnN0YW5jZSBub3QgaW5pdGlhbGl6ZWQiO2lmKCFlKXRocm93Im1pc3NpbmcgZnVuY3Rpb24gbmFtZSB0byBjYWxsIjtpZighdC5pbnN0YW5jZVtlXSl0aHJvd2B1bmRlZmluZWQgZnVuY3Rpb24gWyR7ZX1dIGluIGNsYXNzICR7dC5pbnN0YW5jZS5jb25zdHJ1Y3Rvci53b3JrZXJJZH1gO0RlKHIsYXdhaXQgdC5pbnN0YW5jZVtlXSguLi5uIT1udWxsP246W10pKX1jb25zdCBLbz1PdCgicmVnaXN0ZXJlZFdvcmtlcnMiLHt9KTtmdW5jdGlvbiBxbyhyLHQpe2lmKCFyLmFyZ3MpdGhyb3ciTWlzc2luZyBjbGFzc05hbWUgd2hpbGUgaW5pdGlhbGl6aW5nIHdvcmtlciI7Y29uc3RbZSxuXT1yLmFyZ3Msbz1Lb1tlXTtpZihvKXQuaW5zdGFuY2U9bmV3IG8oci5hcmdzLnNsaWNlKDEpKTtlbHNlIHRocm93YHVua25vd24gd29ya2VyIGNsYXNzICR7ZX1gO0plKG4sdGUpLERlKHIsdHlwZW9mIHQuaW5zdGFuY2UhPT12b2lkIDApfWFzeW5jIGZ1bmN0aW9uIEpvKHIsdCl7Y29uc3R7YXJnczplfT1yO2lmKCF0Lmluc3RhbmNlKXRocm93Imluc3RhbmNlIG5vdCBpbml0aWFsaXplZCI7bGV0IG47dC5pbnN0YW5jZS50ZXJtaW5hdGUmJihuPWF3YWl0IHQuaW5zdGFuY2UudGVybWluYXRlKC4uLmUhPW51bGw/ZTpbXSkpLERlKHIsbil9ZnVuY3Rpb24gWm8ocil7aWYoIXIuYXJncyl0aHJvdyJNaXNzaW5nIGdsb2JhbHMgd2hpbGUgc3luY2luZyI7SmUoci5hcmdzWzBdLHRlKSxEZShyLHt9KX1mdW5jdGlvbiBlaSgpe2NvbnN0IHI9e307b25tZXNzYWdlPWFzeW5jIHQ9Pntjb25zdCBlPXQuZGF0YTtzd2l0Y2goZS50eXBlKXtjYXNlIGRlLklOSVQ6cW8oZSxyKTticmVhaztjYXNlIGRlLkZPUldBUkQ6UW8oZSxyKTticmVhaztjYXNlIGRlLlRFUk1JTkFURTpKbyhlLHIpO2JyZWFrO2Nhc2UgZGUuR0xPQkFMU19TWU5DOlpvKGUpO2JyZWFrfX19JHIoKSYmZWkoKTtmdW5jdGlvbiB0aShyLHQpe3JldHVybiB0ZVtyXXx8KHRlW3JdPXQpLFsoKT0+dGVbcl0sYXN5bmMgZT0+e3RlW3JdPWUsYXdhaXQgWG8oKX1dfWZ1bmN0aW9uIHJpKHIsdCl7cmV0dXJuIHRpKHIsdCl9Y29uc3Rbbmksb2ldPXJpKCJtZXRhZGF0YSIpO2Z1bmN0aW9uIGlpKHIpe29pKHIpfWZ1bmN0aW9uIE10KCl7cmV0dXJuIG5pKCl9Y2xhc3MgVXR7Y29uc3RydWN0b3IodCl7TW8odGhpcywidXVpZCIsSG8oKSksdGhpcy5jb25maWc9dH1hc3luYyBzZW5kKHQpe3ZhciBlLG4sbztjb25zdHthcHBJZDppLHNvdXJjZVR5cGU6c309KGU9TXQoKSkhPW51bGw/ZTp7fTtpZighaXx8IXMpcmV0dXJuIm1ldGFkYXRhIG1pc3NpbmciO2NvbnN0IGE9bmV3IEFib3J0Q29udHJvbGxlcix1PXNldFRpbWVvdXQoKCk9PmEuYWJvcnQoKSx6byk7cmV0dXJuIGF3YWl0KChvPShuPXRoaXMuY29uZmlnKT09bnVsbD92b2lkIDA6bi5mZXRjaCkhPW51bGw/bzpmZXRjaCkodGhpcy5nZXRVcmwoKSx7bWV0aG9kOiJQT1NUIixoZWFkZXJzOnRoaXMuZ2V0SGVhZGVycygpLGJvZHk6SlNPTi5zdHJpbmdpZnkodGhpcy5idWlsZFJlcG9ydCh0KSksc2lnbmFsOmEuc2lnbmFsfSksY2xlYXJUaW1lb3V0KHUpLCJzdWNjZXNzIn1nZXRVcmwoKXt2YXIgdDtsZXQgZT0odD1NdCgpLnByb3h5VXJsKSE9bnVsbD90OkxvO3JldHVybiBlKz0oZS5hdCgtMSk9PT0iLyI/IiI6Ii8iKStVbyxlfWdldEhlYWRlcnMoKXtyZXR1cm57IkNvbnRlbnQtVHlwZSI6ImFwcGxpY2F0aW9uL2pzb24ifX1idWlsZFJlcG9ydCh0KXtjb25zdCBlPU10KCk7cmV0dXJue2d1aWQ6dGhpcy51dWlkLC4uLnQsYXBwbGljYXRpb25JZDplLmFwcElkLHRpbWVzdGFtcDpEYXRlLm5vdygpLHByb3h5VXJsOmUucHJveHlVcmwsc291cmNlOmUuc291cmNlVHlwZX19fWNvbnN0IFplPSIyLjAuMyI7Y2xhc3Mgc2l7Y29uc3RydWN0b3IodCl7QSh0aGlzLCJmcmFtZVRyYW5zZm9ybWVkQ291bnQiLDApLEEodGhpcywiZnJhbWVGcm9tU291cmNlQ291bnQiLDApLEEodGhpcywic3RhcnRBdCIsMCksQSh0aGlzLCJyZXBvcnRlciIpLHRoaXMuY29uZmlnPXQsdGhpcy5yZXBvcnRlcj1uZXcgVXQodCl9YXN5bmMgb25GcmFtZUZyb21Tb3VyY2UoKXt0aGlzLmZyYW1lRnJvbVNvdXJjZUNvdW50Kyt9Z2V0IGZwcygpe2NvbnN0e3N0YXJ0QXQ6dCxmcmFtZUZyb21Tb3VyY2VDb3VudDplfT10aGlzLG49KERhdGUubm93KCktdCkvMWUzO3JldHVybiBlL259YXN5bmMgb25GcmFtZVRyYW5zZm9ybWVkKHQ9e30sZT0hMSl7dGhpcy5zdGFydEF0PT09MCYmKHRoaXMuc3RhcnRBdD1EYXRlLm5vdygpKSx0aGlzLmZyYW1lVHJhbnNmb3JtZWRDb3VudCsrO2NvbnN0e3N0YXJ0QXQ6bixmcmFtZVRyYW5zZm9ybWVkQ291bnQ6byxmcmFtZUZyb21Tb3VyY2VDb3VudDppfT10aGlzLHM9RGF0ZS5ub3coKSxhPShzLW4pLzFlMyx1PW8vYSxmPWkvYTtyZXR1cm4gZXx8dGhpcy5mcmFtZVRyYW5zZm9ybWVkQ291bnQ+PXRoaXMuY29uZmlnLmxvZ2dpbmdJbnRlcnZhbEZyYW1lQ291bnQ/KHRoaXMuZnJhbWVGcm9tU291cmNlQ291bnQ9MCx0aGlzLmZyYW1lVHJhbnNmb3JtZWRDb3VudD0wLHRoaXMuc3RhcnRBdD1zLHRoaXMucmVwb3J0ZXIuY29uZmlnPXRoaXMuY29uZmlnLHRoaXMucmVwb3J0ZXIuc2VuZCh7Li4udGhpcy5jb25maWcucmVwb3J0LHZhcmlhdGlvbjoiUW9TIixmcHM6Zix0cmFuc2Zvcm1lZEZwczp1LGZyYW1lc1RyYW5zZm9ybWVkOm8sLi4udH0pKToic3VjY2VzcyJ9fXZhciBMdD0ocj0+KHIucGlwZWxpbmVfZW5kZWQ9InBpcGVsaW5lX2VuZGVkIixyLnBpcGVsaW5lX2VuZGVkX3dpdGhfZXJyb3I9InBpcGVsaW5lX2VuZGVkX3dpdGhfZXJyb3IiLHIucGlwZWxpbmVfc3RhcnRlZD0icGlwZWxpbmVfc3RhcnRlZCIsci5waXBlbGluZV9zdGFydGVkX3dpdGhfZXJyb3I9InBpcGVsaW5lX3N0YXJ0ZWRfd2l0aF9lcnJvciIsci5waXBlbGluZV9yZXN0YXJ0ZWQ9InBpcGVsaW5lX3Jlc3RhcnRlZCIsci5waXBlbGluZV9yZXN0YXJ0ZWRfd2l0aF9lcnJvcj0icGlwZWxpbmVfcmVzdGFydGVkX3dpdGhfZXJyb3IiLHIpKShMdHx8e30pO2NvbnN0IGFpPTUwMCx1aT0uODtjbGFzcyBjaSBleHRlbmRzIEJ0e2NvbnN0cnVjdG9yKHQsZSl7c3VwZXIoKSxBKHRoaXMsInJlcG9ydGVyXyIsbmV3IFV0KSxBKHRoaXMsInJlcG9ydGVyUW9zXyIsbmV3IHNpKHtsb2dnaW5nSW50ZXJ2YWxGcmFtZUNvdW50OmFpLHJlcG9ydDp7dmVyc2lvbjpaZX19KSksQSh0aGlzLCJ0cmFuc2Zvcm1lclR5cGVfIiksQSh0aGlzLCJ0cmFuc2Zvcm1lcl8iKSxBKHRoaXMsInNob3VsZFN0b3BfIiksQSh0aGlzLCJpc0ZsYXNoZWRfIiksQSh0aGlzLCJtZWRpYVRyYW5zZm9ybWVyUW9zUmVwb3J0U3RhcnRUaW1lc3RhbXBfIiksQSh0aGlzLCJ2aWRlb0hlaWdodF8iKSxBKHRoaXMsInZpZGVvV2lkdGhfIiksQSh0aGlzLCJ0cmFja0V4cGVjdGVkUmF0ZV8iKSxBKHRoaXMsImluZGV4XyIpLEEodGhpcywiY29udHJvbGxlcl8iKSx0aGlzLmluZGV4Xz1lLHRoaXMudHJhbnNmb3JtZXJfPXQsdGhpcy5zaG91bGRTdG9wXz0hMSx0aGlzLmlzRmxhc2hlZF89ITEsdGhpcy5tZWRpYVRyYW5zZm9ybWVyUW9zUmVwb3J0U3RhcnRUaW1lc3RhbXBfPTAsdGhpcy52aWRlb0hlaWdodF89MCx0aGlzLnZpZGVvV2lkdGhfPTAsdGhpcy50cmFja0V4cGVjdGVkUmF0ZV89LTEsdGhpcy50cmFuc2Zvcm1lclR5cGVfPSJDdXN0b20iLCJnZXRUcmFuc2Zvcm1lclR5cGUiaW4gdCYmKHRoaXMudHJhbnNmb3JtZXJUeXBlXz10LmdldFRyYW5zZm9ybWVyVHlwZSgpKSx0aGlzLnJlcG9ydCh7dmFyaWF0aW9uOiJDcmVhdGUifSl9c2V0VHJhY2tFeHBlY3RlZFJhdGUodCl7dGhpcy50cmFja0V4cGVjdGVkUmF0ZV89dH1hc3luYyBzdGFydCh0KXtpZih0aGlzLmNvbnRyb2xsZXJfPXQsdGhpcy50cmFuc2Zvcm1lcl8mJnR5cGVvZiB0aGlzLnRyYW5zZm9ybWVyXy5zdGFydD09ImZ1bmN0aW9uIil0cnl7YXdhaXQgdGhpcy50cmFuc2Zvcm1lcl8uc3RhcnQodCl9Y2F0Y2goZSl7dGhpcy5yZXBvcnQoe21lc3NhZ2U6Wi5lcnJvcnMudHJhbnNmb3JtZXJfc3RhcnQsdmFyaWF0aW9uOiJFcnJvciIsZXJyb3I6TnQoZSl9KTtjb25zdCBuPXtldmVudE1ldGFEYXRhOnt0cmFuc2Zvcm1lckluZGV4OnRoaXMuaW5kZXhffSxlcnJvcjplLGZ1bmN0aW9uOiJzdGFydCJ9O3RoaXMuZW1pdCgiZXJyb3IiLG4pfX1hc3luYyB0cmFuc2Zvcm0odCxlKXt2YXIgbixvLGkscztpZih0aGlzLm1lZGlhVHJhbnNmb3JtZXJRb3NSZXBvcnRTdGFydFRpbWVzdGFtcF89PT0wJiYodGhpcy5tZWRpYVRyYW5zZm9ybWVyUW9zUmVwb3J0U3RhcnRUaW1lc3RhbXBfPURhdGUubm93KCkpLHQgaW5zdGFuY2VvZiBWaWRlb0ZyYW1lJiYodGhpcy52aWRlb0hlaWdodF89KG49dD09bnVsbD92b2lkIDA6dC5kaXNwbGF5SGVpZ2h0KSE9bnVsbD9uOjAsdGhpcy52aWRlb1dpZHRoXz0obz10PT1udWxsP3ZvaWQgMDp0LmRpc3BsYXlXaWR0aCkhPW51bGw/bzowKSx0aGlzLnJlcG9ydGVyUW9zXy5vbkZyYW1lRnJvbVNvdXJjZSgpLHRoaXMudHJhbnNmb3JtZXJfKWlmKHRoaXMuc2hvdWxkU3RvcF8pY29uc29sZS53YXJuKCJbUGlwZWxpbmVdIGZsdXNoIGZyb20gdHJhbnNmb3JtIiksdC5jbG9zZSgpLHRoaXMuZmx1c2goZSksZS50ZXJtaW5hdGUoKTtlbHNle3RyeXthd2FpdCgocz0oaT10aGlzLnRyYW5zZm9ybWVyXykudHJhbnNmb3JtKT09bnVsbD92b2lkIDA6cy5jYWxsKGksdCxlKSksdGhpcy5yZXBvcnRRb3MoKX1jYXRjaChhKXt0aGlzLnJlcG9ydCh7bWVzc2FnZTpaLmVycm9ycy50cmFuc2Zvcm1lcl90cmFuc2Zvcm0sdmFyaWF0aW9uOiJFcnJvciIsZXJyb3I6TnQoYSl9KTtjb25zdCB1PXtldmVudE1ldGFEYXRhOnt0cmFuc2Zvcm1lckluZGV4OnRoaXMuaW5kZXhffSxlcnJvcjphLGZ1bmN0aW9uOiJ0cmFuc2Zvcm0ifTt0aGlzLmVtaXQoImVycm9yIix1KX1pZih0aGlzLnRyYWNrRXhwZWN0ZWRSYXRlXyE9LTEmJnRoaXMudHJhY2tFeHBlY3RlZFJhdGVfKnVpPnRoaXMucmVwb3J0ZXJRb3NfLmZwcyl7Y29uc3QgYT17ZXZlbnRNZXRhRGF0YTp7dHJhbnNmb3JtZXJJbmRleDp0aGlzLmluZGV4X30sd2FybmluZ1R5cGU6ImZwc19kcm9wIixkcm9wSW5mbzp7cmVxdWVzdGVkOnRoaXMudHJhY2tFeHBlY3RlZFJhdGVfLGN1cnJlbnQ6dGhpcy5yZXBvcnRlclFvc18uZnBzfX07dGhpcy5lbWl0KCJ3YXJuIixhKX19fWFzeW5jIGZsdXNoKHQpe2lmKHRoaXMudHJhbnNmb3JtZXJfJiZ0eXBlb2YgdGhpcy50cmFuc2Zvcm1lcl8uZmx1c2g9PSJmdW5jdGlvbiImJiF0aGlzLmlzRmxhc2hlZF8pe3RoaXMuaXNGbGFzaGVkXz0hMDt0cnl7YXdhaXQgdGhpcy50cmFuc2Zvcm1lcl8uZmx1c2godCl9Y2F0Y2goZSl7dGhpcy5yZXBvcnQoe21lc3NhZ2U6Wi5lcnJvcnMudHJhbnNmb3JtZXJfZmx1c2gsdmFyaWF0aW9uOiJFcnJvciIsZXJyb3I6TnQoZSl9KTtjb25zdCBuPXtldmVudE1ldGFEYXRhOnt0cmFuc2Zvcm1lckluZGV4OnRoaXMuaW5kZXhffSxlcnJvcjplLGZ1bmN0aW9uOiJmbHVzaCJ9O3RoaXMuZW1pdCgiZXJyb3IiLG4pfX10aGlzLnJlcG9ydFFvcyghMCksdGhpcy5yZXBvcnQoe3ZhcmlhdGlvbjoiRGVsZXRlIn0pfXN0b3AoKXtjb25zb2xlLmxvZygiW1BpcGVsaW5lXSBTdG9wIHN0cmVhbS4iKSx0aGlzLmNvbnRyb2xsZXJfJiYodGhpcy5mbHVzaCh0aGlzLmNvbnRyb2xsZXJfKSx0aGlzLmNvbnRyb2xsZXJfLnRlcm1pbmF0ZSgpKSx0aGlzLnNob3VsZFN0b3BfPSEwfXJlcG9ydCh0KXt0aGlzLnJlcG9ydGVyXy5zZW5kKHt2ZXJzaW9uOlplLGFjdGlvbjoiTWVkaWFUcmFuc2Zvcm1lciIsdHJhbnNmb3JtZXJUeXBlOnRoaXMudHJhbnNmb3JtZXJUeXBlXywuLi50fSl9cmVwb3J0UW9zKHQ9ITEpe3RoaXMucmVwb3J0ZXJRb3NfLmNvbmZpZz17Li4udGhpcy5yZXBvcnRlclFvc18uY29uZmlnfSx0aGlzLnJlcG9ydGVyUW9zXy5vbkZyYW1lVHJhbnNmb3JtZWQoe3ZlcnNpb246WmUsYWN0aW9uOiJNZWRpYVRyYW5zZm9ybWVyIix0cmFuc2Zvcm1lclR5cGU6dGhpcy50cmFuc2Zvcm1lclR5cGVfLHZpZGVvV2lkdGg6dGhpcy52aWRlb1dpZHRoXyx2aWRlb0hlaWdodDp0aGlzLnZpZGVvSGVpZ2h0X30sdCl9fWNsYXNzIGZpIGV4dGVuZHMgQnR7Y29uc3RydWN0b3IodCl7c3VwZXIoKSxBKHRoaXMsInRyYW5zZm9ybWVyc18iKSxBKHRoaXMsInRyYWNrRXhwZWN0ZWRSYXRlXyIpLHRoaXMudHJhbnNmb3JtZXJzXz1bXSx0aGlzLnRyYWNrRXhwZWN0ZWRSYXRlXz0tMTtmb3IobGV0IGU9MDtlPHQubGVuZ3RoO2UrKyl7bGV0IG49bmV3IGNpKHRbZV0sZSk7bi5vbigiZXJyb3IiLG89Pnt0aGlzLmVtaXQoImVycm9yIixvKX0pLG4ub24oIndhcm4iLG89Pnt0aGlzLmVtaXQoIndhcm4iLG8pfSksdGhpcy50cmFuc2Zvcm1lcnNfLnB1c2gobil9fXNldFRyYWNrRXhwZWN0ZWRSYXRlKHQpe3RoaXMudHJhY2tFeHBlY3RlZFJhdGVfPXQ7Zm9yKGxldCBlIG9mIHRoaXMudHJhbnNmb3JtZXJzXyllLnNldFRyYWNrRXhwZWN0ZWRSYXRlKHRoaXMudHJhY2tFeHBlY3RlZFJhdGVfKX1hc3luYyBzdGFydCh0LGUpe2lmKCF0aGlzLnRyYW5zZm9ybWVyc198fHRoaXMudHJhbnNmb3JtZXJzXy5sZW5ndGg9PT0wKXtjb25zb2xlLmxvZygiW1BpcGVsaW5lXSBObyB0cmFuc2Zvcm1lcnMuIik7cmV0dXJufXRyeXtsZXQgbj10O2ZvcihsZXQgbyBvZiB0aGlzLnRyYW5zZm9ybWVyc18pdD10LnBpcGVUaHJvdWdoKG5ldyBUcmFuc2Zvcm1TdHJlYW0obykpO3QucGlwZVRvKGUpLnRoZW4oYXN5bmMoKT0+e2NvbnNvbGUubG9nKCJbUGlwZWxpbmVdIFNldHVwLiIpLGF3YWl0IGUuYWJvcnQoKSxhd2FpdCBuLmNhbmNlbCgpLHRoaXMuZW1pdCgicGlwZWxpbmVJbmZvIiwicGlwZWxpbmVfZW5kZWQiKX0pLmNhdGNoKGFzeW5jIG89Pnt0LmNhbmNlbCgpLnRoZW4oKCk9Pntjb25zb2xlLmxvZygiW1BpcGVsaW5lXSBTaHV0dGluZyBkb3duIHN0cmVhbXMgYWZ0ZXIgYWJvcnQuIil9KS5jYXRjaChpPT57Y29uc29sZS5lcnJvcigiW1BpcGVsaW5lXSBFcnJvciBmcm9tIHN0cmVhbSB0cmFuc2Zvcm06IixpKX0pLGF3YWl0IGUuYWJvcnQobyksYXdhaXQgbi5jYW5jZWwobyksdGhpcy5lbWl0KCJwaXBlbGluZUluZm8iLCJwaXBlbGluZV9lbmRlZF93aXRoX2Vycm9yIil9KX1jYXRjaHt0aGlzLmVtaXQoInBpcGVsaW5lSW5mbyIsInBpcGVsaW5lX3N0YXJ0ZWRfd2l0aF9lcnJvciIpLHRoaXMuZGVzdHJveSgpO3JldHVybn10aGlzLmVtaXQoInBpcGVsaW5lSW5mbyIsInBpcGVsaW5lX3N0YXJ0ZWQiKSxjb25zb2xlLmxvZygiW1BpcGVsaW5lXSBQaXBlbGluZSBzdGFydGVkLiIpfWFzeW5jIGRlc3Ryb3koKXtjb25zb2xlLmxvZygiW1BpcGVsaW5lXSBEZXN0cm95aW5nIFBpcGVsaW5lLiIpO2ZvcihsZXQgdCBvZiB0aGlzLnRyYW5zZm9ybWVyc18pdC5zdG9wKCl9fWNsYXNzIGxpIGV4dGVuZHMgQnR7Y29uc3RydWN0b3IoKXtzdXBlcigpLEEodGhpcywicmVwb3J0ZXJfIiksQSh0aGlzLCJwaXBlbGluZV8iKSxBKHRoaXMsInRyYW5zZm9ybWVyc18iKSxBKHRoaXMsInJlYWRhYmxlXyIpLEEodGhpcywid3JpdGFibGVfIiksQSh0aGlzLCJ0cmFja0V4cGVjdGVkUmF0ZV8iKSx0aGlzLnJlcG9ydGVyXz1uZXcgVXQsdGhpcy50cmFja0V4cGVjdGVkUmF0ZV89LTEsdGhpcy5yZXBvcnQoe3ZhcmlhdGlvbjoiQ3JlYXRlIn0pfXNldFRyYWNrRXhwZWN0ZWRSYXRlKHQpe3RoaXMudHJhY2tFeHBlY3RlZFJhdGVfPXQsdGhpcy5waXBlbGluZV8mJnRoaXMucGlwZWxpbmVfLnNldFRyYWNrRXhwZWN0ZWRSYXRlKHRoaXMudHJhY2tFeHBlY3RlZFJhdGVfKX10cmFuc2Zvcm0odCxlKXtyZXR1cm4gdGhpcy5yZWFkYWJsZV89dCx0aGlzLndyaXRhYmxlXz1lLHRoaXMudHJhbnNmb3JtSW50ZXJuYWwoKX10cmFuc2Zvcm1JbnRlcm5hbCgpe3JldHVybiBuZXcgUHJvbWlzZShhc3luYyh0LGUpPT57aWYoIXRoaXMudHJhbnNmb3JtZXJzX3x8dGhpcy50cmFuc2Zvcm1lcnNfLmxlbmd0aD09PTApe3RoaXMucmVwb3J0KHttZXNzYWdlOlouZXJyb3JzLnRyYW5zZm9ybWVyX25vbmUsdmFyaWF0aW9uOiJFcnJvciJ9KSxlKCJbTWVkaWFQcm9jZXNzb3JdIE5lZWQgdG8gc2V0IHRyYW5zZm9ybWVycy4iKTtyZXR1cm59aWYoIXRoaXMucmVhZGFibGVfKXt0aGlzLnJlcG9ydCh7dmFyaWF0aW9uOiJFcnJvciIsbWVzc2FnZTpaLmVycm9ycy5yZWFkYWJsZV9udWxsfSksZSgiW01lZGlhUHJvY2Vzc29yXSBSZWFkYWJsZSBpcyBudWxsLiIpO3JldHVybn1pZighdGhpcy53cml0YWJsZV8pe3RoaXMucmVwb3J0KHt2YXJpYXRpb246IkVycm9yIixtZXNzYWdlOlouZXJyb3JzLndyaXRhYmxlX251bGx9KSxlKCJbTWVkaWFQcm9jZXNzb3JdIFdyaXRhYmxlIGlzIG51bGwuIik7cmV0dXJufWxldCBuPSExO3RoaXMucGlwZWxpbmVfJiYobj0hMCx0aGlzLnBpcGVsaW5lXy5jbGVhckxpc3RlbmVycygpLHRoaXMucGlwZWxpbmVfLmRlc3Ryb3koKSksdGhpcy5waXBlbGluZV89bmV3IGZpKHRoaXMudHJhbnNmb3JtZXJzXyksdGhpcy5waXBlbGluZV8ub24oIndhcm4iLG89Pnt0aGlzLmVtaXQoIndhcm4iLG8pfSksdGhpcy5waXBlbGluZV8ub24oImVycm9yIixvPT57dGhpcy5lbWl0KCJlcnJvciIsbyl9KSx0aGlzLnBpcGVsaW5lXy5vbigicGlwZWxpbmVJbmZvIixvPT57biYmKG89PT0icGlwZWxpbmVfc3RhcnRlZCI/bz1MdC5waXBlbGluZV9yZXN0YXJ0ZWQ6bz09PSJwaXBlbGluZV9zdGFydGVkX3dpdGhfZXJyb3IiJiYobz1MdC5waXBlbGluZV9yZXN0YXJ0ZWRfd2l0aF9lcnJvcikpLHRoaXMuZW1pdCgicGlwZWxpbmVJbmZvIixvKX0pLHRoaXMudHJhY2tFeHBlY3RlZFJhdGVfIT0tMSYmdGhpcy5waXBlbGluZV8uc2V0VHJhY2tFeHBlY3RlZFJhdGUodGhpcy50cmFja0V4cGVjdGVkUmF0ZV8pLHRoaXMucGlwZWxpbmVfLnN0YXJ0KHRoaXMucmVhZGFibGVfLHRoaXMud3JpdGFibGVfKS50aGVuKCgpPT57dCgpfSkuY2F0Y2gobz0+e2Uobyl9KX0pfXNldFRyYW5zZm9ybWVycyh0KXtyZXR1cm4gdGhpcy5yZXBvcnQoe3ZhcmlhdGlvbjoiVXBkYXRlIixtZXNzYWdlOloudXBkYXRlcy50cmFuc2Zvcm1lcl9uZXd9KSx0aGlzLnRyYW5zZm9ybWVyc189dCx0aGlzLnJlYWRhYmxlXyYmdGhpcy53cml0YWJsZV8/dGhpcy50cmFuc2Zvcm1JbnRlcm5hbCgpOlByb21pc2UucmVzb2x2ZSgpfWRlc3Ryb3koKXtyZXR1cm4gbmV3IFByb21pc2UoYXN5bmMgdD0+e3RoaXMucGlwZWxpbmVfJiZ0aGlzLnBpcGVsaW5lXy5kZXN0cm95KCksdGhpcy5yZXBvcnQoe3ZhcmlhdGlvbjoiRGVsZXRlIn0pLHQoKX0pfXJlcG9ydCh0KXt0aGlzLnJlcG9ydGVyXy5zZW5kKHt2ZXJzaW9uOlplLGFjdGlvbjoiTWVkaWFQcm9jZXNzb3IiLC4uLnR9KX19dmFyIGRpPU9iamVjdC5kZWZpbmVQcm9wZXJ0eSxtaT0ocix0LGUpPT50IGluIHI/ZGkocix0LHtlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMCx2YWx1ZTplfSk6clt0XT1lLGhpPShyLHQsZSk9PihtaShyLHR5cGVvZiB0IT0ic3ltYm9sIj90KyIiOnQsZSksZSk7Y29uc3QgcGk9ImhsZy50b2tib3guY29tL3Byb2QvbG9nZ2luZy92Y3Bfd2VicnRjIixnaT0iaHR0cHM6Ly8iLHlpPTFlNDtsZXQgZXQ7Y29uc3QgeGk9bmV3IFVpbnQ4QXJyYXkoMTYpO2Z1bmN0aW9uIF9pKCl7aWYoIWV0JiYoZXQ9dHlwZW9mIGNyeXB0bzwidSImJmNyeXB0by5nZXRSYW5kb21WYWx1ZXMmJmNyeXB0by5nZXRSYW5kb21WYWx1ZXMuYmluZChjcnlwdG8pLCFldCkpdGhyb3cgbmV3IEVycm9yKCJjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKCkgbm90IHN1cHBvcnRlZC4gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS91dWlkanMvdXVpZCNnZXRyYW5kb212YWx1ZXMtbm90LXN1cHBvcnRlZCIpO3JldHVybiBldCh4aSl9Y29uc3QgQj1bXTtmb3IobGV0IHI9MDtyPDI1NjsrK3IpQi5wdXNoKChyKzI1NikudG9TdHJpbmcoMTYpLnNsaWNlKDEpKTtmdW5jdGlvbiBiaShyLHQ9MCl7cmV0dXJuKEJbclt0KzBdXStCW3JbdCsxXV0rQltyW3QrMl1dK0Jbclt0KzNdXSsiLSIrQltyW3QrNF1dK0Jbclt0KzVdXSsiLSIrQltyW3QrNl1dK0Jbclt0KzddXSsiLSIrQltyW3QrOF1dK0Jbclt0KzldXSsiLSIrQltyW3QrMTBdXStCW3JbdCsxMV1dK0Jbclt0KzEyXV0rQltyW3QrMTNdXStCW3JbdCsxNF1dK0Jbclt0KzE1XV0pLnRvTG93ZXJDYXNlKCl9Y29uc3Qgdmk9dHlwZW9mIGNyeXB0bzwidSImJmNyeXB0by5yYW5kb21VVUlEJiZjcnlwdG8ucmFuZG9tVVVJRC5iaW5kKGNyeXB0byksR3I9e3JhbmRvbVVVSUQ6dml9O2Z1bmN0aW9uIEVpKHIsdCxlKXtpZihHci5yYW5kb21VVUlEJiYhdCYmIXIpcmV0dXJuIEdyLnJhbmRvbVVVSUQoKTtyPXJ8fHt9O2NvbnN0IG49ci5yYW5kb218fChyLnJuZ3x8X2kpKCk7aWYobls2XT1uWzZdJjE1fDY0LG5bOF09bls4XSY2M3wxMjgsdCl7ZT1lfHwwO2ZvcihsZXQgbz0wO288MTY7KytvKXRbZStvXT1uW29dO3JldHVybiB0fXJldHVybiBiaShuKX1mdW5jdGlvbiB6dChyLHQpe2dsb2JhbFRoaXMudm9uYWdlfHwoZ2xvYmFsVGhpcy52b25hZ2U9e30pLGdsb2JhbFRoaXMudm9uYWdlLndvcmtlcml6ZXJ8fChnbG9iYWxUaGlzLnZvbmFnZS53b3JrZXJpemVyPXt9KTtsZXQgZT1nbG9iYWxUaGlzLnZvbmFnZS53b3JrZXJpemVyO3JldHVybiBlW3JdfHwoZVtyXT10KSxlW3JdfWNvbnN0IHJlPXp0KCJnbG9iYWxzIix7fSk7dmFyIG1lPShyPT4oci5JTklUPSJJTklUIixyLkZPUldBUkQ9IkZPUldBUkQiLHIuVEVSTUlOQVRFPSJURVJNSU5BVEUiLHIuR0xPQkFMU19TWU5DPSJHTE9CQUxTX1NZTkMiLHIpKShtZXx8e30pO2Z1bmN0aW9uIFdyKHIpe3JldHVybltJbWFnZUJpdG1hcCxSZWFkYWJsZVN0cmVhbSxXcml0YWJsZVN0cmVhbV0uc29tZSh0PT5yIGluc3RhbmNlb2YgdCl9bGV0IFRpPTA7ZnVuY3Rpb24gQWkocix0LGUsbixvKXtjb25zdCBpPVRpKys7cmV0dXJuIHIucG9zdE1lc3NhZ2Uoe2lkOmksdHlwZTp0LGZ1bmN0aW9uTmFtZTplLGFyZ3M6bn0sbi5maWx0ZXIocz0+V3IocykpKSxuZXcgUHJvbWlzZShzPT57bz09bnVsbHx8by5zZXQoaSxzKX0pfWZ1bmN0aW9uIENlKHIsdCl7Y29uc3R7aWQ6ZSx0eXBlOm59PXIsbz1BcnJheS5pc0FycmF5KHQpP3Q6W3RdO3Bvc3RNZXNzYWdlKHtpZDplLHR5cGU6bixyZXN1bHQ6dH0sby5maWx0ZXIoaT0+V3IoaSkpKX1jb25zdCBWcj16dCgid29ya2VyaXplZCIse30pO2Z1bmN0aW9uIEhyKCl7cmV0dXJuIHR5cGVvZiBXb3JrZXJHbG9iYWxTY29wZTwidSImJnNlbGYgaW5zdGFuY2VvZiBXb3JrZXJHbG9iYWxTY29wZX1hc3luYyBmdW5jdGlvbiB3aSgpe2lmKEhyKCkpQ2Uoe3R5cGU6bWUuR0xPQkFMU19TWU5DfSxyZSk7ZWxzZXtjb25zdCByPVtdO2Zvcihjb25zdCB0IGluIFZyKXtjb25zdHt3b3JrZXI6ZSxyZXNvbHZlcnM6bn09VnJbdF0ud29ya2VyQ29udGV4dDtlJiZyLnB1c2goQWkoZSxtZS5HTE9CQUxTX1NZTkMsIiIsW3JlXSxuKSl9YXdhaXQgUHJvbWlzZS5hbGwocil9fWZ1bmN0aW9uIHR0KHIsdCl7aWYoQXJyYXkuaXNBcnJheSh0KSl0LnNwbGljZSgwLHQubGVuZ3RoKTtlbHNlIGlmKHR5cGVvZiB0PT0ib2JqZWN0Iilmb3IoY29uc3QgZSBpbiB0KWRlbGV0ZSB0W2VdO2Zvcihjb25zdCBlIGluIHIpQXJyYXkuaXNBcnJheShyW2VdKT8odFtlXT1bXSx0dChyW2VdLHRbZV0pKTp0eXBlb2YgcltlXT09Im9iamVjdCI/KHRbZV09e30sdHQocltlXSx0W2VdKSk6dFtlXT1yW2VdfWFzeW5jIGZ1bmN0aW9uIElpKHIsdCl7Y29uc3R7ZnVuY3Rpb25OYW1lOmUsYXJnczpufT1yO2lmKCF0Lmluc3RhbmNlKXRocm93Imluc3RhbmNlIG5vdCBpbml0aWFsaXplZCI7aWYoIWUpdGhyb3cibWlzc2luZyBmdW5jdGlvbiBuYW1lIHRvIGNhbGwiO2lmKCF0Lmluc3RhbmNlW2VdKXRocm93YHVuZGVmaW5lZCBmdW5jdGlvbiBbJHtlfV0gaW4gY2xhc3MgJHt0Lmluc3RhbmNlLmNvbnN0cnVjdG9yLndvcmtlcklkfWA7Q2Uocixhd2FpdCB0Lmluc3RhbmNlW2VdKC4uLm4hPW51bGw/bjpbXSkpfWNvbnN0IFNpPXp0KCJyZWdpc3RlcmVkV29ya2VycyIse30pO2Z1bmN0aW9uIFJpKHIsdCl7aWYoIXIuYXJncyl0aHJvdyJNaXNzaW5nIGNsYXNzTmFtZSB3aGlsZSBpbml0aWFsaXppbmcgd29ya2VyIjtjb25zdFtlLG5dPXIuYXJncyxvPVNpW2VdO2lmKG8pdC5pbnN0YW5jZT1uZXcgbyhyLmFyZ3Muc2xpY2UoMSkpO2Vsc2UgdGhyb3dgdW5rbm93biB3b3JrZXIgY2xhc3MgJHtlfWA7dHQobixyZSksQ2Uocix0eXBlb2YgdC5pbnN0YW5jZSE9PXZvaWQgMCl9YXN5bmMgZnVuY3Rpb24gRmkocix0KXtjb25zdHthcmdzOmV9PXI7aWYoIXQuaW5zdGFuY2UpdGhyb3ciaW5zdGFuY2Ugbm90IGluaXRpYWxpemVkIjtsZXQgbjt0Lmluc3RhbmNlLnRlcm1pbmF0ZSYmKG49YXdhaXQgdC5pbnN0YW5jZS50ZXJtaW5hdGUoLi4uZSE9bnVsbD9lOltdKSksQ2UocixuKX1mdW5jdGlvbiBQaShyKXtpZighci5hcmdzKXRocm93Ik1pc3NpbmcgZ2xvYmFscyB3aGlsZSBzeW5jaW5nIjt0dChyLmFyZ3NbMF0scmUpLENlKHIse30pfWZ1bmN0aW9uIGtpKCl7Y29uc3Qgcj17fTtvbm1lc3NhZ2U9YXN5bmMgdD0+e2NvbnN0IGU9dC5kYXRhO3N3aXRjaChlLnR5cGUpe2Nhc2UgbWUuSU5JVDpSaShlLHIpO2JyZWFrO2Nhc2UgbWUuRk9SV0FSRDpJaShlLHIpO2JyZWFrO2Nhc2UgbWUuVEVSTUlOQVRFOkZpKGUscik7YnJlYWs7Y2FzZSBtZS5HTE9CQUxTX1NZTkM6UGkoZSk7YnJlYWt9fX1IcigpJiZraSgpO2Z1bmN0aW9uIERpKHIsdCl7cmV0dXJuIHJlW3JdfHwocmVbcl09dCksWygpPT5yZVtyXSxhc3luYyBlPT57cmVbcl09ZSxhd2FpdCB3aSgpfV19ZnVuY3Rpb24gQ2kocix0KXtyZXR1cm4gRGkocix0KX1jb25zdFtCaSx2bF09Q2koIm1ldGFkYXRhIik7ZnVuY3Rpb24gJHQoKXtyZXR1cm4gQmkoKX1jbGFzcyBOaXtjb25zdHJ1Y3Rvcih0KXtoaSh0aGlzLCJ1dWlkIixFaSgpKSx0aGlzLmNvbmZpZz10fWFzeW5jIHNlbmQodCl7dmFyIGUsbixvO2NvbnN0e2FwcElkOmksc291cmNlVHlwZTpzfT0oZT0kdCgpKSE9bnVsbD9lOnt9O2lmKCFpfHwhcylyZXR1cm4ibWV0YWRhdGEgbWlzc2luZyI7Y29uc3QgYT1uZXcgQWJvcnRDb250cm9sbGVyLHU9c2V0VGltZW91dCgoKT0+YS5hYm9ydCgpLHlpKTtyZXR1cm4gYXdhaXQoKG89KG49dGhpcy5jb25maWcpPT1udWxsP3ZvaWQgMDpuLmZldGNoKSE9bnVsbD9vOmZldGNoKSh0aGlzLmdldFVybCgpLHttZXRob2Q6IlBPU1QiLGhlYWRlcnM6dGhpcy5nZXRIZWFkZXJzKCksYm9keTpKU09OLnN0cmluZ2lmeSh0aGlzLmJ1aWxkUmVwb3J0KHQpKSxzaWduYWw6YS5zaWduYWx9KSxjbGVhclRpbWVvdXQodSksInN1Y2Nlc3MifWdldFVybCgpe3ZhciB0O2xldCBlPSh0PSR0KCkucHJveHlVcmwpIT1udWxsP3Q6Z2k7cmV0dXJuIGUrPShlLmF0KC0xKT09PSIvIj8iIjoiLyIpK3BpLGV9Z2V0SGVhZGVycygpe3JldHVybnsiQ29udGVudC1UeXBlIjoiYXBwbGljYXRpb24vanNvbiJ9fWJ1aWxkUmVwb3J0KHQpe2NvbnN0IGU9JHQoKTtyZXR1cm57Z3VpZDp0aGlzLnV1aWQsLi4udCxhcHBsaWNhdGlvbklkOmUuYXBwSWQsdGltZXN0YW1wOkRhdGUubm93KCkscHJveHlVcmw6ZS5wcm94eVVybCxzb3VyY2U6ZS5zb3VyY2VUeXBlfX19Y29uc3QgT2k9IjUuMC4xIjt2YXIgcnQ9KHI9PihyLkxvdz0iTG93IixyLkhpZ2g9IkhpZ2giLHIpKShydHx8e30pLEd0PShyPT4oci5GQVNUPSJGQVNUIixyLlBSRUNJU0U9IlBSRUNJU0UiLHIpKShHdHx8e30pLG50PShyPT4oci5DQU5WQVM9IkNBTlZBUyIsci5XRUJHTD0iV0VCR0wiLHIpKShudHx8e30pLE1pPWZ1bmN0aW9uKCl7dmFyIHI9dHlwZW9mIGRvY3VtZW50PCJ1IiYmZG9jdW1lbnQuY3VycmVudFNjcmlwdD9kb2N1bWVudC5jdXJyZW50U2NyaXB0LnNyYzp2b2lkIDA7cmV0dXJuIGZ1bmN0aW9uKHQpe3Q9dHx8e307dmFyIGU9dHlwZW9mIHQ8InUiP3Q6e30sbixvO2UucmVhZHk9bmV3IFByb21pc2UoZnVuY3Rpb24oYyxoKXtuPWMsbz1ofSk7dmFyIGk9e30scztmb3IocyBpbiBlKWUuaGFzT3duUHJvcGVydHkocykmJihpW3NdPWVbc10pO3ZhciBhPSIuL3RoaXMucHJvZ3JhbSIsdT1mdW5jdGlvbihjLGgpe3Rocm93IGh9LGY9ITAsbT0iIjtmdW5jdGlvbiBwKGMpe3JldHVybiBlLmxvY2F0ZUZpbGU/ZS5sb2NhdGVGaWxlKGMsbSk6bStjfXZhciBnO3R5cGVvZiBkb2N1bWVudDwidSImJmRvY3VtZW50LmN1cnJlbnRTY3JpcHQmJihtPWRvY3VtZW50LmN1cnJlbnRTY3JpcHQuc3JjKSxyJiYobT1yKSxtLmluZGV4T2YoImJsb2I6IikhPT0wP209bS5zdWJzdHIoMCxtLnJlcGxhY2UoL1s/I10uKi8sIiIpLmxhc3RJbmRleE9mKCIvIikrMSk6bT0iIjt2YXIgeD1lLnByaW50fHxjb25zb2xlLmxvZy5iaW5kKGNvbnNvbGUpLGQ9ZS5wcmludEVycnx8Y29uc29sZS53YXJuLmJpbmQoY29uc29sZSk7Zm9yKHMgaW4gaSlpLmhhc093blByb3BlcnR5KHMpJiYoZVtzXT1pW3NdKTtpPW51bGwsZS5hcmd1bWVudHMmJmUuYXJndW1lbnRzLGUudGhpc1Byb2dyYW0mJihhPWUudGhpc1Byb2dyYW0pLGUucXVpdCYmKHU9ZS5xdWl0KTt2YXIgXztlLndhc21CaW5hcnkmJihfPWUud2FzbUJpbmFyeSk7dmFyIEU9ZS5ub0V4aXRSdW50aW1lfHwhMDt0eXBlb2YgV2ViQXNzZW1ibHkhPSJvYmplY3QiJiZmZSgibm8gbmF0aXZlIHdhc20gc3VwcG9ydCBkZXRlY3RlZCIpO3ZhciB2LEY9ITEsaz10eXBlb2YgVGV4dERlY29kZXI8InUiP25ldyBUZXh0RGVjb2RlcigidXRmOCIpOnZvaWQgMDtmdW5jdGlvbiAkKGMsaCx5KXtmb3IodmFyIFQ9aCt5LEQ9aDtjW0RdJiYhKEQ+PVQpOykrK0Q7aWYoRC1oPjE2JiZjLnN1YmFycmF5JiZrKXJldHVybiBrLmRlY29kZShjLnN1YmFycmF5KGgsRCkpO2Zvcih2YXIgTj0iIjtoPEQ7KXt2YXIgdz1jW2grK107aWYoISh3JjEyOCkpe04rPVN0cmluZy5mcm9tQ2hhckNvZGUodyk7Y29udGludWV9dmFyIE09Y1toKytdJjYzO2lmKCh3JjIyNCk9PTE5Mil7Tis9U3RyaW5nLmZyb21DaGFyQ29kZSgodyYzMSk8PDZ8TSk7Y29udGludWV9dmFyIHE9Y1toKytdJjYzO2lmKCh3JjI0MCk9PTIyND93PSh3JjE1KTw8MTJ8TTw8NnxxOnc9KHcmNyk8PDE4fE08PDEyfHE8PDZ8Y1toKytdJjYzLHc8NjU1MzYpTis9U3RyaW5nLmZyb21DaGFyQ29kZSh3KTtlbHNle3ZhciBFbz13LTY1NTM2O04rPVN0cmluZy5mcm9tQ2hhckNvZGUoNTUyOTZ8RW8+PjEwLDU2MzIwfEVvJjEwMjMpfX1yZXR1cm4gTn1mdW5jdGlvbiB6KGMsaCl7cmV0dXJuIGM/JChjZSxjLGgpOiIifWZ1bmN0aW9uIFYoYyxoLHkpe2Zvcih2YXIgVD0wO1Q8Yy5sZW5ndGg7KytUKWJlW2grKz4+MF09Yy5jaGFyQ29kZUF0KFQpO3l8fChiZVtoPj4wXT0wKX1mdW5jdGlvbiBHKGMsaCl7cmV0dXJuIGMlaD4wJiYoYys9aC1jJWgpLGN9dmFyIEdlLGJlLGNlLFc7ZnVuY3Rpb24gcG8oYyl7R2U9YyxlLkhFQVA4PWJlPW5ldyBJbnQ4QXJyYXkoYyksZS5IRUFQMTY9bmV3IEludDE2QXJyYXkoYyksZS5IRUFQMzI9Vz1uZXcgSW50MzJBcnJheShjKSxlLkhFQVBVOD1jZT1uZXcgVWludDhBcnJheShjKSxlLkhFQVBVMTY9bmV3IFVpbnQxNkFycmF5KGMpLGUuSEVBUFUzMj1uZXcgVWludDMyQXJyYXkoYyksZS5IRUFQRjMyPW5ldyBGbG9hdDMyQXJyYXkoYyksZS5IRUFQRjY0PW5ldyBGbG9hdDY0QXJyYXkoYyl9ZS5JTklUSUFMX01FTU9SWTt2YXIgUnIsZ289W10seW89W10seG89W10sT2Y9MDtmdW5jdGlvbiBNZigpe3JldHVybiBFfHxPZj4wfWZ1bmN0aW9uIFVmKCl7aWYoZS5wcmVSdW4pZm9yKHR5cGVvZiBlLnByZVJ1bj09ImZ1bmN0aW9uIiYmKGUucHJlUnVuPVtlLnByZVJ1bl0pO2UucHJlUnVuLmxlbmd0aDspJGYoZS5wcmVSdW4uc2hpZnQoKSk7RnIoZ28pfWZ1bmN0aW9uIExmKCl7RnIoeW8pfWZ1bmN0aW9uIHpmKCl7aWYoZS5wb3N0UnVuKWZvcih0eXBlb2YgZS5wb3N0UnVuPT0iZnVuY3Rpb24iJiYoZS5wb3N0UnVuPVtlLnBvc3RSdW5dKTtlLnBvc3RSdW4ubGVuZ3RoOylXZihlLnBvc3RSdW4uc2hpZnQoKSk7RnIoeG8pfWZ1bmN0aW9uICRmKGMpe2dvLnVuc2hpZnQoYyl9ZnVuY3Rpb24gR2YoYyl7eW8udW5zaGlmdChjKX1mdW5jdGlvbiBXZihjKXt4by51bnNoaWZ0KGMpfXZhciB2ZT0wLFdlPW51bGw7ZnVuY3Rpb24gVmYoYyl7dmUrKyxlLm1vbml0b3JSdW5EZXBlbmRlbmNpZXMmJmUubW9uaXRvclJ1bkRlcGVuZGVuY2llcyh2ZSl9ZnVuY3Rpb24gSGYoYyl7aWYodmUtLSxlLm1vbml0b3JSdW5EZXBlbmRlbmNpZXMmJmUubW9uaXRvclJ1bkRlcGVuZGVuY2llcyh2ZSksdmU9PTAmJldlKXt2YXIgaD1XZTtXZT1udWxsLGgoKX19ZS5wcmVsb2FkZWRJbWFnZXM9e30sZS5wcmVsb2FkZWRBdWRpb3M9e307ZnVuY3Rpb24gZmUoYyl7ZS5vbkFib3J0JiZlLm9uQWJvcnQoYyksYz0iQWJvcnRlZCgiK2MrIikiLGQoYyksRj0hMCxjKz0iLiBCdWlsZCB3aXRoIC1zIEFTU0VSVElPTlM9MSBmb3IgbW9yZSBpbmZvLiI7dmFyIGg9bmV3IFdlYkFzc2VtYmx5LlJ1bnRpbWVFcnJvcihjKTt0aHJvdyBvKGgpLGh9dmFyIGpmPSJkYXRhOmFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbTtiYXNlNjQsIjtmdW5jdGlvbiBfbyhjKXtyZXR1cm4gYy5zdGFydHNXaXRoKGpmKX12YXIgWDtYPSJ0ZmxpdGUtc2ltZC53YXNtIixfbyhYKXx8KFg9cChYKSk7ZnVuY3Rpb24gYm8oYyl7dHJ5e2lmKGM9PVgmJl8pcmV0dXJuIG5ldyBVaW50OEFycmF5KF8pO2lmKCFnKXRocm93ImJvdGggYXN5bmMgYW5kIHN5bmMgZmV0Y2hpbmcgb2YgdGhlIHdhc20gZmFpbGVkIn1jYXRjaChoKXtmZShoKX19ZnVuY3Rpb24gWWYoKXtyZXR1cm4hXyYmZiYmdHlwZW9mIGZldGNoPT0iZnVuY3Rpb24iP2ZldGNoKFgse2NyZWRlbnRpYWxzOiJzYW1lLW9yaWdpbiJ9KS50aGVuKGZ1bmN0aW9uKGMpe2lmKCFjLm9rKXRocm93ImZhaWxlZCB0byBsb2FkIHdhc20gYmluYXJ5IGZpbGUgYXQgJyIrWCsiJyI7cmV0dXJuIGMuYXJyYXlCdWZmZXIoKX0pLmNhdGNoKGZ1bmN0aW9uKCl7cmV0dXJuIGJvKFgpfSk6UHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbigpe3JldHVybiBibyhYKX0pfWZ1bmN0aW9uIFhmKCl7dmFyIGM9e2E6cGx9O2Z1bmN0aW9uIGgodyxNKXt2YXIgcT13LmV4cG9ydHM7ZS5hc209cSx2PWUuYXNtLnEscG8odi5idWZmZXIpLFJyPWUuYXNtLkUsR2YoZS5hc20uciksSGYoKX1WZigpO2Z1bmN0aW9uIHkodyl7aCh3Lmluc3RhbmNlKX1mdW5jdGlvbiBUKHcpe3JldHVybiBZZigpLnRoZW4oZnVuY3Rpb24oTSl7cmV0dXJuIFdlYkFzc2VtYmx5Lmluc3RhbnRpYXRlKE0sYyl9KS50aGVuKGZ1bmN0aW9uKE0pe3JldHVybiBNfSkudGhlbih3LGZ1bmN0aW9uKE0pe2QoImZhaWxlZCB0byBhc3luY2hyb25vdXNseSBwcmVwYXJlIHdhc206ICIrTSksZmUoTSl9KX1mdW5jdGlvbiBEKCl7cmV0dXJuIV8mJnR5cGVvZiBXZWJBc3NlbWJseS5pbnN0YW50aWF0ZVN0cmVhbWluZz09ImZ1bmN0aW9uIiYmIV9vKFgpJiZ0eXBlb2YgZmV0Y2g9PSJmdW5jdGlvbiI/ZmV0Y2goWCx7Y3JlZGVudGlhbHM6InNhbWUtb3JpZ2luIn0pLnRoZW4oZnVuY3Rpb24odyl7dmFyIE09V2ViQXNzZW1ibHkuaW5zdGFudGlhdGVTdHJlYW1pbmcodyxjKTtyZXR1cm4gTS50aGVuKHksZnVuY3Rpb24ocSl7cmV0dXJuIGQoIndhc20gc3RyZWFtaW5nIGNvbXBpbGUgZmFpbGVkOiAiK3EpLGQoImZhbGxpbmcgYmFjayB0byBBcnJheUJ1ZmZlciBpbnN0YW50aWF0aW9uIiksVCh5KX0pfSk6VCh5KX1pZihlLmluc3RhbnRpYXRlV2FzbSl0cnl7dmFyIE49ZS5pbnN0YW50aWF0ZVdhc20oYyxoKTtyZXR1cm4gTn1jYXRjaCh3KXtyZXR1cm4gZCgiTW9kdWxlLmluc3RhbnRpYXRlV2FzbSBjYWxsYmFjayBmYWlsZWQgd2l0aCBlcnJvcjogIit3KSwhMX1yZXR1cm4gRCgpLmNhdGNoKG8pLHt9fWZ1bmN0aW9uIEZyKGMpe2Zvcig7Yy5sZW5ndGg+MDspe3ZhciBoPWMuc2hpZnQoKTtpZih0eXBlb2YgaD09ImZ1bmN0aW9uIil7aChlKTtjb250aW51ZX12YXIgeT1oLmZ1bmM7dHlwZW9mIHk9PSJudW1iZXIiP2guYXJnPT09dm9pZCAwP1JyLmdldCh5KSgpOlJyLmdldCh5KShoLmFyZyk6eShoLmFyZz09PXZvaWQgMD9udWxsOmguYXJnKX19ZnVuY3Rpb24gUWYoYyxoLHksVCl7ZmUoIkFzc2VydGlvbiBmYWlsZWQ6ICIreihjKSsiLCBhdDogIitbaD96KGgpOiJ1bmtub3duIGZpbGVuYW1lIix5LFQ/eihUKToidW5rbm93biBmdW5jdGlvbiJdKX1mdW5jdGlvbiBLZihjLGgpe2ZlKCJUbyB1c2UgZGxvcGVuLCB5b3UgbmVlZCB0byB1c2UgRW1zY3JpcHRlbidzIGxpbmtpbmcgc3VwcG9ydCwgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9lbXNjcmlwdGVuLWNvcmUvZW1zY3JpcHRlbi93aWtpL0xpbmtpbmciKX1mdW5jdGlvbiBxZihjLGgpe2ZlKCJUbyB1c2UgZGxvcGVuLCB5b3UgbmVlZCB0byB1c2UgRW1zY3JpcHRlbidzIGxpbmtpbmcgc3VwcG9ydCwgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9lbXNjcmlwdGVuLWNvcmUvZW1zY3JpcHRlbi93aWtpL0xpbmtpbmciKX1mdW5jdGlvbiBKZigpe2ZlKCIiKX12YXIgU3Q7U3Q9ZnVuY3Rpb24oKXtyZXR1cm4gcGVyZm9ybWFuY2Uubm93KCl9O3ZhciBaZj0hMDtmdW5jdGlvbiBlbChjKXtyZXR1cm4gV1t2bygpPj4yXT1jLGN9ZnVuY3Rpb24gdGwoYyxoKXt2YXIgeTtpZihjPT09MCl5PURhdGUubm93KCk7ZWxzZSBpZigoYz09PTF8fGM9PT00KSYmWmYpeT1TdCgpO2Vsc2UgcmV0dXJuIGVsKDI4KSwtMTtyZXR1cm4gV1toPj4yXT15LzFlM3wwLFdbaCs0Pj4yXT15JTFlMyoxZTMqMWUzfDAsMH1mdW5jdGlvbiBybCgpe3JldHVybiAyMTQ3NDgzNjQ4fWZ1bmN0aW9uIG5sKGMsaCx5KXtjZS5jb3B5V2l0aGluKGMsaCxoK3kpfWZ1bmN0aW9uIG9sKGMpe3RyeXtyZXR1cm4gdi5ncm93KGMtR2UuYnl0ZUxlbmd0aCs2NTUzNT4+PjE2KSxwbyh2LmJ1ZmZlciksMX1jYXRjaHt9fWZ1bmN0aW9uIGlsKGMpe3ZhciBoPWNlLmxlbmd0aDtjPWM+Pj4wO3ZhciB5PTIxNDc0ODM2NDg7aWYoYz55KXJldHVybiExO2Zvcih2YXIgVD0xO1Q8PTQ7VCo9Mil7dmFyIEQ9aCooMSsuMi9UKTtEPU1hdGgubWluKEQsYysxMDA2NjMyOTYpO3ZhciBOPU1hdGgubWluKHksRyhNYXRoLm1heChjLEQpLDY1NTM2KSksdz1vbChOKTtpZih3KXJldHVybiEwfXJldHVybiExfWZ1bmN0aW9uIHNsKGMpe2Zvcih2YXIgaD1TdCgpO1N0KCktaDxjOyk7fXZhciBQcj17fTtmdW5jdGlvbiBhbCgpe3JldHVybiBhfHwiLi90aGlzLnByb2dyYW0ifWZ1bmN0aW9uIFZlKCl7aWYoIVZlLnN0cmluZ3Mpe3ZhciBjPSh0eXBlb2YgbmF2aWdhdG9yPT0ib2JqZWN0IiYmbmF2aWdhdG9yLmxhbmd1YWdlcyYmbmF2aWdhdG9yLmxhbmd1YWdlc1swXXx8IkMiKS5yZXBsYWNlKCItIiwiXyIpKyIuVVRGLTgiLGg9e1VTRVI6IndlYl91c2VyIixMT0dOQU1FOiJ3ZWJfdXNlciIsUEFUSDoiLyIsUFdEOiIvIixIT01FOiIvaG9tZS93ZWJfdXNlciIsTEFORzpjLF86YWwoKX07Zm9yKHZhciB5IGluIFByKVByW3ldPT09dm9pZCAwP2RlbGV0ZSBoW3ldOmhbeV09UHJbeV07dmFyIFQ9W107Zm9yKHZhciB5IGluIGgpVC5wdXNoKHkrIj0iK2hbeV0pO1ZlLnN0cmluZ3M9VH1yZXR1cm4gVmUuc3RyaW5nc312YXIgUnQ9e21hcHBpbmdzOnt9LGJ1ZmZlcnM6W251bGwsW10sW11dLHByaW50Q2hhcjpmdW5jdGlvbihjLGgpe3ZhciB5PVJ0LmJ1ZmZlcnNbY107aD09PTB8fGg9PT0xMD8oKGM9PT0xP3g6ZCkoJCh5LDApKSx5Lmxlbmd0aD0wKTp5LnB1c2goaCl9LHZhcmFyZ3M6dm9pZCAwLGdldDpmdW5jdGlvbigpe1J0LnZhcmFyZ3MrPTQ7dmFyIGM9V1tSdC52YXJhcmdzLTQ+PjJdO3JldHVybiBjfSxnZXRTdHI6ZnVuY3Rpb24oYyl7dmFyIGg9eihjKTtyZXR1cm4gaH0sZ2V0NjQ6ZnVuY3Rpb24oYyxoKXtyZXR1cm4gY319O2Z1bmN0aW9uIHVsKGMsaCl7dmFyIHk9MDtyZXR1cm4gVmUoKS5mb3JFYWNoKGZ1bmN0aW9uKFQsRCl7dmFyIE49aCt5O1dbYytEKjQ+PjJdPU4sVihULE4pLHkrPVQubGVuZ3RoKzF9KSwwfWZ1bmN0aW9uIGNsKGMsaCl7dmFyIHk9VmUoKTtXW2M+PjJdPXkubGVuZ3RoO3ZhciBUPTA7cmV0dXJuIHkuZm9yRWFjaChmdW5jdGlvbihEKXtUKz1ELmxlbmd0aCsxfSksV1toPj4yXT1ULDB9ZnVuY3Rpb24gZmwoYyl7eWwoYyl9ZnVuY3Rpb24gbGwoYyl7cmV0dXJuIDB9ZnVuY3Rpb24gZGwoYyxoLHksVCxEKXt9ZnVuY3Rpb24gbWwoYyxoLHksVCl7Zm9yKHZhciBEPTAsTj0wO048eTtOKyspe2Zvcih2YXIgdz1XW2grTio4Pj4yXSxNPVdbaCsoTio4KzQpPj4yXSxxPTA7cTxNO3ErKylSdC5wcmludENoYXIoYyxjZVt3K3FdKTtEKz1NfXJldHVybiBXW1Q+PjJdPUQsMH1mdW5jdGlvbiBobCgpe2lmKHR5cGVvZiBjcnlwdG89PSJvYmplY3QiJiZ0eXBlb2YgY3J5cHRvLmdldFJhbmRvbVZhbHVlcz09ImZ1bmN0aW9uIil7dmFyIGM9bmV3IFVpbnQ4QXJyYXkoMSk7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMoYyksY1swXX19ZWxzZSByZXR1cm4gZnVuY3Rpb24oKXtmZSgicmFuZG9tRGV2aWNlIil9fWZ1bmN0aW9uIEZ0KGMsaCl7RnQucmFuZG9tRGV2aWNlfHwoRnQucmFuZG9tRGV2aWNlPWhsKCkpO2Zvcih2YXIgeT0wO3k8aDt5KyspYmVbYyt5Pj4wXT1GdC5yYW5kb21EZXZpY2UoKTtyZXR1cm4gMH12YXIgcGw9e2E6UWYsZTpLZixkOnFmLGI6SmYsbjp0bCxoOnJsLGw6bmwsbTppbCxwOnNsLGY6dWwsZzpjbCxqOmZsLGk6bGwsazpkbCxjOm1sLG86RnR9O1hmKCksZS5fX193YXNtX2NhbGxfY3RvcnM9ZnVuY3Rpb24oKXtyZXR1cm4oZS5fX193YXNtX2NhbGxfY3RvcnM9ZS5hc20ucikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxlLl9nZXRNb2RlbEJ1ZmZlck1lbW9yeU9mZnNldD1mdW5jdGlvbigpe3JldHVybihlLl9nZXRNb2RlbEJ1ZmZlck1lbW9yeU9mZnNldD1lLmFzbS5zKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGUuX2dldElucHV0TWVtb3J5T2Zmc2V0PWZ1bmN0aW9uKCl7cmV0dXJuKGUuX2dldElucHV0TWVtb3J5T2Zmc2V0PWUuYXNtLnQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sZS5fZ2V0SW5wdXRIZWlnaHQ9ZnVuY3Rpb24oKXtyZXR1cm4oZS5fZ2V0SW5wdXRIZWlnaHQ9ZS5hc20udSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxlLl9nZXRJbnB1dFdpZHRoPWZ1bmN0aW9uKCl7cmV0dXJuKGUuX2dldElucHV0V2lkdGg9ZS5hc20udikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxlLl9nZXRJbnB1dENoYW5uZWxDb3VudD1mdW5jdGlvbigpe3JldHVybihlLl9nZXRJbnB1dENoYW5uZWxDb3VudD1lLmFzbS53KS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGUuX2dldE91dHB1dE1lbW9yeU9mZnNldD1mdW5jdGlvbigpe3JldHVybihlLl9nZXRPdXRwdXRNZW1vcnlPZmZzZXQ9ZS5hc20ueCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxlLl9nZXRPdXRwdXRIZWlnaHQ9ZnVuY3Rpb24oKXtyZXR1cm4oZS5fZ2V0T3V0cHV0SGVpZ2h0PWUuYXNtLnkpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sZS5fZ2V0T3V0cHV0V2lkdGg9ZnVuY3Rpb24oKXtyZXR1cm4oZS5fZ2V0T3V0cHV0V2lkdGg9ZS5hc20ueikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxlLl9nZXRPdXRwdXRDaGFubmVsQ291bnQ9ZnVuY3Rpb24oKXtyZXR1cm4oZS5fZ2V0T3V0cHV0Q2hhbm5lbENvdW50PWUuYXNtLkEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sZS5fbG9hZE1vZGVsPWZ1bmN0aW9uKCl7cmV0dXJuKGUuX2xvYWRNb2RlbD1lLmFzbS5CKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGUuX3J1bkluZmVyZW5jZT1mdW5jdGlvbigpe3JldHVybihlLl9ydW5JbmZlcmVuY2U9ZS5hc20uQykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxlLl9pc0dQVUVuYWJsZWQ9ZnVuY3Rpb24oKXtyZXR1cm4oZS5faXNHUFVFbmFibGVkPWUuYXNtLkQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX07dmFyIHZvPWUuX19fZXJybm9fbG9jYXRpb249ZnVuY3Rpb24oKXtyZXR1cm4odm89ZS5fX19lcnJub19sb2NhdGlvbj1lLmFzbS5GKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFB0O2Z1bmN0aW9uIGdsKGMpe3RoaXMubmFtZT0iRXhpdFN0YXR1cyIsdGhpcy5tZXNzYWdlPSJQcm9ncmFtIHRlcm1pbmF0ZWQgd2l0aCBleGl0KCIrYysiKSIsdGhpcy5zdGF0dXM9Y31XZT1mdW5jdGlvbiBjKCl7UHR8fGtyKCksUHR8fChXZT1jKX07ZnVuY3Rpb24ga3IoYyl7aWYodmU+MHx8KFVmKCksdmU+MCkpcmV0dXJuO2Z1bmN0aW9uIGgoKXtQdHx8KFB0PSEwLGUuY2FsbGVkUnVuPSEwLCFGJiYoTGYoKSxuKGUpLGUub25SdW50aW1lSW5pdGlhbGl6ZWQmJmUub25SdW50aW1lSW5pdGlhbGl6ZWQoKSx6ZigpKSl9ZS5zZXRTdGF0dXM/KGUuc2V0U3RhdHVzKCJSdW5uaW5nLi4uIiksc2V0VGltZW91dChmdW5jdGlvbigpe3NldFRpbWVvdXQoZnVuY3Rpb24oKXtlLnNldFN0YXR1cygiIil9LDEpLGgoKX0sMSkpOmgoKX1lLnJ1bj1rcjtmdW5jdGlvbiB5bChjLGgpe3hsKGMpfWZ1bmN0aW9uIHhsKGMpe01mKCl8fChlLm9uRXhpdCYmZS5vbkV4aXQoYyksRj0hMCksdShjLG5ldyBnbChjKSl9aWYoZS5wcmVJbml0KWZvcih0eXBlb2YgZS5wcmVJbml0PT0iZnVuY3Rpb24iJiYoZS5wcmVJbml0PVtlLnByZUluaXRdKTtlLnByZUluaXQubGVuZ3RoPjA7KWUucHJlSW5pdC5wb3AoKSgpO3JldHVybiBrcigpLHQucmVhZHl9fSgpO2NsYXNzIFVpe2NvbnN0cnVjdG9yKCl7bCh0aGlzLCJzZWxlY3RlZFRGTGl0ZSIpO2wodGhpcywiaXNTSU1EU3VwcG9ydGVkIiwhMSk7bCh0aGlzLCJpc1RocmVhZHNTdXBwb3J0ZWQiLCExKTtsKHRoaXMsImlucHV0V2lkdGgiLDApO2wodGhpcywiaW5wdXRIZWlnaHQiLDApO2wodGhpcywiaW5wdXRDaGFubmVsQ291bnQiLDApO2wodGhpcywiaW5wdXRNZW1vcnlPZmZzZXQiLDApO2wodGhpcywib3V0cHV0V2lkdGgiLDApO2wodGhpcywib3V0cHV0SGVpZ2h0IiwwKTtsKHRoaXMsIm91dHB1dENoYW5uZWxDb3VudCIsMCk7bCh0aGlzLCJvdXRwdXRNZW1vcnlPZmZzZXQiLDApfX1jb25zdCBMaT0iaHR0cHM6Ly9kM29wcWptcXp4ZjA1Ny5jbG91ZGZyb250Lm5ldC92b25hZ2UtdGVuc29yZmxvdy13YXNtL3RmbGl0ZS1zaW1kLXdhc20vMS4xLjMvIix6aT0iaHR0cHM6Ly9kM29wcWptcXp4ZjA1Ny5jbG91ZGZyb250Lm5ldC9tbC9zZWxmaWVfc2VnbWVudGF0aW9uLzQuMC4wLyI7YXN5bmMgZnVuY3Rpb24gJGkocj1MaSx0PXppKXtsZXQgZT1uZXcgVWk7dmFyIG49bmV3IFByb21pc2UoZnVuY3Rpb24obyxpKXthc3luYyBmdW5jdGlvbiBzKCl7cmV0dXJuIE1pKHtsb2NhdGVGaWxlOmZ1bmN0aW9uKGYpe3JldHVybiByK2Z9fSl9YXN5bmMgZnVuY3Rpb24gYSh1KXtyZXR1cm4gbmV3IFByb21pc2UoYXN5bmMoZixtKT0+e2NvbnN0IHA9dTtpZih0eXBlb2YgcD4idSIpcmV0dXJuIG0oIlRGTGl0ZSBiYWNrZW5kIHVuYXZhaWxhYmxlOiB3YXNtU2ltZCIpO2NvbnN0IGc9InNlbGZpZV9zZWdtZW50YXRpb25fbGFuZHNjYXBlIjtjb25zb2xlLmxvZygiTG9hZGluZyB0ZmxpdGUgbW9kZWw6IixnKTtsZXQgeD10K2Ake2d9LnRmbGl0ZWA7Y29uc29sZS5sb2coIlRGTGl0ZSBtb2RlbFVybDogIit4KTt0cnl7Y29uc3QgXz1hd2FpdChhd2FpdCBmZXRjaCh4KSkuYXJyYXlCdWZmZXIoKTtjb25zb2xlLmxvZygiTW9kZWwgYnVmZmVyIHNpemU6IixfLmJ5dGVMZW5ndGgpO2NvbnN0IEU9cC5fZ2V0TW9kZWxCdWZmZXJNZW1vcnlPZmZzZXQoKTtjb25zb2xlLmxvZygiTW9kZWwgYnVmZmVyIG1lbW9yeSBvZmZzZXQ6IixFKSxjb25zb2xlLmxvZygiTG9hZGluZyBtb2RlbCBidWZmZXIuLi4iKSxwLkhFQVBVOC5zZXQobmV3IFVpbnQ4QXJyYXkoXyksRSk7Y29uc3Qgdj1wLl9sb2FkTW9kZWwoXy5ieXRlTGVuZ3RoKTtpZihjb25zb2xlLmxvZygiTG9hZCBtb2RlbCByZXN1bHQ6Iix2KSx2IT09MCl7bSgiQ2Fubm90IGxvYWQgbW9kZWwiKTtyZXR1cm59ZS5pbnB1dFdpZHRoPXAuX2dldElucHV0V2lkdGgoKSxlLmlucHV0SGVpZ2h0PXAuX2dldElucHV0SGVpZ2h0KCksZS5pbnB1dENoYW5uZWxDb3VudD1wLl9nZXRJbnB1dENoYW5uZWxDb3VudCgpLGUuaW5wdXRNZW1vcnlPZmZzZXQ9cC5fZ2V0SW5wdXRNZW1vcnlPZmZzZXQoKSxjb25zb2xlLmxvZygiSW5wdXQgbWVtb3J5IG9mZnNldDoiLGUuaW5wdXRNZW1vcnlPZmZzZXQpLGNvbnNvbGUubG9nKCJJbnB1dCBoZWlnaHQ6IixlLmlucHV0SGVpZ2h0KSxjb25zb2xlLmxvZygiSW5wdXQgd2lkdGg6IixlLmlucHV0V2lkdGgpLGNvbnNvbGUubG9nKCJJbnB1dCBjaGFubmVsczoiLGUuaW5wdXRDaGFubmVsQ291bnQpLGUub3V0cHV0TWVtb3J5T2Zmc2V0PXAuX2dldE91dHB1dE1lbW9yeU9mZnNldCgpLGUub3V0cHV0V2lkdGg9cC5fZ2V0T3V0cHV0V2lkdGgoKSxlLm91dHB1dEhlaWdodD1wLl9nZXRPdXRwdXRIZWlnaHQoKSxlLm91dHB1dENoYW5uZWxDb3VudD1wLl9nZXRPdXRwdXRDaGFubmVsQ291bnQoKSxjb25zb2xlLmxvZygiT3V0cHV0IG1lbW9yeSBvZmZzZXQ6IixlLm91dHB1dE1lbW9yeU9mZnNldCksY29uc29sZS5sb2coIk91dHB1dCBoZWlnaHQ6IixlLm91dHB1dEhlaWdodCksY29uc29sZS5sb2coIk91dHB1dCB3aWR0aDoiLGUub3V0cHV0V2lkdGgpLGNvbnNvbGUubG9nKCJPdXRwdXQgY2hhbm5lbHM6IixlLm91dHB1dENoYW5uZWxDb3VudCksZS5zZWxlY3RlZFRGTGl0ZT1wfWNhdGNoKGQpe20oZCk7cmV0dXJufWYoKX0pfXMoKS50aGVuKHU9PntpZih1PT09bnVsbCl0aHJvdyBjb25zb2xlLmVycm9yKCJsb2FkVEZMaXRlIG51bGwiKSwibG9hZFRGTGl0ZSBudWxsIjthKHUpLnRoZW4oZj0+e28oZSl9KS5jYXRjaChmPT57Y29uc29sZS5lcnJvcigibG9hZFRGTGl0ZU1vZGVsIGVycm9yIiksaSgibG9hZFRGTGl0ZU1vZGVsIGVycm9yIil9KX0pLmNhdGNoKHU9Pntjb25zb2xlLmVycm9yKCJsb2FkVEZMaXRlIGVycm9yOiIsdSksaSgibG9hZFRGTGl0ZSBlcnJvcjoiK3UpfSl9KTtyZXR1cm4gbn1jbGFzcyBHaXtjb25zdHJ1Y3Rvcigpe2wodGhpcywiY2FudmFzIixuZXcgT2Zmc2NyZWVuQ2FudmFzKDAsMCkpO2wodGhpcywiY29udGV4dCIsdGhpcy5jYW52YXMuZ2V0Q29udGV4dCgiMmQiLHt3aWxsUmVhZEZyZXF1ZW50bHk6ITB9KSk7bCh0aGlzLCJwaXhlbENvdW50IiwwKTtsKHRoaXMsImlucHV0T2Zmc2V0IiwwKTtsKHRoaXMsIm91dHB1dE9mZnNldCIsMCk7bCh0aGlzLCJpbmZvcyIpO2wodGhpcywibWFzayIpfWFzeW5jIGluaXQodCxlKXthd2FpdCB0aGlzLmluaXRXYXNtKHQsZSksdGhpcy5pbmZvcyYmKHRoaXMuY2FudmFzLndpZHRoPXRoaXMuaW5mb3MuaW5wdXRXaWR0aCx0aGlzLmNhbnZhcy5oZWlnaHQ9dGhpcy5pbmZvcy5pbnB1dEhlaWdodCx0aGlzLnBpeGVsQ291bnQ9dGhpcy5pbmZvcy5pbnB1dFdpZHRoKnRoaXMuaW5mb3MuaW5wdXRIZWlnaHQsdGhpcy5tYXNrPW5ldyBJbWFnZURhdGEodGhpcy5pbmZvcy5pbnB1dFdpZHRoLHRoaXMuaW5mb3MuaW5wdXRIZWlnaHQpLHRoaXMuaW5wdXRPZmZzZXQ9dGhpcy5pbmZvcy5pbnB1dE1lbW9yeU9mZnNldC80LHRoaXMub3V0cHV0T2Zmc2V0PXRoaXMuaW5mb3Mub3V0cHV0TWVtb3J5T2Zmc2V0LzQpfWFzeW5jIGluaXRXYXNtKHQsZSl7dGhpcy5pbmZvcz1hd2FpdCAkaSh0LGUpfWdldE91dHB1dERpbWVuc2lvbnMoKXt2YXIgdCxlLG4sbztyZXR1cm57d2lkdGg6KGU9KHQ9dGhpcy5pbmZvcyk9PW51bGw/dm9pZCAwOnQub3V0cHV0V2lkdGgpIT1udWxsP2U6MCxoZWlnaHQ6KG89KG49dGhpcy5pbmZvcyk9PW51bGw/dm9pZCAwOm4ub3V0cHV0SGVpZ2h0KSE9bnVsbD9vOjB9fWFzeW5jIHByb2Nlc3ModCl7aWYoIXRoaXMubWFza3x8IXRoaXMuaW5mb3MpcmV0dXJuO2NvbnN0IGU9dGhpcy5pbmZvcy5pbnB1dFdpZHRoLG49dGhpcy5pbmZvcy5pbnB1dEhlaWdodDt0aGlzLmNvbnRleHQuZHJhd0ltYWdlKHQsMCwwLHQud2lkdGgsdC5oZWlnaHQsMCwwLGUsbik7Y29uc3Qgbz10aGlzLmNvbnRleHQuZ2V0SW1hZ2VEYXRhKDAsMCxlLG4pLGk9dGhpcy5pbmZvcy5zZWxlY3RlZFRGTGl0ZS5IRUFQRjMyO2ZvcihsZXQgcz0wO3M8dGhpcy5waXhlbENvdW50O3MrKyl7Y29uc3QgYT10aGlzLmlucHV0T2Zmc2V0K3MqMztpW2FdPW8uZGF0YVtzKjRdLzI1NSxpW2ErMV09by5kYXRhW3MqNCsxXS8yNTUsaVthKzJdPW8uZGF0YVtzKjQrMl0vMjU1fXRoaXMuaW5mb3Muc2VsZWN0ZWRURkxpdGUuX3J1bkluZmVyZW5jZSgpO2ZvcihsZXQgcz0wO3M8dGhpcy5waXhlbENvdW50O3MrKyl7Y29uc3QgYT10aGlzLmluZm9zLnNlbGVjdGVkVEZMaXRlLkhFQVBGMzJbdGhpcy5vdXRwdXRPZmZzZXQrc107dGhpcy5tYXNrLmRhdGFbcyo0XT10aGlzLm1hc2suZGF0YVtzKjQrM109MjU1KmF9cmV0dXJuIGNyZWF0ZUltYWdlQml0bWFwKHRoaXMubWFzayl9aXNHcHVTdXBwb3J0ZWQoKXt2YXIgdCxlLG47cmV0dXJuKG49KGU9KHQ9dGhpcy5pbmZvcyk9PW51bGw/dm9pZCAwOnQuc2VsZWN0ZWRURkxpdGUpPT1udWxsP3ZvaWQgMDplLl9pc0dQVUVuYWJsZWQoKSkhPW51bGw/bjohMX19ZnVuY3Rpb24gV2koKXtyZXR1cm4gbmV3IE9mZnNjcmVlbkNhbnZhcygwLDApLmdldENvbnRleHQoIndlYmdsMiIse2ZhaWxJZk1ham9yUGVyZm9ybWFuY2VDYXZlYXQ6ITB9KT97c3VwcG9ydGVkOiEwfTp7c3VwcG9ydGVkOiExLG1lc3NhZ2U6IllvdXIgaGFyZHdhcmUgZG9lcyBub3QgcGVyZm9ybSBnb29kIGVub3VnaCB0byBydW4gdGhlIGxpYnJhcnkgZWZmaWNpZW50bHkifX1jbGFzcyBXdHtjb25zdHJ1Y3Rvcigpe2wodGhpcywiY2FudmFzIik7bCh0aGlzLCJjb250ZXh0Iik7Y29uc3QgdD1uZXcgT2Zmc2NyZWVuQ2FudmFzKDAsMCksZT10LmdldENvbnRleHQoIjJkIik7aWYoIWUpdGhyb3ciRmFpbCB0byByZXRyaWV2ZSB3ZWJnbDIgY29udGV4dCI7dGhpcy5jYW52YXM9dCx0aGlzLmNvbnRleHQ9ZX1zZXRGbGlja2VyaW5nT3B0aW9ucyh0KXt9ZW5hYmxlUG9zdFByb2Nlc3NpbmcoKXt9ZGlzYWJsZVBvc3RQcm9jZXNzaW5nKCl7fWFzeW5jIHByb2ZpbGVXZWJnbCh0KXtyZXR1cm5bXX1hc3luYyByZW5kZXIodCxlKXtyZXR1cm4gdGhpcy5jYW52YXN9cmVzaXplQ2FudmFzKHQpe2NvbnN0e3dpZHRoOmUsaGVpZ2h0Om59PXQ7dGhpcy5jYW52YXMud2lkdGg9ZSx0aGlzLmNhbnZhcy5oZWlnaHQ9bn1yZW5kZXJTaWxob3VldHRlKHQsZSxuPSJub25lIil7Y29uc3R7d2lkdGg6byxoZWlnaHQ6aX09dDt0aGlzLmNvbnRleHQuc2F2ZSgpLHRoaXMuY29udGV4dC5kcmF3SW1hZ2UoZSwwLDAsZS53aWR0aCxlLmhlaWdodCwwLDAsbyxpKSx0aGlzLmNvbnRleHQuZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uPSJzb3VyY2UtaW4iLHRoaXMuY29udGV4dC5maWx0ZXI9bix0aGlzLmNvbnRleHQuZHJhd0ltYWdlKHQsMCwwLG8saSwwLDAsdGhpcy5jYW52YXMud2lkdGgsdGhpcy5jYW52YXMuaGVpZ2h0KSx0aGlzLmNvbnRleHQucmVzdG9yZSgpfX1jbGFzcyBWaSBleHRlbmRzIFd0e2NvbnN0cnVjdG9yKHQpe3N1cGVyKCksdGhpcy5yYWRpdXM9dH1hc3luYyByZW5kZXIodCxlKXtyZXR1cm4gc3VwZXIucmVzaXplQ2FudmFzKHQpLHRoaXMucmVuZGVyU2lsaG91ZXR0ZSh0LGUpLHRoaXMuY29udGV4dC5zYXZlKCksdGhpcy5jb250ZXh0LmZpbHRlcj1gYmx1cigke3RoaXMucmFkaXVzfXB4KWAsdGhpcy5jb250ZXh0Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbj0iZGVzdGluYXRpb24tb3ZlciIsdGhpcy5jb250ZXh0LmRyYXdJbWFnZSh0LDAsMCx0LndpZHRoLHQuaGVpZ2h0KSx0aGlzLmNvbnRleHQucmVzdG9yZSgpLHN1cGVyLnJlbmRlcih0LGUpfX1jbGFzcyBIaSBleHRlbmRzIFd0e2NvbnN0cnVjdG9yKHQpe3N1cGVyKCksdGhpcy5yYWRpdXM9dH1hc3luYyByZW5kZXIodCxlKXtyZXR1cm4gc3VwZXIucmVzaXplQ2FudmFzKHQpLHRoaXMucmVuZGVyU2lsaG91ZXR0ZSh0LGUsYGJsdXIoJHt0aGlzLnJhZGl1c31weClgKSx0aGlzLmNvbnRleHQuc2F2ZSgpLHRoaXMuY29udGV4dC5maWx0ZXI9Im5vbmUiLHRoaXMuY29udGV4dC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb249ImRlc3RpbmF0aW9uLW92ZXIiLHRoaXMuY29udGV4dC5kcmF3SW1hZ2UodCwwLDAsdC53aWR0aCx0LmhlaWdodCksdGhpcy5jb250ZXh0LnJlc3RvcmUoKSxzdXBlci5yZW5kZXIodCxlKX19Y2xhc3MgamkgZXh0ZW5kcyBXdHtjb25zdHJ1Y3Rvcigpe3N1cGVyKC4uLmFyZ3VtZW50cyk7bCh0aGlzLCJiYWNrZ3JvdW5kSW1hZ2UiKX1zZXRCYWNrZ3JvdW5kSW1hZ2UoZSl7dGhpcy5iYWNrZ3JvdW5kSW1hZ2U9ZX1hc3luYyByZW5kZXIoZSxuKXtyZXR1cm4gc3VwZXIucmVzaXplQ2FudmFzKGUpLHRoaXMucmVuZGVyU2lsaG91ZXR0ZShlLG4pLHRoaXMuYmFja2dyb3VuZEltYWdlJiYodGhpcy5jb250ZXh0LnNhdmUoKSx0aGlzLmNvbnRleHQuZmlsdGVyPSJub25lIix0aGlzLmNvbnRleHQuZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uPSJkZXN0aW5hdGlvbi1vdmVyIix0aGlzLmNvbnRleHQuZHJhd0ltYWdlKHRoaXMuYmFja2dyb3VuZEltYWdlLDAsMCx0aGlzLmJhY2tncm91bmRJbWFnZS53aWR0aCx0aGlzLmJhY2tncm91bmRJbWFnZS5oZWlnaHQsMCwwLGUud2lkdGgsZS5oZWlnaHQpLHRoaXMuY29udGV4dC5yZXN0b3JlKCkpLHN1cGVyLnJlbmRlcihlLG4pfX0vKiBAbGljZW5zZSB0d2dsLmpzIDUuMi4wIENvcHlyaWdodCAoYykgMjAxNSwgR3JlZ2cgVGF2YXJlcyBBbGwgUmlnaHRzIFJlc2VydmVkLgpBdmFpbGFibGUgdmlhIHRoZSBNSVQgbGljZW5zZS4Kc2VlOiBodHRwOi8vZ2l0aHViLmNvbS9ncmVnZ21hbi90d2dsLmpzIGZvciBkZXRhaWxzICovY29uc3QgVnQ9NTEyMCxCZT01MTIxLEh0PTUxMjIsanQ9NTEyMyxZdD01MTI0LFh0PTUxMjUsUXQ9NTEyNixZaT0zMjgxOSxYaT0zMjgyMCxRaT0zMzYzNSxLaT01MTMxLHFpPTMzNjQwLEppPTM1ODk5LFppPTM1OTAyLGVzPTM2MjY5LHRzPTM0MDQyLGpyPXt9O3tjb25zdCByPWpyO3JbVnRdPUludDhBcnJheSxyW0JlXT1VaW50OEFycmF5LHJbSHRdPUludDE2QXJyYXkscltqdF09VWludDE2QXJyYXkscltZdF09SW50MzJBcnJheSxyW1h0XT1VaW50MzJBcnJheSxyW1F0XT1GbG9hdDMyQXJyYXkscltZaV09VWludDE2QXJyYXkscltYaV09VWludDE2QXJyYXkscltRaV09VWludDE2QXJyYXkscltLaV09VWludDE2QXJyYXkscltxaV09VWludDMyQXJyYXkscltKaV09VWludDMyQXJyYXkscltaaV09VWludDMyQXJyYXkscltlc109VWludDMyQXJyYXksclt0c109VWludDMyQXJyYXl9ZnVuY3Rpb24gS3Qocil7aWYociBpbnN0YW5jZW9mIEludDhBcnJheSlyZXR1cm4gVnQ7aWYociBpbnN0YW5jZW9mIFVpbnQ4QXJyYXl8fHIgaW5zdGFuY2VvZiBVaW50OENsYW1wZWRBcnJheSlyZXR1cm4gQmU7aWYociBpbnN0YW5jZW9mIEludDE2QXJyYXkpcmV0dXJuIEh0O2lmKHIgaW5zdGFuY2VvZiBVaW50MTZBcnJheSlyZXR1cm4ganQ7aWYociBpbnN0YW5jZW9mIEludDMyQXJyYXkpcmV0dXJuIFl0O2lmKHIgaW5zdGFuY2VvZiBVaW50MzJBcnJheSlyZXR1cm4gWHQ7aWYociBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheSlyZXR1cm4gUXQ7dGhyb3cgbmV3IEVycm9yKCJ1bnN1cHBvcnRlZCB0eXBlZCBhcnJheSB0eXBlIil9ZnVuY3Rpb24gWXIocil7aWYocj09PUludDhBcnJheSlyZXR1cm4gVnQ7aWYocj09PVVpbnQ4QXJyYXl8fHI9PT1VaW50OENsYW1wZWRBcnJheSlyZXR1cm4gQmU7aWYocj09PUludDE2QXJyYXkpcmV0dXJuIEh0O2lmKHI9PT1VaW50MTZBcnJheSlyZXR1cm4ganQ7aWYocj09PUludDMyQXJyYXkpcmV0dXJuIFl0O2lmKHI9PT1VaW50MzJBcnJheSlyZXR1cm4gWHQ7aWYocj09PUZsb2F0MzJBcnJheSlyZXR1cm4gUXQ7dGhyb3cgbmV3IEVycm9yKCJ1bnN1cHBvcnRlZCB0eXBlZCBhcnJheSB0eXBlIil9ZnVuY3Rpb24gWHIocil7Y29uc3QgdD1qcltyXTtpZighdCl0aHJvdyBuZXcgRXJyb3IoInVua25vd24gZ2wgdHlwZSIpO3JldHVybiB0fWNvbnN0IG90PXR5cGVvZiBTaGFyZWRBcnJheUJ1ZmZlcjwidSI/ZnVuY3Rpb24odCl7cmV0dXJuIHQmJnQuYnVmZmVyJiYodC5idWZmZXIgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcnx8dC5idWZmZXIgaW5zdGFuY2VvZiBTaGFyZWRBcnJheUJ1ZmZlcil9OmZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0LmJ1ZmZlciYmdC5idWZmZXIgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcn07ZnVuY3Rpb24gUXIoLi4ucil7Y29uc29sZS5lcnJvciguLi5yKX1jb25zdCBLcj1uZXcgTWFwO2Z1bmN0aW9uIGl0KHIsdCl7aWYoIXJ8fHR5cGVvZiByIT0ib2JqZWN0IilyZXR1cm4hMTtsZXQgZT1Lci5nZXQodCk7ZXx8KGU9bmV3IFdlYWtNYXAsS3Iuc2V0KHQsZSkpO2xldCBuPWUuZ2V0KHIpO2lmKG49PT12b2lkIDApe2NvbnN0IG89T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHIpO249by5zdWJzdHJpbmcoOCxvLmxlbmd0aC0xKT09PXQsZS5zZXQocixuKX1yZXR1cm4gbn1mdW5jdGlvbiBycyhyLHQpe3JldHVybiB0eXBlb2YgV2ViR0xCdWZmZXI8InUiJiZpdCh0LCJXZWJHTEJ1ZmZlciIpfWZ1bmN0aW9uIG5zKHIsdCl7cmV0dXJuIHR5cGVvZiBXZWJHTFJlbmRlcmJ1ZmZlcjwidSImJml0KHQsIldlYkdMUmVuZGVyYnVmZmVyIil9ZnVuY3Rpb24gcXQocix0KXtyZXR1cm4gdHlwZW9mIFdlYkdMVGV4dHVyZTwidSImJml0KHQsIldlYkdMVGV4dHVyZSIpfWZ1bmN0aW9uIG9zKHIsdCl7cmV0dXJuIHR5cGVvZiBXZWJHTFNhbXBsZXI8InUiJiZpdCh0LCJXZWJHTFNhbXBsZXIiKX1jb25zdCBxcj0zNTA0NCxoZT0zNDk2Mixpcz0zNDk2Myxzcz0zNDY2MCxhcz01MTIwLHVzPTUxMjEsY3M9NTEyMixmcz01MTIzLGxzPTUxMjQsZHM9NTEyNSxKcj01MTI2LFpyPXthdHRyaWJQcmVmaXg6IiJ9O2Z1bmN0aW9uIG1zKHIsdCxlLG4sbyl7ci5iaW5kQnVmZmVyKHQsZSksci5idWZmZXJEYXRhKHQsbixvfHxxcil9ZnVuY3Rpb24gZW4ocix0LGUsbil7aWYocnMocix0KSlyZXR1cm4gdDtlPWV8fGhlO2NvbnN0IG89ci5jcmVhdGVCdWZmZXIoKTtyZXR1cm4gbXMocixlLG8sdCxuKSxvfWZ1bmN0aW9uIHRuKHIpe3JldHVybiByPT09ImluZGljZXMifWZ1bmN0aW9uIGhzKHIpe3JldHVybiByPT09SW50OEFycmF5fHxyPT09VWludDhBcnJheX1mdW5jdGlvbiBwcyhyKXtyZXR1cm4gci5sZW5ndGg/cjpyLmRhdGF9Y29uc3QgZ3M9L2Nvb3JkfHRleHR1cmUvaSx5cz0vY29sb3J8Y29sb3VyL2k7ZnVuY3Rpb24geHMocix0KXtsZXQgZTtpZihncy50ZXN0KHIpP2U9Mjp5cy50ZXN0KHIpP2U9NDplPTMsdCVlPjApdGhyb3cgbmV3IEVycm9yKGBDYW4gbm90IGd1ZXNzIG51bUNvbXBvbmVudHMgZm9yIGF0dHJpYnV0ZSAnJHtyfScuIFRyaWVkICR7ZX0gYnV0ICR7dH0gdmFsdWVzIGlzIG5vdCBldmVubHkgZGl2aXNpYmxlIGJ5ICR7ZX0uIFlvdSBzaG91bGQgc3BlY2lmeSBpdC5gKTtyZXR1cm4gZX1mdW5jdGlvbiBfcyhyLHQsZSl7cmV0dXJuIHIubnVtQ29tcG9uZW50c3x8ci5zaXplfHx4cyh0LGV8fHBzKHIpLmxlbmd0aCl9ZnVuY3Rpb24gcm4ocix0KXtpZihvdChyKSlyZXR1cm4gcjtpZihvdChyLmRhdGEpKXJldHVybiByLmRhdGE7QXJyYXkuaXNBcnJheShyKSYmKHI9e2RhdGE6cn0pO2xldCBlPXIudHlwZT9KdChyLnR5cGUpOnZvaWQgMDtyZXR1cm4gZXx8KHRuKHQpP2U9VWludDE2QXJyYXk6ZT1GbG9hdDMyQXJyYXkpLG5ldyBlKHIuZGF0YSl9ZnVuY3Rpb24gYnMocil7cmV0dXJuIHR5cGVvZiByPT0ibnVtYmVyIj9yOnI/WXIocik6SnJ9ZnVuY3Rpb24gSnQocil7cmV0dXJuIHR5cGVvZiByPT0ibnVtYmVyIj9YcihyKTpyfHxGbG9hdDMyQXJyYXl9ZnVuY3Rpb24gdnMocix0KXtyZXR1cm57YnVmZmVyOnQuYnVmZmVyLG51bVZhbHVlczoyKjMqNCx0eXBlOmJzKHQudHlwZSksYXJyYXlUeXBlOkp0KHQudHlwZSl9fWZ1bmN0aW9uIEVzKHIsdCl7Y29uc3QgZT10LmRhdGF8fHQsbj1KdCh0LnR5cGUpLG89ZSpuLkJZVEVTX1BFUl9FTEVNRU5ULGk9ci5jcmVhdGVCdWZmZXIoKTtyZXR1cm4gci5iaW5kQnVmZmVyKGhlLGkpLHIuYnVmZmVyRGF0YShoZSxvLHQuZHJhd1R5cGV8fHFyKSx7YnVmZmVyOmksbnVtVmFsdWVzOmUsdHlwZTpZcihuKSxhcnJheVR5cGU6bn19ZnVuY3Rpb24gVHMocix0LGUpe2NvbnN0IG49cm4odCxlKTtyZXR1cm57YXJyYXlUeXBlOm4uY29uc3RydWN0b3IsYnVmZmVyOmVuKHIsbix2b2lkIDAsdC5kcmF3VHlwZSksdHlwZTpLdChuKSxudW1WYWx1ZXM6MH19ZnVuY3Rpb24gQXMocix0KXtjb25zdCBlPXt9O3JldHVybiBPYmplY3Qua2V5cyh0KS5mb3JFYWNoKGZ1bmN0aW9uKG4pe2lmKCF0bihuKSl7Y29uc3Qgbz10W25dLGk9by5hdHRyaWJ8fG8ubmFtZXx8by5hdHRyaWJOYW1lfHxaci5hdHRyaWJQcmVmaXgrbjtpZihvLnZhbHVlKXtpZighQXJyYXkuaXNBcnJheShvLnZhbHVlKSYmIW90KG8udmFsdWUpKXRocm93IG5ldyBFcnJvcigiYXJyYXkudmFsdWUgaXMgbm90IGFycmF5IG9yIHR5cGVkYXJyYXkiKTtlW2ldPXt2YWx1ZTpvLnZhbHVlfX1lbHNle2xldCBzO28uYnVmZmVyJiZvLmJ1ZmZlciBpbnN0YW5jZW9mIFdlYkdMQnVmZmVyP3M9dnM6dHlwZW9mIG89PSJudW1iZXIifHx0eXBlb2Ygby5kYXRhPT0ibnVtYmVyIj9zPUVzOnM9VHM7Y29uc3R7YnVmZmVyOmEsdHlwZTp1LG51bVZhbHVlczpmLGFycmF5VHlwZTptfT1zKHIsbyxuKSxwPW8ubm9ybWFsaXplIT09dm9pZCAwP28ubm9ybWFsaXplOmhzKG0pLGc9X3MobyxuLGYpO2VbaV09e2J1ZmZlcjphLG51bUNvbXBvbmVudHM6Zyx0eXBlOnUsbm9ybWFsaXplOnAsc3RyaWRlOm8uc3RyaWRlfHwwLG9mZnNldDpvLm9mZnNldHx8MCxkaXZpc29yOm8uZGl2aXNvcj09PXZvaWQgMD92b2lkIDA6by5kaXZpc29yLGRyYXdUeXBlOm8uZHJhd1R5cGV9fX19KSxyLmJpbmRCdWZmZXIoaGUsbnVsbCksZX1mdW5jdGlvbiB3cyhyLHQpe3JldHVybiB0PT09YXN8fHQ9PT11cz8xOnQ9PT1jc3x8dD09PWZzPzI6dD09PWxzfHx0PT09ZHN8fHQ9PT1Kcj80OjB9Y29uc3QgWnQ9WyJwb3NpdGlvbiIsInBvc2l0aW9ucyIsImFfcG9zaXRpb24iXTtmdW5jdGlvbiBJcyhyLHQpe2xldCBlLG47Zm9yKG49MDtuPFp0Lmxlbmd0aCYmKGU9WnRbbl0sIShlIGluIHR8fChlPVpyLmF0dHJpYlByZWZpeCtlLGUgaW4gdCkpKTsrK24pO249PT1adC5sZW5ndGgmJihlPU9iamVjdC5rZXlzKHQpWzBdKTtjb25zdCBvPXRbZV07aWYoIW8uYnVmZmVyKXJldHVybiAxO3IuYmluZEJ1ZmZlcihoZSxvLmJ1ZmZlcik7Y29uc3QgaT1yLmdldEJ1ZmZlclBhcmFtZXRlcihoZSxzcyk7ci5iaW5kQnVmZmVyKGhlLG51bGwpO2NvbnN0IHM9d3MocixvLnR5cGUpLGE9aS9zLHU9by5udW1Db21wb25lbnRzfHxvLnNpemUsZj1hL3U7aWYoZiUxIT09MCl0aHJvdyBuZXcgRXJyb3IoYG51bUNvbXBvbmVudHMgJHt1fSBub3QgY29ycmVjdCBmb3IgbGVuZ3RoICR7bGVuZ3RofWApO3JldHVybiBmfWZ1bmN0aW9uIFNzKHIsdCxlKXtjb25zdCBuPUFzKHIsdCksbz1PYmplY3QuYXNzaWduKHt9LGV8fHt9KTtvLmF0dHJpYnM9T2JqZWN0LmFzc2lnbih7fSxlP2UuYXR0cmliczp7fSxuKTtjb25zdCBpPXQuaW5kaWNlcztpZihpKXtjb25zdCBzPXJuKGksImluZGljZXMiKTtvLmluZGljZXM9ZW4ocixzLGlzKSxvLm51bUVsZW1lbnRzPXMubGVuZ3RoLG8uZWxlbWVudFR5cGU9S3Qocyl9ZWxzZSBvLm51bUVsZW1lbnRzfHwoby5udW1FbGVtZW50cz1JcyhyLG8uYXR0cmlicykpO3JldHVybiBvfWZ1bmN0aW9uIE5lKHIpe3JldHVybiEhci50ZXhTdG9yYWdlMkR9Y29uc3Qgbm49ZnVuY3Rpb24oKXtjb25zdCByPXt9LHQ9e307ZnVuY3Rpb24gZShuKXtjb25zdCBvPW4uY29uc3RydWN0b3IubmFtZTtpZighcltvXSl7Zm9yKGNvbnN0IGkgaW4gbilpZih0eXBlb2YgbltpXT09Im51bWJlciIpe2NvbnN0IHM9dFtuW2ldXTt0W25baV1dPXM/YCR7c30gfCAke2l9YDppfXJbb109ITB9fXJldHVybiBmdW5jdGlvbihvLGkpe3JldHVybiBlKG8pLHRbaV18fCh0eXBlb2YgaT09Im51bWJlciI/YDB4JHtpLnRvU3RyaW5nKDE2KX1gOmkpfX0oKSxuZT17dGV4dHVyZUNvbG9yOm5ldyBVaW50OEFycmF5KFsxMjgsMTkyLDI1NSwyNTVdKSx0ZXh0dXJlT3B0aW9uczp7fSxjcm9zc09yaWdpbjp2b2lkIDB9LE9lPW90LG9uPWZ1bmN0aW9uKCl7bGV0IHI7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHI9cnx8KHR5cGVvZiBkb2N1bWVudDwidSImJmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQ/ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIikuZ2V0Q29udGV4dCgiMmQiKTpudWxsKSxyfX0oKSxzbj02NDA2LEs9NjQwNyxSPTY0MDgsYW49NjQwOSx1bj02NDEwLE1lPTY0MDIsY249MzQwNDEsc3Q9MzMwNzEsUnM9OTcyOCxGcz05NzI5LG9lPTM1NTMsaWU9MzQwNjcscGU9MzI4NzksZ2U9MzU4NjYsZXI9MzQwNjksUHM9MzQwNzAsa3M9MzQwNzEsRHM9MzQwNzIsQ3M9MzQwNzMsQnM9MzQwNzQsdHI9MTAyNDEscnI9MTAyNDAsYXQ9MTAyNDIsdXQ9MTAyNDMsZm49MzI4ODIsTnM9MzMwODIsT3M9MzMwODMsTXM9MzMwODQsVXM9MzMwODUsbnI9MzMxNyxsbj0zMzE0LGRuPTMyODc4LG1uPTMzMTYsaG49MzMxNSxwbj0zMjg3NyxMcz0zNzQ0Myx6cz0zNzQ0MSwkcz0zNzQ0MCxHcz0zMzMyMSxXcz0zNjc1NixWcz0zMzMyNSxIcz0zMzMyNixqcz0zMzMzMCxZcz0zMzMyOSxYcz0zMzMzOCxRcz0zMzMzNyxLcz0zMzM0MCxxcz0zMzMzOSxKcz0zMzMyMyxacz0zNjc1NyxlYT0zMzMyNyx0YT0zMzMyOCxyYT0zMzMzNixuYT0zMzMzNSxvYT0zMzMzMixpYT0zMzMzMSxzYT0zMzMzNCxhYT0zMzMzMyx1YT0zMjg0OSxjYT0zNTkwNSxmYT0zNjE5NCxsYT0zNjc1OCxkYT0zNTg5OCxtYT0zNTkwMSxoYT0zNDg0MyxwYT0zNDgzNyxnYT0zNjIyMSx5YT0zNjIzOSx4YT0zNjIxNSxfYT0zNjIzMyxiYT0zNjIwOSx2YT0zNjIyNyxFYT0zMjg1NixUYT0zNTkwNyxBYT0zNjc1OSx3YT0zMjg1NSxJYT0zMjg1NCxTYT0zMjg1NyxSYT0zNDg0MixGYT0zNDgzNixQYT0zNjIyMCxrYT0zNjIzOCxEYT0zNjk3NSxDYT0zNjIxNCxCYT0zNjIzMixOYT0zNjIyNixPYT0zNjIwOCxNYT0zMzE4OSxVYT0zMzE5MCxMYT0zNjAxMix6YT0zNjAxMywkYT0zNTA1NixzZT01MTIwLFM9NTEyMSxjdD01MTIyLEFlPTUxMjMsZnQ9NTEyNCx5ZT01MTI1LE89NTEyNixnbj0zMjgxOSx5bj0zMjgyMCx4bj0zMzYzNSxqPTUxMzEsVWU9MzYxOTMsb3I9MzM2NDAsR2E9MzU4OTksV2E9MzU5MDIsVmE9MzYyNjksSGE9MzQwNDIsbHQ9MzMzMTksd2U9MzMzMjAsZHQ9NjQwMyxJZT0zNjI0NCxTZT0zNjI0OCx4ZT0zNjI0OTtsZXQgaXI7ZnVuY3Rpb24gbXQocil7aWYoIWlyKXtjb25zdCB0PXt9O3Rbc25dPXt0ZXh0dXJlRm9ybWF0OnNuLGNvbG9yUmVuZGVyYWJsZTohMCx0ZXh0dXJlRmlsdGVyYWJsZTohMCxieXRlc1BlckVsZW1lbnQ6WzEsMiwyLDRdLHR5cGU6W1MsaixVZSxPXX0sdFthbl09e3RleHR1cmVGb3JtYXQ6YW4sY29sb3JSZW5kZXJhYmxlOiEwLHRleHR1cmVGaWx0ZXJhYmxlOiEwLGJ5dGVzUGVyRWxlbWVudDpbMSwyLDIsNF0sdHlwZTpbUyxqLFVlLE9dfSx0W3VuXT17dGV4dHVyZUZvcm1hdDp1bixjb2xvclJlbmRlcmFibGU6ITAsdGV4dHVyZUZpbHRlcmFibGU6ITAsYnl0ZXNQZXJFbGVtZW50OlsyLDQsNCw4XSx0eXBlOltTLGosVWUsT119LHRbS109e3RleHR1cmVGb3JtYXQ6Syxjb2xvclJlbmRlcmFibGU6ITAsdGV4dHVyZUZpbHRlcmFibGU6ITAsYnl0ZXNQZXJFbGVtZW50OlszLDYsNiwxMiwyXSx0eXBlOltTLGosVWUsTyx4bl19LHRbUl09e3RleHR1cmVGb3JtYXQ6Uixjb2xvclJlbmRlcmFibGU6ITAsdGV4dHVyZUZpbHRlcmFibGU6ITAsYnl0ZXNQZXJFbGVtZW50Ols0LDgsOCwxNiwyLDJdLHR5cGU6W1MsaixVZSxPLGduLHluXX0sdFtNZV09e3RleHR1cmVGb3JtYXQ6TWUsY29sb3JSZW5kZXJhYmxlOiEwLHRleHR1cmVGaWx0ZXJhYmxlOiExLGJ5dGVzUGVyRWxlbWVudDpbMiw0XSx0eXBlOlt5ZSxBZV19LHRbR3NdPXt0ZXh0dXJlRm9ybWF0OmR0LGNvbG9yUmVuZGVyYWJsZTohMCx0ZXh0dXJlRmlsdGVyYWJsZTohMCxieXRlc1BlckVsZW1lbnQ6WzFdLHR5cGU6W1NdfSx0W1dzXT17dGV4dHVyZUZvcm1hdDpkdCxjb2xvclJlbmRlcmFibGU6ITEsdGV4dHVyZUZpbHRlcmFibGU6ITAsYnl0ZXNQZXJFbGVtZW50OlsxXSx0eXBlOltzZV19LHRbVnNdPXt0ZXh0dXJlRm9ybWF0OmR0LGNvbG9yUmVuZGVyYWJsZTohMSx0ZXh0dXJlRmlsdGVyYWJsZTohMCxieXRlc1BlckVsZW1lbnQ6WzQsMl0sdHlwZTpbTyxqXX0sdFtIc109e3RleHR1cmVGb3JtYXQ6ZHQsY29sb3JSZW5kZXJhYmxlOiExLHRleHR1cmVGaWx0ZXJhYmxlOiExLGJ5dGVzUGVyRWxlbWVudDpbNF0sdHlwZTpbT119LHRbanNdPXt0ZXh0dXJlRm9ybWF0OkllLGNvbG9yUmVuZGVyYWJsZTohMCx0ZXh0dXJlRmlsdGVyYWJsZTohMSxieXRlc1BlckVsZW1lbnQ6WzFdLHR5cGU6W1NdfSx0W1lzXT17dGV4dHVyZUZvcm1hdDpJZSxjb2xvclJlbmRlcmFibGU6ITAsdGV4dHVyZUZpbHRlcmFibGU6ITEsYnl0ZXNQZXJFbGVtZW50OlsxXSx0eXBlOltzZV19LHRbb2FdPXt0ZXh0dXJlRm9ybWF0OkllLGNvbG9yUmVuZGVyYWJsZTohMCx0ZXh0dXJlRmlsdGVyYWJsZTohMSxieXRlc1BlckVsZW1lbnQ6WzJdLHR5cGU6W0FlXX0sdFtpYV09e3RleHR1cmVGb3JtYXQ6SWUsY29sb3JSZW5kZXJhYmxlOiEwLHRleHR1cmVGaWx0ZXJhYmxlOiExLGJ5dGVzUGVyRWxlbWVudDpbMl0sdHlwZTpbY3RdfSx0W3NhXT17dGV4dHVyZUZvcm1hdDpJZSxjb2xvclJlbmRlcmFibGU6ITAsdGV4dHVyZUZpbHRlcmFibGU6ITEsYnl0ZXNQZXJFbGVtZW50Ols0XSx0eXBlOlt5ZV19LHRbYWFdPXt0ZXh0dXJlRm9ybWF0OkllLGNvbG9yUmVuZGVyYWJsZTohMCx0ZXh0dXJlRmlsdGVyYWJsZTohMSxieXRlc1BlckVsZW1lbnQ6WzRdLHR5cGU6W2Z0XX0sdFtKc109e3RleHR1cmVGb3JtYXQ6bHQsY29sb3JSZW5kZXJhYmxlOiEwLHRleHR1cmVGaWx0ZXJhYmxlOiEwLGJ5dGVzUGVyRWxlbWVudDpbMl0sdHlwZTpbU119LHRbWnNdPXt0ZXh0dXJlRm9ybWF0Omx0LGNvbG9yUmVuZGVyYWJsZTohMSx0ZXh0dXJlRmlsdGVyYWJsZTohMCxieXRlc1BlckVsZW1lbnQ6WzJdLHR5cGU6W3NlXX0sdFtlYV09e3RleHR1cmVGb3JtYXQ6bHQsY29sb3JSZW5kZXJhYmxlOiExLHRleHR1cmVGaWx0ZXJhYmxlOiEwLGJ5dGVzUGVyRWxlbWVudDpbOCw0XSx0eXBlOltPLGpdfSx0W3RhXT17dGV4dHVyZUZvcm1hdDpsdCxjb2xvclJlbmRlcmFibGU6ITEsdGV4dHVyZUZpbHRlcmFibGU6ITEsYnl0ZXNQZXJFbGVtZW50Ols4XSx0eXBlOltPXX0sdFtyYV09e3RleHR1cmVGb3JtYXQ6d2UsY29sb3JSZW5kZXJhYmxlOiEwLHRleHR1cmVGaWx0ZXJhYmxlOiExLGJ5dGVzUGVyRWxlbWVudDpbMl0sdHlwZTpbU119LHRbbmFdPXt0ZXh0dXJlRm9ybWF0OndlLGNvbG9yUmVuZGVyYWJsZTohMCx0ZXh0dXJlRmlsdGVyYWJsZTohMSxieXRlc1BlckVsZW1lbnQ6WzJdLHR5cGU6W3NlXX0sdFtYc109e3RleHR1cmVGb3JtYXQ6d2UsY29sb3JSZW5kZXJhYmxlOiEwLHRleHR1cmVGaWx0ZXJhYmxlOiExLGJ5dGVzUGVyRWxlbWVudDpbNF0sdHlwZTpbQWVdfSx0W1FzXT17dGV4dHVyZUZvcm1hdDp3ZSxjb2xvclJlbmRlcmFibGU6ITAsdGV4dHVyZUZpbHRlcmFibGU6ITEsYnl0ZXNQZXJFbGVtZW50Ols0XSx0eXBlOltjdF19LHRbS3NdPXt0ZXh0dXJlRm9ybWF0OndlLGNvbG9yUmVuZGVyYWJsZTohMCx0ZXh0dXJlRmlsdGVyYWJsZTohMSxieXRlc1BlckVsZW1lbnQ6WzhdLHR5cGU6W3llXX0sdFtxc109e3RleHR1cmVGb3JtYXQ6d2UsY29sb3JSZW5kZXJhYmxlOiEwLHRleHR1cmVGaWx0ZXJhYmxlOiExLGJ5dGVzUGVyRWxlbWVudDpbOF0sdHlwZTpbZnRdfSx0W3VhXT17dGV4dHVyZUZvcm1hdDpLLGNvbG9yUmVuZGVyYWJsZTohMCx0ZXh0dXJlRmlsdGVyYWJsZTohMCxieXRlc1BlckVsZW1lbnQ6WzNdLHR5cGU6W1NdfSx0W2NhXT17dGV4dHVyZUZvcm1hdDpLLGNvbG9yUmVuZGVyYWJsZTohMSx0ZXh0dXJlRmlsdGVyYWJsZTohMCxieXRlc1BlckVsZW1lbnQ6WzNdLHR5cGU6W1NdfSx0W2ZhXT17dGV4dHVyZUZvcm1hdDpLLGNvbG9yUmVuZGVyYWJsZTohMCx0ZXh0dXJlRmlsdGVyYWJsZTohMCxieXRlc1BlckVsZW1lbnQ6WzMsMl0sdHlwZTpbUyx4bl19LHRbbGFdPXt0ZXh0dXJlRm9ybWF0OkssY29sb3JSZW5kZXJhYmxlOiExLHRleHR1cmVGaWx0ZXJhYmxlOiEwLGJ5dGVzUGVyRWxlbWVudDpbM10sdHlwZTpbc2VdfSx0W2RhXT17dGV4dHVyZUZvcm1hdDpLLGNvbG9yUmVuZGVyYWJsZTohMSx0ZXh0dXJlRmlsdGVyYWJsZTohMCxieXRlc1BlckVsZW1lbnQ6WzEyLDYsNF0sdHlwZTpbTyxqLEdhXX0sdFttYV09e3RleHR1cmVGb3JtYXQ6Syxjb2xvclJlbmRlcmFibGU6ITEsdGV4dHVyZUZpbHRlcmFibGU6ITAsYnl0ZXNQZXJFbGVtZW50OlsxMiw2LDRdLHR5cGU6W08saixXYV19LHRbaGFdPXt0ZXh0dXJlRm9ybWF0OkssY29sb3JSZW5kZXJhYmxlOiExLHRleHR1cmVGaWx0ZXJhYmxlOiEwLGJ5dGVzUGVyRWxlbWVudDpbMTIsNl0sdHlwZTpbTyxqXX0sdFtwYV09e3RleHR1cmVGb3JtYXQ6Syxjb2xvclJlbmRlcmFibGU6ITEsdGV4dHVyZUZpbHRlcmFibGU6ITEsYnl0ZXNQZXJFbGVtZW50OlsxMl0sdHlwZTpbT119LHRbZ2FdPXt0ZXh0dXJlRm9ybWF0OlNlLGNvbG9yUmVuZGVyYWJsZTohMSx0ZXh0dXJlRmlsdGVyYWJsZTohMSxieXRlc1BlckVsZW1lbnQ6WzNdLHR5cGU6W1NdfSx0W3lhXT17dGV4dHVyZUZvcm1hdDpTZSxjb2xvclJlbmRlcmFibGU6ITEsdGV4dHVyZUZpbHRlcmFibGU6ITEsYnl0ZXNQZXJFbGVtZW50OlszXSx0eXBlOltzZV19LHRbeGFdPXt0ZXh0dXJlRm9ybWF0OlNlLGNvbG9yUmVuZGVyYWJsZTohMSx0ZXh0dXJlRmlsdGVyYWJsZTohMSxieXRlc1BlckVsZW1lbnQ6WzZdLHR5cGU6W0FlXX0sdFtfYV09e3RleHR1cmVGb3JtYXQ6U2UsY29sb3JSZW5kZXJhYmxlOiExLHRleHR1cmVGaWx0ZXJhYmxlOiExLGJ5dGVzUGVyRWxlbWVudDpbNl0sdHlwZTpbY3RdfSx0W2JhXT17dGV4dHVyZUZvcm1hdDpTZSxjb2xvclJlbmRlcmFibGU6ITEsdGV4dHVyZUZpbHRlcmFibGU6ITEsYnl0ZXNQZXJFbGVtZW50OlsxMl0sdHlwZTpbeWVdfSx0W3ZhXT17dGV4dHVyZUZvcm1hdDpTZSxjb2xvclJlbmRlcmFibGU6ITEsdGV4dHVyZUZpbHRlcmFibGU6ITEsYnl0ZXNQZXJFbGVtZW50OlsxMl0sdHlwZTpbZnRdfSx0W0VhXT17dGV4dHVyZUZvcm1hdDpSLGNvbG9yUmVuZGVyYWJsZTohMCx0ZXh0dXJlRmlsdGVyYWJsZTohMCxieXRlc1BlckVsZW1lbnQ6WzRdLHR5cGU6W1NdfSx0W1RhXT17dGV4dHVyZUZvcm1hdDpSLGNvbG9yUmVuZGVyYWJsZTohMCx0ZXh0dXJlRmlsdGVyYWJsZTohMCxieXRlc1BlckVsZW1lbnQ6WzRdLHR5cGU6W1NdfSx0W0FhXT17dGV4dHVyZUZvcm1hdDpSLGNvbG9yUmVuZGVyYWJsZTohMSx0ZXh0dXJlRmlsdGVyYWJsZTohMCxieXRlc1BlckVsZW1lbnQ6WzRdLHR5cGU6W3NlXX0sdFt3YV09e3RleHR1cmVGb3JtYXQ6Uixjb2xvclJlbmRlcmFibGU6ITAsdGV4dHVyZUZpbHRlcmFibGU6ITAsYnl0ZXNQZXJFbGVtZW50Ols0LDIsNF0sdHlwZTpbUyx5bixvcl19LHRbSWFdPXt0ZXh0dXJlRm9ybWF0OlIsY29sb3JSZW5kZXJhYmxlOiEwLHRleHR1cmVGaWx0ZXJhYmxlOiEwLGJ5dGVzUGVyRWxlbWVudDpbNCwyXSx0eXBlOltTLGduXX0sdFtTYV09e3RleHR1cmVGb3JtYXQ6Uixjb2xvclJlbmRlcmFibGU6ITAsdGV4dHVyZUZpbHRlcmFibGU6ITAsYnl0ZXNQZXJFbGVtZW50Ols0XSx0eXBlOltvcl19LHRbUmFdPXt0ZXh0dXJlRm9ybWF0OlIsY29sb3JSZW5kZXJhYmxlOiExLHRleHR1cmVGaWx0ZXJhYmxlOiEwLGJ5dGVzUGVyRWxlbWVudDpbMTYsOF0sdHlwZTpbTyxqXX0sdFtGYV09e3RleHR1cmVGb3JtYXQ6Uixjb2xvclJlbmRlcmFibGU6ITEsdGV4dHVyZUZpbHRlcmFibGU6ITEsYnl0ZXNQZXJFbGVtZW50OlsxNl0sdHlwZTpbT119LHRbUGFdPXt0ZXh0dXJlRm9ybWF0OnhlLGNvbG9yUmVuZGVyYWJsZTohMCx0ZXh0dXJlRmlsdGVyYWJsZTohMSxieXRlc1BlckVsZW1lbnQ6WzRdLHR5cGU6W1NdfSx0W2thXT17dGV4dHVyZUZvcm1hdDp4ZSxjb2xvclJlbmRlcmFibGU6ITAsdGV4dHVyZUZpbHRlcmFibGU6ITEsYnl0ZXNQZXJFbGVtZW50Ols0XSx0eXBlOltzZV19LHRbRGFdPXt0ZXh0dXJlRm9ybWF0OnhlLGNvbG9yUmVuZGVyYWJsZTohMCx0ZXh0dXJlRmlsdGVyYWJsZTohMSxieXRlc1BlckVsZW1lbnQ6WzRdLHR5cGU6W29yXX0sdFtDYV09e3RleHR1cmVGb3JtYXQ6eGUsY29sb3JSZW5kZXJhYmxlOiEwLHRleHR1cmVGaWx0ZXJhYmxlOiExLGJ5dGVzUGVyRWxlbWVudDpbOF0sdHlwZTpbQWVdfSx0W0JhXT17dGV4dHVyZUZvcm1hdDp4ZSxjb2xvclJlbmRlcmFibGU6ITAsdGV4dHVyZUZpbHRlcmFibGU6ITEsYnl0ZXNQZXJFbGVtZW50Ols4XSx0eXBlOltjdF19LHRbTmFdPXt0ZXh0dXJlRm9ybWF0OnhlLGNvbG9yUmVuZGVyYWJsZTohMCx0ZXh0dXJlRmlsdGVyYWJsZTohMSxieXRlc1BlckVsZW1lbnQ6WzE2XSx0eXBlOltmdF19LHRbT2FdPXt0ZXh0dXJlRm9ybWF0OnhlLGNvbG9yUmVuZGVyYWJsZTohMCx0ZXh0dXJlRmlsdGVyYWJsZTohMSxieXRlc1BlckVsZW1lbnQ6WzE2XSx0eXBlOlt5ZV19LHRbTWFdPXt0ZXh0dXJlRm9ybWF0Ok1lLGNvbG9yUmVuZGVyYWJsZTohMCx0ZXh0dXJlRmlsdGVyYWJsZTohMSxieXRlc1BlckVsZW1lbnQ6WzIsNF0sdHlwZTpbQWUseWVdfSx0W1VhXT17dGV4dHVyZUZvcm1hdDpNZSxjb2xvclJlbmRlcmFibGU6ITAsdGV4dHVyZUZpbHRlcmFibGU6ITEsYnl0ZXNQZXJFbGVtZW50Ols0XSx0eXBlOlt5ZV19LHRbTGFdPXt0ZXh0dXJlRm9ybWF0Ok1lLGNvbG9yUmVuZGVyYWJsZTohMCx0ZXh0dXJlRmlsdGVyYWJsZTohMSxieXRlc1BlckVsZW1lbnQ6WzRdLHR5cGU6W09dfSx0WyRhXT17dGV4dHVyZUZvcm1hdDpjbixjb2xvclJlbmRlcmFibGU6ITAsdGV4dHVyZUZpbHRlcmFibGU6ITEsYnl0ZXNQZXJFbGVtZW50Ols0XSx0eXBlOltIYV19LHRbemFdPXt0ZXh0dXJlRm9ybWF0OmNuLGNvbG9yUmVuZGVyYWJsZTohMCx0ZXh0dXJlRmlsdGVyYWJsZTohMSxieXRlc1BlckVsZW1lbnQ6WzRdLHR5cGU6W1ZhXX0sT2JqZWN0LmtleXModCkuZm9yRWFjaChmdW5jdGlvbihlKXtjb25zdCBuPXRbZV07bi5ieXRlc1BlckVsZW1lbnRNYXA9e30sbi5ieXRlc1BlckVsZW1lbnQuZm9yRWFjaChmdW5jdGlvbihvLGkpe2NvbnN0IHM9bi50eXBlW2ldO24uYnl0ZXNQZXJFbGVtZW50TWFwW3NdPW99KX0pLGlyPXR9cmV0dXJuIGlyW3JdfWZ1bmN0aW9uIGphKHIsdCl7Y29uc3QgZT1tdChyKTtpZighZSl0aHJvdyJ1bmtub3duIGludGVybmFsIGZvcm1hdCI7Y29uc3Qgbj1lLmJ5dGVzUGVyRWxlbWVudE1hcFt0XTtpZihuPT09dm9pZCAwKXRocm93InVua25vd24gaW50ZXJuYWwgZm9ybWF0IjtyZXR1cm4gbn1mdW5jdGlvbiBMZShyKXtjb25zdCB0PW10KHIpO2lmKCF0KXRocm93InVua25vd24gaW50ZXJuYWwgZm9ybWF0IjtyZXR1cm57Zm9ybWF0OnQudGV4dHVyZUZvcm1hdCx0eXBlOnQudHlwZVswXX19ZnVuY3Rpb24gX24ocil7cmV0dXJuKHImci0xKT09PTB9ZnVuY3Rpb24gWWEocix0LGUsbil7aWYoIU5lKHIpKXJldHVybiBfbih0KSYmX24oZSk7Y29uc3Qgbz1tdChuKTtpZighbyl0aHJvdyJ1bmtub3duIGludGVybmFsIGZvcm1hdCI7cmV0dXJuIG8uY29sb3JSZW5kZXJhYmxlJiZvLnRleHR1cmVGaWx0ZXJhYmxlfWZ1bmN0aW9uIFhhKHIpe2NvbnN0IHQ9bXQocik7aWYoIXQpdGhyb3cidW5rbm93biBpbnRlcm5hbCBmb3JtYXQiO3JldHVybiB0LnRleHR1cmVGaWx0ZXJhYmxlfWZ1bmN0aW9uIFFhKHIsdCxlKXtyZXR1cm4gT2UodCk/S3QodCk6ZXx8U31mdW5jdGlvbiBodChyLHQsZSxuLG8pe2lmKG8lMSE9PTApdGhyb3ciY2FuJ3QgZ3Vlc3MgZGltZW5zaW9ucyI7aWYoIWUmJiFuKXtjb25zdCBpPU1hdGguc3FydChvLyh0PT09aWU/NjoxKSk7aSUxPT09MD8oZT1pLG49aSk6KGU9byxuPTEpfWVsc2UgaWYobil7aWYoIWUmJihlPW8vbixlJTEpKXRocm93ImNhbid0IGd1ZXNzIGRpbWVuc2lvbnMifWVsc2UgaWYobj1vL2UsbiUxKXRocm93ImNhbid0IGd1ZXNzIGRpbWVuc2lvbnMiO3JldHVybnt3aWR0aDplLGhlaWdodDpufX1mdW5jdGlvbiBSZShyLHQpe3QuY29sb3JzcGFjZUNvbnZlcnNpb24hPT12b2lkIDAmJnIucGl4ZWxTdG9yZWkoTHMsdC5jb2xvcnNwYWNlQ29udmVyc2lvbiksdC5wcmVtdWx0aXBseUFscGhhIT09dm9pZCAwJiZyLnBpeGVsU3RvcmVpKHpzLHQucHJlbXVsdGlwbHlBbHBoYSksdC5mbGlwWSE9PXZvaWQgMCYmci5waXhlbFN0b3JlaSgkcyx0LmZsaXBZKX1mdW5jdGlvbiBibihyKXtyLnBpeGVsU3RvcmVpKG5yLDQpLE5lKHIpJiYoci5waXhlbFN0b3JlaShsbiwwKSxyLnBpeGVsU3RvcmVpKGRuLDApLHIucGl4ZWxTdG9yZWkobW4sMCksci5waXhlbFN0b3JlaShobiwwKSxyLnBpeGVsU3RvcmVpKHBuLDApKX1mdW5jdGlvbiBLYShyLHQsZSxuKXtuLm1pbk1hZyYmKGUuY2FsbChyLHQsdHIsbi5taW5NYWcpLGUuY2FsbChyLHQscnIsbi5taW5NYWcpKSxuLm1pbiYmZS5jYWxsKHIsdCx0cixuLm1pbiksbi5tYWcmJmUuY2FsbChyLHQscnIsbi5tYWcpLG4ud3JhcCYmKGUuY2FsbChyLHQsYXQsbi53cmFwKSxlLmNhbGwocix0LHV0LG4ud3JhcCksKHQ9PT1wZXx8b3Mocix0KSkmJmUuY2FsbChyLHQsZm4sbi53cmFwKSksbi53cmFwUiYmZS5jYWxsKHIsdCxmbixuLndyYXBSKSxuLndyYXBTJiZlLmNhbGwocix0LGF0LG4ud3JhcFMpLG4ud3JhcFQmJmUuY2FsbChyLHQsdXQsbi53cmFwVCksbi5taW5Mb2QmJmUuY2FsbChyLHQsTnMsbi5taW5Mb2QpLG4ubWF4TG9kJiZlLmNhbGwocix0LE9zLG4ubWF4TG9kKSxuLmJhc2VMZXZlbCYmZS5jYWxsKHIsdCxNcyxuLmJhc2VMZXZlbCksbi5tYXhMZXZlbCYmZS5jYWxsKHIsdCxVcyxuLm1heExldmVsKX1mdW5jdGlvbiB2bihyLHQsZSl7Y29uc3Qgbj1lLnRhcmdldHx8b2U7ci5iaW5kVGV4dHVyZShuLHQpLEthKHIsbixyLnRleFBhcmFtZXRlcmksZSl9ZnVuY3Rpb24gcWEocil7cmV0dXJuIHI9cnx8bmUudGV4dHVyZUNvbG9yLE9lKHIpP3I6bmV3IFVpbnQ4QXJyYXkoW3JbMF0qMjU1LHJbMV0qMjU1LHJbMl0qMjU1LHJbM10qMjU1XSl9ZnVuY3Rpb24gc3Iocix0LGUsbixvLGkpe2U9ZXx8bmUudGV4dHVyZU9wdGlvbnMsaT1pfHxSO2NvbnN0IHM9ZS50YXJnZXR8fG9lO2lmKG49bnx8ZS53aWR0aCxvPW98fGUuaGVpZ2h0LHIuYmluZFRleHR1cmUocyx0KSxZYShyLG4sbyxpKSlyLmdlbmVyYXRlTWlwbWFwKHMpO2Vsc2V7Y29uc3QgYT1YYShpKT9GczpScztyLnRleFBhcmFtZXRlcmkocyx0cixhKSxyLnRleFBhcmFtZXRlcmkocyxycixhKSxyLnRleFBhcmFtZXRlcmkocyxhdCxzdCksci50ZXhQYXJhbWV0ZXJpKHMsdXQsc3QpfX1mdW5jdGlvbiB6ZShyKXtyZXR1cm4gci5hdXRvPT09ITB8fHIuYXV0bz09PXZvaWQgMCYmci5sZXZlbD09PXZvaWQgMH1mdW5jdGlvbiBhcihyLHQpe3JldHVybiB0PXR8fHt9LHQuY3ViZUZhY2VPcmRlcnx8W2VyLFBzLGtzLERzLENzLEJzXX1mdW5jdGlvbiB1cihyLHQpe2NvbnN0IG49YXIocix0KS5tYXAoZnVuY3Rpb24obyxpKXtyZXR1cm57ZmFjZTpvLG5keDppfX0pO3JldHVybiBuLnNvcnQoZnVuY3Rpb24obyxpKXtyZXR1cm4gby5mYWNlLWkuZmFjZX0pLG59ZnVuY3Rpb24gRW4ocix0LGUsbil7bj1ufHxuZS50ZXh0dXJlT3B0aW9ucztjb25zdCBvPW4udGFyZ2V0fHxvZSxpPW4ubGV2ZWx8fDA7bGV0IHM9ZS53aWR0aCxhPWUuaGVpZ2h0O2NvbnN0IHU9bi5pbnRlcm5hbEZvcm1hdHx8bi5mb3JtYXR8fFIsZj1MZSh1KSxtPW4uZm9ybWF0fHxmLmZvcm1hdCxwPW4udHlwZXx8Zi50eXBlO2lmKFJlKHIsbiksci5iaW5kVGV4dHVyZShvLHQpLG89PT1pZSl7Y29uc3QgZz1lLndpZHRoLHg9ZS5oZWlnaHQ7bGV0IGQsXztpZihnLzY9PT14KWQ9eCxfPVswLDAsMSwwLDIsMCwzLDAsNCwwLDUsMF07ZWxzZSBpZih4LzY9PT1nKWQ9ZyxfPVswLDAsMCwxLDAsMiwwLDMsMCw0LDAsNV07ZWxzZSBpZihnLzM9PT14LzIpZD1nLzMsXz1bMCwwLDEsMCwyLDAsMCwxLDEsMSwyLDFdO2Vsc2UgaWYoZy8yPT09eC8zKWQ9Zy8yLF89WzAsMCwxLDAsMCwxLDEsMSwwLDIsMSwyXTtlbHNlIHRocm93ImNhbid0IGZpZ3VyZSBvdXQgY3ViZSBtYXAgZnJvbSBlbGVtZW50OiAiKyhlLnNyYz9lLnNyYzplLm5vZGVOYW1lKTtjb25zdCBFPW9uKCk7RT8oRS5jYW52YXMud2lkdGg9ZCxFLmNhbnZhcy5oZWlnaHQ9ZCxzPWQsYT1kLHVyKHIsbikuZm9yRWFjaChmdW5jdGlvbih2KXtjb25zdCBGPV9bdi5uZHgqMiswXSpkLGs9X1t2Lm5keCoyKzFdKmQ7RS5kcmF3SW1hZ2UoZSxGLGssZCxkLDAsMCxkLGQpLHIudGV4SW1hZ2UyRCh2LmZhY2UsaSx1LG0scCxFLmNhbnZhcyl9KSxFLmNhbnZhcy53aWR0aD0xLEUuY2FudmFzLmhlaWdodD0xKTp0eXBlb2YgY3JlYXRlSW1hZ2VCaXRtYXA8InUiJiYocz1kLGE9ZCx1cihyLG4pLmZvckVhY2goZnVuY3Rpb24odil7Y29uc3QgRj1fW3YubmR4KjIrMF0qZCxrPV9bdi5uZHgqMisxXSpkO3IudGV4SW1hZ2UyRCh2LmZhY2UsaSx1LGQsZCwwLG0scCxudWxsKSxjcmVhdGVJbWFnZUJpdG1hcChlLEYsayxkLGQse3ByZW11bHRpcGx5QWxwaGE6Im5vbmUiLGNvbG9yU3BhY2VDb252ZXJzaW9uOiJub25lIn0pLnRoZW4oZnVuY3Rpb24oJCl7UmUocixuKSxyLmJpbmRUZXh0dXJlKG8sdCksci50ZXhJbWFnZTJEKHYuZmFjZSxpLHUsbSxwLCQpLHplKG4pJiZzcihyLHQsbixzLGEsdSl9KX0pKX1lbHNlIGlmKG89PT1wZXx8bz09PWdlKXtjb25zdCBnPU1hdGgubWluKGUud2lkdGgsZS5oZWlnaHQpLHg9TWF0aC5tYXgoZS53aWR0aCxlLmhlaWdodCksZD14L2c7aWYoZCUxIT09MCl0aHJvdyJjYW4gbm90IGNvbXB1dGUgM0QgZGltZW5zaW9ucyBvZiBlbGVtZW50Ijtjb25zdCBfPWUud2lkdGg9PT14PzE6MCxFPWUuaGVpZ2h0PT09eD8xOjA7ci5waXhlbFN0b3JlaShuciwxKSxyLnBpeGVsU3RvcmVpKGxuLGUud2lkdGgpLHIucGl4ZWxTdG9yZWkoZG4sMCksci5waXhlbFN0b3JlaShwbiwwKSxyLnRleEltYWdlM0QobyxpLHUsZyxnLGcsMCxtLHAsbnVsbCk7Zm9yKGxldCB2PTA7djxkOysrdil7Y29uc3QgRj12KmcqXyxrPXYqZypFO3IucGl4ZWxTdG9yZWkobW4sRiksci5waXhlbFN0b3JlaShobixrKSxyLnRleFN1YkltYWdlM0QobyxpLDAsMCx2LGcsZywxLG0scCxlKX1ibihyKX1lbHNlIHIudGV4SW1hZ2UyRChvLGksdSxtLHAsZSk7emUobikmJnNyKHIsdCxuLHMsYSx1KSx2bihyLHQsbil9ZnVuY3Rpb24gJGUoKXt9ZnVuY3Rpb24gSmEocil7aWYodHlwZW9mIGRvY3VtZW50PCJ1Iil7Y29uc3QgdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7cmV0dXJuIHQuaHJlZj1yLHQuaG9zdG5hbWU9PT1sb2NhdGlvbi5ob3N0bmFtZSYmdC5wb3J0PT09bG9jYXRpb24ucG9ydCYmdC5wcm90b2NvbD09PWxvY2F0aW9uLnByb3RvY29sfWVsc2V7Y29uc3QgdD1uZXcgVVJMKGxvY2F0aW9uLmhyZWYpLm9yaWdpbjtyZXR1cm4gbmV3IFVSTChyLGxvY2F0aW9uLmhyZWYpLm9yaWdpbj09PXR9fWZ1bmN0aW9uIFphKHIsdCl7cmV0dXJuIHQ9PT12b2lkIDAmJiFKYShyKT8iYW5vbnltb3VzIjp0fWZ1bmN0aW9uIGV1KHIsdCxlKXtlPWV8fCRlO2xldCBuO2lmKHQ9dCE9PXZvaWQgMD90Om5lLmNyb3NzT3JpZ2luLHQ9WmEocix0KSx0eXBlb2YgSW1hZ2U8InUiKXtuPW5ldyBJbWFnZSx0IT09dm9pZCAwJiYobi5jcm9zc09yaWdpbj10KTtjb25zdCBvPWZ1bmN0aW9uKCl7bi5yZW1vdmVFdmVudExpc3RlbmVyKCJlcnJvciIsaSksbi5yZW1vdmVFdmVudExpc3RlbmVyKCJsb2FkIixzKSxuPW51bGx9LGk9ZnVuY3Rpb24oKXtjb25zdCB1PSJjb3VsZG4ndCBsb2FkIGltYWdlOiAiK3I7UXIodSksZSh1LG4pLG8oKX0scz1mdW5jdGlvbigpe2UobnVsbCxuKSxvKCl9O3JldHVybiBuLmFkZEV2ZW50TGlzdGVuZXIoImVycm9yIixpKSxuLmFkZEV2ZW50TGlzdGVuZXIoImxvYWQiLHMpLG4uc3JjPXIsbn1lbHNlIGlmKHR5cGVvZiBJbWFnZUJpdG1hcDwidSIpe2xldCBvLGk7Y29uc3Qgcz1mdW5jdGlvbigpe2UobyxpKX0sYT17fTt0JiYoYS5tb2RlPSJjb3JzIiksZmV0Y2gocixhKS50aGVuKGZ1bmN0aW9uKHUpe2lmKCF1Lm9rKXRocm93IHU7cmV0dXJuIHUuYmxvYigpfSkudGhlbihmdW5jdGlvbih1KXtyZXR1cm4gY3JlYXRlSW1hZ2VCaXRtYXAodSx7cHJlbXVsdGlwbHlBbHBoYToibm9uZSIsY29sb3JTcGFjZUNvbnZlcnNpb246Im5vbmUifSl9KS50aGVuKGZ1bmN0aW9uKHUpe2k9dSxzZXRUaW1lb3V0KHMpfSkuY2F0Y2goZnVuY3Rpb24odSl7bz11LHNldFRpbWVvdXQocyl9KSxuPW51bGx9cmV0dXJuIG59ZnVuY3Rpb24gVG4ocil7cmV0dXJuIHR5cGVvZiBJbWFnZUJpdG1hcDwidSImJnIgaW5zdGFuY2VvZiBJbWFnZUJpdG1hcHx8dHlwZW9mIEltYWdlRGF0YTwidSImJnIgaW5zdGFuY2VvZiBJbWFnZURhdGF8fHR5cGVvZiBIVE1MRWxlbWVudDwidSImJnIgaW5zdGFuY2VvZiBIVE1MRWxlbWVudH1mdW5jdGlvbiBjcihyLHQsZSl7cmV0dXJuIFRuKHIpPyhzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ZShudWxsLHIpfSkscik6ZXUocix0LGUpfWZ1bmN0aW9uIGZyKHIsdCxlKXtlPWV8fG5lLnRleHR1cmVPcHRpb25zO2NvbnN0IG49ZS50YXJnZXR8fG9lO2lmKHIuYmluZFRleHR1cmUobix0KSxlLmNvbG9yPT09ITEpcmV0dXJuO2NvbnN0IG89cWEoZS5jb2xvcik7aWYobj09PWllKWZvcihsZXQgaT0wO2k8NjsrK2kpci50ZXhJbWFnZTJEKGVyK2ksMCxSLDEsMSwwLFIsUyxvKTtlbHNlIG49PT1wZXx8bj09PWdlP3IudGV4SW1hZ2UzRChuLDAsUiwxLDEsMSwwLFIsUyxvKTpyLnRleEltYWdlMkQobiwwLFIsMSwxLDAsUixTLG8pfWZ1bmN0aW9uIHR1KHIsdCxlLG4pe3JldHVybiBuPW58fCRlLGU9ZXx8bmUudGV4dHVyZU9wdGlvbnMsZnIocix0LGUpLGU9T2JqZWN0LmFzc2lnbih7fSxlKSxjcihlLnNyYyxlLmNyb3NzT3JpZ2luLGZ1bmN0aW9uKGkscyl7aT9uKGksdCxzKTooRW4ocix0LHMsZSksbihudWxsLHQscykpfSl9ZnVuY3Rpb24gcnUocix0LGUsbil7bj1ufHwkZTtjb25zdCBvPWUuc3JjO2lmKG8ubGVuZ3RoIT09Nil0aHJvdyJ0aGVyZSBtdXN0IGJlIDYgdXJscyBmb3IgYSBjdWJlbWFwIjtjb25zdCBpPWUubGV2ZWx8fDAscz1lLmludGVybmFsRm9ybWF0fHxlLmZvcm1hdHx8UixhPUxlKHMpLHU9ZS5mb3JtYXR8fGEuZm9ybWF0LGY9ZS50eXBlfHxTLG09ZS50YXJnZXR8fG9lO2lmKG0hPT1pZSl0aHJvdyJ0YXJnZXQgbXVzdCBiZSBURVhUVVJFX0NVQkVfTUFQIjtmcihyLHQsZSksZT1PYmplY3QuYXNzaWduKHt9LGUpO2xldCBwPTY7Y29uc3QgZz1bXSx4PWFyKHIsZSk7bGV0IGQ7ZnVuY3Rpb24gXyhFKXtyZXR1cm4gZnVuY3Rpb24odixGKXstLXAsdj9nLnB1c2godik6Ri53aWR0aCE9PUYuaGVpZ2h0P2cucHVzaCgiY3ViZW1hcCBmYWNlIGltZyBpcyBub3QgYSBzcXVhcmU6ICIrRi5zcmMpOihSZShyLGUpLHIuYmluZFRleHR1cmUobSx0KSxwPT09NT9hcigpLmZvckVhY2goZnVuY3Rpb24oayl7ci50ZXhJbWFnZTJEKGssaSxzLHUsZixGKX0pOnIudGV4SW1hZ2UyRChFLGkscyx1LGYsRiksemUoZSkmJnIuZ2VuZXJhdGVNaXBtYXAobSkpLHA9PT0wJiZuKGcubGVuZ3RoP2c6dm9pZCAwLHQsZCl9fWQ9by5tYXAoZnVuY3Rpb24oRSx2KXtyZXR1cm4gY3IoRSxlLmNyb3NzT3JpZ2luLF8oeFt2XSkpfSl9ZnVuY3Rpb24gbnUocix0LGUsbil7bj1ufHwkZTtjb25zdCBvPWUuc3JjLGk9ZS5pbnRlcm5hbEZvcm1hdHx8ZS5mb3JtYXR8fFIscz1MZShpKSxhPWUuZm9ybWF0fHxzLmZvcm1hdCx1PWUudHlwZXx8UyxmPWUudGFyZ2V0fHxnZTtpZihmIT09cGUmJmYhPT1nZSl0aHJvdyJ0YXJnZXQgbXVzdCBiZSBURVhUVVJFXzNEIG9yIFRFWFRVUkVfMkRfQVJSQVkiO2ZyKHIsdCxlKSxlPU9iamVjdC5hc3NpZ24oe30sZSk7bGV0IG09by5sZW5ndGg7Y29uc3QgcD1bXTtsZXQgZztjb25zdCB4PWUubGV2ZWx8fDA7bGV0IGQ9ZS53aWR0aCxfPWUuaGVpZ2h0O2NvbnN0IEU9by5sZW5ndGg7bGV0IHY9ITA7ZnVuY3Rpb24gRihrKXtyZXR1cm4gZnVuY3Rpb24oJCx6KXtpZigtLW0sJClwLnB1c2goJCk7ZWxzZXtpZihSZShyLGUpLHIuYmluZFRleHR1cmUoZix0KSx2KXt2PSExLGQ9ZS53aWR0aHx8ei53aWR0aCxfPWUuaGVpZ2h0fHx6LmhlaWdodCxyLnRleEltYWdlM0QoZix4LGksZCxfLEUsMCxhLHUsbnVsbCk7Zm9yKGxldCBWPTA7VjxFOysrVilyLnRleFN1YkltYWdlM0QoZix4LDAsMCxWLGQsXywxLGEsdSx6KX1lbHNle2xldCBWPXosRzsoei53aWR0aCE9PWR8fHouaGVpZ2h0IT09XykmJihHPW9uKCksVj1HLmNhbnZhcyxHLmNhbnZhcy53aWR0aD1kLEcuY2FudmFzLmhlaWdodD1fLEcuZHJhd0ltYWdlKHosMCwwLGQsXykpLHIudGV4U3ViSW1hZ2UzRChmLHgsMCwwLGssZCxfLDEsYSx1LFYpLEcmJlY9PT1HLmNhbnZhcyYmKEcuY2FudmFzLndpZHRoPTAsRy5jYW52YXMuaGVpZ2h0PTApfXplKGUpJiZyLmdlbmVyYXRlTWlwbWFwKGYpfW09PT0wJiZuKHAubGVuZ3RoP3A6dm9pZCAwLHQsZyl9fWc9by5tYXAoZnVuY3Rpb24oaywkKXtyZXR1cm4gY3IoayxlLmNyb3NzT3JpZ2luLEYoJCkpfSl9ZnVuY3Rpb24gb3Uocix0LGUsbil7bj1ufHxuZS50ZXh0dXJlT3B0aW9ucztjb25zdCBvPW4udGFyZ2V0fHxvZTtyLmJpbmRUZXh0dXJlKG8sdCk7bGV0IGk9bi53aWR0aCxzPW4uaGVpZ2h0LGE9bi5kZXB0aDtjb25zdCB1PW4ubGV2ZWx8fDAsZj1uLmludGVybmFsRm9ybWF0fHxuLmZvcm1hdHx8UixtPUxlKGYpLHA9bi5mb3JtYXR8fG0uZm9ybWF0LGc9bi50eXBlfHxRYShyLGUsbS50eXBlKTtpZihPZShlKSllIGluc3RhbmNlb2YgVWludDhDbGFtcGVkQXJyYXkmJihlPW5ldyBVaW50OEFycmF5KGUuYnVmZmVyKSk7ZWxzZXtjb25zdCBFPVhyKGcpO2U9bmV3IEUoZSl9Y29uc3QgeD1qYShmLGcpLGQ9ZS5ieXRlTGVuZ3RoL3g7aWYoZCUxKXRocm93Imxlbmd0aCB3cm9uZyBzaXplIGZvciBmb3JtYXQ6ICIrbm4ocixwKTtsZXQgXztpZihvPT09cGV8fG89PT1nZSlpZighaSYmIXMmJiFhKXtjb25zdCBFPU1hdGguY2JydChkKTtpZihFJTEhPT0wKXRocm93ImNhbid0IGd1ZXNzIGN1YmUgc2l6ZSBvZiBhcnJheSBvZiBudW1FbGVtZW50czogIitkO2k9RSxzPUUsYT1FfWVsc2UgaSYmKCFzfHwhYSk/KF89aHQocixvLHMsYSxkL2kpLHM9Xy53aWR0aCxhPV8uaGVpZ2h0KTpzJiYoIWl8fCFhKT8oXz1odChyLG8saSxhLGQvcyksaT1fLndpZHRoLGE9Xy5oZWlnaHQpOihfPWh0KHIsbyxpLHMsZC9hKSxpPV8ud2lkdGgscz1fLmhlaWdodCk7ZWxzZSBfPWh0KHIsbyxpLHMsZCksaT1fLndpZHRoLHM9Xy5oZWlnaHQ7aWYoYm4ociksci5waXhlbFN0b3JlaShucixuLnVucGFja0FsaWdubWVudHx8MSksUmUocixuKSxvPT09aWUpe2NvbnN0IEU9eC9lLkJZVEVTX1BFUl9FTEVNRU5ULHY9ZC82KkU7dXIocixuKS5mb3JFYWNoKEY9Pntjb25zdCBrPXYqRi5uZHgsJD1lLnN1YmFycmF5KGssayt2KTtyLnRleEltYWdlMkQoRi5mYWNlLHUsZixpLHMsMCxwLGcsJCl9KX1lbHNlIG89PT1wZXx8bz09PWdlP3IudGV4SW1hZ2UzRChvLHUsZixpLHMsYSwwLHAsZyxlKTpyLnRleEltYWdlMkQobyx1LGYsaSxzLDAscCxnLGUpO3JldHVybnt3aWR0aDppLGhlaWdodDpzLGRlcHRoOmEsdHlwZTpnfX1mdW5jdGlvbiBpdShyLHQsZSl7Y29uc3Qgbj1lLnRhcmdldHx8b2U7ci5iaW5kVGV4dHVyZShuLHQpO2NvbnN0IG89ZS5sZXZlbHx8MCxpPWUuaW50ZXJuYWxGb3JtYXR8fGUuZm9ybWF0fHxSLHM9TGUoaSksYT1lLmZvcm1hdHx8cy5mb3JtYXQsdT1lLnR5cGV8fHMudHlwZTtpZihSZShyLGUpLG49PT1pZSlmb3IobGV0IGY9MDtmPDY7KytmKXIudGV4SW1hZ2UyRChlcitmLG8saSxlLndpZHRoLGUuaGVpZ2h0LDAsYSx1LG51bGwpO2Vsc2Ugbj09PXBlfHxuPT09Z2U/ci50ZXhJbWFnZTNEKG4sbyxpLGUud2lkdGgsZS5oZWlnaHQsZS5kZXB0aCwwLGEsdSxudWxsKTpyLnRleEltYWdlMkQobixvLGksZS53aWR0aCxlLmhlaWdodCwwLGEsdSxudWxsKX1mdW5jdGlvbiBBbihyLHQsZSl7ZT1lfHwkZSx0PXR8fG5lLnRleHR1cmVPcHRpb25zO2NvbnN0IG49ci5jcmVhdGVUZXh0dXJlKCksbz10LnRhcmdldHx8b2U7bGV0IGk9dC53aWR0aHx8MSxzPXQuaGVpZ2h0fHwxO2NvbnN0IGE9dC5pbnRlcm5hbEZvcm1hdHx8UjtyLmJpbmRUZXh0dXJlKG8sbiksbz09PWllJiYoci50ZXhQYXJhbWV0ZXJpKG8sYXQsc3QpLHIudGV4UGFyYW1ldGVyaShvLHV0LHN0KSk7bGV0IHU9dC5zcmM7aWYodSlpZih0eXBlb2YgdT09ImZ1bmN0aW9uIiYmKHU9dShyLHQpKSx0eXBlb2YgdT09InN0cmluZyIpdHUocixuLHQsZSk7ZWxzZSBpZihPZSh1KXx8QXJyYXkuaXNBcnJheSh1KSYmKHR5cGVvZiB1WzBdPT0ibnVtYmVyInx8QXJyYXkuaXNBcnJheSh1WzBdKXx8T2UodVswXSkpKXtjb25zdCBmPW91KHIsbix1LHQpO2k9Zi53aWR0aCxzPWYuaGVpZ2h0fWVsc2UgQXJyYXkuaXNBcnJheSh1KSYmKHR5cGVvZiB1WzBdPT0ic3RyaW5nInx8VG4odVswXSkpP289PT1pZT9ydShyLG4sdCxlKTpudShyLG4sdCxlKTooRW4ocixuLHUsdCksaT11LndpZHRoLHM9dS5oZWlnaHQpO2Vsc2UgaXUocixuLHQpO3JldHVybiB6ZSh0KSYmc3IocixuLHQsaSxzLGEpLHZuKHIsbix0KSxufWNvbnN0IGxyPVFyO2Z1bmN0aW9uIHduKHIpe3JldHVybiB0eXBlb2YgZG9jdW1lbnQ8InUiJiZkb2N1bWVudC5nZXRFbGVtZW50QnlJZD9kb2N1bWVudC5nZXRFbGVtZW50QnlJZChyKTpudWxsfWNvbnN0IHB0PTMzOTg0LGd0PTM0OTYyLHN1PTM0OTYzLGF1PTM1NzEzLHV1PTM1NzE0LGN1PTM1NjMyLGZ1PTM1NjMzLGx1PTM1OTgxLEluPTM1NzE4LGR1PTM1NzIxLG11PTM1OTcxLGh1PTM1MzgyLHB1PTM1Mzk2LGd1PTM1Mzk4LHl1PTM1MzkyLHh1PTM1Mzk1LHl0PTUxMjYsU249MzU2NjQsUm49MzU2NjUsRm49MzU2NjYsZHI9NTEyNCxQbj0zNTY2Nyxrbj0zNTY2OCxEbj0zNTY2OSxDbj0zNTY3MCxCbj0zNTY3MSxObj0zNTY3MixPbj0zNTY3MyxNbj0zNTY3NCxVbj0zNTY3NSxMbj0zNTY3NixfdT0zNTY3OCxidT0zNTY4MCx2dT0zNTY3OSxFdT0zNTY4MixUdT0zNTY4NSxBdT0zNTY4Nix3dT0zNTY4NyxJdT0zNTY4OCxTdT0zNTY4OSxSdT0zNTY5MCxGdT0zNjI4OSxQdT0zNjI5MixrdT0zNjI5Myxtcj01MTI1LHpuPTM2Mjk0LCRuPTM2Mjk1LEduPTM2Mjk2LER1PTM2Mjk4LEN1PTM2Mjk5LEJ1PTM2MzAwLE51PTM2MzAzLE91PTM2MzA2LE11PTM2MzA3LFV1PTM2MzA4LEx1PTM2MzExLHh0PTM1NTMsX3Q9MzQwNjcsaHI9MzI4NzksYnQ9MzU4NjYsYj17fTtmdW5jdGlvbiBXbihyLHQpe3JldHVybiBiW3RdLmJpbmRQb2ludH1mdW5jdGlvbiB6dShyLHQpe3JldHVybiBmdW5jdGlvbihlKXtyLnVuaWZvcm0xZih0LGUpfX1mdW5jdGlvbiAkdShyLHQpe3JldHVybiBmdW5jdGlvbihlKXtyLnVuaWZvcm0xZnYodCxlKX19ZnVuY3Rpb24gR3Uocix0KXtyZXR1cm4gZnVuY3Rpb24oZSl7ci51bmlmb3JtMmZ2KHQsZSl9fWZ1bmN0aW9uIFd1KHIsdCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3IudW5pZm9ybTNmdih0LGUpfX1mdW5jdGlvbiBWdShyLHQpe3JldHVybiBmdW5jdGlvbihlKXtyLnVuaWZvcm00ZnYodCxlKX19ZnVuY3Rpb24gVm4ocix0KXtyZXR1cm4gZnVuY3Rpb24oZSl7ci51bmlmb3JtMWkodCxlKX19ZnVuY3Rpb24gSG4ocix0KXtyZXR1cm4gZnVuY3Rpb24oZSl7ci51bmlmb3JtMWl2KHQsZSl9fWZ1bmN0aW9uIGpuKHIsdCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3IudW5pZm9ybTJpdih0LGUpfX1mdW5jdGlvbiBZbihyLHQpe3JldHVybiBmdW5jdGlvbihlKXtyLnVuaWZvcm0zaXYodCxlKX19ZnVuY3Rpb24gWG4ocix0KXtyZXR1cm4gZnVuY3Rpb24oZSl7ci51bmlmb3JtNGl2KHQsZSl9fWZ1bmN0aW9uIEh1KHIsdCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3IudW5pZm9ybTF1aSh0LGUpfX1mdW5jdGlvbiBqdShyLHQpe3JldHVybiBmdW5jdGlvbihlKXtyLnVuaWZvcm0xdWl2KHQsZSl9fWZ1bmN0aW9uIFl1KHIsdCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3IudW5pZm9ybTJ1aXYodCxlKX19ZnVuY3Rpb24gWHUocix0KXtyZXR1cm4gZnVuY3Rpb24oZSl7ci51bmlmb3JtM3Vpdih0LGUpfX1mdW5jdGlvbiBRdShyLHQpe3JldHVybiBmdW5jdGlvbihlKXtyLnVuaWZvcm00dWl2KHQsZSl9fWZ1bmN0aW9uIEt1KHIsdCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3IudW5pZm9ybU1hdHJpeDJmdih0LCExLGUpfX1mdW5jdGlvbiBxdShyLHQpe3JldHVybiBmdW5jdGlvbihlKXtyLnVuaWZvcm1NYXRyaXgzZnYodCwhMSxlKX19ZnVuY3Rpb24gSnUocix0KXtyZXR1cm4gZnVuY3Rpb24oZSl7ci51bmlmb3JtTWF0cml4NGZ2KHQsITEsZSl9fWZ1bmN0aW9uIFp1KHIsdCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3IudW5pZm9ybU1hdHJpeDJ4M2Z2KHQsITEsZSl9fWZ1bmN0aW9uIGVjKHIsdCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3IudW5pZm9ybU1hdHJpeDN4MmZ2KHQsITEsZSl9fWZ1bmN0aW9uIHRjKHIsdCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3IudW5pZm9ybU1hdHJpeDJ4NGZ2KHQsITEsZSl9fWZ1bmN0aW9uIHJjKHIsdCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3IudW5pZm9ybU1hdHJpeDR4MmZ2KHQsITEsZSl9fWZ1bmN0aW9uIG5jKHIsdCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3IudW5pZm9ybU1hdHJpeDN4NGZ2KHQsITEsZSl9fWZ1bmN0aW9uIG9jKHIsdCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3IudW5pZm9ybU1hdHJpeDR4M2Z2KHQsITEsZSl9fWZ1bmN0aW9uIFUocix0LGUsbil7Y29uc3Qgbz1XbihyLHQpO3JldHVybiBOZShyKT9mdW5jdGlvbihpKXtsZXQgcyxhO3F0KHIsaSk/KHM9aSxhPW51bGwpOihzPWkudGV4dHVyZSxhPWkuc2FtcGxlciksci51bmlmb3JtMWkobixlKSxyLmFjdGl2ZVRleHR1cmUocHQrZSksci5iaW5kVGV4dHVyZShvLHMpLHIuYmluZFNhbXBsZXIoZSxhKX06ZnVuY3Rpb24oaSl7ci51bmlmb3JtMWkobixlKSxyLmFjdGl2ZVRleHR1cmUocHQrZSksci5iaW5kVGV4dHVyZShvLGkpfX1mdW5jdGlvbiBMKHIsdCxlLG4sbyl7Y29uc3QgaT1XbihyLHQpLHM9bmV3IEludDMyQXJyYXkobyk7Zm9yKGxldCBhPTA7YTxvOysrYSlzW2FdPWUrYTtyZXR1cm4gTmUocik/ZnVuY3Rpb24oYSl7ci51bmlmb3JtMWl2KG4scyksYS5mb3JFYWNoKGZ1bmN0aW9uKHUsZil7ci5hY3RpdmVUZXh0dXJlKHB0K3NbZl0pO2xldCBtLHA7cXQocix1KT8obT11LHA9bnVsbCk6KG09dS50ZXh0dXJlLHA9dS5zYW1wbGVyKSxyLmJpbmRTYW1wbGVyKGUscCksci5iaW5kVGV4dHVyZShpLG0pfSl9OmZ1bmN0aW9uKGEpe3IudW5pZm9ybTFpdihuLHMpLGEuZm9yRWFjaChmdW5jdGlvbih1LGYpe3IuYWN0aXZlVGV4dHVyZShwdCtzW2ZdKSxyLmJpbmRUZXh0dXJlKGksdSl9KX19Ylt5dF09e1R5cGU6RmxvYXQzMkFycmF5LHNpemU6NCxzZXR0ZXI6enUsYXJyYXlTZXR0ZXI6JHV9LGJbU25dPXtUeXBlOkZsb2F0MzJBcnJheSxzaXplOjgsc2V0dGVyOkd1LGNvbHM6Mn0sYltSbl09e1R5cGU6RmxvYXQzMkFycmF5LHNpemU6MTIsc2V0dGVyOld1LGNvbHM6M30sYltGbl09e1R5cGU6RmxvYXQzMkFycmF5LHNpemU6MTYsc2V0dGVyOlZ1LGNvbHM6NH0sYltkcl09e1R5cGU6SW50MzJBcnJheSxzaXplOjQsc2V0dGVyOlZuLGFycmF5U2V0dGVyOkhufSxiW1BuXT17VHlwZTpJbnQzMkFycmF5LHNpemU6OCxzZXR0ZXI6am4sY29sczoyfSxiW2tuXT17VHlwZTpJbnQzMkFycmF5LHNpemU6MTIsc2V0dGVyOlluLGNvbHM6M30sYltEbl09e1R5cGU6SW50MzJBcnJheSxzaXplOjE2LHNldHRlcjpYbixjb2xzOjR9LGJbbXJdPXtUeXBlOlVpbnQzMkFycmF5LHNpemU6NCxzZXR0ZXI6SHUsYXJyYXlTZXR0ZXI6anV9LGJbem5dPXtUeXBlOlVpbnQzMkFycmF5LHNpemU6OCxzZXR0ZXI6WXUsY29sczoyfSxiWyRuXT17VHlwZTpVaW50MzJBcnJheSxzaXplOjEyLHNldHRlcjpYdSxjb2xzOjN9LGJbR25dPXtUeXBlOlVpbnQzMkFycmF5LHNpemU6MTYsc2V0dGVyOlF1LGNvbHM6NH0sYltDbl09e1R5cGU6VWludDMyQXJyYXksc2l6ZTo0LHNldHRlcjpWbixhcnJheVNldHRlcjpIbn0sYltCbl09e1R5cGU6VWludDMyQXJyYXksc2l6ZTo4LHNldHRlcjpqbixjb2xzOjJ9LGJbTm5dPXtUeXBlOlVpbnQzMkFycmF5LHNpemU6MTIsc2V0dGVyOlluLGNvbHM6M30sYltPbl09e1R5cGU6VWludDMyQXJyYXksc2l6ZToxNixzZXR0ZXI6WG4sY29sczo0fSxiW01uXT17VHlwZTpGbG9hdDMyQXJyYXksc2l6ZTozMixzZXR0ZXI6S3Uscm93czoyLGNvbHM6Mn0sYltVbl09e1R5cGU6RmxvYXQzMkFycmF5LHNpemU6NDgsc2V0dGVyOnF1LHJvd3M6Myxjb2xzOjN9LGJbTG5dPXtUeXBlOkZsb2F0MzJBcnJheSxzaXplOjY0LHNldHRlcjpKdSxyb3dzOjQsY29sczo0fSxiW1R1XT17VHlwZTpGbG9hdDMyQXJyYXksc2l6ZTozMixzZXR0ZXI6WnUscm93czoyLGNvbHM6M30sYltBdV09e1R5cGU6RmxvYXQzMkFycmF5LHNpemU6MzIsc2V0dGVyOnRjLHJvd3M6Mixjb2xzOjR9LGJbd3VdPXtUeXBlOkZsb2F0MzJBcnJheSxzaXplOjQ4LHNldHRlcjplYyxyb3dzOjMsY29sczoyfSxiW0l1XT17VHlwZTpGbG9hdDMyQXJyYXksc2l6ZTo0OCxzZXR0ZXI6bmMscm93czozLGNvbHM6NH0sYltTdV09e1R5cGU6RmxvYXQzMkFycmF5LHNpemU6NjQsc2V0dGVyOnJjLHJvd3M6NCxjb2xzOjJ9LGJbUnVdPXtUeXBlOkZsb2F0MzJBcnJheSxzaXplOjY0LHNldHRlcjpvYyxyb3dzOjQsY29sczozfSxiW191XT17VHlwZTpudWxsLHNpemU6MCxzZXR0ZXI6VSxhcnJheVNldHRlcjpMLGJpbmRQb2ludDp4dH0sYltidV09e1R5cGU6bnVsbCxzaXplOjAsc2V0dGVyOlUsYXJyYXlTZXR0ZXI6TCxiaW5kUG9pbnQ6X3R9LGJbdnVdPXtUeXBlOm51bGwsc2l6ZTowLHNldHRlcjpVLGFycmF5U2V0dGVyOkwsYmluZFBvaW50OmhyfSxiW0V1XT17VHlwZTpudWxsLHNpemU6MCxzZXR0ZXI6VSxhcnJheVNldHRlcjpMLGJpbmRQb2ludDp4dH0sYltGdV09e1R5cGU6bnVsbCxzaXplOjAsc2V0dGVyOlUsYXJyYXlTZXR0ZXI6TCxiaW5kUG9pbnQ6YnR9LGJbUHVdPXtUeXBlOm51bGwsc2l6ZTowLHNldHRlcjpVLGFycmF5U2V0dGVyOkwsYmluZFBvaW50OmJ0fSxiW2t1XT17VHlwZTpudWxsLHNpemU6MCxzZXR0ZXI6VSxhcnJheVNldHRlcjpMLGJpbmRQb2ludDpfdH0sYltEdV09e1R5cGU6bnVsbCxzaXplOjAsc2V0dGVyOlUsYXJyYXlTZXR0ZXI6TCxiaW5kUG9pbnQ6eHR9LGJbQ3VdPXtUeXBlOm51bGwsc2l6ZTowLHNldHRlcjpVLGFycmF5U2V0dGVyOkwsYmluZFBvaW50OmhyfSxiW0J1XT17VHlwZTpudWxsLHNpemU6MCxzZXR0ZXI6VSxhcnJheVNldHRlcjpMLGJpbmRQb2ludDpfdH0sYltOdV09e1R5cGU6bnVsbCxzaXplOjAsc2V0dGVyOlUsYXJyYXlTZXR0ZXI6TCxiaW5kUG9pbnQ6YnR9LGJbT3VdPXtUeXBlOm51bGwsc2l6ZTowLHNldHRlcjpVLGFycmF5U2V0dGVyOkwsYmluZFBvaW50Onh0fSxiW011XT17VHlwZTpudWxsLHNpemU6MCxzZXR0ZXI6VSxhcnJheVNldHRlcjpMLGJpbmRQb2ludDpocn0sYltVdV09e1R5cGU6bnVsbCxzaXplOjAsc2V0dGVyOlUsYXJyYXlTZXR0ZXI6TCxiaW5kUG9pbnQ6X3R9LGJbTHVdPXtUeXBlOm51bGwsc2l6ZTowLHNldHRlcjpVLGFycmF5U2V0dGVyOkwsYmluZFBvaW50OmJ0fTtmdW5jdGlvbiB2dChyLHQpe3JldHVybiBmdW5jdGlvbihlKXtpZihlLnZhbHVlKXN3aXRjaChyLmRpc2FibGVWZXJ0ZXhBdHRyaWJBcnJheSh0KSxlLnZhbHVlLmxlbmd0aCl7Y2FzZSA0OnIudmVydGV4QXR0cmliNGZ2KHQsZS52YWx1ZSk7YnJlYWs7Y2FzZSAzOnIudmVydGV4QXR0cmliM2Z2KHQsZS52YWx1ZSk7YnJlYWs7Y2FzZSAyOnIudmVydGV4QXR0cmliMmZ2KHQsZS52YWx1ZSk7YnJlYWs7Y2FzZSAxOnIudmVydGV4QXR0cmliMWZ2KHQsZS52YWx1ZSk7YnJlYWs7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoInRoZSBsZW5ndGggb2YgYSBmbG9hdCBjb25zdGFudCB2YWx1ZSBtdXN0IGJlIGJldHdlZW4gMSBhbmQgNCEiKX1lbHNlIHIuYmluZEJ1ZmZlcihndCxlLmJ1ZmZlciksci5lbmFibGVWZXJ0ZXhBdHRyaWJBcnJheSh0KSxyLnZlcnRleEF0dHJpYlBvaW50ZXIodCxlLm51bUNvbXBvbmVudHN8fGUuc2l6ZSxlLnR5cGV8fHl0LGUubm9ybWFsaXplfHwhMSxlLnN0cmlkZXx8MCxlLm9mZnNldHx8MCksci52ZXJ0ZXhBdHRyaWJEaXZpc29yJiZyLnZlcnRleEF0dHJpYkRpdmlzb3IodCxlLmRpdmlzb3J8fDApfX1mdW5jdGlvbiBhZShyLHQpe3JldHVybiBmdW5jdGlvbihlKXtpZihlLnZhbHVlKWlmKHIuZGlzYWJsZVZlcnRleEF0dHJpYkFycmF5KHQpLGUudmFsdWUubGVuZ3RoPT09NClyLnZlcnRleEF0dHJpYjRpdih0LGUudmFsdWUpO2Vsc2UgdGhyb3cgbmV3IEVycm9yKCJUaGUgbGVuZ3RoIG9mIGFuIGludGVnZXIgY29uc3RhbnQgdmFsdWUgbXVzdCBiZSA0ISIpO2Vsc2Ugci5iaW5kQnVmZmVyKGd0LGUuYnVmZmVyKSxyLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KHQpLHIudmVydGV4QXR0cmliSVBvaW50ZXIodCxlLm51bUNvbXBvbmVudHN8fGUuc2l6ZSxlLnR5cGV8fGRyLGUuc3RyaWRlfHwwLGUub2Zmc2V0fHwwKSxyLnZlcnRleEF0dHJpYkRpdmlzb3ImJnIudmVydGV4QXR0cmliRGl2aXNvcih0LGUuZGl2aXNvcnx8MCl9fWZ1bmN0aW9uIEV0KHIsdCl7cmV0dXJuIGZ1bmN0aW9uKGUpe2lmKGUudmFsdWUpaWYoci5kaXNhYmxlVmVydGV4QXR0cmliQXJyYXkodCksZS52YWx1ZS5sZW5ndGg9PT00KXIudmVydGV4QXR0cmliNHVpdih0LGUudmFsdWUpO2Vsc2UgdGhyb3cgbmV3IEVycm9yKCJUaGUgbGVuZ3RoIG9mIGFuIHVuc2lnbmVkIGludGVnZXIgY29uc3RhbnQgdmFsdWUgbXVzdCBiZSA0ISIpO2Vsc2Ugci5iaW5kQnVmZmVyKGd0LGUuYnVmZmVyKSxyLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KHQpLHIudmVydGV4QXR0cmliSVBvaW50ZXIodCxlLm51bUNvbXBvbmVudHN8fGUuc2l6ZSxlLnR5cGV8fG1yLGUuc3RyaWRlfHwwLGUub2Zmc2V0fHwwKSxyLnZlcnRleEF0dHJpYkRpdmlzb3ImJnIudmVydGV4QXR0cmliRGl2aXNvcih0LGUuZGl2aXNvcnx8MCl9fWZ1bmN0aW9uIHByKHIsdCxlKXtjb25zdCBuPWUuc2l6ZSxvPWUuY291bnQ7cmV0dXJuIGZ1bmN0aW9uKGkpe3IuYmluZEJ1ZmZlcihndCxpLmJ1ZmZlcik7Y29uc3Qgcz1pLnNpemV8fGkubnVtQ29tcG9uZW50c3x8bixhPXMvbyx1PWkudHlwZXx8eXQsbT1iW3VdLnNpemUqcyxwPWkubm9ybWFsaXplfHwhMSxnPWkub2Zmc2V0fHwwLHg9bS9vO2ZvcihsZXQgZD0wO2Q8bzsrK2Qpci5lbmFibGVWZXJ0ZXhBdHRyaWJBcnJheSh0K2QpLHIudmVydGV4QXR0cmliUG9pbnRlcih0K2QsYSx1LHAsbSxnK3gqZCksci52ZXJ0ZXhBdHRyaWJEaXZpc29yJiZyLnZlcnRleEF0dHJpYkRpdmlzb3IodCtkLGkuZGl2aXNvcnx8MCl9fWNvbnN0IFA9e307UFt5dF09e3NpemU6NCxzZXR0ZXI6dnR9LFBbU25dPXtzaXplOjgsc2V0dGVyOnZ0fSxQW1JuXT17c2l6ZToxMixzZXR0ZXI6dnR9LFBbRm5dPXtzaXplOjE2LHNldHRlcjp2dH0sUFtkcl09e3NpemU6NCxzZXR0ZXI6YWV9LFBbUG5dPXtzaXplOjgsc2V0dGVyOmFlfSxQW2tuXT17c2l6ZToxMixzZXR0ZXI6YWV9LFBbRG5dPXtzaXplOjE2LHNldHRlcjphZX0sUFttcl09e3NpemU6NCxzZXR0ZXI6RXR9LFBbem5dPXtzaXplOjgsc2V0dGVyOkV0fSxQWyRuXT17c2l6ZToxMixzZXR0ZXI6RXR9LFBbR25dPXtzaXplOjE2LHNldHRlcjpFdH0sUFtDbl09e3NpemU6NCxzZXR0ZXI6YWV9LFBbQm5dPXtzaXplOjgsc2V0dGVyOmFlfSxQW05uXT17c2l6ZToxMixzZXR0ZXI6YWV9LFBbT25dPXtzaXplOjE2LHNldHRlcjphZX0sUFtNbl09e3NpemU6NCxzZXR0ZXI6cHIsY291bnQ6Mn0sUFtVbl09e3NpemU6OSxzZXR0ZXI6cHIsY291bnQ6M30sUFtMbl09e3NpemU6MTYsc2V0dGVyOnByLGNvdW50OjR9O2NvbnN0IGljPS9FUlJPUjpccypcZCs6KFxkKykvZ2k7ZnVuY3Rpb24gc2Mocix0PSIiLGU9MCl7Y29uc3Qgbj1bLi4udC5tYXRjaEFsbChpYyldLG89bmV3IE1hcChuLm1hcCgoaSxzKT0+e2NvbnN0IGE9cGFyc2VJbnQoaVsxXSksdT1uW3MrMV0sZj11P3UuaW5kZXg6dC5sZW5ndGgsbT10LnN1YnN0cmluZyhpLmluZGV4LGYpO3JldHVyblthLTEsbV19KSk7cmV0dXJuIHIuc3BsaXQoYApgKS5tYXAoKGkscyk9Pntjb25zdCBhPW8uZ2V0KHMpO3JldHVybmAke3MrMStlfTogJHtpfSR7YT9gCgpeXl4gJHthfWA6IiJ9YH0pLmpvaW4oYApgKX1jb25zdCBRbj0vXlsgXHRdKlxuLztmdW5jdGlvbiBLbihyKXtsZXQgdD0wO3JldHVybiBRbi50ZXN0KHIpJiYodD0xLHI9ci5yZXBsYWNlKFFuLCIiKSkse2xpbmVPZmZzZXQ6dCxzaGFkZXJTb3VyY2U6cn19ZnVuY3Rpb24gYWMocix0KXtyZXR1cm4gci5lcnJvckNhbGxiYWNrKHQpLHIuY2FsbGJhY2smJnNldFRpbWVvdXQoKCk9PntyLmNhbGxiYWNrKGAke3R9CiR7ci5lcnJvcnMuam9pbihgCmApfWApfSksbnVsbH1mdW5jdGlvbiB1YyhyLHQsZSxuKXtpZihuPW58fGxyLCFyLmdldFNoYWRlclBhcmFtZXRlcihlLGF1KSl7Y29uc3QgaT1yLmdldFNoYWRlckluZm9Mb2coZSkse2xpbmVPZmZzZXQ6cyxzaGFkZXJTb3VyY2U6YX09S24oci5nZXRTaGFkZXJTb3VyY2UoZSkpLHU9YCR7c2MoYSxpLHMpfQpFcnJvciBjb21waWxpbmcgJHtubihyLHQpfTogJHtpfWA7cmV0dXJuIG4odSksdX1yZXR1cm4iIn1mdW5jdGlvbiBncihyLHQsZSl7bGV0IG4sbyxpO2lmKHR5cGVvZiB0PT0iZnVuY3Rpb24iJiYoZT10LHQ9dm9pZCAwKSx0eXBlb2Ygcj09ImZ1bmN0aW9uIillPXIscj12b2lkIDA7ZWxzZSBpZihyJiYhQXJyYXkuaXNBcnJheShyKSl7Y29uc3QgZj1yO2U9Zi5lcnJvckNhbGxiYWNrLHI9Zi5hdHRyaWJMb2NhdGlvbnMsbj1mLnRyYW5zZm9ybUZlZWRiYWNrVmFyeWluZ3Msbz1mLnRyYW5zZm9ybUZlZWRiYWNrTW9kZSxpPWYuY2FsbGJhY2t9Y29uc3Qgcz1lfHxscixhPVtdLHU9e2Vycm9yQ2FsbGJhY2soZiwuLi5tKXthLnB1c2goZikscyhmLC4uLm0pfSx0cmFuc2Zvcm1GZWVkYmFja1ZhcnlpbmdzOm4sdHJhbnNmb3JtRmVlZGJhY2tNb2RlOm8sY2FsbGJhY2s6aSxlcnJvcnM6YX07e2xldCBmPXt9O0FycmF5LmlzQXJyYXkocik/ci5mb3JFYWNoKGZ1bmN0aW9uKG0scCl7ZlttXT10P3RbcF06cH0pOmY9cnx8e30sdS5hdHRyaWJMb2NhdGlvbnM9Zn1yZXR1cm4gdX1jb25zdCBjYz1bIlZFUlRFWF9TSEFERVIiLCJGUkFHTUVOVF9TSEFERVIiXTtmdW5jdGlvbiBmYyhyLHQpe2lmKHQuaW5kZXhPZigiZnJhZyIpPj0wKXJldHVybiBjdTtpZih0LmluZGV4T2YoInZlcnQiKT49MClyZXR1cm4gZnV9ZnVuY3Rpb24gbGMocix0LGUpe2NvbnN0IG49ci5nZXRBdHRhY2hlZFNoYWRlcnModCk7Zm9yKGNvbnN0IG8gb2YgbillLmhhcyhvKSYmci5kZWxldGVTaGFkZXIobyk7ci5kZWxldGVQcm9ncmFtKHQpfWNvbnN0IGRjPShyPTApPT5uZXcgUHJvbWlzZSh0PT5zZXRUaW1lb3V0KHQscikpO2Z1bmN0aW9uIG1jKHIsdCxlKXtjb25zdCBuPXIuY3JlYXRlUHJvZ3JhbSgpLHthdHRyaWJMb2NhdGlvbnM6byx0cmFuc2Zvcm1GZWVkYmFja1ZhcnlpbmdzOmksdHJhbnNmb3JtRmVlZGJhY2tNb2RlOnN9PWdyKGUpO2ZvcihsZXQgYT0wO2E8dC5sZW5ndGg7KythKXtsZXQgdT10W2FdO2lmKHR5cGVvZiB1PT0ic3RyaW5nIil7Y29uc3QgZj13bih1KSxtPWY/Zi50ZXh0OnU7bGV0IHA9cltjY1thXV07ZiYmZi50eXBlJiYocD1mYyhyLGYudHlwZSl8fHApLHU9ci5jcmVhdGVTaGFkZXIocCksci5zaGFkZXJTb3VyY2UodSxLbihtKS5zaGFkZXJTb3VyY2UpLHIuY29tcGlsZVNoYWRlcih1KSxyLmF0dGFjaFNoYWRlcihuLHUpfX1PYmplY3QuZW50cmllcyhvKS5mb3JFYWNoKChbYSx1XSk9PnIuYmluZEF0dHJpYkxvY2F0aW9uKG4sdSxhKSk7e2xldCBhPWk7YSYmKGEuYXR0cmlicyYmKGE9YS5hdHRyaWJzKSxBcnJheS5pc0FycmF5KGEpfHwoYT1PYmplY3Qua2V5cyhhKSksci50cmFuc2Zvcm1GZWVkYmFja1ZhcnlpbmdzKG4sYSxzfHxsdSkpfXJldHVybiByLmxpbmtQcm9ncmFtKG4pLG59ZnVuY3Rpb24gaGMocix0LGUsbixvKXtjb25zdCBpPWdyKGUsbixvKSxzPW5ldyBTZXQodCksYT1tYyhyLHQsaSk7ZnVuY3Rpb24gdShmLG0pe2NvbnN0IHA9Z2MoZixtLGkuZXJyb3JDYWxsYmFjayk7cmV0dXJuIHAmJmxjKGYsbSxzKSxwfWlmKGkuY2FsbGJhY2spe3BjKHIsYSkudGhlbigoKT0+e2NvbnN0IGY9dShyLGEpO2kuY2FsbGJhY2soZixmP3ZvaWQgMDphKX0pO3JldHVybn1yZXR1cm4gdShyLGEpP3ZvaWQgMDphfWFzeW5jIGZ1bmN0aW9uIHBjKHIsdCl7Y29uc3QgZT1yLmdldEV4dGVuc2lvbigiS0hSX3BhcmFsbGVsX3NoYWRlcl9jb21waWxlIiksbj1lPyhpLHMpPT5pLmdldFByb2dyYW1QYXJhbWV0ZXIocyxlLkNPTVBMRVRJT05fU1RBVFVTX0tIUik6KCk9PiEwO2xldCBvPTA7ZG8gYXdhaXQgZGMobyksbz0xZTMvNjA7d2hpbGUoIW4ocix0KSl9ZnVuY3Rpb24gZ2Mocix0LGUpe2lmKGU9ZXx8bHIsIXIuZ2V0UHJvZ3JhbVBhcmFtZXRlcih0LHV1KSl7Y29uc3Qgbz1yLmdldFByb2dyYW1JbmZvTG9nKHQpO2UoYEVycm9yIGluIHByb2dyYW0gbGlua2luZzogJHtvfWApO2NvbnN0IHM9ci5nZXRBdHRhY2hlZFNoYWRlcnModCkubWFwKGE9PnVjKHIsci5nZXRTaGFkZXJQYXJhbWV0ZXIoYSxyLlNIQURFUl9UWVBFKSxhLGUpKTtyZXR1cm5gJHtvfQoke3MuZmlsdGVyKGE9PmEpLmpvaW4oYApgKX1gfX1mdW5jdGlvbiB5YyhyLHQsZSxuLG8pe3JldHVybiBoYyhyLHQsZSxuLG8pfWZ1bmN0aW9uIHFuKHIpe2NvbnN0IHQ9ci5uYW1lO3JldHVybiB0LnN0YXJ0c1dpdGgoImdsXyIpfHx0LnN0YXJ0c1dpdGgoIndlYmdsXyIpfWNvbnN0IHhjPS8oXC58XFt8XXxcdyspL2csX2M9cj0+cj49IjAiJiZyPD0iOSI7ZnVuY3Rpb24gYmMocix0LGUsbil7Y29uc3Qgbz1yLnNwbGl0KHhjKS5maWx0ZXIoYT0+YSE9PSIiKTtsZXQgaT0wLHM9IiI7Zm9yKDs7KXtjb25zdCBhPW9baSsrXTtzKz1hO2NvbnN0IHU9X2MoYVswXSksZj11P3BhcnNlSW50KGEpOmE7aWYodSYmKHMrPW9baSsrXSksaT09PW8ubGVuZ3RoKXtlW2ZdPXQ7YnJlYWt9ZWxzZXtjb25zdCBwPW9baSsrXSxnPXA9PT0iWyIseD1lW2ZdfHwoZz9bXTp7fSk7ZVtmXT14LGU9eCxuW3NdPW5bc118fGZ1bmN0aW9uKGQpe3JldHVybiBmdW5jdGlvbihfKXtKbihkLF8pfX0oeCkscys9cH19fWZ1bmN0aW9uIHZjKHIsdCl7bGV0IGU9MDtmdW5jdGlvbiBuKGEsdSxmKXtjb25zdCBtPXUubmFtZS5lbmRzV2l0aCgiWzBdIikscD11LnR5cGUsZz1iW3BdO2lmKCFnKXRocm93IG5ldyBFcnJvcihgdW5rbm93biB0eXBlOiAweCR7cC50b1N0cmluZygxNil9YCk7bGV0IHg7aWYoZy5iaW5kUG9pbnQpe2NvbnN0IGQ9ZTtlKz11LnNpemUsbT94PWcuYXJyYXlTZXR0ZXIocixwLGQsZix1LnNpemUpOng9Zy5zZXR0ZXIocixwLGQsZix1LnNpemUpfWVsc2UgZy5hcnJheVNldHRlciYmbT94PWcuYXJyYXlTZXR0ZXIocixmKTp4PWcuc2V0dGVyKHIsZik7cmV0dXJuIHgubG9jYXRpb249Zix4fWNvbnN0IG89e30saT17fSxzPXIuZ2V0UHJvZ3JhbVBhcmFtZXRlcih0LEluKTtmb3IobGV0IGE9MDthPHM7KythKXtjb25zdCB1PXIuZ2V0QWN0aXZlVW5pZm9ybSh0LGEpO2lmKHFuKHUpKWNvbnRpbnVlO2xldCBmPXUubmFtZTtmLmVuZHNXaXRoKCJbMF0iKSYmKGY9Zi5zdWJzdHIoMCxmLmxlbmd0aC0zKSk7Y29uc3QgbT1yLmdldFVuaWZvcm1Mb2NhdGlvbih0LHUubmFtZSk7aWYobSl7Y29uc3QgcD1uKHQsdSxtKTtvW2ZdPXAsYmMoZixwLGksbyl9fXJldHVybiBvfWZ1bmN0aW9uIEVjKHIsdCl7Y29uc3QgZT17fSxuPXIuZ2V0UHJvZ3JhbVBhcmFtZXRlcih0LG11KTtmb3IobGV0IG89MDtvPG47KytvKXtjb25zdCBpPXIuZ2V0VHJhbnNmb3JtRmVlZGJhY2tWYXJ5aW5nKHQsbyk7ZVtpLm5hbWVdPXtpbmRleDpvLHR5cGU6aS50eXBlLHNpemU6aS5zaXplfX1yZXR1cm4gZX1mdW5jdGlvbiBUYyhyLHQpe2NvbnN0IGU9ci5nZXRQcm9ncmFtUGFyYW1ldGVyKHQsSW4pLG49W10sbz1bXTtmb3IobGV0IGE9MDthPGU7KythKXtvLnB1c2goYSksbi5wdXNoKHt9KTtjb25zdCB1PXIuZ2V0QWN0aXZlVW5pZm9ybSh0LGEpO25bYV0ubmFtZT11Lm5hbWV9W1siVU5JRk9STV9UWVBFIiwidHlwZSJdLFsiVU5JRk9STV9TSVpFIiwic2l6ZSJdLFsiVU5JRk9STV9CTE9DS19JTkRFWCIsImJsb2NrTmR4Il0sWyJVTklGT1JNX09GRlNFVCIsIm9mZnNldCJdXS5mb3JFYWNoKGZ1bmN0aW9uKGEpe2NvbnN0IHU9YVswXSxmPWFbMV07ci5nZXRBY3RpdmVVbmlmb3Jtcyh0LG8sclt1XSkuZm9yRWFjaChmdW5jdGlvbihtLHApe25bcF1bZl09bX0pfSk7Y29uc3QgaT17fSxzPXIuZ2V0UHJvZ3JhbVBhcmFtZXRlcih0LGh1KTtmb3IobGV0IGE9MDthPHM7KythKXtjb25zdCB1PXIuZ2V0QWN0aXZlVW5pZm9ybUJsb2NrTmFtZSh0LGEpLGY9e2luZGV4OnIuZ2V0VW5pZm9ybUJsb2NrSW5kZXgodCx1KSx1c2VkQnlWZXJ0ZXhTaGFkZXI6ci5nZXRBY3RpdmVVbmlmb3JtQmxvY2tQYXJhbWV0ZXIodCxhLHB1KSx1c2VkQnlGcmFnbWVudFNoYWRlcjpyLmdldEFjdGl2ZVVuaWZvcm1CbG9ja1BhcmFtZXRlcih0LGEsZ3UpLHNpemU6ci5nZXRBY3RpdmVVbmlmb3JtQmxvY2tQYXJhbWV0ZXIodCxhLHl1KSx1bmlmb3JtSW5kaWNlczpyLmdldEFjdGl2ZVVuaWZvcm1CbG9ja1BhcmFtZXRlcih0LGEseHUpfTtmLnVzZWQ9Zi51c2VkQnlWZXJ0ZXhTaGFkZXJ8fGYudXNlZEJ5RnJhZ21lbnRTaGFkZXIsaVt1XT1mfXJldHVybntibG9ja1NwZWNzOmksdW5pZm9ybURhdGE6bn19ZnVuY3Rpb24gSm4ocix0KXtmb3IoY29uc3QgZSBpbiB0KXtjb25zdCBuPXJbZV07dHlwZW9mIG49PSJmdW5jdGlvbiI/bih0W2VdKTpKbihyW2VdLHRbZV0pfX1mdW5jdGlvbiBabihyLC4uLnQpe2NvbnN0IGU9ci51bmlmb3JtU2V0dGVyc3x8cixuPXQubGVuZ3RoO2ZvcihsZXQgbz0wO288bjsrK28pe2NvbnN0IGk9dFtvXTtpZihBcnJheS5pc0FycmF5KGkpKXtjb25zdCBzPWkubGVuZ3RoO2ZvcihsZXQgYT0wO2E8czsrK2EpWm4oZSxpW2FdKX1lbHNlIGZvcihjb25zdCBzIGluIGkpe2NvbnN0IGE9ZVtzXTthJiZhKGlbc10pfX19ZnVuY3Rpb24gQWMocix0KXtjb25zdCBlPXt9LG49ci5nZXRQcm9ncmFtUGFyYW1ldGVyKHQsZHUpO2ZvcihsZXQgbz0wO288bjsrK28pe2NvbnN0IGk9ci5nZXRBY3RpdmVBdHRyaWIodCxvKTtpZihxbihpKSljb250aW51ZTtjb25zdCBzPXIuZ2V0QXR0cmliTG9jYXRpb24odCxpLm5hbWUpLGE9UFtpLnR5cGVdLHU9YS5zZXR0ZXIocixzLGEpO3UubG9jYXRpb249cyxlW2kubmFtZV09dX1yZXR1cm4gZX1mdW5jdGlvbiB3YyhyLHQpe2Zvcihjb25zdCBlIGluIHQpe2NvbnN0IG49cltlXTtuJiZuKHRbZV0pfX1mdW5jdGlvbiBJYyhyLHQsZSl7ZS52ZXJ0ZXhBcnJheU9iamVjdD9yLmJpbmRWZXJ0ZXhBcnJheShlLnZlcnRleEFycmF5T2JqZWN0KTood2ModC5hdHRyaWJTZXR0ZXJzfHx0LGUuYXR0cmlicyksZS5pbmRpY2VzJiZyLmJpbmRCdWZmZXIoc3UsZS5pbmRpY2VzKSl9ZnVuY3Rpb24gZW8ocix0KXtjb25zdCBlPXZjKHIsdCksbj1BYyhyLHQpLG89e3Byb2dyYW06dCx1bmlmb3JtU2V0dGVyczplLGF0dHJpYlNldHRlcnM6bn07cmV0dXJuIE5lKHIpJiYoby51bmlmb3JtQmxvY2tTcGVjPVRjKHIsdCksby50cmFuc2Zvcm1GZWVkYmFja0luZm89RWMocix0KSksb31jb25zdCBTYz0vXHN8e3x9fDsvO2Z1bmN0aW9uIFJjKHIsdCxlLG4sbyl7Y29uc3QgaT1ncihlLG4sbykscz1bXTtpZih0PXQubWFwKGZ1bmN0aW9uKGYpe2lmKCFTYy50ZXN0KGYpKXtjb25zdCBtPXduKGYpO2lmKG0pZj1tLnRleHQ7ZWxzZXtjb25zdCBwPWBubyBlbGVtZW50IHdpdGggaWQ6ICR7Zn1gO2kuZXJyb3JDYWxsYmFjayhwKSxzLnB1c2gocCl9fXJldHVybiBmfSkscy5sZW5ndGgpcmV0dXJuIGFjKGksIiIpO2NvbnN0IGE9aS5jYWxsYmFjazthJiYoaS5jYWxsYmFjaz0oZixtKT0+e2EoZixmP3ZvaWQgMDplbyhyLG0pKX0pO2NvbnN0IHU9eWMocix0LGkpO3JldHVybiB1P2VvKHIsdSk6bnVsbH1jb25zdCBGYz00LHRvPTUxMjM7ZnVuY3Rpb24gUGMocix0LGUsbixvLGkpe2U9ZT09PXZvaWQgMD9GYzplO2NvbnN0IHM9dC5pbmRpY2VzLGE9dC5lbGVtZW50VHlwZSx1PW49PT12b2lkIDA/dC5udW1FbGVtZW50czpuO289bz09PXZvaWQgMD8wOm8sYXx8cz9pIT09dm9pZCAwP3IuZHJhd0VsZW1lbnRzSW5zdGFuY2VkKGUsdSxhPT09dm9pZCAwP3RvOnQuZWxlbWVudFR5cGUsbyxpKTpyLmRyYXdFbGVtZW50cyhlLHUsYT09PXZvaWQgMD90bzp0LmVsZW1lbnRUeXBlLG8pOmkhPT12b2lkIDA/ci5kcmF3QXJyYXlzSW5zdGFuY2VkKGUsbyx1LGkpOnIuZHJhd0FycmF5cyhlLG8sdSl9Y29uc3Qgcm89MzYxNjAsVHQ9MzYxNjEsa2M9MzU1MyxEYz01MTIxLENjPTY0MDIsQmM9NjQwOCxOYz0zMzE5MCxPYz0zNjAxMixNYz0zNTA1NixVYz0zNjAxMyxMYz0zMjg1NCx6Yz0zMjg1NSwkYz0zNjE5NCxubz0zMzE4OSxvbz02NDAxLGlvPTM2MTY4LHlyPTM0MDQxLHhyPTM2MDY0LEF0PTM2MDk2LHNvPTM2MTI4LF9yPTMzMzA2LGJyPTMzMDcxLHZyPTk3MjksR2M9W3tmb3JtYXQ6QmMsdHlwZTpEYyxtaW46dnIsd3JhcDpicn0se2Zvcm1hdDp5cn1dLFk9e307WVt5cl09X3IsWVtvb109c28sWVtpb109c28sWVtDY109QXQsWVtub109QXQsWVtOY109QXQsWVtPY109QXQsWVtNY109X3IsWVtVY109X3I7ZnVuY3Rpb24gV2Mocix0KXtyZXR1cm4gWVtyXXx8WVt0XX1jb25zdCB1ZT17fTt1ZVtMY109ITAsdWVbemNdPSEwLHVlWyRjXT0hMCx1ZVt5cl09ITAsdWVbbm9dPSEwLHVlW29vXT0hMCx1ZVtpb109ITA7ZnVuY3Rpb24gVmMocil7cmV0dXJuIHVlW3JdfWNvbnN0IEhjPTMyO2Z1bmN0aW9uIGpjKHIpe3JldHVybiByPj14ciYmcjx4citIY31mdW5jdGlvbiB3dChyLHQsZSxuKXtjb25zdCBvPXJvLGk9ci5jcmVhdGVGcmFtZWJ1ZmZlcigpO3IuYmluZEZyYW1lYnVmZmVyKG8saSksZT1lfHxyLmRyYXdpbmdCdWZmZXJXaWR0aCxuPW58fHIuZHJhd2luZ0J1ZmZlckhlaWdodCx0PXR8fEdjO2NvbnN0IHM9W10sYT17ZnJhbWVidWZmZXI6aSxhdHRhY2htZW50czpbXSx3aWR0aDplLGhlaWdodDpufTtyZXR1cm4gdC5mb3JFYWNoKGZ1bmN0aW9uKHUsZil7bGV0IG09dS5hdHRhY2htZW50O2NvbnN0IHA9dS5zYW1wbGVzLGc9dS5mb3JtYXQ7bGV0IHg9dS5hdHRhY2htZW50UG9pbnR8fFdjKGcsdS5pbnRlcm5hbEZvcm1hdCk7aWYoeHx8KHg9eHIrZiksamMoeCkmJnMucHVzaCh4KSwhbSlpZihwIT09dm9pZCAwfHxWYyhnKSltPXIuY3JlYXRlUmVuZGVyYnVmZmVyKCksci5iaW5kUmVuZGVyYnVmZmVyKFR0LG0pLHA+MT9yLnJlbmRlcmJ1ZmZlclN0b3JhZ2VNdWx0aXNhbXBsZShUdCxwLGcsZSxuKTpyLnJlbmRlcmJ1ZmZlclN0b3JhZ2UoVHQsZyxlLG4pO2Vsc2V7Y29uc3QgZD1PYmplY3QuYXNzaWduKHt9LHUpO2Qud2lkdGg9ZSxkLmhlaWdodD1uLGQuYXV0bz09PXZvaWQgMCYmKGQuYXV0bz0hMSxkLm1pbj1kLm1pbnx8ZC5taW5NYWd8fHZyLGQubWFnPWQubWFnfHxkLm1pbk1hZ3x8dnIsZC53cmFwUz1kLndyYXBTfHxkLndyYXB8fGJyLGQud3JhcFQ9ZC53cmFwVHx8ZC53cmFwfHxiciksbT1BbihyLGQpfWlmKG5zKHIsbSkpci5mcmFtZWJ1ZmZlclJlbmRlcmJ1ZmZlcihvLHgsVHQsbSk7ZWxzZSBpZihxdChyLG0pKXUubGF5ZXIhPT12b2lkIDA/ci5mcmFtZWJ1ZmZlclRleHR1cmVMYXllcihvLHgsbSx1LmxldmVsfHwwLHUubGF5ZXIpOnIuZnJhbWVidWZmZXJUZXh0dXJlMkQobyx4LHUudGFyZ2V0fHxrYyxtLHUubGV2ZWx8fDApO2Vsc2UgdGhyb3cgbmV3IEVycm9yKCJ1bmtub3duIGF0dGFjaG1lbnQgdHlwZSIpO2EuYXR0YWNobWVudHMucHVzaChtKX0pLHIuZHJhd0J1ZmZlcnMmJnIuZHJhd0J1ZmZlcnMocyksYX1mdW5jdGlvbiBZYyhyLHQsZSl7ZT1lfHxybyx0PyhyLmJpbmRGcmFtZWJ1ZmZlcihlLHQuZnJhbWVidWZmZXIpLHIudmlld3BvcnQoMCwwLHQud2lkdGgsdC5oZWlnaHQpKTooci5iaW5kRnJhbWVidWZmZXIoZSxudWxsKSxyLnZpZXdwb3J0KDAsMCxyLmRyYXdpbmdCdWZmZXJXaWR0aCxyLmRyYXdpbmdCdWZmZXJIZWlnaHQpKX1mdW5jdGlvbiBJKHIsdCl7cmV0dXJuKCk9PnQgaW5zdGFuY2VvZiBXZWJHTFRleHR1cmU/dDpBbihyLHtzcmM6dCx3cmFwOnIuQ0xBTVBfVE9fRURHRX0pfWNvbnN0IEZlPTI7Y2xhc3MgX2V7Y29uc3RydWN0b3IodCl7bCh0aGlzLCJpZCIsIl8iKTtsKHRoaXMsImNvbnRleHQiKTtsKHRoaXMsIm91dHB1dCIpO2wodGhpcywiZmJpIik7bCh0aGlzLCJvcHRpb25zIik7bCh0aGlzLCJwcm9ncmFtSW5mbyIpO2wodGhpcywiYnVmZmVySW5mbyIpO2wodGhpcywicHJvZmlsZXIiKTtsKHRoaXMsImxhc3RSdW4iKTtjb25zdHtjb250ZXh0OmUsd2lkdGg6bixoZWlnaHQ6b309dDt0aGlzLmNvbnRleHQ9ZSx0aGlzLm9wdGlvbnM9dDtjb25zdCBpPXRoaXMuYnVpbGREZWZpbmVzKCk7dGhpcy5wcm9ncmFtSW5mbz1SYyh0aGlzLmNvbnRleHQsW2krdGhpcy5nZXRWZXJ0ZXhTaGFkZXIoKSxpK3RoaXMuZ2V0RnJhZ21lbnRTaGFkZXIoKV0pLHRoaXMuYnVmZmVySW5mbz1Tcyh0aGlzLmNvbnRleHQsdGhpcy5nZXRCdWZmZXJzKCkpLHRoaXMuZmJpPXd0KHRoaXMuY29udGV4dCxbe2Zvcm1hdDp0aGlzLmNvbnRleHQuUkdCQSx0eXBlOnRoaXMuY29udGV4dC5VTlNJR05FRF9CWVRFLG1pbjp0aGlzLmNvbnRleHQuTElORUFSLHdyYXA6dGhpcy5jb250ZXh0LkNMQU1QX1RPX0VER0V9XSxuLG8pLHRoaXMub3V0cHV0PXRoaXMuZmJpLmF0dGFjaG1lbnRzWzBdfXJlc2l6ZU91dHB1dCh0LGUpe3RoaXMuZmJpPXd0KHRoaXMuY29udGV4dCxbe2Zvcm1hdDp0aGlzLmNvbnRleHQuUkdCQSx0eXBlOnRoaXMuY29udGV4dC5VTlNJR05FRF9CWVRFLG1pbjp0aGlzLmNvbnRleHQuTElORUFSLHdyYXA6dGhpcy5jb250ZXh0LkNMQU1QX1RPX0VER0V9XSx0LGUpLHRoaXMub3B0aW9ucy53aWR0aD10LHRoaXMub3B0aW9ucy5oZWlnaHQ9ZSx0aGlzLm91dHB1dD10aGlzLmZiaS5hdHRhY2htZW50c1swXX1nZXREZWZpbmVzKCl7cmV0dXJue319Z2V0QnVmZmVycygpe3JldHVybntwb3NpdGlvbjp7bnVtQ29tcG9uZW50czoyLGRhdGE6Wy0xLC0xLC0xLDEsMSwtMSwxLDEsLTEsMSwxLC0xXX0sdGV4dHVyZV9jb29yZDp7bnVtQ29tcG9uZW50czoyLGRhdGE6WzAsMCwwLDEsMSwwLDEsMSwwLDEsMSwwXX19fWJ1aWxkRGVmaW5lcygpe2xldCB0PSIiO2NvbnN0IGU9dGhpcy5nZXREZWZpbmVzKCk7Zm9yKGxldCBuIGluIGUpdCs9YCNkZWZpbmUgJHtufSAke2Vbbl0udG9GaXhlZCgxKX0KYDtyZXR1cm4gdH1ydW4odCl7dmFyIG8saSxzLGEsdSxmOyhvPXRoaXMucHJvZmlsZXIpPT1udWxsfHxvLnB1c2hDb250ZXh0KGBbJHt0aGlzLmlkfV0gUFJPRyA6ICR7dGhpcy5jb25zdHJ1Y3Rvci5uYW1lfWApLChpPXRoaXMucHJvZmlsZXIpPT1udWxsfHxpLnB1c2hDb250ZXh0KGBbJHt0aGlzLmlkfV0gVU5JRk9STVNgKTtmb3IoY29uc3QgbSBpbiB0KXR5cGVvZiB0W21dPT0iZnVuY3Rpb24iJiYoKHM9dGhpcy5wcm9maWxlcik9PW51bGx8fHMucHVzaENvbnRleHQoYFske3RoaXMuaWR9XSBVTkkgOiAke219YCksdFttXT10W21dKCksKGE9dGhpcy5wcm9maWxlcik9PW51bGx8fGEucG9wQ29udGV4dChgWyR7dGhpcy5pZH1dIFVOSSA6ICR7bX1gKSk7KHU9dGhpcy5wcm9maWxlcik9PW51bGx8fHUucG9wQ29udGV4dChgWyR7dGhpcy5pZH1dIFVOSUZPUk1TYCk7Y29uc3QgZT1EYXRlLm5vdygpO2xldCBuPTA7dGhpcy5sYXN0UnVuJiYobj0oZS10aGlzLmxhc3RSdW4pLzFlMyksdGhpcy5sYXN0UnVuPWUsdGhpcy5jb250ZXh0LnZpZXdwb3J0KDAsMCx0aGlzLmNvbnRleHQuY2FudmFzLndpZHRoLHRoaXMuY29udGV4dC5jYW52YXMuaGVpZ2h0KSx0aGlzLmNvbnRleHQudXNlUHJvZ3JhbSh0aGlzLnByb2dyYW1JbmZvLnByb2dyYW0pLEljKHRoaXMuY29udGV4dCx0aGlzLnByb2dyYW1JbmZvLHRoaXMuYnVmZmVySW5mbyksWm4odGhpcy5wcm9ncmFtSW5mbyx7ZGVsdGE6bixjYW52YXM6W3RoaXMuY29udGV4dC5jYW52YXMud2lkdGgsdGhpcy5jb250ZXh0LmNhbnZhcy5oZWlnaHRdLC4uLnR9KSxZYyh0aGlzLmNvbnRleHQsdGhpcy5vcHRpb25zLmRpc2FibGVGcmFtZWJ1ZmZlcj9udWxsOnRoaXMuZmJpKSxQYyh0aGlzLmNvbnRleHQsdGhpcy5idWZmZXJJbmZvKSwoZj10aGlzLnByb2ZpbGVyKT09bnVsbHx8Zi5wb3BDb250ZXh0KGBbJHt0aGlzLmlkfV0gUFJPRyA6ICR7dGhpcy5jb25zdHJ1Y3Rvci5uYW1lfWApfXNldFByb2ZpbGVyKHQpe3RoaXMucHJvZmlsZXI9dH19dmFyIFhjPWBwcmVjaXNpb24gbWVkaXVtcCBmbG9hdDsKCnZhcnlpbmcgdmVjMiBfdGV4dHVyZV9jb29yZDsKCnVuaWZvcm0gc2FtcGxlcjJEIGJhY2tncm91bmQ7CnVuaWZvcm0gc2FtcGxlcjJEIGZvcmVncm91bmQ7CnVuaWZvcm0gc2FtcGxlcjJEIHRocmVzaG9sZDsKCnZvaWQgbWFpbigpIHsKICB2ZWM0IGJhY2tncm91bmRDb2xvciA9IHRleHR1cmUyRChiYWNrZ3JvdW5kLCBfdGV4dHVyZV9jb29yZCk7CiAgdmVjNCBmb3JlZ3JvdW5kQ29sb3IgPSB0ZXh0dXJlMkQoZm9yZWdyb3VuZCwgX3RleHR1cmVfY29vcmQpOwogIHZlYzQgdHJlc2hvbGRDb2xvciA9IHRleHR1cmUyRCh0aHJlc2hvbGQsIF90ZXh0dXJlX2Nvb3JkKTsKICBnbF9GcmFnQ29sb3IgPSBmb3JlZ3JvdW5kQ29sb3IgKiB0cmVzaG9sZENvbG9yLmEgKwogICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvciAqICgxLiAtIHRyZXNob2xkQ29sb3IuYSk7Cn0KYCxRYz1gdmFyeWluZyB2ZWMyIF90ZXh0dXJlX2Nvb3JkOwoKYXR0cmlidXRlIHZlYzIgcG9zaXRpb247CmF0dHJpYnV0ZSB2ZWMyIHRleHR1cmVfY29vcmQ7Cgp2b2lkIG1haW4oKSB7CiAgZ2xfUG9zaXRpb24gPSB2ZWM0KHBvc2l0aW9uLCAwLiwgMS4pOwogIF90ZXh0dXJlX2Nvb3JkID0gdGV4dHVyZV9jb29yZDsKICBfdGV4dHVyZV9jb29yZC55ID0gMS4gLSB0ZXh0dXJlX2Nvb3JkLnk7Cn0KYDtjbGFzcyBFciBleHRlbmRzIF9le2dldEZyYWdtZW50U2hhZGVyKCl7cmV0dXJuIFhjfWdldFZlcnRleFNoYWRlcigpe3JldHVybiBRY319Y2xhc3MgVHJ7Y29uc3RydWN0b3IoKXtsKHRoaXMsInN0ZXBzIixbXSk7bCh0aGlzLCJwcm9maWxlciIpfWFkZFN0ZXAodCl7dGhpcy5zdGVwcy5wdXNoKHQpfWFzeW5jIHJ1bigpe2Zvcihjb25zdCB0IG9mIHRoaXMuc3RlcHMpdC5wcm9ncmFtLnJ1bih0LmdldFVuaWZvcm1zKCkpfXJlc2l6ZU91dHB1dCh0LGUpe3ZhciBuLG87KG49dGhpcy5wcm9maWxlcik9PW51bGx8fG4ucHVzaENvbnRleHQoYFBJUCBbJHt0aGlzLmNvbnN0cnVjdG9yLm5hbWV9XWApO2Zvcihjb25zdCBpIG9mIHRoaXMuc3RlcHMpaS5wcmV2ZW50UmVzaXplfHxpLnByb2dyYW0ucmVzaXplT3V0cHV0KHQsZSk7KG89dGhpcy5wcm9maWxlcik9PW51bGx8fG8ucG9wQ29udGV4dChgUElQIFske3RoaXMuY29uc3RydWN0b3IubmFtZX1dYCl9c2V0UHJvZmlsZXIodCl7dGhpcy5wcm9maWxlcj10O2Zvcihjb25zdCBlIG9mIHRoaXMuc3RlcHMpZS5wcm9ncmFtLnNldFByb2ZpbGVyKHQpfXNldElkKHQpe2Zvcihjb25zdCBlIG9mIHRoaXMuc3RlcHMpZS5wcm9ncmFtLmlkPXR9fWNsYXNzIEFyIGV4dGVuZHMgVHJ7Y29uc3RydWN0b3IoKXtzdXBlciguLi5hcmd1bWVudHMpO2wodGhpcywicHJlY2lzZU1hc2tFbmFibGVkIiwhMSl9fWNsYXNzIGFvIGV4dGVuZHMgQXJ7Y29uc3RydWN0b3IoZSl7c3VwZXIoKTtsKHRoaXMsImlucHV0SW1hZ2UiKTtsKHRoaXMsImlucHV0QmFja2dyb3VuZEltYWdlIik7bCh0aGlzLCJpbnB1dE1hc2siKTtsKHRoaXMsInByZWNpc2VNYXNrRW5hYmxlZCIsITApO3RoaXMuY29udGV4dD1lO2NvbnN0IG49e2NvbnRleHQ6ZSxoZWlnaHQ6ZS5jYW52YXMuaGVpZ2h0LHdpZHRoOmUuY2FudmFzLndpZHRofSxvPW5ldyBFcih7Li4ubixkaXNhYmxlRnJhbWVidWZmZXI6ITB9KTt0aGlzLmFkZFN0ZXAoe3Byb2dyYW06byxnZXRVbmlmb3JtczooKT0+KHtiYWNrZ3JvdW5kOkkoZSx0aGlzLmlucHV0QmFja2dyb3VuZEltYWdlKSxmb3JlZ3JvdW5kOkkoZSx0aGlzLmlucHV0SW1hZ2UpLHRocmVzaG9sZDpJKGUsdGhpcy5pbnB1dE1hc2spfSl9KX1zZXREYXRhKGUsbil7dGhpcy5pbnB1dEltYWdlPWUsdGhpcy5pbnB1dE1hc2s9bn19dmFyIEtjPWBwcmVjaXNpb24gbWVkaXVtcCBmbG9hdDsKCnZhcnlpbmcgdmVjMiBfdGV4dHVyZV9jb29yZDsKdW5pZm9ybSBzYW1wbGVyMkQgdGV4dHVyZTsKCnZvaWQgbWFpbigpIHsgZ2xfRnJhZ0NvbG9yID0gdGV4dHVyZTJEKHRleHR1cmUsIF90ZXh0dXJlX2Nvb3JkKTsgfQpgLHFjPWB2YXJ5aW5nIHZlYzIgX3RleHR1cmVfY29vcmQ7CgphdHRyaWJ1dGUgdmVjMiBwb3NpdGlvbjsKYXR0cmlidXRlIHZlYzIgdGV4dHVyZV9jb29yZDsKdW5pZm9ybSBib29sIGludmVydF95OwoKdm9pZCBtYWluKCkgewogIGdsX1Bvc2l0aW9uID0gdmVjNChwb3NpdGlvbiwgMC4sIDEuKTsKICBfdGV4dHVyZV9jb29yZCA9IHRleHR1cmVfY29vcmQ7CiAgaWYgKGludmVydF95KSB7CiAgICBfdGV4dHVyZV9jb29yZC55ID0gMS4gLSB0ZXh0dXJlX2Nvb3JkLnk7CiAgfQp9CmA7Y2xhc3MgSmMgZXh0ZW5kcyBfZXtnZXRGcmFnbWVudFNoYWRlcigpe3JldHVybiBLY31nZXRWZXJ0ZXhTaGFkZXIoKXtyZXR1cm4gcWN9fWNsYXNzIFpjIGV4dGVuZHMgVHJ7Y29uc3RydWN0b3IoZSxuLG8pe3N1cGVyKCk7bCh0aGlzLCJpbnB1dEltYWdlIik7dGhpcy5jb250ZXh0PWU7Y29uc3QgaT17Y29udGV4dDplLGhlaWdodDpvLHdpZHRoOm59O3RoaXMuYWRkU3RlcCh7cHJvZ3JhbTpuZXcgSmMoey4uLmksZGlzYWJsZUZyYW1lYnVmZmVyOiEwfSksZ2V0VW5pZm9ybXM6KCk9Pih7dGV4dHVyZTpJKGUsdGhpcy5pbnB1dEltYWdlKSxpbnZlcnRfeTohMH0pfSl9c2V0RGF0YShlKXt0aGlzLmlucHV0SW1hZ2U9ZX19YXN5bmMgZnVuY3Rpb24gdW8ocil7cmV0dXJuIG5ldyBQcm9taXNlKHQ9PntzZXRUaW1lb3V0KCgpPT57dCgpfSxyKX0pfXZhciBlZj1gcHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7Cgp2YXJ5aW5nIHZlYzIgX3RleHR1cmVfY29vcmQ7Cgp1bmlmb3JtIHZlYzIgY2FudmFzOwp1bmlmb3JtIHNhbXBsZXIyRCB0ZXh0dXJlOwoKdmVjNCBsb29wKCk7Cgp2b2lkIG1haW4oKSB7IGdsX0ZyYWdDb2xvciA9IGxvb3AoKTsgfQpgLHRmPWB2YXJ5aW5nIHZlYzIgX3RleHR1cmVfY29vcmQ7CgphdHRyaWJ1dGUgdmVjMiBwb3NpdGlvbjsKYXR0cmlidXRlIHZlYzIgdGV4dHVyZV9jb29yZDsKCnZvaWQgbWFpbigpIHsKICBnbF9Qb3NpdGlvbiA9IHZlYzQocG9zaXRpb24sIDAuLCAxLik7CiAgX3RleHR1cmVfY29vcmQgPSB0ZXh0dXJlX2Nvb3JkOwp9CmAsd3I9KHI9PihyW3IuTElORUFSPTBdPSJMSU5FQVIiLHJbci5HQVVTU0lBTj0xXT0iR0FVU1NJQU4iLHIpKSh3cnx8e30pO2NsYXNzIGNvIGV4dGVuZHMgX2V7Z2V0RGVmaW5lcygpe3ZhciB0O3JldHVybntSQURJVVM6KHQ9dGhpcy5vcHRpb25zLnJhZGl1cykhPW51bGw/dDoxfX1nZXRGcmFnbWVudFNoYWRlcigpe3JldHVybiBlZit0aGlzLmNyZWF0ZUxvb3BGdW5jdGlvbigpfWdldFZlcnRleFNoYWRlcigpe3JldHVybiB0Zn1jcmVhdGVMb29wRnVuY3Rpb24oKXt2YXIgZTtsZXQgdD0oZT10aGlzLm9wdGlvbnMucmFkaXVzKSE9bnVsbD9lOjE7cmV0dXJuYAoKICAgICAgICB2ZWM0IGxvb3AoKSB7IAogICAgICAgICAgICB2ZWM0IHJlc3VsdCA9IHZlYzQoMCwwLDAsMCk7CiAgICAgICAgICAgIGZsb2F0IGZhY3RvclN1bSA9IDAuOwoKICAgICAgICAgICAgdmVjMiBub3JtYWxpemVkUmFkaXVzID0gdmVjMigtJHt0fS4pIC8gY2FudmFzOwogICAgICAgICAgICB2ZWMyIG5vcm1hbGl6ZWRJbmNyZW1lbnQgPSB2ZWMyKDEuKSAvIGNhbnZhczsKICAgICAgICAgICAgdmVjMiBkaWZmID0gbm9ybWFsaXplZFJhZGl1czsKCiAgICAgICAgICAgIGZvcihpbnQgeT0tJHt0fTsgeTwke3QrMX07ICsreSkgewogICAgICAgICAgICAgICAgZm9yKGludCB4PS0ke3R9OyB4PCR7dCsxfTsgKyt4KSB7CiAgICAgICAgICAgICAgICAgICAgZmxvYXQgZmFjdG9yID0gMS47CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IGZhY3RvciAqIHRleHR1cmUyRCh0ZXh0dXJlLCBfdGV4dHVyZV9jb29yZCArIGRpZmYpOwogICAgICAgICAgICAgICAgICAgIGZhY3RvclN1bSArPSBmYWN0b3I7CiAgICAgICAgICAgICAgICAgICAgZGlmZi54ICs9IG5vcm1hbGl6ZWRJbmNyZW1lbnQueDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRpZmYueSArPSBub3JtYWxpemVkSW5jcmVtZW50Lnk7CiAgICAgICAgICAgICAgICBkaWZmLnggPSBub3JtYWxpemVkUmFkaXVzLng7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHJlc3VsdCAvIGZhY3RvclN1bTsKICAgICAgICB9YH1nZXRGYWN0b3IodCxlKXtzd2l0Y2godGhpcy5vcHRpb25zLnR5cGUpe2Nhc2UgMTpyZXR1cm4gdGhpcy5nZXRMaW5lYXJGYWN0b3IodCxlKTtjYXNlIDA6ZGVmYXVsdDpyZXR1cm4gdGhpcy5nZXRMaW5lYXJGYWN0b3IodCxlKX19Z2V0TGluZWFyRmFjdG9yKHQsZSl7cmV0dXJuIDF9Z2V0R2F1c3NpYW5GYWN0b3IodCxlKXt2YXIgdTtjb25zdCBuPU1hdGguUEkqMixvPU1hdGgubWF4KCh1PXRoaXMub3B0aW9ucy5yYWRpdXMpIT1udWxsP3U6MSwxKSxpPTEvKG4qbyoqMikscz0tKHQqKjIrZSoqMiksYT1pKnM7cmV0dXJuIGkqTWF0aC5FKiphfX1jbGFzcyBJciBleHRlbmRzIF9le2NvbnN0cnVjdG9yKGUpe3N1cGVyKGUpO2wodGhpcywiZmJpMiIpO3RoaXMuZmJpMj13dChlLmNvbnRleHQsW3tmb3JtYXQ6ZS5jb250ZXh0LlJHQkEsdHlwZTplLmNvbnRleHQuVU5TSUdORURfQllURSxtaW46ZS5jb250ZXh0LkxJTkVBUixtYWc6ZS5jb250ZXh0LkxJTkVBUix3cmFwOmUuY29udGV4dC5DTEFNUF9UT19FREdFfV0sZS53aWR0aCxlLmhlaWdodCl9cnVuKGUpe2NvbnN0IG49dGhpcy5mYmk7dGhpcy5mYmk9dGhpcy5mYmkyLHRoaXMuZmJpMj1uLHRoaXMub3V0cHV0PXRoaXMuZmJpLmF0dGFjaG1lbnRzWzBdLHN1cGVyLnJ1bih7Li4uZSxwcmV2aW91c19yZW5kZXJpbmc6dGhpcy5mYmkyLmF0dGFjaG1lbnRzWzBdfSl9cmVzaXplT3V0cHV0KGUsbil7c3VwZXIucmVzaXplT3V0cHV0KGUsbiksdGhpcy5mYmkyPXd0KHRoaXMuY29udGV4dCxbe2Zvcm1hdDp0aGlzLmNvbnRleHQuUkdCQSx0eXBlOnRoaXMuY29udGV4dC5VTlNJR05FRF9CWVRFLG1pbjp0aGlzLmNvbnRleHQuTElORUFSLHdyYXA6dGhpcy5jb250ZXh0LkNMQU1QX1RPX0VER0V9XSxlLG4pfX12YXIgcmY9YHByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwoKdmFyeWluZyB2ZWMyIF90ZXh0dXJlX2Nvb3JkOwoKLy8gdW5pZm9ybSBmbG9hdCB0cmVzaG9sZDsKdW5pZm9ybSBzYW1wbGVyMkQgaW1hZ2Vfbm93Owp1bmlmb3JtIHNhbXBsZXIyRCBpbWFnZV9iZWZvcmU7CnVuaWZvcm0gc2FtcGxlcjJEIG1hc2tfbm93Owp1bmlmb3JtIHNhbXBsZXIyRCBtYXNrX2JlZm9yZTsKdW5pZm9ybSBzYW1wbGVyMkQgcHJldmlvdXNfcmVuZGVyaW5nOwp1bmlmb3JtIHZlYzIgY2FudmFzOwoKdW5pZm9ybSBmbG9hdCBkZWx0YTsKCmZsb2F0IGN1cnJlbnRfZmFjdG9yID0gMC42OTsKZmxvYXQgcHJldmlvdXNfZmFjdG9yID0gMC43NDsKZmxvYXQgdGhyZXNob2xkX2FjdGl2YXRpb24gPSAwLjU0OwoKZmxvYXQgbWFwKGZsb2F0IHZhbHVlLCBmbG9hdCBtaW4xLCBmbG9hdCBtYXgxLCBmbG9hdCBtaW4yLCBmbG9hdCBtYXgyKSB7CiAgcmV0dXJuIG1pbjIgKyAodmFsdWUgLSBtaW4xKSAqIChtYXgyIC0gbWluMikgLyAobWF4MSAtIG1pbjEpOwp9CgpmbG9hdCBnZXRUaHJlc2hvbGQoKSB7CiAgdmVjNCBjb2xvciA9IHZlYzQoMC4pOwogIGZvciAoZmxvYXQgeSA9IC02LjsgeSA8IDcuOyB5ICs9IDEuKSB7CiAgICBmb3IgKGZsb2F0IHggPSAtNi47IHggPCA3LjsgeCArPSAxLikgewogICAgICB2ZWM0IGltYWdlX25vd19jb2xvciA9CiAgICAgICAgICB0ZXh0dXJlMkQoaW1hZ2Vfbm93LCBfdGV4dHVyZV9jb29yZCArIHZlYzIoeCwgeSkgLyBjYW52YXMpOwogICAgICB2ZWM0IGltYWdlX2JlZm9yZV9jb2xvciA9CiAgICAgICAgICB0ZXh0dXJlMkQoaW1hZ2VfYmVmb3JlLCBfdGV4dHVyZV9jb29yZCArIHZlYzIoeCwgeSkgLyBjYW52YXMpOwogICAgICBjb2xvciArPSBhYnMoaW1hZ2VfYmVmb3JlX2NvbG9yIC0gaW1hZ2Vfbm93X2NvbG9yKTsKICAgIH0KICB9CiAgcmV0dXJuIChjb2xvci54ICsgY29sb3IueSArIGNvbG9yLnopIC8gKDMuICogOS4pOwp9Cgp2b2lkIG1haW4oKSB7CiAgZmxvYXQgdHJlc2hvbGRfaW5wdXQgPSAuNDsKICBmbG9hdCB0cmVzaG9sZF9wcmV2aW91c19yZW5kZXJpbmcgPSAuOTg7CgogIHZlYzQgbWFza19ub3dfY29sb3IgPSB0ZXh0dXJlMkQobWFza19ub3csIF90ZXh0dXJlX2Nvb3JkKTsKICB2ZWM0IG1hc2tfYmVmb3JlX2NvbG9yID0gdGV4dHVyZTJEKG1hc2tfYmVmb3JlLCBfdGV4dHVyZV9jb29yZCk7CiAgdmVjNCBwcmV2aW91c19yZW5kZXJpbmdfY29sb3IgPSB0ZXh0dXJlMkQocHJldmlvdXNfcmVuZGVyaW5nLCBfdGV4dHVyZV9jb29yZCk7CgogIHZlYzMgbWFza19kaWZmID0gYWJzKG1hc2tfYmVmb3JlX2NvbG9yLnh5eiAtIG1hc2tfbm93X2NvbG9yLnh5eik7CiAgZmxvYXQgZmxpY2tlcmluZyA9IG1hc2tfZGlmZi54OwogIGZsb2F0IHRocmVzaG9sZCA9IGdldFRocmVzaG9sZCgpOwogIGlmICh0aHJlc2hvbGQgPCB0aHJlc2hvbGRfYWN0aXZhdGlvbikgewogICAgZ2xfRnJhZ0NvbG9yID0gdmVjNChmbGlja2VyaW5nLCAwLiwgMC4sIDEuKSAqIGN1cnJlbnRfZmFjdG9yICsKICAgICAgICAgICAgICAgICAgIHByZXZpb3VzX3JlbmRlcmluZ19jb2xvciAqIHByZXZpb3VzX2ZhY3RvcjsKICAgIGdsX0ZyYWdDb2xvciAqPSAoMS4gLSB0aHJlc2hvbGQpOwogIH0KfQpgLG5mPWB2YXJ5aW5nIHZlYzIgX3RleHR1cmVfY29vcmQ7CgphdHRyaWJ1dGUgdmVjMiBwb3NpdGlvbjsKYXR0cmlidXRlIHZlYzIgdGV4dHVyZV9jb29yZDsKCnZvaWQgbWFpbigpIHsKICBnbF9Qb3NpdGlvbiA9IHZlYzQocG9zaXRpb24sIDAuLCAxLik7CiAgX3RleHR1cmVfY29vcmQgPSB0ZXh0dXJlX2Nvb3JkOwp9CmA7Y2xhc3Mgb2YgZXh0ZW5kcyBJcntnZXRGcmFnbWVudFNoYWRlcigpe3JldHVybiByZn1nZXRWZXJ0ZXhTaGFkZXIoKXtyZXR1cm4gbmZ9fXZhciBzZj1gI3ZlcnNpb24gMzAwIGVzCi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9Wb2xjb21peC92aXJ0dWFsLWJhY2tncm91bmQvYmxvYi9tYWluL3NyYy9waXBlbGluZXMvd2ViZ2wyL2pvaW50QmlsYXRlcmFsRmlsdGVyU3RhZ2UudHMKCnByZWNpc2lvbiBoaWdocCBmbG9hdDsKdW5pZm9ybSBzYW1wbGVyMkQgaW5wdXRfZnJhbWU7CnVuaWZvcm0gc2FtcGxlcjJEIHNlZ21lbnRhdGlvbl9tYXNrOwp1bmlmb3JtIHNhbXBsZXIyRCB0aHJlc2hvbGQ7CnVuaWZvcm0gdmVjMiB0ZXhlbF9zaXplOwp1bmlmb3JtIGZsb2F0IHN0ZXA7CnVuaWZvcm0gZmxvYXQgcmFkaXVzOwp1bmlmb3JtIGZsb2F0IG9mZnNldDsKdW5pZm9ybSBmbG9hdCBzaWdtYV90ZXhlbDsKdW5pZm9ybSBmbG9hdCBzaWdtYV9jb2xvcjsKCmluIHZlYzIgX3RleHR1cmVfY29vcmQ7Cm91dCB2ZWM0IG91dENvbG9yOwoKZmxvYXQgZ2F1c3NpYW4oZmxvYXQgeCwgZmxvYXQgc2lnbWEpIHsKICBmbG9hdCBjb2VmZiA9IC0wLjUgLyAoc2lnbWEgKiBzaWdtYSAqIDQuMCArIDEuMGUtNik7CiAgcmV0dXJuIGV4cCgoeCAqIHgpICogY29lZmYpOwp9Cgp2b2lkIG1haW4oKSB7CiAgdmVjMiBjZW50ZXJDb29yZCA9IF90ZXh0dXJlX2Nvb3JkOwogIHZlYzMgY2VudGVyQ29sb3IgPSB0ZXh0dXJlKGlucHV0X2ZyYW1lLCBjZW50ZXJDb29yZCkucmdiOwogIGZsb2F0IG5ld1ZhbCA9IDAuMDsKICBmbG9hdCBzcGFjZVdlaWdodCA9IDAuMDsKICBmbG9hdCBjb2xvcldlaWdodCA9IDAuMDsKICBmbG9hdCB0b3RhbFdlaWdodCA9IDAuMDsKICAvLyBTdWJzYW1wbGUga2VybmVsIHNwYWNlLgogIGZvciAoZmxvYXQgaSA9IC1yYWRpdXMgKyBvZmZzZXQ7IGkgPD0gcmFkaXVzOyBpICs9IHN0ZXApIHsKICAgIGZvciAoZmxvYXQgaiA9IC1yYWRpdXMgKyBvZmZzZXQ7IGogPD0gcmFkaXVzOyBqICs9IHN0ZXApIHsKICAgICAgdmVjMiBzaGlmdCA9IHZlYzIoaiwgaSkgKiB0ZXhlbF9zaXplOwogICAgICB2ZWMyIGNvb3JkID0gdmVjMihjZW50ZXJDb29yZCArIHNoaWZ0KTsKICAgICAgdmVjMyBmcmFtZUNvbG9yID0gdGV4dHVyZShpbnB1dF9mcmFtZSwgY29vcmQpLnJnYjsKICAgICAgZmxvYXQgdGhyZXNob2xkID0gdGV4dHVyZSh0aHJlc2hvbGQsIGNvb3JkKS5hOwogICAgICBmbG9hdCBvdXRWYWwgPSB0ZXh0dXJlKHNlZ21lbnRhdGlvbl9tYXNrLCBjb29yZCkuYTsKCiAgICAgIHNwYWNlV2VpZ2h0ID0gZ2F1c3NpYW4oZGlzdGFuY2UoY2VudGVyQ29vcmQsIGNvb3JkKSwgc2lnbWFfdGV4ZWwpOwogICAgICBjb2xvcldlaWdodCA9IGdhdXNzaWFuKGRpc3RhbmNlKGNlbnRlckNvbG9yLCBmcmFtZUNvbG9yKSwgc2lnbWFfY29sb3IpOwogICAgICB0b3RhbFdlaWdodCArPSBzcGFjZVdlaWdodCAqIGNvbG9yV2VpZ2h0OwogICAgICBuZXdWYWwgKz0gc3BhY2VXZWlnaHQgKiBjb2xvcldlaWdodCAqIG91dFZhbCAqIHRocmVzaG9sZDsKICAgIH0KICB9CiAgbmV3VmFsIC89IHRvdGFsV2VpZ2h0OwogIG91dENvbG9yID0gdmVjNCh2ZWMzKDAuKSwgbmV3VmFsKTsKfWAsYWY9YCN2ZXJzaW9uIDMwMCBlcwppbiB2ZWMyIHBvc2l0aW9uOwppbiB2ZWMyIHRleHR1cmVfY29vcmQ7Cm91dCB2ZWMyIF90ZXh0dXJlX2Nvb3JkOwp2b2lkIG1haW4oKSB7CiAgZ2xfUG9zaXRpb24gPSB2ZWM0KHBvc2l0aW9uLCAwLjAsIDEuMCk7CiAgX3RleHR1cmVfY29vcmQgPSB0ZXh0dXJlX2Nvb3JkOwp9YDtjbGFzcyB1ZiBleHRlbmRzIF9le2dldEZyYWdtZW50U2hhZGVyKCl7cmV0dXJuIHNmfWdldFZlcnRleFNoYWRlcigpe3JldHVybiBhZn19dmFyIGNmPWBwcmVjaXNpb24gbWVkaXVtcCBmbG9hdDsKCnZhcnlpbmcgdmVjMiBfdGV4dHVyZV9jb29yZDsKCnVuaWZvcm0gdmVjMiBjYW52YXM7CnVuaWZvcm0gc2FtcGxlcjJEIHRleHR1cmU7Cgp2b2lkIG1haW4oKSB7CiAgaW50IGNvdW50ID0gMDsKICBmb3IgKGZsb2F0IHkgPSAtMS47IHkgPCAyLjsgeSArPSAxLikgewogICAgZm9yIChmbG9hdCB4ID0gLTEuOyB4IDwgMi47IHggKz0gMS4pIHsKICAgICAgdmVjMiBjb29yZCA9IF90ZXh0dXJlX2Nvb3JkICsgdmVjMih5LCB4KSAvIGNhbnZhczsKICAgICAgdmVjNCBjb2xvciA9IHRleHR1cmUyRCh0ZXh0dXJlLCBjb29yZCk7CiAgICAgIGlmIChjb2xvci5yID4gLjEpIHsKICAgICAgICBjb3VudCsrOwogICAgICB9CiAgICB9CiAgfQogIGlmIChjb3VudCA+IDUpIHsKICAgIGdsX0ZyYWdDb2xvciA9IHRleHR1cmUyRCh0ZXh0dXJlLCBfdGV4dHVyZV9jb29yZCk7CiAgfQp9CmAsZmY9YHZhcnlpbmcgdmVjMiBfdGV4dHVyZV9jb29yZDsKCmF0dHJpYnV0ZSB2ZWMyIHBvc2l0aW9uOwphdHRyaWJ1dGUgdmVjMiB0ZXh0dXJlX2Nvb3JkOwoKdm9pZCBtYWluKCkgewogIGdsX1Bvc2l0aW9uID0gdmVjNChwb3NpdGlvbiwgMC4sIDEuKTsKICBfdGV4dHVyZV9jb29yZCA9IHRleHR1cmVfY29vcmQ7Cn0KYDtjbGFzcyBsZiBleHRlbmRzIF9le2dldEZyYWdtZW50U2hhZGVyKCl7cmV0dXJuIGNmfWdldFZlcnRleFNoYWRlcigpe3JldHVybiBmZn19dmFyIGRmPWBwcmVjaXNpb24gbWVkaXVtcCBmbG9hdDsKCnZhcnlpbmcgdmVjMiBfdGV4dHVyZV9jb29yZDsKCnVuaWZvcm0gdmVjMiBjYW52YXM7CnVuaWZvcm0gc2FtcGxlcjJEIHRleHR1cmU7Cgp2b2lkIG1haW4oKSB7CiAgdmVjNCBjb2xvciA9IHRleHR1cmUyRCh0ZXh0dXJlLCBfdGV4dHVyZV9jb29yZCk7CiAgZm9yIChmbG9hdCB5ID0gLTIuOyB5IDwgMy47IHkgKz0gMS4pIHsKICAgIGZvciAoZmxvYXQgeCA9IC0yLjsgeCA8IDMuOyB4ICs9IDEuKSB7CiAgICAgIHZlYzIgY29vcmQgPSBfdGV4dHVyZV9jb29yZDsKICAgICAgY29vcmQgKz0gdmVjMih5LCB4KSAvIGNhbnZhczsKICAgICAgY29sb3IgKz0gdGV4dHVyZTJEKHRleHR1cmUsIGNvb3JkKSAqICgxLiAvIDQuKTsKICAgIH0KICB9CgogIGdsX0ZyYWdDb2xvciA9IGNvbG9yOwp9CmAsbWY9YHZhcnlpbmcgdmVjMiBfdGV4dHVyZV9jb29yZDsKCmF0dHJpYnV0ZSB2ZWMyIHBvc2l0aW9uOwphdHRyaWJ1dGUgdmVjMiB0ZXh0dXJlX2Nvb3JkOwoKdm9pZCBtYWluKCkgewogIGdsX1Bvc2l0aW9uID0gdmVjNChwb3NpdGlvbiwgMC4sIDEuKTsKICBfdGV4dHVyZV9jb29yZCA9IHRleHR1cmVfY29vcmQ7Cn0KYDtjbGFzcyBoZiBleHRlbmRzIElye2dldEZyYWdtZW50U2hhZGVyKCl7cmV0dXJuIGRmfWdldFZlcnRleFNoYWRlcigpe3JldHVybiBtZn19dmFyIHBmPWBwcmVjaXNpb24gbWVkaXVtcCBmbG9hdDsKCnZhcnlpbmcgdmVjMiBfdGV4dHVyZV9jb29yZDsKCnVuaWZvcm0gc2FtcGxlcjJEIHRocmVzaG9sZDsKdW5pZm9ybSBzYW1wbGVyMkQgaW5wdXRzOwoKdm9pZCBtYWluKCkgewogIHZlYzQgaW5wdXRzX2NvbG9yID0gdGV4dHVyZTJEKGlucHV0cywgX3RleHR1cmVfY29vcmQpOwogIHZlYzQgdGhyZXNob2xkX2NvbG9yID0gdGV4dHVyZTJEKHRocmVzaG9sZCwgX3RleHR1cmVfY29vcmQpOwogIGlmICh0aHJlc2hvbGRfY29sb3IuciA8IC4xICYmIGlucHV0c19jb2xvci5yID4gLjUpIHsKICAgIGdsX0ZyYWdDb2xvciA9IGlucHV0c19jb2xvcjsKICB9Cn0KYCxnZj1gdmFyeWluZyB2ZWMyIF90ZXh0dXJlX2Nvb3JkOwoKYXR0cmlidXRlIHZlYzIgcG9zaXRpb247CmF0dHJpYnV0ZSB2ZWMyIHRleHR1cmVfY29vcmQ7Cgp2b2lkIG1haW4oKSB7CiAgZ2xfUG9zaXRpb24gPSB2ZWM0KHBvc2l0aW9uLCAwLiwgMS4pOwogIF90ZXh0dXJlX2Nvb3JkID0gdGV4dHVyZV9jb29yZDsKfQpgO2NsYXNzIHlmIGV4dGVuZHMgSXJ7Z2V0RnJhZ21lbnRTaGFkZXIoKXtyZXR1cm4gcGZ9Z2V0VmVydGV4U2hhZGVyKCl7cmV0dXJuIGdmfX1jbGFzcyB4ZiBleHRlbmRzIFRye2NvbnN0cnVjdG9yKGUsbixvKXtzdXBlcigpO2wodGhpcywiaW5wdXRJbWFnZSIpO2wodGhpcywiaW5wdXRNYXNrIik7bCh0aGlzLCJwcmV2aW91c0lucHV0SW1hZ2UiKTtsKHRoaXMsInByZXZpb3VzSW5wdXRNYXNrIik7bCh0aGlzLCJvdXRwdXQiKTtsKHRoaXMsIm9wdGlvbnMiLHtjdXJyZW50VGhyZXNob2xkTWluaW11bTowLGN1cnJlbnRUaHJlc2hvbGRNYXhpbXVtOjEscHJldmlvdXNUaHJlc2hvbGRNaW5pbXVtOjAscHJldmlvdXNUaHJlc2hvbGRNYXhpbXVtOjEsdGhyZXNob2xkTWluaW11bTowLHRocmVzaG9sZE1heGltdW06MSx0aHJlc2hvbGRGYWN0b3I6MX0pO2wodGhpcywiam9pbnRCaWxhdGVyYWwiKTt0aGlzLmNvbnRleHQ9ZTtjb25zdCBpPXtjb250ZXh0OmUsaGVpZ2h0Om8sd2lkdGg6bn0scz1uZXcgb2YoaSksYT1uZXcgY28oey4uLmkscmFkaXVzOjEsdHlwZTp3ci5HQVVTU0lBTn0pLHU9bmV3IHlmKGkpLGY9bmV3IGhmKGkpLG09bmV3IGxmKGkpO3RoaXMuam9pbnRCaWxhdGVyYWw9bmV3IHVmKGkpLHRoaXMuYWRkU3RlcCh7cHJvZ3JhbTpzLGdldFVuaWZvcm1zOigpPT4oe2ltYWdlX25vdzpJKGUsdGhpcy5pbnB1dEltYWdlKSxpbWFnZV9iZWZvcmU6SShlLHRoaXMucHJldmlvdXNJbnB1dEltYWdlKSxtYXNrX25vdzpJKGUsdGhpcy5pbnB1dE1hc2spLG1hc2tfYmVmb3JlOkkoZSx0aGlzLnByZXZpb3VzSW5wdXRNYXNrKSxjdXJyZW50X3RocmVzaG9sZF9taW5pbXVtOnRoaXMub3B0aW9ucy5jdXJyZW50VGhyZXNob2xkTWluaW11bSxjdXJyZW50X3RocmVzaG9sZF9tYXhpbXVtOnRoaXMub3B0aW9ucy5jdXJyZW50VGhyZXNob2xkTWF4aW11bSxwcmV2aW91c190aHJlc2hvbGRfbWluaW11bTp0aGlzLm9wdGlvbnMucHJldmlvdXNUaHJlc2hvbGRNaW5pbXVtLHByZXZpb3VzX3RocmVzaG9sZF9tYXhpbXVtOnRoaXMub3B0aW9ucy5wcmV2aW91c1RocmVzaG9sZE1heGltdW0sdGhyZXNob2xkX21pbmltdW06dGhpcy5vcHRpb25zLnRocmVzaG9sZE1pbmltdW0sdGhyZXNob2xkX21heGltdW06dGhpcy5vcHRpb25zLnRocmVzaG9sZE1heGltdW0sdGhyZXNob2xkX2ZhY3Rvcjp0aGlzLm9wdGlvbnMudGhyZXNob2xkRmFjdG9yfSl9KSx0aGlzLmFkZFN0ZXAoe3Byb2dyYW06dSxnZXRVbmlmb3JtczooKT0+KHtpbnB1dHM6SShlLHRoaXMuaW5wdXRNYXNrKSx0aHJlc2hvbGQ6SShlLHMub3V0cHV0KX0pfSksdGhpcy5hZGRTdGVwKHtwcm9ncmFtOm0sZ2V0VW5pZm9ybXM6KCk9Pih7dGV4dHVyZTpJKGUsdS5vdXRwdXQpfSl9KSx0aGlzLmFkZFN0ZXAoe3Byb2dyYW06ZixnZXRVbmlmb3JtczooKT0+KHt0ZXh0dXJlOkkoZSxtLm91dHB1dCl9KX0pLHRoaXMuYWRkU3RlcCh7cHJvZ3JhbTphLGdldFVuaWZvcm1zOigpPT4oe3RleHR1cmU6SShlLGYub3V0cHV0KX0pfSksdGhpcy5hZGRTdGVwKHtwcm9ncmFtOnRoaXMuam9pbnRCaWxhdGVyYWwsZ2V0VW5pZm9ybXM6KCk9Pnt2YXIgJCx6LFYsRyxHZSxiZSxjZSxXO2NvbnN0IGc9KHo9KCQ9dGhpcy5pbnB1dEltYWdlKT09bnVsbD92b2lkIDA6JC53aWR0aCkhPW51bGw/ejoxLHg9KEc9KFY9dGhpcy5pbnB1dEltYWdlKT09bnVsbD92b2lkIDA6Vi5oZWlnaHQpIT1udWxsP0c6MSxkPShiZT0oR2U9dGhpcy5pbnB1dE1hc2spPT1udWxsP3ZvaWQgMDpHZS53aWR0aCkhPW51bGw/YmU6MSxfPShXPShjZT10aGlzLmlucHV0TWFzayk9PW51bGw/dm9pZCAwOmNlLmhlaWdodCkhPW51bGw/VzoxLEU9TWF0aC5tYXgoZy9kLHgvXyksdj1NYXRoLm1heCgxLE1hdGguc3FydChFKSouNjYpLEY9MS9nLGs9MS94O3JldHVybntpbnB1dF9mcmFtZTpJKGUsdGhpcy5pbnB1dEltYWdlKSxzZWdtZW50YXRpb25fbWFzazpJKGUsdGhpcy5pbnB1dE1hc2spLHRocmVzaG9sZDpJKGUsYS5vdXRwdXQpLHRleGVsX3NpemU6W0Ysa10sc3RlcDp2LHJhZGl1czpFLG9mZnNldDp2PjE/diouNTowLHNpZ21hX3RleGVsOk1hdGgubWF4KEYsaykqRSxzaWdtYV9jb2xvcjouMX19fSksdGhpcy5vdXRwdXQ9dGhpcy5qb2ludEJpbGF0ZXJhbC5vdXRwdXR9c2V0RGF0YShlLG4pe3RoaXMucHJldmlvdXNJbnB1dEltYWdlPXRoaXMuaW5wdXRJbWFnZT90aGlzLmlucHV0SW1hZ2U6ZSx0aGlzLnByZXZpb3VzSW5wdXRNYXNrPXRoaXMuaW5wdXRNYXNrP3RoaXMuaW5wdXRNYXNrOm4sdGhpcy5pbnB1dEltYWdlPWUsdGhpcy5pbnB1dE1hc2s9bn1zZXRPcHRpb25zKGUpe3RoaXMub3B0aW9ucz1lfXJlc2l6ZU91dHB1dChlLG4pe3N1cGVyLnJlc2l6ZU91dHB1dChlLG4pLHRoaXMub3V0cHV0PXRoaXMuam9pbnRCaWxhdGVyYWwub3V0cHV0fX1jbGFzcyBfZntjb25zdHJ1Y3Rvcih0KXtsKHRoaXMsImNvbnRleHQiKTtsKHRoaXMsImV4dGVuc2lvbiIpO2wodGhpcywicXVlcmllcyIsW10pO2wodGhpcywiYWN0aXZlUXVlcnkiKTt0aGlzLmNvbnRleHQ9dCx0aGlzLmV4dGVuc2lvbj10LmdldEV4dGVuc2lvbigiRVhUX2Rpc2pvaW50X3RpbWVyX3F1ZXJ5X3dlYmdsMiIpfXN0YXJ0KCl7fXN0b3AoKXt0aGlzLmFjdGl2ZVF1ZXJ5JiZ0aGlzLmNvbnRleHQuZW5kUXVlcnkodGhpcy5leHRlbnNpb24uVElNRV9FTEFQU0VEX0VYVCl9cHVzaENvbnRleHQodCl7dGhpcy5jcmVhdGVRdWVyeSgiUFVTSCIsdCl9cG9wQ29udGV4dCh0KXt0aGlzLmNyZWF0ZVF1ZXJ5KCJQT1AiLHQpfWNyZWF0ZVF1ZXJ5KHQsZSl7dGhpcy5hY3RpdmVRdWVyeSYmdGhpcy5jb250ZXh0LmVuZFF1ZXJ5KHRoaXMuZXh0ZW5zaW9uLlRJTUVfRUxBUFNFRF9FWFQpLHRoaXMuYWN0aXZlUXVlcnk9dGhpcy5jb250ZXh0LmNyZWF0ZVF1ZXJ5KCksdGhpcy5jb250ZXh0LmJlZ2luUXVlcnkodGhpcy5leHRlbnNpb24uVElNRV9FTEFQU0VEX0VYVCx0aGlzLmFjdGl2ZVF1ZXJ5KSx0aGlzLnF1ZXJpZXMucHVzaCh7bmFtZTplLGFjdGlvbjp0LHF1ZXJ5OnRoaXMuYWN0aXZlUXVlcnl9KX1hc3luYyBnZXRSZXNvbHZlZFF1ZXJpZXMoKXtjb25zdCB0PShhd2FpdCBQcm9taXNlLmFsbChbLi4udGhpcy5xdWVyaWVzXS5tYXAoZT0+dGhpcy5yZXNvbHZlUXVlcnkoZSkpKSkuZmlsdGVyKGU9PmUpO2ZvcihsZXQgZT0xO2U8dC5sZW5ndGg7KytlKXRbZV0udGltZXN0YW1wKz10W2UtMV0uZHVyYXRpb24rdFtlLTFdLnRpbWVzdGFtcDtyZXR1cm4gdH1hc3luYyByZXNvbHZlUXVlcnkodCl7aWYoIWF3YWl0IHRoaXMuYXdhaXRRdWVyeUF2YWlsYWJsZSh0KSl7Y29uc29sZS5sb2coIlVuYXdhaXRhYmxlIHF1ZXJ5Iix0KTtyZXR1cm59aWYodGhpcy5jb250ZXh0LmdldFBhcmFtZXRlcih0aGlzLmV4dGVuc2lvbi5HUFVfRElTSk9JTlRfRVhUKSl7Y29uc29sZS5sb2coIkRpc2pvaW50ZWQgcXVlcnkiLHQpO3JldHVybn1yZXR1cm57Li4udCxkdXJhdGlvbjp0aGlzLmNvbnRleHQuZ2V0UXVlcnlQYXJhbWV0ZXIodC5xdWVyeSx0aGlzLmNvbnRleHQuUVVFUllfUkVTVUxUKSx0aW1lc3RhbXA6MH19YXN5bmMgYXdhaXRRdWVyeUF2YWlsYWJsZSh0KXtmb3IobGV0IGU9MDtlPDEwOysrZSl7aWYodGhpcy5jb250ZXh0LmdldFF1ZXJ5UGFyYW1ldGVyKHQucXVlcnksdGhpcy5jb250ZXh0LlFVRVJZX1JFU1VMVF9BVkFJTEFCTEUpKXJldHVybiB0O2F3YWl0IHVvKDIwMCl9fX1jbGFzcyBJdHtjb25zdHJ1Y3Rvcigpe2wodGhpcywiY2FudmFzIik7bCh0aGlzLCJjb250ZXh0Iik7bCh0aGlzLCJwaXBlbGluZSIpO2wodGhpcywicHJldmlvdXNJbWFnZVdpZHRoIiwwKTtsKHRoaXMsInByZXZpb3VzSW1hZ2VIZWlnaHQiLDApO2wodGhpcywicHJldmlvdXNNYXNrV2lkdGgiLEZlKTtsKHRoaXMsInByZXZpb3VzTWFza0hlaWdodCIsRmUpO2wodGhpcywicHJvZmlsZXIiKTtsKHRoaXMsInBvc3RQcm9jZXNzaW5nRW5hYmxlZCIsITApO2wodGhpcywiaW1wcm92ZU1hc2siKTtjb25zdCB0PW5ldyBPZmZzY3JlZW5DYW52YXMoMCwwKSxlPXQuZ2V0Q29udGV4dCgid2ViZ2wyIik7aWYoIWUpdGhyb3ciRmFpbCB0byByZXRyaWV2ZSB3ZWJnbDIgY29udGV4dCI7dGhpcy5jYW52YXM9dCx0aGlzLmNvbnRleHQ9ZSx0aGlzLmltcHJvdmVNYXNrPW5ldyB4Zih0aGlzLmNvbnRleHQsRmUsRmUpfXNldEZsaWNrZXJpbmdPcHRpb25zKHQpe3RoaXMuaW1wcm92ZU1hc2suc2V0T3B0aW9ucyh0KX1lbmFibGVQb3N0UHJvY2Vzc2luZygpe3RoaXMucG9zdFByb2Nlc3NpbmdFbmFibGVkPSEwfWRpc2FibGVQb3N0UHJvY2Vzc2luZygpe3RoaXMucG9zdFByb2Nlc3NpbmdFbmFibGVkPSExfWFzeW5jIHByb2ZpbGVXZWJnbCh0KXtjb25zdCBlPW5ldyBfZih0aGlzLmNvbnRleHQpO3JldHVybiB0aGlzLnByb2ZpbGVyPWUsZS5zdGFydCgpLGF3YWl0IHVvKHQpLHRoaXMucHJvZmlsZXI9dm9pZCAwLGUuc3RvcCgpLGUuZ2V0UmVzb2x2ZWRRdWVyaWVzKCl9YXN5bmMgcmVuZGVyKHQsZSl7dmFyIGkscztpZighdGhpcy5waXBlbGluZSl0aHJvdyJtaXNzaW5nIHBpcGVsaW5lIjsodGhpcy5wcmV2aW91c0ltYWdlSGVpZ2h0IT09dC5oZWlnaHR8fHRoaXMucHJldmlvdXNJbWFnZVdpZHRoIT09dC53aWR0aCkmJnRoaXMucmVzaXplT3V0cHV0KHQud2lkdGgsdC5oZWlnaHQpLCh0aGlzLnByZXZpb3VzTWFza0hlaWdodCE9PWUuaGVpZ2h0fHx0aGlzLnByZXZpb3VzTWFza1dpZHRoIT09ZS53aWR0aCkmJih0aGlzLmltcHJvdmVNYXNrLnJlc2l6ZU91dHB1dChlLndpZHRoLGUuaGVpZ2h0KSx0aGlzLnByZXZpb3VzTWFza1dpZHRoPWUud2lkdGgsdGhpcy5wcmV2aW91c01hc2tIZWlnaHQ9ZS5oZWlnaHQpO2NvbnN0IG49InJlbmRlcmVyIjsoaT10aGlzLnByb2ZpbGVyKT09bnVsbHx8aS5wdXNoQ29udGV4dChuKSx0aGlzLmltcHJvdmVNYXNrLnNldFByb2ZpbGVyKHRoaXMucHJvZmlsZXIpLHRoaXMucGlwZWxpbmUuc2V0UHJvZmlsZXIodGhpcy5wcm9maWxlcik7bGV0IG89ZTtyZXR1cm4gdGhpcy5wb3N0UHJvY2Vzc2luZ0VuYWJsZWQmJih0aGlzLmltcHJvdmVNYXNrLnNldERhdGEodCxlKSx0aGlzLmltcHJvdmVNYXNrLnJ1bigpLG89dGhpcy5pbXByb3ZlTWFzay5vdXRwdXQpLHRoaXMucGlwZWxpbmUuc2V0RGF0YSh0LG8pLGF3YWl0IHRoaXMucGlwZWxpbmUucnVuKCksKHM9dGhpcy5wcm9maWxlcik9PW51bGx8fHMucG9wQ29udGV4dChuKSx0aGlzLmNhbnZhc31yZXNpemVPdXRwdXQodCxlKXt2YXIgbjt0aGlzLmNhbnZhcy53aWR0aD10LHRoaXMuY2FudmFzLmhlaWdodD1lLChuPXRoaXMucGlwZWxpbmUpPT1udWxsfHxuLnJlc2l6ZU91dHB1dCh0LGUpLHRoaXMucHJldmlvdXNJbWFnZVdpZHRoPXQsdGhpcy5wcmV2aW91c0ltYWdlSGVpZ2h0PWV9fWNsYXNzIGZvIGV4dGVuZHMgSXR7Y29uc3RydWN0b3IoKXtzdXBlcigpO2wodGhpcywicGlwZWxpbmUiKTtsKHRoaXMsImJhY2tncm91bmRJbWFnZSIpO2wodGhpcywiYmFja2dyb3VuZEltYWdlUmVzaXplckNhbnZhcyIpO2wodGhpcywiYmFja2dyb3VuZEltYWdlUmVzaXplckNvbnRleHQiKTtsKHRoaXMsImJhY2tncm91bmRJbWFnZVJlc2l6ZXIiKTt0aGlzLnBpcGVsaW5lPW5ldyBhbyh0aGlzLmNvbnRleHQpO2NvbnN0IGU9bmV3IE9mZnNjcmVlbkNhbnZhcygwLDApLG49ZS5nZXRDb250ZXh0KCJ3ZWJnbDIiKTtpZighbil0aHJvdyJGYWlsIHRvIHJldHJpZXZlIHdlYmdsIGNvbnRleHQiO3RoaXMuYmFja2dyb3VuZEltYWdlUmVzaXplckNhbnZhcz1lLHRoaXMuYmFja2dyb3VuZEltYWdlUmVzaXplckNvbnRleHQ9bix0aGlzLmJhY2tncm91bmRJbWFnZVJlc2l6ZXI9bmV3IFpjKHRoaXMuYmFja2dyb3VuZEltYWdlUmVzaXplckNvbnRleHQsMCwwKX1zZXRCYWNrZ3JvdW5kSW1hZ2UoZSl7dGhpcy5iYWNrZ3JvdW5kSW1hZ2U9ZSx0aGlzLnVwZGF0ZUJhY2tncm91bmRJbWFnZSgpfXVwZGF0ZUJhY2tncm91bmRJbWFnZSgpe2NvbnN0e3dpZHRoOmUsaGVpZ2h0Om59PXRoaXMuY2FudmFzO3RoaXMuYmFja2dyb3VuZEltYWdlUmVzaXplci5yZXNpemVPdXRwdXQoZSxuKSx0aGlzLmJhY2tncm91bmRJbWFnZVJlc2l6ZXIuc2V0RGF0YSh0aGlzLmJhY2tncm91bmRJbWFnZSksdGhpcy5iYWNrZ3JvdW5kSW1hZ2VSZXNpemVyLnJ1bigpLHRoaXMucGlwZWxpbmUuaW5wdXRCYWNrZ3JvdW5kSW1hZ2U9dGhpcy5iYWNrZ3JvdW5kSW1hZ2VSZXNpemVyQ2FudmFzfXJlc2l6ZU91dHB1dChlLG4pe3N1cGVyLnJlc2l6ZU91dHB1dChlLG4pLHRoaXMuYmFja2dyb3VuZEltYWdlUmVzaXplckNhbnZhcy53aWR0aD1lLHRoaXMuYmFja2dyb3VuZEltYWdlUmVzaXplckNhbnZhcy5oZWlnaHQ9bix0aGlzLmJhY2tncm91bmRJbWFnZVJlc2l6ZXIucmVzaXplT3V0cHV0KGUsbiksdGhpcy51cGRhdGVCYWNrZ3JvdW5kSW1hZ2UoKX19Y2xhc3MgYmYgZXh0ZW5kcyBmb3tjb25zdHJ1Y3Rvcigpe3N1cGVyKC4uLmFyZ3VtZW50cyk7bCh0aGlzLCJmcmFtZVJlYWRlciIpfXNldEJhY2tncm91bmRWaWRlbyhlKXt0aGlzLmZyYW1lUmVhZGVyPWUuZ2V0UmVhZGVyKCksdGhpcy5yZWFkTmV4dFZpZGVvRnJhbWUoKX1hc3luYyByZW5kZXIoZSxuKXtyZXR1cm4gYXdhaXQgdGhpcy5yZWFkTmV4dFZpZGVvRnJhbWUoKSxzdXBlci5yZW5kZXIoZSxuKX1hc3luYyByZWFkTmV4dFZpZGVvRnJhbWUoKXt2YXIgbjtjb25zdCBlPWF3YWl0KChuPXRoaXMuZnJhbWVSZWFkZXIpPT1udWxsP3ZvaWQgMDpuLnJlYWQoKSk7aWYoZSE9bnVsbCYmZS52YWx1ZSl7Y29uc3Qgbz1hd2FpdCBjcmVhdGVJbWFnZUJpdG1hcChlLnZhbHVlKTt0aGlzLnNldEJhY2tncm91bmRJbWFnZShvKSxlLnZhbHVlLmNsb3NlKCl9fX1jbGFzcyBsb3tibHVyQmFja2dyb3VuZCh0KXtyZXR1cm4gbmV3IFZpKHQpfWJsdXJTaWxob3VldHRlKHQpe3JldHVybiBuZXcgSGkodCl9aW1hZ2VCYWNrZ3JvdW5kKCl7cmV0dXJuIG5ldyBqaX12aWRlb0JhY2tncm91bmQoKXtyZXR1cm4gbmV3IGJmfX12YXIgdmY9YHByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwoKdmFyeWluZyB2ZWMyIF90ZXh0dXJlX2Nvb3JkOwoKdW5pZm9ybSB2ZWMyIGNhbnZhczsKdW5pZm9ybSBzYW1wbGVyMkQgdGV4dHVyZTsKdW5pZm9ybSBzYW1wbGVyMkQgbWFzazsKCnZlYzQgbG9vcCgpOwoKdm9pZCBtYWluKCkgeyBnbF9GcmFnQ29sb3IgPSBsb29wKCk7IH0KYCxFZj1gdmFyeWluZyB2ZWMyIF90ZXh0dXJlX2Nvb3JkOwoKYXR0cmlidXRlIHZlYzIgcG9zaXRpb247CmF0dHJpYnV0ZSB2ZWMyIHRleHR1cmVfY29vcmQ7Cgp2b2lkIG1haW4oKSB7CiAgZ2xfUG9zaXRpb24gPSB2ZWM0KHBvc2l0aW9uLCAwLiwgMS4pOwogIF90ZXh0dXJlX2Nvb3JkID0gdGV4dHVyZV9jb29yZDsKfQpgO2NsYXNzIFRmIGV4dGVuZHMgX2V7Z2V0RGVmaW5lcygpe3ZhciB0O3JldHVybntSQURJVVM6KHQ9dGhpcy5vcHRpb25zLnJhZGl1cykhPW51bGw/dDoxfX1nZXRGcmFnbWVudFNoYWRlcigpe3JldHVybiB2Zit0aGlzLmNyZWF0ZUxvb3BGdW5jdGlvbigpfWdldFZlcnRleFNoYWRlcigpe3JldHVybiBFZn1jcmVhdGVMb29wRnVuY3Rpb24oKXt2YXIgZTtsZXQgdD0oZT10aGlzLm9wdGlvbnMucmFkaXVzKSE9bnVsbD9lOjE7cmV0dXJuYAoKICAgICAgICB2ZWM0IGxvb3AoKSB7IAogICAgICAgICAgICB2ZWM0IHJlc3VsdCA9IHZlYzQoMCwwLDAsMCk7CiAgICAgICAgICAgIGZsb2F0IGZhY3RvclN1bSA9IDAuOwoKICAgICAgICAgICAgdmVjMiBub3JtYWxpemVkUmFkaXVzID0gdmVjMigtJHt0fS4pIC8gY2FudmFzOwogICAgICAgICAgICB2ZWMyIG5vcm1hbGl6ZWRJbmNyZW1lbnQgPSB2ZWMyKDEuKSAvIGNhbnZhczsKICAgICAgICAgICAgdmVjMiBkaWZmID0gbm9ybWFsaXplZFJhZGl1czsKICAgICAgICAgICAgZmxvYXQgbWF4TGVuZ3RoID0gbGVuZ3RoKG5vcm1hbGl6ZWRSYWRpdXMpOwoKICAgICAgICAgICAgZm9yKGludCB5PS0ke3R9OyB5PCR7dCsxfTsgKyt5KSB7CiAgICAgICAgICAgICAgICBmb3IoaW50IHg9LSR7dH07IHg8JHt0KzF9OyArK3gpIHsKICAgICAgICAgICAgICAgICAgICBmbG9hdCBmYWN0b3IgPSAoMS4tIHRleHR1cmUyRChtYXNrLCBfdGV4dHVyZV9jb29yZCArIGRpZmYpLmEpICogKG1heExlbmd0aCAtIGxlbmd0aChkaWZmKSkgLyBtYXhMZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IGZhY3RvciAqIHRleHR1cmUyRCh0ZXh0dXJlLCBfdGV4dHVyZV9jb29yZCArIGRpZmYpOwogICAgICAgICAgICAgICAgICAgIGZhY3RvclN1bSArPSBmYWN0b3I7CiAgICAgICAgICAgICAgICAgICAgZGlmZi54ICs9IG5vcm1hbGl6ZWRJbmNyZW1lbnQueDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRpZmYueSArPSBub3JtYWxpemVkSW5jcmVtZW50Lnk7CiAgICAgICAgICAgICAgICBkaWZmLnggPSBub3JtYWxpemVkUmFkaXVzLng7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHJlc3VsdCAvIGZhY3RvclN1bTsKICAgICAgICB9YH19Y29uc3QgQWY9MTAsd2Y9MixJZj04O2NsYXNzIFNmIGV4dGVuZHMgQXJ7Y29uc3RydWN0b3IoZSxuKXtzdXBlcigpO2wodGhpcywiaW5wdXRJbWFnZSIpO2wodGhpcywiaW5wdXRNYXNrIik7bCh0aGlzLCJibHVyIik7dGhpcy5jb250ZXh0PWUsdGhpcy5yYWRpdXM9bjtjb25zdCBvPXtjb250ZXh0OmUsaGVpZ2h0OmUuY2FudmFzLmhlaWdodCx3aWR0aDplLmNhbnZhcy53aWR0aH07dGhpcy5ibHVyPW5ldyBUZih7Li4ubyxyYWRpdXM6biwuLi50aGlzLmdldEJsdXJUZXh0dXJlU2l6ZShlLmNhbnZhcy53aWR0aCxlLmNhbnZhcy5oZWlnaHQpfSk7Y29uc3QgaT1uZXcgRXIoey4uLm8sZGlzYWJsZUZyYW1lYnVmZmVyOiEwfSk7dGhpcy5hZGRTdGVwKHtwcm9ncmFtOnRoaXMuYmx1cixwcmV2ZW50UmVzaXplOiEwLGdldFVuaWZvcm1zOigpPT4oe3RleHR1cmU6SShlLHRoaXMuaW5wdXRJbWFnZSksbWFzazpJKGUsdGhpcy5pbnB1dE1hc2spfSl9KSx0aGlzLmFkZFN0ZXAoe3Byb2dyYW06aSxnZXRVbmlmb3JtczooKT0+KHtiYWNrZ3JvdW5kOkkoZSx0aGlzLmJsdXIub3V0cHV0KSxmb3JlZ3JvdW5kOkkoZSx0aGlzLmlucHV0SW1hZ2UpLHRocmVzaG9sZDpJKGUsdGhpcy5pbnB1dE1hc2spfSl9KX1nZXRCbHVyVGV4dHVyZVNpemUoZSxuKXtjb25zdCBvPXRoaXMucmFkaXVzPkFmP0lmOndmO3JldHVybnt3aWR0aDpNYXRoLm1heChGZSxlL28pLGhlaWdodDpNYXRoLm1heChGZSxuL28pfX1zZXREYXRhKGUsbil7dGhpcy5pbnB1dEltYWdlPWUsdGhpcy5pbnB1dE1hc2s9bn1yZXNpemVPdXRwdXQoZSxuKXtzdXBlci5yZXNpemVPdXRwdXQoZSxuKTtjb25zdCBvPXRoaXMuZ2V0Qmx1clRleHR1cmVTaXplKGUsbik7dGhpcy5ibHVyLnJlc2l6ZU91dHB1dChvLndpZHRoLG8uaGVpZ2h0KX19Y2xhc3MgUmYgZXh0ZW5kcyBJdHtjb25zdHJ1Y3RvcihlKXtzdXBlcigpO2wodGhpcywicGlwZWxpbmUiKTt0aGlzLnBpcGVsaW5lPW5ldyBTZih0aGlzLmNvbnRleHQsZSksdGhpcy5kaXNhYmxlUG9zdFByb2Nlc3NpbmcoKX19Y2xhc3MgRmYgZXh0ZW5kcyBBcntjb25zdHJ1Y3RvcihlLG4pe3N1cGVyKCk7bCh0aGlzLCJpbnB1dEltYWdlIik7bCh0aGlzLCJpbnB1dE1hc2siKTt0aGlzLmNvbnRleHQ9ZTtjb25zdCBvPXtjb250ZXh0OmUsaGVpZ2h0OmUuY2FudmFzLmhlaWdodCx3aWR0aDplLmNhbnZhcy53aWR0aH0saT1uZXcgY28oey4uLm8scmFkaXVzOm4sdHlwZTp3ci5HQVVTU0lBTn0pLHM9bmV3IEVyKHsuLi5vLGRpc2FibGVGcmFtZWJ1ZmZlcjohMH0pO3RoaXMuYWRkU3RlcCh7cHJvZ3JhbTppLGdldFVuaWZvcm1zOigpPT4oe3RleHR1cmU6SShlLHRoaXMuaW5wdXRJbWFnZSl9KX0pLHRoaXMuYWRkU3RlcCh7cHJvZ3JhbTpzLGdldFVuaWZvcm1zOigpPT4oe2JhY2tncm91bmQ6SShlLHRoaXMuaW5wdXRJbWFnZSksZm9yZWdyb3VuZDpJKGUsaS5vdXRwdXQpLHRocmVzaG9sZDpJKGUsdGhpcy5pbnB1dE1hc2spfSl9KX1zZXREYXRhKGUsbil7dGhpcy5pbnB1dEltYWdlPWUsdGhpcy5pbnB1dE1hc2s9bn19Y2xhc3MgUGYgZXh0ZW5kcyBJdHtjb25zdHJ1Y3RvcihlKXtzdXBlcigpO2wodGhpcywicGlwZWxpbmUiKTt0aGlzLnBpcGVsaW5lPW5ldyBGZih0aGlzLmNvbnRleHQsZSksdGhpcy5kaXNhYmxlUG9zdFByb2Nlc3NpbmcoKX19Y2xhc3Mga2YgZXh0ZW5kcyBhb3tjb25zdHJ1Y3Rvcigpe3N1cGVyKC4uLmFyZ3VtZW50cyk7bCh0aGlzLCJmcmFtZVJlYWRlciIpO2wodGhpcywicHJlY2lzZU1hc2tFbmFibGVkIiwhMCl9c2V0IGlucHV0VmlkZW8oZSl7dGhpcy5mcmFtZVJlYWRlcj1lLmdldFJlYWRlcigpLHRoaXMucmVhZE5leHRWaWRlb0ZyYW1lKCl9YXN5bmMgcnVuKCl7dGhpcy5mcmFtZVJlYWRlciYmKGF3YWl0IHN1cGVyLnJ1bigpLHRoaXMucmVhZE5leHRWaWRlb0ZyYW1lKCkpfWFzeW5jIHJlYWROZXh0VmlkZW9GcmFtZSgpe3ZhciBuO2NvbnN0IGU9YXdhaXQoKG49dGhpcy5mcmFtZVJlYWRlcik9PW51bGw/dm9pZCAwOm4ucmVhZCgpKTtlIT1udWxsJiZlLnZhbHVlJiYodGhpcy5pbnB1dEJhY2tncm91bmRJbWFnZT1hd2FpdCBjcmVhdGVJbWFnZUJpdG1hcChlLnZhbHVlKSxlLnZhbHVlLmNsb3NlKCkpfX1jbGFzcyBEZiBleHRlbmRzIEl0e2NvbnN0cnVjdG9yKCl7c3VwZXIoKTtsKHRoaXMsInBpcGVsaW5lIik7dGhpcy5waXBlbGluZT1uZXcga2YodGhpcy5jb250ZXh0KX1zZXRCYWNrZ3JvdW5kVmlkZW8oZSl7dGhpcy5waXBlbGluZS5pbnB1dFZpZGVvPWV9fWNsYXNzIG1ve2JsdXJCYWNrZ3JvdW5kKHQpe3JldHVybiBuZXcgUmYodCl9Ymx1clNpbGhvdWV0dGUodCl7cmV0dXJuIG5ldyBQZih0KX1pbWFnZUJhY2tncm91bmQoKXtyZXR1cm4gbmV3IGZvfXZpZGVvQmFja2dyb3VuZCgpe3JldHVybiBuZXcgRGZ9fWNsYXNzIENme2NvbnN0cnVjdG9yKHQpe2wodGhpcywiZmFjdG9yeSIpO3N3aXRjaCh0KXtjYXNlIG50LkNBTlZBUzp0aGlzLmZhY3Rvcnk9bmV3IGxvO2JyZWFrO2Nhc2UgbnQuV0VCR0w6dGhpcy5mYWN0b3J5PW5ldyBtbzticmVhaztkZWZhdWx0OmNvbnN0IGU9V2koKTt0aGlzLmZhY3Rvcnk9ZS5zdXBwb3J0ZWQ/bmV3IG1vOm5ldyBsb319Ymx1ckJhY2tncm91bmQodCl7cmV0dXJuIHRoaXMuZ2V0RmFjdG9yeSgpLmJsdXJCYWNrZ3JvdW5kKHQpfWJsdXJTaWxob3VldHRlKHQpe3JldHVybiB0aGlzLmdldEZhY3RvcnkoKS5ibHVyU2lsaG91ZXR0ZSh0KX1pbWFnZUJhY2tncm91bmQoKXtyZXR1cm4gdGhpcy5nZXRGYWN0b3J5KCkuaW1hZ2VCYWNrZ3JvdW5kKCl9dmlkZW9CYWNrZ3JvdW5kKCl7cmV0dXJuIHRoaXMuZ2V0RmFjdG9yeSgpLnZpZGVvQmFja2dyb3VuZCgpfWdldEZhY3RvcnkoKXtpZighdGhpcy5mYWN0b3J5KXRocm93IkZhY3RvcnkgaXMgbm90IGluaXRpYWxpemVkIjtyZXR1cm4gdGhpcy5mYWN0b3J5fX1jbGFzcyBCZntjb25zdHJ1Y3Rvcigpe2wodGhpcywicmVuZGVyZXIiKX1zZXRCYWNrZ3JvdW5kT3B0aW9ucyh0KXt2YXIgbixvO2NvbnN0IGU9bmV3IENmKChuPXQucmVuZGVyaW5nT3B0aW9ucyk9PW51bGw/dm9pZCAwOm4udHlwZSk7c3dpdGNoKHQudHJhbnNmb3JtZXJUeXBlKXtjYXNlIkJhY2tncm91bmRCbHVyIjp0aGlzLnJlbmRlcmVyPWUuYmx1ckJhY2tncm91bmQodGhpcy5nZXRCbHVyU2l6ZSh0LnJhZGl1cykpO2JyZWFrO2Nhc2UiU2lsaG91ZXR0ZUJsdXIiOnRoaXMucmVuZGVyZXI9ZS5ibHVyU2lsaG91ZXR0ZSh0aGlzLmdldEJsdXJTaXplKHQucmFkaXVzKSk7YnJlYWs7Y2FzZSJWaWRlb0JhY2tncm91bmQiOnRoaXMucmVuZGVyZXI9ZS52aWRlb0JhY2tncm91bmQoKTticmVhaztjYXNlIlZpcnR1YWxCYWNrZ3JvdW5kIjp0aGlzLnJlbmRlcmVyPWUuaW1hZ2VCYWNrZ3JvdW5kKCk7YnJlYWs7ZGVmYXVsdDp0aHJvd2BVbmtub3duIHJlbmRlcmluZyB0eXBlIFske3QudHJhbnNmb3JtZXJUeXBlfV1gfSgobz10LnJlbmRlcmluZ09wdGlvbnMpPT1udWxsP3ZvaWQgMDpvLnR5cGUpPT09bnQuV0VCR0wmJih0LnJlbmRlcmluZ09wdGlvbnMuc2VsZmllU2VnbWVudGF0aW9uVHlwZT09PUd0LlBSRUNJU0U/dGhpcy5yZW5kZXJlci5lbmFibGVQb3N0UHJvY2Vzc2luZygpOnQucmVuZGVyaW5nT3B0aW9ucy5zZWxmaWVTZWdtZW50YXRpb25UeXBlPT09R3QuRkFTVCYmdGhpcy5yZW5kZXJlci5kaXNhYmxlUG9zdFByb2Nlc3NpbmcoKSl9c2V0RmxpY2tlcmluZ09wdGlvbnModCl7dmFyIGU7KGU9dGhpcy5yZW5kZXJlcik9PW51bGx8fGUuc2V0RmxpY2tlcmluZ09wdGlvbnModCl9c2V0VmlkZW9CR1JlYWRhYmxlKHQpe2NvbnN0IGU9dGhpcy5yZW5kZXJlcjtlLnNldEJhY2tncm91bmRWaWRlbyYmZS5zZXRCYWNrZ3JvdW5kVmlkZW8odCl9YXN5bmMgc2V0VmlydHVhbEJHSW1hZ2UodCl7Y29uc3QgZT10aGlzLnJlbmRlcmVyO2Uuc2V0QmFja2dyb3VuZEltYWdlJiZlLnNldEJhY2tncm91bmRJbWFnZSh0KX1hc3luYyBwcm9jZXNzKHQsZSl7aWYodGhpcy5yZW5kZXJlcilyZXR1cm4gdGhpcy5yZW5kZXJlci5yZW5kZXIodCxlKX1hc3luYyByZXNpemVGb3JlZ3JvdW5kKHQsZSl7fWdldEJsdXJTaXplKHQ9cnQuTG93KXtzd2l0Y2godCl7Y2FzZSBydC5Mb3c6cmV0dXJuIDU7Y2FzZSBydC5IaWdoOnJldHVybiAxMn1yZXR1cm4gdH1hc3luYyBwcm9maWxlKHQpe3ZhciBlLG47cmV0dXJuKG49KGU9dGhpcy5yZW5kZXJlcik9PW51bGw/dm9pZCAwOmUucHJvZmlsZVdlYmdsKHQpKSE9bnVsbD9uOltdfX1jbGFzcyBOZntjb25zdHJ1Y3Rvcigpe2wodGhpcywic2VsZmllU2VnbWVudGF0aW9uIixuZXcgR2kpO2wodGhpcywiYmFja2dyb3VuZEZpbHRlciIpO2wodGhpcywicmVwb3J0ZXIiLG5ldyBOaSk7bCh0aGlzLCJiYWNrZ3JvdW5kT3B0aW9ucyIpfWFzeW5jIGluaXQodCxlKXthd2FpdCB0aGlzLnNlbGZpZVNlZ21lbnRhdGlvbi5pbml0KGUud2FzbUFzc2V0VXJpUGF0aCxlLnRmbGl0ZUFzc2V0VXJpUGF0aCksdGhpcy5iYWNrZ3JvdW5kRmlsdGVyPW5ldyBCZix0aGlzLnJlcG9ydCh7dmFyaWF0aW9uOiJDcmVhdGUifSl9YXN5bmMgdHJhbnNmb3JtKHQsZSl7dmFyIGEsdTtsZXQgbjtjb25zdCBvPShhPXQudGltZXN0YW1wKSE9bnVsbD9hOjAsaT1hd2FpdCBjcmVhdGVJbWFnZUJpdG1hcCh0KSxzPWF3YWl0IHRoaXMuc2VsZmllU2VnbWVudGF0aW9uLnByb2Nlc3MoaSk7cyYmKG49YXdhaXQoKHU9dGhpcy5iYWNrZ3JvdW5kRmlsdGVyKT09bnVsbD92b2lkIDA6dS5wcm9jZXNzKGkscykpKSxuPyh0LmNsb3NlKCksZS5lbnF1ZXVlKG5ldyBWaWRlb0ZyYW1lKG4se3RpbWVzdGFtcDpvLGFscGhhOiJkaXNjYXJkIn0pKSk6ZS5lbnF1ZXVlKHQpfWFzeW5jIHNldEJhY2tncm91bmRPcHRpb25zKHQpe3ZhciBlO3RoaXMuYmFja2dyb3VuZE9wdGlvbnM9dCxhd2FpdCgoZT10aGlzLmJhY2tncm91bmRGaWx0ZXIpPT1udWxsP3ZvaWQgMDplLnNldEJhY2tncm91bmRPcHRpb25zKHQpKSx0aGlzLnJlcG9ydCh7dmFyaWF0aW9uOiJVcGRhdGUifSl9YXN5bmMgc2V0VmlkZW9CR1JlYWRhYmxlKHQpe3ZhciBlO2F3YWl0KChlPXRoaXMuYmFja2dyb3VuZEZpbHRlcik9PW51bGw/dm9pZCAwOmUuc2V0VmlkZW9CR1JlYWRhYmxlKHQpKX1hc3luYyBzZXRWaXJ0dWFsQkdJbWFnZSh0KXt2YXIgZTthd2FpdCgoZT10aGlzLmJhY2tncm91bmRGaWx0ZXIpPT1udWxsP3ZvaWQgMDplLnNldFZpcnR1YWxCR0ltYWdlKHQpKX1zZXRGbGlja2VyaW5nT3B0aW9ucyh0KXt2YXIgZTsoZT10aGlzLmJhY2tncm91bmRGaWx0ZXIpPT1udWxsfHxlLnNldEZsaWNrZXJpbmdPcHRpb25zKHQpLHRoaXMucmVwb3J0KHt2YXJpYXRpb246IlVwZGF0ZSJ9KX1hc3luYyBwcm9maWxlKHQpe3ZhciBlLG47cmV0dXJuKG49KGU9dGhpcy5iYWNrZ3JvdW5kRmlsdGVyKT09bnVsbD92b2lkIDA6ZS5wcm9maWxlKHQpKSE9bnVsbD9uOltdfWdldFRyYW5zZm9ybWVyVHlwZSgpe3ZhciB0LGU7cmV0dXJuKGU9KHQ9dGhpcy5iYWNrZ3JvdW5kT3B0aW9ucyk9PW51bGw/dm9pZCAwOnQudHJhbnNmb3JtZXJUeXBlKSE9bnVsbD9lOiJVbmRlZmluZWQifXJlcG9ydCh0KXt2YXIgZTt0aGlzLnJlcG9ydGVyLnNlbmQoe3ZlcnNpb246T2ksYWN0aW9uOiJNbFRyYW5zZm9ybWVycyIsdHJhbnNmb3JtZXJUeXBlOihlPXRoaXMuYmFja2dyb3VuZE9wdGlvbnMpPT1udWxsP3ZvaWQgMDplLnRyYW5zZm9ybWVyVHlwZSxjb25maWc6SlNPTi5zdHJpbmdpZnkodGhpcy5iYWNrZ3JvdW5kT3B0aW9ucyksLi4udH0pfX1jb25zdCBTcj1jbGFzc3tjb25zdHJ1Y3Rvcigpe2wodGhpcywiYmFja2dyb3VuZFRyYW5zZm9ybWVyIixuZXcgTmYpO2wodGhpcywibWVkaWFQcm9jZXNzb3IiLG5ldyBsaSk7bCh0aGlzLCJyYXRlIiwzMCk7bCh0aGlzLCJyZXNvbHZlT25NZWRpYVByb2Nlc3NvciIpO2wodGhpcywiZXZlbnRzUXVldWUiLFtdKX1hc3luYyBpbml0KHQsZSl7YXdhaXQgdGhpcy5iYWNrZ3JvdW5kVHJhbnNmb3JtZXIuaW5pdCh0LGUpLGF3YWl0IHRoaXMubWVkaWFQcm9jZXNzb3Iuc2V0VHJhbnNmb3JtZXJzKFt0aGlzLmJhY2tncm91bmRUcmFuc2Zvcm1lcl0pLHRoaXMubWVkaWFQcm9jZXNzb3Iuc2V0VHJhY2tFeHBlY3RlZFJhdGUodGhpcy5yYXRlKSx0aGlzLm1lZGlhUHJvY2Vzc29yLm9uQW55KChuLG8pPT57dGhpcy5yZXNvbHZlT25NZWRpYVByb2Nlc3Nvcj8odGhpcy5yZXNvbHZlT25NZWRpYVByb2Nlc3Nvcih7bmFtZTpuLGRhdGE6b30pLHRoaXMucmVzb2x2ZU9uTWVkaWFQcm9jZXNzb3I9dm9pZCAwKTp0aGlzLmV2ZW50c1F1ZXVlLnB1c2goe25hbWU6bixkYXRhOm99KX0pfWFzeW5jIG9uTWVkaWFQcm9jZXNzb3JFdmVudCgpe3JldHVybiBhd2FpdCBuZXcgUHJvbWlzZSh0PT57dGhpcy5ldmVudHNRdWV1ZS5sZW5ndGg+MD90KHRoaXMuZXZlbnRzUXVldWUuc2hpZnQoKSk6dGhpcy5yZXNvbHZlT25NZWRpYVByb2Nlc3Nvcj10fSl9YXN5bmMgc2V0VHJhY2tFeHBlY3RlZFJhdGUodCl7dGhpcy5yYXRlPXQsdGhpcy5tZWRpYVByb2Nlc3Nvci5zZXRUcmFja0V4cGVjdGVkUmF0ZSh0KX1hc3luYyB0cmFuc2Zvcm0odCxlKXt0aGlzLm1lZGlhUHJvY2Vzc29yLnRyYW5zZm9ybSh0LGUpfWFzeW5jIHNldEJhY2tncm91bmRPcHRpb25zKHQpe3ZhciBlO2F3YWl0KChlPXRoaXMuYmFja2dyb3VuZFRyYW5zZm9ybWVyKT09bnVsbD92b2lkIDA6ZS5zZXRCYWNrZ3JvdW5kT3B0aW9ucyh0KSl9c2V0VmlkZW9CR1JlYWRhYmxlKHQpe3RoaXMuYmFja2dyb3VuZFRyYW5zZm9ybWVyLnNldFZpZGVvQkdSZWFkYWJsZSh0KX1hc3luYyBzZXRWaXJ0dWFsQkdJbWFnZSh0KXthd2FpdCB0aGlzLmJhY2tncm91bmRUcmFuc2Zvcm1lci5zZXRWaXJ0dWFsQkdJbWFnZSh0KX1hc3luYyB0ZXJtaW5hdGUoKXthd2FpdCB0aGlzLm1lZGlhUHJvY2Vzc29yLmRlc3Ryb3koKX1zZXRGbGlja2VyaW5nT3B0aW9ucyh0KXt0aGlzLmJhY2tncm91bmRUcmFuc2Zvcm1lci5zZXRGbGlja2VyaW5nT3B0aW9ucyh0KX1zZXRWb25hZ2VNZXRhZGF0YSh0KXtpaSh0KX1hc3luYyBwcm9maWxlKHQpe3JldHVybiBKU09OLnN0cmluZ2lmeShhd2FpdCB0aGlzLmJhY2tncm91bmRUcmFuc2Zvcm1lci5wcm9maWxlKHQpKX19O2xldCBobz1TcjsoKCk9Pnt3bygiUHJvY2Vzc29yV29ya2VyIixTcil9KSgpfSkoKTsK",Ni=typeof window<"u"&&window.Blob&&new Blob([atob(ki)],{type:"text/javascript;charset=utf-8"});function Li(){const e=Ni&&(window.URL||window.webkitURL).createObjectURL(Ni);try{return e?new Worker(e):new Worker("data:application/javascript;base64,"+ki)}finally{e&&(window.URL||window.webkitURL).revokeObjectURL(e)}}const Mi=class extends Ye{constructor(){super(...arguments),o(this,"rate",30),o(this,"worker")}async init(e){this.worker=await at(xi,Li),await this.worker.init("worker_"+Mi.initCount++,e),await this.worker.setVonageMetadata(Q()),await this.setBackgroundOptions(e),this.listenWorker()}async setTrackExpectedRate(e){var t;await(null==(t=this.worker)?void 0:t.setTrackExpectedRate(e))}async setBackgroundOptions(e){var t,n,r;await(null==(t=this.worker)?void 0:t.setBackgroundOptions(e));const{transformerType:i}=e;switch(i){case"VideoBackground":await(null==(n=this.worker)?void 0:n.setVideoBGReadable(await ct.createVideoReadable(e.backgroundAssetUri)));break;case"VirtualBackground":await(null==(r=this.worker)?void 0:r.setVirtualBGImage(await ct.createImageCanvas(e.backgroundAssetUri)))}}async transform(e,t){var n;await(null==(n=this.worker)?void 0:n.transform(e,t))}async destroy(){var e;await(null==(e=this.worker)?void 0:e.terminate())}async setFlickeringOptions(e){var t;await(null==(t=this.worker)?void 0:t.setFlickeringOptions(e))}async profile(e){var t;const n=await(null==(t=this.worker)?void 0:t.profile(e));return JSON.parse(null!=n?n:"[]")}async listenWorker(){for(var e,t,n;null!=(e=this.worker)&&e.workerContext.worker;){const{name:e,data:r}=await(null==(t=this.worker)?void 0:t.onMediaProcessorEvent());switch(e){case"error":case"warn":this.emit(e,r);break;case"pipelineInfo":switch(this.emit(e,r),r){case"pipeline_ended":case"pipeline_ended_with_error":return void await(null==(n=this.worker)?void 0:n.terminate())}}}}};let Vi=Mi;o(Vi,"initCount",0);class Pi{constructor(e){this.queries=e}async downloadSpeedscope(){this.download(await this.convertToSpeedscope())}download(e){const t=document.createElement("a");t.href=URL.createObjectURL(new Blob([e],{type:"application/json"})),t.download=`profile-${+new Date}.speedscope.json`,document.body.appendChild(t),t.click(),document.body.removeChild(t)}convertToSpeedscope(){const e=[],t={},n=[];let r=0;for(const i of this.queries){const o=[];for(const n of i)void 0===t[n.name]&&(t[n.name]=e.length,e.push({name:n.name})),o.push({type:n.action==fi.PUSH?"O":"C",frame:t[n.name],at:n.timestamp}),r=Math.max(r,n.timestamp+n.duration);n.push({events:o,type:"evented",name:"GPU Profile",unit:"nanoseconds",startValue:0,endValue:r})}const i={$schema:"https://www.speedscope.app/file-format-schema.json",shared:{frames:e},profiles:n};return JSON.stringify(i,null,2)}}class Di extends Ye{constructor(){super(),o(this,"worker",new Vi),o(this,"connector",new ce(this.worker))}async init(e){await this.worker.init(e),this.worker.onAny((e,t)=>this.emit(e,t))}async setBackgroundOptions(e){await this.worker.setBackgroundOptions(e)}setTrackExpectedRate(e){this.worker.setTrackExpectedRate(e)}getConnector(){return this.connector}async profile(e){return this.worker.profile(e)}static async profile(t){const n=await e.all(this.instances.map(e=>e.profile(t)));return new Pi(n)}static async create(e){const t=new this;return await t.init(e),this.instances.push(t),t}}function Zi(){return Ee}function ji(){return _e}function Wi(){return Te}function Gi(){return Re}function Fi(){return Ie}function Ui(){return we}function Xi(){return Ce}async function Bi(e){return await Di.create(e)}o(Di,"instances",[])}.call(this,n(2),n(43))},function(e,t,n){"use strict";const r=n(35)().onlyLocal(),i=n(101).prependProxyToUrlIfNeeded,o={getConfig:function(e){void 0===e&&(e={});const t=e,n=t.staticConfig,o=((e,t)=>{let n=e.apiUrl.includes("anvil.opentok.com")?"https://static.opentok.com":"https://www.dev.tokbox.com";return t&&(n=t.includes("euproxy.opentok.com")?"https://static-eu.opentok.com":i(n,t)),n+"/ml-transformers/v4.0.0"})(void 0===n?r:n,t.proxyUrl);return{mediapipeBaseAssetsUri:""+o,wasmAssetUriPath:o+"/",tfliteAssetUriPath:o+"/"}}};e.exports=o},function(e,t,n){"use strict";const r=n(17),i=n(11),o=n(732),a=n(733),s=n(734);e.exports=function(e){void 0===e&&(e={});const t=e.Errors||n(7),c=e.ExceptionCodes||n(10),u=e.logging||n(0)("publisherInit"),d=e.otError||n(13)(),l=e.OTHelpers||n(8),f=e.Publisher||n(169)(),p=e.sessionObjects||n(22);return function(e,n,h){let m;u.debug(`OT.initPublisher(${e})`),"string"!=typeof e||document.getElementById(e)||(e=n,n=h,h=arguments[3]),"function"==typeof e?(h=e,n=void 0,e=void 0):i(e)&&!l.isElementNode(e)&&(h=n,n=e,e=void 0),"function"==typeof n&&(h=n,n=void 0),n&&(i(n)?!1===n.insertDefaultUI&&e?m="You cannot specify a target element if insertDefaultUI is false":o(n.audioSource)&&o(n.videoSource)&&(m="You cannot specify both audioSource and videoSource as null or false"):(m="properties argument to Publisher constructor, if provided, should be an object",n=void 0)),a(n),s(n);const g=new f(n||{});p.publishers.add(g);const v=function(){h&&r(h)&&(h(...arguments),h=void 0)};void 0!==m&&(u.error(m),v(d(t.INVALID_PARAMETER,new Error(m),c.INVALID_PARAMETER)));const y=function(e){g.off("publishComplete",b),v(e)};let b=function(e){g.off("initSuccess",y),e&&v(e)};return g.once("initSuccess",y),g.once("publishComplete",b),g.publish(e),g}}},function(e,t,n){"use strict";(function(t){var r=n(1),i=r(n(4)),o=r(n(5));const a=n(14),s=n(735),c=n(11),u=n(17),d=n(9),l=n(26),f=n(6),p=n(21),h=n(35)(),m=n(74),g=n(318),v=n(737),y=n(738),b=n(739),S=n(101).prependProxyToUrlIfNeeded,E=n(102).getProxyUrl,_=n(741);e.exports=function(e){void 0===e&&(e={});const r=e.adaptIceServers||n(103).adaptIceServers,T=e.AnalyticsHelper||p,R=e.APIKEY||n(71),I=e.Capabilities||n(170),w=e.convertAnvilErrorCode||n(742),C=e.convertRumorError||n(325),O=e.Errors||n(7),A=e.Events||n(24)(),x=e.Stream||n(171),k=e.ExceptionCodes||n(10),N=e.hasIceRestartsCapability||n(326),L=e.hasE2eeCapability||n(110),M=e.logging||n(0)("Session"),V=e.otError||n(13)(),P=e.OTErrorClass||n(23),D=e.OTHelpers||n(8),Z=n(743),j=e.StaticConfig||h,W=e.staticConfig||j.onlyLocal(),G=e.Publisher||n(169)(),F=e.RaptorSocket||n(744).default(),U=e.SessionDispatcher||n(334),X=e.sessionObjects||n(22),B=e.sessionTag||n(333),H=e.socketCloseCodes||n(77),Y=e.Subscriber||n(310)(),J=e.systemRequirements||n(153),z=e.uuid||n(16),K=y({otError:V}),Q=e.global||(void 0!==typeof window?window:global),q=e.getSessionInfo||n(768)(),$=n(142),ee=e.KeyStore||n(771),te=e.SFrameClientStore||n(773),ne=e.SinglePeerConnectionController||n(775),re=e.initPublisher||n(323)({Publisher:G});return function(e,n,p){var h=this;let y=void 0===p?{}:p,ie=y.iceConfig,oe=y.connectionEventsSuppressed,ae=y.ipWhitelist,se=void 0!==ae&&ae,ce=y.encryptionSecret,ue=y._enableSinglePeerConnection;const de=E(),le=new T,fe=e=>"string"==typeof e?this.streams.get(e)||{id:e}:e;let pe,he,me,ge,ve,ye,be,Se;f(this),this._tag=B,J.check()||J.upgrade(),null==n&&(n=e,e=null),K(ie),this.id=n,this.sessionId=n,this.keyStore=new ee,this.sFrameClientStore=new te;let Ee=!1,_e=e;const Te=this;let Re=n,Ie=z(),we=M,Ce=!1;const Oe=[];let Ae,xe,ke,Ne,Le=null,Me=!1,Ve=!1,Pe=ce;const De=D.statable(this,["disconnected","connecting","connected","disconnecting"],"disconnected");let Ze;this.connection=null,this.connections=new D.Collection,this.streams=new D.Collection,this.archives=new D.Collection;const je=function(e){De("disconnected"),e.code||(e.code=k.CONNECT_FAILED),we.error(`${e.name||"Unknown Error"}: ${e.message}`),P.handleJsException({error:e,target:this,analytics:le}),this.trigger("sessionConnectFailed",e)},We=function(e){Ee=!1;const t=e.reason;this.logEvent("Connect","Disconnected",{reason:e.reason});const n=new A.SessionDisconnectEvent("sessionDisconnected",t.replace("networkTimedout","networkDisconnected"));this.isConnected()&&this.disconnect(),xe(),Ae.call(this,t),setTimeout(()=>{this.dispatchEvent(n),ke.call(this,n.reason),n.isDefaultPrevented()||Ne.call(this,n.reason)})},Ge=function(e){oe||e.id.match(/^symphony\./)||this.dispatchEvent(new A.ConnectionEvent(l.CONNECTION_CREATED,e))},Fe=function(e,t){e.id.match(/^symphony\./)||pe&&e.id===pe.id()||this.dispatchEvent(new A.ConnectionEvent(l.CONNECTION_DESTROYED,e,t))},Ue=function(e){!e||!e.connection||this.connection&&e.connection.id===this.connection.id||this.dispatchEvent(new A.StreamEvent(l.STREAM_CREATED,e,null,!1))},Xe=function(e){const t=e.target,n=e.changedProperty;let r=e.newValue;"videoDisableWarning"!==n&&"audioDisableWarning"!==n&&("videoDimensions"===n&&(r={width:r.width,height:r.height}),this.dispatchEvent(new A.StreamPropertyChangedEvent(l.STREAM_PROPERTY_CHANGED,t,n,e.oldValue,r)))},Be=function(e,t){void 0===t&&(t="clientDisconnected");const n=new A.StreamEvent("streamDestroyed",e,t,!0);e.connection.id===this.connection.id?X.publishers.where({streamId:e.id}).forEach((function(n){n._.unpublishStreamFromSession(e,this,t)}),this):this.dispatchEvent(n),(()=>{X.subscribers.where({streamId:e.id}).filter(e=>e.session.id===this.id&&e.stream).forEach(e=>{e._disconnect({reason:t}),n.isDefaultPrevented()||e._destroy({reason:t,noStateTransition:!0})})})()},He=function(e){this.dispatchEvent(new A.ArchiveEvent("archiveStarted",e))},Ye=function(e){this.dispatchEvent(new A.ArchiveEvent("archiveDestroyed",e))},Je=function(e){const t=e.target,n=e.changedProperty,r=e.newValue;"status"===n&&"stopped"===r?this.dispatchEvent(new A.ArchiveEvent("archiveStopped",t)):this.dispatchEvent(new A.ArchiveEvent("archiveUpdated",t))},ze=()=>X.subscribers.forEach(e=>e._.pauseAndPlayVideoElement()),Ke=function(){Te.token=null,me=null,De("disconnected"),pe=null,he&&(he.stop(),he=null),Te.connection=null,Te.capabilities=new I([],{hasE2eeCapability:L}),Te.connections.destroy(),Te.streams.destroy(),Te.archives.destroy()};xe=function(){Ie=z(),Ke()},Ae=function(e){X.publishers.where({session:this}).forEach(t=>{t.disconnect(e)}),X.subscribers.where({session:this}).forEach(e=>{e._disconnect()})},ke=function(e){X.publishers.where({session:this}).forEach(t=>{t._.streamDestroyed(e)})},Ne=function(e){X.subscribers.where({session:this}).forEach(t=>{t._destroy({reason:e})})};const Qe=function(){we.debug("OT.Session: connecting to Raptor");const e=S(this.sessionInfo.messagingURL,de),t=["forceMute"];this.sessionInfo.isAdaptiveEnabled&&t.push("amr"),Ve&&t.push("spc"),pe=new F({connectionId:Ie,sessionId:n,messagingSocketUrl:e,symphonyUrl:this.sessionInfo.symphonyAddress,dispatcher:U(this,{connectionEventsSuppressed:oe}),analytics:le,requestedCapabilities:t}),pe.connect(me,this.sessionInfo,{connectionEventsSuppressed:oe},(e,t)=>{if(e){const t={};let n;if("ConnectToSession"===e.reason||"GetSessionState"===e.reason){const n=C(e);d(t,{originalMessage:e.message,originalCode:e.code}),e.code=n.code,e.message=n.message}(e.code||e.message||e.reason)&&(n={failureCode:e.code,failureMessage:e.message,failureReason:e.reason,socketId:pe.socketId}),pe=null,this.logConnectivityEvent("Failure",t,n);const r=function(e,t){let n;switch(e){case"WebSocketConnection":if(n=s(H.codes,e=>e===t),n)return O["SOCKET_"+n];break;case"ConnectToSession":case"GetSessionState":switch(t){case k.CONNECT_FAILED:return O.CONNECT_FAILED;case k.UNEXPECTED_SERVER_RESPONSE:return O.UNEXPECTED_SERVER_RESPONSE;case k.CONNECTION_LIMIT_EXCEEDED:return O.CONNECTION_LIMIT_EXCEEDED}}}(e.reason,e.code);return r&&(e=V(r,new Error(e.message),e.code)),void je.call(this,e)}we.debug("OT.Session: Received session state from Raptor",t),this.connection=this.connections.get(pe.id()),this.connection&&(this.capabilities=this.connection.permissions),De("connected"),this.logConnectivityEvent("Success",{connectionId:this.connection.id}),this.connection.on("destroyed",We,this),this.dispatchEvent(new A.SessionConnectEvent(l.SESSION_CONNECTED)),this.connections.on({add:Ge,remove:Fe},this),this.streams.on({add:Ue,remove:Be,update:Xe},this),this.archives.on({add:He,remove:Ye,update:Je},this),this.connections._triggerAddEvents(),this.streams._triggerAddEvents(),this.archives._triggerAddEvents(),D.env.isiOS&&D.env.iOSVersion>=13.3&&this.on("gsmCallEnded",ze)})},qe=e=>this.capabilities.permittedTo(e),$e=(e,t)=>{M.error(`${e.name}: ${e.message}`),"function"==typeof t&&t(e),P.handleJsException({error:e,target:this,analytics:le})},et=e=>{const t=V(e.code,new Error(e.message),e.exceptionCode);return $e(t),t},tt=()=>this.isNot("connected")?et(Z.NOT_CONNECTED):qe("forceMute")?null:et(Z.PERMISSION_DENIED),nt=e=>"404"===e.code?et(Z.NOT_FOUND):"403"===e.code?et(Z.PERMISSION_DENIED):et(Z.UNEXPECTED_SERVER_RESPONSE);this.reportIssue=e=>{let t=e.id;return g(le.logEvent.bind(le))({action:"ReportIssue",variation:"Event",connectionId:Ie,payload:{reportIssueId:t}},null)},this.logEvent=function(e,t,n,r){let i={action:e,variation:t,payload:n,sessionId:Re,messagingServer:ve,p2p:ge,partnerId:_e,connectionId:Ie};r&&(i=d(r,i)),le.logEvent(i)},this.logConfigurationFileEvent=function(e,t,n){if(void 0===t&&(t=null),void 0===n&&(n={}),"Attempt"===e)be=(new Date).getTime();else if("Failure"===e||"Success"===e){const e=(new Date).getTime()-be;d(n,{attemptDuration:e})}de&&(n.proxyUrl=de),this.logEvent("ConfigurationFile",e,t,Object.assign({},n))},this.logConnectivityEvent=function(e,t,n){if(void 0===t&&(t=null),void 0===n&&(n={}),de&&(n.proxyUrl=de),"Attempt"===e&&(he&&(he.stop(),M.error("_connectivityAttemptPinger should have been cleaned up")),ye=(new Date).getTime(),he=new m(()=>{this.logEvent("Connect","Attempting",t,Object.assign({},n))},.2,6),he.start()),"Failure"===e||"Success"===e||"Cancel"===e){const r=r=>{he&&(he.stop(),he=void 0),this.logEvent("Connect",e,t,Object.assign({},n,{attemptDuration:(new Date).getTime()-ye,iceConfig:r,ipWhitelist:se}))};"Success"===e?this._.getIceConfig().then(e=>{const t={includeServers:ie&&ie.includeServers||"all",transportPolicy:e.transportPolicy};t.servers=e.servers?e.servers.map(e=>({url:e.urls})):[],r(t)}):r()}else this.logEvent("Connect",e,t,n)},this.connect=function(){let r;for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];o.length>1&&("string"==typeof o[0]||"number"==typeof o[0])&&"string"==typeof o[1]?(null==e&&(_e=o[0].toString()),r=o[1]):r=o[0];const s=o[o.length-1];if(h.is("connecting","connected"))return we.warn("OT.Session: Cannot connect, the session is already "+h.currentState),h;le.sessionInfo=new $,Ke(),De("connecting");const d=Ie;function l(){const e=Ie!==d;return e&&M.debug("Connection was interrupted"),e}if(h.token=!u(r)&&r,me=!u(r)&&r,s&&u(s)){let e;const t=function(){e();for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];s(void 0,...n)},n=function(){e(),s(...arguments)};e=()=>{h.off("sessionConnected",t),h.off("sessionConnectFailed",n)},h.once("sessionConnected",t),h.once("sessionConnectFailed",n)}if(null==_e||u(_e))return setTimeout(je.bind(h,V(O.AUTHENTICATION_ERROR,new Error("API Key is undefined. You must pass an API Key to initSession."),k.AUTHENTICATION_ERROR))),h;if(!Re||c(Re)||Array.isArray(Re)){let e;return Re?(e="SessionID is not a string. You must use string as the session ID passed into OT.initSession().",Re=Re.toString()):e="SessionID is undefined. You must pass a sessionID to initSession.",setTimeout(je.bind(h,V(O.INVALID_SESSION_ID,new Error(e),k.INVALID_SESSION_ID))),h.logConnectivityEvent("Attempt"),h.logConnectivityEvent("Failure",null,{failureReason:"ConnectToSession",failureCode:k.INVALID_SESSION_ID,failureMessage:e}),h}if(h.apiKey=_e.toString(),_e=_e.toString(),Pe){if(!L())return setTimeout(je.bind(h,V(O.UNSUPPORTED_BROWSER,new Error("E2E Encryption is not supported in your browser.")))),h;try{_(Pe),h.keyStore.set(n,Pe),Me=!0}catch(e){return setTimeout(je.bind(h,V(O.INVALID_ENCRYPTION_SECRET,new Error("Invalid encryptionSecret: "+e.message)))),h}}0===R.value.length&&(R.value=_e);const f=Boolean(j.onlyLocal().configUrl),p=!0===se&&Boolean(j.onlyLocal().ipWhitelistConfigUrl);f||p?h.logConfigurationFileEvent("Attempt"):h.logConfigurationFileEvent("Event",{message:"No configUrl, using local config only"});const m=f||p?j.get({partnerId:_e,token:r,useIpWhitelistConfigUrl:p,proxyUrl:de}):t.resolve(j.onlyLocal());return m.then(e=>((f||p)&&h.logConfigurationFileEvent("Success"),e),e=>((f||p)&&h.logConfigurationFileEvent("Failure",{failureMessage:e.message,failureStack:e.stack}),j.onlyLocal())).then(e=>{if(h.staticConfig=e,le.staticConfig=e,!1===e.apiEnabled)throw V(O.API_KEY_DISABLED,new Error("The API KEY has been disabled. Access to the service is currently being restricted. Please contact support."));if(l())return;h.logConnectivityEvent("Attempt"),de?h.logEvent("SessionInfo","Attempt",null,{proxyUrl:de}):h.logEvent("SessionInfo","Attempt");const t=e=>{e.code=w(e.code),h.logConnectivityEvent("Failure",null,{failureReason:"GetSessionInfo",failureCode:e.code||"No code",failureMessage:e.message,failureName:e.name}),e.name&&(e=V(e.name,new Error(`${e.message}${e.code?` (${e.code})`:""}`),e.code)),je.call(h,e)},r=S(e.apiUrl,de);return q({anvilUrl:r,sessionId:n,token:me,connectionId:Ie,clientVersion:e.clientVersion}).then(n=>{if(l())return;if(n.partnerId&&n.partnerId!==_e){const e="Authentication Error: The API key does not match the token or session.";return void t(V(O.AUTHENTICATION_ERROR,new Error(e),k.AUTHENTICATION_ERROR))}Ve=b(n,ue),Ve&&(Ze=new ne(h)),le.sessionInfo=n;const r={features:{reconnection:n.reconnection,renegotiation:N()&&n.renegotiation,simulcast:void 0!==n.simulcast&&n.simulcast&&"Chrome"===D.env.name}};if(de&&(r.proxyUrl=de),h.is("connecting")){h.sessionInfo=n,h._.setIceServers(h.sessionInfo.iceServers),ge=n.p2pEnabled,ve=n.messagingServer,h.logEvent("SessionInfo","Success",null,r,{messagingServer:n.messagingServer});const t=e.sessionInfoOverrides;null!=t&&"object"==typeof t&&Object.keys(t).forEach(e=>{Object.defineProperty(h.sessionInfo,e,{value:t[e]})}),Qe.call(h)}},t)}).catch(e=>{je.call(h,e)}),h},this.disconnect=function(){Ze&&(Ze.destroy(),Ze=null),pe&&pe.isNot("disconnected")?pe.isNot("disconnecting")&&(pe.isNot("connecting")||this.logConnectivityEvent("Cancel"),De("disconnecting"),pe.disconnect(),this.off("gsmCallEnded",ze)):xe()},this.destroy=function(){this.streams.destroy(),this.connections.destroy(),this.archives.destroy(),this.disconnect()},this.publish=function(e,t,n){if("function"==typeof e&&(n=e,e=void 0),"function"==typeof t&&(n=t,t=void 0),n=n||function(){},this.isNot("connected"))return le.logError(1010,"OT.exception","We need to be connected before you can publish",null,{action:"Publish",variation:"Failure",failureReason:"unconnected",failureCode:k.NOT_CONNECTED,failureMessage:"We need to be connected before you can publish",sessionId:Re,streamId:e&&e.stream?e.stream.id:null,p2p:this.sessionInfo?this.sessionInfo.p2pEnabled:void 0,messagingServer:this.sessionInfo?this.sessionInfo.messagingServer:null,partnerId:_e}),$e(V(O.NOT_CONNECTED,new Error("We need to be connected before you can publish"),k.NOT_CONNECTED),n),null;if(!qe("publish")){const e="This token does not allow publishing. The role must be at least `publisher` to enable this functionality",t={failureReason:"Permission",failureCode:k.UNABLE_TO_PUBLISH,failureMessage:e};return this.logEvent("Publish","Failure",null,t),$e(V(O.PERMISSION_DENIED,new Error(e),k.UNABLE_TO_PUBLISH),n),null}if(!e||"string"==typeof e||D.isElementNode(e))e=re(e,t);else{if(!(e instanceof G))return void $e(V(O.INVALID_PARAMETER,new Error("Session.publish :: First parameter passed in is neither a string nor an instance of the Publisher"),k.UNABLE_TO_PUBLISH),n);"session"in e&&e.session&&"sessionId"in e.session&&(e.session.sessionId===this.sessionId?we.warn(`Cannot publish ${e.guid()} again to ${this.sessionId}. Please call session.unpublish(publisher) first.`):we.warn(`Cannot publish ${e.guid()} publisher already attached to ${e.session.sessionId}. Please call session.unpublish(publisher) first.`))}return Ce&&e._.forceMuteAudio(),e._.publishToSession(this,le).catch(e=>{throw e.message="Session.publish :: "+e.message,we.error(e.code,e.message),e}).then(()=>e).then((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n(null,...t)}),e=>n(e)),e},this.unpublish=function(e){e?e._.unpublishFromSession(this,"unpublished"):we.error("OT.Session.unpublish: publisher parameter missing.")},this.setIceConfig=function(){var e=(0,o.default)(i.default.mark((function e(n){var r,o;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(K(n),le.logEvent({action:"setIceConfig",variation:"Attempt",payload:{newIceConfig:n}}),ie=Object.assign({},n),"all"!==n.includeServers){e.next=8;break}return e.next=6,Te._.getOtIceServerInfo();case 6:r=e.sent,n.customServers=n.customServers.concat(r.servers);case 8:return o={iceServers:(i=n).customServers,iceTransportPolicy:i.transportPolicy},e.prev=10,e.next=13,t.all(X.publishers.map(e=>e._.setIceConfig(o)).concat(X.subscribers.map(e=>e._.setIceConfig(o))));case 13:e.next=19;break;case 15:throw e.prev=15,e.t0=e.catch(10),le.logEvent({action:"setIceConfig",variation:"Failure",payload:{newIceConfig:n}}),e.t0;case 19:le.logEvent({action:"setIceConfig",variation:"Success",payload:{newIceConfig:n}});case 20:case"end":return e.stop()}var i}),e,null,[[10,15]])})));return function(t){return e.apply(this,arguments)}}(),this.subscribe=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0,n=void 0),"function"==typeof n&&(r=n,n=void 0),r=r||function(){},!this.connection||!this.connection.connectionId)return void $e(V(O.NOT_CONNECTED,new Error("Session.subscribe :: Connection required to subscribe"),k.UNABLE_TO_SUBSCRIBE),r);if(!e)return void $e(V(O.INVALID_PARAMETER,new Error("Session.subscribe :: stream cannot be null"),k.UNABLE_TO_SUBSCRIBE),r);if(!Object.prototype.hasOwnProperty.call(e,"streamId"))return void $e(V(O.INVALID_PARAMETER,new Error("Session.subscribe :: invalid stream object"),k.UNABLE_TO_SUBSCRIBE),r);if(n&&!1===n.insertDefaultUI&&t)return void $e(V(O.INVALID_PARAMETER,new Error("You cannot specify a target element if insertDefaultUI is false"),k.INVALID_PARAMETER),r);t&&!1===t.insertDefaultUI&&(n=t,t=void 0);const i=new Y(t,d(n||{},{stream:e,session:this,analytics:le,_singlePeerConnectionController:Ze}),e=>{e?$e(e,r):r(null,i)});return X.subscribers.add(i),i},this.unsubscribe=function(e){if(!e){const e="OT.Session.unsubscribe: subscriber cannot be null";throw we.error(e),new Error(e)}return e.stream?(we.debug("OT.Session.unsubscribe: subscriber "+e.id),e._destroy({reason:"Unsubscribe"}),!0):(we.warn("OT.Session.unsubscribe:: tried to unsubscribe a subscriber that had no stream"),!1)},this.getSubscribersForStream=function(e){return X.subscribers.where({streamId:e.id})},this.getPublisherForStream=function(e){let t,n;if("string"==typeof e)t=e;else{if("object"!=typeof e||!e||!Object.hasOwnProperty.call(e,"id"))throw n="Session.getPublisherForStream :: Invalid stream type",we.error(n),new Error(n);t=e.id}return X.publishers.where({streamId:t})[0]},this._={getProxyUrl:()=>de,isE2ee:()=>Te.sessionInfo.e2ee&&Me&&!!Te.capabilities.supportsE2ee,isSocketReconnecting:()=>Ee,getSocket:()=>pe,reconnecting:function(){Ee=!0,this.dispatchEvent(new A.SessionReconnectingEvent)}.bind(this),reconnected:function(){Ee=!1,this.dispatchEvent(new A.SessionReconnectedEvent),this.sessionInfo.reconnection&&(X.publishers.where({session:this}).forEach(e=>{e._.iceRestart()}),this.sessionInfo.p2pEnabled||X.subscribers.where({session:this}).forEach(e=>{e._.iceRestart("socket reconnected")}))}.bind(this),dispatchSignal:function(e,t,n){const r=new A.SignalEvent(t,n,e);r.target=this,this.trigger(l.SIGNAL,r),t&&this.dispatchEvent(r)}.bind(this),dispatchCaption:function(e,t){let n,r,i;try{const e=JSON.parse(t.data);n=e.caption.text,r=e.streamId,i=e.isFinal}catch(e){return void we.error("Caption parsing failed: "+e.message)}const o=new A.CaptionReceivedEvent(n,r,i);o.target=this,this.trigger(l.SUBSCRIBER_CAPTION_RECEIVED,o),this.dispatchEvent(o)}.bind(this),subscriberChannelUpdate:(e,t,n,r)=>pe?pe.subscriberChannelUpdate(e.id,t.widgetId,n.id,r):(we.warn("You are disconnected, cannot update subscriber properties ",r),null),streamCreate(e,t){let n=void 0===e?{}:e,r=n.name,i=n.streamId,o=n.subscriberAudioFallbackEnabled,a=n.channels,s=n.minBitrate,c=n.sourceStreamId,u=n.e2ee,d=n.publisherAudioFallbackEnabled,l=n.customProperties;pe?pe.streamCreate({name:r,streamId:i,subscriberAudioFallbackEnabled:o,channels:a,minBitrate:s,maxBitrate:void 0,sourceStreamId:c,e2ee:u,publisherAudioFallbackEnabled:d,customProperties:l},t):we.warn("You are disconnected, cannot create stream ",i)},streamDestroy(e,t){pe?pe.streamDestroy(e,t):we.warn("You are disconnected, cannot destroy stream ",e)},streamChannelUpdate(e,t,n){pe?pe.streamChannelUpdate(e.id,t.id,n):we.warn("You are disconnected, cannot update stream properties ",n)},setSocket(e){pe=e},setLogging(e){we=e},setState:De,setIceServers(e){e&&(Se={iceServers:r(e),timestamp:Date.now()})},getOtIceServerInfo(){if(864e5-(Se?Date.now()-Se.timestamp:1/0)>3e5)return t.resolve({transportPolicy:Te&&Te.sessionInfo&&Te.sessionInfo.clientCandidates,servers:Se&&Se.iceServers});if(!me)return t.resolve({transportPolicy:Te&&Te.sessionInfo&&Te.sessionInfo.clientCandidates,servers:[],needRumorIceServersFallback:!0});const e=W.clientVersion;return q({anvilUrl:(this.staticConfig||W).apiUrl,sessionId:n,token:me,connectionId:Ie,clientVersion:e}).then(e=>(Te._.setIceServers(e.iceServers),Se?{transportPolicy:Te&&Te.sessionInfo&&Te.sessionInfo.clientCandidates,servers:Se&&Se.iceServers}:{transportPolicy:Te.sessionInfo.clientCandidates,servers:[],needRumorIceServersFallback:!0}))},getCodecFlags:()=>({h264:Te.sessionInfo.h264,vp9:Te.sessionInfo.vp9,vp8:Te.sessionInfo.vp8}),getVideoCodecsCompatible:e=>v({RTCPeerConnection:Q.RTCPeerConnection,env:D.env,stream:e,codecFlags:Te._.getCodecFlags()}),getIceConfig:()=>{if(!ie)return Te._.getOtIceServerInfo();const e=ie&&"relay"===ie.transportPolicy?"relay":Te.sessionInfo.clientCandidates;return("custom"===ie.includeServers?t.resolve({servers:[]}):Te._.getOtIceServerInfo()).then(t=>d(t,{transportPolicy:e,servers:[...t.servers,...ie.customServers]}))},forceMute:function(e){this.dispatchEvent(new A.MuteForcedEvent(e))}.bind(this),enableMuteOnEntry:()=>{Ce=!0},addSubscriberToPeerConnectionsQueue:(e,t)=>{Oe.push({pc:e,message:t}),Le||(Le=setInterval(()=>{const e=Oe.shift();e?e.pc.processMessage("offer",e.message):(clearInterval(Le),Le=null)},100))},disableMuteOnEntry:()=>{Ce=!1},privateEvents:new a},this.signal=function(e,t){let n=e,r=t||function(){};if(u(n)&&(r=n,n=null),this.isNot("connected")){const e="Unable to send signal - you are not connected to the session.";$e(V(O.NOT_CONNECTED,new Error(e),500),r)}else pe.signal(n,(function(e){if(e){const t=i(e.code);return t&&(e=V(t,new Error(e.message),e.code)),void r(e)}for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];r(e,...n)}),this.logEvent),e&&e.data&&"string"!=typeof e.data&&we.warn("Signaling of anything other than Strings is deprecated. Please update the data property to be a string.");function i(e){switch(e){case 400:case 413:return O.INVALID_PARAMETER;case 429:return O.RATE_LIMIT_EXCEEDED;case 404:return O.NOT_FOUND;case 500:return O.NOT_CONNECTED;case 403:return O.PERMISSION_DENIED;case 2001:return O.UNEXPECTED_SERVER_RESPONSE;default:return}}},this.forceDisconnect=function(e,t){if(this.isNot("connected")){const e="Cannot call forceDisconnect(). You are not connected to the session.";return void $e(V(O.NOT_CONNECTED,new Error(e),k.NOT_CONNECTED),t)}const n="string"==typeof e?e:e.id,r="Invalid Parameter. Check that you have passed valid parameter values into the method call.";n?qe("forceDisconnect")?pe.forceDisconnect(n,(function(e){if(e)$e(V(O.INVALID_PARAMETER,new Error(r),k.INVALID_PARAMETER),t);else if(t&&u(t)){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];t(e,...i)}})):$e(V(O.PERMISSION_DENIED,new Error("This token does not allow forceDisconnect. The role must be at least `moderator` to enable this functionality"),k.UNABLE_TO_FORCE_DISCONNECT),t):$e(V(O.INVALID_PARAMETER,new Error(r),k.INVALID_PARAMETER),t)},this.forceUnpublish=function(e,t){void 0===t&&(t=()=>{});const n=e=>$e(V(e.name,new Error(e.msg),e.code),t),r={msg:"Invalid Parameter. Check that you have passed valid parameter values into the method call.",code:k.INVALID_PARAMETER,name:O.INVALID_PARAMETER},i={msg:"Cannot call forceUnpublish(). You are not connected to the session.",code:k.NOT_CONNECTED,name:O.NOT_CONNECTED},o={msg:"This token does not allow forceUnpublish. The role must be at least `moderator` to enable this functionality",code:k.UNABLE_TO_FORCE_UNPUBLISH,name:O.PERMISSION_DENIED},a={msg:"The stream does not exist.",name:O.NOT_FOUND},s={msg:"An unexpected error occurred.",name:O.UNEXPECTED_SERVER_RESPONSE,code:k.UNEXPECTED_SERVER_RESPONSE};if(!e)return void n(r);if(h.isNot("connected"))return void n(i);const c=fe(e);qe("forceUnpublish")?pe.forceUnpublish(c.id,e=>{e?"404"===e.code?n(a):"403"===e.code?n(o):n(s):t(null)}):n(o)},this.forceMuteStream=e=>new t((t,n)=>{const r=tt();r?n(r):e&&e.id?pe.forceMuteStream(e.id,e=>{e?n(nt(e)):t()}):n(et(Z.INVALID_PARAMETER))}),this.forceMuteAll=e=>new t((t,n)=>{const r=tt();if(r)return void n(r);if(Array.isArray(e)&&!e.every(e=>e instanceof x)||e&&!Array.isArray(e))return void n(et(Z.INVALID_PARAMETER));const i=(e||[]).map(e=>e.id);pe.forceMuteAll(i,!0,e=>{e?n(nt(e)):t()})}),this.disableForceMute=()=>new t((e,t)=>{const n=tt();n?t(n):pe.forceMuteAll([],!1,n=>{n?t(nt(n)):e()})}),this.setEncryptionSecret=function(){var e=(0,o.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Pe){e.next=3;break}return M.error("Encryption secret must first be set in initSession."),e.abrupt("return");case 3:e.prev=3,_(t),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(3),V(O.INVALID_ENCRYPTION_SECRET,new Error("setEncryptionSecret: "+e.t0.message));case 10:return e.prev=10,e.next=13,h.keyStore.set(n,t);case 13:Pe=t,e.next=19;break;case 16:e.prev=16,e.t1=e.catch(10),we.error("Error in setEncryptionSecret}: "+e.t1.message);case 19:case"end":return e.stop()}}),e,null,[[3,7],[10,16]])})));return function(t){return e.apply(this,arguments)}}(),this.isConnected=()=>this.is("connected"),this.capabilities=new I([],{hasE2eeCapability:L})}}}).call(this,n(2))},function(e,t,n){"use strict";const r=n(10),i=n(23),o=[400,403,409,r.CONNECTION_LIMIT_EXCEEDED],a="ConnectToSession",s="GetSessionState";e.exports=function(e){let t,n;if(e.reason===a&&e.code===r.CONNECT_FAILED)t=e.code,n=i.getTitleByCode(e.code);else if(e.code&&o.indexOf(Number(e.code))>-1)switch(t=r.CONNECT_FAILED,e.reason){case a:switch(e.code){case r.CONNECTION_LIMIT_EXCEEDED:t=e.code,n="Cannot connect -- the limit for concurrent connections to the session has been reached";break;default:n="Received error response to connection create message."}break;case s:n="Received error response to session read";break;default:n=""}else t=r.UNEXPECTED_SERVER_RESPONSE,n="Unexpected server response. Try this operation again later.";return{code:t,message:n}}},function(e,t,n){"use strict";const r=n(3),i=n(52).once;e.exports=()=>i()&&(r.isChromiumEdge||["Chrome","Safari","Firefox","Opera"].includes(r.name))},function(e,t,n){"use strict";e.exports=function(e){return JSON.stringify(e)}},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0,t.default=e=>{let t=e.logger,n=e.obj;e.eventNames.forEach(e=>{n.on(e,(function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t.spam("emitted",e,r)}))})}},function(e,t,n){"use strict";const r=n(17),i=n(23),o=n(6),a=n(0)("Dispatcher"),s=n(172),c=n(759),u=function(){o(this),this.callbacks={}};e.exports=u,u.prototype.registerCallback=function(e,t){this.callbacks[e]=t},u.prototype.triggerCallback=function(e){if(!e)return;const t=this.callbacks[e];if(t&&r(t)){const e=Array.prototype.slice.call(arguments);e.shift(),t(...e)}delete this.callbacks[e]},u.prototype.onClose=function(e){this.emit("close",e)},u.prototype.onReconnected=function(){this.emit("reconnected")},u.prototype.onReconnecting=function(){this.emit("reconnecting")},u.prototype.dispatch=function(e){var t,n;if(e.type===s.STATUS){var r;let t;if(a.debug(e),e.isError){let n;if("string"==typeof e.data)try{const t=JSON.parse(e.data);t&&"object"==typeof t&&(n=t.reason)}catch(e){a.warn("Failed to parse rumorMessage.data",e)}t=new i(e.status,n)}const n=e.data?JSON.parse(e.data):"";return null!=n&&null!=(r=n.mute)&&r.active&&this.dispatchMuteOnEntry(),void this.triggerCallback(e.transactionId,t,e)}const o=c(e);switch(a.debug(o.signature+":",o),o.resource){case"session":this.dispatchSession(o);break;case"connection":if(null!=o&&null!=(t=o.content)&&null!=(n=t.userAgent)&&n.includes("auriga"))return;this.dispatchConnection(o);break;case"stream":this.dispatchStream(o);break;case"stream_channel":this.dispatchStreamChannel(o);break;case"subscriber":this.dispatchSubscriber(o);break;case"subscriber_channel":this.dispatchSubscriberChannel(o);break;case"signal":this.dispatchSignal(o);break;case"data":this.dispatchCaption(o);break;case"archive":this.dispatchArchive(o);break;case"source":this.dispatchSource(o);break;default:a.debug(`Type ${o.resource} is not currently implemented`)}},u.prototype.dispatchSession=function(e){switch(e.method){case"read":this.emit("session#read",e.content,e.transactionId);break;case"update":this.emit("session#update",e.content);break;default:a.debug(e.signature+" is not currently implemented")}},u.prototype.dispatchMuteOnEntry=function(){this.emit("session#muted")},u.prototype.dispatchConnection=function(e){switch(e.method){case"created":this.emit("connection#created",e.content);break;case"deleted":this.emit("connection#deleted",e.params.connection,e.reason);break;default:a.debug(e.signature+" is not currently implemented")}},u.prototype.dispatchStream=function(e){switch(e.method){case"created":this.emit("stream#created",e.content,e.transactionId);break;case"deleted":this.emit("stream#deleted",e.params.stream,e.reason,e.content);break;case"updated":this.emit("stream#updated",e.params.stream,e.content);break;case"update":this.emit("stream#update",e.params.stream,e.content);break;case"generateoffer":case"answer":case"pranswer":case"offer":case"candidate":this.dispatchJsep(e.method,e);break;default:a.debug(e.signature+" is not currently implemented")}},u.prototype.dispatchStreamChannel=function(e){switch(e.method){case"updated":this.emit("streamChannel#updated",e.params.stream,e.params.channel,e.content);break;default:a.debug(e.signature+" is not currently implemented")}},u.prototype.dispatchJsep=function(e,t){this.emit("jsep#"+e,t.params.stream,t.fromAddress,t)},u.prototype.dispatchSubscriberChannel=function(e){switch(e.method){case"updated":this.emit("subscriberChannel#updated",e.params.stream,e.params.channel,e.content);break;case"update":this.emit("subscriberChannel#update",e.params.subscriber,e.params.stream,e.content);break;default:a.debug(e.signature+" is not currently implemented")}},u.prototype.dispatchSubscriber=function(e){switch(e.method){case"created":this.emit("subscriber#created",e.params.stream,e.fromAddress,e.content.id);break;case"deleted":this.dispatchJsep("unsubscribe",e),this.emit("subscriber#deleted",e.params.stream,e.fromAddress);break;case"generateoffer":case"answer":case"pranswer":case"offer":case"candidate":this.dispatchJsep(e.method,e);break;default:a.debug(e.signature+" is not currently implemented")}},u.prototype.dispatchSignal=function(e){"signal"===e.method?this.emit("signal",e.fromAddress,e.content):a.debug(e.signature+" is not currently implemented")},u.prototype.dispatchCaption=function(e){this.emit("caption",e.fromAddress,e.content)},u.prototype.dispatchArchive=function(e){switch(e.method){case"created":this.emit("archive#created",e.content);break;case"updated":this.emit("archive#updated",e.params.archive,e.content)}},u.prototype.dispatchSource=function(e){switch(e.method){case"create":this.emit("source#create",e.params.source,e.params.stream,e.reason);break;case"delete":this.emit("source#delete",e.params.source,e.params.stream,e.reason);break;default:a.debug(e.signature+" is not currently implemented")}}},function(e,t,n){"use strict";const r=n(16),i=n(8),o=n(762),a=n(763),s=n(327),c=n(764),u=n(35)().onlyLocal(),d={};e.exports=d,d.connections={},d.connections.create=function(e){const t=e.apiKey,n=e.sessionId,r=e.connectionId,o=e.connectionEventsSuppressed,a=e.capabilities;return s({method:"create",uri:`/v2/partner/${t}/session/${n}/connection/${r}`,content:{userAgent:i.env.userAgent,clientVersion:u.clientVersion,capabilities:a||[],connectionEventsSuppressed:o}})},d.connections.destroy=function(e){const t=e.apiKey,n=e.sessionId,r=e.connectionId;return s({method:"delete",uri:`/v2/partner/${t}/session/${n}/connection/${r}`,content:{}})},d.sessions={},d.sessions.get=function(e,t){return s({method:"read",uri:`/v2/partner/${e}/session/${t}`,content:{}})},d.streams={},d.streams.get=function(e,t,n){return s({method:"read",uri:`/v2/partner/${e}/session/${t}/stream/${n}`,content:{}})},d.streams.channelFromOTChannel=function(e){const t={id:e.id,type:e.type,active:e.active};return"video"===e.type&&(t.width=e.width,t.height=e.height,t.orientation=e.orientation,t.frameRate=e.frameRate,"default"!==e.source&&(t.source=e.source),t.fitMode=e.fitMode),t},d.streams.create=function(e){void 0===e&&(e={});const t=e,n=t.apiKey,r=t.sessionId,i=t.streamId,o=t.name,a=t.audioFallbackEnabled,c=t.publisherAudioFallbackEnabled,u=t.subscriberAudioFallbackEnabled,l=t.channels,f=t.minBitrate,p=t.maxBitrate,h=t.sourceStreamId,m=t.e2ee,g=t.customProperties,v={id:i,name:o,audioFallbackEnabled:a,publisherAudioFallbackEnabled:c,subscriberAudioFallbackEnabled:u,channel:l.map(e=>d.streams.channelFromOTChannel(e)),e2ee:m,customProperties:g};return f&&(v.minBitrate=Math.round(f)),p&&(v.maxBitrate=Math.round(p)),h&&(v.sourceStreamId=h),"boolean"==typeof m&&(v.e2ee=m),s({method:"create",uri:`/v2/partner/${n}/session/${r}/stream/${i}`,content:v})},d.streams.destroy=function(e,t,n,r){const i={};return r&&(i.sourceStreamId=r),s({method:"delete",uri:`/v2/partner/${e}/session/${t}/stream/${n}`,content:i})},d.streamChannels={},d.streamChannels.update=function(e,t,n,r,i){return s({method:"update",uri:`/v2/partner/${e}/session/${t}/stream/${n}/channel/${r}`,content:i})},d.subscribers={},d.subscribers.create=function(e){void 0===e&&(e={});const t=e,n=t.apiKey,r=t.sessionId,i=t.streamId,u=t.subscriberId,d=t.connectionId,l=t.channelsToSubscribeTo,f=t.sourceStreamId,p=t.e2ee,h={id:u,connection:d,keyManagementMethod:c,bundleSupport:o(),rtcpMuxSupport:a(),e2ee:p};return l&&(h.channel=l),f&&(h.sourceStreamId=f),s({method:"create",uri:`/v2/partner/${n}/session/${r}/stream/${i}/subscriber/${u}`,content:h})},d.subscribers.destroy=function(e,t,n,r){return s({method:"delete",uri:`/v2/partner/${e}/session/${t}/stream/${n}/subscriber/${r}`,content:{}})},d.subscribers.update=function(e,t,n,r,i){return s({method:"update",uri:`/v2/partner/${e}/session/${t}/stream/${n}/subscriber/${r}`,content:i})},d.subscriberChannels={},d.subscriberChannels.update=function(e,t,n,r,i,o){return s({method:"update",uri:`/v2/partner/${e}/session/${t}/stream/${n}/subscriber/${r}/channel/${i}`,content:o})},d.signals={},d.signals.create=function(e,t,n,i,o){const a={};return void 0!==i&&(a.type=i),void 0!==o&&(a.data=o),s({method:"signal",uri:`/v2/partner/${e}/session/${t}${void 0!==n?"/connection/"+n:""}/signal/${r()}`,content:a})},d.forceMute={},d.forceMute.update=e=>{const t=e.apiKey,n=e.sessionId,r=e.streamId,i=e.active,o=e.excludedStreamIds,a={reason:"mute",channels:["audio"],active:i,locked:!1};return o&&(a.exclusion=o),s({method:"update",uri:`/v2/partner/${t}/session/${n}${r?"/stream/"+r:""}`,content:a})}},function(e,t,n){"use strict";const r=n(38),i=n(71),o=n(173),a=n(331),s=n(333);e.exports=function(e,t,n){var c;this.toRaptorMessage=function(){let t=this.to;return t&&"string"!=typeof t&&(t=t.id),a.signals.create(i.value,e,t,this.type,this.data)},this.toHash=function(){return n},this.error=null,this.retryAfterReconnect=!0,n&&(n.hasOwnProperty("data")&&(this.data=r(n.data),this.error=function(e){let t=null;if(null==e)t={code:400,reason:"The signal data was null or undefined. Either set it to a String value or omit it"};else try{JSON.stringify(e).length>8192&&(t={code:413,reason:"The data field was too long, the maximum size of it is 8192 characters"})}catch(e){t={code:400,reason:"The data field was not valid JSON"}}return t}(this.data)),n.hasOwnProperty("to")&&(this.to=n.to,this.error||(this.error=(c=this.to)?c instanceof o||c._tag===s?null:{code:400,reason:"The To field was invalid"}:{code:400,reason:"The signal to field was invalid. Either set it to a OT.Connection, OT.Session, or omit it entirely"})),n.hasOwnProperty("type")&&(this.error||(this.error=function(e){let t=null;return null==e?t={code:400,reason:"The signal type was null or undefined. Either set it to a String value or omit it"}:e.length>128?t={code:413,reason:"The signal type was too long, the maximum length of it is 128 characters"}:function(e){return!/^[a-zA-Z0-9\-\._~]+$/.exec(e)}(e)&&(t={code:400,reason:"The signal type was invalid, it can only contain letters, numbers, '-', '_', and '~'."}),t}(n.type)),this.type=n.type),n.hasOwnProperty("retryAfterReconnect")&&(this.error||(this.error=function(e){let t=null;return!0!==e&&!1!==e&&(t={code:400,reason:"The signal retryAfterReconnect was not true or false. Either set it to a Boolean value or omit it"}),t}(n.retryAfterReconnect)),this.retryAfterReconnect=n.retryAfterReconnect)),this.valid=null===this.error}},function(e,t,n){"use strict";e.exports={}},function(e,t,n){"use strict";var r=n(1),i=r(n(4)),o=r(n(5));const a=n(335),s=n(50),c=n(173),u=n(767),d=n(330),l=n(0)("SessionDispatcher"),f=n(22),p=n(171),h=n(150),m=n(168);function g(e,t){if(t.streams.has(e.id))return;const n=function(e,t){const n=e.channel.map(e=>new h(e)),r=e.connectionId?e.connectionId:e.connection.id;return new p(e.id,e.name,e.creationTime,t.connections.get(r),t,n,e.customProperties&&e.customProperties.initials)}(e,t);return t.streams.add(n),n}function v(e,t){if(t.archives.has(e.id))return;const n=function(e){return new a(e.id,e.name,e.status)}(e);return t.archives.add(n),n}const y=function(e){const t={};this.enqueue=function(){const n=arguments[0],r=Array.prototype.slice.call(arguments,1);t[n]||(t[n]=new u(e)),t[n].enqueue.apply(t[n],r)},this.triggerConnectionCreated=function(e){t["connectionCreated"+e.id]&&t["connectionCreated"+e.id].triggerAll()},this.triggerSessionConnected=function(e){t.sessionConnected&&t.sessionConnected.triggerAll(),e.forEach((function(e){this.triggerConnectionCreated(e)}),this)}},b={};e.exports=function(e,t){let n=(void 0===t?{}:t).connectionEventsSuppressed;const r=new d;let a=!1;const u=new y(r);r.on("reconnecting",()=>{e._.reconnecting()}),r.on("reconnected",()=>{e._.reconnected()}),r.on("close",t=>{const n=e.connection;n&&(n.destroyedReason()?l.debug("Socket was closed but the connection had already been destroyed. Reason: "+n.destroyedReason()):n.destroy(t))});const p=function(t,n){return e.connections.has(t.id)?e.connections.get(t.id):(t=c.fromHash(t),(n||e.connection&&t.id!==e.connection.id)&&(e.connections.add(t),u.triggerConnectionCreated(t)),Object.keys(b).forEach(r=>{const i=b[r];if(i&&t.id===i.connection.id){g(i,e),delete b[i.id];const r={debug:n?"connection came in session#read":"connection came in connection#created",streamId:i.id,connectionId:t.id};e.logEvent("streamCreated","warning",r)}}),t)};r.on("session#read",(t,n)=>{let i;const o={streams:[],connections:[],archives:[]};t.connection.forEach(e=>{i=p(e,!0),o.connections.push(i)}),t.stream.forEach(t=>{o.streams.push(g(t,e))}),(t.archive||t.archives).forEach(t=>{o.archives.push(v(t,e))}),r.triggerCallback(n,null,o),a=!0,u.triggerSessionConnected(e.connections)}),r.on("session#update",t=>{if("mute"!==t.reason)return void l.debug("session#update that handle this reason is not currently implemented");const n=!0===t.active;e._.forceMute({active:n}),n?e._.enableMuteOnEntry():e._.disableMuteOnEntry()}),r.on("session#muted",()=>{e._.enableMuteOnEntry(),e._.forceMute({active:!0})}),r.on("connection#created",e=>{p(e)}),r.on("connection#deleted",(t,n)=>{(t=e.connections.get(t))?t.destroy(n):l.warn("A connection was deleted that we do not know about")}),r.on("stream#created",(t,i)=>{const o=t.id,a=t.sourceStreamId,s=t.connection;let c;if(n){if(null==s||null==s.id)return void e.logEvent("SessionDispatcher:stream#created","Event",{connection:s,info:"Stream did not contain a connection object. Event ignored"});p(s)}const u=t.connectionId||s.id;if(e.connections.has(u))c=g(t,e);else{b[o]=t;const n={debug:"eventOrderError -- streamCreated event before connectionCreated",streamId:o,sourceStreamId:m(a)};e.logEvent("streamCreated","warning",n)}c?(c.publisher&&c.publisher.setStream(c),r.triggerCallback(i,null,c)):e.sessionInfo.isAdaptiveEnabled&&"P2P"===a&&f.subscribers.where({streamId:o}).forEach(e=>{e._.startRoutedToRelayedTransition()})}),r.on("stream#deleted",(t,n,r)=>{const i=e.streams.get(t),o=r.sourceStreamId,a=f.subscribers,s=e.sessionInfo.isAdaptiveEnabled&&"P2P"===o;(i||s)&&(s?a.where({streamId:t}).forEach(e=>{e._.startRelayedToRoutedTransition()}):i.destroy(n))}),r.on("stream#updated",(t,n)=>{const r=e.streams.get(t);r?r._.update(n):l.error(`A stream does not exist with the id of ${t}, for stream#updated message!`)}),r.on("stream#update",(t,n)=>{const r=e.streams.get(t),i=n.reason,o=n.active;r?"mute"===i?o&&r._.forceMute(n):l.debug("stream#update that handle this reason is not currently implemented"):l.error(`A stream does not exist with the id of ${t}, for stream#updated message!`)}),r.on("streamChannel#updated",(t,n,r)=>{let i;t&&(i=e.streams.get(t))?i._.updateChannel(n,r):l.error("Unable to determine streamId, or the stream does not exist, for streamChannel message!")});const h=(t,n,r,a)=>{let u,d;const p={streamId:n},h=f.subscribers,m=f.publishers;switch(u=a.params.subscriber?{widgetId:a.params.subscriber}:p,t){case"offer":d=[].concat(h.where(u),m.where(p)).slice(0,1);break;case"answer":case"pranswer":d=[].concat(m.where(p),h.where(u)).slice(0,1);break;case"generateoffer":case"unsubscribe":d=m.where(p);break;case"candidate":d=[].concat(h.where(u),m.where(p));break;default:return void l.debug(`jsep#${t} is not currently implemented`)}if(0===d.length)return;let g=e.connections.get(r);!g&&r.match(/^symphony\./)&&(g=c.fromHash({id:r,creationTime:Math.floor(s())}),e.connections.add(g)),d.forEach(function(){var e=(0,o.default)(i.default.mark((function e(n){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.processMessage(t,r,a);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),l.error("Error occurred during processMessage",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}())};return r.on("jsep#offer",h.bind(null,"offer")),r.on("jsep#answer",h.bind(null,"answer")),r.on("jsep#pranswer",h.bind(null,"pranswer")),r.on("jsep#generateoffer",h.bind(null,"generateoffer")),r.on("jsep#unsubscribe",h.bind(null,"unsubscribe")),r.on("jsep#candidate",h.bind(null,"candidate")),r.on("subscriberChannel#updated",(t,n,r)=>{t&&e.streams.has(t)?e.streams.get(t)._.updateChannel(n,r):l.error("Unable to determine streamId, or the stream does not exist, for subscriberChannel#updated message!")}),r.on("subscriberChannel#update",(t,n,r)=>{n&&e.streams.has(n)?f.subscribers.has(t)?f.subscribers.get(t).disableVideo(r.active):l.error("Unable to determine subscriberId, or the subscriber does not exist, for subscriberChannel#update message!"):l.error("Unable to determine streamId, or the stream does not exist, for subscriberChannel#update message!")}),r.on("signal",(t,r)=>{if(n){let n=r.connection||r.fromConnection;null!=n&&null!=n.id||(n=function(e){return{id:e,creationTime:(new Date).getTime(),data:{},capablities:{},permissions:[]}}(t),e.logEvent("SessionDispatcher:Signal","Event",{fromAddress:t,connection:r.connection,fromConnection:r.fromConnection,info:"Signal did not contain a connection object. One has been constructed",constructedConnection:n})),p(n)}const i=r.type,o=r.data,s=e.connections.get(t);e.connection&&t===e.connection.connectionId?a?e._.dispatchSignal(s,i,o):u.enqueue("sessionConnected","signal",t,i,o):e.connections.get(t)?e._.dispatchSignal(s,i,o):""===t?e._.dispatchSignal(null,i,o):u.enqueue("connectionCreated"+t,"signal",t,i,o)}),r.on("caption",(t,n)=>{e._.dispatchCaption(t,n)}),r.on("archive#created",t=>{v(t,e)}),r.on("archive#updated",(t,n)=>{const r=e.archives.get(t);r?r._.update(n):l.error(`An archive does not exist with the id of ${t}, for archive#updated message!`)}),r.on("source#create",(t,n,r)=>{const i=m(t);e.logEvent("SessionDispatcher:source#create","Event",{sourceStreamId:i,streamId:n,reason:r}),l.debug(`Received a request from RUMOR to start a transition to ${t} for the stream ID ${n} with the reason: ${r}`),f.publishers.where({streamId:n}).forEach(e=>{e._.startRoutedToRelayedTransition()})}),r.on("source#delete",(t,n,r)=>{e.logEvent("SessionDispatcher:source#delete","Event",{sourceStreamId:m(t),streamId:n,reason:r}),l.debug(`Received a request from RUMOR to start a transition from P2P to MANTIS for the stream ID ${n} with the reason: ${r}`),f.publishers.where({streamId:n}).forEach(e=>{e._.startRelayedToRoutedTransition()})}),r}},function(e,t,n){"use strict";const r=n(24)(),i=n(6);e.exports=function(e,t,n){this.id=e,this.name=t,this.status=n,this._={},i(this),this._.update=e=>{Object.keys(e).forEach(t=>{const n=this[t];this[t]=e[t];const i=new r.ArchiveUpdatedEvent(this,t,n,this[t]);this.dispatchEvent(i)})},this.destroy=()=>{}}},function(e,t,n){"use strict";const r=n(20)().getAudioOutputMediaDevices;e.exports=()=>r()},function(e,t,n){"use strict";const r=n(20)().getActiveAudioOutputDevice;e.exports=()=>r()},function(e,t,n){"use strict";(function(t){var r=n(1),i=r(n(4)),o=r(n(5));const a=n(22),s=n(107).setCurrentAudioOutputDeviceId,c=n(337),u=n(20)(),d=u.getDefaultAudioOutputDeviceId,l=u.getAudioOutputMediaDevices,f=n(297),p=new(n(21)),h=(e,t)=>{p.logEvent({action:"updateSubscribersSinkId",variation:e,payload:t})},m=e=>{const n=a.subscribers.map(t=>t._.setSinkId(e));return t.all(n)},g=function(){var e=(0,o.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:return e.prev=2,h("Attempt",{deviceId:t}),e.next=6,m(t);case 6:h("Success",{deviceId:t}),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(2),h("Failure",{deviceId:t,error:null==e.t0?void 0:e.t0.message}),e.t0;case 13:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=(0,o.default)(i.default.mark((function e(){var t,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l();case 2:return t=e.sent,n=d(t),e.prev=4,e.next=7,g(n);case 7:s(n),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(4);case 12:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=(0,o.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c();case 2:return t=e.sent,e.prev=3,e.next=6,g(t.deviceId);case 6:e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(3),e.next=12,v();case 12:case"end":return e.stop()}}),e,null,[[3,8]])})));return function(){return e.apply(this,arguments)}}();e.exports=function(){var e=(0,o.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,h("Attempt",{deviceId:t}),e.next=4,m(t);case 4:h("Success",{deviceId:t}),s(t),e.next=14;break;case 8:return e.prev=8,e.t0=e.catch(0),h("Failure",{deviceId:t,error:null==e.t0?void 0:e.t0.message}),e.next=13,y();case 13:throw e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()}).call(this,n(2))},function(e,t,n){"use strict";n(340);const r=n(38),i=n(26),o=n(6),a=n(128),s=n(35)(),c=n(21),u=n(249),d=n(567),l=n(568),f=s.onlyLocal(),p={};p.noConflict=n(569)(),(void 0!==typeof window?window:global).OT=p,e.exports=p,(()=>{let e=p;Object.defineProperty(void 0!==typeof window?window:global,"TB",{get:()=>(e===p&&console.warn("window.TB is deprecated, and will be removed in the future. Please access via window.OT"),e),set:t=>{e=t},configurable:!0})})();const h=n(143)(void 0!==typeof window?window:global),m=n(8),g=n(71),v=n(144),y=n(252),b=n(145),S=n(146),E=n(253),_=n(147),T=n(7),R=n(10),I=n(254),w=n(241),C=n(0)("OT"),O=n(121),A=n(596),x=n(23),k=n(103).parseIceServers,N=n(267),L=n(22),M=n(150),V=n(152),P=n(153),D=n(72)({global:h}),Z=n(13)({}),j=n(158)(),W=n(281)({otError:Z}),G=n(282)(),F=n(288)({global:h}),U=n(20)({getNativeEnumerateDevices:F}),X=n(24)(),B=n(160)(),H=n(651)({otError:Z,global:h}),Y=n(161)({chromeExtensionHelper:W,otError:Z}),J=n(656)({deviceHelpers:U,generateConstraintInfo:I,getUserMediaHelper:H,global:h,OTHelpers:m,screenSharing:Y}),z=n(659)({otError:Z,processPubOptions:J}),K=n(162)({otError:Z}),Q=n(74),q=n(294)(),$=n(295)({otError:Z}),ee=n(296)({global:h,videoElementErrorMap:$}),te=n(163)({global:h}),ne=n(298)({PeerConnection:D,setCertificates:te}),re=n(305)({PeerConnection:D,setCertificates:te}),ie=n(307)(),oe=n(682)({otError:Z}),ae=n(109)({NativeVideoElementWrapper:ee}),se=n(151)(),ce=n(165)({VideoElementFacade:ae}),ue=n(310)({interpretPeerConnectionError:K,otError:Z,SubscriberPeerConnection:re,WidgetView:ce}),de=n(169)({APIKEY:g,createChromeMixin:G,deviceHelpers:U,EnvironmentLoader:_,Errors:T,Events:X,ExceptionCodes:R,calculateCapableSimulcastStreams:y,global:h,interpretPeerConnectionError:K,IntervalRunner:Q,Microphone:q,otError:Z,OTErrorClass:x,OTHelpers:m,parseIceServers:k,processPubOptions:J,PUBLISH_MAX_DELAY:N,PublisherPeerConnection:ne,PublishingState:ie,StreamChannel:M,systemRequirements:P,VideoOrientation:se,WidgetView:ce}),le=n(323)({otError:Z,Publisher:de}),fe=n(324)({global:h,initPublisher:le,otError:Z,Publisher:de,Subscriber:ue}),pe=n(777)({Session:fe});o(p);const he=n(778),me=n(781),ge=n(782);u(p,"$",{name:"OT.$",getMessage:"Please use an external library like jQuery to select elements from the page.",value:m}),p.APIKEY=g.value,p.AnalyserAudioLevelSampler=S,p.Archive=n(335),p.ArchiveEvent=X.ArchiveEvent,p.ArchiveUpdatedEvent=X.ArchiveUpdatedEvent,p.AudioLevelTransformer=v,p.AudioLevelUpdatedEvent=X.AudioLevelUpdatedEvent,p.Capabilities=n(170),p.Chrome=b,p.Connection=n(173),p.ConnectionCapabilities=p.Connection.Capabilities,p.ConnectionEvent=X.ConnectionEvent,Object.keys(O).forEach(e=>{p[e.toUpperCase()]=O[e].priority}),p.NONE=0,p.debug=C.debug,p.error=C.error,p.info=C.info,p.log=C.log,p.warn=C.warn,p.DestroyedEvent=X.DestroyedEvent,p.EnvLoadedEvent=X.EnvLoadedEvent,p.Error=x,p.Error.on(i.EXCEPTION,e=>{if(e.target===p.Error){const t=r(e);t.target=p,p.dispatchEvent(t)}else p.dispatchEvent(e)}),p.Event=a,p.ExceptionCodes=R,p.ExceptionEvent=X.ExceptionEvent,p.getDevices=n(783),p.getAudioOutputDevices=n(336),p.getActiveAudioOutputDevice=n(337),p.setAudioOutputDevice=n(784)(),p.GetAudioLevelSampler=E,p.HAS_REQUIREMENTS=1,p.IntervalRunner=Q,p.IssueReportedEvent=X.IssueReportedEvent,p.MediaStoppedEvent=X.MediaStoppedEvent,p.Microphone=q,p.NOT_HAS_REQUIREMENTS=0,p.PeerConnection=D,p.PeerConnection.QOS=n(279).default,p.Publisher=de,p.PublisherPeerConnection=ne,p.PublishingState=ie,p.MuteForcedEvent=X.MuteForcedEvent,p.Session=fe,p.SessionConnectEvent=X.SessionConnectEvent,p.SessionDisconnectEvent=X.SessionDisconnectEvent,p.SessionDispatcher=n(334),p.Signal=n(332),p.SignalEvent=X.SignalEvent,p.Stream=n(171),p.StreamChannel=M,p.StreamEvent=X.StreamEvent,p.StreamPropertyChangedEvent=X.StreamPropertyChangedEvent,p.StreamUpdatedEvent=X.StreamUpdatedEvent,p.StylableComponent=V,p.Subscriber=ue,p.SubscriberPeerConnection=re,p.SubscribingState=n(313),p.VideoDimensionsChangedEvent=X.VideoDimensionsChangedEvent,p.VideoDisableWarningEvent=X.VideoDisableWarningEvent,p.VideoElement=ae,p.VideoEnabledChangedEvent=X.VideoEnabledChangedEvent,p.VideoOrientation=se,p.WidgetView=ce,p.getSupportedCodecs=he,p.hasMediaProcessorSupport=me,p.hasEndToEndEncryptionSupport=ge,p._={AnalyticsHelper:c,getClientGuid:w.get,StaticConfig:s},Object.defineProperty(p,"version",{value:f.version});const ve={};u(ve,"version",{value:f.version,name:"OT.properties.version",getWarning:"Please use OT.version instead",warnOnSet:!0,setWarning:"Mutating version has no effect"}),d.forEach(e=>{let t,n;if(Array.isArray(e)){const r=e[0],i=e[1];n=r,t=f[i]||i}else t=f[e],n=e;const r=(i=n,l.includes(i));var i;u(ve,n,{value:t,name:"OT.properties."+n,warnOnSet:!0,canSet:r,setWarning:r?`Mutating ${n} can cause side effects`:`Mutating ${n} has no effect`})}),p.properties=ve,p.audioContext=j,p.checkScreenSharingCapability=Y.checkCapability,p.checkSystemRequirements=P.check,p.components={},p.generateSimpleStateMachine=B,p.getErrorTitleByCode=x.getTitleByCode,p.getLogs=C.getLogs,p.getStatsAdpater=n(275),p.getStatsHelpers=n(76),p.getUserMedia=z,p.handleJsException=x.handleJsException,p.initPublisher=le,p.setProxyUrl=n(102).setProxyUrl,p.initSession=function(e,t,n){return null==t&&(t=e,e=null),0===g.value.length&&e&&(g.value=e,p.APIKEY=e),pe(e,t,n)};const ye=(e,t)=>()=>(console.warn(e+" is deprecated and will be removed in a future version of OpenTok"),t);Object.defineProperties(p,{isUnloaded:{get:ye("OT.isUnloaded",_.isUnloaded)},onLoad:{get:ye("OT.onLoad",_.onLoad)},onUnload:{get:ye("OT.onUnload",_.onUnload)},overrideGuidStorage:{get:ye("OT.overrideGuidStorage",w.override)}}),p.pickScreenSharingHelper=Y.pickHelper,p.publishers=L.publishers,p.registerScreenSharingExtension=Y.registerExtension,p.registerScreenSharingExtensionHelper=Y.registerExtensionHelper,p.reportIssue=oe,p.sessions=L.sessions,p.setLogLevel=A,p.shouldLog=C.shouldLog,p.subscribers=L.subscribers,p.unblockAudio=n(167),p.upgradeSystemRequirements=P.upgrade,_.onUnload(()=>{L.publishers.destroy(),L.subscribers.destroy(),L.sessions.destroy("unloaded")}),n(785)()},function(e,t,n){var r=n(341);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(355)(r,i),r.locals&&(e.exports=r.locals)},function(e,t,n){t=e.exports=n(342)(!1);var r=n(343),i=r(n(344)),o=r(n(345)),a=r(n(346)),s=r(n(347)),c=r(n(348)),u=r(n(349)),d=r(n(350)),l=r(n(351)),f=r(n(352)),p=r(n(353)),h=r(n(354));t.push([e.i,"/*!\n * Copyright (c) 2017 TokBox, Inc.\n * Released under the MIT license\n * http://opensource.org/licenses/MIT\n */\n\n/**\n * OT Base styles\n */\n\n/* Root OT object, this is where our CSS reset happens */\n.OT_root,\n.OT_root * {\n  color: #ffffff;\n  margin: 0;\n  padding: 0;\n  border: 0;\n  font-size: 100%;\n  font-family: Arial, Helvetica, sans-serif;\n  vertical-align: baseline;\n}\n\n/**\n * Specific Element Reset\n */\n\n.OT_root h1,\n.OT_root h2,\n.OT_root h3,\n.OT_root h4,\n.OT_root h5,\n.OT_root h6 {\n  color: #ffffff;\n  font-family: Arial, Helvetica, sans-serif;\n  font-size: 100%;\n  font-weight: bold;\n}\n\n.OT_root header {\n\n}\n\n.OT_root footer {\n\n}\n\n.OT_root div {\n\n}\n\n.OT_root section {\n\n}\n\n.OT_root video {\n\n}\n\n.OT_root button {\n\n}\n\n.OT_root strong {\n  font-weight: bold;\n}\n\n.OT_root em {\n  font-style: italic;\n}\n\n.OT_root a,\n.OT_root a:link,\n.OT_root a:visited,\n.OT_root a:hover,\n.OT_root a:active {\n  font-family: Arial, Helvetica, sans-serif;\n}\n\n.OT_root ul, .OT_root ol {\n  margin: 1em 1em 1em 2em;\n}\n\n.OT_root ol {\n  list-style: decimal outside;\n}\n\n.OT_root ul {\n  list-style: disc outside;\n}\n\n.OT_root dl {\n  margin: 4px;\n}\n\n.OT_root dl dt,\n.OT_root dl dd {\n  float: left;\n  margin: 0;\n  padding: 0;\n}\n\n.OT_root dl dt {\n  clear: left;\n  text-align: right;\n  width: 50px;\n}\n\n.OT_root dl dd {\n  margin-left: 10px;\n}\n\n.OT_root img {\n  border: 0 none;\n}\n\n/* Modal dialog styles */\n\n/* Modal dialog styles */\n\n.OT_dialog-centering {\n  display: table;\n  width: 100%;\n  height: 100%;\n}\n\n.OT_dialog-centering-child {\n  display: table-cell;\n  vertical-align: middle;\n}\n\n.OT_dialog {\n  position: relative;\n\n  box-sizing: border-box;\n  max-width: 576px;\n  margin-right: auto;\n  margin-left: auto;\n  padding: 36px;\n  text-align: center; /* centers all the inline content */\n\n  background-color: #363636;\n  color: #fff;\n  box-shadow: 2px 4px 6px #999;\n  font-family: 'Didact Gothic', sans-serif;\n  font-size: 13px;\n  line-height: 1.4;\n}\n\n.OT_dialog * {\n  font-family: inherit;\n  box-sizing: inherit;\n}\n\n.OT_closeButton {\n  color: #999999;\n  cursor: pointer;\n  font-size: 32px;\n  line-height: 36px;\n  position: absolute;\n  right: 18px;\n  top: 0;\n}\n\n.OT_dialog-messages {\n  text-align: center;\n}\n\n.OT_dialog-messages-main {\n  margin-bottom: 36px;\n  line-height: 36px;\n\n  font-weight: 300;\n  font-size: 24px;\n}\n\n.OT_dialog-messages-minor {\n  margin-bottom: 18px;\n\n  font-size: 13px;\n  line-height: 18px;\n  color: #A4A4A4;\n}\n\n.OT_dialog-messages-minor strong {\n  color: #ffffff;\n}\n\n.OT_dialog-actions-card {\n  display: inline-block;\n}\n\n.OT_dialog-button-title {\n  margin-bottom: 18px;\n  line-height: 18px;\n\n  font-weight: 300;\n  text-align: center;\n  font-size: 14px;\n  color: #999999;\n}\n.OT_dialog-button-title label {\n  color: #999999;\n}\n\n.OT_dialog-button-title a,\n.OT_dialog-button-title a:link,\n.OT_dialog-button-title a:active {\n  color: #02A1DE;\n}\n\n.OT_dialog-button-title strong {\n  color: #ffffff;\n  font-weight: 100;\n  display: block;\n}\n\n.OT_dialog-button {\n  display: inline-block;\n\n  margin-bottom: 18px;\n  padding: 0 1em;\n\n  background-color: #1CA3DC;\n  text-align: center;\n  cursor: pointer;\n}\n\n.OT_dialog-button:disabled {\n  cursor: not-allowed;\n  opacity: 0.5;\n}\n\n.OT_dialog-button-large {\n  line-height: 36px;\n  padding-top: 9px;\n  padding-bottom: 9px;\n\n  font-weight: 100;\n  font-size: 24px;\n}\n\n.OT_dialog-button-small {\n  line-height: 18px;\n  padding-top: 9px;\n  padding-bottom: 9px;\n\n  background-color: #444444;\n  color: #999999;\n  font-size: 16px;\n}\n\n.OT_dialog-progress-bar {\n  display: inline-block; /* prevents margin collapse */\n  width: 100%;\n  margin-top: 5px;\n  margin-bottom: 41px;\n\n  border: 1px solid #4E4E4E;\n  height: 8px;\n}\n\n.OT_dialog-progress-bar-fill {\n  height: 100%;\n\n  background-color: #29A4DA;\n}\n\n/* Helpers */\n\n.OT_centered {\n  position: fixed;\n  left: 50%;\n  top: 50%;\n  margin: 0;\n}\n\n.OT_dialog-hidden {\n  display: none;\n}\n\n.OT_dialog-button-block {\n  display: block;\n}\n\n.OT_dialog-no-natural-margin {\n  margin-bottom: 0;\n}\n\n/* Publisher and Subscriber styles */\n\n.OT_publisher, .OT_subscriber {\n  position: relative;\n  min-width: 48px;\n  min-height: 48px;\n}\n\n.OT_publisher .OT_video-element,\n.OT_subscriber .OT_video-element {\n  display: block;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n\n  transform-origin: 0 0;\n}\n\n/* Styles that are applied when the video element should be mirrored */\n.OT_publisher.OT_mirrored .OT_video-element {\n  transform: scale(-1, 1);\n  transform-origin: 50% 50%;\n}\n\n.OT_subscriber_error {\n  background-color: #000;\n  color: #fff;\n  text-align: center;\n}\n\n.OT_subscriber_error > p {\n  padding: 20px;\n}\n\n/* The publisher/subscriber name/mute background */\n.OT_publisher .OT_bar,\n.OT_subscriber .OT_bar,\n.OT_publisher .OT_name,\n.OT_subscriber .OT_name,\n.OT_publisher .OT_archiving,\n.OT_subscriber .OT_archiving,\n.OT_publisher .OT_archiving-status,\n.OT_subscriber .OT_archiving-status,\n.OT_publisher .OT_archiving-light-box,\n.OT_subscriber .OT_archiving-light-box {\n  -ms-box-sizing: border-box;\n  box-sizing: border-box;\n  top: 0;\n  left: 0;\n  right: 0;\n  display: block;\n  height: 34px;\n  position: absolute;\n}\n\n.OT_publisher .OT_bar,\n.OT_subscriber .OT_bar {\n  background: rgba(0, 0, 0, 0.4);\n}\n\n.OT_publisher .OT_edge-bar-item,\n.OT_subscriber .OT_edge-bar-item {\n  z-index: 1; /* required to get audio level meter underneath */\n}\n\n/* The publisher/subscriber name panel/archiving status bar */\n.OT_publisher .OT_name,\n.OT_subscriber .OT_name {\n  background-color: transparent;\n  color: #ffffff;\n  font-size: 15px;\n  line-height: 34px;\n  font-weight: normal;\n  padding: 0 4px 0 36px;\n  letter-spacing: normal;\n}\n\n.OT_publisher .OT_archiving-status,\n.OT_subscriber .OT_archiving-status {\n  background: rgba(0, 0, 0, 0.4);\n  top: auto;\n  bottom: 0;\n  left: 34px;\n  padding: 0 4px;\n  color: rgba(255, 255, 255, 0.8);\n  font-size: 15px;\n  line-height: 34px;\n  font-weight: normal;\n  letter-spacing: normal;\n}\n\n.OT_micro .OT_archiving-status,\n.OT_micro:hover .OT_archiving-status,\n.OT_mini .OT_archiving-status,\n.OT_mini:hover .OT_archiving-status {\n  display: none;\n}\n\n.OT_publisher .OT_archiving-light-box,\n.OT_subscriber .OT_archiving-light-box {\n  background: rgba(0, 0, 0, 0.4);\n  top: auto;\n  bottom: 0;\n  right: auto;\n  width: 34px;\n  height: 34px;\n}\n\n.OT_archiving-light {\n  width: 7px;\n  height: 7px;\n  border-radius: 30px;\n  position: absolute;\n  top: 14px;\n  left: 14px;\n  background-color: #575757;\n  box-shadow: 0 0 5px 1px #575757;\n}\n\n.OT_archiving-light.OT_active {\n  background-color: #970d13;\n  -webkit-animation: OT_pulse 1.3s ease-in;\n  -moz-animation: OT_pulse 1.3s ease-in;\n  -webkit-animation: OT_pulse 1.3s ease-in;\n  -webkit-animation-iteration-count: infinite;\n  -moz-animation-iteration-count: infinite;\n  -webkit-animation-iteration-count: infinite;\n}\n\n.OT_mini .OT_bar,\n.OT_bar.OT_mode-mini,\n.OT_bar.OT_mode-mini-auto {\n  bottom: 0;\n  height: auto;\n}\n\n.OT_mini .OT_name.OT_mode-off,\n.OT_mini .OT_name.OT_mode-on,\n.OT_mini .OT_name.OT_mode-auto,\n.OT_mini:hover .OT_name.OT_mode-auto {\n  display: none;\n}\n\n.OT_publisher .OT_name,\n.OT_subscriber .OT_name {\n    left: 10px;\n    right: 37px;\n    height: 34px;\n    padding-left: 0;\n}\n\n.OT_publisher .OT_mute,\n.OT_subscriber .OT_mute {\n    border: none;\n    cursor: pointer;\n    display: block;\n    position: absolute;\n    text-align: center;\n    text-indent: -9999em;\n    background-color: transparent;\n    background-repeat: no-repeat;\n}\n\n.OT_publisher .OT_mute,\n.OT_subscriber .OT_mute {\n  right: 0;\n  top: 0;\n  border-left: 1px solid rgba(255, 255, 255, 0.2);\n  height: 36px;\n  width: 37px;\n}\n\n.OT_mini .OT_mute,\n.OT_publisher.OT_mini .OT_mute.OT_mode-auto.OT_mode-on-hold,\n.OT_subscriber.OT_mini .OT_mute.OT_mode-auto.OT_mode-on-hold {\n  top: 50%;\n  left: 50%;\n  right: auto;\n  margin-top: -18px;\n  margin-left: -18.5px;\n  border-left: none;\n}\n\n.OT_publisher .OT_mute {\n  background-image: url("+i+");\n  background-position: 9px 5px;\n}\n\n.OT_publisher .OT_mute.OT_active {\n  background-image: url("+o+");\n  background-position: 9px 4px;\n}\n\n.OT_subscriber .OT_mute {\n  background-image: url("+a+");\n  background-position: 8px 7px;\n}\n\n.OT_subscriber .OT_mute.OT_active {\n  background-image: url("+s+");\n  background-position: 7px 7px;\n}\n\n/**\n * Styles for display modes\n *\n * Note: It's important that these completely control the display and opacity\n * attributes, no other selectors should atempt to change them.\n */\n\n/* Default display mode transitions for various chrome elements */\n.OT_publisher .OT_edge-bar-item,\n.OT_subscriber .OT_edge-bar-item {\n  transition-property: top, bottom, opacity;\n  transition-duration: 0.5s;\n  transition-timing-function: ease-in;\n}\n\n.OT_publisher .OT_edge-bar-item.OT_mode-off,\n.OT_subscriber .OT_edge-bar-item.OT_mode-off,\n.OT_publisher .OT_edge-bar-item.OT_mode-auto,\n.OT_subscriber .OT_edge-bar-item.OT_mode-auto,\n.OT_publisher .OT_edge-bar-item.OT_mode-mini-auto,\n.OT_subscriber .OT_edge-bar-item.OT_mode-mini-auto {\n  top: -25px;\n  opacity: 0;\n}\n\n.OT_publisher .OT_edge-bar-item.OT_mode-off,\n.OT_subscriber .OT_edge-bar-item.OT_mode-off {\n  display: none;\n}\n\n.OT_mini .OT_mute.OT_mode-auto,\n.OT_publisher .OT_mute.OT_mode-mini-auto,\n.OT_subscriber .OT_mute.OT_mode-mini-auto {\n  top: 50%;\n}\n\n.OT_publisher .OT_edge-bar-item.OT_edge-bottom.OT_mode-off,\n.OT_subscriber .OT_edge-bar-item.OT_edge-bottom.OT_mode-off,\n.OT_publisher .OT_edge-bar-item.OT_edge-bottom.OT_mode-auto,\n.OT_subscriber .OT_edge-bar-item.OT_edge-bottom.OT_mode-auto,\n.OT_publisher .OT_edge-bar-item.OT_edge-bottom.OT_mode-mini-auto,\n.OT_subscriber .OT_edge-bar-item.OT_edge-bottom.OT_mode-mini-auto {\n  top: auto;\n  bottom: -25px;\n}\n\n.OT_publisher .OT_edge-bar-item.OT_mode-on,\n.OT_subscriber .OT_edge-bar-item.OT_mode-on,\n.OT_publisher .OT_edge-bar-item.OT_mode-auto.OT_mode-on-hold,\n.OT_subscriber .OT_edge-bar-item.OT_mode-auto.OT_mode-on-hold,\n.OT_publisher:hover .OT_edge-bar-item.OT_mode-auto,\n.OT_subscriber:hover .OT_edge-bar-item.OT_mode-auto,\n.OT_publisher:hover .OT_edge-bar-item.OT_mode-mini-auto,\n.OT_subscriber:hover .OT_edge-bar-item.OT_mode-mini-auto {\n  top: 0;\n  opacity: 1;\n}\n\n.OT_mini .OT_mute.OT_mode-on,\n.OT_mini:hover .OT_mute.OT_mode-auto,\n.OT_mute.OT_mode-mini,\n.OT_root:hover .OT_mute.OT_mode-mini-auto {\n  top: 50%;\n}\n\n.OT_publisher .OT_edge-bar-item.OT_edge-bottom.OT_mode-on,\n.OT_subscriber .OT_edge-bar-item.OT_edge-bottom.OT_mode-on,\n.OT_publisher:hover .OT_edge-bar-item.OT_edge-bottom.OT_mode-auto,\n.OT_subscriber:hover .OT_edge-bar-item.OT_edge-bottom.OT_mode-auto {\n  top: auto;\n  bottom: 0;\n  opacity: 1;\n}\n\n\n/* Contains the video element, used to fix video letter-boxing */\n.OT_widget-container {\n  position: absolute;\n  background: linear-gradient(60.08deg, #333333 0%, #1A1A1A 100%);\n  overflow: hidden;\n}\n\n.OT_hidden-audio {\n  position: absolute !important;\n  height: 1px !important;\n  width: 1px !important;\n}\n\n/* Load animation */\n.OT_root .OT_video-loading {\n  position: absolute;\n  z-index: 1;\n  width: 100%;\n  height: 100%;\n  display: none;\n\n  background-color: rgba(0, 0, 0, .75);\n}\n\n.OT_root .OT_video-loading .OT_video-loading-spinner {\n  background: url("+c+") no-repeat;\n  position: absolute;\n  width: 32px;\n  height: 32px;\n  left: 50%;\n  top: 50%;\n  margin-left: -16px;\n  margin-top: -16px;\n  animation: OT_spin 2s linear infinite;\n}\n@keyframes OT_spin {\n  100% {\n    transform: rotate(360deg);\n  }\n}\n\n.OT_publisher.OT_loading .OT_video-loading,\n.OT_subscriber.OT_loading .OT_video-loading {\n  display: block;\n}\n\n.OT_publisher.OT_loading .OT_video-element,\n.OT_subscriber.OT_loading .OT_video-element {\n  /*display: none;*/\n}\n\n.OT_video-centering {\n  display: table;\n  width: 100%;\n  height: 100%;\n}\n\n.OT_video-container {\n  display: table-cell;\n  vertical-align: middle;\n}\n\n.OT_video-poster {\n  position: absolute;\n  z-index: 1;\n  width: 100%;\n  height: 100%;\n  display: none;\n\n  opacity: 1.0;\n\n  background-repeat: no-repeat;\n  background-image: url("+u+");\n  background-size: auto 55%;\n}\n\n.OT_fit-mode-cover .OT_video-element {\n  object-fit: cover;\n}\n\n/* Workaround for iOS freezing issue when cropping videos */\n/* https://bugs.webkit.org/show_bug.cgi?id=176439 */\n@media only screen\n  and (orientation: portrait) {\n  .OT_subscriber.OT_ForceContain.OT_fit-mode-cover .OT_video-element {\n    object-fit: contain !important;\n  }\n}\n\n.OT_fit-mode-contain .OT_video-element {\n  object-fit: contain;\n}\n\n.OT_fit-mode-cover .OT_video-poster {\n  background-position: center;\n}\n\n.OT_fit-mode-contain .OT_video-poster {\n  background-position: center;\n}\n\n.OT_audio-level-meter {\n  position: absolute;\n  width: 25%;\n  max-width: 224px;\n  min-width: 21px;\n  top: 0;\n  right: 0;\n  overflow: hidden;\n}\n\n.OT_audio-level-meter:before {\n  /* makes the height of the container equals its width */\n  content: '';\n  display: block;\n  padding-top: 100%;\n}\n\n.OT_audio-level-meter__audio-only-img {\n  position: absolute;\n  top: 22%;\n  right: 15%;\n  width: 40%;\n\n  opacity: .7;\n\n  background: url("+d+") no-repeat center;\n}\n\n.OT_audio-level-meter__audio-only-img:before {\n  /* makes the height of the container equals its width */\n  content: '';\n  display: block;\n  padding-top: 100%;\n}\n\n.OT_audio-level-meter__value {\n  will-change: transform;\n  position: absolute;\n  top: -100%;\n  right: -100%;\n  width: 200%;\n  height: 200%;\n  transform: scale(0);\n  border-radius: 50%;\n  background-image: radial-gradient(circle, rgba(151, 206, 0, 1) 0%, rgba(151, 206, 0, 0) 100%);\n}\n\n.OT_audio-level-meter.OT_mode-off {\n    display: none;\n}\n\n.OT_audio-level-meter.OT_mode-on,\n.OT_audio-only .OT_audio-level-meter.OT_mode-auto {\n  display: block;\n}\n\n.OT_audio-only.OT_publisher .OT_video-element,\n.OT_audio-only.OT_subscriber .OT_video-element {\n  display: none;\n}\n\n\n.OT_video-disabled-indicator {\n  opacity: 1;\n  border: none;\n  display: none;\n  position: absolute;\n  background-color: transparent;\n  background-repeat: no-repeat;\n  background-position: bottom right;\n  pointer-events: none;\n  top: 0;\n  left: 0;\n  bottom: 3px;\n  right: 3px;\n}\n\n.OT_video-disabled {\n  background-image: url("+l+");\n  background-size: 33px auto;\n}\n\n.OT_video-disabled-warning {\n  background-image: url("+f+");\n  background-size: 33px auto;\n}\n\n.OT_video-disabled-indicator.OT_active {\n  display: block;\n}\n\n.OT_audio-blocked-indicator {\n  opacity: 1;\n  border: none;\n  display: none;\n  position: absolute;\n  background-color: transparent;\n  background-repeat: no-repeat;\n  background-position: center;\n  pointer-events: none;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n}\n\n.OT_audio-blocked {\n  background-image: url("+p+");\n  background-size: 90px auto;\n}\n\n.OT_container-audio-blocked {\n  cursor: pointer;\n}\n\n.OT_container-audio-blocked.OT_mini .OT_edge-bar-item {\n  display: none;\n}\n\n.OT_container-audio-blocked .OT_mute {\n  display: none;\n}\n\n.OT_audio-blocked-indicator.OT_active {\n  display: block;\n}\n\n.OT_video-unsupported {\n  opacity: 1;\n  border: none;\n  display: none;\n  position: absolute;\n  background-color: transparent;\n  background-repeat: no-repeat;\n  background-position: center;\n  background-image: url("+h+");\n  background-size: 58px auto;\n  pointer-events: none;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  margin-top: -30px;\n}\n\n.OT_video-unsupported-bar {\n  display: none;\n  position: absolute;\n  width: 192%; /* copy the size of the audio meter bar for symmetry */\n  height: 192%;\n  top: -96% /* half of the size */;\n  left: -96%;\n  border-radius: 50%;\n\n  background-color: rgba(0, 0, 0, .8);\n}\n\n.OT_video-unsupported-img {\n  display: none;\n  position: absolute;\n  top: 11%;\n  left: 15%;\n  width: 70%;\n  opacity: .7;\n  background-image: url("+h+");\n  background-repeat: no-repeat;\n  background-position: center;\n  background-size: 100% auto;\n}\n\n.OT_video-unsupported-img:before {\n  /* makes the height of the container 93% of its width (90/97 px) */\n  content: '';\n  display: block;\n  padding-top: 93%;\n}\n\n.OT_video-unsupported-text {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  text-align: center;\n  height: 100%;\n  margin-top: 40px;\n}\n\n.OT_video-unsupported.OT_active {\n  display: block;\n}\n\n.OT_mini .OT_video-unsupported,\n.OT_micro .OT_video-unsupported {\n  position: absolute;\n  width: 25%;\n  max-width: 224px;\n  min-width: 21px;\n  top: 0;\n  left: 0;\n  overflow: hidden;\n  background: none;\n  bottom: auto;\n  right: auto;\n  margin: auto;\n}\n\n.OT_mini .OT_video-unsupported:before,\n.OT_micro .OT_video-unsupported:before {\n  /* makes the height of the container equals its width */\n  content: '';\n  display: block;\n  padding-top: 100%;\n}\n\n.OT_mini .OT_video-unsupported-bar,\n.OT_micro .OT_video-unsupported-bar,\n.OT_mini .OT_video-unsupported-img,\n.OT_micro .OT_video-unsupported-img {\n  display: block;\n}\n\n.OT_mini .OT_video-unsupported-text,\n.OT_micro .OT_video-unsupported-text {\n  display: none;\n}\n\n.OT_hide-forced {\n  display: none;\n}\n\n.OT_ModalDialog {\n  position: fixed;\n  top: 0px;\n  left: 0px;\n  right: 0px;\n  bottom: 0px;\n  z-index: 1000;\n  background-color: rgba(0, 0, 0, 0.2);\n}\n\n#tb_alert {\n  position: fixed;\n  width: 570px;\n  font-family: \"Lucida Grande\", Arial;\n  top: 50%;\n  left: 50%;\n  margin-top: -75px;\n  margin-left: -285px;\n}\n\n#tb_alert * {\n  box-sizing: border-box;\n}\n\n#tb_alert .OT_alert {\n  border-top-right-radius: 5px;\n  border-bottom-right-radius: 5px;\n  background-color: #333;\n  position: relative;\n  padding: 30px;\n  overflow: visible;\n  margin-left: 70px;\n  border-bottom-color: rgba(255, 255, 255, 0.1);\n  border-left-color: rgba(255, 255, 255, 0.1);\n\n  background-image: linear-gradient(45deg, rgba(0, 0, 0, 0.2) 25%, transparent 25%, transparent 75%, rgba(0, 0, 0, 0.2) 75%, rgba(0, 0, 0, 0.2)), linear-gradient(45deg, rgba(0, 0, 0, 0.2) 25%, transparent 25%, transparent 75%, rgba(0, 0, 0, 0.2) 75%, rgba(0, 0, 0, 0.2));\n\n  background-image: -ms-linear-gradient(45deg, rgba(0, 0, 0, 0.2) 25%, transparent 25%, transparent 75%, rgba(0, 0, 0, 0.2) 75%, rgba(0, 0, 0, 0.2)), -ms-linear-gradient(45deg, rgba(0, 0, 0, 0.2) 25%, transparent 25%, transparent 75%, rgba(0, 0, 0, 0.2) 75%, rgba(0, 0, 0, 0.2));\n\n  background-size: 4px 4px;\n  background-position: 0 0, 2px 2px;\n  box-shadow: 0 2px 2px rgba(0, 0, 0, 0.15);\n  border: 1px solid rgba(255, 255, 255, 0.3);\n}\n\n#tb_alert .OT_alert-exclamation {\n  background-color: #9c1408;\n  background-image: linear-gradient(0deg, #dd0c0a 0%, #9c1408 100%);\n  box-shadow: 0 2px 2px rgba(0, 0, 0, 0.15);\n  border: 1px solid rgba(255, 255, 255, 0.3);\n\n  margin: -1px 0;\n\n  font-family: MS Trebuchet;\n  font-weight: bold;\n  font-size: 60px;\n  text-shadow: -1px -1px 2px rgba(0, 0, 0, 0.5);\n\n  color: white;\n  width: 65px;\n  position: absolute;\n  padding: 42px 0;\n  text-align: center;\n  left: -70px;\n  top: 0;\n  bottom: 0;\n  border-top-left-radius: 5px;\n  border-bottom-left-radius: 5px;\n\n  border-bottom-color: transparent;\n  border-left: none;\n  border-right: none;\n}\n\n#tb_alert .OT_alert-exclamation:after,\n#tb_alert .OT_alert-exclamation:before {\n  content: \" \";\n  position: absolute;\n  right: -24px;\n  top: 40%;\n  border: 12px solid transparent;\n  border-left-color: #9c1408;\n}\n\n#tb_alert .OT_alert-exclamation:before {\n  border-left-color: #bc3428;\n  top: 39%;\n}\n\n#tb_alert .OT_alert-body {\n  color: #c8c5c5;\n  margin: 0;\n  text-shadow: 0 2px 0 rgba(0, 0, 0, 0.3);\n  font-size: 14px;\n  line-height: 1.3em;\n}\n\n#tb_alert .continue-text {\n  margin-top: 12px\n}\n\n#tb_alert > * a {\n  color: #a7d8df;\n  text-decoration: none;\n}\n\n#tb_alert .OT_alert-header {\n  font-size: 24px;\n  padding-bottom: 5px;\n  color: #aaa;\n  font-weight: bold;\n  position: relative;\n  text-shadow: 0 2px 0 rgba(0, 0, 0, 0.3);\n  margin: 0;\n}\n\n#tb_alert .OT_alert-header::before {\n  content: attr(data-text);\n  position: absolute;\n  left: 0;\n  color: white;\n  -webkit-mask-image: -webkit-gradient(\n    linear,\n    left top, left bottom,\n    from(rgba(0, 0, 0, 1)),\n    color-stop(60%, rgba(0, 0, 0, 0)),\n    to(rgba(0, 0, 0, 0))\n  );\n}\n\n#tb_alert .OT_alert-close-button {\n  position: absolute;\n  right: 8px;\n  top: 5px;\n  background-color: #000;\n  color: #666;\n  border: none;\n  font-size: 20px;\n  /** Hack to bring it up to the proper line top */\n  line-height: 14px;\n  padding: 0;\n  padding-bottom: 3px;\n  cursor: pointer;\n}\n\n#tb_alert #section-mobile-browser,\n#tb_alert #section-supported-mobile-browser {\n  width: 200px;\n  top: 0px;\n  left: 25%;\n  margin-top: 0;\n  margin-left: 0;\n}\n\n@media all and (max-height: 300px) {\n  #tb_alert {\n    width: 100%;\n    height: 100%;\n    left: 0;\n    top: 0;\n    margin-left: 0;\n    margin-top: 0;\n  }\n  #tb_alert #section-mobile-browser,\n  #tb_alert #section-supported-mobile-browser {\n    margin-left: 0;\n    margin-top: 10px;\n    left: 0;\n  }\n}\n\n#tb_alert #section-normal-install,\n#tb_alert #section-upgrade-install,\n#tb_alert #section-mobile-browser,\n#tb_alert #section-supported-mobile-browser {\n  display: none;\n}\n",""])},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n,r=e[1]||"",i=e[3];if(!i)return r;if(t&&"function"==typeof btoa){var o=(n=i,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */"),a=i.sources.map((function(e){return"/*# sourceURL="+i.sourceRoot+e+" */"}));return[r].concat(a).concat([o]).join("\n")}return[r].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n})).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},i=0;i<this.length;i++){var o=this[i][0];null!=o&&(r[o]=!0)}for(i=0;i<e.length;i++){var a=e[i];null!=a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},function(e,t,n){"use strict";e.exports=function(e,t){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)||t?'"'+e.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"':e)}},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAAcCAMAAAC02HQrAAAA1VBMVEUAAAD3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pn3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pn3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj3+Pj39/j3+Pj3+Pn4+Pk/JRMlAAAAQ3RSTlMABAUHCQoLDhAQERwdHiAjLjAxOD9ASFBRVl1mbnZ6fH2LjI+QkaWqrrC1uLzAwcXJycrL1NXj5Ofo6u3w9fr7/P3+d4M3+QAAAQBJREFUGBlVwYdCglAABdCLlr5Unijm3hMUtBzlBLSr//9JgUToOQgVJgceJgU8aHgMeA38K50ZOpcQmTPwcyXn+JM8M3JJIqQypiIkeXelTyIkGZPwKS1NMia1lgKTVkaE3oQQGYsmHNqSMWnTgUFbMiZtGlD2dpaxrL1XgM0i4ZK8MeAmFhsAs29MGZniawagS63oMOQUNXYB5D0D1RMDpyoMLw/fiE2og/V+PVDR5AiBl0/2Uwik+vx4xV3a5G5Ye68Nd1czjUjZckm6VhmPciRzeCZICjwTJAViQq+3e+St167rAoHK8sLYZVkBYPCZAZ/eGa+2R5LH7Wrc0YFf/O9J3yBDFaoAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAdCAYAAABFRCf7AAADcElEQVRIiaWVXWhcRRTHf7NNd2aDtUKMIjTpg4ufFIuiUOmDEWm0Vi3VYhXRqIggQh4sWJFSig9+oOhTKSpIRUWMIBIr2kptoTbgU6ooxCiIjR+14kcJmf9sNceHnd3ebnc3Uv9wuXfOzPzmnDMz5zozGwdWAbc65w5RUJQ8cC2wDJgFJioh/MJCMrNxq2vOzK4HmIvRRemxKP0RJWt53o7S+d2Yzsx6gQ+AIUDAnUqpBLzXZd4RYFUlhB/bdZacc3PAOmAcCMC7wfvFwLNdoAPAyx09bXyYWRl4E7gDmAdGlNKFwLYu8GolhO9O87RJd64GbMrgEvB68P4osMWdXLtVV7czlooNpVRWSs8DO7NpR/B+3rBHsvetCgtCMTxwQCm9BbyQrc8F7/uBex3uRCeXO0PrUZ4NfKyUPgWeyj3bg/crDNsIRGwBaJQGorQ3Svdn2wHgc2BUKb0DPJHtjwfvbwRucc7tz+N+i9LFUdoXpfVN36I0CVwBTFI/q9e1LPxT8P4qYEdu70q12mYzWw1MYQzjeJF6zq+shHC4B7jklOBPP/TzSunh4P0DwKvAfb5c9krpe+CcwsEoZdbhEvBM9wxRAl5RShcA9wAngE3B+8tLpdLuwrhp4MNmK0pfRWkySr7NXS8+L5nZbWZWy/Vin1IaitJnUTqvwevJ71lgSSWEFKUfHG7Q2m/xqFJaGry/GXgfGPLl8mJgrXPur2JoUC8Qy3OpG+sAbGhEKT0ErAWOA6uBPWbW1wr9BOgFbgKezot0kAPYqJQA1gC/A9cA+82svzksSn1R+jNKX0SpnM/e1x3yqig92JhrZivM7FjO8bSZLSuCR/Ok16K0KMNHojQWpYko7Y7S1igN5PE3ROl4lNaZ2UVmNpPBU01orvZvZPCeKFXbBR+lEKVtUapFaSZKg9njqpl9aWYTrmXCImA7sCWb9lK/jj9TrwkrgA1AH3AQuKsSwkzbrLfxpgpsBtYDxf/R3xm2ExirhNCuHHZXTsmRwiat+S/zSt06eysVA/4pmGr/G3qm6ik28v29FKgCg8BS6pvS0KNRGgZ+Bb4FpsxsOkfUlMuwDcBWYOUZOHYM2AU8WQmhBifDv70O7PjX7KZ+4G7g3FM8zd6uBIaBy4AqxnIcZwFLCovPAhE4Sj38b4BDwEeVEFKD9S94Khjn486v3QAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAATCAYAAAB7u5a2AAABx0lEQVQ4jaWUv48NURiGn3ONmCs32ZBd28ht1gqyZAkF21ylQkEiSp2ehpDlD1BoFGqqVdJohYKI7MaPxMoVNghCWMF+7ybLUewnOXfcMWO9yeQ857zne8+XmZOBGjJpr0kvTIomvTZpS526UCO4DUwD64FjwCFgqZnnR+oc8LfgzKQ73vGsr42ZtGjSQFV9o8KfBCacZwCaef4YmAf2rzjcpN3A2WSpm/AssKcqPDNpDBjs410CViXzTwk/A7b1C4wxDgOngAsZcAXY2buDfp/6S4F3lDS8DjgBzDWAjX/Y/e/QgYS/AhsKHa+OMQ6GEJ4Cj4BOAxgq6aCowyZtdf4OtAr+FHDO+R4wWnVbihr3cQnICt4boO38GWj9a/icjwOACt4m4K3zEPA+AxaAtTWCnwN3lzHkEL8V/OPAGud9wK2GF9XR1Wae/1zG2AI+pGYI4VUIoRtjHAc2A9cz4LRPevYCZ+i9/4sJt4GXJU10gaPAzdI2TTro/5Tfz8XEe2LSZGmxq/SDNvP8BnA5WRrx4BwYBe6vONx1EnjovGvBLAAd4Adwuyq8UiaNmDTvr+a8SQ9MuvbfwckBHZPe+QEfTdpep+4XZmPBHiHgz74AAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAUCAYAAACXtf2DAAACtklEQVQ4jZ2VSYiURxTHf+/T9Nc9iRrBuYySmIsXUU9iFMEFERRBvAjJLUQi5ioiHvSScfTmgqC4XAT1ZIgLuJHkICaaQAgKI2hAUBT30bjUq7bbv4eukXK029F3+eqtv/fqK6qQdEnSNUmT6CDB/bvgfjO4N9zj2RD8007xg1IABkwEzkma0qb4PGAPMBZYLtSD8eNwAEjqTlNI0gNJM4YU7w7ut4O7gvuhZFsR3C8NC5BBLiTIY0mzM8AvqbiC++pk+zLpE95XuwAws3vAQuBPYDRwWtL84P4tsDSLv5oaug4EYOawAMF9jMdoLxqNZcDvQA04UVYqL4G/svj7AF21mhJscrvCksYBFO7xc2AAGGg2mrdjvf4rcAyomNn+slLZmUEGBgsYdh945xZJmgvckDSrEJpK6ySBgV6q12O8ABwGPjGzfWWlsjdN9rpjoSfA+DYDXARGAksK4Is3XC1Ub4z1f4CDQGFmu6tleQSYk0U+p7WVeefLJc00s4fAeWB6Qeunvj0m2ugx9gO7kmlrtSxvBfcy6fXUZS6rgG/S+jLQUwCVNmMC9HqM14EtSe+rluWazN8YEv8IqKZ1E1qnaIDO0ucx3gX6kv6TpM3AM+D/IbGjgP60/gq4WQA33gMA2OQxPgHWJX1ttSwL4FAeZGYLgB2SasBs4A8L7qOBf9M0uXQB3a+TMYSmVctyDrA9mfcBK82smSdKWgCcAaa1bTm4fxbc/8uuCQX3RanAD5Ka6Wo5IGnE0HxJPZ03pQX5Org3MsD3AO5xXLPZXJ9BjkrqdFg6QjZkgG3Jtsw93pG0VFI9QU5K6voYQBHcTydAfwheBI9HgvvPAJIWS3qeIL9JGvUxkO7gfi1BrqTvwkG/pPmSnibIqTzXPgAyEVgBjAEu1qrVPbk/PVTHgb/NbPGg/RVIzOQqzSTBaQAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9Ii0yMCAtMjAgMjQwIDI0MCI+PGRlZnM+PGxpbmVhckdyYWRpZW50IGlkPSJhIiB4Mj0iMCIgeTI9IjEiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2ZmZiIgc3RvcC1vcGFjaXR5PSIwIi8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjZmZmIiBzdG9wLW9wYWNpdHk9IjAiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCBpZD0iYiIgeDE9IjEiIHgyPSIwIiB5Mj0iMSI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjZmZmIiBzdG9wLW9wYWNpdHk9IjAiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNmZmYiIHN0b3Atb3BhY2l0eT0iLjA4Ii8+PC9saW5lYXJHcmFkaWVudD48bGluZWFyR3JhZGllbnQgaWQ9ImMiIHgxPSIxIiB4Mj0iMCIgeTE9IjEiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2ZmZiIgc3RvcC1vcGFjaXR5PSIuMDgiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNmZmYiIHN0b3Atb3BhY2l0eT0iLjE2Ii8+PC9saW5lYXJHcmFkaWVudD48bGluZWFyR3JhZGllbnQgaWQ9ImQiIHgyPSIwIiB5MT0iMSI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjZmZmIiBzdG9wLW9wYWNpdHk9Ii4xNiIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iI2ZmZiIgc3RvcC1vcGFjaXR5PSIuMzMiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCBpZD0iZSIgeDI9IjEiIHkxPSIxIj48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiNmZmYiIHN0b3Atb3BhY2l0eT0iLjMzIi8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjZmZmIiBzdG9wLW9wYWNpdHk9Ii42NiIvPjwvbGluZWFyR3JhZGllbnQ+PGxpbmVhckdyYWRpZW50IGlkPSJmIiB4Mj0iMSIgeTI9IjEiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2ZmZiIgc3RvcC1vcGFjaXR5PSIuNjYiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNmZmYiLz48L2xpbmVhckdyYWRpZW50PjxtYXNrIGlkPSJnIj48ZyBmaWxsPSJub25lIiBzdHJva2Utd2lkdGg9IjQwIj48cGF0aCBzdHJva2U9InVybCgjYSkiIGQ9Ik04Ni42LTUwYTEwMCAxMDAgMCAwMTAgMTAwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMDAgMTAwKSIvPjxwYXRoIHN0cm9rZT0idXJsKCNiKSIgZD0iTTg2LjYgNTBBMTAwIDEwMCAwIDAxMCAxMDAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEwMCAxMDApIi8+PHBhdGggc3Ryb2tlPSJ1cmwoI2MpIiBkPSJNMCAxMDBhMTAwIDEwMCAwIDAxLTg2LjYtNTAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEwMCAxMDApIi8+PHBhdGggc3Ryb2tlPSJ1cmwoI2QpIiBkPSJNLTg2LjYgNTBhMTAwIDEwMCAwIDAxMC0xMDAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEwMCAxMDApIi8+PHBhdGggc3Ryb2tlPSJ1cmwoI2UpIiBkPSJNLTg2LjYtNTBBMTAwIDEwMCAwIDAxMC0xMDAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEwMCAxMDApIi8+PHBhdGggc3Ryb2tlPSJ1cmwoI2YpIiBkPSJNMC0xMDBhMTAwIDEwMCAwIDAxODYuNiA1MCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAwIDEwMCkiLz48L2c+PC9tYXNrPjwvZGVmcz48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiB4PSItMjAiIHk9Ii0yMCIgbWFzaz0idXJsKCNnKSIgZmlsbD0iI2ZmZiIvPjwvc3ZnPg=="},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDciIGhlaWdodD0iNDciIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGNpcmNsZSBjeD0iMjMuNSIgY3k9IjIzLjUiIHI9IjIzLjUiIGZpbGw9IiMwMDAiLz48cGF0aCBkPSJNMjcuNjM0IDE4LjUwOGE0LjMwNCA0LjMwNCAwIDExLTguNjA5IDAgNC4zMDQgNC4zMDQgMCAwMTguNjA5IDB6bTQuNzEyIDEyLjgwNGMuMTIyLjUwNi0uMjc1Ljk2OS0uNzg2Ljk2OUgxNS4xYy0uNTEyIDAtLjkwOS0uNDYyLS43ODctLjk3Ljk5My00LjEzNyA0LjY1My03LjIwOCA5LjAxNi03LjIwOHM4LjAyMyAzLjA3IDkuMDE3IDcuMjA5eiIgZmlsbD0iI0ZGRiIvPjwvc3ZnPg=="},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgNzkgODYiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0iI2ZmZiI+PHBhdGggZD0iTTkuNzU3IDQwLjkyNGMzLjczOC01LjE5MSAxMi43MTEtNC4zMDggMTIuNzExLTQuMzA4IDIuMjIzIDMuMDE0IDUuMTI2IDI0LjU4NiAzLjYyNCAyOC43MTgtMS40MDEgMS4zMDEtMTEuNjExIDEuNjI5LTEzLjM4LTEuNDM2LTEuMjI2LTguODA0LTIuOTU1LTIyLjk3NS0yLjk1NS0yMi45NzV6bTU4Ljc4NSAwYy0zLjczNy01LjE5MS0xMi43MTEtNC4zMDgtMTIuNzExLTQuMzA4LTIuMjIzIDMuMDE0LTUuMTI2IDI0LjU4Ni0zLjYyNCAyOC43MTggMS40MDEgMS4zMDEgMTEuNjExIDEuNjI5IDEzLjM4LTEuNDM2IDEuMjI2LTguODA0IDIuOTU1LTIyLjk3NSAyLjk1NS0yMi45NzV6Ii8+PHBhdGggZD0iTTY4LjY0NyA1OC42Yy43MjktNC43NTMgMi4zOC05LjU2MSAyLjM4LTE0LjgwNCAwLTIxLjQxMi0xNC4xMTUtMzguNzctMzEuNTI4LTM4Ljc3LTE3LjQxMiAwLTMxLjUyNyAxNy4zNTgtMzEuNTI3IDM4Ljc3IDAgNC41NDEuNTE1IDguOTM2IDEuODAyIDEyLjk1IDEuNjk4IDUuMjk1LTUuNTQyIDYuOTkxLTYuNjE2IDIuMDczQzIuNDEgNTUuMzk0IDAgNTEuNzg3IDAgNDguMTAzIDAgMjEuNTM2IDE3LjY4NSAwIDM5LjUgMCA2MS4zMTYgMCA3OSAyMS41MzYgNzkgNDguMTAzYzAgLjcxOC0yLjg5OSA5LjY5My0zLjI5MiAxMS40MDgtLjc1NCAzLjI5My03Ljc1MSAzLjU4OS03LjA2MS0uOTEyeiIvPjxwYXRoIGQ9Ik01LjA4NCA1MS4zODVjLS44MDQtMy43ODIuNTY5LTcuMzM1IDMuMTM0LTcuOTIxIDIuNjM2LS42MDMgNS40ODUgMi4xNSA2LjI4OSA2LjEzMi43OTcgMy45NDgtLjc1MiA3LjQ1Ny0zLjM4OCA3Ljg1OS0yLjU2Ni4zOTEtNS4yMzctMi4zMTgtNi4wMzQtNi4wN3ptNjguODM0IDBjLjgwNC0zLjc4Mi0uNTY4LTcuMzM1LTMuMTMzLTcuOTIxLTIuNjM2LS42MDMtNS40ODUgMi4xNS02LjI4OSA2LjEzMi0uNzk3IDMuOTQ4Ljc1MiA3LjQ1NyAzLjM4OSA3Ljg1OSAyLjU2NS4zOTEgNS4yMzctMi4zMTggNi4wMzQtNi4wN3ptLTIuMDM4IDguMjg4Yy0uOTI2IDE5LjY1OS0xNS4xMTIgMjQuNzU5LTI1Ljg1OSAyMC40NzUtNS40MDUtLjYwNi0zLjAzNCAxLjI2Mi0zLjAzNCAxLjI2MiAxMy42NjEgMy41NjIgMjYuMTY4IDMuNDk3IDMxLjI3My0yMC41NDktLjU4NS00LjUxMS0yLjM3OS0xLjE4Ny0yLjM3OS0xLjE4N3oiLz48cGF0aCBkPSJNNDEuNjYyIDc4LjQyMmw3LjU1My41NWMxLjE5Mi4xMDcgMi4xMiAxLjE1MyAyLjA3MiAyLjMzNWwtLjEwOSAyLjczOGMtLjA0NyAxLjE4Mi0xLjA1MSAyLjA1NC0yLjI0MyAxLjk0NmwtNy41NTMtLjU1Yy0xLjE5MS0uMTA3LTIuMTE5LTEuMTUzLTIuMDcyLTIuMzM1bC4xMDktMi43MzdjLjA0Ny0xLjE4MiAxLjA1Mi0yLjA1NCAyLjI0My0xLjk0N3oiLz48L2c+PC9zdmc+"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFIAAAAoCAYAAABtla08AAAINUlEQVR42u2aaUxUVxTHcRBmAAEBRVTK4sKwDIsg+wCK7CqIw1CN1YobbbS2qYlJ06Qx1UpdqMbYWq2pSzWmH6ytNbXWJY1Lq7VuqBERtW64V0XFLYae0/xvcp3MMAMzDz6IyT/ge2ce5/7ucpY3Ts3NzZ1ygF57AJ0gO0G2jyZPmdbFyclJSAV1EeoEaUUSLGdSV5KLLFxzFmA7QVqGqDqjixhWkxCVeyRVl38wM6bwj6yYItYK47BAuu9B0gCqs6Ng2r494KQtkj/Dz2jHraw6qw2fdSE4rNmcCPCvZONP8iF1I6kdBdMaQJWZLeJqRWa2kPJAxXY+GxE+zxLI03GRh8lGSwoi9WCY8FWlCEh+8JOnT7MfPGjMuXX7Tt61hoaCi/9cKmKdv3BxeEtim/UbNpnbQiqF4MmT7kqrbr4lkMcTo46TTSpJB5g+8NHuVWnWuaampvhmO/7duHmrGluoO4C6OsJZGRrkDIld43ZqUOTnlkDSmXmabAoBU0vqBf+6KgFSxQ9++uzZ8rZApM81TJ8xM5me0Z/UF7PuBmdVdkGEb5gYDeQmyZNW3SJLIP9Kj64lGyMpmxRN6sOfIbkoAhKOdnv2/PmB1kB88eLFo+olyyrps3rSINIAzLonnqlqK8R9w+L86vtrt5L2nhug3Vc3ULu/Liz8AOuXESlZZONH6kmr7gtLIA9lRNeRzVukAvj3BslLnJNKgfScO69K+/Lly0ZbQW7e8tNK+pwBjqaSIjDrXgJkW1ciAZvbQjQ+RDahpBBKd5ZZsqN758hmImk4KQHnpDd8UwSkCyJarx07d4+3BeKJmlMHyX4qaRxpBCmNFE4KENvHDpAutVERn1kCVBMfeRRgYvZnx62wZPdnZkw92VQA5GClQXYRBze2S+iJmpPVVoJLA9l9QKokjcWKTCT1R5rhLg70NuSsziT16diIKkuAjibrTpJNDkn/e17CahtAjlAWJAYkb29Sb1LE9Rs391kILk8mVkyuIpuZcLKUlEmKkra1WuSTNuesEPzwoEploSVAh9Oiz+BIyd9dOHhtx4OEpFpVg6gbNK3yXX1j48N6U5Dz5i/gc/FDrMY3sTLiSMEkXxGxzUEUAGnbxlPaksMlHUXWAlHS8URCPseSohZbCSLjSSU7ixLXdzhIWVKq4Y7t2a/2bN0qGeKly1fYsVmk6RgIDz4J0bonyUOcjeYqm/8hRoYbWkigV2NH9CHAS60EkUkkw47hSRs6FqT1LR5AVcsrueXlK1d5AO+RpmBrZZEiefByytPCanRGNLZY0uF52gNDYr9sCRB8MHY0SJu2OJWKS2WQV65e4y31DmkCImEi0hBfufRime0RIhpbKen0/Ny9OYNW2ghyYytABjNIaxNuKttAWk6HPLn0k0FevdZwFinPWFIuKZbUV16NVko6jbWSDoPO3pOf8K0jQWLSQ0S9bdpkYck+m7vfWpAiHfKgBsZiGSSt0FqcTeU8WETqAHE2CgcAVd3Gkm4MD3xXYeI6B4NMItvKbcUpQ9gP+KMWnSsW+TaYJtoo+avBWLoKoK0CCSDud+7eXWQGZAXqV3YoQjQCfixJ8+fzj9ta3JHhlUeJ8wJOY2ws6eRKpPS3oqTvHAESEz9ya0naXL5WH6pt3FqSOhTHkTcKEXc6k1POh4Q9YJu/03TT4a8PoGMFI4i2EqSbOZAYaBkpCyD92RkG6KCSbjI/H0HEISBnlOZPFdcEzI2GTO4KBZICGKyAKLTEmJOB2txf5MbgohBINCl4FTqmpJMB2W+HiRn1Q2l6lXyPmiEP6VVE2TfGoaMYrHyPdtAnyI0jEOn9RLWmNEhvBBE7SjpFQZaShtLK+1S+T12lRwxUvrZlVPp8jE1PikeO7C/nyEqBDCB1t7+kUx4kKUWclea0yZC5BIGpiJSNSD9QgFR0RQKkL6KxHSWdsiARHJNYewoGrzG1/bk4dTPSunL2EyDjcbb7MQ+lQfZmkKiN7SjpFAM5CWAyGcwyY84YsZ1lUcbRNNtQMAdtQWGvQ0DyVjzYAKQfQFodeAeC1C8vzymXIZqD+ZEh/2OyLSalS/3VbnJZ+VqDXGjMrTCFuK4s66vVZUNfqaDolcbjOcb899sLpEE+I20GifywXe2QR3KElu99PzqjGufhREqB1pjCnG3IL3fY1v733r2FMsiGhutn0LAoJWWIGbPxjKwgjUbF0m52mPhigrpdXOecEq9pR6MkHbu2LOtrcZ9y3d0ODTb15y9MePz48aF79+8fvXnr9sljx2u2I7KNxDuaMPGVECoRs7mC4eT7SIruFNfNHK15MKuM2evwNq+4qjxvGnd5CHwNNynawW4cOlUZdG8b55IIJHmkItwrZHH6QxB3OSL9kTtAGpIvZiQB3Z4SKBfXQtEE9sashWAW87Bt3sYZNR6zn4uzJwWDKUKXfaKCdqUoBpLxSjYe9nqGiwWRBGipuGZ3Qm76itYLbbJI/PEhUApfw73uOIy9xfse3M9F9BuFJHcYrseSouGkHtCVtkuGTTikI8XgZzhg9SeF4VqcvSWiaSvNHQ8JwkNjIfEHemCmNLD1RaEfLs18mlgNuN6PFALHo7CyU5W2g00gFAQF4ozvibH04muwDbWraSFAyt/AAMzewgGR8uCeWn77xzBxPxgzPRCDDMZ14bQ/3jqGKGoHf2Hjgx3kw5LbaJDYWb52t9FMgw4AuWNWukNeuOYqOsmQi2jgws4PA/DD/z0B2x0/veCs4naw0cgybezid7X9jV3rX2RSs0wfLkll4pBGcgifg+NYxe1kJ2ycTaRq66uG/wBOl0vjcw70xwAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFIAAAAoCAYAAABtla08AAAGMElEQVR4Ae2aA7D0yBaAc7oH12vbRmlLaxYWb23btm3btm2899a2bWuYtPZ01cmtU9lJrib315yqr9I3Oem/5/s7acwEnehEJzoxCcX2O+wEeIgRBDDaGjAZOgQ6ihRpLklHZDJIXK1WWymMIhGGkVBKCWMM+Iv/f/b5t7faYtM/sGgIS7j8RNLjceUVl41GvGN1BFiHy9sgtRWaYbhvuVQ6o1VOvV5/tLe3dyssKoZuh8xClkDEi2MMS6ZjR0cScxdK/+HgnJsmLccYOx0e/PUGUqfTJDEHkV5go9lcMQoj4R8RpSIRRUr4a9baTJFCCNfqESKJ7RYJibK0xoi05EhFRTxMi1Rit6xHAuLaKRLwEVi6q1x+EhlVpd3d3Wfh4VQkQhRhxthYLg7SRGqdLlIp7UVOHf+JhEhEMscUolVje3p63saeeOFoKsT7fjj++BNuw2I/0ouUENmGaQcQEilQvUU6xuWC0kqmVWCt8df6kG7WLoFA20VSCOyNh0RKPT+SyrTWtQsvuvTYCy84z3+oAdbgAiLGIvHjTz6bFuu/B3lKKfVkFKknwih6EnnipZdfXQZzepAupXSGSCfwUGZtkrx3t/0dSQGnnXbmdocdetArQoj+4VR23wMP3bj/vnv9Sv/rBmkish09ca655thHSrlWq4TFF1vkNDxsgjiUnPqZnHPABIq47jx7pPMcecShfz7x1DO7D6eit99576X1113nVd8rqLGAuDaNitJonTGIqHgQGQjDsJglMrUH5iDSEQbRa6y2yrNvv/PuWVmV/PTzLz8steTit1B9FtGJeZrJksmWdBzBMcami4xUkaY1A1Qe94WIaPGBApJhaERrLrXkElf8+NPPz6YMLs1DDjn0Wn9PnI/UiQadM4jNEkhzVsEGE8nIHESM1j5/KqRX+/IEiOQ/yifNBlEkpnb00cccesbpp13T3983H88/48xzrrvm6it/8U5JXgX5G6nSvSq1R5LATR7aYGkwMG1RSwkWABH+4jUb3vT/uJ1Z0xpjraTBRltrxUQhksIRmgTJyy69+Pv99tv3qYX6FxgU+fU33352xGEHf5wisU7nNWJpZRMkAjZ6aIN1mwV7h29Jo2wCHlveu/GV169z65E+T6koexCh6c+EEiky3lnxQKFjUeVyOeI5AOBzIiayRhJryd7YYnkIHgvB0qk9Tdql6N3XH4bRUIOIIIKJSiRb0hkSEpZKRd1CpEq8GxtIyCVmDSgFl94GacTgaJw1rUlYhYng0c4ewaUsmKRIJjpiqMSOCh9QeI+UYECmtQIsxEu6OorEcv6Rl0gu0woh8MhFkmSCTXVI4pC704WCFRJvSRNJSzrMMEZO2iKZTCHAZYnmvXCny7ed5vfZK3viHSBdIFCKEFj2+nt+73nw8m2uedcLJlktA++VNMEPaR45aYukcKnnCfY3/DFbZS8t7eHxNgsPM0N1hXhJJwwM1QbpoQFlog2R13a/zBxEYHAQEUYUM6qiVwEyBYoM6JFNF2kFLelI5KQf+fVI4dJFCguDS7oAyx2R6SFQJKRedSDj/cMg/RXQ6ZE05GSIDAaXdCi1I3L021SQWNJ1RLY5OiIdL4/yvuw8ADfWPFrSciaMyH8tEQPwf1uGG54g5+KlJGTmsrxsQdl5PKidnPFe2QS///7Hu+VS6WX/HYnf0sevGL7lXydwod2/9DykZq0s5yff0sgSWCigNOH7TPHL7ufj+/TH8P/+qYpL4HkBDiRYpEXeM8/89/9zzjn7EtY64dfd1nqccM7Bs8+9MKy8555/8TnKS+5MufH6EZVASkgPzf+mJXroet17JirU0ALST3nT0y5ONyLpeo1y64ih+vuQfsoTOeRFSJXa+SvyB90TUmdw49EjLaKpMQ0mzEeTzkWsd/oI6fzfiKM8gWg6X6OjpXstu5ZHnmIb0GFiu29MIUfUewkmVrEN3RqVQ/bY8FzNcquMBv/pCNUZ5pHHem01KdN/I/DG66/lLhKSvTO5M84kav5C5z2ZfyAivi9i9VGd45RH7UWJbjwGG/7NYsRECt7jiOToHedKAui8SW4CsxyRc54mKH/8f7ELhCCACyNcIl/wI+FaAJyc8yzRtinQPzWzuFZrFHq/AAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTUwIiBoZWlnaHQ9IjkwIj48ZGVmcz48cGF0aCBkPSJNNjcgMTJMNi40NDggNzIuNTUyIDAgMzFWMThMMjYgMGw0MSAxMnptMyA3bDYgNDctMjkgMTgtMzUuNTAyLTYuNDk4TDcwIDE5eiIgaWQ9ImEiLz48L2RlZnM+PHJlY3Qgd2lkdGg9IjE1MCIgaGVpZ2h0PSI5MCIgcng9IjM1IiByeT0iNDUiIG9wYWNpdHk9Ii41Ii8+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzNikiPjxtYXNrIGlkPSJiIiBmaWxsPSIjZmZmIj48dXNlIHhsaW5rOmhyZWY9IiNhIi8+PC9tYXNrPjxwYXRoIGQ9Ik0zOS4yNDkgNTEuMzEyYy42OTcgMTAuMzcgMi43ODUgMTcuODk3IDUuMjUxIDE3Ljg5NyAzLjAzOCAwIDUuNS0xMS40MTcgNS41LTI1LjVzLTIuNDYyLTI1LjUtNS41LTI1LjVjLTIuNTEgMC00LjYyOCA3Ljc5Ny01LjI4NyAxOC40NTNBOC45ODkgOC45ODkgMCAwMTQzIDQ0YTguOTg4IDguOTg4IDAgMDEtMy43NTEgNy4zMTJ6TTIwLjk4NSAzMi4yMjRsMTUuNzQ2LTE2Ljg3N2E3LjM4NSA3LjM4NSAwIDAxMTAuMzc0LS40MkM1MS43MDIgMTkuMTE0IDU0IDI5LjIwOCA1NCA0NS4yMDhjMCAxNC41MjctMi4zNDMgMjMuODgtNy4wMyAyOC4wNThhNy4yOCA3LjI4IDAgMDEtMTAuMTY4LS40NjhMMjAuNDA1IDU1LjIyNEgxMmE1IDUgMCAwMS01LTV2LTEzYTUgNSAwIDAxNS01aDguOTg1eiIgZmlsbD0iI0ZGRiIgbWFzaz0idXJsKCNiKSIvPjwvZz48cGF0aCBkPSJNMTA2LjUgMTMuNUw0NC45OTggNzUuMDAyIiBzdHJva2U9IiNGRkYiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIi8+PC9nPjwvc3ZnPg=="},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOTciIGhlaWdodD0iOTAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxwYXRoIGQ9Ik03MCAxMkw5LjQ0OCA3Mi41NTIgMCA2MmwzLTQ0TDI5IDBsNDEgMTJ6bTggMmwxIDUyLTI5IDE4LTM1LjUwMi02LjQ5OEw3OCAxNHoiIGlkPSJhIi8+PC9kZWZzPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOCAzKSI+PG1hc2sgaWQ9ImIiIGZpbGw9IiNmZmYiPjx1c2UgeGxpbms6aHJlZj0iI2EiLz48L21hc2s+PHBhdGggZD0iTTkuMTEgMjAuOTY4SDQ4LjFhNSA1IDAgMDE1IDVWNTguMThhNSA1IDAgMDEtNSA1SDkuMTFhNSA1IDAgMDEtNS01VjI1Ljk3YTUgNSAwIDAxNS01em00Ny4wOCAxMy4zOTRjMC0uMzQ1IDUuNDcyLTMuMTU5IDE2LjQxNS04LjQ0M2EzIDMgMCAwMTQuMzA0IDIuNzAydjI2LjgzNWEzIDMgMCAwMS00LjMwNSAyLjcwMWMtMTAuOTQyLTUuMjg2LTE2LjQxMy04LjEtMTYuNDEzLTguNDQ2VjM0LjM2MnoiIGZpbGw9IiNGRkYiIG1hc2s9InVybCgjYikiLz48L2c+PHBhdGggZD0iTTgxLjUgMTYuNUwxOS45OTggNzguMDAyIiBzdHJva2U9IiNGRkYiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIi8+PC9nPjwvc3ZnPg=="},function(e,t,n){var r,i,o={},a=(r=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===i&&(i=r.apply(this,arguments)),i}),s=function(e,t){return t?t.querySelector(e):document.querySelector(e)},c=function(e){var t={};return function(e,n){if("function"==typeof e)return e();if(void 0===t[e]){var r=s.call(this,e,n);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}}(),u=null,d=0,l=[],f=n(356);function p(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=o[r.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](r.parts[a]);for(;a<r.parts.length;a++)i.parts.push(b(r.parts[a],t))}else{var s=[];for(a=0;a<r.parts.length;a++)s.push(b(r.parts[a],t));o[r.id]={id:r.id,refs:1,parts:s}}}}function h(e,t){for(var n=[],r={},i=0;i<e.length;i++){var o=e[i],a=t.base?o[0]+t.base:o[0],s={css:o[1],media:o[2],sourceMap:o[3]};r[a]?r[a].parts.push(s):n.push(r[a]={id:a,parts:[s]})}return n}function m(e,t){var n=c(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=l[l.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),l.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var i=c(e.insertAt.before,n);n.insertBefore(t,i)}}function g(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=l.indexOf(e);t>=0&&l.splice(t,1)}function v(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var r=n.nc;r&&(e.attrs.nonce=r)}return y(t,e.attrs),m(e,t),t}function y(e,t){Object.keys(t).forEach((function(n){e.setAttribute(n,t[n])}))}function b(e,t){var n,r,i,o;if(t.transform&&e.css){if(!(o="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=o}if(t.singleton){var a=d++;n=u||(u=v(t)),r=_.bind(null,n,a,!1),i=_.bind(null,n,a,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",y(t,e.attrs),m(e,t),t}(t),r=R.bind(null,n,t),i=function(){g(n),n.href&&URL.revokeObjectURL(n.href)}):(n=v(t),r=T.bind(null,n),i=function(){g(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=a()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var n=h(e,t);return p(n,t),function(e){for(var r=[],i=0;i<n.length;i++){var a=n[i];(s=o[a.id]).refs--,r.push(s)}for(e&&p(h(e,t),t),i=0;i<r.length;i++){var s;if(0===(s=r[i]).refs){for(var c=0;c<s.parts.length;c++)s.parts[c]();delete o[s.id]}}}};var S,E=(S=[],function(e,t){return S[e]=t,S.filter(Boolean).join("\n")});function _(e,t,n,r){var i=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=E(t,i);else{var o=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function T(e,t){var n=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function R(e,t,n){var r=n.css,i=n.sourceMap,o=void 0===t.convertToAbsoluteUrls&&i;(t.convertToAbsoluteUrls||o)&&(r=f(r)),i&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var a=new Blob([r],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,r=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var i,o=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(o)?e:(i=0===o.indexOf("//")?o:0===o.indexOf("/")?n+o:r+o.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")}))}},function(e,t){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,n){var r=n(81),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0||(n==t.length-1?t.pop():i.call(t,n,1),--this.size,0))}},function(e,t,n){var r=n(81);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},function(e,t,n){var r=n(81);e.exports=function(e){return r(this.__data__,e)>-1}},function(e,t,n){var r=n(81);e.exports=function(e,t){var n=this.__data__,i=r(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}},function(e,t,n){var r=n(80);e.exports=function(){this.__data__=new r,this.size=0}},function(e,t){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},function(e,t){e.exports=function(e){return this.__data__.get(e)}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t,n){var r=n(80),i=n(111),o=n(112);e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var a=n.__data__;if(!i||a.length<199)return a.push([e,t]),this.size=++n.size,this;n=this.__data__=new o(a)}return n.set(e,t),this.size=n.size,this}},function(e,t,n){var r=n(17),i=n(370),o=n(11),a=n(175),s=/^\[object .+?Constructor\]$/,c=Function.prototype,u=Object.prototype,d=c.toString,l=u.hasOwnProperty,f=RegExp("^"+d.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!o(e)||i(e))&&(r(e)?f:s).test(a(e))}},function(e,t,n){var r=n(40),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=o.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(e){}var i=a.call(e);return r&&(t?e[s]=n:delete e[s]),i}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t,n){var r,i=n(371),o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!o&&o in e}},function(e,t,n){var r=n(15)["__core-js_shared__"];e.exports=r},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t,n){var r=n(374),i=n(80),o=n(111);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||i),string:new r}}},function(e,t,n){var r=n(375),i=n(376),o=n(377),a=n(378),s=n(379);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=a,c.prototype.set=s,e.exports=c},function(e,t,n){var r=n(82);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},function(e,t,n){var r=n(82),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(t,e)?t[e]:void 0}},function(e,t,n){var r=n(82),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:i.call(t,e)}},function(e,t,n){var r=n(82);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},function(e,t,n){var r=n(83);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},function(e,t,n){var r=n(83);e.exports=function(e){return r(this,e).get(e)}},function(e,t,n){var r=n(83);e.exports=function(e){return r(this,e).has(e)}},function(e,t,n){var r=n(83);e.exports=function(e,t){var n=r(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}},function(e,t){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},function(e,t,n){var r=n(30),i=n(18);e.exports=function(e){return i(e)&&"[object Arguments]"==r(e)}},function(e,t){e.exports=function(){return!1}},function(e,t,n){var r=n(30),i=n(114),o=n(18),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=function(e){return o(e)&&i(e.length)&&!!a[r(e)]}},function(e,t,n){var r=n(179)(Object.keys,Object);e.exports=r},function(e,t,n){var r=n(41),i=n(54);e.exports=function(e,t){return e&&r(t,i(t),e)}},function(e,t,n){var r=n(11),i=n(68),o=n(392),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=i(e),n=[];for(var s in e)("constructor"!=s||!t&&a.call(e,s))&&n.push(s);return n}},function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},function(e,t,n){var r=n(41),i=n(117);e.exports=function(e,t){return r(e,i(e),t)}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}},function(e,t,n){var r=n(41),i=n(182);e.exports=function(e,t){return r(e,i(e),t)}},function(e,t,n){var r=n(39)(n(15),"DataView");e.exports=r},function(e,t,n){var r=n(39)(n(15),"Promise");e.exports=r},function(e,t){var n=Object.prototype.hasOwnProperty;e.exports=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&n.call(e,"index")&&(r.index=e.index,r.input=e.input),r}},function(e,t,n){var r=n(120),i=n(400),o=n(401),a=n(402),s=n(189);e.exports=function(e,t,n){var c=e.constructor;switch(t){case"[object ArrayBuffer]":return r(e);case"[object Boolean]":case"[object Date]":return new c(+e);case"[object DataView]":return i(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return s(e,n);case"[object Map]":return new c;case"[object Number]":case"[object String]":return new c(e);case"[object RegExp]":return o(e);case"[object Set]":return new c;case"[object Symbol]":return a(e)}}},function(e,t,n){var r=n(120);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}},function(e,t){var n=/\w*$/;e.exports=function(e){var t=new e.constructor(e.source,n.exec(e));return t.lastIndex=e.lastIndex,t}},function(e,t,n){var r=n(40),i=r?r.prototype:void 0,o=i?i.valueOf:void 0;e.exports=function(e){return o?Object(o.call(e)):{}}},function(e,t,n){var r=n(404),i=n(67),o=n(115),a=o&&o.isMap,s=a?i(a):r;e.exports=s},function(e,t,n){var r=n(42),i=n(18);e.exports=function(e){return i(e)&&"[object Map]"==r(e)}},function(e,t,n){var r=n(406),i=n(67),o=n(115),a=o&&o.isSet,s=a?i(a):r;e.exports=s},function(e,t,n){var r=n(42),i=n(18);e.exports=function(e){return i(e)&&"[object Set]"==r(e)}},function(e,t,n){(function(r){t.log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.exports.humanize(this.diff),n){var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var i=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))})),t.splice(o,0,r)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.setItem("debug",e)}catch(e){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e},t.useColors=function(){var e=function(e){var n="debug_"+e.toLowerCase();try{return t.storage.getItem(n)}catch(e){return void 0!==r&&"env"in r?r.env[n.toUpperCase()]:void 0}}("colors");return!/^(no|off|false|disabled)$/i.test(e)&&(!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&Boolean("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)))},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=n(408)(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this,n(43))},function(e,t,n){e.exports=function(e){function t(e){var t,n=0;for(t in e)n=(n<<5)-n+e.charCodeAt(t),n|=0;return r.colors[Math.abs(n)%r.colors.length]}function r(e){var n;function o(){if(o.enabled){var e=o,t=+new Date,i=t-(n||t);e.diff=i,e.prev=n,e.curr=t,n=t;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=r.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var c=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(function(t,n){if("%%"===t)return t;c++;var i=r.formatters[n];if("function"==typeof i){var o=a[c];t=i.call(e,o),a.splice(c,1),c--}return t})),r.formatArgs.call(e,a);var u=e.log||r.log;u.apply(e,a)}}return o.namespace=e,o.enabled=r.enabled(e),o.useColors=r.useColors(),o.color=t(e),o.destroy=i,"function"==typeof r.init&&r.init(o),r.instances.push(o),o}function i(){var e=r.instances.indexOf(this);return-1!==e&&(r.instances.splice(e,1),!0)}return r.debug=r.default=r,r.coerce=function(e){return e instanceof Error?e.stack||e.message:e},r.disable=function(){r.enable("")},r.enable=function(e){var t;r.save(e),r.names=[],r.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length;for(t=0;t<i;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^"+e.substr(1)+"$")):r.names.push(new RegExp("^"+e+"$")));for(t=0;t<r.instances.length;t++){var o=r.instances[t];o.enabled=r.enabled(o.namespace)}},r.enabled=function(e){if("*"===e[e.length-1])return!0;var t,n;for(t=0,n=r.skips.length;t<n;t++)if(r.skips[t].test(e))return!1;for(t=0,n=r.names.length;t<n;t++)if(r.names[t].test(e))return!0;return!1},r.humanize=n(409),Object.keys(e).forEach((function(t){r[t]=e[t]})),r.instances=[],r.names=[],r.skips=[],r.formatters={},r.selectColor=t,r.enable(r.load()),r}},function(e,t){var n=1e3,r=6e4,i=60*r,o=24*i;function a(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}e.exports=function(e,t){t=t||{};var s,c,u=typeof e;if("string"===u&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var a=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"weeks":case"week":case"w":return 6048e5*a;case"days":case"day":case"d":return a*o;case"hours":case"hour":case"hrs":case"hr":case"h":return a*i;case"minutes":case"minute":case"mins":case"min":case"m":return a*r;case"seconds":case"second":case"secs":case"sec":case"s":return a*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}(e);if("number"===u&&isFinite(e))return t.long?(s=e,(c=Math.abs(s))>=o?a(s,c,o,"day"):c>=i?a(s,c,i,"hour"):c>=r?a(s,c,r,"minute"):c>=n?a(s,c,n,"second"):s+" ms"):function(e){var t=Math.abs(e);return t>=o?Math.round(e/o)+"d":t>=i?Math.round(e/i)+"h":t>=r?Math.round(e/r)+"m":t>=n?Math.round(e/n)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){var r=n(411),i=n(176),o=n(89),a=i?function(e,t){return i(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:o;e.exports=a},function(e,t){e.exports=function(e){return function(){return e}}},function(e,t,n){"use strict";const r=n(195),i=new r;e.exports=function(e,t){if(void 0===t)return e;i.has(t)||i.set(t,new r);const n=i.get(t);return n.has(e)||n.set(e,e.bind(t)),n.get(e)}},function(e,t,n){"use strict";e.exports=function(){var e,t;if("function"!=typeof WeakMap)return!1;try{e=new WeakMap([[t={},"one"],[{},"two"],[{},"three"]])}catch(e){return!1}return"[object WeakMap]"===String(e)&&"function"==typeof e.set&&e.set({},1)===e&&"function"==typeof e.delete&&"function"==typeof e.has&&"one"===e.get(t)}},function(e,t,n){"use strict";var r,i=n(44),o=n(125),a=n(417),s=n(32),c=n(418),u=n(33),d=n(202),l=n(460),f=n(45).toStringTag,p=n(461),h=Array.isArray,m=Object.defineProperty,g=Object.prototype.hasOwnProperty,v=Object.getPrototypeOf;e.exports=r=function(){var e,t=arguments[0];if(!(this instanceof r))throw new TypeError("Constructor requires 'new'");return e=p&&o&&WeakMap!==r?o(new WeakMap,v(this)):this,i(t)&&(h(t)||(t=d(t))),m(e,"__weakMapData__",u("c","$weakMap$"+c())),t?(l(t,(function(t){s(t),e.set(t[0],t[1])})),e):e},p&&(o&&o(r,WeakMap),r.prototype=Object.create(WeakMap.prototype,{constructor:u(r)})),Object.defineProperties(r.prototype,{delete:u((function(e){return!!g.call(a(e),this.__weakMapData__)&&(delete e[this.__weakMapData__],!0)})),get:u((function(e){if(g.call(a(e),this.__weakMapData__))return e[this.__weakMapData__]})),has:u((function(e){return g.call(a(e),this.__weakMapData__)})),set:u((function(e,t){return m(a(e),this.__weakMapData__,u("c",t)),this})),toString:u((function(){return"[object WeakMap]"}))}),m(r.prototype,f,u("c","WeakMap"))},function(e,t,n){"use strict";e.exports=function(){}},function(e,t,n){"use strict";var r,i,o,a,s=Object.create;n(196)()||(r=n(197)),e.exports=r?1!==r.level?s:(i={},o={},a={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach((function(e){o[e]="__proto__"!==e?a:{configurable:!0,enumerable:!1,writable:!0,value:void 0}})),Object.defineProperties(i,o),Object.defineProperty(r,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:i}),function(e,t){return s(null===e?i:e,t)}):s},function(e,t,n){"use strict";var r=n(198);e.exports=function(e){if(!r(e))throw new TypeError(e+" is not an Object");return e}},function(e,t,n){"use strict";var r=Object.create(null),i=Math.random;e.exports=function(){var e;do{e=i().toString(36).slice(2)}while(r[e]);return e}},function(e,t,n){"use strict";var r=n(420);e.exports=function(e){if("function"!=typeof e)return!1;if(!hasOwnProperty.call(e,"length"))return!1;try{if("number"!=typeof e.length)return!1;if("function"!=typeof e.call)return!1;if("function"!=typeof e.apply)return!1}catch(e){return!1}return!r(e)}},function(e,t,n){"use strict";var r=n(126);e.exports=function(e){if(!r(e))return!1;try{return!!e.constructor&&e.constructor.prototype===e}catch(e){return!1}}},function(e,t,n){"use strict";e.exports=function(){var e,t=Object.assign;return"function"==typeof t&&(t(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}},function(e,t,n){"use strict";var r=n(423),i=n(32),o=Math.max;e.exports=function(e,t){var n,a,s,c=o(arguments.length,2);for(e=Object(i(e)),s=function(r){try{e[r]=t[r]}catch(e){n||(n=e)}},a=1;a<c;++a)r(t=arguments[a]).forEach(s);if(void 0!==n)throw n;return e}},function(e,t,n){"use strict";e.exports=n(424)()?Object.keys:n(425)},function(e,t,n){"use strict";e.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},function(e,t,n){"use strict";var r=n(44),i=Object.keys;e.exports=function(e){return i(r(e)?Object(e):e)}},function(e,t,n){"use strict";var r="razdwatrzy";e.exports=function(){return"function"==typeof r.contains&&!0===r.contains("dwa")&&!1===r.contains("foo")}},function(e,t,n){"use strict";var r=String.prototype.indexOf;e.exports=function(e){return r.call(this,e,arguments[1])>-1}},function(e,t,n){"use strict";var r,i=n(125),o=n(201),a=n(33),s=n(45),c=n(204),u=Object.defineProperty;r=e.exports=function(e,t){if(!(this instanceof r))throw new TypeError("Constructor requires 'new'");c.call(this,e),t=t?o.call(t,"key+value")?"key+value":o.call(t,"key")?"key":"value":"value",u(this,"__kind__",a("",t))},i&&i(r,c),delete r.prototype.constructor,r.prototype=Object.create(c.prototype,{_resolve:a((function(e){return"value"===this.__kind__?this.__list__[e]:"key+value"===this.__kind__?[e,this.__list__[e]]:e}))}),u(r.prototype,s.toStringTag,a("c","Array Iterator"))},function(e,t,n){"use strict";var r=n(92),i={object:!0,symbol:!0};e.exports=function(){var e,t=r.Symbol;if("function"!=typeof t)return!1;e=t("test symbol");try{String(e)}catch(e){return!1}return!!i[typeof t.iterator]&&!!i[typeof t.toPrimitive]&&!!i[typeof t.toStringTag]}},function(e,t,n){"use strict";e.exports=function(){return"object"==typeof globalThis&&!!globalThis&&globalThis.Array===Array}},function(e,t){var n=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return n()}try{return __global__||n()}finally{delete Object.prototype.__global__}}()},function(e,t,n){"use strict";var r,i,o,a=n(33),s=n(203),c=n(92).Symbol,u=n(434),d=n(435),l=n(436),f=Object.create,p=Object.defineProperties,h=Object.defineProperty;if("function"==typeof c)try{String(c()),o=!0}catch(e){}else c=null;i=function(e){if(this instanceof i)throw new TypeError("Symbol is not a constructor");return r(e)},e.exports=r=function e(t){var n;if(this instanceof e)throw new TypeError("Symbol is not a constructor");return o?c(t):(n=f(i.prototype),t=void 0===t?"":String(t),p(n,{__description__:a("",t),__name__:a("",u(t))}))},d(r),l(r),p(i.prototype,{constructor:a(r),toString:a("",(function(){return this.__name__}))}),p(r.prototype,{toString:a((function(){return"Symbol ("+s(this).__description__+")"})),valueOf:a((function(){return s(this)}))}),h(r.prototype,r.toPrimitive,a("",(function(){var e=s(this);return"symbol"==typeof e?e:e.toString()}))),h(r.prototype,r.toStringTag,a("c","Symbol")),h(i.prototype,r.toStringTag,a("c",r.prototype[r.toStringTag])),h(i.prototype,r.toPrimitive,a("c",r.prototype[r.toPrimitive]))},function(e,t,n){"use strict";e.exports=function(e){return!!e&&("symbol"==typeof e||!!e.constructor&&"Symbol"===e.constructor.name&&"Symbol"===e[e.constructor.toStringTag])}},function(e,t,n){"use strict";var r=n(33),i=Object.create,o=Object.defineProperty,a=Object.prototype,s=i(null);e.exports=function(e){for(var t,n,i=0;s[e+(i||"")];)++i;return s[e+=i||""]=!0,o(a,t="@@"+e,r.gs(null,(function(e){n||(n=!0,o(this,t,r(e)),n=!1)}))),t}},function(e,t,n){"use strict";var r=n(33),i=n(92).Symbol;e.exports=function(e){return Object.defineProperties(e,{hasInstance:r("",i&&i.hasInstance||e("hasInstance")),isConcatSpreadable:r("",i&&i.isConcatSpreadable||e("isConcatSpreadable")),iterator:r("",i&&i.iterator||e("iterator")),match:r("",i&&i.match||e("match")),replace:r("",i&&i.replace||e("replace")),search:r("",i&&i.search||e("search")),species:r("",i&&i.species||e("species")),split:r("",i&&i.split||e("split")),toPrimitive:r("",i&&i.toPrimitive||e("toPrimitive")),toStringTag:r("",i&&i.toStringTag||e("toStringTag")),unscopables:r("",i&&i.unscopables||e("unscopables"))})}},function(e,t,n){"use strict";var r=n(33),i=n(203),o=Object.create(null);e.exports=function(e){return Object.defineProperties(e,{for:r((function(t){return o[t]?o[t]:o[t]=e(String(t))})),keyFor:r((function(e){var t;for(t in i(e),o)if(o[t]===e)return t}))})}},function(e,t,n){"use strict";var r=n(32);e.exports=function(){return r(this).length=0,this}},function(e,t,n){"use strict";var r,i=n(56),o=n(439),a=n(443),s=n(444),c=n(200),u=n(454),d=Function.prototype.bind,l=Object.defineProperty,f=Object.prototype.hasOwnProperty;r=function(e,t,n){var r,i=o(t)&&a(t.value);return delete(r=s(t)).writable,delete r.value,r.get=function(){return!n.overwriteDefinition&&f.call(this,e)?i:(t.value=d.call(i,n.resolveContext?n.resolveContext(this):this),l(this,e,t),this[e])},r},e.exports=function(e){var t=c(arguments[1]);return i(t.resolveContext)&&a(t.resolveContext),u(e,(function(e,n){return r(n,e,t)}))}},function(e,t,n){"use strict";var r=n(205),i=n(56);e.exports=function(e){return i(e)?e:r(e,"Cannot use %v",arguments[1])}},function(e,t,n){"use strict";var r=n(56),i=n(126),o=Object.prototype.toString;e.exports=function(e){if(!r(e))return null;if(i(e)){var t=e.toString;if("function"!=typeof t)return null;if(t===o)return null}try{return""+e}catch(e){return null}}},function(e,t,n){"use strict";var r=n(442),i=/[\n\r\u2028\u2029]/g;e.exports=function(e){var t=r(e);return null===t?"<Non-coercible to string value>":(t.length>100&&(t=t.slice(0,99)+"â¦"),t=t.replace(i,(function(e){switch(e){case"\n":return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}})))}},function(e,t,n){"use strict";e.exports=function(e){try{return e.toString()}catch(t){try{return String(e)}catch(e){return null}}}},function(e,t,n){"use strict";var r=n(205),i=n(199);e.exports=function(e){return i(e)?e:r(e,"%v is not a plain function",arguments[1])}},function(e,t,n){"use strict";var r=n(445),i=n(127),o=n(32);e.exports=function(e){var t=Object(o(e)),n=arguments[1],a=Object(arguments[2]);if(t!==e&&!n)return t;var s={};return n?r(n,(function(t){(a.ensure||t in e)&&(s[t]=e[t])})):i(s,e),s}},function(e,t,n){"use strict";e.exports=n(446)()?Array.from:n(447)},function(e,t,n){"use strict";e.exports=function(){var e,t,n=Array.from;return"function"==typeof n&&(t=n(e=["raz","dwa"]),Boolean(t&&t!==e&&"dwa"===t[1]))}},function(e,t,n){"use strict";var r=n(45).iterator,i=n(90),o=n(448),a=n(449),s=n(69),c=n(32),u=n(44),d=n(91),l=Array.isArray,f=Function.prototype.call,p={configurable:!0,enumerable:!0,writable:!0,value:null},h=Object.defineProperty;e.exports=function(e){var t,n,m,g,v,y,b,S,E,_,T=arguments[1],R=arguments[2];if(e=Object(c(e)),u(T)&&s(T),this&&this!==Array&&o(this))t=this;else{if(!T){if(i(e))return 1!==(v=e.length)?Array.apply(null,e):((g=new Array(1))[0]=e[0],g);if(l(e)){for(g=new Array(v=e.length),n=0;n<v;++n)g[n]=e[n];return g}}g=[]}if(!l(e))if(void 0!==(E=e[r])){for(b=s(E).call(e),t&&(g=new t),S=b.next(),n=0;!S.done;)_=T?f.call(T,R,S.value,n):S.value,t?(p.value=_,h(g,n,p)):g[n]=_,S=b.next(),++n;v=n}else if(d(e)){for(v=e.length,t&&(g=new t),n=0,m=0;n<v;++n)_=e[n],n+1<v&&(y=_.charCodeAt(0))>=55296&&y<=56319&&(_+=e[++n]),_=T?f.call(T,R,_,m):_,t?(p.value=_,h(g,m,p)):g[m]=_,++m;v=m}if(void 0===v)for(v=a(e.length),t&&(g=new t(v)),n=0;n<v;++n)_=T?f.call(T,R,e[n],n):e[n],t?(p.value=_,h(g,n,p)):g[n]=_;return t&&(p.value=null,g.length=v),g}},function(e,t,n){"use strict";var r=Object.prototype.toString,i=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);e.exports=function(e){return"function"==typeof e&&i(r.call(e))}},function(e,t,n){"use strict";var r=n(450),i=Math.max;e.exports=function(e){return i(0,r(e))}},function(e,t,n){"use strict";var r=n(451),i=Math.abs,o=Math.floor;e.exports=function(e){return isNaN(e)?0:0!==(e=Number(e))&&isFinite(e)?r(e)*o(i(e)):e}},function(e,t,n){"use strict";e.exports=n(452)()?Math.sign:n(453)},function(e,t,n){"use strict";e.exports=function(){var e=Math.sign;return"function"==typeof e&&1===e(10)&&-1===e(-20)}},function(e,t,n){"use strict";e.exports=function(e){return e=Number(e),isNaN(e)||0===e?e:e>0?1:-1}},function(e,t,n){"use strict";var r=n(69),i=n(455),o=Function.prototype.call;e.exports=function(e,t){var n={},a=arguments[2];return r(t),i(e,(function(e,r,i,s){n[r]=o.call(t,a,e,r,i,s)})),n}},function(e,t,n){"use strict";e.exports=n(456)("forEach")},function(e,t,n){"use strict";var r=n(69),i=n(32),o=Function.prototype.bind,a=Function.prototype.call,s=Object.keys,c=Object.prototype.propertyIsEnumerable;e.exports=function(e,t){return function(n,u){var d,l=arguments[2],f=arguments[3];return n=Object(i(n)),r(u),d=s(n),f&&d.sort("function"==typeof f?o.call(f,n):void 0),"function"!=typeof e&&(e=d[e]),a.call(e,d,(function(e,r){return c.call(n,e)?a.call(u,l,n[e],e,n,r):t}))}}},function(e,t,n){"use strict";var r,i=n(125),o=n(33),a=n(45),s=n(204),c=Object.defineProperty;r=e.exports=function(e){if(!(this instanceof r))throw new TypeError("Constructor requires 'new'");e=String(e),s.call(this,e),c(this,"__length__",o("",e.length))},i&&i(r,s),delete r.prototype.constructor,r.prototype=Object.create(s.prototype,{_next:o((function(){if(this.__list__)return this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind()})),_resolve:o((function(e){var t,n=this.__list__[e];return this.__nextIndex__===this.__length__?n:(t=n.charCodeAt(0))>=55296&&t<=56319?n+this.__list__[this.__nextIndex__++]:n}))}),c(r.prototype,a.toStringTag,o("c","String Iterator"))},function(e,t,n){"use strict";var r=n(459);e.exports=function(e){if(!r(e))throw new TypeError(e+" is not iterable");return e}},function(e,t,n){"use strict";var r=n(90),i=n(44),o=n(91),a=n(45).iterator,s=Array.isArray;e.exports=function(e){return!(!i(e)||!s(e)&&!o(e)&&!r(e)&&"function"!=typeof e[a])}},function(e,t,n){"use strict";var r=n(90),i=n(69),o=n(91),a=n(202),s=Array.isArray,c=Function.prototype.call,u=Array.prototype.some;e.exports=function(e,t){var n,d,l,f,p,h,m,g,v=arguments[2];if(s(e)||r(e)?n="array":o(e)?n="string":e=a(e),i(t),l=function(){f=!0},"array"!==n)if("string"!==n)for(d=e.next();!d.done;){if(c.call(t,v,d.value,l),f)return;d=e.next()}else for(h=e.length,p=0;p<h&&(m=e[p],p+1<h&&(g=m.charCodeAt(0))>=55296&&g<=56319&&(m+=e[++p]),c.call(t,v,m,l),!f);++p);else u.call(e,(function(e){return c.call(t,v,e,l),f}))}},function(e,t,n){"use strict";e.exports="function"==typeof WeakMap&&"[object WeakMap]"===Object.prototype.toString.call(new WeakMap)},function(e,t,n){var r=n(93),i=n(94),o=n(130),a=n(34),s=n(67),c=n(95),u=Math.min;e.exports=function(e,t,n){for(var d=n?o:i,l=e[0].length,f=e.length,p=f,h=Array(f),m=1/0,g=[];p--;){var v=e[p];p&&t&&(v=a(v,s(t))),m=u(v.length,m),h[p]=!n&&(t||l>=120&&v.length>=120)?new r(p&&v):void 0}v=e[0];var y=-1,b=h[0];e:for(;++y<l&&g.length<m;){var S=v[y],E=t?t(S):S;if(S=n||0!==S?S:0,!(b?c(b,E):d(g,E,n))){for(p=f;--p;){var _=h[p];if(!(_?c(_,E):d(e[p],E,n)))continue e}b&&b.push(E),g.push(S)}}return g}},function(e,t){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t,n){var r=n(206),i=n(466),o=n(467);e.exports=function(e,t,n){return t==t?o(e,t,n):r(e,i,n)}},function(e,t){e.exports=function(e){return e!=e}},function(e,t){e.exports=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}},function(e,t,n){var r=n(131);e.exports=function(e){return r(e)?e:[]}},function(e,t,n){"use strict";(function(t){var r=n(19),i=n(208),o=n(470),a=n(214);function s(e){var t=new o(e),n=i(o.prototype.request,t);return r.extend(n,o.prototype,t),r.extend(n,t),n}var c=s(n(132));c.Axios=o,c.create=function(e){return s(a(c.defaults,e))},c.Cancel=n(215),c.CancelToken=n(484),c.isCancel=n(213),c.all=function(e){return t.all(e)},c.spread=n(485),c.isAxiosError=n(486),e.exports=c,e.exports.default=c}).call(this,n(2))},function(e,t,n){"use strict";(function(t){var r=n(19),i=n(209),o=n(471),a=n(472),s=n(214),c=n(482),u=c.validators;function d(e){this.defaults=e,this.interceptors={request:new o,response:new o}}d.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=s(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var n=e.transitional;void 0!==n&&c.assertOptions(n,{silentJSONParsing:u.transitional(u.boolean,"1.0.0"),forcedJSONParsing:u.transitional(u.boolean,"1.0.0"),clarifyTimeoutError:u.transitional(u.boolean,"1.0.0")},!1);var r=[],i=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(i=i&&t.synchronous,r.unshift(t.fulfilled,t.rejected))}));var o,d=[];if(this.interceptors.response.forEach((function(e){d.push(e.fulfilled,e.rejected)})),!i){var l=[a,void 0];for(Array.prototype.unshift.apply(l,r),l=l.concat(d),o=t.resolve(e);l.length;)o=o.then(l.shift(),l.shift());return o}for(var f=e;r.length;){var p=r.shift(),h=r.shift();try{f=p(f)}catch(e){h(e);break}}try{o=a(f)}catch(e){return t.reject(e)}for(;d.length;)o=o.then(d.shift(),d.shift());return o},d.prototype.getUri=function(e){return e=s(this.defaults,e),i(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){d.prototype[e]=function(t,n){return this.request(s(n||{},{method:e,url:t,data:(n||{}).data}))}})),r.forEach(["post","put","patch"],(function(e){d.prototype[e]=function(t,n,r){return this.request(s(r||{},{method:e,url:t,data:n}))}})),e.exports=d}).call(this,n(2))},function(e,t,n){"use strict";var r=n(19);function i(){this.handlers=[]}i.prototype.use=function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},function(e,t,n){"use strict";(function(t){var r=n(19),i=n(473),o=n(213),a=n(132);function s(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return s(e),e.headers=e.headers||{},e.data=i.call(e,e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||a.adapter)(e).then((function(t){return s(e),t.data=i.call(e,t.data,t.headers,e.transformResponse),t}),(function(n){return o(n)||(s(e),n&&n.response&&(n.response.data=i.call(e,n.response.data,n.response.headers,e.transformResponse))),t.reject(n)}))}}).call(this,n(2))},function(e,t,n){"use strict";var r=n(19),i=n(132);e.exports=function(e,t,n){var o=this||i;return r.forEach(n,(function(n){e=n.call(o,e,t)})),e}},function(e,t,n){"use strict";var r=n(19);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},function(e,t,n){"use strict";var r=n(212);e.exports=function(e,t,n){var i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},function(e,t,n){"use strict";var r=n(19);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,i,o,a){var s=[];s.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),r.isString(i)&&s.push("path="+i),r.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";var r=n(478),i=n(479);e.exports=function(e,t){return e&&!r(t)?i(e,t):t}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var r=n(19),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,o,a={};return e?(r.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=r.trim(e.substr(0,o)).toLowerCase(),n=r.trim(e.substr(o+1)),t){if(a[t]&&i.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([n]):a[t]?a[t]+", "+n:n}})),a):a}},function(e,t,n){"use strict";var r=n(19);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=i(window.location.href),function(t){var n=r.isString(t)?i(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},function(e,t,n){"use strict";var r=n(483),i={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){i[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));var o={},a=r.version.split(".");function s(e,t){for(var n=t?t.split("."):a,r=e.split("."),i=0;i<3;i++){if(n[i]>r[i])return!0;if(n[i]<r[i])return!1}return!1}i.transitional=function(e,t,n){var i=t&&s(t);function a(e,t){return"[Axios v"+r.version+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return function(n,r,s){if(!1===e)throw new Error(a(r," has been removed in "+t));return i&&!o[r]&&(o[r]=!0,console.warn(a(r," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,r,s)}},e.exports={isOlderVersion:s,assertOptions:function(e,t,n){if("object"!=typeof e)throw new TypeError("options must be an object");for(var r=Object.keys(e),i=r.length;i-- >0;){var o=r[i],a=t[o];if(a){var s=e[o],c=void 0===s||a(s,o,e);if(!0!==c)throw new TypeError("option "+o+" must be "+c)}else if(!0!==n)throw Error("Unknown option "+o)}},validators:i}},function(e){e.exports=JSON.parse('{"name":"axios","version":"0.21.4","description":"Promise based HTTP client for the browser and node.js","main":"index.js","scripts":{"test":"grunt test","start":"node ./sandbox/server.js","build":"NODE_ENV=production grunt build","preversion":"npm test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json","postversion":"git push && git push --tags","examples":"node ./examples/server.js","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","fix":"eslint --fix lib/**/*.js"},"repository":{"type":"git","url":"https://github.com/axios/axios.git"},"keywords":["xhr","http","ajax","promise","node"],"author":"Matt Zabriskie","license":"MIT","bugs":{"url":"https://github.com/axios/axios/issues"},"homepage":"https://axios-http.com","devDependencies":{"coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^8.2.1","sinon":"^4.5.0","terser-webpack-plugin":"^4.2.3","typescript":"^4.0.5","url-search-params":"^0.10.0","webpack":"^4.44.2","webpack-dev-server":"^3.11.0"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"jsdelivr":"dist/axios.min.js","unpkg":"dist/axios.min.js","typings":"./index.d.ts","dependencies":{"follow-redirects":"^1.14.0"},"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}]}')},function(e,t,n){"use strict";(function(t){var r=n(215);function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var n;this.promise=new t((function(e){n=e}));var i=this;e((function(e){i.reason||(i.reason=new r(e),n(i.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i}).call(this,n(2))},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,n){"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},function(e,t,n){var r=n(216)("pick",n(48));r.placeholder=n(133),e.exports=r},function(e,t,n){var r=n(489),i=n(133),o=Array.prototype.push;function a(e,t){return 2==t?function(t,n){return e(t,n)}:function(t){return e(t)}}function s(e){for(var t=e?e.length:0,n=Array(t);t--;)n[t]=e[t];return n}function c(e,t){return function(){var n=arguments.length;if(n){for(var r=Array(n);n--;)r[n]=arguments[n];var i=r[0]=t.apply(void 0,r);return e.apply(void 0,r),i}}}e.exports=function e(t,n,u,d){var l="function"==typeof n,f=n===Object(n);if(f&&(d=u,u=n,n=void 0),null==u)throw new TypeError;d||(d={});var p=!("cap"in d)||d.cap,h=!("curry"in d)||d.curry,m=!("fixed"in d)||d.fixed,g=!("immutable"in d)||d.immutable,v=!("rearg"in d)||d.rearg,y=l?u:i,b="curry"in d&&d.curry,S="fixed"in d&&d.fixed,E="rearg"in d&&d.rearg,_=l?u.runInContext():void 0,T=l?u:{ary:t.ary,assign:t.assign,clone:t.clone,curry:t.curry,forEach:t.forEach,isArray:t.isArray,isError:t.isError,isFunction:t.isFunction,isWeakMap:t.isWeakMap,iteratee:t.iteratee,keys:t.keys,rearg:t.rearg,toInteger:t.toInteger,toPath:t.toPath},R=T.ary,I=T.assign,w=T.clone,C=T.curry,O=T.forEach,A=T.isArray,x=T.isError,k=T.isFunction,N=T.isWeakMap,L=T.keys,M=T.rearg,V=T.toInteger,P=T.toPath,D=L(r.aryMethod),Z={castArray:function(e){return function(){var t=arguments[0];return A(t)?e(s(t)):e.apply(void 0,arguments)}},iteratee:function(e){return function(){var t=arguments[0],n=arguments[1],r=e(t,n),i=r.length;return p&&"number"==typeof n?(n=n>2?n-2:1,i&&i<=n?r:a(r,n)):r}},mixin:function(e){return function(t){var n=this;if(!k(n))return e(n,Object(t));var r=[];return O(L(t),(function(e){k(t[e])&&r.push([e,n.prototype[e]])})),e(n,Object(t)),O(r,(function(e){var t=e[1];k(t)?n.prototype[e[0]]=t:delete n.prototype[e[0]]})),n}},nthArg:function(e){return function(t){var n=t<0?1:V(t)+1;return C(e(t),n)}},rearg:function(e){return function(t,n){var r=n?n.length:0;return C(e(t,n),r)}},runInContext:function(n){return function(r){return e(t,n(r),d)}}};function j(e,t){if(p){var n=r.iterateeRearg[e];if(n)return function(e,t){return X(e,(function(e){var n=t.length;return function(e,t){return 2==t?function(t,n){return e.apply(void 0,arguments)}:function(t){return e.apply(void 0,arguments)}}(M(a(e,n),t),n)}))}(t,n);var i=!l&&r.iterateeAry[e];if(i)return function(e,t){return X(e,(function(e){return"function"==typeof e?a(e,t):e}))}(t,i)}return t}function W(e,t,n){if(m&&(S||!r.skipFixed[e])){var i=r.methodSpread[e],a=i&&i.start;return void 0===a?R(t,n):function(e,t){return function(){for(var n=arguments.length,r=n-1,i=Array(n);n--;)i[n]=arguments[n];var a=i[t],s=i.slice(0,t);return a&&o.apply(s,a),t!=r&&o.apply(s,i.slice(t+1)),e.apply(this,s)}}(t,a)}return t}function G(e,t,n){return v&&n>1&&(E||!r.skipRearg[e])?M(t,r.methodRearg[e]||r.aryRearg[n]):t}function F(e,t){for(var n=-1,r=(t=P(t)).length,i=r-1,o=w(Object(e)),a=o;null!=a&&++n<r;){var s=t[n],c=a[s];null==c||k(c)||x(c)||N(c)||(a[s]=w(n==i?c:Object(c))),a=a[s]}return o}function U(t,n){var i=r.aliasToReal[t]||t,o=r.remap[i]||i,a=d;return function(t){var r=l?_:T,s=l?_[o]:n,c=I(I({},a),t);return e(r,i,s,c)}}function X(e,t){return function(){var n=arguments.length;if(!n)return e();for(var r=Array(n);n--;)r[n]=arguments[n];var i=v?0:n-1;return r[i]=t(r[i]),e.apply(void 0,r)}}function B(e,t,n){var i,o=r.aliasToReal[e]||e,a=t,u=Z[o];return u?a=u(t):g&&(r.mutate.array[o]?a=c(t,s):r.mutate.object[o]?a=c(t,function(e){return function(t){return e({},t)}}(t)):r.mutate.set[o]&&(a=c(t,F))),O(D,(function(e){return O(r.aryMethod[e],(function(t){if(o==t){var n=r.methodSpread[o],s=n&&n.afterRearg;return i=s?W(o,G(o,a,e),e):G(o,W(o,a,e),e),i=function(e,t,n){return b||h&&n>1?C(t,n):t}(0,i=j(o,i),e),!1}})),!i})),i||(i=a),i==t&&(i=b?C(i,1):function(){return t.apply(this,arguments)}),i.convert=U(o,t),i.placeholder=t.placeholder=n,i}if(!f)return B(n,u,y);var H=u,Y=[];return O(D,(function(e){O(r.aryMethod[e],(function(e){var t=H[r.remap[e]||e];t&&Y.push([e,B(e,t,H)])}))})),O(L(H),(function(e){var t=H[e];if("function"==typeof t){for(var n=Y.length;n--;)if(Y[n][0]==e)return;t.convert=U(e,t),Y.push([e,t])}})),O(Y,(function(e){H[e[0]]=e[1]})),H.convert=function(e){return H.runInContext.convert(e)(void 0)},H.placeholder=H,O(L(H),(function(e){O(r.realToAlias[e]||[],(function(t){H[t]=H[e]}))})),H}},function(e,t){t.aliasToReal={each:"forEach",eachRight:"forEachRight",entries:"toPairs",entriesIn:"toPairsIn",extend:"assignIn",extendAll:"assignInAll",extendAllWith:"assignInAllWith",extendWith:"assignInWith",first:"head",conforms:"conformsTo",matches:"isMatch",property:"get",__:"placeholder",F:"stubFalse",T:"stubTrue",all:"every",allPass:"overEvery",always:"constant",any:"some",anyPass:"overSome",apply:"spread",assoc:"set",assocPath:"set",complement:"negate",compose:"flowRight",contains:"includes",dissoc:"unset",dissocPath:"unset",dropLast:"dropRight",dropLastWhile:"dropRightWhile",equals:"isEqual",identical:"eq",indexBy:"keyBy",init:"initial",invertObj:"invert",juxt:"over",omitAll:"omit",nAry:"ary",path:"get",pathEq:"matchesProperty",pathOr:"getOr",paths:"at",pickAll:"pick",pipe:"flow",pluck:"map",prop:"get",propEq:"matchesProperty",propOr:"getOr",props:"at",symmetricDifference:"xor",symmetricDifferenceBy:"xorBy",symmetricDifferenceWith:"xorWith",takeLast:"takeRight",takeLastWhile:"takeRightWhile",unapply:"rest",unnest:"flatten",useWith:"overArgs",where:"conformsTo",whereEq:"isMatch",zipObj:"zipObject"},t.aryMethod={1:["assignAll","assignInAll","attempt","castArray","ceil","create","curry","curryRight","defaultsAll","defaultsDeepAll","floor","flow","flowRight","fromPairs","invert","iteratee","memoize","method","mergeAll","methodOf","mixin","nthArg","over","overEvery","overSome","rest","reverse","round","runInContext","spread","template","trim","trimEnd","trimStart","uniqueId","words","zipAll"],2:["add","after","ary","assign","assignAllWith","assignIn","assignInAllWith","at","before","bind","bindAll","bindKey","chunk","cloneDeepWith","cloneWith","concat","conformsTo","countBy","curryN","curryRightN","debounce","defaults","defaultsDeep","defaultTo","delay","difference","divide","drop","dropRight","dropRightWhile","dropWhile","endsWith","eq","every","filter","find","findIndex","findKey","findLast","findLastIndex","findLastKey","flatMap","flatMapDeep","flattenDepth","forEach","forEachRight","forIn","forInRight","forOwn","forOwnRight","get","groupBy","gt","gte","has","hasIn","includes","indexOf","intersection","invertBy","invoke","invokeMap","isEqual","isMatch","join","keyBy","lastIndexOf","lt","lte","map","mapKeys","mapValues","matchesProperty","maxBy","meanBy","merge","mergeAllWith","minBy","multiply","nth","omit","omitBy","overArgs","pad","padEnd","padStart","parseInt","partial","partialRight","partition","pick","pickBy","propertyOf","pull","pullAll","pullAt","random","range","rangeRight","rearg","reject","remove","repeat","restFrom","result","sampleSize","some","sortBy","sortedIndex","sortedIndexOf","sortedLastIndex","sortedLastIndexOf","sortedUniqBy","split","spreadFrom","startsWith","subtract","sumBy","take","takeRight","takeRightWhile","takeWhile","tap","throttle","thru","times","trimChars","trimCharsEnd","trimCharsStart","truncate","union","uniqBy","uniqWith","unset","unzipWith","without","wrap","xor","zip","zipObject","zipObjectDeep"],3:["assignInWith","assignWith","clamp","differenceBy","differenceWith","findFrom","findIndexFrom","findLastFrom","findLastIndexFrom","getOr","includesFrom","indexOfFrom","inRange","intersectionBy","intersectionWith","invokeArgs","invokeArgsMap","isEqualWith","isMatchWith","flatMapDepth","lastIndexOfFrom","mergeWith","orderBy","padChars","padCharsEnd","padCharsStart","pullAllBy","pullAllWith","rangeStep","rangeStepRight","reduce","reduceRight","replace","set","slice","sortedIndexBy","sortedLastIndexBy","transform","unionBy","unionWith","update","xorBy","xorWith","zipWith"],4:["fill","setWith","updateWith"]},t.aryRearg={2:[1,0],3:[2,0,1],4:[3,2,0,1]},t.iterateeAry={dropRightWhile:1,dropWhile:1,every:1,filter:1,find:1,findFrom:1,findIndex:1,findIndexFrom:1,findKey:1,findLast:1,findLastFrom:1,findLastIndex:1,findLastIndexFrom:1,findLastKey:1,flatMap:1,flatMapDeep:1,flatMapDepth:1,forEach:1,forEachRight:1,forIn:1,forInRight:1,forOwn:1,forOwnRight:1,map:1,mapKeys:1,mapValues:1,partition:1,reduce:2,reduceRight:2,reject:1,remove:1,some:1,takeRightWhile:1,takeWhile:1,times:1,transform:2},t.iterateeRearg={mapKeys:[1],reduceRight:[1,0]},t.methodRearg={assignInAllWith:[1,0],assignInWith:[1,2,0],assignAllWith:[1,0],assignWith:[1,2,0],differenceBy:[1,2,0],differenceWith:[1,2,0],getOr:[2,1,0],intersectionBy:[1,2,0],intersectionWith:[1,2,0],isEqualWith:[1,2,0],isMatchWith:[2,1,0],mergeAllWith:[1,0],mergeWith:[1,2,0],padChars:[2,1,0],padCharsEnd:[2,1,0],padCharsStart:[2,1,0],pullAllBy:[2,1,0],pullAllWith:[2,1,0],rangeStep:[1,2,0],rangeStepRight:[1,2,0],setWith:[3,1,2,0],sortedIndexBy:[2,1,0],sortedLastIndexBy:[2,1,0],unionBy:[1,2,0],unionWith:[1,2,0],updateWith:[3,1,2,0],xorBy:[1,2,0],xorWith:[1,2,0],zipWith:[1,2,0]},t.methodSpread={assignAll:{start:0},assignAllWith:{start:0},assignInAll:{start:0},assignInAllWith:{start:0},defaultsAll:{start:0},defaultsDeepAll:{start:0},invokeArgs:{start:2},invokeArgsMap:{start:2},mergeAll:{start:0},mergeAllWith:{start:0},partial:{start:1},partialRight:{start:1},without:{start:1},zipAll:{start:0}},t.mutate={array:{fill:!0,pull:!0,pullAll:!0,pullAllBy:!0,pullAllWith:!0,pullAt:!0,remove:!0,reverse:!0},object:{assign:!0,assignAll:!0,assignAllWith:!0,assignIn:!0,assignInAll:!0,assignInAllWith:!0,assignInWith:!0,assignWith:!0,defaults:!0,defaultsAll:!0,defaultsDeep:!0,defaultsDeepAll:!0,merge:!0,mergeAll:!0,mergeAllWith:!0,mergeWith:!0},set:{set:!0,setWith:!0,unset:!0,update:!0,updateWith:!0}},t.realToAlias=function(){var e=Object.prototype.hasOwnProperty,n=t.aliasToReal,r={};for(var i in n){var o=n[i];e.call(r,o)?r[o].push(i):r[o]=[i]}return r}(),t.remap={assignAll:"assign",assignAllWith:"assignWith",assignInAll:"assignIn",assignInAllWith:"assignInWith",curryN:"curry",curryRightN:"curryRight",defaultsAll:"defaults",defaultsDeepAll:"defaultsDeep",findFrom:"find",findIndexFrom:"findIndex",findLastFrom:"findLast",findLastIndexFrom:"findLastIndex",getOr:"get",includesFrom:"includes",indexOfFrom:"indexOf",invokeArgs:"invoke",invokeArgsMap:"invokeMap",lastIndexOfFrom:"lastIndexOf",mergeAll:"merge",mergeAllWith:"mergeWith",padChars:"pad",padCharsEnd:"padEnd",padCharsStart:"padStart",propertyOf:"get",rangeStep:"range",rangeStepRight:"rangeRight",restFrom:"rest",spreadFrom:"spread",trimChars:"trim",trimCharsEnd:"trimEnd",trimCharsStart:"trimStart",zipAll:"zip"},t.skipFixed={castArray:!0,flow:!0,flowRight:!0,iteratee:!0,mixin:!0,rearg:!0,runInContext:!0},t.skipRearg={add:!0,assign:!0,assignIn:!0,bind:!0,bindKey:!0,concat:!0,difference:!0,divide:!0,eq:!0,gt:!0,gte:!0,isEqual:!0,lt:!0,lte:!0,matchesProperty:!0,merge:!0,multiply:!0,overArgs:!0,partial:!0,partialRight:!0,propertyOf:!0,random:!0,range:!0,rangeRight:!0,subtract:!0,zip:!0,zipObject:!0,zipObjectDeep:!0}},function(e,t,n){e.exports={ary:n(491),assign:n(177),clone:n(38),curry:n(509),forEach:n(113),isArray:n(12),isError:n(510),isFunction:n(17),isWeakMap:n(511),iteratee:n(512),keys:n(116),rearg:n(527),toInteger:n(97),toPath:n(530)}},function(e,t,n){var r=n(134);e.exports=function(e,t,n){return t=n?void 0:t,t=e&&null==t?e.length:t,r(e,128,void 0,void 0,void 0,void 0,t)}},function(e,t,n){var r=n(96),i=n(15);e.exports=function(e,t,n){var o=1&t,a=r(e);return function t(){var r=this&&this!==i&&this instanceof t?a:e;return r.apply(o?n:this,arguments)}}},function(e,t,n){var r=n(122),i=n(96),o=n(219),a=n(222),s=n(228),c=n(137),u=n(15);e.exports=function(e,t,n){var d=i(e);return function i(){for(var l=arguments.length,f=Array(l),p=l,h=s(i);p--;)f[p]=arguments[p];var m=l<3&&f[0]!==h&&f[l-1]!==h?[]:c(f,h);if((l-=m.length)<n)return a(e,t,o,i.placeholder,void 0,f,m,void 0,void 0,n-l);var g=this&&this!==u&&this instanceof i?d:e;return r(g,this,f)}}},function(e,t){e.exports=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}},function(e,t,n){var r=n(135),i=n(223),o=n(496),a=n(498);e.exports=function(e){var t=o(e),n=a[t];if("function"!=typeof n||!(t in r.prototype))return!1;if(e===n)return!0;var s=i(n);return!!s&&e===s[0]}},function(e,t,n){var r=n(497),i=Object.prototype.hasOwnProperty;e.exports=function(e){for(var t=e.name+"",n=r[t],o=i.call(r,t)?n.length:0;o--;){var a=n[o],s=a.func;if(null==s||s==e)return a.name}return t}},function(e,t){e.exports={}},function(e,t,n){var r=n(135),i=n(225),o=n(136),a=n(12),s=n(18),c=n(499),u=Object.prototype.hasOwnProperty;function d(e){if(s(e)&&!a(e)&&!(e instanceof r)){if(e instanceof i)return e;if(u.call(e,"__wrapped__"))return c(e)}return new i(e)}d.prototype=o.prototype,d.prototype.constructor=d,e.exports=d},function(e,t,n){var r=n(135),i=n(225),o=n(55);e.exports=function(e){if(e instanceof r)return e.clone();var t=new i(e.__wrapped__,e.__chain__);return t.__actions__=o(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}},function(e,t){var n=/\{\n\/\* \[wrapped with (.+)\] \*/,r=/,? & /;e.exports=function(e){var t=e.match(n);return t?t[1].split(r):[]}},function(e,t){var n=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;e.exports=function(e,t){var r=t.length;if(!r)return e;var i=r-1;return t[i]=(r>1?"& ":"")+t[i],t=t.join(r>2?", ":" "),e.replace(n,"{\n/* [wrapped with "+t+"] */\n")}},function(e,t,n){var r=n(113),i=n(94),o=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];e.exports=function(e,t){return r(o,(function(n){var r="_."+n[0];t&n[1]&&!i(e,r)&&e.push(r)})),e.sort()}},function(e,t,n){var r=n(55),i=n(66),o=Math.min;e.exports=function(e,t){for(var n=e.length,a=o(t.length,n),s=r(e);a--;){var c=t[a];e[a]=i(c,n)?s[c]:void 0}return e}},function(e,t,n){var r=n(122),i=n(96),o=n(15);e.exports=function(e,t,n,a){var s=1&t,c=i(e);return function t(){for(var i=-1,u=arguments.length,d=-1,l=a.length,f=Array(l+u),p=this&&this!==o&&this instanceof t?c:e;++d<l;)f[d]=a[d];for(;u--;)f[d++]=arguments[++i];return r(p,s?n:this,f)}}},function(e,t,n){var r=n(220),i=n(221),o=n(137),a=Math.min;e.exports=function(e,t){var n=e[1],s=t[1],c=n|s,u=c<131,d=128==s&&8==n||128==s&&256==n&&e[7].length<=t[8]||384==s&&t[7].length<=t[8]&&8==n;if(!u&&!d)return e;1&s&&(e[2]=t[2],c|=1&n?0:4);var l=t[3];if(l){var f=e[3];e[3]=f?r(f,l,t[4]):l,e[4]=f?o(e[3],"__lodash_placeholder__"):t[4]}return(l=t[5])&&(f=e[5],e[5]=f?i(f,l,t[6]):l,e[6]=f?o(e[5],"__lodash_placeholder__"):t[6]),(l=t[7])&&(e[7]=l),128&s&&(e[8]=null==e[8]?t[8]:a(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=c,e}},function(e,t,n){var r=n(229);e.exports=function(e){return e?(e=r(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},function(e,t,n){var r=n(508),i=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(i,""):e}},function(e,t){var n=/\s/;e.exports=function(e){for(var t=e.length;t--&&n.test(e.charAt(t)););return t}},function(e,t,n){var r=n(134);function i(e,t,n){var o=r(e,8,void 0,void 0,void 0,void 0,void 0,t=n?void 0:t);return o.placeholder=i.placeholder,o}i.placeholder={},e.exports=i},function(e,t,n){var r=n(30),i=n(18),o=n(138);e.exports=function(e){if(!i(e))return!1;var t=r(e);return"[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!o(e)}},function(e,t,n){var r=n(42),i=n(18);e.exports=function(e){return i(e)&&"[object WeakMap]"==r(e)}},function(e,t,n){var r=n(78),i=n(36);e.exports=function(e){return i("function"==typeof e?e:r(e,1))}},function(e,t,n){var r=n(514),i=n(518),o=n(235);e.exports=function(e){var t=i(e);return 1==t.length&&t[0][2]?o(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}},function(e,t,n){var r=n(79),i=n(230);e.exports=function(e,t,n,o){var a=n.length,s=a,c=!o;if(null==e)return!s;for(e=Object(e);a--;){var u=n[a];if(c&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++a<s;){var d=(u=n[a])[0],l=e[d],f=u[1];if(c&&u[2]){if(void 0===l&&!(d in e))return!1}else{var p=new r;if(o)var h=o(l,f,d,e,t,p);if(!(void 0===h?i(f,l,3,o,p):h))return!1}}return!0}},function(e,t,n){var r=n(79),i=n(231),o=n(516),a=n(517),s=n(42),c=n(12),u=n(65),d=n(86),l="[object Object]",f=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,p,h,m){var g=c(e),v=c(t),y=g?"[object Array]":s(e),b=v?"[object Array]":s(t),S=(y="[object Arguments]"==y?l:y)==l,E=(b="[object Arguments]"==b?l:b)==l,_=y==b;if(_&&u(e)){if(!u(t))return!1;g=!0,S=!1}if(_&&!S)return m||(m=new r),g||d(e)?i(e,t,n,p,h,m):o(e,t,y,n,p,h,m);if(!(1&n)){var T=S&&f.call(e,"__wrapped__"),R=E&&f.call(t,"__wrapped__");if(T||R){var I=T?e.value():e,w=R?t.value():t;return m||(m=new r),h(I,w,n,p,m)}}return!!_&&(m||(m=new r),a(e,t,n,p,h,m))}},function(e,t,n){var r=n(40),i=n(188),o=n(53),a=n(231),s=n(233),c=n(98),u=r?r.prototype:void 0,d=u?u.valueOf:void 0;e.exports=function(e,t,n,r,u,l,f){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!l(new i(e),new i(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var p=s;case"[object Set]":var h=1&r;if(p||(p=c),e.size!=t.size&&!h)return!1;var m=f.get(e);if(m)return m==t;r|=2,f.set(e,t);var g=a(p(e),p(t),r,u,l,f);return f.delete(e),g;case"[object Symbol]":if(d)return d.call(e)==d.call(t)}return!1}},function(e,t,n){var r=n(183),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,o,a,s){var c=1&n,u=r(e),d=u.length;if(d!=r(t).length&&!c)return!1;for(var l=d;l--;){var f=u[l];if(!(c?f in t:i.call(t,f)))return!1}var p=s.get(e),h=s.get(t);if(p&&h)return p==t&&h==e;var m=!0;s.set(e,t),s.set(t,e);for(var g=c;++l<d;){var v=e[f=u[l]],y=t[f];if(o)var b=c?o(y,v,f,t,e,s):o(v,y,f,e,t,s);if(!(void 0===b?v===y||a(v,y,n,o,s):b)){m=!1;break}g||(g="constructor"==f)}if(m&&!g){var S=e.constructor,E=t.constructor;S==E||!("constructor"in e)||!("constructor"in t)||"function"==typeof S&&S instanceof S&&"function"==typeof E&&E instanceof E||(m=!1)}return s.delete(e),s.delete(t),m}},function(e,t,n){var r=n(234),i=n(31);e.exports=function(e){for(var t=i(e),n=t.length;n--;){var o=t[n],a=e[o];t[n]=[o,a,r(a)]}return t}},function(e,t,n){var r=n(230),i=n(58),o=n(237),a=n(139),s=n(234),c=n(235),u=n(47);e.exports=function(e,t){return a(e)&&s(t)?c(u(e),t):function(n){var a=i(n,e);return void 0===a&&a===t?o(n,e):r(t,a,3)}}},function(e,t,n){var r=n(191);e.exports=function(e){var t=r(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}},function(e,t,n){var r=n(40),i=n(34),o=n(12),a=n(70),s=r?r.prototype:void 0,c=s?s.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(o(t))return i(t,e)+"";if(a(t))return c?c.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}},function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},function(e,t,n){var r=n(59),i=n(64),o=n(12),a=n(66),s=n(114),c=n(47);e.exports=function(e,t,n){for(var u=-1,d=(t=r(t,e)).length,l=!1;++u<d;){var f=c(t[u]);if(!(l=null!=e&&n(e,f)))break;e=e[f]}return l||++u!=d?l:!!(d=null==e?0:e.length)&&s(d)&&a(f,d)&&(o(e)||i(e))}},function(e,t,n){var r=n(525),i=n(526),o=n(139),a=n(47);e.exports=function(e){return o(e)?r(a(e)):i(e)}},function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},function(e,t,n){var r=n(99);e.exports=function(e){return function(t){return r(t,e)}}},function(e,t,n){var r=n(134),i=n(140),o=i((function(e,t){return r(e,256,void 0,void 0,void 0,t)}));e.exports=o},function(e,t,n){var r=n(238);e.exports=function(e){return null!=e&&e.length?r(e,1):[]}},function(e,t,n){var r=n(40),i=n(64),o=n(12),a=r?r.isConcatSpreadable:void 0;e.exports=function(e){return o(e)||i(e)||!!(a&&e&&e[a])}},function(e,t,n){var r=n(34),i=n(55),o=n(12),a=n(70),s=n(236),c=n(47),u=n(60);e.exports=function(e){return o(e)?r(e,c):a(e)?[e]:i(s(u(e)))}},function(e,t,n){var r=n(532),i=n(237);e.exports=function(e,t){return r(e,t,(function(t,n){return i(e,n)}))}},function(e,t,n){var r=n(99),i=n(533),o=n(59);e.exports=function(e,t,n){for(var a=-1,s=t.length,c={};++a<s;){var u=t[a],d=r(e,u);n(d,u)&&i(c,o(u,e),d)}return c}},function(e,t,n){var r=n(84),i=n(59),o=n(66),a=n(11),s=n(47);e.exports=function(e,t,n,c){if(!a(e))return e;for(var u=-1,d=(t=i(t,e)).length,l=d-1,f=e;null!=f&&++u<d;){var p=s(t[u]),h=n;if("__proto__"===p||"constructor"===p||"prototype"===p)return e;if(u!=l){var m=f[p];void 0===(h=c?c(m,p,f):void 0)&&(h=a(m)?m:o(t[u+1])?[]:{})}r(f,p,h),f=f[p]}return e}},function(e,t,n){var r=n(216)("mapKeys",n(535));r.placeholder=n(133),e.exports=r},function(e,t,n){var r=n(63),i=n(100),o=n(36);e.exports=function(e,t){var n={};return t=o(t,3),i(e,(function(e,i,o){r(n,t(e,i,o),e)})),n}},function(e,t){e.exports=function(e){return function(t,n,r){for(var i=-1,o=Object(t),a=r(t),s=a.length;s--;){var c=a[e?s:++i];if(!1===n(o[c],c,o))break}return t}}},function(e,t,n){(function(e){var r;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(i){t&&t.nodeType,e&&e.nodeType;var o="object"==typeof(void 0!==typeof window?window:global)&&(void 0!==typeof window?window:global);o.global!==o&&o.window!==o&&o.self;var a,s=2147483647,c=/^xn--/,u=/[^\x20-\x7E]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,l={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,p=String.fromCharCode;function h(e){throw new RangeError(l[e])}function m(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function g(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+m((e=e.replace(d,".")).split("."),t).join(".")}function v(e){for(var t,n,r=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}function y(e){return m(e,(function(e){var t="";return e>65535&&(t+=p((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=p(e)})).join("")}function b(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function S(e,t,n){var r=0;for(e=n?f(e/700):e>>1,e+=f(e/t);e>455;r+=36)e=f(e/35);return f(r+36*e/(e+38))}function E(e){var t,n,r,i,o,a,c,u,d,l,p,m=[],g=e.length,v=0,b=128,E=72;for((n=e.lastIndexOf("-"))<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&h("not-basic"),m.push(e.charCodeAt(r));for(i=n>0?n+1:0;i<g;){for(o=v,a=1,c=36;i>=g&&h("invalid-input"),((u=(p=e.charCodeAt(i++))-48<10?p-22:p-65<26?p-65:p-97<26?p-97:36)>=36||u>f((s-v)/a))&&h("overflow"),v+=u*a,!(u<(d=c<=E?1:c>=E+26?26:c-E));c+=36)a>f(s/(l=36-d))&&h("overflow"),a*=l;E=S(v-o,t=m.length+1,0==o),f(v/t)>s-b&&h("overflow"),b+=f(v/t),v%=t,m.splice(v++,0,b)}return y(m)}function _(e){var t,n,r,i,o,a,c,u,d,l,m,g,y,E,_,T=[];for(g=(e=v(e)).length,t=128,n=0,o=72,a=0;a<g;++a)(m=e[a])<128&&T.push(p(m));for(r=i=T.length,i&&T.push("-");r<g;){for(c=s,a=0;a<g;++a)(m=e[a])>=t&&m<c&&(c=m);for(c-t>f((s-n)/(y=r+1))&&h("overflow"),n+=(c-t)*y,t=c,a=0;a<g;++a)if((m=e[a])<t&&++n>s&&h("overflow"),m==t){for(u=n,d=36;!(u<(l=d<=o?1:d>=o+26?26:d-o));d+=36)_=u-l,E=36-l,T.push(p(b(l+_%E,0))),u=f(_/E);T.push(p(b(u,0))),o=S(n,y,r==i),n=0,++r}++n,++t}return T.join("")}a={version:"1.4.1",ucs2:{decode:v,encode:y},decode:E,encode:_,toASCII:function(e){return g(e,(function(e){return u.test(e)?"xn--"+_(e):e}))},toUnicode:function(e){return g(e,(function(e){return c.test(e)?E(e.slice(4).toLowerCase()):e}))}},void 0===(r=function(){return a}.call(t,n,t,e))||(e.exports=r)}()}).call(this,n(85)(e))},function(e,t,n){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,n){"use strict";t.decode=t.parse=n(540),t.encode=t.stringify=n(541)},function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,o){t=t||"&",n=n||"=";var a={};if("string"!=typeof e||0===e.length)return a;var s=/\+/g;e=e.split(t);var c=1e3;o&&"number"==typeof o.maxKeys&&(c=o.maxKeys);var u=e.length;c>0&&u>c&&(u=c);for(var d=0;d<u;++d){var l,f,p,h,m=e[d].replace(s,"%20"),g=m.indexOf(n);g>=0?(l=m.substr(0,g),f=m.substr(g+1)):(l=m,f=""),p=decodeURIComponent(l),h=decodeURIComponent(f),r(a,p)?i(a[p])?a[p].push(h):a[p]=[a[p],h]:a[p]=h}return a};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,s){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?o(a(e),(function(a){var s=encodeURIComponent(r(a))+n;return i(e[a])?o(e[a],(function(e){return s+encodeURIComponent(r(e))})).join(t):s+encodeURIComponent(r(e[a]))})).join(t):s?encodeURIComponent(r(s))+n+encodeURIComponent(r(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function o(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var a=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},function(e,t,n){var r=function(){return this||"object"==typeof self&&self}()||Function("return this")(),i=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,o=i&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,e.exports=n(543),i)r.regeneratorRuntime=o;else try{delete r.regeneratorRuntime}catch(e){r.regeneratorRuntime=void 0}},function(e,t,n){(function(t){!function(n){"use strict";var r=Object.prototype,i=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag",u="object"==typeof e,d=n.regeneratorRuntime;if(d)u&&(e.exports=d);else{(d=n.regeneratorRuntime=u?e.exports:{}).wrap=g;var l={},f={};f[a]=function(){return this};var p=Object.getPrototypeOf,h=p&&p(p(C([])));h&&h!==r&&i.call(h,a)&&(f=h);var m=S.prototype=y.prototype=Object.create(f);b.prototype=m.constructor=S,S.constructor=b,S[c]=b.displayName="GeneratorFunction",d.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},d.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,c in e||(e[c]="GeneratorFunction")),e.prototype=Object.create(m),e},d.awrap=function(e){return{__await:e}},E(_.prototype),_.prototype[s]=function(){return this},d.AsyncIterator=_,d.async=function(e,t,n,r){var i=new _(g(e,t,n,r));return d.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(m),m[c]="Generator",m[a]=function(){return this},m.toString=function(){return"[object Generator]"},d.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},d.values=C,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var s=i.call(o,"catchLoc"),c=i.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;I(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:C(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}}}function g(e,t,n,r){var i=t&&t.prototype instanceof y?t:y,o=Object.create(i.prototype),a=new w(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=T(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=v(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===l)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(e,n,a),o}function v(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function y(){}function b(){}function S(){}function E(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function _(e){var n;this._invoke=function(r,o){function a(){return new t((function(n,a){!function n(r,o,a,s){var c=v(e[r],e,o);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==typeof d&&i.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}(r,o,n,a)}))}return n=n?n.then(a,a):a()}}function T(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,T(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=v(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,l;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function R(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(R,this),this.reset(!0)}function C(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:O}}function O(){return{value:void 0,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())}).call(this,n(2))},function(e,t,n){var r,i,o=n(242),a=n(243),s=0,c=0;e.exports=function(e,t,n){var u=t&&n||0,d=t||[],l=(e=e||{}).node||r,f=void 0!==e.clockseq?e.clockseq:i;if(null==l||null==f){var p=o();null==l&&(l=r=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==f&&(f=i=16383&(p[6]<<8|p[7]))}var h=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:c+1,g=h-s+(m-c)/1e4;if(g<0&&void 0===e.clockseq&&(f=f+1&16383),(g<0||h>s)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=h,c=m,i=f;var v=(1e4*(268435455&(h+=122192928e5))+m)%4294967296;d[u++]=v>>>24&255,d[u++]=v>>>16&255,d[u++]=v>>>8&255,d[u++]=255&v;var y=h/4294967296*1e4&268435455;d[u++]=y>>>8&255,d[u++]=255&y,d[u++]=y>>>24&15|16,d[u++]=y>>>16&255,d[u++]=f>>>8|128,d[u++]=255&f;for(var b=0;b<6;++b)d[u+b]=l[b];return t||a(d)}},function(e,t,n){var r=n(242),i=n(243);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[o+s]=a[s];return t||i(a)}},function(e,t,n){"use strict";const r=n(9),i=n(0)("analytics"),o=n(547),a=n(16),s=n(244),c=n(101).prependProxyToUrlIfNeeded,u=n(102).getProxyUrl,d=a(),l=new o;e.exports=function(e){var t=this;let n=e.loggingUrl,o=e.queue,a=void 0===o?l:o,f=e.ajax,p=void 0===f?s:f;this.loggingUrl=n,this.updateEndPoints=()=>{if(!this.proxyUrl){this.proxyUrl=u();const e=c(this.loggingUrl,this.proxyUrl);this.loggingUrl=e}this.endPoint=this.loggingUrl+"/logging/ClientEvent",this.endPointQos=this.loggingUrl+"/logging/ClientQos"},this.updateEndPoints();const h={};this.logError=function(e,n,i,o,a){void 0===o&&(o=null),void 0===a&&(a={});const s=a.partnerId;if(((e,t,n)=>{if(!n)return!1;const r=[n,t,e].join("_");return(h[r]||0)>=100})(e,n,s))return;const c=[s,n,e].join("_"),u=o;h[c]=void 0!==h[c]?h[c]+1:1,t.logEvent(r(a,{action:`${n}.${e}`,payload:u}),!1)},this.logEvent=function(e,n,r,o){void 0===n&&(n=!1),void 0===o&&(o=()=>{}),t.updateEndPoints();const s=Object.assign({},e,{clientInstanceId:d});if(r&&!isNaN(r)&&Math.random()>r)return void i.debug("skipping sending analytics due to throttle:",s);let c;i.debug("queueing analytics:",t.loggingUrl,s);try{c=JSON.stringify(s)}catch(e){return void o(e)}!function(e,n,r){void 0===n&&(n=()=>{}),a.add(o=>{i.debug("sending analytics:",t.loggingUrl,e),p.post(r?t.endPointQos:t.endPoint,{body:e,overrideMimeType:"text/plain",headers:{Accept:"text/plain","Content-Type":"application/json"}},e=>{e&&i.debug("Failed to send ClientEvent, moving on to the next item."),n(e||void 0),o()})})}(c,o,n)},this.logQOS=e=>this.logEvent(e,!0)}},function(e,t,n){"use strict";let r=function(){function e(e){let t=(void 0===e?{}:e).waitTime,n=void 0===t?50:t;this.queue=[],this.running=!1,this.waitTime=n}var t=e.prototype;return t.add=function(e){this.queue.push(e),this.run()},t.run=function(){if(this.running)return;this.running=!0;const e=()=>{0!==this.queue.length?this.queue.shift()(()=>{setTimeout(e,this.waitTime)}):this.running=!1};e()},e}();e.exports=r},function(e,t,n){"use strict";const r=n(11),i={for:"htmlFor",class:"className"};e.exports=function(e){e.prototype.attr=function(e,t){if(r(e)){let t;Object.keys(e).forEach(n=>{t=i[n]||n,this.first.setAttribute(t,e[n])})}else{if(void 0===t)return this.first.getAttribute(i[e]||e);this.first.setAttribute(i[e]||e,t)}return this},e.prototype.removeAttr=function(e){const t=i[e]||e;return this.forEach(e=>{e.removeAttribute(t)}),this},e.prototype.html=function(e){return void 0!==e&&(this.first.innerHTML=e),this.first.innerHTML},e.prototype.center=function(t,n){let r;return this.forEach(i=>{r=new e(i),t=t||parseInt(r.width(),10),n=n||parseInt(r.height(),10);const o=-.5*t+"px",a=-.5*n+"px";r.css("margin",`${a} 0 0 ${o}`).addClass("OT_centered")}),this},e._attachToOTHelpers.centerElement=function(t,n,r){return new e(t).center(n,r)};const t=function(t){return t.offsetWidth>0?t.offsetWidth+"px":new e(t).css("width")},n=function(t){return t.offsetHeight>0?t.offsetHeight+"px":new e(t).css("height")};e.prototype.width=function(e){return e?(this.css("width",e),this):this.isDisplayNone()?this.makeVisibleAndYield(e=>t(e))[0]:t(this.get(0))},e._attachToOTHelpers.width=function(t,n){const r=new e(t).width(n);return n?e._attachToOTHelpers:r},e.prototype.height=function(e){return e?(this.css("height",e),this):this.isDisplayNone()?this.makeVisibleAndYield(e=>n(e))[0]:n(this.get(0))},e._attachToOTHelpers.height=function(t,n){const r=new e(t).height(n);return n?e._attachToOTHelpers:r}}},function(e,t,n){"use strict";const r=n(3),i=(void 0!==typeof window?window:global).getComputedStyle,o={Firefox:"moz",Opera:"O",Chrome:"Webkit",Safari:"Webkit"};e.exports=function(e,t){const n={},a={},s=function(e,t){if(t in e.style)return t;const n=o[r.name]+t[0].toUpperCase()+t.slice(1);return n in e.style?n:t};e.prototype.show=function(){return this.forEach(t=>{const r=t.style.display;""!==r&&"none"!==r||(t.style.display=n[t]||"",delete n[t]),function(e){return"none"===i(e).getPropertyValue("display")}(t)&&(n[t]="none",t.style.display=function(t){if(a[t.ownerDocument]&&a[t.ownerDocument][t.nodeName])return a[t.ownerDocument][t.nodeName];a[t.ownerDocument]||(a[t.ownerDocument]={});let n,r=t.ownerDocument.createElement(t.nodeName);return t.ownerDocument.body.appendChild(r),n=new e(r).css("display"),a[t.ownerDocument][t.nodeName]=n,new e(r).remove(),r=null,n}(t))})},e.prototype.hide=function(){return this.forEach(e=>{"none"!==e.style.display&&(n[e]=e.style.display,e.style.display="none")})},e.prototype.css=function(e,t){if(0!==this.length)return"string"!=typeof e?this.forEach(t=>{!function(e,t){const n=e.style;for(const r in t)t.hasOwnProperty(r)&&(n[s(e,r)]=t[r])}(t,e)}):void 0!==t?this.forEach(n=>{!function(e,t,n){e.style[s(e,t)]=n}(n,e,t)}):function(e,t){const n=s(e,t);let r=i(e).getPropertyValue(n);return""===r&&(r=e.style[n]),r}(this.first,e)},e.prototype.makeVisibleAndYield=function(n){const r={display:"block",visibility:"hidden"},i=[];return this.forEach(o=>{const a=t(o);a?i.push(function(t,n,r){const i=new e(t),o={};let a,s;for(a in n)n.hasOwnProperty(a)&&(o[a]=t.style[a],i.css(a,n[a]));for(a in s=r(t),n)n.hasOwnProperty(a)&&i.css(a,o[a]||"");return s}(a,r,n)):i.push(void 0)}),i}}},function(e,t,n){"use strict";(function(t){const r=n(551),i=r.isiPhone,o=r.isiPad,a=r.isiOS,s=n(552),c=n(553),u=e=>{var t,n;return(null==(n=e=e||(null==(t=void 0!==typeof window?window:global)?void 0:t.navigator))?void 0:n.userAgent.toLowerCase().indexOf("electron"))>=0},d=()=>{var e,t,n;return"string"==typeof(null==(e=void 0!==typeof window?window:global)||null==(t=e.process)||null==(n=t.versions)?void 0:n.node)&&!u()};let l;e.exports={parse:e=>(l={version:-1,name:"unknown"},d()?(l.name="Node",l.isNode=!0,l.version=parseInt(t.versions.node,10),l.userAgent=`${l.name} ${l.version}`):(e=>{if(e=e||(void 0!==typeof window?window:global).navigator,l.userAgent=e.userAgent.toLowerCase(),l.name="unknown",l.userAgent.indexOf("opera")>-1||l.userAgent.indexOf("opr/")>-1)l.name="Opera",l.isOpera=!0,null!==/opr\/([0-9]{1,}[.0-9]{0,})/.exec(l.userAgent)&&(l.version=parseFloat(RegExp.$1));else if(l.userAgent.indexOf("firefox")>-1)l.name="Firefox",l.isFirefox=!0,null!==/firefox\/([0-9]{1,}[.0-9]{0,})/.exec(l.userAgent)&&(l.version=parseFloat(RegExp.$1));else if(l.userAgent.match(/edge?\/(\d+)(?:\.\d+)+$/)){l.name="Edge",l.isEdge=!0;const e=RegExp.$1;l.version=parseInt(e,10)}else l.userAgent.indexOf("chrome")>-1?(l.name="Chrome",l.isElectron=u(e),l.isElectron?l.electronVersion=c(e.userAgent):l.isChrome=!0,null!==/chrome\/([0-9]{1,}[.0-9]{0,})/.exec(l.userAgent)&&(l.version=parseFloat(RegExp.$1))):e.vendor&&e.vendor.toLowerCase().indexOf("apple")>-1?(l.name="Safari",l.isSafari=!0,l.isiPhone=i(e.userAgent),l.isiPad=o(e.userAgent),l.isiOS=a(e.userAgent),l.isiOS&&(l.iOSVersion=s(e.userAgent)),(null!==/version\/([0-9]{1,}[.0-9]{0,})/.exec(l.userAgent)||null!==/fxios\/([0-9]{1,}[.0-9]{0,})/.exec(l.userAgent)||null!==/crios\/([0-9]{1,}[.0-9]{0,})/.exec(l.userAgent))&&(l.version=parseFloat(RegExp.$1))):l.userAgent.indexOf("applewebkit")>-1&&-1===l.userAgent.indexOf("version")&&(l.isIosWebView=!0);l.isChromiumEdge="Edge"===l.name&&l.version>=79,l.isLegacyEdge="Edge"===l.name&&l.version<79,l.isLegacyElectron=l.isElectron&&l.electronVersion<16,l.isLegacyChrome=l.isChrome&&l.version<87,l.isLegacyFirefox=l.isFirefox&&l.version<=98,l.isChromium=!!(l.isChrome||l.isChromiumEdge||l.isElectron||l.isOpera),l.isAndroid=l.userAgent.indexOf("android")>-1,l.userAgent=e.userAgent,l.protocol=location.protocol,l.hostName=location.hostName,(-1===l.version||"unknown"===l.name||l.isiOS&&!l.iOSVersion)&&(l.error=!0)})(e),l),isNode:d}}).call(this,n(43))},function(e,t,n){"use strict";const r=e=>/iPhone/.test(e),i=e=>/iPad/.test(e)||(e=>{try{return e.includes("Mac")&&"ontouchend"in document}catch(e){return!1}})(e);e.exports={isiPhone:r,isiPad:i,isiOS:e=>r(e)||i(e)}},function(e,t,n){"use strict";e.exports=function(e){const t=e.match(/OS (\d+_\d+).* like Mac/);if(null!==t&&t[1])return parseFloat(t[1].replace("_","."))}},function(e,t,n){"use strict";const r=/(Electron)\/([0-9]{1,}[.0-9]{0,})/;e.exports=e=>{const t=e.match(r);return t&&parseFloat(t[2])}},function(e,t,n){"use strict";const r=n(555);function i(e,t){return!!t&&(r()?e.classList.contains(t):e.className.indexOf(t)>-1)}e.exports=function(e){e.prototype.addClass=function(e){if(e){const t=e.trim().split(/\s+/);this.forEach(e=>{!function(e,t){if(!t||0===t.length)return;if(1!==e.nodeType)return;const n=t.length;let i=0;if(r())for(;i<n;++i)e.classList.add(t[i]);else if(e.className||1!==t.length){let r=` ${e.className} `;for(;i<n;++i)~r.indexOf(` ${t[i]} `)||(r+=t[i]+" ");e.className=r.trim()}else e.className=t.join(" ")}(e,t)})}return this},e.prototype.removeClass=function(e){if(e){const t=e.trim().split(/\s+/);this.forEach(e=>{!function(e,t){if(!t||0===t.length)return;if(1!==e.nodeType)return;const n=t.length;let i=0;if(r()){for(;i<n;++i)e.classList.remove(t[i]);return}let o=` ${e.className} `.replace(/[\s+]/," ");for(;i<n;++i)o=o.replace(` ${t[i]} `," ");e.className=o.trim()}(e,t)})}return this},e.prototype.toggleClass=function(e){if(e){const t=e.trim().split(/\s+/);this.forEach(e=>{!function(e,t){if(!t||0===t.length)return;if(1!==e.nodeType)return;const n=t.length;let o=0;if(r()){for(;o<n;++o)e.classList.toggle(t[o]);return}let a=` ${e.className} `.replace(/[\s+]/," ");for(;o<n;++o)i(e,t[o])?a=a.replace(` ${t[o]} `," "):a+=t[o]+" ";e.className=a.trim()}(e,t)})}return this},e.prototype.hasClass=function(e){return this.some(t=>i(t,e))}}},function(e,t,n){"use strict";e.exports=()=>"undefined"!=typeof document&&"classList"in document.createElement("a")},function(e,t,n){"use strict";const r=n(557);e.exports=function(e){let t=0,n=0;e.prototype.observeStyleChanges=function(t,n){const i=[];return this.forEach(o=>{i.push(function(t,n,i){const o={},a=function(n){switch(n){case"width":return new e(t).width();case"height":return new e(t).height();default:return new e(t).css(n)}};n.forEach(e=>{o[e]=a(e)});const s=new(void 0!==typeof window?window:global).MutationObserver(s=>{const c={};s.forEach(r=>{if("style"!==r.attributeName)return;const i=new e(t).isDisplayNone();n.forEach(e=>{if(i&&("width"===e||"height"===e))return;const t=a(e);t!==o[e]&&(c[e]=[o[e],t],o[e]=t)})}),r(c)||setTimeout(()=>{i.call(null,c)})});return s.observe(t,{attributes:!0,attributeFilter:["style"],childList:!1,characterData:!1,subtree:!1}),s}(o,t,n))}),i},e.prototype.observeNodeOrChildNodeRemoval=function(t){const r=[];return this.forEach(i=>{r.push(function(t,r){const i=new(void 0!==typeof window?window:global).MutationObserver(t=>{let n=[];t.forEach(e=>{e.removedNodes.length&&(n=n.concat(Array.prototype.slice.call(e.removedNodes)))}),n.length&&setTimeout(()=>{r(new e(n))})});i.observe(t,{attributes:!1,childList:!0,characterData:!1,subtree:!0}),n++;const o=i.disconnect;return i.disconnect=function(){o.apply(i,arguments),n--},i}(i,t))}),r},e.prototype.observeSize=function(e){const n=[];return this.forEach(r=>{n.push(function(e,n){let r={width:0,height:0};const i=setInterval(()=>{const t=e.getBoundingClientRect();r.width===t.width&&r.height===t.height||(n(t,r),r={width:t.width,height:t.height})},200);return t++,{disconnect(){clearInterval(i),t--}}}(r,e))}),n},e._attachToOTHelpers.observeStyleChanges=function(t,n,r){return new e(t).observeStyleChanges(n,r)[0]},e._attachToOTHelpers.observeNodeOrChildNodeRemoval=function(t,n){return new e(t).observeNodeOrChildNodeRemoval(n)[0]},e.__testOnly||(e.__testOnly={}),e.__testOnly.sizeObserverCount=function(){return t},e.__testOnly.nodeRemovalObserverCount=function(){return n}}},function(e,t,n){var r=n(116),i=n(42),o=n(64),a=n(12),s=n(25),c=n(65),u=n(68),d=n(86),l=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(s(e)&&(a(e)||"string"==typeof e||"function"==typeof e.splice||c(e)||d(e)||o(e)))return!e.length;var t=i(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(u(e))return!r(e).length;for(var n in e)if(l.call(e,n))return!1;return!0}},function(e,t,n){"use strict";e.exports={1004:"Authentication error",1005:"Invalid Session ID",1006:"Connect Failed",1007:"Connect Rejected",1008:"Connect Time-out",1009:"Security Error",1010:"Not Connected",1011:"Invalid Parameter",1012:"Peer-to-peer Stream Play Failed",1013:"Connection Failed",1014:"API Response Failure",1015:"PeerConnection not connected, cannot call this method",1021:"Request Timeout",1026:"Terms of Service Violation: Export Compliance",1027:"Connection Limit Exceeded",1040:"Set Video Source Failure",1041:"Invalid Video Source",1500:"Unable to Publish",1501:"Unable to Subscribe",1502:"Unsupported Video Codec",1503:"No TURN server found",1520:"Unable to Force Disconnect",1530:"Unable to Force Unpublish",1540:"Unable to Force Mute",1553:"Publisher ICEWorkflow failed",1554:"Subscriber ICEWorkflow failed",1600:"createOffer, createAnswer, setLocalDescription, setRemoteDescription",1605:"Stream Limit Exceeded",2e3:"Internal Error",2001:"Unexpected Server Response",2021:"Proxy URL Timing Error",2022:"Proxy URL Already Set Error",2031:"getRtcStatsReport is not supported in this browser",4e3:"WebSocket Connection Failed",4001:"WebSocket Network Disconnected",5001:"Unable to access media engine"}},function(e,t,n){"use strict";const r=n(17);e.exports=function(e,t,n,i,o){let a,s=n;return e.currentState=n,e.is=function(){return-1!==Array.prototype.indexOf.call(arguments,s)},e.isNot=function(){return-1===Array.prototype.indexOf.call(arguments,s)},function(n){if(s!==n){if(-1===t.indexOf(n))return void(o&&r(o)&&o("invalidState",n));e.previousState=s,a=s,e.currentState=n,s=n,i&&r(i)&&i(n,a)}}}},function(e,t,n){"use strict";const r=n(247),i={};e.exports=i,i.isElementNode=function(e){return e&&"object"==typeof e&&1===e.nodeType},i.createElement=function(e,t,n,r){const i=(r||document).createElement(e);t=t||{},Object.keys(t).forEach(e=>{if("object"==typeof t[e]){i[e]||(i[e]={});const n=t[e];Object.keys(n).forEach(t=>{i[e][t]=n[t]})}else"className"===e?i.className=t[e]:i.setAttribute(e,t[e])});const o=function(e){"string"==typeof e?i.innerHTML+=e:i.appendChild(e)};return Array.isArray(n)?n.forEach(o):n&&o(n),i},r(i)},function(e,t,n){"use strict";const r=n(562);e.exports=(e,t)=>{if("string"==typeof e&&"string"==typeof t){const n=r(e),i=t.match(/(\w+:\/\/)(.*)/);return`${i[1]}${n}/${i[2]}`}return t}},function(e,t,n){"use strict";e.exports=e=>e.replace(/\/+$/,"").replace(/^.*:\/+/,"")},function(e,t,n){"use strict";const r=n(564);e.exports=function(e){void 0===e&&(e={}),(e.isSessionProxied||n(565))(e.sessionId)&&r.forEach(t=>{t in e&&(e[t]="")})}},function(e,t,n){"use strict";e.exports=["audioLocalAddress","audioRemoteAddress","videoLocalAddress","videoRemoteAddress"]},function(e,t,n){"use strict";const r=n(22).sessions;e.exports=e=>{const t=r.get(e);return!!t&&!!t._.getProxyUrl()}},function(e,t,n){"use strict";var r=n(1),i=r(n(4)),o=r(n(5));const a={architecture:"event_ua_arch",bitness:"event_ua_bitness",model:"event_ua_model",platformVersion:"event_ua_platform_version"},s=function(){var e=(0,o.default)(i.default.mark((function e(t){var n,r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={},null==t||!t.getHighEntropyValues){e.next=6;break}return e.next=4,t.getHighEntropyValues(Object.keys(a));case 4:(r=e.sent)&&Object.entries(a).forEach(e=>{let t=e[0],i=e[1];void 0!==r[t]&&(n[i]=r[t])});case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();e.exports=s},function(e,t,n){"use strict";e.exports=["buildHash","minimumVersion","debug",["websiteURL","websiteUrl"],["cdnURL","cdnUrl"],["loggingURL","loggingUrl"],["apiURL","apiUrl"],["supportSSL",!0],["cdnURLSSL","cdnUrl"],["loggingURLSSL","loggingUrl"],["apiURLSSL","apiUrl"],["assetURL","assetUrl"]]},function(e,t,n){"use strict";e.exports=["apiUrl","apiURL","apiURLSSL"]},function(e,t,n){"use strict";e.exports=function(){const e=(void 0!==typeof window?window:global).OT,t=(void 0!==typeof window?window:global).TB;return()=>{const n=(void 0!==typeof window?window:global).OT;return(void 0!==typeof window?window:global).OT=e,(void 0!==typeof window?window:global).TB=t,n}}},function(e,t,n){"use strict";e.exports=function(e){function t(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];const o=new e(...r);return Object.setPrototypeOf(o,t.prototype),o}return t.prototype=Object.create(e.prototype),Object.defineProperties(t.prototype,(e=>{const t={};return Object.getOwnPropertyNames(e).forEach(n=>{t[n]=Object.getOwnPropertyDescriptor(e,n)}),t})(e.prototype)),Object.keys(e).forEach(n=>{t[n]=e[n]}),t}},function(e,t,n){"use strict";var r=n(27);e.exports=function(e,t){var i=e&&e.window,o={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};for(var a in t)hasOwnProperty.call(t,a)&&(o[a]=t[a]);var s=r.log,c=r.detectBrowser(i),u=n(572)||null,d=n(574)||null,l=n(578)||null,f=n(580)||null,p=n(581)||null,h={browserDetails:c,commonShim:p,extractVersion:r.extractVersion,disableLog:r.disableLog,disableWarnings:r.disableWarnings};switch(c.browser){case"chrome":if(!u||!u.shimPeerConnection||!o.shimChrome)return s("Chrome shim is not included in this adapter release."),h;s("adapter.js shimming chrome."),h.browserShim=u,p.shimCreateObjectURL(i),u.shimGetUserMedia(i),u.shimMediaStream(i),u.shimSourceObject(i),u.shimPeerConnection(i),u.shimOnTrack(i),u.shimAddTrackRemoveTrack(i),u.shimGetSendersWithDtmf(i),u.shimSenderReceiverGetStats(i),u.fixNegotiationNeeded(i),p.shimRTCIceCandidate(i),p.shimMaxMessageSize(i),p.shimSendThrowTypeError(i);break;case"firefox":if(!l||!l.shimPeerConnection||!o.shimFirefox)return s("Firefox shim is not included in this adapter release."),h;s("adapter.js shimming firefox."),h.browserShim=l,p.shimCreateObjectURL(i),l.shimGetUserMedia(i),l.shimSourceObject(i),l.shimPeerConnection(i),l.shimOnTrack(i),l.shimRemoveStream(i),l.shimSenderGetStats(i),l.shimReceiverGetStats(i),l.shimRTCDataChannel(i),p.shimRTCIceCandidate(i),p.shimMaxMessageSize(i),p.shimSendThrowTypeError(i);break;case"edge":if(!d||!d.shimPeerConnection||!o.shimEdge)return s("MS edge shim is not included in this adapter release."),h;s("adapter.js shimming edge."),h.browserShim=d,p.shimCreateObjectURL(i),d.shimGetUserMedia(i),d.shimPeerConnection(i),d.shimReplaceTrack(i),d.shimGetDisplayMedia(i),p.shimMaxMessageSize(i),p.shimSendThrowTypeError(i);break;case"safari":if(!f||!o.shimSafari)return s("Safari shim is not included in this adapter release."),h;s("adapter.js shimming safari."),h.browserShim=f,p.shimCreateObjectURL(i),f.shimRTCIceServerUrls(i),f.shimCreateOfferLegacy(i),f.shimCallbacksAPI(i),f.shimLocalStreamsAPI(i),f.shimRemoteStreamsAPI(i),f.shimTrackEventTransceiver(i),f.shimGetUserMedia(i),p.shimRTCIceCandidate(i),p.shimMaxMessageSize(i),p.shimSendThrowTypeError(i);break;default:s("Unsupported browser!")}return h}},function(e,t,n){"use strict";(function(t){var r=n(27),i=r.log;function o(e,t,n){var r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;var o=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((function(t){e.forEach((function(n){n.type===r&&n.trackId===t.id&&function e(t,n,r){n&&!r.has(n.id)&&(r.set(n.id,n),Object.keys(n).forEach((function(i){i.endsWith("Id")?e(t,t.get(n[i]),r):i.endsWith("Ids")&&n[i].forEach((function(n){e(t,t.get(n),r)}))})))}(e,n,i)}))})),i}e.exports={shimGetUserMedia:n(573),shimMediaStream:function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},shimOnTrack:function(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return n._ontrackpoly||(n._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.track.id})):{track:r.track};var o=new Event("track");o.track=r.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)})),t.stream.getTracks().forEach((function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.id})):{track:r};var o=new Event("track");o.track=r,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)}))},n.addEventListener("addstream",n._ontrackpoly)),t.apply(n,arguments)}}else r.wrapPeerConnectionEvent(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}))},shimGetSendersWithDtmf:function(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){var i=this,o=n.apply(i,arguments);return o||(o=t(i,e),i._senders.push(o)),o};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;r.apply(t,arguments);var n=t._senders.indexOf(e);-1!==n&&t._senders.splice(n,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;n._senders=n._senders||[],i.apply(n,[e]),e.getTracks().forEach((function(e){n._senders.push(t(n,e))}))};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;t._senders=t._senders||[],o.apply(t,[e]),e.getTracks().forEach((function(e){var n=t._senders.find((function(t){return t.track===e}));n&&t._senders.splice(t._senders.indexOf(n),1)}))}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=a.apply(e,[]);return t.forEach((function(t){t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},shimSenderReceiverGetStats:function(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var n=e.RTCPeerConnection.prototype.getSenders;n&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=n.apply(e,[]);return t.forEach((function(t){t._pc=e})),t});var i=e.RTCPeerConnection.prototype.addTrack;i&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=i.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return o(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var a=e.RTCPeerConnection.prototype.getReceivers;a&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=a.apply(e,[]);return t.forEach((function(t){t._pc=e})),t}),r.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return o(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var s=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var n=this;if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var r,i,o,a=arguments[0];return n.getSenders().forEach((function(e){e.track===a&&(r?o=!0:r=e)})),n.getReceivers().forEach((function(e){return e.track===a&&(i?o=!0:i=e),e.track===a})),o||r&&i?t.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():i?i.getStats():t.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return s.apply(n,arguments)}}}},shimSourceObject:function(e){var t=e&&e.URL;"object"==typeof e&&e.HTMLMediaElement&&!("srcObject"in e.HTMLMediaElement.prototype)&&Object.defineProperty(e.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(e){var n=this;this._srcObject=e,this.src&&t.revokeObjectURL(this.src),e?(this.src=t.createObjectURL(e),e.addEventListener("addtrack",(function(){n.src&&t.revokeObjectURL(n.src),n.src=t.createObjectURL(e)})),e.addEventListener("removetrack",(function(){n.src&&t.revokeObjectURL(n.src),n.src=t.createObjectURL(e)}))):this.src=""}})},shimAddTrackRemoveTrackWithNative:function(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var r=t.getSenders();n.apply(this,arguments);var i=t.getSenders().filter((function(e){return-1===r.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(i)};var r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(n){var r=t._shimmedLocalStreams[n].indexOf(e);-1!==r&&t._shimmedLocalStreams[n].splice(r,1),1===t._shimmedLocalStreams[n].length&&delete t._shimmedLocalStreams[n]})),i.apply(this,arguments)}},shimAddTrackRemoveTrack:function(e){if(e.RTCPeerConnection){var n=r.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&n.version>=65)return this.shimAddTrackRemoveTrackWithNative(e);var i=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=i.apply(this);return e._reverseStreams=e._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var o=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var n=this;if(n._streams=n._streams||{},n._reverseStreams=n._reverseStreams||{},t.getTracks().forEach((function(e){if(n.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!n._reverseStreams[t.id]){var r=new e.MediaStream(t.getTracks());n._streams[t.id]=r,n._reverseStreams[r.id]=t,t=r}o.apply(n,[t])};var a=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;t._streams=t._streams||{},t._reverseStreams=t._reverseStreams||{},a.apply(t,[t._streams[e.id]||e]),delete t._reverseStreams[t._streams[e.id]?t._streams[e.id].id:e.id],delete t._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(n,r){var i=this;if("closed"===i.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var o=[].slice.call(arguments,1);if(1!==o.length||!o[0].getTracks().find((function(e){return e===n})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");var a=i.getSenders().find((function(e){return e.track===n}));if(a)throw new DOMException("Track already exists.","InvalidAccessError");i._streams=i._streams||{},i._reverseStreams=i._reverseStreams||{};var s=i._streams[r.id];if(s)s.addTrack(n),t.resolve().then((function(){i.dispatchEvent(new Event("negotiationneeded"))}));else{var c=new e.MediaStream([n]);i._streams[r.id]=c,i._reverseStreams[c.id]=r,i.addStream(c)}return i.getSenders().find((function(e){return e.track===n}))},["createOffer","createAnswer"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=this,t=arguments,r=arguments.length&&"function"==typeof arguments[0];return r?n.apply(e,[function(n){var r=u(e,n);t[0].apply(null,[r])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):n.apply(e,arguments).then((function(t){return u(e,t)}))}}));var s=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){var e=this;return arguments.length&&arguments[0].type?(arguments[0]=d(e,arguments[0]),s.apply(e,arguments)):s.apply(e,arguments)};var c=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=c.get.apply(this);return""===e.type?e:u(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,n=this;if("closed"===n.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==n)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");n._streams=n._streams||{},Object.keys(n._streams).forEach((function(r){n._streams[r].getTracks().find((function(t){return e.track===t}))&&(t=n._streams[r])})),t&&(1===t.getTracks().length?n.removeStream(n._reverseStreams[t.id]):t.removeTrack(e.track),n.dispatchEvent(new Event("negotiationneeded")))}}function u(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(i.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:n})}function d(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})}},shimPeerConnection:function(e){var n=r.detectBrowser(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=function(t,n){return i("PeerConnection"),t&&t.iceTransportPolicy&&(t.iceTransports=t.iceTransportPolicy),new e.webkitRTCPeerConnection(t,n)},e.RTCPeerConnection.prototype=e.webkitRTCPeerConnection.prototype,e.webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return e.webkitRTCPeerConnection.generateCertificate}})),e.RTCPeerConnection){var o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,n,r){var i=this,a=arguments;if(arguments.length>0&&"function"==typeof e)return o.apply(this,arguments);if(0===o.length&&(0===arguments.length||"function"!=typeof arguments[0]))return o.apply(this,[]);var s=function(e){var t={};return e.result().forEach((function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){n[t]=e.stat(t)})),t[n.id]=n})),t},c=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};if(arguments.length>=2){var u=function(e){a[1](c(s(e)))};return o.apply(this,[u,arguments[0]])}return new t((function(e,t){o.apply(i,[function(t){e(c(s(t)))},t])})).then(n,r)},n.version<51&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(n){var r=e.RTCPeerConnection.prototype[n];e.RTCPeerConnection.prototype[n]=function(){var e=arguments,n=this,i=new t((function(t,i){r.apply(n,[e[0],t,i])}));return e.length<2?i:i.then((function(){e[1].apply(null,[])}),(function(t){e.length>=3&&e[2].apply(null,[t])}))}})),n.version<52&&["createOffer","createAnswer"].forEach((function(n){var r=e.RTCPeerConnection.prototype[n];e.RTCPeerConnection.prototype[n]=function(){var e=this;if(arguments.length<1||1===arguments.length&&"object"==typeof arguments[0]){var n=1===arguments.length?arguments[0]:void 0;return new t((function(t,i){r.apply(e,[t,i,n])}))}return r.apply(this,arguments)}})),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}}));var a=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?a.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),t.resolve())}}},fixNegotiationNeeded:function(e){r.wrapPeerConnectionEvent(e,"negotiationneeded",(function(e){if("stable"===e.target.signalingState)return e}))},shimGetDisplayMedia:function(e,t){e.navigator&&e.navigator.mediaDevices&&!("getDisplayMedia"in e.navigator.mediaDevices)&&("function"==typeof t?(e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((function(t){var r=n.video&&n.video.width,i=n.video&&n.video.height,o=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)}))},e.navigator.getDisplayMedia=function(t){return r.deprecated("navigator.getDisplayMedia","navigator.mediaDevices.getDisplayMedia"),e.navigator.mediaDevices.getDisplayMedia(t)}):console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}}}).call(this,n(2))},function(e,t,n){"use strict";(function(t){var r=n(27),i=r.log;e.exports=function(e){var n=r.detectBrowser(e),o=e&&e.navigator,a=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var o={};"number"==typeof r.ideal?(o[i("min",n)]=r.ideal,t.optional.push(o),(o={})[i("max",n)]=r.ideal,t.optional.push(o)):(o[i("",n)]=r.ideal,t.optional.push(o))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach((function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},s=function(e,t){if(n.version>=61)return t(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){var r=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};r((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),r(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=a(e.audio)}if(e&&"object"==typeof e.video){var s=e.video.facingMode;s=s&&("object"==typeof s?s:{ideal:s});var c,u=n.version<66;if(s&&("user"===s.exact||"environment"===s.exact||"user"===s.ideal||"environment"===s.ideal)&&(!o.mediaDevices.getSupportedConstraints||!o.mediaDevices.getSupportedConstraints().facingMode||u)&&(delete e.video.facingMode,"environment"===s.exact||"environment"===s.ideal?c=["back","rear"]:"user"!==s.exact&&"user"!==s.ideal||(c=["front"]),c))return o.mediaDevices.enumerateDevices().then((function(n){var r=(n=n.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return c.some((function(t){return-1!==e.label.toLowerCase().indexOf(t)}))}));return!r&&n.length&&-1!==c.indexOf("back")&&(r=n[n.length-1]),r&&(e.video.deviceId=s.exact?{exact:r.deviceId}:{ideal:r.deviceId}),e.video=a(e.video),i("chrome: "+JSON.stringify(e)),t(e)}));e.video=a(e.video)}return i("chrome: "+JSON.stringify(e)),t(e)},c=function(e){return n.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};o.getUserMedia=function(e,t,n){s(e,(function(e){o.webkitGetUserMedia(e,t,(function(e){n&&n(c(e))}))}))};var u=function(e){return new t((function(t,n){o.getUserMedia(e,t,n)}))};if(o.mediaDevices||(o.mediaDevices={getUserMedia:u,enumerateDevices:function(){return new t((function(t){var n={audio:"audioinput",video:"videoinput"};return e.MediaStreamTrack.getSources((function(e){t(e.map((function(e){return{label:e.label,kind:n[e.kind],deviceId:e.id,groupId:""}})))}))}))},getSupportedConstraints:function(){return{deviceId:!0,echoCancellation:!0,facingMode:!0,frameRate:!0,height:!0,width:!0}}}),o.mediaDevices.getUserMedia){var d=o.mediaDevices.getUserMedia.bind(o.mediaDevices);o.mediaDevices.getUserMedia=function(e){return s(e,(function(e){return d(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return t.reject(c(e))}))}))}}else o.mediaDevices.getUserMedia=function(e){return u(e)};void 0===o.mediaDevices.addEventListener&&(o.mediaDevices.addEventListener=function(){i("Dummy mediaDevices.addEventListener called.")}),void 0===o.mediaDevices.removeEventListener&&(o.mediaDevices.removeEventListener=function(){i("Dummy mediaDevices.removeEventListener called.")})}}).call(this,n(2))},function(e,t,n){"use strict";var r=n(27),i=n(575),o=n(576);e.exports={shimGetUserMedia:n(577),shimPeerConnection:function(e){var t=r.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){n.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var a=o(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=i(e.iceServers)),new a(e)},e.RTCPeerConnection.prototype=a.prototype},shimReplaceTrack:function(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)},shimGetDisplayMedia:function(e,t){if("getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&!("getDisplayMedia"in e.navigator.mediaDevices)){var n=e.navigator.getDisplayMedia;e.navigator.mediaDevices.getDisplayMedia=function(t){return n.call(e.navigator,t)},e.navigator.getDisplayMedia=function(t){return r.deprecated("navigator.getDisplayMedia","navigator.mediaDevices.getDisplayMedia"),n.call(e.navigator,t)}}}}},function(e,t,n){"use strict";var r=n(27);e.exports=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var i=e.urls||e.url;e.url&&!e.urls&&r.deprecated("RTCIceServer.url","RTCIceServer.urls");var o="string"==typeof i;return o&&(i=[i]),i=i.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||n?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(n=!0,!0)})),delete e.url,e.urls=o?i[0]:i,!!i.length}}))}},function(e,t,n){"use strict";(function(t){var r=n(251);function i(e,t,n,i,o){var a=r.writeRtpDescription(e.kind,t);if(a+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":o||"active"),a+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var s=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=s;var c="msid:"+(i?i.id:"-")+" "+s+"\r\n";a+="a="+c,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),a}function o(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},i=function(e,t,n,i){var o=r(e.parameters.apt,n),a=r(t.parameters.apt,i);return o&&a&&o.name.toLowerCase()===a.name.toLowerCase()};return e.codecs.forEach((function(r){for(var o=0;o<t.codecs.length;o++){var a=t.codecs[o];if(r.name.toLowerCase()===a.name.toLowerCase()&&r.clockRate===a.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&a.parameters.apt&&!i(r,a,e.codecs,t.codecs))continue;(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(r.numChannels,a.numChannels),n.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter((function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}})),n}function a(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function s(e,t){var n=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return n||e.addRemoteCandidate(t),!n}function c(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}e.exports=function(e,n){function u(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function d(t,n,r,i){var o=new Event("track");o.track=n,o.receiver=r,o.transceiver={receiver:r},o.streams=i,e.setTimeout((function(){t._dispatchEvent("track",o)}))}var l=function(t){var i=this,o=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){i[e]=o[e].bind(o)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",t=JSON.parse(JSON.stringify(t||{})),this.usingBundle="max-bundle"===t.bundlePolicy,"negotiate"===t.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(t.rtcpMuxPolicy||(t.rtcpMuxPolicy="require"),t.iceTransportPolicy){case"all":case"relay":break;default:t.iceTransportPolicy="all"}switch(t.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:t.bundlePolicy="balanced"}if(t.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof r;return i&&(r=[r]),r=r.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||n?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(n=!0,!0)})),delete e.url,e.urls=i?r[0]:r,!!r.length}}))}(t.iceServers||[],n),this._iceGatherers=[],t.iceCandidatePoolSize)for(var a=t.iceCandidatePoolSize;a>0;a--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:t.iceServers,gatherPolicy:t.iceTransportPolicy}));else t.iceCandidatePoolSize=0;this._config=t,this.transceivers=[],this._sdpSessionId=r.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(l.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(l.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),l.prototype.onicecandidate=null,l.prototype.onaddstream=null,l.prototype.ontrack=null,l.prototype.onremovestream=null,l.prototype.onsignalingstatechange=null,l.prototype.oniceconnectionstatechange=null,l.prototype.onconnectionstatechange=null,l.prototype.onicegatheringstatechange=null,l.prototype.onnegotiationneeded=null,l.prototype.ondatachannel=null,l.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},l.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},l.prototype.getConfiguration=function(){return this._config},l.prototype.getLocalStreams=function(){return this.localStreams},l.prototype.getRemoteStreams=function(){return this.remoteStreams},l.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,r={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)r.iceTransport=this.transceivers[0].iceTransport,r.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();r.iceTransport=i.iceTransport,r.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(r),r},l.prototype.addTrack=function(t,n){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find((function(e){return e.track===t})))throw c("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(r=this.transceivers[i]);return r||(r=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),r.track=t,r.stream=n,r.rtpSender=new e.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},l.prototype.addStream=function(e){var t=this;if(n>=15025)e.getTracks().forEach((function(n){t.addTrack(n,e)}));else{var r=e.clone();e.getTracks().forEach((function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",(function(e){n.enabled=e.enabled}))})),r.getTracks().forEach((function(e){t.addTrack(e,r)}))}},l.prototype.removeTrack=function(t){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find((function(e){return e.rtpSender===t}));if(!n)throw c("InvalidAccessError","Sender was not created by this connection.");var r=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},l.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var n=t.getSenders().find((function(t){return t.track===e}));n&&t.removeTrack(n)}))},l.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},l.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},l.prototype._createIceGatherer=function(t,n){var r=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;i.state=n?"completed":"gathering",null!==r.transceivers[t].bufferedCandidateEvents&&r.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},l.prototype._gather=function(t,n){var i=this,o=this.transceivers[n].iceGatherer;if(!o.onlocalcandidate){var a=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,o.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),o.onlocalcandidate=function(e){if(!(i.usingBundle&&n>0)){var a=new Event("icecandidate");a.candidate={sdpMid:t,sdpMLineIndex:n};var s=e.candidate,c=!s||0===Object.keys(s).length;if(c)"new"!==o.state&&"gathering"!==o.state||(o.state="completed");else{"new"===o.state&&(o.state="gathering"),s.component=1,s.ufrag=o.getLocalParameters().usernameFragment;var u=r.writeCandidate(s);a.candidate=Object.assign(a.candidate,r.parseCandidate(u)),a.candidate.candidate=u,a.candidate.toJSON=function(){return{candidate:a.candidate.candidate,sdpMid:a.candidate.sdpMid,sdpMLineIndex:a.candidate.sdpMLineIndex,usernameFragment:a.candidate.usernameFragment}}}var d=r.getMediaSections(i._localDescription.sdp);d[a.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+a.candidate.candidate+"\r\n",i._localDescription.sdp=r.getDescription(i._localDescription.sdp)+d.join("");var l=i.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==i.iceGatheringState&&(i.iceGatheringState="gathering",i._emitGatheringStateChange()),c||i._dispatchEvent("icecandidate",a),l&&(i._dispatchEvent("icecandidate",new Event("icecandidate")),i.iceGatheringState="complete",i._emitGatheringStateChange())}},e.setTimeout((function(){a.forEach((function(e){o.onlocalcandidate(e)}))}),0)}},l.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var r=new e.RTCDtlsTransport(n);return r.ondtlsstatechange=function(){t._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:r}},l.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var r=this.transceivers[e].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[e].dtlsTransport)},l.prototype._transceive=function(e,t,i){var a=o(e.localCapabilities,e.remoteCapabilities);t&&e.rtpSender&&(a.encodings=e.sendEncodingParameters,a.rtcp={cname:r.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(a.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(a)),i&&e.rtpReceiver&&a.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&n<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?a.encodings=e.recvEncodingParameters:a.encodings=[{}],a.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(a.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(a.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(a))},l.prototype.setLocalDescription=function(e){var n,i,s=this;if(-1===["offer","answer"].indexOf(e.type))return t.reject(c("TypeError",'Unsupported type "'+e.type+'"'));if(!a("setLocalDescription",e.type,s.signalingState)||s._isClosed)return t.reject(c("InvalidStateError","Can not set local "+e.type+" in state "+s.signalingState));if("offer"===e.type)n=r.splitSections(e.sdp),i=n.shift(),n.forEach((function(e,t){var n=r.parseRtpParameters(e);s.transceivers[t].localCapabilities=n})),s.transceivers.forEach((function(e,t){s._gather(e.mid,t)}));else if("answer"===e.type){n=r.splitSections(s._remoteDescription.sdp),i=n.shift();var u=r.matchPrefix(i,"a=ice-lite").length>0;n.forEach((function(e,t){var n=s.transceivers[t],a=n.iceGatherer,c=n.iceTransport,d=n.dtlsTransport,l=n.localCapabilities,f=n.remoteCapabilities;if(!(r.isRejected(e)&&0===r.matchPrefix(e,"a=bundle-only").length||n.rejected)){var p=r.getIceParameters(e,i),h=r.getDtlsParameters(e,i);u&&(h.role="server"),s.usingBundle&&0!==t||(s._gather(n.mid,t),"new"===c.state&&c.start(a,p,u?"controlling":"controlled"),"new"===d.state&&d.start(h));var m=o(l,f);s._transceive(n,m.codecs.length>0,!1)}}))}return s._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?s._updateSignalingState("have-local-offer"):s._updateSignalingState("stable"),t.resolve()},l.prototype.setRemoteDescription=function(i){var l=this;if(-1===["offer","answer"].indexOf(i.type))return t.reject(c("TypeError",'Unsupported type "'+i.type+'"'));if(!a("setRemoteDescription",i.type,l.signalingState)||l._isClosed)return t.reject(c("InvalidStateError","Can not set remote "+i.type+" in state "+l.signalingState));var f={};l.remoteStreams.forEach((function(e){f[e.id]=e}));var p=[],h=r.splitSections(i.sdp),m=h.shift(),g=r.matchPrefix(m,"a=ice-lite").length>0,v=r.matchPrefix(m,"a=group:BUNDLE ").length>0;l.usingBundle=v;var y=r.matchPrefix(m,"a=ice-options:")[0];return l.canTrickleIceCandidates=!!y&&y.substr(14).split(" ").indexOf("trickle")>=0,h.forEach((function(t,a){var c=r.splitLines(t),d=r.getKind(t),h=r.isRejected(t)&&0===r.matchPrefix(t,"a=bundle-only").length,y=c[0].substr(2).split(" ")[2],b=r.getDirection(t,m),S=r.parseMsid(t),E=r.getMid(t)||r.generateIdentifier();if(h||"application"===d&&("DTLS/SCTP"===y||"UDP/DTLS/SCTP"===y))l.transceivers[a]={mid:E,kind:d,protocol:y,rejected:!0};else{var _,T,R,I,w,C,O,A,x;!h&&l.transceivers[a]&&l.transceivers[a].rejected&&(l.transceivers[a]=l._createTransceiver(d,!0));var k,N,L=r.parseRtpParameters(t);h||(k=r.getIceParameters(t,m),(N=r.getDtlsParameters(t,m)).role="client"),O=r.parseRtpEncodingParameters(t);var M=r.parseRtcpParameters(t),V=r.matchPrefix(t,"a=end-of-candidates",m).length>0,P=r.matchPrefix(t,"a=candidate:").map((function(e){return r.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===i.type||"answer"===i.type)&&!h&&v&&a>0&&l.transceivers[a]&&(l._disposeIceAndDtlsTransports(a),l.transceivers[a].iceGatherer=l.transceivers[0].iceGatherer,l.transceivers[a].iceTransport=l.transceivers[0].iceTransport,l.transceivers[a].dtlsTransport=l.transceivers[0].dtlsTransport,l.transceivers[a].rtpSender&&l.transceivers[a].rtpSender.setTransport(l.transceivers[0].dtlsTransport),l.transceivers[a].rtpReceiver&&l.transceivers[a].rtpReceiver.setTransport(l.transceivers[0].dtlsTransport)),"offer"!==i.type||h)"answer"!==i.type||h||(T=(_=l.transceivers[a]).iceGatherer,R=_.iceTransport,I=_.dtlsTransport,w=_.rtpReceiver,C=_.sendEncodingParameters,A=_.localCapabilities,l.transceivers[a].recvEncodingParameters=O,l.transceivers[a].remoteCapabilities=L,l.transceivers[a].rtcpParameters=M,P.length&&"new"===R.state&&(!g&&!V||v&&0!==a?P.forEach((function(e){s(_.iceTransport,e)})):R.setRemoteCandidates(P)),v&&0!==a||("new"===R.state&&R.start(T,k,"controlling"),"new"===I.state&&I.start(N)),!o(_.localCapabilities,_.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&_.sendEncodingParameters[0].rtx&&delete _.sendEncodingParameters[0].rtx,l._transceive(_,"sendrecv"===b||"recvonly"===b,"sendrecv"===b||"sendonly"===b),!w||"sendrecv"!==b&&"sendonly"!==b?delete _.rtpReceiver:(x=w.track,S?(f[S.stream]||(f[S.stream]=new e.MediaStream),u(x,f[S.stream]),p.push([x,w,f[S.stream]])):(f.default||(f.default=new e.MediaStream),u(x,f.default),p.push([x,w,f.default]))));else{(_=l.transceivers[a]||l._createTransceiver(d)).mid=E,_.iceGatherer||(_.iceGatherer=l._createIceGatherer(a,v)),P.length&&"new"===_.iceTransport.state&&(!V||v&&0!==a?P.forEach((function(e){s(_.iceTransport,e)})):_.iceTransport.setRemoteCandidates(P)),A=e.RTCRtpReceiver.getCapabilities(d),n<15019&&(A.codecs=A.codecs.filter((function(e){return"rtx"!==e.name}))),C=_.sendEncodingParameters||[{ssrc:1001*(2*a+2)}];var D,Z=!1;"sendrecv"===b||"sendonly"===b?(Z=!_.rtpReceiver,w=_.rtpReceiver||new e.RTCRtpReceiver(_.dtlsTransport,d),Z&&(x=w.track,S&&"-"===S.stream||(S?(f[S.stream]||(f[S.stream]=new e.MediaStream,Object.defineProperty(f[S.stream],"id",{get:function(){return S.stream}})),Object.defineProperty(x,"id",{get:function(){return S.track}}),D=f[S.stream]):(f.default||(f.default=new e.MediaStream),D=f.default)),D&&(u(x,D),_.associatedRemoteMediaStreams.push(D)),p.push([x,w,D]))):_.rtpReceiver&&_.rtpReceiver.track&&(_.associatedRemoteMediaStreams.forEach((function(t){var n=t.getTracks().find((function(e){return e.id===_.rtpReceiver.track.id}));n&&function(t,n){n.removeTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}(n,t)})),_.associatedRemoteMediaStreams=[]),_.localCapabilities=A,_.remoteCapabilities=L,_.rtpReceiver=w,_.rtcpParameters=M,_.sendEncodingParameters=C,_.recvEncodingParameters=O,l._transceive(l.transceivers[a],!1,Z)}}})),void 0===l._dtlsRole&&(l._dtlsRole="offer"===i.type?"active":"passive"),l._remoteDescription={type:i.type,sdp:i.sdp},"offer"===i.type?l._updateSignalingState("have-remote-offer"):l._updateSignalingState("stable"),Object.keys(f).forEach((function(t){var n=f[t];if(n.getTracks().length){if(-1===l.remoteStreams.indexOf(n)){l.remoteStreams.push(n);var r=new Event("addstream");r.stream=n,e.setTimeout((function(){l._dispatchEvent("addstream",r)}))}p.forEach((function(e){var t=e[0],r=e[1];n.id===e[2].id&&d(l,t,r,[n])}))}})),p.forEach((function(e){e[2]||d(l,e[0],e[1],[])})),e.setTimeout((function(){l&&l.transceivers&&l.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),t.resolve()},l.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},l.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},l.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},l.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},l.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},l.prototype.createOffer=function(){var o=this;if(o._isClosed)return t.reject(c("InvalidStateError","Can not call createOffer after close"));var a=o.transceivers.filter((function(e){return"audio"===e.kind})).length,s=o.transceivers.filter((function(e){return"video"===e.kind})).length,u=arguments[0];if(u){if(u.mandatory||u.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==u.offerToReceiveAudio&&(a=!0===u.offerToReceiveAudio?1:!1===u.offerToReceiveAudio?0:u.offerToReceiveAudio),void 0!==u.offerToReceiveVideo&&(s=!0===u.offerToReceiveVideo?1:!1===u.offerToReceiveVideo?0:u.offerToReceiveVideo)}for(o.transceivers.forEach((function(e){"audio"===e.kind?--a<0&&(e.wantReceive=!1):"video"===e.kind&&--s<0&&(e.wantReceive=!1)}));a>0||s>0;)a>0&&(o._createTransceiver("audio"),a--),s>0&&(o._createTransceiver("video"),s--);var d=r.writeSessionBoilerplate(o._sdpSessionId,o._sdpSessionVersion++);o.transceivers.forEach((function(t,i){var a=t.track,s=t.kind,c=t.mid||r.generateIdentifier();t.mid=c,t.iceGatherer||(t.iceGatherer=o._createIceGatherer(i,o.usingBundle));var u=e.RTCRtpSender.getCapabilities(s);n<15019&&(u.codecs=u.codecs.filter((function(e){return"rtx"!==e.name}))),u.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),t.remoteCapabilities&&t.remoteCapabilities.codecs&&t.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),u.headerExtensions.forEach((function(e){(t.remoteCapabilities&&t.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var d=t.sendEncodingParameters||[{ssrc:1001*(2*i+1)}];a&&n>=15019&&"video"===s&&!d[0].rtx&&(d[0].rtx={ssrc:d[0].ssrc+1}),t.wantReceive&&(t.rtpReceiver=new e.RTCRtpReceiver(t.dtlsTransport,s)),t.localCapabilities=u,t.sendEncodingParameters=d})),"max-compat"!==o._config.bundlePolicy&&(d+="a=group:BUNDLE "+o.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),d+="a=ice-options:trickle\r\n",o.transceivers.forEach((function(e,t){d+=i(e,e.localCapabilities,"offer",e.stream,o._dtlsRole),d+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===o.iceGatheringState||0!==t&&o.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,d+="a="+r.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(d+="a=end-of-candidates\r\n"))}));var l=new e.RTCSessionDescription({type:"offer",sdp:d});return t.resolve(l)},l.prototype.createAnswer=function(){var a=this;if(a._isClosed)return t.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==a.signalingState&&"have-local-pranswer"!==a.signalingState)return t.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+a.signalingState));var s=r.writeSessionBoilerplate(a._sdpSessionId,a._sdpSessionVersion++);a.usingBundle&&(s+="a=group:BUNDLE "+a.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),s+="a=ice-options:trickle\r\n";var u=r.getMediaSections(a._remoteDescription.sdp).length;a.transceivers.forEach((function(e,t){if(!(t+1>u)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?s+="m=application 0 DTLS/SCTP 5000\r\n":s+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?s+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(s+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(s+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var r;e.stream&&("audio"===e.kind?r=e.stream.getAudioTracks()[0]:"video"===e.kind&&(r=e.stream.getVideoTracks()[0]),r&&n>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var c=o(e.localCapabilities,e.remoteCapabilities);!c.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,s+=i(e,c,"answer",e.stream,a._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(s+="a=rtcp-rsize\r\n")}}));var d=new e.RTCSessionDescription({type:"answer",sdp:s});return t.resolve(d)},l.prototype.addIceCandidate=function(e){var n,i=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?t.reject(new TypeError("sdpMLineIndex or sdpMid required")):new t((function(t,o){if(!i._remoteDescription)return o(c("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var a=e.sdpMLineIndex;if(e.sdpMid)for(var u=0;u<i.transceivers.length;u++)if(i.transceivers[u].mid===e.sdpMid){a=u;break}var d=i.transceivers[a];if(!d)return o(c("OperationError","Can not add ICE candidate"));if(d.rejected)return t();var l=Object.keys(e.candidate).length>0?r.parseCandidate(e.candidate):{};if("tcp"===l.protocol&&(0===l.port||9===l.port))return t();if(l.component&&1!==l.component)return t();if((0===a||a>0&&d.iceTransport!==i.transceivers[0].iceTransport)&&!s(d.iceTransport,l))return o(c("OperationError","Can not add ICE candidate"));var f=e.candidate.trim();0===f.indexOf("a=")&&(f=f.substr(2)),(n=r.getMediaSections(i._remoteDescription.sdp))[a]+="a="+(l.type?f:"end-of-candidates")+"\r\n",i._remoteDescription.sdp=r.getDescription(i._remoteDescription.sdp)+n.join("")}else for(var p=0;p<i.transceivers.length&&(i.transceivers[p].rejected||(i.transceivers[p].iceTransport.addRemoteCandidate({}),(n=r.getMediaSections(i._remoteDescription.sdp))[p]+="a=end-of-candidates\r\n",i._remoteDescription.sdp=r.getDescription(i._remoteDescription.sdp)+n.join(""),!i.usingBundle));p++);t()}))},l.prototype.getStats=function(n){if(n&&n instanceof e.MediaStreamTrack){var r=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===n?r=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===n&&(r=e.rtpReceiver)})),!r)throw c("InvalidAccessError","Invalid selector.");return r.getStats()}var i=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&i.push(e[t].getStats())}))})),t.all(i).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var r=n.prototype.getStats;n.prototype.getStats=function(){return r.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(n){var r;e[n].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(r=e[n]).type]||r.type,t.set(n,e[n])})),t}))}}}));var f=["createOffer","createAnswer"];return f.forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(f=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),l}}).call(this,n(2))},function(e,t,n){"use strict";(function(t){e.exports=function(e){var n=e&&e.navigator,r=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(e){return r(e).catch((function(e){return t.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))}))}}}).call(this,n(2))},function(e,t,n){"use strict";(function(t){var r=n(27);e.exports={shimGetUserMedia:n(579),shimOnTrack:function(e){"object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)&&Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.getTracks().forEach(function(t){var n=new Event("track");n.track=t,n.receiver={track:t},n.transceiver={receiver:n.receiver},n.streams=[e.stream],this.dispatchEvent(n)}.bind(this))}.bind(this))},enumerable:!0,configurable:!0}),"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimSourceObject:function(e){"object"==typeof e&&e.HTMLMediaElement&&!("srcObject"in e.HTMLMediaElement.prototype)&&Object.defineProperty(e.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(e){this.mozSrcObject=e}})},shimPeerConnection:function(e){var n=r.detectBrowser(e);if("object"==typeof e&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){e.RTCPeerConnection||(e.RTCPeerConnection=function(t,r){if(n.version<38&&t&&t.iceServers){for(var i=[],o=0;o<t.iceServers.length;o++){var a=t.iceServers[o];if(a.hasOwnProperty("urls"))for(var s=0;s<a.urls.length;s++){var c={url:a.urls[s]};0===a.urls[s].indexOf("turn")&&(c.username=a.username,c.credential=a.credential),i.push(c)}else i.push(t.iceServers[o])}t.iceServers=i}return new e.mozRTCPeerConnection(t,r)},e.RTCPeerConnection.prototype=e.mozRTCPeerConnection.prototype,e.mozRTCPeerConnection.generateCertificate&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return e.mozRTCPeerConnection.generateCertificate}}),e.RTCSessionDescription=e.mozRTCSessionDescription,e.RTCIceCandidate=e.mozRTCIceCandidate),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}}));var i=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?i.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),t.resolve())};var o={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},a=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,t,r){return a.apply(this,[e||null]).then((function(e){if(n.version<48&&(e=function(e){var t=new Map;return Object.keys(e).forEach((function(n){t.set(n,e[n]),t[n]=e[n]})),t}(e)),n.version<53&&!t)try{e.forEach((function(e){e.type=o[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach((function(t,n){e.set(n,Object.assign({},t,{type:o[t.type]||t.type}))}))}return e})).then(t,r)}}},shimSenderGetStats:function(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpSender.prototype))){var n=e.RTCPeerConnection.prototype.getSenders;n&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=n.apply(e,[]);return t.forEach((function(t){t._pc=e})),t});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):t.resolve(new Map)}}},shimReceiverGetStats:function(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpReceiver.prototype))){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,n=t.apply(e,[]);return n.forEach((function(t){t._pc=e})),n}),r.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},shimRemoveStream:function(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;r.deprecated("removeStream","removeTrack"),this.getSenders().forEach((function(n){n.track&&-1!==e.getTracks().indexOf(n.track)&&t.removeTrack(n)}))})},shimRTCDataChannel:function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},shimGetDisplayMedia:function(e,n){e.navigator&&e.navigator.mediaDevices&&!("getDisplayMedia"in e.navigator.mediaDevices)&&(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){var i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,t.reject(i)}return!0===r.video?r.video={mediaSource:n}:r.video.mediaSource=n,e.navigator.mediaDevices.getUserMedia(r)},e.navigator.getDisplayMedia=function(t){return r.deprecated("navigator.getDisplayMedia","navigator.mediaDevices.getDisplayMedia"),e.navigator.mediaDevices.getDisplayMedia(t)})}}}).call(this,n(2))},function(e,t,n){"use strict";(function(t){var r=n(27),i=r.log;e.exports=function(e){var n=r.detectBrowser(e),o=e&&e.navigator,a=e&&e.MediaStreamTrack,s=function(e){return{name:{InternalError:"NotReadableError",NotSupportedError:"TypeError",PermissionDeniedError:"NotAllowedError",SecurityError:"NotAllowedError"}[e.name]||e.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[e.message]||e.message,constraint:e.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},c=function(e,t,r){var a=function(e){if("object"!=typeof e||e.require)return e;var t=[];return Object.keys(e).forEach((function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r=e[n]="object"==typeof e[n]?e[n]:{ideal:e[n]};if(void 0===r.min&&void 0===r.max&&void 0===r.exact||t.push(n),void 0!==r.exact&&("number"==typeof r.exact?r.min=r.max=r.exact:e[n]=r.exact,delete r.exact),void 0!==r.ideal){e.advanced=e.advanced||[];var i={};"number"==typeof r.ideal?i[n]={min:r.ideal,max:r.ideal}:i[n]=r.ideal,e.advanced.push(i),delete r.ideal,Object.keys(r).length||delete e[n]}}})),t.length&&(e.require=t),e};return e=JSON.parse(JSON.stringify(e)),n.version<38&&(i("spec: "+JSON.stringify(e)),e.audio&&(e.audio=a(e.audio)),e.video&&(e.video=a(e.video)),i("ff37: "+JSON.stringify(e))),o.mozGetUserMedia(e,t,(function(e){r(s(e))}))};if(o.mediaDevices||(o.mediaDevices={getUserMedia:function(e){return new t((function(t,n){c(e,t,n)}))},addEventListener:function(){},removeEventListener:function(){}}),o.mediaDevices.enumerateDevices=o.mediaDevices.enumerateDevices||function(){return new t((function(e){e([{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}])}))},n.version<41){var u=o.mediaDevices.enumerateDevices.bind(o.mediaDevices);o.mediaDevices.enumerateDevices=function(){return u().then(void 0,(function(e){if("NotFoundError"===e.name)return[];throw e}))}}if(n.version<49){var d=o.mediaDevices.getUserMedia.bind(o.mediaDevices);o.mediaDevices.getUserMedia=function(e){return d(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("The object can not be found here.","NotFoundError");return t}),(function(e){return t.reject(s(e))}))}}if(!(n.version>55&&"autoGainControl"in o.mediaDevices.getSupportedConstraints())){var l=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},f=o.mediaDevices.getUserMedia.bind(o.mediaDevices);if(o.mediaDevices.getUserMedia=function(e){return"object"==typeof e&&"object"==typeof e.audio&&(e=JSON.parse(JSON.stringify(e)),l(e.audio,"autoGainControl","mozAutoGainControl"),l(e.audio,"noiseSuppression","mozNoiseSuppression")),f(e)},a&&a.prototype.getSettings){var p=a.prototype.getSettings;a.prototype.getSettings=function(){var e=p.apply(this,arguments);return l(e,"mozAutoGainControl","autoGainControl"),l(e,"mozNoiseSuppression","noiseSuppression"),e}}if(a&&a.prototype.applyConstraints){var h=a.prototype.applyConstraints;a.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"==typeof e&&(e=JSON.parse(JSON.stringify(e)),l(e,"autoGainControl","mozAutoGainControl"),l(e,"noiseSuppression","mozNoiseSuppression")),h.apply(this,[e])}}}o.getUserMedia=function(e,t,i){if(n.version<44)return c(e,t,i);r.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),o.mediaDevices.getUserMedia(e).then(t,i)}}}).call(this,n(2))},function(e,t,n){"use strict";(function(t){var r=n(27);e.exports={shimLocalStreamsAPI:function(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),"getStreamById"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getStreamById=function(e){var t=null;return this._localStreams&&this._localStreams.forEach((function(n){n.id===e&&(t=n)})),this._remoteStreams&&this._remoteStreams.forEach((function(n){n.id===e&&(t=n)})),t}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),-1===this._localStreams.indexOf(e)&&this._localStreams.push(e);var n=this;e.getTracks().forEach((function(r){t.call(n,r,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e,n){return n&&(this._localStreams?-1===this._localStreams.indexOf(n)&&this._localStreams.push(n):this._localStreams=[n]),t.call(this,e,n)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);var t=this._localStreams.indexOf(e);if(-1!==t){this._localStreams.splice(t,1);var n=this,r=e.getTracks();this.getSenders().forEach((function(e){-1!==r.indexOf(e.track)&&n.removeTrack(e)}))}})}},shimRemoteStreamsAPI:function(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){this._onaddstream&&this.removeEventListener("addstream",this._onaddstream),this.addEventListener("addstream",this._onaddstream=e)}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}}))}),t.apply(e,arguments)}}},shimCallbacksAPI:function(e){if("object"==typeof e&&e.RTCPeerConnection){var n=e.RTCPeerConnection.prototype,r=n.createOffer,i=n.createAnswer,o=n.setLocalDescription,a=n.setRemoteDescription,s=n.addIceCandidate;n.createOffer=function(e,n){var i=arguments.length>=2?arguments[2]:arguments[0],o=r.apply(this,[i]);return n?(o.then(e,n),t.resolve()):o},n.createAnswer=function(e,n){var r=arguments.length>=2?arguments[2]:arguments[0],o=i.apply(this,[r]);return n?(o.then(e,n),t.resolve()):o};var c=function(e,n,r){var i=o.apply(this,[e]);return r?(i.then(n,r),t.resolve()):i};n.setLocalDescription=c,c=function(e,n,r){var i=a.apply(this,[e]);return r?(i.then(n,r),t.resolve()):i},n.setRemoteDescription=c,c=function(e,n,r){var i=s.apply(this,[e]);return r?(i.then(n,r),t.resolve()):i},n.addIceCandidate=c}},shimGetUserMedia:function(e){var t=e&&e.navigator;t.getUserMedia||(t.webkitGetUserMedia?t.getUserMedia=t.webkitGetUserMedia.bind(t):t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t)))},shimRTCIceServerUrls:function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){for(var i=[],o=0;o<e.iceServers.length;o++){var a=e.iceServers[o];!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")?(r.deprecated("RTCIceServer.url","RTCIceServer.urls"),(a=JSON.parse(JSON.stringify(a))).urls=a.url,delete a.url,i.push(a)):i.push(e.iceServers[o])}e.iceServers=i}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},shimTrackEventTransceiver:function(e){"object"==typeof e&&e.RTCPeerConnection&&"receiver"in e.RTCTrackEvent.prototype&&!e.RTCTransceiver&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimCreateOfferLegacy:function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){var n=this;if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var r=n.getTransceivers().find((function(e){return e.sender.track&&"audio"===e.sender.track.kind}));!1===e.offerToReceiveAudio&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveAudio||r||n.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var i=n.getTransceivers().find((function(e){return e.sender.track&&"video"===e.sender.track.kind}));!1===e.offerToReceiveVideo&&i?"sendrecv"===i.direction?i.setDirection("sendonly"):"recvonly"===i.direction&&i.setDirection("inactive"):!0!==e.offerToReceiveVideo||i||n.addTransceiver("video")}return t.apply(n,arguments)}}}}).call(this,n(2))},function(e,t,n){"use strict";var r=n(251),i=n(27);e.exports={shimRTCIceCandidate:function(e){if(!(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var n=new t(e),i=r.parseCandidate(e.candidate),o=Object.assign(n,i);return o.toJSON=function(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}},o}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,i.wrapPeerConnectionEvent(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}},shimCreateObjectURL:function(e){var t=e&&e.URL;if("object"==typeof e&&e.HTMLMediaElement&&"srcObject"in e.HTMLMediaElement.prototype&&t.createObjectURL&&t.revokeObjectURL){var n=t.createObjectURL.bind(t),r=t.revokeObjectURL.bind(t),o=new Map,a=0;t.createObjectURL=function(e){if("getTracks"in e){var t="polyblob:"+ ++a;return o.set(t,e),i.deprecated("URL.createObjectURL(stream)","elem.srcObject = stream"),t}return n(e)},t.revokeObjectURL=function(e){r(e),o.delete(e)};var s=Object.getOwnPropertyDescriptor(e.HTMLMediaElement.prototype,"src");Object.defineProperty(e.HTMLMediaElement.prototype,"src",{get:function(){return s.get.apply(this)},set:function(e){return this.srcObject=o.get(e)||null,s.set.apply(this,[e])}});var c=e.HTMLMediaElement.prototype.setAttribute;e.HTMLMediaElement.prototype.setAttribute=function(){return 2===arguments.length&&"src"===(""+arguments[0]).toLowerCase()&&(this.srcObject=o.get(arguments[1])||null),c.apply(this,arguments)}}},shimMaxMessageSize:function(e){if(!e.RTCSctpTransport&&e.RTCPeerConnection){var t=i.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var n=function(e){var t=r.splitSections(e.sdp);return t.shift(),t.some((function(e){var t=r.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))},o=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var n=parseInt(t[1],10);return n!=n?-1:n},a=function(e){var n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n},s=function(e,n){var i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);var o=r.matchPrefix(e.sdp,"a=max-message-size:");return o.length>0?i=parseInt(o[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(i=2147483637),i},c=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;if(e._sctp=null,n(arguments[0])){var t,r=o(arguments[0]),i=a(r),u=s(arguments[0],r);t=0===i&&0===u?Number.POSITIVE_INFINITY:0===i||0===u?Math.max(i,u):Math.min(i,u);var d={};Object.defineProperty(d,"maxMessageSize",{get:function(){return t}}),e._sctp=d}return c.apply(e,arguments)}}},shimSendThrowTypeError:function(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=this,r=t.apply(e,arguments);return n(r,e),r},i.wrapPeerConnectionEvent(e,"datachannel",(function(e){return n(e.channel,e.target),e}))}function n(e,t){var n=e.send;e.send=function(){var r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}}}},function(e,t,n){"use strict";(function(t){const r=n(6);function i(){return"undefined"==typeof document||"complete"===document.readyState||"interactive"===document.readyState&&document.body}let o=!1;const a={isDomLoaded:i,isDomUnloaded:()=>o,whenUnloaded:new t(e=>{if("undefined"!=typeof window){const t=()=>{o=!0,a.emit("unload"),e()};window.addEventListener("unload",t)}}),whenLoaded:new t(e=>{if(i())return void e();const t=()=>{document.removeEventListener("DOMContentLoaded",t),document.removeEventListener("load",t),a.emit("load"),e()};document.addEventListener("DOMContentLoaded",t),document.addEventListener("load",t)})};r(a),e.exports=a}).call(this,n(2))},function(e,t,n){var r=n(79),i=n(256),o=n(239),a=n(584),s=n(11),c=n(54),u=n(257);e.exports=function e(t,n,d,l,f){t!==n&&o(n,(function(o,c){if(f||(f=new r),s(o))a(t,n,c,d,e,l,f);else{var p=l?l(u(t,c),o,c+"",t,n,f):void 0;void 0===p&&(p=o),i(t,c,p)}}),c)}},function(e,t,n){var r=n(256),i=n(180),o=n(189),a=n(55),s=n(190),c=n(64),u=n(12),d=n(131),l=n(65),f=n(17),p=n(11),h=n(138),m=n(86),g=n(257),v=n(585);e.exports=function(e,t,n,y,b,S,E){var _=g(e,n),T=g(t,n),R=E.get(T);if(R)r(e,n,R);else{var I=S?S(_,T,n+"",e,t,E):void 0,w=void 0===I;if(w){var C=u(T),O=!C&&l(T),A=!C&&!O&&m(T);I=T,C||O||A?u(_)?I=_:d(_)?I=a(_):O?(w=!1,I=i(T,!0)):A?(w=!1,I=o(T,!0)):I=[]:h(T)||c(T)?(I=_,c(_)?I=v(_):p(_)&&!f(_)||(I=s(T))):w=!1}w&&(E.set(T,I),b(I,T,y,S,E),E.delete(T)),r(e,n,I)}}},function(e,t,n){var r=n(41),i=n(54);e.exports=function(e){return r(e,i(e))}},function(e,t,n){"use strict";const r=n(148),i=n(258),o=n(259),a=n(264),s=n(0)("normalizeConstraintInput"),c={"320x240":{width:320,height:240},"320x180":{width:320,height:180},"640x480":{width:640,height:480},"640x360":{width:640,height:360},"1280x720":{width:1280,height:720},"1280x960":{width:1280,height:960},"1920x1080":{width:1920,height:1080}},u=[1,7,15,30];function d(e){return e._inject&&e._inject.logging||s}function l(e,t,n,r,i){if(void 0===t)return;const o=n(t);return o||i.warn(`Invalid ${e} passed to the Publisher. Got: ${t}, expecting one of ${r}`),o}function f(e,t){const n=d(t),r=(()=>{const n=t["publish"+o(e)];return void 0===n||Boolean(n)})();let i=(()=>{const r=t[e+"Source"];return void 0===r||null!==r&&!1!==r&&("object"==typeof r?!t[`isCustom${o(e)}Track`]&&("string"!=typeof r.deviceId?(n.warn(`Invalid ${e}Source passed to Publisher. Expected either a device ID or device.`),!0):r.deviceId):"string"!=typeof r?(n.warn(`Ignoring invalid ${e}Source parameter`),!0):r)})();return"audio"===e&&t.isScreenSharing&&!a&&!1!==i&&(t.audioSource&&d(t).warn("Invalid audioSource passed to Publisher - when using screen sharing no audioSource may be used"),i=!1),{source:i,publish:r}}function p(e,t){return"Chrome"===e.name&&-1!==e.userAgent.indexOf("Mac OS X")&&1===t?2:t}const h=["user","environment","left","right"],m=(e,t)=>{if(void 0===e||h.indexOf(e)>=0)return e;d(t).warn("Invalid facingMode passed to Publisher. Expected one of: "+h.join(", "))};e.exports=function(e){const t=d(e),n=e.env||{},o=e.isScreenSharing,a=e.isCustomAudioTrack,s=e.isCustomVideoTrack;return o&&!i&&r(e.usingOptionalMandatoryStyle,"Screensharing only uses optional-mandatory constraints right now"),["echoCancellation","autoGainControl","noiseSuppression"].forEach(t=>{!1!==e[t]&&Object.assign(e,{[t]:!0})}),{isScreenSharing:o,isCustomAudioTrack:a,isCustomVideoTrack:s,audio:f("audio",e),video:f("video",e),usingOptionalMandatoryStyle:e.usingOptionalMandatoryStyle,enableRenegotiation:e.enableRenegotiation,enableStereo:e.enableStereo,noiseSuppression:e.noiseSuppression,autoGainControl:e.autoGainControl,echoCancellation:e.echoCancellation,disableAudioProcessing:e.disableAudioProcessing,videoDimensions:l("resolution",e.resolution,e=>c[e],`"${Object.keys(c).join('", "')}"`,t),frameRate:p(n,l("frameRate",e.frameRate,e=>-1!==u.indexOf(e)?e:void 0,u.join(","),t)),maxResolution:function(){if(void 0===e.maxResolution)return o?{width:1920,height:1920}:void 0;const n={width:e.maxResolution.width,height:e.maxResolution.height};return Object.keys(n).forEach(e=>{const r=n[e];("number"!=typeof r||r>1920)&&(t.warn(`Invalid maxResolution passed to the Publisher. maxResolution.${e} must be less than or equal to 1920`),n[e]=1920)}),n}(),facingMode:m(e.facingMode,e)}}},function(e,t,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function a(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,s,c=a(e),u=1;u<arguments.length;u++){for(var d in n=Object(arguments[u]))i.call(n,d)&&(c[d]=n[d]);if(r){s=r(n);for(var l=0;l<s.length;l++)o.call(n,s[l])&&(c[s[l]]=n[s[l]])}}return c}},function(e,t,n){(function(e,r){var i=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},o=/%[sdj%]/g;t.format=function(e){if(!y(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(c(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,i=r.length,a=String(e).replace(o,(function(e){if("%%"===e)return"%";if(n>=i)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),s=r[n];n<i;s=r[++n])g(s)||!E(s)?a+=" "+s:a+=" "+c(s);return a},t.deprecate=function(n,r){if(void 0!==e&&!0===e.noDeprecation)return n;if(void 0===e)return function(){return t.deprecate(n,r).apply(this,arguments)};var i=!1;return function(){if(!i){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),i=!0}return n.apply(this,arguments)}};var a,s={};function c(e,n){var r={seen:[],stylize:d};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),m(n)?r.showHidden=n:n&&t._extend(r,n),b(r.showHidden)&&(r.showHidden=!1),b(r.depth)&&(r.depth=2),b(r.colors)&&(r.colors=!1),b(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=u),l(r,e,r.depth)}function u(e,t){var n=c.styles[t];return n?"["+c.colors[n][0]+"m"+e+"["+c.colors[n][1]+"m":e}function d(e,t){return e}function l(e,n,r){if(e.customInspect&&n&&R(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,e);return y(i)||(i=l(e,i,r)),i}var o=function(e,t){if(b(t))return e.stylize("undefined","undefined");if(y(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return v(t)?e.stylize(""+t,"number"):m(t)?e.stylize(""+t,"boolean"):g(t)?e.stylize("null","null"):void 0}(e,n);if(o)return o;var a=Object.keys(n),s=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(n)),T(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return f(n);if(0===a.length){if(R(n)){var c=n.name?": "+n.name:"";return e.stylize("[Function"+c+"]","special")}if(S(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(_(n))return e.stylize(Date.prototype.toString.call(n),"date");if(T(n))return f(n)}var u,d="",E=!1,I=["{","}"];return h(n)&&(E=!0,I=["[","]"]),R(n)&&(d=" [Function"+(n.name?": "+n.name:"")+"]"),S(n)&&(d=" "+RegExp.prototype.toString.call(n)),_(n)&&(d=" "+Date.prototype.toUTCString.call(n)),T(n)&&(d=" "+f(n)),0!==a.length||E&&0!=n.length?r<0?S(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),u=E?function(e,t,n,r,i){for(var o=[],a=0,s=t.length;a<s;++a)A(t,String(a))?o.push(p(e,t,n,r,String(a),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(p(e,t,n,r,i,!0))})),o}(e,n,r,s,a):a.map((function(t){return p(e,n,r,s,t,E)})),e.seen.pop(),function(e,t,n){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(u,d,I)):I[0]+d+I[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,n,r,i,o){var a,s,c;if((c=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(s=e.stylize("[Setter]","special")),A(r,i)||(a="["+i+"]"),s||(e.seen.indexOf(c.value)<0?(s=g(n)?l(e,c.value,null):l(e,c.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),b(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function h(e){return Array.isArray(e)}function m(e){return"boolean"==typeof e}function g(e){return null===e}function v(e){return"number"==typeof e}function y(e){return"string"==typeof e}function b(e){return void 0===e}function S(e){return E(e)&&"[object RegExp]"===I(e)}function E(e){return"object"==typeof e&&null!==e}function _(e){return E(e)&&"[object Date]"===I(e)}function T(e){return E(e)&&("[object Error]"===I(e)||e instanceof Error)}function R(e){return"function"==typeof e}function I(e){return Object.prototype.toString.call(e)}function w(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(n){if(b(a)&&(a=e.env.NODE_DEBUG||""),n=n.toUpperCase(),!s[n])if(new RegExp("\\b"+n+"\\b","i").test(a)){var r=e.pid;s[n]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",n,r,e)}}else s[n]=function(){};return s[n]},t.inspect=c,c.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},c.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=h,t.isBoolean=m,t.isNull=g,t.isNullOrUndefined=function(e){return null==e},t.isNumber=v,t.isString=y,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=b,t.isRegExp=S,t.isObject=E,t.isDate=_,t.isError=T,t.isFunction=R,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(589);var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function O(){var e=new Date,t=[w(e.getHours()),w(e.getMinutes()),w(e.getSeconds())].join(":");return[e.getDate(),C[e.getMonth()],t].join(" ")}function A(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",O(),t.format.apply(t,arguments))},t.inherits=n(590),t._extend=function(e,t){if(!t||!E(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e};var x="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function k(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(x&&e[x]){var t;if("function"!=typeof(t=e[x]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,x,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,i=new r((function(e,r){t=e,n=r})),o=[],a=0;a<arguments.length;a++)o.push(arguments[a]);o.push((function(e,r){e?n(e):t(r)}));try{e.apply(this,o)}catch(e){n(e)}return i}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),x&&Object.defineProperty(t,x,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,i(e))},t.promisify.custom=x,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var i=n.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var o=this,a=function(){return i.apply(o,arguments)};t.apply(this,n).then((function(t){e.nextTick(a,null,t)}),(function(t){e.nextTick(k,t,a)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(t)),Object.defineProperties(n,i(t)),n}}).call(this,n(43),n(2))},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){var r=n(592),i=n(262),o=n(263),a=n(60);e.exports=function(e){return function(t){t=a(t);var n=i(t)?o(t):void 0,s=n?n[0]:t.charAt(0),c=n?r(n,1).join(""):t.slice(1);return s[e]()+c}}},function(e,t,n){var r=n(261);e.exports=function(e,t,n){var i=e.length;return n=void 0===n?i:n,!t&&n>=i?e:r(e,t,n)}},function(e,t){e.exports=function(e){return e.split("")}},function(e,t){var n="[\\ud800-\\udfff]",r="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",i="\\ud83c[\\udffb-\\udfff]",o="[^\\ud800-\\udfff]",a="(?:\\ud83c[\\udde6-\\uddff]){2}",s="[\\ud800-\\udbff][\\udc00-\\udfff]",c="(?:"+r+"|"+i+")?",u="[\\ufe0e\\ufe0f]?"+c+"(?:\\u200d(?:"+[o,a,s].join("|")+")[\\ufe0e\\ufe0f]?"+c+")*",d="(?:"+[o+r+"?",r,a,s,n].join("|")+")",l=RegExp(i+"(?="+i+")|"+d+u,"g");e.exports=function(e){return e.match(l)||[]}},function(e,t,n){"use strict";e.exports=["screen","window","tab","browser","application"]},function(e,t,n){"use strict";const r=n(0),i=n(35)(),o=n(51),a=n(121),s=n(598),c=n(601),u=i.onlyLocal(),d=r("setLogLevel"),l=o(()=>{d.info("%c\n âââââââ âââââââ ââââââââââââ   ââââââââââââ âââââââ âââ  âââ\nââââââââââââââââââââââââââââââ  ââââââââââââââââââââââââ ââââ\nâââ   âââââââââââââââââ  ââââââ âââ   âââ   âââ   ââââââââââ\nâââ   ââââââââââ ââââââ  ââââââââââ   âââ   âââ   ââââââââââ\nââââââââââââ     âââââââââââ ââââââ   âââ   ââââââââââââ  âââ\n âââââââ âââ     âââââââââââ  âââââ   âââ    âââââââ âââ  âââ",'font-family: "Fire Code", Courier, "Courier New", Consolas, "DejaVu Sans Mono"'),d.info("OpenTok JS SDK "+u.version),d.info(`Release notes: ${u.websiteUrl}/opentok/webrtc/docs/js/release-notes.html`),d.info(`Known issues: ${u.websiteUrl}/opentok/webrtc/docs/js/release-notes.htmll#knownIssues`)});function f(e){if(void 0===e||!s(a,{priority:e})&&0!==e){const t=c(a,(e,t)=>`OT.${t.toUpperCase()} = ${e.priority}`).join(", ");d.error("level must be one of: OT.NONE = 0, "+t),d.warn("Using OT.WARN instead"),e=a.warn.priority}return r.setLogLevel(e),e>=a.debug.priority&&l(),d.info("OpenTok JS SDK now uses the debug library. More info at https://www.npmjs.com/package/debug#browser-support"),d.info("Changed log level to: "+e),e}f(u.debug?a.debug.priority:a.warn.priority),e.exports=f},function(e,t,n){var r=n(97);e.exports=function(e,t){var n;if("function"!=typeof t)throw new TypeError("Expected a function");return e=r(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}}},function(e,t,n){var r=n(232),i=n(36),o=n(599),a=n(12),s=n(124);e.exports=function(e,t,n){var c=a(e)?r:o;return n&&s(e,t,n)&&(t=void 0),c(e,i(t,3))}},function(e,t,n){var r=n(266);e.exports=function(e,t){var n;return r(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}},function(e,t,n){var r=n(25);e.exports=function(e,t){return function(n,i){if(null==n)return n;if(!r(n))return e(n,i);for(var o=n.length,a=t?o:-1,s=Object(n);(t?a--:++a<o)&&!1!==i(s[a],a,s););return n}}},function(e,t,n){var r=n(34),i=n(36),o=n(602),a=n(12);e.exports=function(e,t){return(a(e)?r:o)(e,i(t,3))}},function(e,t,n){var r=n(266),i=n(25);e.exports=function(e,t){var n=-1,o=i(e)?Array(e.length):[];return r(e,(function(e,r,i){o[++n]=t(e,r,i)})),o}},function(e,t,n){"use strict";e.exports=function(e){return"http:"!==e.substr(0,5)&&"https:"!==e.substr(0,6)&&"data:image/png;base64,"!==e.substr(0,22)?"data:image/png;base64,"+e:e}},function(e,t,n){"use strict";const r=n(57),i=n(0)("Style");e.exports=function(e,t){const n=this,o={},a={buttonDisplayMode:["auto","mini","mini-auto","off","on"],nameDisplayMode:["auto","off","on"],audioLevelDisplayMode:["auto","off","on"],showSettingsButton:[!0,!1],showSpeakerButton:null,showMicButton:[!0,!1],backgroundImageURI:null,showControlBar:[!0,!1],showArchiveStatus:[!0,!1],archiveStatusDisplayMode:["auto","off","on"],videoDisabledDisplayMode:["auto","off","on"],audioBlockedDisplayMode:["auto","off","on"]};n.getAll=function(){return r(o)},n.get=function(e){return e?o[e]:n.getAll()},n.setAll=function(e,t){return Object.keys(e).forEach(r=>{n.set(r,e[r],t)}),n},n.set=function(e,r,s){let c;i.debug("setStyle: "+e.toString());const u=function(e){switch(e){case"true":return!0;case"false":return!1;default:return e}}(r);return function(e,t){const n=a[e];return void 0!==n&&(null===n||-1!==n.indexOf(t))}(e,u)?(c=o[e],u!==c&&(o[e]=u,s||t(e,r,c)),n):(i.warn(`Style.set::Invalid style property passed ${e} : ${u}`),n)},e&&n.setAll(e,!0)}},function(e,t,n){"use strict";const r=n(3),i=n(270);e.exports=()=>Boolean("Node"!==r.name&&!r.isIosWebView&&(!!i()||(void 0!==typeof window?window:global).navigator.mediaDevices&&(void 0!==typeof window?window:global).navigator.mediaDevices.getUserMedia||(void 0!==typeof window?window:global).navigator.webkitGetUserMedia||(void 0!==typeof window?window:global).navigator.mozGetUserMedia))},function(e,t,n){"use strict";const r=n(3);e.exports=()=>"Node"!==r.name&&(!("function"!=typeof(void 0!==typeof window?window:global).webkitRTCPeerConnection||!(void 0!==typeof window?window:global).webkitRTCPeerConnection.prototype.addTrack)||"function"==typeof(void 0!==typeof window?window:global).RTCPeerConnection||"function"==typeof(void 0!==typeof window?window:global).mozRTCPeerConnection&&r.version>20)},function(e,t,n){"use strict";e.exports=void 0!==(void 0!==typeof window?window:global).WebSocket},function(e,t){e.exports='<div id="tb_alert"><div id="section-normal-install" class="OT_alert"><div class="OT_alert-exclamation">!</div><button class="OT_alert-close-button" role="OT_close">&#x00D7;</button><div class="OT_alert-header" data-text="Incompatible Browser">Incompatible Browser</div><div class="OT_alert-body">The video component of this application requires <a target="_blank" href="https://www.google.com/chrome/">Google Chrome</a>, <a target="_blank" href="http://www.mozilla.org/firefox">Firefox</a>, <a target="_blank" href="https://www.microsoft.com/en-us/edge">Edge</a>, or <a target="_blank" href="https://www.apple.com/safari/">Safari</a>.</div></div><div id="section-upgrade-install" class="OT_alert"><div class="OT_alert-exclamation">!</div><button class="OT_alert-close-button" role="OT_close">&#x00D7;</button><div class="OT_alert-header" data-text="Incompatible Browser">Incompatible Browser</div><div class="OT_alert-body">The video component of this application requires a newer version of <a target="_blank" href="https://www.google.com/chrome/">Google Chrome</a>, <a target="_blank" href="http://www.mozilla.org/firefox">Firefox</a>, <a target="_blank" href="https://www.microsoft.com/en-us/edge">Edge</a>, or <a target="_blank" href="https://www.apple.com/safari/">Safari</a>.</div><div class="continue-text"><a href="#" role="OT_close">Continue at my own risk.</a></div></div><div id="section-supported-mobile-browser" class="OT_alert"><div class="OT_alert-exclamation">!</div><button class="OT_alert-close-button" role="OT_close">&#x00D7;</button><div class="OT_alert-header" data-text="Incompatible Browser">Incompatible Browser</div><div class="OT_alert-body">The video component of this application requires a newer version of <a target="_blank" href="https://www.google.com.au/chrome/browser/mobile/">Google Chrome</a>.</div><div class="continue-text"><a href="#" role="OT_close">Continue at my own risk.</a></div></div><div id="section-mobile-browser" class="OT_alert"><div class="OT_alert-exclamation">!</div><button class="OT_alert-close-button" role="OT_close">&#x00D7;</button><div class="OT_alert-header" data-text="Incompatible Browser">Incompatible Browser</div><div class="OT_alert-body">The video component of this application is not supported on your mobile device\'s browser at this time.</div></div></div>'},function(e,t,n){"use strict";var r=n(1)(n(49));const i=n(14);e.exports=function(e){function t(t,n){var r;let i=(void 0===n?{}:n).destroyOnClose,o=void 0===i||i;(r=e.call(this)||this).modalDiv=document.createElement("div"),r.modalDiv.classList.add("OT_ModalDialog"),r.modalDiv.innerHTML=t;const a=r.modalDiv.querySelectorAll("[role=OT_close]");return[].forEach.call(a,e=>e.addEventListener("click",e=>{e.preventDefault(),r.close()})),r.close(),document.body.appendChild(r.modalDiv),o&&r.on("closed",()=>r.destroy()),r}(0,r.default)(t,e);var n=t.prototype;return n.open=function(){this.modalDiv.style.display="block",this.emit("opened")},n.close=function(){this.modalDiv.style.display="none",this.emit("closed")},n.destroy=function(){this.modalDiv.innerHTML="",this.modalDiv.parentNode.removeChild(this.modalDiv),this.emit("destroyed")},n.el=function(e){return this.modalDiv.querySelector(e)},t}(i)},function(e,t,n){"use strict";const r=n(21);e.exports=function(e){void 0===e&&(e={});const t=e.env||n(3),i=e.analytics||new r;i.logEvent({action:"UserAgentParsing",variation:"Attempt",payload:{userAgent:t.userAgent}}),i.logEvent({action:"UserAgentParsing",variation:t.error?"Failure":"Success",payload:{userAgent:t.userAgent}})}},function(e,t,n){var r=n(612),i=n(271),o=n(613),a=n(614);function s(t){var n="function"==typeof Map?new Map:void 0;return e.exports=s=function(e){if(null===e||!o(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return a(e,arguments,r(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i(t,e)},s(t)}e.exports=s},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t){e.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}},function(e,t,n){var r=n(271);function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function o(t,n,a){return i()?e.exports=o=Reflect.construct:e.exports=o=function(e,t,n){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return n&&r(o,n.prototype),o},o.apply(null,arguments)}e.exports=o},function(e,t,n){"use strict";(function(t){e.exports=(e,n)=>(n=n||(()=>{}),e.then(e=>new t(e=>{e(n())}).then(()=>e),e=>new t(e=>{e(n())}).then(()=>{throw e})))}).call(this,n(2))},function(e,t,n){var r=n(59),i=n(617),o=n(618),a=n(47);e.exports=function(e,t){return t=r(t,e),null==(e=o(e,t))||delete e[a(i(t))]}},function(e,t){e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},function(e,t,n){var r=n(99),i=n(261);e.exports=function(e,t){return t.length<2?e:r(e,i(t,0,-1))}},function(e,t,n){var r=n(138);e.exports=function(e){return r(e)?void 0:e}},function(e,t,n){var r=n(36),i=n(25),o=n(31);e.exports=function(e){return function(t,n,a){var s=Object(t);if(!i(t)){var c=r(n,3);t=o(t),n=function(e){return c(s[e],e,s)}}var u=e(t,n,a);return u>-1?s[c?t[u]:u]:void 0}}},function(e,t,n){var r=n(93),i=n(94),o=n(130),a=n(95),s=n(622),c=n(98);e.exports=function(e,t,n){var u=-1,d=i,l=e.length,f=!0,p=[],h=p;if(n)f=!1,d=o;else if(l>=200){var m=t?null:s(e);if(m)return c(m);f=!1,d=a,h=new r}else h=t?[]:p;e:for(;++u<l;){var g=e[u],v=t?t(g):g;if(g=n||0!==g?g:0,f&&v==v){for(var y=h.length;y--;)if(h[y]===v)continue e;t&&h.push(v),p.push(g)}else d(h,v,n)||(h!==p&&h.push(v),p.push(g))}return p}},function(e,t,n){var r=n(186),i=n(224),o=n(98),a=r&&1/o(new r([,-0]))[1]==1/0?function(e){return new r(e)}:i;e.exports=a},function(e,t,n){"use strict";e.exports=e=>(e=>parseInt(e,10))((e=>e.substring(0,9))((e=>e&&e.replace(/\D+/g,"")||"0")(e)))},function(e,t,n){"use strict";(function(t){var r=n(1),i=r(n(4)),o=r(n(5));const a=n(0)("hasValidPeerConnection");function s(e){return new t(t=>{e.addEventListener("signalingstatechange",()=>t(!0)),e.createOffer({offerToReceiveAudio:1}).then(t=>e.setLocalDescription(t)).then(()=>setTimeout(()=>{t(!1)},1e3))})}function c(){return(c=(0,o.default)(i.default.mark((function e(t){var n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=new t({iceServers:[]}),e.next=8;break;case 4:return e.prev=4,e.t0=e.catch(0),a.error("Error occurred creating PeerConnection",e.t0),e.abrupt("return",!1);case 8:return e.prev=8,e.next=11,s(n);case 11:e.next=18;break;case 13:e.prev=13,e.t1=e.catch(8),a.error("Error occurred checking the validity of the PeerConnection",e.t1);try{n.close()}catch(e){}return e.abrupt("return",!1);case 18:e.prev=18,n.close(),e.next=26;break;case 22:return e.prev=22,e.t2=e.catch(18),a.error("Error occurred closing PeerConnection",e.t2),e.abrupt("return",!1);case 26:return e.abrupt("return",!0);case 27:case"end":return e.stop()}}),e,null,[[0,4],[8,13],[18,22]])})))).apply(this,arguments)}e.exports=function(e){return c.apply(this,arguments)}}).call(this,n(2))},function(e,t,n){"use strict";(function(t){const r=n(38),i=n(3),o=n(626),a=n(73),s=n(0)("createPeerConnection");e.exports=function(e){let n=e.window,c=e.config,u=e.constraints;s.debug("called");const d=r(c);d.iceServers=o(i,d.iceServers),a()&&(d.sdpSemantics="plan-b");const l=new n.RTCPeerConnection(d,u);return t.resolve(l)}}).call(this,n(2))},function(e,t,n){"use strict";const r=n(9),i=n(272),o={Edge(e){let t=!1;return e.map(e=>{if(!e)return;const n=e.urls||e.url&&[e.url];if(!n)return;const o=n.filter(e=>0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||t?0===e.indexOf("stun:"):(t=!0,!0));return 0!==o.length?r(i(e,["url","urls"]),{urls:o}):void 0}).filter(e=>void 0!==e)},Safari:e=>e.map(e=>{if(void 0!==e.urls&&void 0===e.url)return e;const t=e.urls||e.url&&[e.url];return r(i(e,["url","urls"]),{urls:t})})};e.exports=function(e,t){let n=e.name;e.isEdge&&(n=e.isLegacyEdge?"Edge":"ChromiumEdge");const r=o[n];return r?r(t):t}},function(e,t,n){"use strict";const r=n(28),i=n(3),o={baseline:"42001f",constBaseline:"42e01f"},a=e=>{let t=e.sdp,n=e.from,r=e.to;return t.replace(new RegExp("^(a=fmtp:\\d+ .*profile-level-id=)"+n,"gmi"),"$1"+r)};e.exports={local:{offer:function(e,t){let n=void 0===e?{}:e,s=n.numSimulcastStreams,c=n.audioBitrate,u=n.priorityVideoCodec,d=void 0===u?"":u,l=n.codecFlags,f=void 0===l?{}:l,p=n.enableStereo,h=void 0!==p&&p,m=n.enableDtx,g=void 0!==m&&m,v=n.replaceBaselineProfile,y=void 0!==v&&v,b=n.removeVideoOrientation,S=void 0!==b&&b,E=r.filterExcessSSRCs(t);s>1&&(E=r.enableSimulcast(E,s)),c>0&&(E=r.setAudioBitrate(E,c)),S&&(E=r.removeVideoOrientation(E)),E=r.modifyReceiveStereo(E,!1),E=r.modifySendStereo(E,Boolean(h)),E=r.modifyDtx(E,Boolean(g)),i.isLegacyEdge||Object.keys(f).filter(e=>!1===f[e]).forEach(e=>{E=r.removeVideoCodec(E,e)}),d&&!i.isLegacyEdge?E=r.reprioritizeVideoCodec(E,d,"top"):"h264"!==d&&(E=r.reprioritizeVideoCodec(E,"h264","bottom"));let _=E;return y&&(_=a({sdp:_,from:o.baseline,to:o.constBaseline})),{local:E,remote:_}},answer:function(e,t){let n=void 0===e?{}:e,i=n.audioBitrate,s=n.codecFlags,c=n.enableStereo,u=void 0!==c&&c,d=n.enableDtx,l=void 0!==d&&d,f=n.replaceBaselineProfile,p=void 0!==f&&f,h=n.sourceStreamId,m=t;i>0&&(m=r.setAudioBitrate(m,i)),m=r.modifyReceiveStereo(m,Boolean(u)),m=r.modifySendStereo(m,!1),m=r.modifyDtx(m,Boolean(l)),"MANTIS"===h&&"passive"===r.getSetupRole(m)&&(m=r.setSetupRole(m,"active")),s&&Object.keys(s).filter(e=>!1===s[e]).forEach(e=>{m=r.removeVideoCodec(m,e)});let g=m;return p&&(g=a({sdp:g,from:o.baseline,to:o.constBaseline})),{local:m,remote:g}}},remote:{offer:(e,t)=>{let n=e.replaceBaselineProfile,r=void 0!==n&&n,i=t;if(-1===i.indexOf("a=rtcp-fb")){const e="a=rtcp-fb:* ccm fir\r\na=rtcp-fb:* nack ";i=i.replace(/^m=video(.*)$/gim,"m=video$1\r\n"+e)}return r&&(i=a({sdp:i,from:o.constBaseline,to:o.baseline})),{local:i}},answer:function(e,t){let n=void 0===e?{}:e,i=n.audioBitrate,s=n.replaceBaselineProfile,c=void 0!==s&&s,u=t;return i>0&&(u=r.setAudioBitrate(u,i)),c&&(u=a({sdp:u,from:o.constBaseline,to:o.baseline})),{local:u}}}}},function(e,t,n){var r=n(40),i=n(55),o=n(42),a=n(25),s=n(276),c=n(629),u=n(233),d=n(98),l=n(263),f=n(277),p=r?r.iterator:void 0;e.exports=function(e){if(!e)return[];if(a(e))return s(e)?l(e):i(e);if(p&&e[p])return c(e[p]());var t=o(e);return("[object Map]"==t?u:"[object Set]"==t?d:f)(e)}},function(e,t){e.exports=function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}},function(e,t,n){var r=n(34);e.exports=function(e,t){return r(t,(function(t){return e[t]}))}},function(e,t,n){"use strict";e.exports=(e,t)=>{let n=[],r=null;if("function"==typeof e.getReceivers){const t=e.getReceivers().find(e=>"audio"===e.track.kind);t&&(n=t.getSynchronizationSources())}else r=new Error("peerConnection does not support getReceivers function");t&&t(r,n)}},function(e,t,n){"use strict";(function(t){const r=n(633),i=function(e){this.pending=[],this._processBinding=this.maybeProcessPending.bind(this),e&&this.setPeerConnection(e)};i.prototype.setPeerConnection=function(e){if(this.pc)throw new Error("Peer connection already set");this.pc=e,this._forwardIceCandidate=r(this.pc,"addIceCandidate"),this.pc.addEventListener("signalingstatechange",this._processBinding),this.maybeProcessPending()},i.prototype.canAddCandidates=function(){return!!(this.pc&&"closed"!==this.pc.iceConnectionState&&this.pc.remoteDescription&&this.pc.remoteDescription.type&&this.pc.localDescription&&this.pc.localDescription.type)},i.prototype.addIceCandidate=function(e){if(this.canAddCandidates())return this._forwardIceCandidate(e);const n=this.pending;return new t((t,r)=>{n.push({iceCandidate:e,resolve:t,reject:r})})},i.prototype.maybeProcessPending=function(){this.canAddCandidates()&&this.process()},i.prototype.process=function(){for(;this.pending.length;){const e=this.pending.shift();this._forwardIceCandidate(e.iceCandidate).then(e.resolve).catch(e.reject)}},i.prototype.destroy=function(){this.pc&&this.pc.removeEventListener("signalingstatechange",this._processBinding),this._processBinding=null,this.pc=null},e.exports=i}).call(this,n(2))},function(e,t,n){"use strict";(function(t){e.exports=function(e,n){const r=e[n];return function(n){return new t((t,i)=>{const o=r.apply(e,[n,t,i]);o&&"function"==typeof o.then&&t(o)})}}}).call(this,n(2))},function(e,t,n){"use strict";const r=n(156),i=n(3),o=n(0)("offerProcessor"),a=n(28),s=n(635);e.exports=function(e,t,n,c,u,d,l,f,p,h,m,g,v){const y=(e,t)=>n=>{o.error(e),o.error(n),h&&h(e,n,t)},b=t=>{const n=a.hasSendStereo(d.sdp),i=a.hasSendDtx(d.sdp),o=a.getAudioBitrate(d.sdp),s=r(u,"local","answer",{enableStereo:n,enableDtx:i,audioBitrate:o,replaceBaselineProfile:g,codecFlags:l,sourceStreamId:v},t.sdp),f=new c({type:t.type,sdp:s.local}),h={type:t.type,sdp:s.remote};return e.setLocalDescription(f).then(()=>p(h)).catch(y("Error while setting LocalDescription","SetLocalDescription"))},S=new c({type:d.type,sdp:r(u,"remote","offer",{replaceBaselineProfile:g},d.sdp).local}),E=y("Error while setting RemoteDescription","SetRemoteDescription");return s(S,f,i,t,n).then(()=>(m(!0),S)).catch(e=>{if(m(!1),!a.hasMediaType(S.sdp,"audio"))throw new Error("Unsupported video without audio for fallback");o.debug("Couldn't set remote description",S,e,", trying without video");const t=new c({type:d.type,sdp:a.disableMediaType(S.sdp,"video")});return o.debug("offer without video",t.sdp),t}).then(t=>e.setRemoteDescription(t)).then(()=>e.createAnswer().then(b).catch(y("Error while setting createAnswer","CreateAnswer"))).catch(E)}},function(e,t,n){"use strict";(function(t){const r=n(73);e.exports=(e,n,i,o,a)=>{if(!o)return t.resolve(!0);const s={iceServers:[]};r()&&(s.sdpSemantics="plan-b");const c=new o(s),u=()=>{try{c.close()}catch(e){}};return c.setRemoteDescription(new a(e)).then(()=>{u()}).catch(e=>{throw u(),e})}}).call(this,n(2))},function(e,t,n){"use strict";const r=n(61),i=n(637);e.exports=function(e){let t=[];const n={};let o={sentMessages:0,recvMessages:0};const a=function(e){const n=new i(e);return t.push(n),n.on("close",()=>{!function(e){t.filter(t=>e!==t)}(n)}),n};return n.add=function(t,n){return a(e.createDataChannel(t,n))},n.addMany=function(e){for(const t in e)e.hasOwnProperty(t)&&n.add(t,e[t])},n.get=function(e,n){return r(t,t=>t.equals(e,n))},n.getOrAdd=function(e,t){let r=n.get(e,t);return r||(r=n.add(e,t)),r},n.getQosData=function(){const e={sentMessages:0,recvMessages:0};return t.forEach(t=>{e.sentMessages+=t.getQosData().sentMessages,e.recvMessages+=t.getQosData().recvMessages}),e},n.sampleQos=function(){const e=n.getQosData(),t={sentMessages:e.sentMessages-o.sentMessages,recvMessages:e.recvMessages-o.recvMessages};return o=e,t},n.destroy=function(){t.forEach(e=>{e.close()}),t=[]},e.addEventListener("datachannel",e=>{a(e.channel)}),n}},function(e,t,n){"use strict";const r=n(6),i=n(0)("DataChannel"),o=function(e){this.data=e.data,this.source=e.source,this.lastEventId=e.lastEventId,this.origin=e.origin,this.timeStamp=e.timeStamp,this.type=e.type,this.ports=e.ports,this.path=e.path};e.exports=function(e){const t={},n=[],a={sentMessages:0,recvMessages:0},s=function(e){return n.push(e),t},c=function(n){return e.send(n),a.sentMessages++,t};return r(t,!0),t.label=e.label,t.id=e.id,t.reliable=e.reliable,t.negotiated=e.negotiated,t.ordered=e.ordered,t.protocol=e.protocol,t._channel=e,t.close=function(){e.close()},t.equals=function(e,n){if(t.label!==e)return!1;for(const e in n)if(n.hasOwnProperty(e)&&t[e]!==n[e])return!1;return!0},t.getQosData=function(){return a},t.send=s,e.addEventListener("open",(function(){t.send=c,function(){let e;for(;e=n.shift();)t.send(e)}()}),!1),e.addEventListener("close",(function(e){t.send=s,t.trigger("close",e)}),!1),e.addEventListener("error",(function(e){i.error(e)}),!1),e.addEventListener("message",(function(e){const n=new o(e);a.recvMessages++,t.trigger("message",n)}),!1),t}},function(e,t,n){"use strict";const r=n(9),i=n(156),o=n(0)("subscribeProcessor"),a=n(28);e.exports=function(e){let t=e.peerConnection,n=e.NativeRTCSessionDescription,s=e.sdpTransforms,c=e.numSimulcastStreams,u=e.offerOverrides,d=e.offerConstraints,l=e.replaceBaselineProfile,f=e.removeVideoOrientation,p=e.removeUnusedCodecs;const h=(e,t)=>n=>{o.error(e,n);const r=new Error(e);throw r.reason=n,r.prefix=t,r};return o.debug("subscribeProcessor: creating offer"),t.createOffer(d).then(e=>{o.debug("subscribeProcessor: offer created",e);let d=e.sdp;var m;p&&(d=a.removeUnusedCodecs(d,null==(m=t.currentLocalDescription)?void 0:m.sdp));const g=i(s,"local","offer",r({numSimulcastStreams:c,replaceBaselineProfile:l,removeVideoOrientation:f},u),d),v=new n({type:e.type,sdp:g.local}),y=new n({type:e.type,sdp:g.remote});return o.debug("subscribeProcessor: setting local description"),t.setLocalDescription(v).then(()=>y,h("Error while setting LocalDescription","SetLocalDescription"))},h("Error while creating Offer","CreateOffer")).then(e=>({sdp:e.sdp,type:e.type}))}},function(e,t,n){"use strict";const r=n(640);let i=function(){function e(e){this.state=r.RESOLVED,this.offerAnswerQueue=[],this.logAnalyticsEvent=e}var t=e.prototype;return t.setPending=function(){this.state=r.PENDING},t.setResolved=function(){this.state=r.RESOLVED;const e=this.offerAnswerQueue.shift();e&&(this.logAnalyticsEvent("dequeueOfferAnswer","Event"),this.setPending(),e())},t.isPending=function(){return this.state===r.PENDING},t.enqueueOfferAnswer=function(e){this.isPending()?(this.offerAnswerQueue.push(e),this.logAnalyticsEvent("enqueueOfferAnswer","Event")):(this.setPending(),e())},e}();e.exports=i},function(e,t,n){"use strict";e.exports={PENDING:"pending",RESOLVED:"resolved"}},function(e,t,n){"use strict";var r=n(1),i=r(n(4)),o=r(n(5));const a=n(28),s=a.mediaDirections,c=s.RECVONLY,u=s.INACTIVE,d=function(){var e=(0,o.default)(i.default.mark((function e(t,n){var r,o,s;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.createOffer();case 4:return r=e.sent,e.next=7,t.setLocalDescription(r);case 7:o=t.remoteDescription.sdp,s=a.changeMediaDirection(o,n),t.setRemoteDescription({type:t.remoteDescription.type,sdp:s});case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();e.exports={changeMediaDirectionToInactive:e=>d(e,u),changeMediaDirectionToRecvOnly:e=>d(e,c)}},function(e,t,n){"use strict";function r(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t.__esModule=!0,t.default=function(e,t,n,r,i){return l?y(e,t,n,r,i):v(e,0,n,0,i)},t.parseStatsNewAPI=y,t.parseStatsOldAPI=v;const o=n(3),a=n(8),s=n(0)("QoS"),c=n(28),u=n(280),d=n(643),l=n(104)(),f=n(157),p=["audioCodec","audioSentBytes","audioSentPackets","audioSentPacketsLost","audioRtt","videoCodec","videoHeight","videoHeightInput","videoSentBytes","videoFrameRateSent","videoSentPackets","videoRtt","videoSentPacketsLost","videoWidthInput","videoWidth","srtpCipher"],h=["audioCodec","audioRecvBytes","audioRecvPackets","audioRecvPacketsLost","videoCodec","videoHeight","videoRecvBytes","videoRecvPackets","videoRecvPacketsLost","videoFrameRateReceived","videoWidth","srtpCipher"],m=(e,t)=>s.debug(`Raw stats for peer conn ${e.id}:`,t),g=e=>{const t=e.portNumber||e.port;return`${e.ipAddress||e.address||e.ip}:${t}`};function v(e,t,n,r,i){const o=e=>(Number(e.stat("googFrameRateSent"))>0?(n.videoSentBytes=Number(e.stat("bytesSent")),n.videoSentPackets=Number(e.stat("packetsSent")),n.videoSentPacketsLost=Number(e.stat("packetsLost")),n.videoRtt=Number(e.stat("googRtt"))/1e3,n.videoFrameRate=Number(e.stat("googFrameRateInput")),n.videoWidth=Number(e.stat("googFrameWidthSent")),n.videoHeight=Number(e.stat("googFrameHeightSent")),n.videoFrameRateSent=Number(e.stat("googFrameRateSent")),n.videoWidthInput=Number(e.stat("googFrameWidthInput")),n.videoHeightInput=Number(e.stat("googFrameHeightInput")),n.videoCodec=e.stat("googCodecName"),n.videoBandwidthLimitedResolution="true"===e.stat("googBandwidthLimitedResolution"),n.cpuLimitedResolution="true"===e.stat("googCpuLimitedResolution")):Number(e.stat("googFrameRateReceived"))>0&&(n.videoRecvBytes=Number(e.stat("bytesReceived")),n.videoRecvPackets=Number(e.stat("packetsReceived")),n.videoRecvPacketsLost=Number(e.stat("packetsLost")),n.videoFrameRate=Number(e.stat("googFrameRateOutput")),n.videoFrameRateReceived=Number(e.stat("googFrameRateReceived")),n.videoFrameRateDecoded=Number(e.stat("googFrameRateDecoded")),n.videoWidth=Number(e.stat("googFrameWidthReceived")),n.videoHeight=Number(e.stat("googFrameHeightReceived")),n.videoCodec=e.stat("googCodecName")),null),a=e=>{Number(e.stat("audioInputLevel"))>0?(n.audioSentPackets=Number(e.stat("packetsSent")),n.audioSentPacketsLost=Number(e.stat("packetsLost")),n.audioSentBytes=Number(e.stat("bytesSent")),n.audioCodec=e.stat("googCodecName"),n.audioRtt=Number(e.stat("googRtt"))/1e3):Number(e.stat("audioOutputLevel"))>0&&(n.audioRecvPackets=Number(e.stat("packetsReceived")),n.audioRecvPacketsLost=Number(e.stat("packetsLost")),n.audioRecvBytes=Number(e.stat("bytesReceived")),n.audioCodec=e.stat("googCodecName"))};e.getStats(t=>{if(t.result){const r=t.result();m(e,r);const i=(e,t)=>r.filter(n=>n.id===t.stat(e))[0],s=e=>i("localCandidateId",e),c=e=>i("remoteCandidateId",e);for(let e=0;e<r.length;e++){const t=r[e];t.stat&&("true"===t.stat("googActiveConnection")&&(t.stat("googChannelId").indexOf("audio")>-1?(n.audioLocalAddress=t.stat("googLocalAddress"),n.audioRemoteAddress=t.stat("googRemoteAddress"),n.audioLocalCandidateType=t.stat("googLocalCandidateType"),n.audioRemoteCandidateType=t.stat("googRemoteCandidateType"),n.audioTransportType=t.stat("googTransportType"),n.audioLocalRelayProtocol=u(s(t).stat("priority")),n.audioRemoteRelayProtocol=u(c(t).stat("priority"))):t.stat("googChannelId").indexOf("video")>-1&&(n.videoLocalAddress=t.stat("googLocalAddress"),n.videoRemoteAddress=t.stat("googRemoteAddress"),n.videoLocalCandidateType=t.stat("googLocalCandidateType"),n.videoRemoteCandidateType=t.stat("googRemoteCandidateType"),n.videoTransportType=t.stat("googTransportType"),n.videoLocalRelayProtocol=u(s(t).stat("priority")),n.videoRemoteRelayProtocol=u(c(t).stat("priority")))),Number(t.stat("googAvailableSendBandwidth"))>0&&(n.videoSentEstimatedBandwidth=Number(t.stat("googAvailableSendBandwidth"))),Number(t.stat("googAvailableReceiveBandwidth"))>0&&(n.videoRecvEstimatedBandwidth=Number(t.stat("googAvailableReceiveBandwidth"))),a(t),o(t))}"videoCodec"in n&&!n.videoLocalAddress&&["LocalAddress","RemoteAddress","LocalCandidateType","RemoteCandidateType","TransportType","LocalRelayProtocol","RemoteRelayProtocol"].forEach(e=>{n["video"+e]=n["audio"+e]})}i(null,n)})}function y(e,t,n,i,s){const u=e=>{const t={packetsSent:"videoSentPackets",packetsLost:"videoSentPacketsLost",bytesSent:"videoSentBytes",framesPerSecond:"videoFrameRate",framesSent:"videoFrameRateSent",framesReceived:"videoFramesReceived",frameWidth:"videoWidth",frameHeight:"videoHeight"},r=["videoSentPackets","videoSentBytes"];for(const i in t)if(i in e){const o=t[i];r.includes(o)&&Number.isSafeInteger(n[o])?n[o]+=e[i]:n[o]=e[i]}},l=(r,s)=>{if("outboundrtp"===s?(r.hasOwnProperty("qualityLimitationReason")&&(n.videoBandwidthLimitedResolution="bandwidth"===r.qualityLimitationReason,n.cpuLimitedResolution="cpu"===r.qualityLimitationReason),u(r)):"inboundrtp"===s&&(n.videoRecvPackets=r.packetsReceived,n.videoRecvPacketsLost=r.packetsLost,n.videoRecvBytes=r.bytesReceived),(o.isFirefox&&["outboundrtp","inboundrtp"].includes(s)||!i&&"inboundrtp"===s)&&(n.videoFrameRate=(()=>{if(!("videoSentBytes"in n?n.videoSentBytes>0:n.videoRecvBytes>0))return 0;let e=0;if(o.isFirefox&&o.version<96)e=Number(r.framerateMean);else{const i="outboundrtp"===s?"framesEncoded":"framesDecoded";n[i]=r[i],e=f({currentStatFrames:r[i],currentTimestamp:r.timestamp,prevStatFrames:t[i],prevTimestamp:t.timeStamp||Date.now()})}return e})()),void 0===n.videoCodec&&-1!==["Safari"].indexOf(a.env.name)&&void 0!==r.codecId){const t=("answer"===e.remoteDescription.type?e.remoteDescription:e.localDescription).sdp,i=r.codecId.lastIndexOf("_"),o=c.getCodecsAndCodecMap(t,"video");-1!==i&&void 0!==o&&(n.videoCodec=o.codecMap[r.codecId.substring(i+1)])}};e.getStats(null).then(t=>{let o,f,v,y,b,S,E,_;const T=[],R=r=>{const s=r.type.toLowerCase().replace(/[^a-z]/g,""),p=r.id.toLowerCase();if(/(in|out)boundrtp$/.test(s)){const t=/rtp/.test(p),i=t&&/audio/.test(p),o=t&&/video/.test(p),u=i||"audio"===r.kind,d=o||"video"===r.kind;if(u?((t,r)=>{if("outboundrtp"===r?(n.audioSentPackets=t.packetsSent,n.audioSentPacketsLost=t.packetsLost,n.audioSentBytes=t.bytesSent):"inboundrtp"===r&&(n.audioRecvPackets=t.packetsReceived,n.audioRecvPacketsLost=t.packetsLost,n.audioRecvBytes=t.bytesReceived),void 0===n.audioCodec&&-1!==["Safari"].indexOf(a.env.name)&&void 0!==t.codecId){const r=("answer"===e.remoteDescription.type?e.remoteDescription:e.localDescription).sdp,i=t.codecId.lastIndexOf("_"),o=c.getCodecsAndCodecMap(r,"audio");-1!==i&&void 0!==o&&(n.audioCodec=o.codecMap[t.codecId.substring(i+1)])}})(r,s):d&&l(r,s),r.hasOwnProperty("roundTripTime")){const e=r.mediaType||r.kind;"video"===e?T.push(r.roundTripTime):"audio"===e&&(n.audioRtt=r.roundTripTime)}if("remoteinboundrtp"===s&&r.hasOwnProperty("packetsLost")){const e=r.kind+"SentPacketsLost";n[e]||(n[e]=0),n[e]+=r.packetsLost}}else if("transport"===s){const e=r.selectedCandidatePairId,i=r.srtpCipher;n.srtpCipher=i,e&&(y=d(e,t))}else"localcandidate"===s?(o=r.candidateType,v=g(r),S=r.protocol||r.transport):"remotecandidate"===s?(f=r.candidateType,b=g(r)):"track"===s&&0!==p.indexOf("video")?(E=r.frameWidth,_=r.frameHeight,u(r)):"mediasource"===s?(r.hasOwnProperty("framesPerSecond")&&(n.videoFrameRate=r.framesPerSecond),r.hasOwnProperty("width")&&(n.videoWidthInput=r.width),r.hasOwnProperty("height")&&(n.videoHeightInput=r.height)):"candidatepair"===s&&r.hasOwnProperty("availableOutgoingBitrate")&&(n[`video${i?"Sent":"Recv"}EstimatedBandwidth`]=parseInt(r.availableOutgoingBitrate,10))};if("function"==typeof t[Symbol.iterator]){m(e,Array.from(t));for(var I,w=r(t);!(I=w()).done;){const e=I.value;R(Array.isArray(e)?e[1]:e)}}else{m(e,t);for(const e in t)t.hasOwnProperty(e)&&R(t[e])}if(e.currentRemoteDescription&&(n.useDtx=c.hasSendDtx(e.currentRemoteDescription.sdp)),i&&(n.videoRtt=(()=>{if(0===T.length)return null;const e=T.filter(e=>e>0),t=e.reduce((e,t)=>e+t,0);return e.length?t/e.length:0})()),(n.audioRecvBytes||n.audioSentBytes)&&(n.audioLocalCandidateType=o,n.audioLocalAddress=v,n.audioRemoteCandidateType=f,n.audioRemoteAddress=b,n.audioTransportType=S,n.audioLocalRelayProtocol=y,void 0===n.audioCodec)){const t=("answer"===e.remoteDescription.type?e.remoteDescription:e.localDescription).sdp,r=c.getCodecs(t,"audio");n.audioCodec=r[0]}if((n.videoRecvBytes||n.videoSentBytes)&&(n.videoLocalCandidateType=o,n.videoLocalAddress=v,n.videoRemoteCandidateType=f,n.videoRemoteAddress=b,n.videoTransportType=S,n.videoLocalRelayProtocol=y,void 0===n.videoCodec)){const t=("answer"===e.remoteDescription.type?e.remoteDescription:e.localDescription).sdp,r=c.getCodecs(t,"video");n.videoCodec=r[0]}!function(e,t){(t?p:h).forEach(t=>{e.hasOwnProperty(t)||(e[t]=null)})}(n,i),n.videoWidth=n.videoWidth||E,n.videoHeight=n.videoHeight||_,s(null,n)}).catch((function(e){s(e)}))}},function(e,t,n){"use strict";const r=n(280);e.exports=(e,t)=>{let n="";if(!e||!t)return n;const i=t.get(e);if(i){const e=i.localCandidateId;if(e){const i=t.get(e);if(i){const e=i.relayProtocol,t=i.priority;n=e?"TURN/"+e.toUpperCase():r(t)}}}return n}},function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;let r=function(){function e(){this.value=null,this.changeCount=0}return e.prototype.onValue=function(e){e&&e!==this.value&&(this.value&&(this.changeCount+=1),this.value=e)},e}();t.default=r},function(e,t,n){var r=n(11),i=n(646),o=n(229),a=Math.max,s=Math.min;e.exports=function(e,t,n){var c,u,d,l,f,p,h=0,m=!1,g=!1,v=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var n=c,r=u;return c=u=void 0,h=t,l=e.apply(r,n)}function b(e){return h=e,f=setTimeout(E,t),m?y(e):l}function S(e){var n=e-p;return void 0===p||n>=t||n<0||g&&e-h>=d}function E(){var e=i();if(S(e))return _(e);f=setTimeout(E,function(e){var n=t-(e-p);return g?s(n,d-(e-h)):n}(e))}function _(e){return f=void 0,v&&c?y(e):(c=u=void 0,l)}function T(){var e=i(),n=S(e);if(c=arguments,u=this,p=e,n){if(void 0===f)return b(p);if(g)return clearTimeout(f),f=setTimeout(E,t),y(p)}return void 0===f&&(f=setTimeout(E,t)),l}return t=o(t)||0,r(n)&&(m=!!n.leading,d=(g="maxWait"in n)?a(o(n.maxWait)||0,t):d,v="trailing"in n?!!n.trailing:v),T.cancel=function(){void 0!==f&&clearTimeout(f),h=0,c=p=u=f=void 0},T.flush=function(){return void 0===f?l:_(i())},T}},function(e,t,n){var r=n(15);e.exports=function(){return r.Date.now()}},function(e,t,n){"use strict";const r=n(51);t.check=function(e){void 0===e&&(e={});const t=e.env||n(3);return"Chrome"===t.name&&t.userAgent.toLowerCase().indexOf("android")>-1&&t.version<65},t.once=r(()=>t.check())},function(e,t,n){"use strict";const r=n(3);e.exports=function(e){void 0===e&&(e={});const t=e.env,n=void 0===t?r:t;return!!(n.isiOS&&n.iOSVersion>10)}},function(e,t,n){"use strict";const r=n(37),i=n(8);e.exports=function(e){let t,n,o,a,s;const c=this;let u=e.archiving;const d=e.archivingStarted||"Archiving on",l=e.archivingEnded||"Archiving off";let f=!0;const p=function(e){a.nodeValue=e,t.setAttribute("title",e)},h=function(){s&&(clearTimeout(s),s=null),u?i.addClass(n,"OT_active"):i.removeClass(n,"OT_active"),i.removeClass(c.domElement,"OT_archiving-"+(u?"off":"on")),i.addClass(c.domElement,"OT_archiving-"+(u?"on":"off")),e.show&&u?(p(d),i.addClass(o,"OT_mode-on"),i.removeClass(o,"OT_mode-auto"),c.setDisplayMode("on"),s=setTimeout(()=>{i.addClass(o,"OT_mode-auto"),i.removeClass(o,"OT_mode-on")},5e3)):e.show&&!f?(i.addClass(o,"OT_mode-on"),i.removeClass(o,"OT_mode-auto"),c.setDisplayMode("on"),p(l),s=setTimeout(()=>{c.setDisplayMode("off")},5e3)):c.setDisplayMode("off")};r(this,{mode:u&&e.show?"on":"off",nodeName:"h1",htmlAttributes:{className:"OT_archiving OT_edge-bar-item OT_edge-bottom"},onCreate(){t=i.createElement("div",{className:"OT_archiving-light-box"},""),n=i.createElement("div",{className:"OT_archiving-light"},""),t.appendChild(n),o=i.createElement("div",{className:"OT_archiving-status OT_mode-on OT_edge-bar-item OT_edge-bottom"},""),a=document.createTextNode(""),o.appendChild(a),c.domElement.appendChild(t),c.domElement.appendChild(o),h()}}),this.setShowArchiveStatus=function(t){e.show=t,c.domElement&&h.call(c)},this.setArchiving=function(e){u=e,f=!1,c.domElement&&h.call(c)}}},function(e,t,n){"use strict";e.exports=function(e){void 0===e&&(e={});const t=e.global||(void 0!==typeof window?window:global);return()=>t.navigator&&t.navigator.mediaDevices}},function(e,t,n){"use strict";(function(t){const r=n(9),i=n(11),o=n(108),a=n(652),s=n(21),c=n(23),u=n(6);e.exports=function(e){void 0===e&&(e={});const d=e.env||n(3),l=e.Errors||n(7),f=e.otError||n(13)(),p=e.logging||n(0)("getUserMedia"),h=e.screenSharing||n(161)(),m=e.getDisplayMediaExtensionHelper||n(290),g=e.customGetUserMedia,v=e.global||(void 0!==typeof window?window:global),y=e.analytics||new s,b=v.navigator,S=v.location,E=()=>{return g||(b.mediaDevices?(e=b.mediaDevices).getUserMedia.bind(e):void 0);var e},_=function(){const e=E();return e?e(...arguments):t.reject(new Error("Cannot find getUserMedia"))},T=()=>{return g||(b.mediaDevices&&b.getDisplayMedia?b.getDisplayMedia.bind(b):b.mediaDevices&&b.mediaDevices.getDisplayMedia?(e=b.mediaDevices).getDisplayMedia.bind(e):void 0);var e},R=function(){const e=T();return e?e(...arguments):t.reject(new Error("Cannot find getDisplayMedia"))},I=(()=>{const e={name:l.USER_MEDIA_ACCESS_DENIED,message:"End-user denied permission to hardware devices"},t={name:l.NOT_SUPPORTED,message:"A constraint specified is not supported by the browser."},n={name:l.CONSTRAINTS_NOT_SATISFIED,message:"It's not possible to satisfy one or more constraints passed into the getUserMedia function"},i={name:l.NO_DEVICES_FOUND,message:"No voice or video input devices are available on this machine."},o={name:l.HARDWARE_UNAVAILABLE,message:"The selected voice or video devices are unavailable. Verify that the chosen devices are not in use by another application."},s={name:l.UNABLE_TO_CAPTURE_SCREEN,message:"Unable to capture screen. Unknown error occurred"},c={AbortError:{name:l.UNABLE_TO_CAPTURE_MEDIA,message:"Unable to capture media. Unknown error occurred"},NotAllowedError:e,NotFoundError:i,NotReadableError:o,OverconstrainedError:n,SecurityError:r({},e,{message:"End-user denied permission to hardware devices or user media support may be disabled on this page"}),TypeError:n,PermissionDeniedError:e,PermissionDismissedError:e,NotSupportedError:t,ConstraintNotSatisfiedError:n,MandatoryUnsatisfiedError:n,OverConstrainedError:n,DevicesNotFoundError:i,NoDevicesFoundError:i,HardwareUnavailableError:o,SourceUnavailableError:o,TrackStartError:o,ScreenCaptureError:s,TabCaptureError:s};return a({objectToTrack:c,keys:["PermissionDeniedError","PermissionDismissedError","NotSupportedError","ConstraintNotSatisfiedError","MandatoryUnsatisfiedError","OverConstrainedError","DevicesNotFoundError","NoDevicesFoundError","HardwareUnavailableError","SourceUnavailableError","TrackStartError","ScreenCaptureError","TabCaptureError"],onUsage(e){y.logEvent({action:"DeprecatedPropertyUsage:getUserMedia:errorMap",variation:"Event",payload:{key:e}})}}),c})(),w=(e,t)=>{let n=e;"AbortError"===n&&"string"==typeof t&&t.match(/(screen|tab).?capture/i)&&(n="ScreenCaptureError");const r=I[n];let i;return i=r?f(r.name,new Error(`${r.message} (getUserMedia error: ${e})`)):new Error("Unknown error while getting user media: "+e),i.originalMessage=t,i.originalName=e,i};return function(e,n){if(void 0===n&&(n=!1),p.debug("getUserMedia wrapper called with",e),function(e){if(!e||!i(e))return!0;for(const t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}(e))return p.error("Couldn't get UserMedia: All constraints were false"),u(t.reject(f(l.NO_VALID_CONSTRAINTS,new Error("Video and Audio was disabled, you need to enable at least one"))));const r=n&&m.isSupportedInThisBrowser?R:_,a=u(r(e).catch(e=>{const n=(e=>{if(i(e)&&e.name){let t=e.name,n=e.message;if("Cannot find getUserMedia"!==n&&"Cannot find getDisplayMedia"!==n||(t="Chrome"===d.name&&d.version>73&&"https:"!==v.location.protocol?"NotAllowedError":"NotSupportedError"),"Safari"===d.name&&"Error"===t){const n=Object.prototype.toString.call(e).match(/^\[object (\w+Error)\]$/);n&&(t=n[1])}const r=w(t,n);return r.constraintName=e.constraint||e.constraintName,r instanceof c||y.logEvent({action:"UnexpectedError:getUserMedia:parseErrorEvent",variation:"Event",payload:{name:r.name,message:r.message,originalMessage:r.originalMessage}}),r}if("string"==typeof e){const t=w(e);return y.logEvent({action:"CheckUnreachable:getUserMedia:parseErrorEvent",variation:"Event",payload:{info:"error is string",error:e}}),t}return y.logEvent({action:"CheckUnreachable:getUserMedia:parseErrorEvent",variation:"Event",payload:{info:"error was not string or object with name property",error:e}}),new Error("Unknown error type while getting media")})(e);if(n.name===l.UNABLE_TO_CAPTURE_SCREEN)return new t((e,t)=>{h.checkCapability(e=>{if("chrome"===e.extensionRequired){if(e.extensionRegistered&&!e.extensionInstalled){const e=f(l.SCREEN_SHARING_EXTENSION_NOT_INSTALLED,n);e.message="Screen sharing extension not installed see https://tokbox.com/developer/guides/screen-sharing/js/#chrome-extension",t(e)}else if(!e.extensionRegistered){const e=f(l.SCREEN_SHARING_EXTENSION_NOT_REGISTERED,n);e.message="Screen sharing extension not registered see https://tokbox.com/developer/guides/screen-sharing/js/#chrome-extension",t(e)}}else t(n)})});throw n}).then(e=>(p.debug("got stream:",{stream:e,tracks:e.getTracks(),trackLabels:e.getTracks().map(e=>e.label)}),e))),s=-1!==S.protocol.indexOf("https")?500:100;let g=!0;const b=()=>{g=!1};return a.then(b,b),o(s).then(()=>{if(!g)return;const e=()=>{a.emit("accessDialogClosed")};a.emit("accessDialogOpened"),a.then(e,e)}),a}}}).call(this,n(2))},function(e,t,n){"use strict";e.exports=function(e){let t=void 0===e?{}:e,n=t.objectToTrack,r=t.keys,i=t.onUsage;if(!Array.isArray(r)&&void 0!==r)throw new Error("keys must be an array, or undefined");if("function"!=typeof i)throw new Error("onUsage must be a function");if(null==n)throw new Error("Expected objectToTrack to be a trackable object");Object.keys(n).forEach(e=>{if(void 0!==r&&-1===r.indexOf(e))return;let t=n[e];Object.defineProperty(n,e,{get:()=>(i(e),t),set(n){t=n,i(e,t)},enumerable:!0})})}},function(e,t,n){"use strict";const r=n(3),i=n(654).isCallbackBasedAPI;let o=n(265),a=null;const s=(e,t)=>{a.getSources(e,t)},c=(e,t)=>{a.getSources(e).then(e=>{t(void 0,e)},t)},u=(e,t)=>{(i?s:c)({types:[e]},(n,r)=>{if(n)return void t(n);const i=r[0];if(!i)return void t(new Error("Could not find Electron source for screensharing"));const o={audio:!1,video:{mandatory:{chromeMediaSource:e,chromeMediaSourceId:i.id}}};t(void 0,o)})};e.exports=function(e){void 0===e&&(e={});try{const t=()=>{let e=void 0!==typeof window?window:global;for(;"function"!=typeof e.require&&e.parent&&e.parent!==e;)e=e.parent;return e},n=()=>{const e=t();return(e.require?e.require("electron"):e.electron).desktopCapturer};a=e.desktopCapturer||(r.isElectron?n():null),o=e.isElectronScreenSharingSource||o}catch(e){}return{isSupportedInThisBrowser:null!==a,autoRegisters:!0,extensionRequired:!1,getConstraintsShowsPermissionUI:!1,sources:{screen:!0,application:!0,window:!0,browser:!0},register:()=>({isInstalled:e=>e(!0),getConstraints(e,t,n){o(e)?n(void 0,{audio:!0,video:!1}):u(e,n)}})}}},function(e,t,n){"use strict";const r=n(3).version<78,i=!r;e.exports={isCallbackBasedAPI:r,isPromiseBasedAPI:i}},function(e,t,n){"use strict";const r=n(3),i=n(159).default;e.exports={isSupportedInThisBrowser:!!r.isFirefox&&!i,autoRegisters:!0,extensionRequired:!1,extensionInstalled:!1,getConstraintsShowsPermissionUI:!1,sources:{screen:!0,application:!1,window:!0,browser:!1},register:()=>({isInstalled(e){e("object"==typeof OTScreenSharing)},getConstraints(e,t,n){t.video={mediaSource:e},t.browserWindow&&(t.video.browserWindow=t.browserWindow,delete t.browserWindow),void 0!==t.scrollWithPage&&(t.video.scrollWithPage=t.scrollWithPage,delete t.scrollWithPage),n(void 0,t)}})}},function(e,t,n){"use strict";var r=n(1),i=r(n(4)),o=r(n(5));const a=n(657).normaliseOptions,s=n(291).isMediaStreamTrack,c=n(148),u=n(9),d=n(141),l=n(292).default,f=n(7),p=n(48),h=n(13)(),m=n(293).isValidVideoContentHint,g=n(6),v=n(149),y=n(3),b=n(264);e.exports=function(e){void 0===e&&(e={}),["deviceHelpers","getUserMediaHelper"].forEach(t=>{c(e[t],t+" dependency must be injected into processPubOptions")});const t=e.generateConstraintInfo||n(254),r=e.global||(void 0!==typeof window?window:global),S=e.logging||n(0)("processPubOptions"),E=e.navigator||r.navigator,_=e.screenSharing||n(161)(),T=e.env||y,R=n(658)({navigator:E||{}}),I=e,w=I.deviceHelpers,C=I.getUserMediaHelper;return(e,n,c)=>{var y,E,I;const O=a(e,n,S),A=v(O.videoSource),x=s(O.audioSource),k=s(O.videoSource),N=!x&&null!==O.audioSource,L=!k&&null!==O.videoSource,M=N||L,V=e=>"boolean"==typeof e,P=!A||x||b,D=d(O,{mirror:!A&&!k,publishAudio:!0,publishVideo:!0,showControls:!0,fitMode:A?"contain":"cover",insertDefaultUI:!0,enableRenegotiation:!1,enableStereo:!1,enableDtx:!1,disableAudioProcessing:!1,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}),Z=O.audioFallback,j=void 0===Z?{}:Z,W=O.audioFallbackEnabled;if(D.publisherAudioFallbackEnabled=null!=(y=j.publisher)&&y,D.subscriberAudioFallbackEnabled=null!=(E=null!=(I=j.subscriber)?I:W)?E:!A,void 0===D.videoContentHint||m(D.videoContentHint)||(S.warn(n+': Invalid content hint. Valid content hints are "text", "detail", "motion", or ""'),D.videoContentHint=""),D.name&&(D.name=String(D.name)),V(D.enableDtx)||(D.enableDtx=!1),V(D.enableStereo)||(D.enableStereo=!1),D.initials&&("string"!=typeof D.initials&&(D.initials=""),D.initials.length>2&&(D.initials="",S.warn("Publisher initials cleared. Only one or two characters allowed for publisher initials.")),D.initials=D.initials.toUpperCase()),D.constraints)S.warn(n+": You have passed your own constraints not using ours");else{const e=t(Object.assign({isScreenSharing:A,isCustomAudioTrack:x,isCustomVideoTrack:k},p(D,["audioSource","publishAudio","videoSource","publishVideo","resolution","maxResolution","frameRate","facingMode","enableRenegotiation","enableStereo","disableAudioProcessing","echoCancellation","noiseSuppression","autoGainControl"]),{env:T,usingOptionalMandatoryStyle:R(A)}));u(D,e)}const G={isScreenSharing:A,isCustomAudioTrack:x,isCustomVideoTrack:k,shouldAllowAudio:P,properties:D};return g(G),G.getUserMedia=(0,o.default)(i.default.mark((function e(){var t,a,s,u,d,p,m,g,v;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return G.emit("accessDialogOpened",...t)},a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return G.emit("accessDialogClosed",...t)},M){e.next=7;break}return s=new r.MediaStream,x&&s.addTrack(O.audioSource),k&&s.addTrack(O.videoSource),e.abrupt("return",s);case 7:if(!A){e.next=15;break}return e.next=10,_.getConstraints({onAccessDialogOpened:t,onAccessDialogClosed:a,videoSource:O.videoSource,constraints:D.constraints});case 10:if(D.constraints=e.sent,!c()){e.next=13;break}throw h(f.CANCEL,new Error("getUserMedia request was aborted"));case 13:e.next=25;break;case 15:return e.next=17,w.shouldAskForDevices();case 17:if(u=e.sent,!c()){e.next=20;break}throw h(f.CANCEL,new Error("getUserMedia request was aborted"));case 20:S.debug(n+": shouldAskForDevices:",u),u.video||(S.warn(n+": Setting video constraint to false, there are no video sources"),D.constraints.video=!1),u.audio||(S.warn(n+": Setting audio constraint to false, there are no audio sources"),D.constraints.audio=!1),G.videoDevices=u.videoDevices,G.audioDevices=u.audioDevices;case 25:if(d=D.constraints,S.debug(n+": onConstraintsFound",d),!c()){e.next=29;break}throw h(f.CANCEL,new Error("getUserMedia request was aborted"));case 29:return p="Failed to acquire functional stream, this might be caused by the following iOS bug: https://bugs.webkit.org/show_bug.cgi?id=188088",m="Failed to acquire functional stream, this might be caused by the following iOS bug: https://bugs.webkit.org/show_bug.cgi?id=204106",g=e=>"NotReadableError"===e.originalName&&"Failed starting capture of a video track"===e.originalMessage,v=function(){var e=(0,o.default)(i.default.mark((function e(){var r,o,s;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=C(d,A)).on("accessDialogOpened",t),r.on("accessDialogClosed",a),e.prev=3,e.next=6,r;case 6:if(o=e.sent,!(T.isiOS&&D.publishVideo&&o.getVideoTracks().length&&"ended"===o.getVideoTracks()[0].readyState)){e.next=11;break}throw o.getTracks().forEach(e=>e.stop()),new Error(p);case 11:return e.abrupt("return",o);case 14:if(e.prev=14,e.t0=e.catch(3),!T.isiOS){e.next=34;break}if(!(g(e.t0)&&T.iOSVersion>=13&&T.iOSVersion<13.4)){e.next=32;break}return e.prev=18,s=C({audio:!0,video:!1},!1),e.next=22,s;case 22:e.sent.getTracks().forEach(e=>e.stop()),e.next=29;break;case 26:e.prev=26,e.t1=e.catch(18),S.debug(n+": error disposing audio track",e.t1);case 29:throw new Error(m);case 32:if(e.t0.name!==f.HARDWARE_UNAVAILABLE){e.next=34;break}throw new Error(p);case 34:throw e.t0;case 35:return e.prev=35,setTimeout(()=>{r.off("accessDialogOpened",t),r.off("accessDialogClosed",a)}),e.finish(35);case 38:case"end":return e.stop()}}),e,null,[[3,14,35,38],[18,26]])})));return function(){return e.apply(this,arguments)}}(),e.next=35,l(v,(e,t)=>!(![p,m].includes(e.message)||1!==t||c())&&1e3)();case 35:if(s=e.sent,!c()){e.next=39;break}throw s.getTracks().forEach(e=>{e.stop()}),h(f.CANCEL,new Error("getUserMedia request was aborted"));case 39:return x&&s.addTrack(O.audioSource),k&&s.addTrack(O.videoSource),e.abrupt("return",s);case 42:case"end":return e.stop()}}),e)}))),G}}},function(e,t,n){"use strict";const r=n(291).isMediaStreamTrack,i=n(38),o=n(3);t.normaliseOptions=(e,t,n)=>{const a=e&&"object"==typeof e?i(e):{};if(!1===a.audioSource&&(a.audioSource=null),!1===a.videoSource&&(a.videoSource=null),void 0===a.minVideoBitrate||"number"==typeof a.minVideoBitrate&&a.minVideoBitrate>0||(n.warn(t+": Invalid minVideoBitrate in publisher properties. minVideoBitrate must be a positive number"),delete a.minVideoBitrate),void 0===a.audioBitrate||a.audioBitrate>=6e3&&a.audioBitrate<=51e4||(n.warn(t+": Invalid audioBitrate in publisher properties. audioBitrate must be a number between 6000 and 510000 bits per second"),delete a.audioBitrate),"Firefox"===o.name&&o.version<49){const e="Firefox 48 and below";r(a.audioSource)&&(a.audioSource=null,n.warn(`${t}: Cannot use custom tracks with ${e}. Setting audioSource to null`)),r(a.videoSource)&&(a.videoSource=null,n.warn(`${t}: Cannot use custom tracks with ${e}. Setting videoSource to null`))}return a}},function(e,t,n){"use strict";const r=n(3),i=r.name,o=r.version,a=n(258);e.exports=function(e){let t=(void 0===e?{}:e).navigator,n=void 0===t?window.navigator:t;return function(e){return e&&!a||!(n.mediaDevices&&n.mediaDevices.getUserMedia)||"Chrome"===i&&o<61}}},function(e,t,n){"use strict";e.exports=function(e){void 0===e&&(e={}),["processPubOptions"].forEach(t=>{if(!e[t])throw new Error(t+" dependency must be injected into OT.getUserMedia")});const t=e.logging||n(0)("getUserMedia"),r=e.processPubOptions;return function(e){return void 0===e&&(e={}),r(e,"OT.getUserMedia",()=>!1).getUserMedia().catch(e=>{throw t.error("OT.getUserMedia failed to getUserMedia: "+e),e})}}},function(e,t,n){"use strict";e.exports=function(e,t){const n=(t,n)=>()=>{throw new Error(`Cannot ${t} ${n}, ${e} is destroyed`)};Object.keys(t).forEach(e=>{"function"==typeof t[e]?t[e]=n("call",e):Object.defineProperty(t,e,{get:n("get",e),set:n("set",e)})})}},function(e,t,n){"use strict";e.exports=e=>{if("srcObject"in e)return;const t=window&&window.URL;"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(e,"srcObject",{get(){return this._srcObject},set(e){const n=this;if(this._srcObject=e,this.src&&t.revokeObjectURL(this.src),e)return this.src=t.createObjectURL(e),e.addEventListener("addtrack",()=>{n.src&&t.revokeObjectURL(n.src),n.src=t.createObjectURL(e)}),e.addEventListener("removetrack",()=>{n.src&&t.revokeObjectURL(n.src),n.src=t.createObjectURL(e)}),this._srcObject;this.src=""}})}},function(e,t,n){"use strict";e.exports=e=>{return!(!(t=e)||"function"!=typeof t.getBoundingClientRect)&&(e=>{const t=e.getBoundingClientRect(),n=window.innerHeight||document.documentElement.clientHeight,r=window.innerWidth||document.documentElement.clientWidth,i=t.top<=n&&t.top+t.height>=0,o=t.left<=r&&t.left+t.width>=0;return i&&o})(e)&&(e=>{const t=e=>!(!e.style||"hidden"!==e.style.visibility)||!!e.parentNode&&t(e.parentNode);return null!==e.offsetParent&&!t(e)})(e);var t}},function(e,t,n){"use strict";const r=n(106),i=n(8),o={0:"rotate(0deg)",270:"rotate(90deg)",90:"rotate(-90deg)",180:"rotate(180deg)"};e.exports=function(e,t,n){let a=n;r(e,{isRotated:{get(){return this.orientation()&&(270===this.orientation().videoOrientation||90===this.orientation().videoOrientation)}},orientation:{get:()=>a,set(n){a=n;const r=o[n.videoOrientation]||o.ROTATED_NORMAL;switch(i.env.name){case"Chrome":case"Safari":t().style.webkitTransform=r;break;default:t().style.transform=r}e.trigger("orientationChanged",a)}},audioChannelType:{get(){return"mozAudioChannelType"in this.domElement?this.domElement.mozAudioChannelType:"unknown"},set(e){"mozAudioChannelType"in this.domElement&&(this.domElement.mozAudioChannelType=e)}}})}},function(e,t,n){"use strict";e.exports=function(){return function(e,t,n){const r=[];function i(i){setTimeout(()=>{if(r.length)if(function(e){return e.getTracks().every(e=>"ended"===e.readyState)}(e))a(),"function"==typeof t&&t();else{const e=i.target;o(e),"function"==typeof n&&n(e)}},100)}function o(e){e.onended===i&&(e.onended=null);const t=r.indexOf(e);t>=0&&r.splice(t,1)}function a(){r.slice().forEach(o)}function s(){e.getTracks().forEach(e=>{r.push(e),e.onended=i})}return s(),{stop:a,refresh:()=>{a(),s()}}}}},function(e,t,n){"use strict";var r=n(1);t.__esModule=!0,t.default=void 0;var i=r(n(14)),o=r(n(0)),a=r(n(75)),s=n(29);const c=(0,o.default)("AudioFallbackState");var u=()=>{const e=new i.default;let t=s.CongestionLevels.LOW,n=a.default.ACTIVE_VIDEO;const r=t=>{n=t,e.emit("stateChange",{state:t})},o={[s.CongestionLevels.LOW]:()=>{t=s.CongestionLevels.LOW,r(a.default.ACTIVE_VIDEO)},[s.CongestionLevels.MEDIUM]:()=>{t===s.CongestionLevels.LOW&&r(a.default.ACTIVE_VIDEO_WITH_WARNING),t=s.CongestionLevels.MEDIUM},[s.CongestionLevels.CRITICAL]:()=>{t=s.CongestionLevels.CRITICAL,r(a.default.SUSPENDED_VIDEO)}};return Object.assign(e,{setCongestionLevel(e){if(t===e)return;const n=o[e];n?n():c.warn("Invalid congestion level: "+e)},getState:()=>({videoState:n,congestionLevel:t}),setInternalState(e){n=e.videoState,t=e.congestionLevel},reset(){t=s.CongestionLevels.LOW,n=a.default.ACTIVE_VIDEO}})};t.default=u},function(e,t,n){"use strict";var r=n(1);t.__esModule=!0,t.default=void 0;var i=r(n(667)),o=r(n(668)),a=r(n(299)),s=r(n(300)),c=r(n(670));const u=n(14);var d=function(e,t){void 0===e&&(e={}),void 0===t&&(t={});const n=new u,r=e,d=r.videoResolution,l=r.getStats,f=t,p=f.createMovingAverageTracker,h=void 0===p?s.default:p,m=f.createTimeBasedCongestionLevel,g=void 0===m?i.default:m,v=f.createBasicCongestionLevel,y=void 0===v?o.default:v,b=f.getFairQualityBandwidthForResolution,S=void 0===b?c.default:b,E=f.createCongestionLevelStats,_=void 0===E?a.default:E,T={bandwidthFairThreshold:S(d)},R=g(T),I=y(T),w=h(),C=h(),O=h(),A=()=>{const e=R.getLevel({bandwidth:O.getMovingAverageValue(),audioPacketLoss:w.getMovingAverageValue()}),t=I.getLevel({bandwidth:O.getMovingAverageValue(),audioPacketLoss:w.getMovingAverageValue()}),r=Math.max(e,t);n.emit("congestionLevel",r)},x=_(l);return x.on("statsAvailable",e=>{(e=>{let t=e.audioPacketLoss,n=e.videoPacketLoss,r=e.bandwidth;w.addValue(t),C.addValue(n),O.addValue(r),A()})(e)}),Object.assign(n,{start(){x.start()},stop(){x.stop()}})};t.default=d},function(e,t,n){"use strict";var r=n(1);t.__esModule=!0,t.default=void 0;var i=r(n(164)),o=n(29);const a=(0,r(n(0)).default)("pafdebug:TimeBasedCongestionLevel");var s=function(e){void 0===e&&(e={});const t=Object.assign({},i.default,e);let n,r=!1;return{getLevel(e){let i=e.audioPacketLoss;const s=e=>a.info(""+e,{audioPacketLoss:i,params:t});if(i<t.packetLossCriticalThreshold)return r=!1,o.LOW;const c=Date.now();return r||(n=c,r=!0),c>n+t.criticalCongestionPeriod?(s("CRITICAL"),o.CRITICAL):c>n+t.criticalCongestionPeriod/2?(s("MEDIUM"),o.MEDIUM):o.LOW}}};t.default=s},function(e,t,n){"use strict";var r=n(1);t.__esModule=!0,t.default=void 0;var i=r(n(164)),o=n(29);const a=(0,r(n(0)).default)("pafdebug:BasicConnectionLevel"),s=["LOW","MEDIUM","CRITICAL"];var c=function(e){void 0===e&&(e={});const t=Object.assign({},i.default,e);return{getLevel(e){let n,r=e.bandwidth,i=e.audioPacketLoss;const c=e=>a.info(`${s[n]} Branch: ${e}`,{bandwidth:r,audioPacketLoss:i,params:t});if(r<=0)return i>t.packetLossCriticalThresholdMediumBw?(n=o.CRITICAL,c("audioPacketLoss > params.packetLossCriticalThresholdMediumBw")):n=o.LOW,n;if(r>=t.bandwidthFairThreshold?n=o.LOW:r>=t.bandwidthCriticalThreshold?r>=(t.bandwidthCriticalThreshold+t.bandwidthFairThreshold)/2?i>2*t.packetLossCriticalThresholdMediumBw?(n=o.CRITICAL,c("audioPacketLoss > params.packetLossCriticalThresholdMediumBw * 2.0")):(n=o.MEDIUM,c("!audioPacketLoss > params.packetLossCriticalThresholdMediumBw * 2.0")):i>t.packetLossCriticalThresholdMediumBw?(n=o.CRITICAL,c("audioPacketLoss > params.packetLossCriticalThresholdMediumBw")):(n=o.MEDIUM,c("audioPacketLoss > params.packetLossCriticalThresholdMediumBw")):i>t.packetLossCriticalThreshold?(n=o.CRITICAL,c("audioPacketLoss > params.packetLossCriticalThreshold")):(n=o.MEDIUM,c("audioPacketLoss > params.packetLossCriticalThreshold")),void 0===n)throw new Error("undefined congestion level");return n}}};t.default=c},function(e,t,n){"use strict";t.__esModule=!0,t.parseStats=t.getVideoResolution=t.getVideoPacketStats=t.getVideoPacketLoss=t.getSelectedCandidatePairId=t.getBandwidth=t.getAudioPacketStats=t.getAudioPacketLoss=void 0;const r=(e,t)=>{const n=e.filter(e=>{let n=e.type,r=e.kind;return"outbound-rtp"===n&&r===t}),r=e.filter(e=>{let n=e.type,r=e.kind;return"remote-inbound-rtp"===n&&r===t});return{packetsSent:n.reduce((e,t)=>e+t.packetsSent,0),packetsLost:r.reduce((e,t)=>e+t.packetsLost,0)}};t.getVideoResolution=e=>e.filter(e=>{let t=e.type,n=e.kind;return"outbound-rtp"===t&&"video"===n}).reduce((e,t)=>({width:Math.max(e.width,t.frameWidth),height:Math.max(e.height,t.frameHeight)}),{width:0,height:0});const i=e=>{const t=r(e,"audio"),n=t.packetsSent;return{audioPacketsLost:t.packetsLost,audioPacketsSent:n}};t.getAudioPacketStats=i;const o=e=>{const t=r(e,"video"),n=t.packetsSent;return{videoPacketsLost:t.packetsLost,videoPacketsSent:n}};t.getVideoPacketStats=o;const a=e=>{const t=e.find(e=>"transport"===e.type);return null==t?void 0:t.selectedCandidatePairId};t.getSelectedCandidatePairId=a;const s=e=>{const t=((e,t)=>{if(t){const n=e.find(e=>{let n=e.id,r=e.type;return n===t&&"candidate-pair"===r});return null==n?void 0:n.availableOutgoingBitrate}})(e,a(e));if(void 0!==t)return t;const n=e.find(e=>{let t=e.type,n=e.availableOutgoingBitrate;return"candidate-pair"===t&&void 0!==n});return null==n?void 0:n.availableOutgoingBitrate};t.getBandwidth=s,t.parseStats=e=>{const t=i(e),n=t.audioPacketsSent,r=t.audioPacketsLost,a=o(e),c=a.videoPacketsSent,u=a.videoPacketsLost;return{bandwidth:s(e),audioPacketsSent:n,audioPacketsLost:r,videoPacketsSent:c,videoPacketsLost:u}};const c=(e,t,n)=>{const r=t[e+"PacketsSent"]-n[e+"PacketsSent"],i=t[e+"PacketsLost"]-n[e+"PacketsLost"];return o=i,0===(a=r)?0:o/a;var o,a};t.getAudioPacketLoss=(e,t)=>c("audio",e,t),t.getVideoPacketLoss=(e,t)=>c("video",e,t)},function(e,t,n){"use strict";const r=[{width:"320",height:"180",fairQualityBitrate:12e4},{width:"320",height:"240",fairQualityBitrate:12e4},{width:"352",height:"288",fairQualityBitrate:125e3},{width:"480",height:"270",fairQualityBitrate:125e3},{width:"640",height:"360",fairQualityBitrate:15e4},{width:"640",height:"480",fairQualityBitrate:15e4},{width:"960",height:"540",fairQualityBitrate:15e4},{width:"1280",height:"720",fairQualityBitrate:4e5},{width:"1920",height:"1080",fairQualityBitrate:5e5}].sort((e,t)=>e.fairQualityBitrate-t.fairQualityBitrate),i=r.reduce((e,t)=>{let n=t.fairQualityBitrate;return Math.max(e,n)},25e4);e.exports=(e,t)=>{var n;return e&&t?(null==(n=r.find(n=>{let r=n.height,i=n.width;return t*e<=r*i}))?void 0:n.fairQualityBitrate)||i:25e4}},function(e,t,n){"use strict";var r=n(1);t.__esModule=!0,t.default=void 0;var i=r(n(14)),o=r(n(672)),a=n(29),s=r(n(301)),c=function(e){void 0===e&&(e={});const t=new i.default,n=e,r=n.getStats,c=n.setVideoActive,u=n.createNetworkProbe,d=void 0===u?o.default:u;let l,f;const p=()=>{var e,t;null==(e=l)||e.removeAllListeners(),clearTimeout(f),null==(t=l)||t.stop(),l=void 0};return Object.assign(t,{start:function(e){let n=(void 0===e?{}:e).getDelayForProbeNumber,i=void 0===n?s.default:n;l&&p(),l=d({getStats:r});let o=0;const u=()=>{const e=i(o);o++,f=setTimeout(()=>{c(!0),l.start()},e)};l.on("probeResult",e=>{e===a.LOW?t.emit("networkRecovered"):(c(!1),u())}),u()},stop:p})};t.default=c},function(e,t,n){"use strict";var r=n(1);t.__esModule=!0,t.default=void 0;var i=r(n(14)),o=r(n(673)),a=n(29);const s=(0,r(n(0)).default)("networkProbe");var c=function(e){void 0===e&&(e={});const t=new i.default,n=e,r=n.getStats,c=n.createRecoveryCongestionLevelCalculator,u=void 0===c?o.default:c;let d=0;const l=u({getStats:r}),f=e=>{l.stop(),s.info("Network probe result "+e),t.emit("probeResult",e)};return l.on("congestionLevel",e=>{d+=1,e===a.CRITICAL?f(a.CRITICAL):d>=20&&(e===a.LOW?f(a.LOW):f(a.CRITICAL))}),Object.assign(t,{start(){s.info("Start network probe"),l.start()},stop(){s.info("Stop network probe"),l.stop(),d=0}})};t.default=c},function(e,t,n){"use strict";var r=n(1);t.__esModule=!0,t.default=void 0;var i=r(n(14)),o=r(n(674)),a=r(n(299)),s=r(n(300)),c=function(e){void 0===e&&(e={});const t=new i.default,n=e,r=n.getStats,c=n.createMovingAverageTracker,u=void 0===c?s.default:c,d=n.createBandwidthCongestionLevel,l=void 0===d?o.default:d,f=n.createCongestionLevelStats,p=void 0===f?a.default:f,h=l(),m=u(),g=u(),v=p(r),y=()=>{v.stop(),m.reset(),g.reset()};return v.on("statsAvailable",e=>{let n=e.audioPacketLoss,r=e.videoPacketLoss;m.addValue(n),g.addValue(r);const i=h.getLevel({audioPacketLoss:m.getMovingAverageValue(),videoPacketLoss:g.getMovingAverageValue()});t.emit("congestionLevel",i)}),Object.assign(t,{start(){v.start()},stop(){y()}})};t.default=c},function(e,t,n){"use strict";var r=n(1);t.__esModule=!0,t.default=void 0;var i=r(n(164)),o=n(29),a=function(e){void 0===e&&(e={});const t=Object.assign({},i.default,e).packetLossCriticalThreshold,n=.5*t,r=.8*t,a=.5*r;return{getLevel(e){let i=e.audioPacketLoss,s=e.videoPacketLoss;return i>r||s>t?o.CRITICAL:i>a||s>n?o.MEDIUM:o.LOW}}};t.default=a},function(e,t,n){"use strict";var r=n(1);t.__esModule=!0,t.default=void 0;var i=n(302),o=r(n(301)),a=e=>0===e?5*i.ONE_SECOND_IN_MS:(0,o.default)(e-1);t.default=a},function(e,t,n){"use strict";const r=e=>e>=15&&e<15.4;e.exports=e=>!!(e=e||n(3)).isiPad||(e.isiPhone?r(e.iOSVersion):!!e.isSafari&&r(e.version))},function(e,t,n){"use strict";const r=[{width:320,height:180,maxBitrate:3e5},{width:320,height:240,maxBitrate:4e5},{width:352,height:288,maxBitrate:5e5},{width:480,height:270,maxBitrate:55e4},{width:640,height:360,maxBitrate:8e5},{width:640,height:480,maxBitrate:8e5},{width:960,height:540,maxBitrate:11e5},{width:1280,height:720,maxBitrate:25e5},{width:1920,height:1080,maxBitrate:45e5}].sort((e,t)=>e.maxBitrate-t.maxBitrate);e.exports=(e,t)=>{var n;return e&&t&&(null==(n=r.find(n=>{let r=n.height,i=n.width;return t*e<=r*i}))?void 0:n.maxBitrate)||45e5}},function(e,t,n){var r=n(63),i=n(100),o=n(36);e.exports=function(e,t){var n={};return t=o(t,3),i(e,(function(e,i,o){r(n,i,t(e,i,o))})),n}},function(e,t,n){"use strict";e.exports=function(e,t){const n=setTimeout(()=>{e((e,n)=>{if(!e)for(let e=0;e<n.length;e+=1){const r=n[e];-1===r.id.indexOf("_send")||"ssrc"!==r.type||"audio"!==r.kind&&"audio"!==r.mediaType||0!==parseInt(r.bytesSent,10)||t()}})},3e3);return function(){clearTimeout(n)}}},function(e,t,n){"use strict";const r=n(6),i=n(306),o=n(16);e.exports=function(){return function(e,t){const n={},a=[];let s=!1,c=!1;this._id=o();const u=()=>{this.trigger("iceConnected"),s=!0};r(this);const d=t.getPeerConnection(e,this);d.on({iceConnected:u,close:()=>this.trigger("close"),signalingStateChange:e=>this.trigger("signalingStateChange",e),signalingStateStable:e=>this.trigger("signalingStateStable",e),error:e=>{let t=e.reason,n=e.prefix;return this.trigger("error",t,n)},qos:e=>{e.parsedStats.isSinglePeerConnection=!0,this.trigger("qos",e)},iceConnectionStateChange:e=>this.trigger("iceConnectionStateChange",e),remoteVideoSupported:e=>this.trigger("remoteVideoSupported",e),negotiationNeeded:()=>{c&&(c=!1,t.removeFromSinglePeerConnection(this._id))}},this),this._onTrackAdded=e=>{const t=e.track,r=e.transceiver;n[t.id]=r.mid,a.push(t),d.iceConnectionStateIsConnected()&&!s&&u(),this.trigger("trackAdded",e)},this.disconnect=()=>{c=!0,t.removeSubscriber(this._id,Object.values(n))},this.removeTrack=e=>{n[e.id]&&t.removeSubscriber(this._id,[n[e.id]]),i(a,e),t.removeTrack(e,this._id)},this.remoteTracks=()=>a,this.generateOfferAndSend=()=>d.generateOfferAndSend(),this.getDataChannel=(e,t,n)=>{d.getDataChannel(e,t,n)},this.getSourceStreamId=()=>d.getSourceStreamId(),this.processMessage=(e,n)=>{"offer"!==e&&"answer"!==e||t.cacheOfferAnswer(n.content),d.processMessage(e,n)},this.remoteDescription=()=>d.remoteDescription(),this.getStats=e=>{d.getStats(e)},this.getSynchronizationSources=e=>{d.getSynchronizationSources(e)},this.getRtcStatsReport=e=>{d.getRtcStatsReport(e)},this.remoteStreams=()=>d.remoteStreams(),this.hasRelayCandidates=()=>d.hasRelayCandidates(),this.iceRestart=()=>d.iceRestart(),this.iceConnectionStateIsConnected=()=>d.iceConnectionStateIsConnected()}}},function(e,t,n){"use strict";e.exports=function(e,t,n){void 0===n&&(n=!1);let r=null,i=0,o=null,a=n;const s=e=>"inbound-rtp"===e.type&&"audio"===(e.kind||e.mediaType),c=e=>e.id===o&&"track"===e.type&&"audio"===(e.kind||e.mediaType),u=setInterval(()=>{e((e,n)=>{if(e)return;const d=n.find(s)||{};o=d.trackId;const l=n.find(c);if(l){const e=l.audioLevel,n=l.totalSamplesReceived;if(void 0===e)return;((e,t)=>e===r&&t===i)(e,n)?(clearInterval(u),t("audioLevelStuck")):((e,t)=>!a&&0===e&&0===r&&t>i)(e,n)&&(clearInterval(u),t("audioLevelStuckAt0")),r=e,i=n}})},500);return n||setTimeout(()=>{a=!0},3e3),{stop:()=>{clearInterval(u)}}}},function(e,t,n){"use strict";(function(t){const r=new(n(21));e.exports=function(e){void 0===e&&(e={});const i=e.analytics||r,o=e.errors||n(7),a=e.ExceptionCodes||n(10),s=e.otError||n(13)(),c=e.sessionObjects||n(22),u=e.uuid||n(16);return function(e){void 0===e&&(e=()=>{});const n=u();function r(t){t?e(s(o.REPORT_ISSUE_FAILED,new Error("Error calling OT.reportIssue(). Check the client's network connection."),a.REPORT_ISSUE_ERROR)):e(null,n)}0===c.sessions.length()?i.logEvent({action:"ReportIssue",variation:"Event",payload:{reportIssueId:n}},null,r):t.all(c.sessions.map(e=>e.reportIssue({id:n}))).then(()=>r(),e=>r(e))}}}).call(this,n(2))},function(e,t,n){"use strict";e.exports=e=>{let t=e.window,n=!1;try{const e=Object.defineProperty({},"passive",{get(){n=!0}});t.addEventListener("testPassive",null,e),t.removeEventListener("testPassive",null,e)}catch(e){}return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(308),a=(r=o)&&r.__esModule?r:{default:r},s=function(){},c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.internalIsCanceled=!1,this.listeners=[]}return i(e,[{key:"isCanceled",value:function(){return this.internalIsCanceled}},{key:"cancel",value:function(){this.internalIsCanceled||(this.internalIsCanceled=!0,this.listeners.forEach((function(e){return e()})),this.listeners=null)}},{key:"throwIfCanceled",value:function(){if(this.internalIsCanceled)throw new a.default("Operation has been canceled.")}},{key:"onCancel",value:function(e){var t=this;return this.internalIsCanceled?s:(this.listeners.push(e),function(){if(t.listeners){var n=t.listeners.indexOf(e);-1!==n&&t.listeners.splice(n,1)}})}},{key:"fork",value:function(){if(this.internalIsCanceled)return e.CANCELED;var t=new e;return this.onCancel((function(){return t.cancel()})),t}}]),e}();t.default=c,c.CANCELED=new c,c.CANCELED.internalIsCanceled=!0},function(e,t,n){"use strict";(function(t){const r=n(62),i=n(309).default,o=n(154);n(109)(),e.exports=function(e,n){const a=r(e),s=new t(t=>{const n=()=>{(e.videoWidth()>2||e.videoHeight()>2)&&t(!0)};a.on("videoDimensionsChanged",n),n()});return i(o(s,n,()=>!1),()=>a.removeAll())}}).call(this,n(2))},function(e,t,n){"use strict";(function(t){const r=n(62),i=n(309).default,o=n(154);n(109)(),e.exports=function(e,n){void 0===n&&(n=5e3);const a=r(e),s=new t(e=>{a.on("timeupdate",e),a.on("loadedmetadata",e)});return i(o(s,n,()=>!1),()=>a.removeAll())}}).call(this,n(2))},function(e,t,n){"use strict";const r=n(0)("WidgetView:fixMini");e.exports=function(e){const t=e.clientWidth,n=e.clientHeight;e.classList.remove("OT_micro"),e.classList.remove("OT_mini"),(t<64||n<64)&&(e.classList.add("OT_micro"),r.debug("OT_micro class added",{clientWidth:t,clientHeight:n,microWidth:64,microHeight:64})),(t<128||n<128)&&(e.classList.add("OT_mini"),r.debug("OT_mini class added",{clientWidth:t,clientHeight:n,miniWidth:128,miniHeight:128}))}},function(e,t,n){"use strict";const r=n(16);e.exports=function(e,t){let n,i;if(e&&e.nodeName?(n=e,n.getAttribute("id")&&0!==n.getAttribute("id").length||n.setAttribute("id","OT_"+r()),i=n.getAttribute("id")):e&&(n=document.getElementById(e),n&&(i=e)),i||(i="OT_"+r().replace(/-/g,"_")),!n)return n=document.createElement("div"),n.id=i,n.setAttribute("id",i),n.style.backgroundColor="#000000",document.body.appendChild(n),n;const o=document.createElement("div");switch(o.id="OT_"+r(),t){case"append":return n.appendChild(o),o;case"before":return n.parentNode.insertBefore(o,n),o;case"after":return n.parentNode.insertBefore(o,n.nextSibling),o;case"replace":default:for(;n.firstChild;)n.removeChild(n.firstChild);return n}}},function(e,t,n){"use strict";e.exports=function(e,t){return void 0===t&&(t="px"),String(parseFloat(e,10))===String(e).trim()?`${String(e).trim()}${t}`:e}},function(e,t,n){"use strict";e.exports=e=>{const t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("viewBox","0 0 300 300"),t.setAttribute("style","width: 50%; dominant-baseline: middle; text-anchor: middle;");const n=(()=>{const e=document.createElementNS("http://www.w3.org/2000/svg","circle");return e.setAttribute("cx","50%"),e.setAttribute("cy","50%"),e.setAttribute("r","50%"),e.setAttribute("fill","%23000000"),e})(),r=(e=>{const t=document.createElementNS("http://www.w3.org/2000/svg","text");t.setAttribute("x","50%"),t.setAttribute("y","50%"),t.setAttribute("dy","5%"),t.setAttribute("line-height","133%"),t.setAttribute("font-size","108"),t.setAttribute("font-weight","500"),t.setAttribute("font-style","normal"),t.setAttribute("fill","%23FFFFFF"),t.setAttribute("font-family","spezia,sans-serif"),t.setAttribute("dominant-baseline","middle"),t.setAttribute("text-anchor","middle");const n=document.createTextNode(e);return t.appendChild(n),t})(e);return t.appendChild(n),t.appendChild(r),t}},function(e,t,n){"use strict";(function(e){var r=n(1);t.__esModule=!0,t.default=void 0;var i=r(n(4)),o=r(n(5));const a=n(74);t.default=function(t){let n=(void 0===t?{}:t).asynchronous;return void 0!==n&&n?function(t,n){let r=void 0===n?{}:n,s=r.frequency,c=void 0===s?10:s,u=r.timeout,d=void 0===u?2e3:u;return new e((e,n)=>{let r;const s=new a((0,o.default)(i.default.mark((function n(){var a,c;return i.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=function(){return(c=(0,o.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t();case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)},a=function(){return c.apply(this,arguments)},n.next=4,a();case 4:n.sent&&(clearTimeout(r),s.stop(),e());case 6:case"end":return n.stop()}}),n)}))),c);r=setTimeout(()=>{s.stop(),n(new Error("TIMEOUT"))},d),s.start()})}:function(t,n){let r=void 0===n?{}:n,i=r.frequency,o=void 0===i?60:i,s=r.timeout,c=void 0===s?2e3:s;return new e((e,n)=>{let r;const i=new a(()=>{(function(){try{return t()}catch(e){return!1}})()&&(clearTimeout(r),i.stop(),e())},o);r=setTimeout(()=>{i.stop(),n(new Error("TIMEOUT"))},c),i.start()})}}}).call(this,n(2))},function(e,t,n){"use strict";const r=n(13)(),i=n(7),o=n(10);e.exports=e=>"404"===String(e.code)?r(i.STREAM_NOT_FOUND,new Error("stream not found"),o.UNABLE_TO_SUBSCRIBE):"409"===String(e.code)&&"streamLimitExceeded"===e.message?r(i.STREAM_LIMIT_EXCEEDED,new Error("The limit for concurrent streams in the session has been reached"),o.STREAM_LIMIT_EXCEEDED):"405"===String(e.code)&&"IncompatibleEncryptionSettings"===e.message?r(i.UNABLE_TO_SUBSCRIBE,new Error("Tried to subscribe to an encrypted stream without enabling encryption"),o.UNABLE_TO_SUBSCRIBE):"500"===String(e.code)&&"Not connected."===e.message?r(i.UNABLE_TO_SUBSCRIBE,new Error("Tried to subscribe to a stream while disconnected."),o.UNABLE_TO_SUBSCRIBE):r(i.UNABLE_TO_SUBSCRIBE,new Error(`subscriberCreate failed with unexpected code ${e.code}: ${e.message}`),o.UNEXPECTED_SERVER_RESPONSE)},function(e,t,n){"use strict";const r=n(26),i=n(50),o=n(105),a=n(24)();e.exports=e=>{let t=e.subscriber,n=e.audioLevelSampler,s=0,c=0;const u=new o(()=>{const e=t.listenerCount(r.AUDIO_LEVEL_UPDATED);i()-c>1e4&&0===e?u.stop():(s=n.sample(),e>0&&t.dispatchEvent(new a.AudioLevelUpdatedEvent(s)))});return Object.defineProperty(t,"loudness",{get:()=>(u.start(),c=i(),s),set(){throw new TypeError("Cannot set readonly property loudness")},configurable:!0}),t.listenerCount(r.AUDIO_LEVEL_UPDATED)&&u.start(),t.on("audioLevelUpdated:added",()=>{u.start()}),t.once(r.SUBSCRIBER_DESTROYED,()=>{u.stop()}),{destroy(){n.destroy(),u.stop()}}}},function(e,t,n){"use strict";const r=n(253),i=n(146),o=n(695),a=n(311),s=n(312),c=n(158)(),u=n(696),d=n(0)("Subscriber");e.exports=function(e,t){void 0===t&&(t={});const n=t.hasGetSynchronizationSupport;if(e){if(o({hasGetSynchronizationSupport:n}))return new r(e.getSynchronizationSources);if(a())return new r(e.getStats);if(s()){let e;try{e=t.audioContext||c()}catch(e){d.warn("Failed to get AudioContext()",e)}if(u(e))return new i(e)}}}},function(e,t,n){"use strict";const r=n(3),i=()=>window.RTCRtpReceiver&&"getSynchronizationSources"in window.RTCRtpReceiver.prototype;e.exports=function(e){void 0===e&&(e={});const t=e.hasGetSynchronizationSupport||i;return"boolean"==typeof e.isEnabled&&e.isEnabled&&t()&&!r.isFirefox}},function(e,t,n){"use strict";e.exports=e=>(void 0!==typeof window?window:global).AudioContext&&e instanceof(void 0!==typeof window?window:global).AudioContext||(void 0!==typeof window?window:global).webkitAudioContext&&e instanceof(void 0!==typeof window?window:global).webkitAudioContext},function(e,t,n){"use strict";const r=n(37),i=n(8);e.exports=function(e){let t=!1;const n=e=>{const n=["auto","on"].indexOf(this.getDisplayMode())>-1;i.removeClass(e,["OT_audio-blocked","OT_active"].join(" ")),n&&(t&&i.addClass(e,"OT_audio-blocked"),i.addClass(e,"OT_active"))};this.setAudioBlocked=e=>{t=e,n(this.domElement)},r(this,{mode:e.mode||"auto",nodeName:"div",htmlAttributes:{className:"OT_audio-blocked-indicator"}});const o=this.setDisplayMode.bind(this);this.setDisplayMode=e=>{o(e),n(this.domElement)}}},function(e,t,n){"use strict";const r=n(37),i=n(8);e.exports=function(e){let t=!1;const n=e=>{const n=["auto","on"].indexOf(this.getDisplayMode())>-1;i.removeClass(e,["OT_active"].join(" ")),n&&t&&i.addClass(e,"OT_active")};this.setVideoUnsupported=e=>{t=e,n(this.domElement)},r(this,{mode:e.mode||"auto",nodeName:"div",htmlAttributes:{className:"OT_video-unsupported"},htmlContent:'<div class="OT_video-unsupported-bar"></div><div class="OT_video-unsupported-img"></div><span class="OT_video-unsupported-text">Video format not supported</span>'});const o=this.setDisplayMode.bind(this);this.setDisplayMode=e=>{o(e),n(this.domElement)}}},function(e,t,n){"use strict";const r=n(48),i=n(9),o=n(61),a=n(76),s=n(157);e.exports=function(e,t){let n;void 0===t&&(t=5e3);let c=!1;const u={},d=()=>{c||e((e,s)=>{if(!c){if(!e){const e=function(e){return void 0===e&&(e=[]),o(e,e=>a.isVideoInboundRtpStat(e))}(s);e?i(u,r(e,["timestamp","framesDecoded"])):u.timestamp||i(u,{timestamp:Date.now(),framesDecoded:0})}n=setTimeout(d,t)}})};return d(),{getFrameRateFromStat:e=>s({currentStatFrames:e.framesDecoded,currentTimestamp:e.timestamp,prevStatFrames:u.framesDecoded,prevTimestamp:u.timestamp}),destroy(){c=!0,n&&(clearTimeout(n),n=null)}}}},function(e,t,n){"use strict";e.exports=e=>{let t=e.connectivityState,n=e.onWarning,r=e.onTimeout,i=e.warningMs,o=e.timeoutMs;const a=[],s=()=>{a.forEach(e=>clearTimeout(e))};t.observe({onEnterConnecting(){a.push(setTimeout(n,i),setTimeout(r,o))},onEnterConnected:s,onEnterDisconnected:s})}},function(e,t,n){"use strict";const r=n(315);e.exports=e=>{let t=e.onInvalidTransition;return new r({init:"disconnected",transitions:[{name:"beginConnect",from:"disconnected",to:"connecting"},{name:"connect",from:"connecting",to:"connected"},{name:"fail",from:["connecting","connected"],to:"disconnected"},{name:"cancel",from:["connecting","connected"],to:"disconnected"},{name:"disconnect",from:["connecting","connected"],to:"disconnected"}],methods:{onInvalidTransition:t}})}},function(e,t,n){"use strict";const r=n(74);e.exports=e=>{let t=e.connectivityState,n=e.logAttempt;const i=new r(n,.2,6);t.observe({onEnterConnecting(){i.start()},onEnterDisconnected(){i.stop()},onEnterConnected(){i.stop()}})}},function(e,t){e.exports=function(e){if(null==e)throw new TypeError("Cannot destructure undefined")}},function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n.apply(this,arguments)}e.exports=n},function(e,t,n){"use strict";var r=n(1);t.__esModule=!0,t.default=void 0;var i=r(n(4)),o=r(n(5)),a=r(n(14)),s=r(n(706)),c=r(n(75)),u=n(29);const d=c.default.ACTIVE_VIDEO,l=c.default.ACTIVE_VIDEO_WITH_WARNING,f=c.default.SUSPENDED_VIDEO;var p=e=>{let t=e.getAllPeerConnections,n=e.AnalyticsHelper;const r=new a.default,c=new n,p=(0,s.default)();p.on("stateChange",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.emit("stateChange",...t)}));const h=function(){var e=(0,o.default)(i.default.mark((function e(){var n,r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:n=e.sent,r=n.reduce((e,t)=>{var n;return Math.max(e,null==(n=t.getAudioFallbackState())?void 0:n.videoState)},d),p.setState(r);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object.assign(r,{onPeerConnectionStateChange:e=>{let t=e.state,n=e.peerConnection,r=e.publishVideo,i=e.stream,o=e.peerId,a=e.connectionId,s=e.sessionId;if(r){const e="MANTIS"===n.getSourceStreamId()?void 0:o;switch(t){case d:i.setChannelActiveState("video",!0,"auto",u.LOW,e);break;case l:i.setChannelActiveState("video",!0,"auto",u.MEDIUM,e);break;case f:i.setChannelActiveState("video",!1,"auto",u.CRITICAL,e)}c.logEvent({action:"congestionLevelChanged",payload:{congestionLevel:t},streamId:i.id,sessionId:s,connectionId:a})}h()},onPeerConnectionDisconnected:()=>{h()},reset:()=>p.reset(),getState:()=>p.getState()})};t.default=p},function(e,t,n){"use strict";var r=n(1);t.__esModule=!0,t.default=void 0;var i=r(n(14)),o=r(n(75)),a=()=>{const e=new i.default;let t=o.default.ACTIVE_VIDEO;return Object.assign(e,{getState:()=>t,setState(n){if(!Object.values(o.default).includes(n))throw new Error("Invalid video state: ",n);if(n===t)return;const r=t;t=n,e.emit("stateChange",{state:t,previousState:r})},reset(){t=o.default.ACTIVE_VIDEO}})};t.default=a},function(e,t,n){"use strict";var r=n(1);t.__esModule=!0,t.default=function(e){const t=u();let n=!1;t.addEventListener("devicechange",(0,o.default)(i.default.mark((function t(){var r;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=2;break}return t.abrupt("return");case 2:return n=!0,t.next=5,c();case 5:r=t.sent,n=!1,e.setAudioSource(r);case 8:case"end":return t.stop()}}),t)}))))};var i=r(n(4)),o=r(n(5)),a=r(n(708)),s=r(n(20));const c=(0,a.default)(),u=(0,s.default)().getNativeMediaDevices},function(e,t,n){"use strict";var r=n(1);t.__esModule=!0,t.default=void 0;var i=r(n(4)),o=r(n(5)),a=r(n(20)),s=r(n(289));t.default=function(e){void 0===e&&(e={});const t=e.deviceHelpers||(0,a.default)(),n=t.getAudioInputMediaDevices,r=t.getDefaultAudioInputDevice,c=t.hasDevice,u=e.currentAudioOutputDevice||s.default,d=u.getCurrentAudioInputDevice,l=u.setCurrentAudioInputDevice;return function(){var e=(0,o.default)(i.default.mark((function e(){var t,o,a,s;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n();case 2:if(0!==(t=e.sent).length){e.next=6;break}return l(""),e.abrupt("return");case 6:if(o=d(),a=c(t,o.deviceId),s=r(t),!a||o.label!==s.label){e.next=11;break}return e.abrupt("return");case 11:return l(s),e.abrupt("return",s.deviceId);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}},function(e,t,n){var r=n(710),i=n(260),o=r((function(e,t,n){return e+(n?" ":"")+i(t)}));e.exports=o},function(e,t,n){var r=n(711),i=n(712),o=n(715),a=RegExp("['â]","g");e.exports=function(e){return function(t){return r(o(i(t).replace(a,"")),e,"")}}},function(e,t){e.exports=function(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}},function(e,t,n){var r=n(713),i=n(60),o=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,a=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");e.exports=function(e){return(e=i(e))&&e.replace(o,r).replace(a,"")}},function(e,t,n){var r=n(714)({Ã:"A",Ã:"A",Ã:"A",Ã:"A",Ã:"A",Ã:"A",Ã :"a",Ã¡:"a",Ã¢:"a",Ã£:"a",Ã¤:"a",Ã¥:"a",Ã:"C",Ã§:"c",Ã:"D",Ã°:"d",Ã:"E",Ã:"E",Ã:"E",Ã:"E",Ã¨:"e",Ã©:"e",Ãª:"e",Ã«:"e",Ã:"I",Ã:"I",Ã:"I",Ã:"I",Ã¬:"i",Ã­:"i",Ã®:"i",Ã¯:"i",Ã:"N",Ã±:"n",Ã:"O",Ã:"O",Ã:"O",Ã:"O",Ã:"O",Ã:"O",Ã²:"o",Ã³:"o",Ã´:"o",Ãµ:"o",Ã¶:"o",Ã¸:"o",Ã:"U",Ã:"U",Ã:"U",Ã:"U",Ã¹:"u",Ãº:"u",Ã»:"u",Ã¼:"u",Ã:"Y",Ã½:"y",Ã¿:"y",Ã:"Ae",Ã¦:"ae",Ã:"Th",Ã¾:"th",Ã:"ss",Ä:"A",Ä:"A",Ä:"A",Ä:"a",Ä:"a",Ä:"a",Ä:"C",Ä:"C",Ä:"C",Ä:"C",Ä:"c",Ä:"c",Ä:"c",Ä:"c",Ä:"D",Ä:"D",Ä:"d",Ä:"d",Ä:"E",Ä:"E",Ä:"E",Ä:"E",Ä:"E",Ä:"e",Ä:"e",Ä:"e",Ä:"e",Ä:"e",Ä:"G",Ä:"G",Ä :"G",Ä¢:"G",Ä:"g",Ä:"g",Ä¡:"g",Ä£:"g",Ä¤:"H",Ä¦:"H",Ä¥:"h",Ä§:"h",Ä¨:"I",Äª:"I",Ä¬:"I",Ä®:"I",Ä°:"I",Ä©:"i",Ä«:"i",Ä­:"i",Ä¯:"i",Ä±:"i",Ä´:"J",Äµ:"j",Ä¶:"K",Ä·:"k",Ä¸:"k",Ä¹:"L",Ä»:"L",Ä½:"L",Ä¿:"L",Å:"L",Äº:"l",Ä¼:"l",Ä¾:"l",Å:"l",Å:"l",Å:"N",Å:"N",Å:"N",Å:"N",Å:"n",Å:"n",Å:"n",Å:"n",Å:"O",Å:"O",Å:"O",Å:"o",Å:"o",Å:"o",Å:"R",Å:"R",Å:"R",Å:"r",Å:"r",Å:"r",Å:"S",Å:"S",Å:"S",Å :"S",Å:"s",Å:"s",Å:"s",Å¡:"s",Å¢:"T",Å¤:"T",Å¦:"T",Å£:"t",Å¥:"t",Å§:"t",Å¨:"U",Åª:"U",Å¬:"U",Å®:"U",Å°:"U",Å²:"U",Å©:"u",Å«:"u",Å­:"u",Å¯:"u",Å±:"u",Å³:"u",Å´:"W",Åµ:"w",Å¶:"Y",Å·:"y",Å¸:"Y",Å¹:"Z",Å»:"Z",Å½:"Z",Åº:"z",Å¼:"z",Å¾:"z",Ä²:"IJ",Ä³:"ij",Å:"Oe",Å:"oe",Å:"'n",Å¿:"s"});e.exports=r},function(e,t){e.exports=function(e){return function(t){return null==e?void 0:e[t]}}},function(e,t,n){var r=n(716),i=n(717),o=n(60),a=n(718);e.exports=function(e,t,n){return e=o(e),void 0===(t=n?void 0:t)?i(e)?a(e):r(e):e.match(t)||[]}},function(e,t){var n=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;e.exports=function(e){return e.match(n)||[]}},function(e,t){var n=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;e.exports=function(e){return n.test(e)}},function(e,t){var n="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",r="["+n+"]",i="\\d+",o="[\\u2700-\\u27bf]",a="[a-z\\xdf-\\xf6\\xf8-\\xff]",s="[^\\ud800-\\udfff"+n+i+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",c="(?:\\ud83c[\\udde6-\\uddff]){2}",u="[\\ud800-\\udbff][\\udc00-\\udfff]",d="[A-Z\\xc0-\\xd6\\xd8-\\xde]",l="(?:"+a+"|"+s+")",f="(?:"+d+"|"+s+")",p="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",h="[\\ufe0e\\ufe0f]?"+p+"(?:\\u200d(?:"+["[^\\ud800-\\udfff]",c,u].join("|")+")[\\ufe0e\\ufe0f]?"+p+")*",m="(?:"+[o,c,u].join("|")+")"+h,g=RegExp([d+"?"+a+"+(?:['â](?:d|ll|m|re|s|t|ve))?(?="+[r,d,"$"].join("|")+")",f+"+(?:['â](?:D|LL|M|RE|S|T|VE))?(?="+[r,d+l,"$"].join("|")+")",d+"?"+l+"+(?:['â](?:d|ll|m|re|s|t|ve))?",d+"+(?:['â](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",i,m].join("|"),"g");e.exports=function(e){return e.match(g)||[]}},function(e,t,n){"use strict";const r=n(48),i=n(269),o=n(319);e.exports=e=>{const t=r(e,["audioDeviceId","audioFallback","audioFallbackEnabled","audioSource","channels","classNames","constraints","disableAudioProcessing","echoCancellation","noiseSuppression","autoGainControl","enableRenegotiation","enableStereo","facingMode","fitMode","frameRate","height","insertDefaultUI","insertMode","audioBitrate","maxResolution","minVideoBitrate","mirror","name","publishAudio","publishVideo","publishCaptions","resolution","scalableScreenshare","scalableVideo","showControls","style","videoContentHint","videoDeviceId","videoDimensions","videoFilter","videoSource","width"]);return t.style&&(t.style=i(t.style)),t.videoFilter&&(t.videoFilter=o(t.videoFilter)),t}},function(e,t,n){"use strict";const r=n(26),i=n(50),o=n(105),a=n(24)();e.exports=e=>{let t=e.publisher,n=e.widgetView,s=0,c=0;const u=new o(()=>{const e=t.listenerCount(r.AUDIO_LEVEL_UPDATED);if(i()-c>1e4&&0===e)return void u.stop();const o=n&&n.video();if(o){const n=o.getAudioInputLevel();s=n,e>0&&t.dispatchEvent(new a.AudioLevelUpdatedEvent(n))}});Object.defineProperty(t,"loudness",{get:()=>(u.start(),c=i(),s),set(){throw new TypeError("Cannot set readonly property loudness")}}),t.listenerCount(r.AUDIO_LEVEL_UPDATED)&&u.start(),t.on("audioLevelUpdated:added",()=>{u.start()}),t.once(r.PUBLISHER_DESTROYED,()=>{u.stop()})}},function(e,t,n){"use strict";var r=n(1),i=r(n(4)),o=r(n(5));e.exports=function(e){let t=!1;return function(){var n=(0,o.default)(i.default.mark((function n(){var r,o,a,s=arguments;return i.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=2;break}throw new Error("The previous call to this function has not yet completed.");case 2:for(t=!0,n.prev=3,r=s.length,o=new Array(r),a=0;a<r;a++)o[a]=s[a];return n.next=7,e.call(this,...o);case 7:return n.abrupt("return",n.sent);case 8:return n.prev=8,t=!1,n.finish(8);case 11:case"end":return n.stop()}}),n,this,[[3,,8,11]])})));return function(){return n.apply(this,arguments)}}()}},function(e,t,n){"use strict";const r=n(13)(),i=n(7);e.exports=function(e){const t=document.createElement("canvas");if(!t.captureStream)throw r(i.NOT_SUPPORTED,new Error("Your browser does not support HTMLCanvasElement.captureStream()"));t.width=e.width,t.height=e.height,t.getContext("2d").fillRect(0,0,1,1);const n=t.captureStream().getVideoTracks()[0];return n.isCreatedCanvas=!0,n.enabled=!1,n}},function(e,t,n){"use strict";e.exports=(e,t)=>{if(!e)return null;const n=e.getVideoTracks()[0];return n?((e,t)=>(e=>e.getSettings&&e.getSettings().deviceId)(e)||(e=>{let t;return e.getConstraints&&e.getConstraints().deviceId&&(t=e.getConstraints().deviceId.exact),t})(e)||((e,t)=>{let n;if(t&&t.length){const r=t.find(t=>t.label===e.label);r&&(n=r.deviceId)}return n})(e,t))(n,t):null}},function(e,t,n){"use strict";const r=n(7),i=n(10),o=n(13)();e.exports=e=>{const t=String(e.code);return"405"===t&&"IncompatibleEncryptionSettings"===e.message?o(r.STREAM_CREATE_FAILED,new Error("IncompatibleEncryptionSettings: Tried to publish a stream to an encrypted session without enabling encryption"),i.UNABLE_TO_PUBLISH):["403","404","409"].includes(t)?o(r.STREAM_CREATE_FAILED,new Error("Failed to create stream in server model: "+e.message),i.UNABLE_TO_PUBLISH):o(r.UNEXPECTED_SERVER_RESPONSE,new Error("Unexpected server response: "+e.message),i.UNEXPECTED_SERVER_RESPONSE)}},function(e,t,n){"use strict";var r=n(1),i=r(n(4)),o=r(n(5));const a=n(3),s=n(320),c=n(727),u=n(0)("MediaProcessor"),d=n(102).getProxyUrl;function l(e){var t=this;void 0===e&&(e={});const n=e,r=n.ML,a=void 0===r?s:r,l=n.MediaTransform,f=void 0===l?c:l,p=n.getProxyUrl,h=void 0===p?d:p;let m,g,v,y;this.isValidVideoFilter=e=>{const t=e.type;return f.isSupported(t)&&f.isValidConfig(e)},this.canUpdateVideoFilter=e=>["backgroundBlur","backgroundReplacement"].includes(e),this.updateVideoFilter=function(){var e=(0,o.default)(i.default.mark((function e(n){var r,o,a;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.type,t.canUpdateVideoFilter(r)){e.next=4;break}return u.warn(`Ignoring: filter "${r}" doesn't support real-time updates`),e.abrupt("return");case 4:return o=f.getConfigurator(r),a=o.getConfig(Object.assign({proxyUrl:h()},n)),e.next=8,g.setBackgroundOptions(a);case 8:v=n;case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.setVideoFilter=function(){var e=(0,o.default)(i.default.mark((function e(n){var r,o,s;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.type,o=f.getConfigurator(r)){e.next=5;break}return u.warn(`Ignoring: filter "${r}" isn't supported`),e.abrupt("return");case 5:if(s=o.getConfig(Object.assign({proxyUrl:h()},n))){e.next=9;break}return u.warn("Ignoring: couldn't configure filter "+r),e.abrupt("return");case 9:if(!t.getVideoFilter()){e.next=20;break}return e.prev=11,e.next=14,t.destroy();case 14:e.next=20;break;case 16:return e.prev=16,e.t0=e.catch(11),u.warn("Ignoring, couldn't remove previous filter: "+e.t0),e.abrupt("return");case 20:return e.next=22,a.createProcessor(s);case 22:return g=e.sent,e.next=25,g.getConnector();case 25:m=e.sent,v=n;case 27:case"end":return e.stop()}}),e,null,[[11,16]])})));return function(t){return e.apply(this,arguments)}}(),this.getVideoFilter=()=>v,this.getOriginalVideoTrack=()=>y,this.setMediaStream=function(){var e=(0,o.default)(i.default.mark((function e(t){var n,r,o;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.getVideoTracks(),r=n[0]){e.next=4;break}return u.warn("Ignoring. No video track found"),e.abrupt("return",null);case 4:return o=null,e.prev=5,e.next=8,m.setTrack(r);case 8:o=e.sent,y=r,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),u.error("Error setting media stream: "+e.t0);case 15:return e.abrupt("return",o);case 16:case"end":return e.stop()}}),e,null,[[5,12]])})));return function(t){return e.apply(this,arguments)}}(),this.setVideoTrack=function(){var e=(0,o.default)(i.default.mark((function e(t){var n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.prev=1,e.next=4,m.setTrack(t);case 4:n=e.sent,y=t,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),u.error("Error setting video track: "+e.t0);case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),this._setConnector=e=>{m=e},this.destroy=(0,o.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.destroy();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),u.warn("Error destroying connector: "+e.t0);case 8:m=null,v=null,y=null;case 11:case"end":return e.stop()}}),e,null,[[0,5]])}))),this.enableLogging=e=>{if(!e)return void u.warn("Error enabling logging: invalid API key");const t={appId:e,sourceType:"video"},n=h();n&&(t.proxyUrl=n),a.setMetadata(t)},this.disableLogging=()=>{a.setMetadata()}}l.isSupported=function(e){void 0===e&&(e={});const t=e,n=t.env,r=void 0===n?a:n,i=t.ML,o=void 0===i?s:i;return!!r.isChromium&&o.isSupported()},e.exports=l},function(e,t,n){"use strict";n.r(t),function(e,r){n.d(t,"ErrorFunction",(function(){return ne})),n.d(t,"MediaProcessor",(function(){return ae})),n.d(t,"MediaProcessorConnector",(function(){return ce})),n.d(t,"PipelineInfoData",(function(){return re})),n.d(t,"VonageSourceType",(function(){return A})),n.d(t,"WarningType",(function(){return te})),n.d(t,"getVonageMetadata",(function(){return Q})),n.d(t,"isSupported",(function(){return a})),n.d(t,"setVonageMetadata",(function(){return K}));var i=Object.defineProperty,o=(e,t,n)=>(((e,t,n)=>{t in e?i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);function a(){return new e((e,t)=>{typeof MediaStreamTrackProcessor>"u"||typeof MediaStreamTrackGenerator>"u"?t("Your browser does not support the MediaStreamTrack API for Insertable Streams of Media."):e()})}class s{}o(s,"updates",{transformer_new:"New transformer",transformer_null:"Null transformer"}),o(s,"errors",{transformer_none:"No transformers provided",transformer_start:"Cannot start transformer",transformer_transform:"Cannot transform frame",transformer_flush:"Cannot flush transformer",readable_null:"Readable is null",writable_null:"Writable is null"});const c=new WeakMap,u=new WeakMap,d=new WeakMap,l=Symbol("anyProducer"),f=e.resolve(),p=Symbol("listenerAdded"),h=Symbol("listenerRemoved");let m=!1;function g(e){if("string"!=typeof e&&"symbol"!=typeof e)throw new TypeError("eventName must be a string or a symbol")}function v(e){if("function"!=typeof e)throw new TypeError("listener must be a function")}function y(e,t){const n=u.get(e);return n.has(t)||n.set(t,new Set),n.get(t)}function b(e,t){const n="string"==typeof t||"symbol"==typeof t?t:l,r=d.get(e);return r.has(n)||r.set(n,new Set),r.get(n)}function S(t,n){n=Array.isArray(n)?n:[n];let r=!1,i=()=>{},o=[];const a={enqueue(e){o.push(e),i()},finish(){r=!0,i()}};for(const e of n)b(t,e).add(a);return{async next(){return o?0===o.length?r?(o=void 0,this.next()):(await new e(e=>{i=e}),this.next()):{done:!1,value:await o.shift()}:{done:!0}},async return(e){o=void 0;for(const e of n)b(t,e).delete(a);return i(),arguments.length>0?{done:!0,value:await e}:{done:!0}},[Symbol.asyncIterator](){return this}}}function E(e){if(void 0===e)return R;if(!Array.isArray(e))throw new TypeError("`methodNames` must be an array of strings");for(const t of e)if(!R.includes(t))throw"string"!=typeof t?new TypeError("`methodNames` element must be a string"):new Error(t+" is not Emittery method");return e}const _=e=>e===p||e===h;class T{static mixin(e,t){return t=E(t),n=>{if("function"!=typeof n)throw new TypeError("`target` must be function");for(const e of t)if(void 0!==n.prototype[e])throw new Error(`The property \`${e}\` already exists on \`target\``);Object.defineProperty(n.prototype,e,{enumerable:!1,get:function(){return Object.defineProperty(this,e,{enumerable:!1,value:new T}),this[e]}});const r=t=>function(...n){return this[e][t](...n)};for(const e of t)Object.defineProperty(n.prototype,e,{enumerable:!1,value:r(e)});return n}}static get isDebugEnabled(){if("object"!=typeof r)return m;const{env:e}=r||{env:{}};return"emittery"===e.DEBUG||"*"===e.DEBUG||m}static set isDebugEnabled(e){m=e}constructor(e={}){c.set(this,new Set),u.set(this,new Map),d.set(this,new Map),this.debug=e.debug||{},void 0===this.debug.enabled&&(this.debug.enabled=!1),this.debug.logger||(this.debug.logger=(e,t,n,r)=>{try{r=JSON.stringify(r)}catch{r="Object with the following keys failed to stringify: "+Object.keys(r).join(",")}"symbol"==typeof n&&(n=n.toString());const i=new Date,o=`${i.getHours()}:${i.getMinutes()}:${i.getSeconds()}.${i.getMilliseconds()}`;console.log(`[${o}][emittery:${e}][${t}] Event Name: ${n}\n\tdata: ${r}`)})}logIfDebugEnabled(e,t,n){(T.isDebugEnabled||this.debug.enabled)&&this.debug.logger(e,this.debug.name,t,n)}on(e,t){v(t),e=Array.isArray(e)?e:[e];for(const n of e)g(n),y(this,n).add(t),this.logIfDebugEnabled("subscribe",n,void 0),_(n)||this.emit(p,{eventName:n,listener:t});return this.off.bind(this,e,t)}off(e,t){v(t),e=Array.isArray(e)?e:[e];for(const n of e)g(n),y(this,n).delete(t),this.logIfDebugEnabled("unsubscribe",n,void 0),_(n)||this.emit(h,{eventName:n,listener:t})}once(t){return new e(e=>{const n=this.on(t,t=>{n(),e(t)})})}events(e){e=Array.isArray(e)?e:[e];for(const t of e)g(t);return S(this,e)}async emit(t,n){g(t),this.logIfDebugEnabled("emit",t,n),function(t,n,r){const i=d.get(t);if(i.has(n))for(const e of i.get(n))e.enqueue(r);if(i.has(l)){const t=e.all([n,r]);for(const e of i.get(l))e.enqueue(t)}}(this,t,n);const r=y(this,t),i=c.get(this),o=[...r],a=_(t)?[]:[...i];await f,await e.all([...o.map(async e=>{if(r.has(e))return e(n)}),...a.map(async e=>{if(i.has(e))return e(t,n)})])}async emitSerial(e,t){g(e),this.logIfDebugEnabled("emitSerial",e,t);const n=y(this,e),r=c.get(this),i=[...n],o=[...r];await f;for(const e of i)n.has(e)&&await e(t);for(const n of o)r.has(n)&&await n(e,t)}onAny(e){return v(e),this.logIfDebugEnabled("subscribeAny",void 0,void 0),c.get(this).add(e),this.emit(p,{listener:e}),this.offAny.bind(this,e)}anyEvent(){return S(this)}offAny(e){v(e),this.logIfDebugEnabled("unsubscribeAny",void 0,void 0),this.emit(h,{listener:e}),c.get(this).delete(e)}clearListeners(e){e=Array.isArray(e)?e:[e];for(const t of e)if(this.logIfDebugEnabled("clear",t,void 0),"string"==typeof t||"symbol"==typeof t){y(this,t).clear();const e=b(this,t);for(const t of e)t.finish();e.clear()}else{c.get(this).clear();for(const e of u.get(this).values())e.clear();for(const e of d.get(this).values()){for(const t of e)t.finish();e.clear()}}}listenerCount(e){e=Array.isArray(e)?e:[e];let t=0;for(const n of e)if("string"!=typeof n){typeof n<"u"&&g(n),t+=c.get(this).size;for(const e of u.get(this).values())t+=e.size;for(const e of d.get(this).values())t+=e.size}else t+=c.get(this).size+y(this,n).size+b(this,n).size+b(this).size;return t}bindMethods(e,t){if("object"!=typeof e||null===e)throw new TypeError("`target` must be an object");t=E(t);for(const n of t){if(void 0!==e[n])throw new Error(`The property \`${n}\` already exists on \`target\``);Object.defineProperty(e,n,{enumerable:!1,value:this[n].bind(this)})}}}const R=Object.getOwnPropertyNames(T.prototype).filter(e=>"constructor"!==e);Object.defineProperty(T,"listenerAdded",{value:p,writable:!1,enumerable:!0,configurable:!1}),Object.defineProperty(T,"listenerRemoved",{value:h,writable:!1,enumerable:!0,configurable:!1});var I=T;function w(e){return function(e){if(function(e){return"object"==typeof e&&null!==e&&"message"in e&&"string"==typeof e.message}(e))return e;try{return new Error(JSON.stringify(e))}catch{return new Error(String(e))}}(e).message}var C=Object.defineProperty,O=(e,t,n)=>(((e,t,n)=>{t in e?C(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n),A=(e=>(e.automation="automation",e.test="test",e.vbc="vbc",e.video="video",e.voice="voice",e))(A||{});let x;const k=new Uint8Array(16);function N(){if(!x&&(x=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!x))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return x(k)}const L=[];for(let e=0;e<256;++e)L.push((e+256).toString(16).slice(1));const M={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function V(e,t,n){if(M.randomUUID&&!t&&!e)return M.randomUUID();const r=(e=e||{}).random||(e.rng||N)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return function(e,t=0){return(L[e[t+0]]+L[e[t+1]]+L[e[t+2]]+L[e[t+3]]+"-"+L[e[t+4]]+L[e[t+5]]+"-"+L[e[t+6]]+L[e[t+7]]+"-"+L[e[t+8]]+L[e[t+9]]+"-"+L[e[t+10]]+L[e[t+11]]+L[e[t+12]]+L[e[t+13]]+L[e[t+14]]+L[e[t+15]]).toLowerCase()}(r)}function P(e,t){globalThis.vonage||(globalThis.vonage={}),globalThis.vonage.workerizer||(globalThis.vonage.workerizer={});let n=globalThis.vonage.workerizer;return n[e]||(n[e]=t),n[e]}const D=P("globals",{});var Z=(e=>(e.INIT="INIT",e.FORWARD="FORWARD",e.TERMINATE="TERMINATE",e.GLOBALS_SYNC="GLOBALS_SYNC",e))(Z||{});function j(e){return[ImageBitmap,ReadableStream,WritableStream].some(t=>e instanceof t)}let W=0;function G(t,n,r,i,o){const a=W++;return t.postMessage({id:a,type:n,functionName:r,args:i},i.filter(e=>j(e))),new e(e=>{null==o||o.set(a,e)})}function F(e,t){const{id:n,type:r}=e,i=Array.isArray(t)?t:[t];postMessage({id:n,type:r,result:t},i.filter(e=>j(e)))}const U=P("workerized",{});function X(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}function B(e,t){if(Array.isArray(t))t.splice(0,t.length);else if("object"==typeof t)for(const e in t)delete t[e];for(const n in e)Array.isArray(e[n])?(t[n]=[],B(e[n],t[n])):"object"==typeof e[n]?(t[n]={},B(e[n],t[n])):t[n]=e[n]}const H=P("registeredWorkers",{});function Y(t,n){return D[t]||(D[t]=n),[()=>D[t],async n=>{D[t]=n,await async function(){if(X())F({type:Z.GLOBALS_SYNC},D);else{const t=[];for(const e in U){const{worker:n,resolvers:r}=U[e].workerContext;n&&t.push(G(n,Z.GLOBALS_SYNC,"",[D],r))}await e.all(t)}}()}]}X()&&function(){const e={};onmessage=async t=>{const n=t.data;switch(n.type){case Z.INIT:!function(e,t){if(!e.args)throw"Missing className while initializing worker";const[n,r]=e.args,i=H[n];if(!i)throw"unknown worker class "+n;t.instance=new i(e.args.slice(1)),B(r,D),F(e,void 0!==typeof t.instance)}(n,e);break;case Z.FORWARD:!async function(e,t){const{functionName:n,args:r}=e;if(!t.instance)throw"instance not initialized";if(!n)throw"missing function name to call";if(!t.instance[n])throw`undefined function [${n}] in class ${t.instance.constructor.workerId}`;F(e,await t.instance[n](...null!=r?r:[]))}(n,e);break;case Z.TERMINATE:!async function(e,t){const{args:n}=e;if(!t.instance)throw"instance not initialized";let r;t.instance.terminate&&(r=await t.instance.terminate(...null!=n?n:[])),F(e,r)}(n,e);break;case Z.GLOBALS_SYNC:!function(e){if(!e.args)throw"Missing globals while syncing";B(e.args[0],D),F(e,{})}(n)}}}();const[J,z]=function(e,t){return Y(e,t)}("metadata");function K(e){z(e)}function Q(){return J()}class q{constructor(e){O(this,"uuid",V()),this.config=e}async send(e){var t,n,r;const{appId:i,sourceType:o}=null!=(t=Q())?t:{};if(!i||!o)return"metadata missing";const a=new AbortController,s=setTimeout(()=>a.abort(),1e4);return await(null!=(r=null==(n=this.config)?void 0:n.fetch)?r:fetch)(this.getUrl(),{method:"POST",headers:this.getHeaders(),body:JSON.stringify(this.buildReport(e)),signal:a.signal}),clearTimeout(s),"success"}getUrl(){var e;let t=null!=(e=Q().proxyUrl)?e:"https://";return t+=("/"===t.at(-1)?"":"/")+"hlg.tokbox.com/prod/logging/vcp_webrtc",t}getHeaders(){return{"Content-Type":"application/json"}}buildReport(e){const t=Q();return{guid:this.uuid,...e,applicationId:t.appId,timestamp:Date.now(),proxyUrl:t.proxyUrl,source:t.sourceType}}}const $="2.0.3";class ee{constructor(e){o(this,"frameTransformedCount",0),o(this,"frameFromSourceCount",0),o(this,"startAt",0),o(this,"reporter"),this.config=e,this.reporter=new q(e)}async onFrameFromSource(){this.frameFromSourceCount++}get fps(){const{startAt:e,frameFromSourceCount:t}=this;return t/((Date.now()-e)/1e3)}async onFrameTransformed(e={},t=!1){0===this.startAt&&(this.startAt=Date.now()),this.frameTransformedCount++;const{startAt:n,frameTransformedCount:r,frameFromSourceCount:i}=this,o=Date.now(),a=(o-n)/1e3,s=r/a,c=i/a;return t||this.frameTransformedCount>=this.config.loggingIntervalFrameCount?(this.frameFromSourceCount=0,this.frameTransformedCount=0,this.startAt=o,this.reporter.config=this.config,this.reporter.send({...this.config.report,variation:"QoS",fps:c,transformedFps:s,framesTransformed:r,...e})):"success"}}var te=(e=>(e.FPS_DROP="fps_drop",e))(te||{}),ne=(e=>(e.start="start",e.transform="transform",e.flush="flush",e))(ne||{}),re=(e=>(e.pipeline_ended="pipeline_ended",e.pipeline_ended_with_error="pipeline_ended_with_error",e.pipeline_started="pipeline_started",e.pipeline_started_with_error="pipeline_started_with_error",e.pipeline_restarted="pipeline_restarted",e.pipeline_restarted_with_error="pipeline_restarted_with_error",e))(re||{});class ie extends I{constructor(e,t){super(),o(this,"reporter_",new q),o(this,"reporterQos_",new ee({loggingIntervalFrameCount:500,report:{version:$}})),o(this,"transformerType_"),o(this,"transformer_"),o(this,"shouldStop_"),o(this,"isFlashed_"),o(this,"mediaTransformerQosReportStartTimestamp_"),o(this,"videoHeight_"),o(this,"videoWidth_"),o(this,"trackExpectedRate_"),o(this,"index_"),o(this,"controller_"),this.index_=t,this.transformer_=e,this.shouldStop_=!1,this.isFlashed_=!1,this.mediaTransformerQosReportStartTimestamp_=0,this.videoHeight_=0,this.videoWidth_=0,this.trackExpectedRate_=-1,this.transformerType_="Custom","getTransformerType"in e&&(this.transformerType_=e.getTransformerType()),this.report({variation:"Create"})}setTrackExpectedRate(e){this.trackExpectedRate_=e}async start(e){if(this.controller_=e,this.transformer_&&"function"==typeof this.transformer_.start)try{await this.transformer_.start(e)}catch(e){this.report({message:s.errors.transformer_start,variation:"Error",error:w(e)});const t={eventMetaData:{transformerIndex:this.index_},error:e,function:"start"};this.emit("error",t)}}async transform(e,t){var n,r,i,o;if(0===this.mediaTransformerQosReportStartTimestamp_&&(this.mediaTransformerQosReportStartTimestamp_=Date.now()),e instanceof VideoFrame&&(this.videoHeight_=null!=(n=null==e?void 0:e.displayHeight)?n:0,this.videoWidth_=null!=(r=null==e?void 0:e.displayWidth)?r:0),this.reporterQos_.onFrameFromSource(),this.transformer_)if(this.shouldStop_)console.warn("[Pipeline] flush from transform"),e.close(),this.flush(t),t.terminate();else{try{await(null==(o=(i=this.transformer_).transform)?void 0:o.call(i,e,t)),this.reportQos()}catch(e){this.report({message:s.errors.transformer_transform,variation:"Error",error:w(e)});const t={eventMetaData:{transformerIndex:this.index_},error:e,function:"transform"};this.emit("error",t)}if(-1!=this.trackExpectedRate_&&.8*this.trackExpectedRate_>this.reporterQos_.fps){const e={eventMetaData:{transformerIndex:this.index_},warningType:"fps_drop",dropInfo:{requested:this.trackExpectedRate_,current:this.reporterQos_.fps}};this.emit("warn",e)}}}async flush(e){if(this.transformer_&&"function"==typeof this.transformer_.flush&&!this.isFlashed_){this.isFlashed_=!0;try{await this.transformer_.flush(e)}catch(e){this.report({message:s.errors.transformer_flush,variation:"Error",error:w(e)});const t={eventMetaData:{transformerIndex:this.index_},error:e,function:"flush"};this.emit("error",t)}}this.reportQos(!0),this.report({variation:"Delete"})}stop(){console.log("[Pipeline] Stop stream."),this.controller_&&(this.flush(this.controller_),this.controller_.terminate()),this.shouldStop_=!0}report(e){this.reporter_.send({version:$,action:"MediaTransformer",transformerType:this.transformerType_,...e})}reportQos(e=!1){this.reporterQos_.config={...this.reporterQos_.config},this.reporterQos_.onFrameTransformed({version:$,action:"MediaTransformer",transformerType:this.transformerType_,videoWidth:this.videoWidth_,videoHeight:this.videoHeight_},e)}}class oe extends I{constructor(e){super(),o(this,"transformers_"),o(this,"trackExpectedRate_"),this.transformers_=[],this.trackExpectedRate_=-1;for(let t=0;t<e.length;t++){let n=new ie(e[t],t);n.on("error",e=>{this.emit("error",e)}),n.on("warn",e=>{this.emit("warn",e)}),this.transformers_.push(n)}}setTrackExpectedRate(e){this.trackExpectedRate_=e;for(let e of this.transformers_)e.setTrackExpectedRate(this.trackExpectedRate_)}async start(e,t){if(this.transformers_&&0!==this.transformers_.length){try{let n=e;for(let t of this.transformers_)e=e.pipeThrough(new TransformStream(t));e.pipeTo(t).then(async()=>{console.log("[Pipeline] Setup."),await t.abort(),await n.cancel(),this.emit("pipelineInfo","pipeline_ended")}).catch(async r=>{e.cancel().then(()=>{console.log("[Pipeline] Shutting down streams after abort.")}).catch(e=>{console.error("[Pipeline] Error from stream transform:",e)}),await t.abort(r),await n.cancel(r),this.emit("pipelineInfo","pipeline_ended_with_error")})}catch{return this.emit("pipelineInfo","pipeline_started_with_error"),void this.destroy()}this.emit("pipelineInfo","pipeline_started"),console.log("[Pipeline] Pipeline started.")}else console.log("[Pipeline] No transformers.")}async destroy(){console.log("[Pipeline] Destroying Pipeline.");for(let e of this.transformers_)e.stop()}}class ae extends I{constructor(){super(),o(this,"reporter_"),o(this,"pipeline_"),o(this,"transformers_"),o(this,"readable_"),o(this,"writable_"),o(this,"trackExpectedRate_"),this.reporter_=new q,this.trackExpectedRate_=-1,this.report({variation:"Create"})}setTrackExpectedRate(e){this.trackExpectedRate_=e,this.pipeline_&&this.pipeline_.setTrackExpectedRate(this.trackExpectedRate_)}transform(e,t){return this.readable_=e,this.writable_=t,this.transformInternal()}transformInternal(){return new e(async(e,t)=>{if(!this.transformers_||0===this.transformers_.length)return this.report({message:s.errors.transformer_none,variation:"Error"}),void t("[MediaProcessor] Need to set transformers.");if(!this.readable_)return this.report({variation:"Error",message:s.errors.readable_null}),void t("[MediaProcessor] Readable is null.");if(!this.writable_)return this.report({variation:"Error",message:s.errors.writable_null}),void t("[MediaProcessor] Writable is null.");let n=!1;this.pipeline_&&(n=!0,this.pipeline_.clearListeners(),this.pipeline_.destroy()),this.pipeline_=new oe(this.transformers_),this.pipeline_.on("warn",e=>{this.emit("warn",e)}),this.pipeline_.on("error",e=>{this.emit("error",e)}),this.pipeline_.on("pipelineInfo",e=>{n&&("pipeline_started"===e?e=re.pipeline_restarted:"pipeline_started_with_error"===e&&(e=re.pipeline_restarted_with_error)),this.emit("pipelineInfo",e)}),-1!=this.trackExpectedRate_&&this.pipeline_.setTrackExpectedRate(this.trackExpectedRate_),this.pipeline_.start(this.readable_,this.writable_).then(()=>{e()}).catch(e=>{t(e)})})}setTransformers(t){return this.report({variation:"Update",message:s.updates.transformer_new}),this.transformers_=t,this.readable_&&this.writable_?this.transformInternal():e.resolve()}destroy(){return new e(async e=>{this.pipeline_&&this.pipeline_.destroy(),this.report({variation:"Delete"}),e()})}report(e){this.reporter_.send({version:$,action:"MediaProcessor",...e})}}class se{constructor(){o(this,"processor_"),o(this,"generator_"),this.processor_=null,this.generator_=null}init(t){return new e((e,n)=>{try{this.processor_=new MediaStreamTrackProcessor(t)}catch(e){console.log("[InsertableStreamHelper] MediaStreamTrackProcessor failed: "+e),n(e)}try{"audio"===t.kind?this.generator_=new MediaStreamTrackGenerator({kind:"audio"}):"video"===t.kind?this.generator_=new MediaStreamTrackGenerator({kind:"video"}):n("kind not supported")}catch(e){console.log("[InsertableStreamHelper] MediaStreamTrackGenerator failed: "+e),n(e)}e()})}getReadable(){return this.processor_.readable}getWriteable(){return this.generator_.writable}getProccesorTrack(){return this.generator_}}class ce{constructor(e){o(this,"insertableStreamHelper_"),o(this,"mediaProcessor_"),this.insertableStreamHelper_=new se,this.mediaProcessor_=e}setTrack(t){return new e((e,n)=>{this.insertableStreamHelper_.init(t).then(()=>{this.mediaProcessor_.transform(this.insertableStreamHelper_.getReadable(),this.insertableStreamHelper_.getWriteable()).then(()=>{e(this.insertableStreamHelper_.getProccesorTrack())}).catch(e=>{n(e)})}).catch(e=>{n(e)})})}destroy(){return new e((e,t)=>{this.mediaProcessor_?this.mediaProcessor_.destroy().then(()=>{e()}).catch(e=>{t(e)}):t("no processor")})}}}.call(this,n(2),n(43))},function(e,t,n){"use strict";const r={backgroundBlur:n(728),backgroundReplacement:n(729)},i=e=>!!r[e],o=e=>i(e)?r[e]:null,a={isSupported:i,getConfigurator:o,isValidConfig:e=>{const t=e.type;return!!i(t)&&o(t).isValidConfig(e)}};e.exports=a},function(e,t,n){"use strict";const r=n(321).BlurRadius,i=n(322),o=r.High,a=e=>"low"===e||"high"===e,s={isValidConfig:e=>{if("backgroundBlur"!==(null==e?void 0:e.type))return!1;const t=e.blurStrength;return!t||a(t)},getConfig:function(e){void 0===e&&(e={});const t=(e=>Object.assign({},i.getConfig(e),{transformerType:"BackgroundBlur",radius:o}))(e),n=e.blurStrength;return a(n)&&(t.radius=(e=>"low"===e?r.Low:r.High)(n)),t}};e.exports=s},function(e,t,n){"use strict";const r=n(322),i=e=>/^data:image\/(?:png|jpeg|bmp|gif);base64/.test(e)||/\.(?:png|jpe?g|bmp|gif)$/i.test(e),o={isValidConfig:e=>{if("backgroundReplacement"!==(null==e?void 0:e.type))return!1;const t=e.backgroundImgUrl;return i(t)},getConfig:function(e){void 0===e&&(e={});const t=(e=>Object.assign({},r.getConfig(e),{transformerType:"VirtualBackground"}))(e),n=e.backgroundImgUrl;return i(n)&&(t.backgroundAssetUri=n),t}};e.exports=o},function(e,t,n){"use strict";var r=n(1),i=r(n(4)),o=r(n(5));const a=n(0)("MediaProcessorConnector");let s=function(e){var t=this;this.setTrack=function(){var e=(0,o.default)(i.default.mark((function e(n){var r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,e.prev=1,e.next=4,t.connector.setTrack(n);case 4:r=e.sent,t.originalTrack=n,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),a.error("Error setting track: "+e.t0);case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),this.destroy=(0,o.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.connector.destroy();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),a.warn("Error destroying connector: "+e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),this.stopOriginalTrack=()=>{this.originalTrack&&(this.originalTrack.stop(),this.originalTrack=null)},this.connector=e};s.isValidConnector=e=>"function"==typeof(null==e?void 0:e.setTrack)&&"function"==typeof(null==e?void 0:e.destroy),e.exports=s},function(e,t,n){"use strict";e.exports=e=>!!e&&!!e.apiKey},function(e,t,n){"use strict";e.exports=e=>null===e||!1===e},function(e,t,n){"use strict";e.exports=e=>{var t;e&&null!=(t=e.videoSource)&&t.canvas&&(!e||!("videoContentHint"in e))&&(e.videoContentHint="detail")}},function(e,t,n){"use strict";const r=n(149);e.exports=e=>{var t;e||(e={});const n=!!r(null==(t=e)?void 0:t.videoSource);e.capableSimulcastScreenshare=n&&(e=>!(null==e||!e.scalableScreenshare))(e)}},function(e,t,n){var r=n(736),i=n(100),o=n(36);e.exports=function(e,t){return r(e,o(t,3),i)}},function(e,t){e.exports=function(e,t,n){var r;return n(e,(function(e,n,i){if(t(e,n,i))return r=n,!1})),r}},function(e,t,n){"use strict";(function(t){const r=n(28),i=n(73);e.exports=e=>{let n,o,a=e.RTCPeerConnection,s=e.env,c=e.stream,u=e.codecFlags;if(s.isLegacyEdge)return!0;const d=()=>{try{n.close()}catch(e){}try{o.close()}catch(e){}n=null,o=null};try{const e={iceServers:[]};i()&&(e.sdpSemantics="plan-b"),n=new a(e),o=new a(e),c.getTracks().forEach(e=>n.addTrack(e,c))}catch(e){return d(),t.resolve(!1)}return n.createOffer().then(e=>{const t={type:e.type,sdp:e.sdp};return Object.keys(u).forEach(e=>{u[e]||(t.sdp=r.removeVideoCodec(t.sdp,e))}),o.setRemoteDescription(t)}).then(()=>!0).catch(()=>!1).then(e=>(d(),e))}}).call(this,n(2))},function(e,t,n){"use strict";const r=n(7).INVALID_PARAMETER;e.exports=e=>{let t=e.otError;return e=>{if(!e)return;const n=(e,n)=>{if(!e)throw t(r,new Error("iceConfig invalid: "+n))};"includeServers"in e&&n(-1!==["all","custom"].indexOf(e.includeServers),".includeServers must be all or custom"),"transportPolicy"in e&&n(-1!==["all","relay"].indexOf(e.transportPolicy),".transportPolicy must be all or relay"),n(Array.isArray(e.customServers),".customServers must be an array"),e.customServers.forEach(e=>{n(e.urls||!("url"in e),"ice servers need .urls, not .url"),n("string"==typeof e.urls||Array.isArray(e.urls),"ice server .urls must be a string or an array"),n(!e.username||"string"==typeof e.username,"ice server .username must be a string if present"),n(!e.credential||"string"==typeof e.credential,"ice server .credential must be a string if present")})}}},function(e,t,n){"use strict";var r=n(1)(n(740));e.exports=(e,t)=>{const n=e||{},i=n.p2pEnabled,o=n.singlePeerConnection;if(i)return!1;let a=!!o;return"boolean"==typeof t&&(a=t),a&&(0,r.default)()}},function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;const r=n(3);t.default=()=>r.isChromium||r.isFirefox||r.isSafari},function(e,t,n){"use strict";e.exports=e=>{if("string"!=typeof e)throw new Error("secret must be a string");if(e.length<8)throw new Error("secret must have at least 8 characters");if(e.length>256)throw new Error("secret must not exceed 256 characters")}},function(e,t,n){"use strict";const r=n(10);e.exports=function(e){switch(e){case r.AUTHENTICATION_ERROR:case r.INVALID_SESSION_ID:case r.TERMS_OF_SERVICE_FAILURE:case r.UNEXPECTED_SERVER_RESPONSE:return e;case r.ANVIL_EMPTY_RESPONSE_BODY:case r.ANVIL_CONNECT_FAILED:return r.CONNECT_FAILED;case r.ANVIL_BADLY_FORMED_RESPONSE:case r.ANVIL_INVALID_HTTP_STATUS:case r.ANVIL_XDOMAIN_OR_PARSING_ERROR:case r.ANVIL_UNKNOWN_HTTP_ERROR:case r.ANVIL_UNEXPECTED_ERROR_CODE:default:return r.UNEXPECTED_SERVER_RESPONSE}}},function(e,t,n){"use strict";const r=n(10),i=n(7);e.exports={NOT_CONNECTED:{code:i.NOT_CONNECTED,message:"Cannot use forceMute functionality. You are not connected to the session.",exceptionCode:r.NOT_CONNECTED},PERMISSION_DENIED:{code:i.PERMISSION_DENIED,message:"This token does not allow forceMute usage. The role must be at least `moderator` to enable this functionality",exceptionCode:r.UNABLE_TO_FORCE_MUTE},INVALID_PARAMETER:{code:i.INVALID_PARAMETER,message:"Invalid Parameter. Check that you have passed valid parameter values into the method call.",exceptionCode:r.INVALID_PARAMETER},NOT_FOUND:{code:i.NOT_FOUND,message:"The stream does not exist."},UNEXPECTED_SERVER_RESPONSE:{code:i.UNEXPECTED_SERVER_RESPONSE,message:"An unexpected error occurred.",exceptionCode:r.UNEXPECTED_SERVER_RESPONSE}}},function(e,t,n){"use strict";(function(e){var r=n(1);t.__esModule=!0,t.default=function(t){void 0===t&&(t={});const r=t.convertRumorError||n(325),d=t.Dispatcher||n(330),l=t.ExceptionCodes||n(10),f=t.hasIceRestartsCapability||n(326),p=t.hasRenegotiationCapability||n(761),h=t.hasE2eeCapability||n(110),m=t.logging||n(0)("RaptorSocket"),g=t.Message||n(331),v=t.OTHelpers||n(8),y=t.RumorSocket||(0,u.default)(),b=t.Signal||n(332),S=t.SignalError||n(766),E=function t(n){var u=this;let f,p,h,E,_,T,R,I,w=n.connectionId,C=n.sessionId,O=n.messagingSocketUrl,A=n.symphonyUrl,x=n.dispatcher,k=n.analytics,N=n.requestedCapabilities,L=void 0===N?[]:N;const M=x||new d,V=v.statable(this,["disconnected","connecting","connected","error","disconnecting"],"disconnected"),P=function(e){e.action&&e.variation||m.debug("Expected action and variation"),k.logEvent((0,o.default)({sessionId:p,partnerId:f,p2p:T,messagingServer:R,connectionId:w},e))},D=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t[0];V(r?"error":"connected"),_(...t)},Z=e=>{let t="clientDisconnected";!this.is("disconnecting")&&I&&(t="networkDisconnected"),e&&4001===e.code&&(t="networkTimedout"),V("disconnected"),M.onClose(t)},j=e=>{I=!0,m.error(e)},W=()=>{M.onReconnecting()},G=()=>{P({action:"Reconnect",variation:"Success",retries:this._rumor.reconnectRetriesCount(),messageQueueSize:this._rumor.messageQueueSize(),socketId:this.socketId}),M.onReconnected()},F=()=>{P({action:"Reconnect",variation:"Attempt",retries:this._rumor.reconnectRetriesCount(),messageQueueSize:this._rumor.messageQueueSize(),socketId:this.socketId})},U=e=>{"connectionLimitExceeded"===e.message&&(e.code=l.CONNECTION_LIMIT_EXCEEDED),e.reason="ConnectToSession";const t=r(e);P({action:"Reconnect",variation:"Failure",failureReason:e.reason,failureCode:t.code,failureMessage:t.message,messageQueueSize:this._rumor.messageQueueSize(),socketId:this.socketId})};Object.defineProperty(this,"socketId",{get(){return this._rumor.socketID}}),this.connect=function(n,r,i,o){if(!this.is("disconnected","error"))return void m.warn("Cannot connect the Raptor Socket as it is currently connected. You should disconnect first.");V("connecting"),f=r.partnerId,p=r.sessionId,T=r.p2pEnabled,R=r.messagingServer,h=n,_=o,E={apiKey:f,sessionId:p};const a=`/v2/partner/${f}/session/${p}`;this._rumor=new t.RumorSocket({messagingURL:O,notifyDisconnectAddress:A,connectionId:w,sessionId:C,enableReconnection:r.reconnection}),this._rumor.on("close",Z),this._rumor.on("error",j),this._rumor.on("reconnecting",W),this._rumor.on("reconnectAttempt",F),this._rumor.on("reconnectFailure",U),this._rumor.on("reconnected",G),this._rumor.on("message",M.dispatch.bind(M));const c=e=>{D({reason:"WebSocketConnection",code:e.code,message:e.message})};this._rumor.once("error",c),this._rumor.once("open",()=>{this._rumor.removeListener("error",c),m.debug(`connected. Subscribing to ${a} on ${O}`),this._rumor.subscribe([a]);const n=L;(t.hasIceRestartsCapability()||t.hasRenegotiationCapability())&&r.renegotiation&&n.push("renegotiation"),t.hasE2eeCapability()&&r.e2ee&&n.push("e2ee");const o=g.connections.create({apiKey:f,sessionId:p,connectionId:this._rumor.id,connectionEventsSuppressed:i.connectionEventsSuppressed,capabilities:n}),u=new e(e=>{const t=n=>{n.id===this._rumor.id&&(e(n),x.off("connection#created",t))};x.on("connection#created",t)});this.publish(o,{"X-TB-TOKEN-AUTH":h},!0,(e,t)=>{if(e)return"connectionLimitExceeded"===e.message&&(e.code=l.CONNECTION_LIMIT_EXCEEDED),void D({reason:"ConnectToSession",code:e.code,message:e.message,socketId:this.socketId});const n=t&&t.data?JSON.parse(t.data):null;n&&(n.connection&&0!==n.connection.length||(n.connection=[],Array.isArray(n.stream)&&n.stream.forEach(e=>{let t=e.connection;return n.connection.push(t)})));const r=(e,t)=>{e?D({reason:"GetSessionState",code:e.code,message:e.message,socketId:this.socketId}):D(void 0,t)};u.then(e=>{n.connection.some(t=>t.id===e.id)||n.connection.unshift(e);const t=(0,s.default)();M.registerCallback(t,r),M.emit("session#read",n,t)})})})},this.disconnect=function(){this.is("disconnected")||(V("disconnecting"),this._rumor.disconnect())},this.publish=function(e,t,n,r){r=r||function(){};const i=(0,a.default)(r),c=(0,s.default)();if(m.debug(`Publish (ID:${c}) ${e}`),this._rumor.readyState!==y.OPEN||this._rumor.reconnecting&&!n){const e=new Error("Not connected.");return e.code=500,i(e),void m.error("cannot publish until the socket is connected.")}return M.registerCallback(c,i),this._rumor.publish([A],e,(0,o.default)({},t,{"Content-Type":"application/x-raptor+v2","TRANSACTION-ID":c,"X-TB-FROM-ADDRESS":this._rumor.id}),n,(function(e){e&&i(...arguments)})),c},this.send=function(e,t,n,r){void 0===n&&(n=!0),void 0===r&&(r=()=>{}),u.publish((0,c.default)(e),t,n,r)},this.streamCreate=function(e,t){void 0===e&&(e={}),void 0===t&&(t=()=>{});const n=e,r=n.name,i=n.streamId,o=n.subscriberAudioFallbackEnabled,a=n.channels,s=n.minBitrate,c=n.maxBitrate,u=n.sourceStreamId,d=n.e2ee,l=n.publisherAudioFallbackEnabled,h=n.customProperties,m={apiKey:f,sessionId:p,streamId:i,name:r,audioFallbackEnabled:o,subscriberAudioFallbackEnabled:o,channels:a,minBitrate:s,maxBitrate:c,sourceStreamId:u,e2ee:d,publisherAudioFallbackEnabled:l,customProperties:h},v=g.streams.create(m);this.publish(v,{},!0,(e,n)=>{t(e,i,n)})},this.streamDestroy=function(e,t){this.publish(g.streams.destroy(f,p,e,t),{},!0)},this.streamChannelUpdate=function(e,t,n){this.publish(g.streamChannels.update(f,p,e,t,n),{},!0)},this.subscriberCreate=function(e,t,n,r,i,o){const a={apiKey:f,sessionId:p,streamId:e,subscriberId:t,connectionId:this._rumor.id,channelsToSubscribeTo:n,sourceStreamId:r,e2ee:i};this.publish(g.subscribers.create(a),{},!0,o)},this.subscriberDestroy=function(e,t){this.publish(g.subscribers.destroy(f,p,e,t),{},!0)},this.subscriberUpdate=function(e,t,n){this.publish(g.subscribers.update(f,p,e,t,n),{},!0)},this.subscriberChannelUpdate=function(e,t,n,r){this.publish(g.subscriberChannels.update(f,p,e,t,n,r),{},!0)},this.forceDisconnect=function(e,t){this.publish(g.connections.destroy({apiKey:f,sessionId:p,connectionId:e}),{},!0,t)},this.forceUnpublish=function(e,t){this.publish(g.streams.destroy(f,p,e),{},!0,t)},this.forceMuteStream=function(e,t){const n={streamId:e,active:!0};this.publish(g.forceMute.update(Object.assign({},E,n)),{},!0,t)},this.forceMuteAll=function(e,t,n){const r={excludedStreamIds:e,active:t};this.publish(g.forceMute.update(Object.assign({},E,r)),{},!0,n)},this.signal=function(e,t,n){const r=new b(p,this._rumor.id,e||{});r.valid?this.publish(r.toRaptorMessage(),{},r.retryAfterReconnect,e=>{let o,a,s;const c=[400,403,404,413,500];if(e){const t=parseInt(e.code,10);c.includes(t)?(a=t,s=e.message):(a=l.UNEXPECTED_SERVER_RESPONSE,s="Unexpected server response. Try this operation again later."),o=new S(a,s)}else{const e=r.data?typeof r.data:null;n("signal","send",{type:e})}t&&(0,i.default)(t)&&t(o,r.toHash())}):t&&(0,i.default)(t)&&t(new S(r.error.code,r.error.reason),r.toHash())},this.id=function(){return this._rumor&&this._rumor.id}};return E.hasIceRestartsCapability=f,E.hasRenegotiationCapability=p,E.hasE2eeCapability=h,E.RumorSocket=y,E};var i=r(n(17)),o=r(n(9)),a=r(n(51)),s=r(n(16)),c=r(n(327)),u=r(n(745))}).call(this,n(2))},function(e,t,n){"use strict";var r=n(1);t.__esModule=!0,t.default=function(e){let t=(void 0===e?{}:e).WebSocket,n=void 0===t?u.default:t;const r=(0,o.default)(),l=(0,s.default)({AnalyticsHelper:d.default,EventEmitter:i.default,WebSocket:n,logging:a.default,allocateId:r});return(0,c.default)({EventEmitter:i.default,ReconnectableSocket:l,logging:a.default,allocateId:r})};var i=r(n(14)),o=r(n(746)),a=r(n(0)),s=r(n(747)),c=r(n(752)),u=r(n(757)),d=r(n(21))},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(){let e=0;return()=>(e+=1,e)}},function(e,t,n){"use strict";var r=n(1);t.__esModule=!0,t.default=void 0;var i=r(n(4)),o=r(n(5)),a=r(n(46)),s=r(n(328)),c=r(n(49)),u=r(n(329)),d=n(77),l=r(n(748)),f=r(n(62)),p=r(n(749)),h=r(n(751));const m=e=>function(){e(...arguments)},g=e=>1e3===e||e>=3e3&&e<=4999,v=d.codes.CLOSE_TIMEOUT;t.default=e=>{var t;let n=e.AnalyticsHelper,r=e.EventEmitter,d=e.WebSocket,y=e.logging,b=e.allocateId,S=e.BUFFER_DRAIN_INTERVAL,E=void 0===S?100:S,_=e.BUFFER_DRAIN_MAX_RETRIES,T=void 0===_?10:_;return(t=function(e){function t(r){var a;(a=e.call(this)||this)._url=void 0,a._id=b(),a._logger=y("ReconnectableSocket:"+a._id),a._webSocket=void 0,a._connectTimer=void 0,a._pingTimer=void 0,a._pingWarningTimer=void 0,a._disconnectTimer=void 0,a._queuedMessages=[],a._draining=!1,a._analytics=new n,a._logAnalyticsEvent=e=>{let t=e.action,n=e.variation,r=e.payload;a._analytics.logEvent({action:t,variation:n,payload:r,sessionId:a.sessionId,connectionId:a.connectionId})};const c=r.url,d=r.connectionId,f=r.sessionId,h=r.connectTimeout,g=void 0===h?15e3:h,v=r.pingThreshold,S=void 0===v?3e3:v,E=r.pingWarningDelay,_=void 0===E?100:E,T=r.disconnectThreshold,R=void 0===T?5900:T,I=r.reconnectMaxDuration,w=void 0===I?6e4:I;if(!c)throw new Error("Must provide url");a.connectionId=d,a.sessionId=f,a.readyStateMachine=(0,p.default)({reconnectMaxDuration:w,CLOSED:t.CLOSED,CLOSING:t.CLOSING}),a._url=c,(0,u.default)({logger:a._logger,obj:(0,s.default)(a),eventNames:["error","open","message","needsPing","reconnecting","reconnectAttempt","reconnectFailure","reconnected","close"]}),a.readyStateMachine.observe("onEnterOpen",e=>{let t=e.from;a._resetPingTimers(),a._resetDisconnectTimer(),a._connectTimer.clear(),"reconnecting"===t?(a._queuedMessages.forEach(e=>a.send(e,!0)),a._queuedMessages=[],a.emit("reconnected"),a._logAnalyticsEvent({action:"WebSocket:reconnect",variation:"Success"})):(a.emit("open"),a._logAnalyticsEvent({action:"WebSocket:open"}))}),a.readyStateMachine.observe("onEnterClosed",(e,t)=>{let n=e.from,r=e.code,i=e.reason;a.emit("close",t),"reconnecting"===n&&a._logAnalyticsEvent({action:"WebSocket:reconnect",variation:"Failure",payload:{code:r,reason:i}})}),a.readyStateMachine.observe("onEnterClosing",m(function(){var e=(0,o.default)(i.default.mark((function e(t,n){var r,o,s;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.from,o=n.code,s=n.reason,a._clearTimers(),e.next=5,a._clearSocket({drain:"open"===r,code:o,reason:s});case 5:"reconnecting"===r&&(a.emit("reconnectFailure",{code:o,reason:s}),a._logAnalyticsEvent({action:"WebSocket:reconnect",variation:"Failure"})),setTimeout(()=>{a.readyStateMachine.closed({code:o,reason:s})});case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())),a.readyStateMachine.observe("onEnterReconnecting",()=>{a.emit("reconnecting"),a._logAnalyticsEvent({action:"WebSocket:reconnect",variation:"Attempt"})}),a.readyStateMachine.observe("onDisconnect",m(function(){var e=(0,o.default)(i.default.mark((function e(t,n){var r,o,s,c;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.from,o=t.to,s=n.code,c=n.reason,"reconnecting"!==o){e.next=12;break}if(!a._draining){e.next=5;break}return e.abrupt("return");case 5:return a._clearTimers(),a.emit("reconnectAttempt"),e.next=9,a._clearSocket({drain:"open"===r,code:s,reason:c});case 9:a._createSocket(),e.next=13;break;case 12:a._logAnalyticsEvent({action:"WebSocket:disconnect",payload:{code:s,reason:c}});case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));const C=(e,t)=>new l.default({name:e,duration:t,logger:a._logger});return a._connectTimer=C("connect",g),a._pingTimer=C("ping",S),a._pingWarningTimer=C("pingWarning",_),a._disconnectTimer=C("disconnect",R),a._createSocket(),a}(0,c.default)(t,e);var r=t.prototype;return r._createSocket=function(){const e=new d(this.url);e.binaryType="arraybuffer";const n=(0,f.default)(e);n.on("open",()=>{this.readyStateMachine.open()}),n.on("close",e=>{let t=e.code,n=e.reason;this.readyStateMachine.disconnect({code:t,reason:n})}),n.on("error",e=>{this.emit("error",e)}),n.on("message",e=>{this.readyState!==t.CLOSING&&this._resetDisconnectTimer(),this.emit("message",e)}),this._webSocket=e,this._webSocketEvents=n,this._connectTimer.reset(()=>{const e={code:v,reason:"Timeout while opening connection"},t=new Error(e.reason);t.code=v,this.emit("error",t),this.readyStateMachine.disconnect(e)})},r._clearSocket=function(){var e=(0,o.default)(i.default.mark((function e(n){var r,o,a,s,c;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=(r=void 0===n?{}:n).drain,a=void 0!==o&&o,s=r.code,c=r.reason,this._draining=!0,this._webSocketEvents&&this._webSocketEvents.removeAll(),this._webSocket.readyState===t.CLOSED){e.next=9;break}if(!a){e.next=7;break}return e.next=7,(0,h.default)(this._webSocket,{BUFFER_DRAIN_INTERVAL:E,BUFFER_DRAIN_MAX_RETRIES:T});case 7:this._logAnalyticsEvent({action:"WebSocket:close",payload:{code:s,reason:c},variation:"Attempt"});try{!g(s)||void 0===s&&void 0===c?this._webSocket.close():this._webSocket.close(s,c),this._logAnalyticsEvent({action:"WebSocket:close",payload:{code:s,reason:c},variation:"Success"})}catch(e){y.error("Could not close websocket",e),this._logAnalyticsEvent({action:"WebSocket:close",payload:{err:e},variation:"Failure"})}case 9:this._draining=!1;case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),r.send=function(e,n){void 0===n&&(n=!0),this.readyState===t.OPEN&&this._resetPingTimers();const r=()=>{try{return this._webSocket.send(e),"sent"}catch(e){if(this._webSocket.readyState===d.OPEN)return this._logger.debug("webSocket.send threw exception even though it was open:",e),"dropped";throw e}};if("reconnecting"===this.readyStateMachine.state){if(this._webSocket.readyState===d.OPEN)try{r()}catch(e){}return n?(this._queuedMessages.push(e),"queued"):(this._logger.debug("Dropping message during reconnection since retryAfterReconnect is false:",e),"dropped")}return r()},r.close=function(e,n){if(this.readyState===t.CLOSING)throw new Error("Can not call close on a closing ReconnectableSocket");if(this.readyState===t.CLOSED)throw new Error("Can not call close on an already closed ReconnectableSocket");this.readyStateMachine.close({code:e,reason:n})},r._resetPingTimers=function(){this._pingWarningTimer.clear(),this._pingTimer.reset(()=>{this._pingWarningTimer.reset(()=>{this._logger.warn("Did not send message after needsPing event. Other side may disconnect.")}),this.emit("needsPing")})},r._resetDisconnectTimer=function(){this._disconnectTimer.reset(()=>this.readyStateMachine.disconnect({code:v,reason:"No activity"}))},r._clearTimers=function(){[this._disconnectTimer,this._connectTimer,this._pingTimer,this._pingWarningTimer].forEach(e=>e.clear())},(0,a.default)(t,[{key:"url",get:function(){return"function"==typeof this._url?this._url():this._url}},{key:"reconnecting",get:function(){return"reconnecting"===this.readyStateMachine.state}},{key:"binaryType",get:function(){return this._webSocket.binaryType}},{key:"bufferedAmount",get:function(){return this._webSocket.bufferedAmount}},{key:"protocol",get:function(){return this._webSocket.protocol}},{key:"extensions",get:function(){return this._webSocket.extensions}},{key:"readyState",get:function(){return{reconnecting:t.OPEN,open:t.OPEN,closing:t.CLOSING,closed:t.CLOSED,connecting:t.CONNECTING}[this.readyStateMachine.state]}}]),t}(r)).CONNECTING=d.CONNECTING,t.OPEN=d.OPEN,t.CLOSING=d.CLOSING,t.CLOSED=d.CLOSED,t}},function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;let r=function(){function e(e){let t=e.name,n=e.logger,r=e.duration;this.name=void 0,this.logger=void 0,this.duration=void 0,this.currId=void 0,this.name=t,this.logger=n,this.duration=r}var t=e.prototype;return t.reset=function(e){this.clear();const t=setTimeout(()=>{void 0!==this.currId&&(this.logger.spam(`${this.name} timer with id ${this.currId} expired, entering callback`),this.currId=void 0,e())},this.duration);this.currId=t,this.logger.spam(`Started ${this.name} timer with id ${this.currId}, expires in `+this.duration+"ms")},t.clear=function(){void 0!==this.currId&&(clearTimeout(this.currId),this.logger.spam(`Cleared ${this.name} timer with id ${this.currId}`),this.currId=void 0)},t.isRunning=function(){return void 0!==this.currId},e}();t.default=r},function(e,t,n){"use strict";var r=n(1);t.__esModule=!0,t.default=void 0;var i=r(n(315)),o=r(n(750)),a=n(77);const s=(0,r(n(0)).default)("ReconnectableSocketStateMachine"),c=a.codes.CLOSE_UNSUPPORTED,u=a.codes.CLOSE_UNEXPECTED_CONDITION;t.default=e=>{let t,n=e.reconnectMaxDuration,r=e.CLOSED,a=e.CLOSING;return new i.default({init:"connecting",methods:{onInvalidTransition(e,t,n){s.error("Invalid state transition",{transition:e,from:t,to:n})}},transitions:[{name:"open",from:["connecting","reconnecting"],to:"open"},{name:"close",from:["connecting","reconnecting","open"],to:"closing"},{name:"closed",from:"closing",to:"closed"},{name:"disconnect",from:["reconnecting","open","connecting"],to:function(e){let i=e.code;return"open"!==this.state&&t||(t=(0,o.default)(n)),n>0&&!t()&&-1===[c,u].indexOf(i)&&-1===[r,a].indexOf(this.readyState)?"reconnecting":"closing"}}]})}},function(e,t,n){"use strict";e.exports=e=>{let t=!1;return setTimeout(()=>{t=!0},e),()=>t}},function(e,t,n){"use strict";var r=n(1);t.__esModule=!0,t.default=void 0;var i=r(n(4)),o=r(n(5)),a=r(n(108)),s=function(){var e=(0,o.default)(i.default.mark((function e(t,n){var r,o,s,c,u,d;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=(r=void 0===n?{}:n).BUFFER_DRAIN_INTERVAL,s=void 0===o?100:o,c=r.BUFFER_DRAIN_MAX_RETRIES,u=void 0===c?10:c,d=0;case 2:if(!(d<u)){e.next=10;break}if(0!==t.bufferedAmount){e.next=5;break}return e.abrupt("break",10);case 5:return e.next=7,(0,a.default)(s);case 7:d+=1,e.next=2;break;case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();t.default=s},function(e,t,n){"use strict";var r=n(1);t.__esModule=!0,t.default=void 0;var i=r(n(46)),o=r(n(328)),a=r(n(49)),s=r(n(16)),c=r(n(329)),u=r(n(753)),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=p(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(n(172)),l=r(n(756)),f=n(77);function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(p=function(e){return e?n:t})(e)}t.default=e=>{var t;let n=e.EventEmitter,r=e.ReconnectableSocket,p=e.logging,h=e.allocateId;return(t=function(e){function t(t){var n;let i=t.messagingURL,a=t.notifyDisconnectAddress,d=t.connectionId,m=t.sessionId,g=t.enableReconnection,v=t.pingThreshold,y=void 0===v?2e3:v,b=t.disconnectThreshold,S=void 0===b?(g?3:25)*y-100:b,E=t.reconnectMaxDuration,_=void 0===E?g?6e4:0:E;(n=e.call(this)||this).url=void 0,n.id=void 0,n._opened=!1,n._socket=void 0,n._reconnectAttempts=0,n._socketID=(0,s.default)(),n._receivedTransactionIDs=[],n._notifyDisconnectAddress=void 0,n._enableReconnection=void 0,n._pendingMessages=[],n._logger=p("RumorSocket:"+h()),(0,c.default)({logger:n._logger,obj:(0,o.default)(n),eventNames:["open","message","error","reconnecting","reconnectAttempt","reconnectFailure","reconnected","close"]}),n.url=i,n.id=d,n._notifyDisconnectAddress=a,n._enableReconnection=g,n.on("error",e=>{n._logger.error(e.message)});try{n._socket=new r({url:()=>n._enableReconnection?[n.url,n.url.indexOf("?")>=0?"&":"?","socketId="+n._socketID,n._socket&&n._socket.reconnecting?"&reconnect=true":"","&attempt="+(0,s.default)()].join(""):n.url,pingThreshold:y,disconnectThreshold:S,reconnectMaxDuration:_,connectionId:d,sessionId:m})}catch(e){n._logger.error(e),n.emit("error",new l.default(f.codes.CLOSE_CONNECT_EXCEPTION))}const T=()=>{n._opened=!0,n._socket.send(u.default.Connect(n.id,a).serialize()),n.emit("open",n.id)};return n._socket.once("open",T),n._socket.on("message",e=>n._receiveMessage(e)),n._socket.once("close",e=>{n._logger.debug(`ReconnectableSocket closed (code: ${e.code})`),n._clearPendingMessages(),-1===[f.codes.CLOSE_NORMAL,f.codes.CLOSE_GOING_AWAY,f.codes.CLOSE_TIMEOUT].indexOf(e.code)&&n.emit("error",new l.default(e.code)),n.emit("close",e)}),n._socket.on("error",e=>{let t=e.code;return n.emit("error",new l.default(t))}),n._socket.on("needsPing",()=>{n._socket.send(u.default.Ping().serialize())}),n._socket.on("reconnecting",()=>{n._opened&&(n._clearPendingMessagesWhichShouldntRetry(),n.emit("reconnecting"),n._reconnectAttempts=0)}),n._socket.on("reconnectAttempt",()=>{n._opened&&(n._reconnectAttempts+=1,n._socket.send(u.default.Disconnect("1").serialize(),!1),n.emit("reconnectAttempt"))}),n._socket.on("reconnected",()=>{n._opened?(n._pendingMessages.forEach(e=>{n._socket.send(e.rumorMessage.serialize())}),n.emit("reconnected")):T()}),n._socket.on("reconnectFailure",()=>{n._opened&&(n._logger.debug("Reconnecting failed as connectivity was not restored within "+_+"ms"),n.emit("reconnectFailure",new l.default))}),n}(0,a.default)(t,e);var n=t.prototype;return n._clearPendingMessagesWhichShouldntRetry=function(){const e=this._pendingMessages.filter(e=>!e.retryAfterReconnect);this._pendingMessages=this._pendingMessages.filter(e=>e.retryAfterReconnect),e.forEach(e=>{const t=new Error("Not connected.");t.code=500,e.completion(t)})},n._clearPendingMessages=function(){this._pendingMessages.forEach(e=>{const t=new Error("Not connected.");t.code=500,e.completion(t)}),this._pendingMessages=[]},n._sendAck=function(e){this._socket.send(u.default.Status([e.fromAddress],{"TRANSACTION-ID":e.headers["TRANSACTION-ID"],"X-TB-FROM-ADDRESS":this.id}).serialize())},n._receiveMessage=function(e){const t=u.default.deserialize(e.data);if(t.type!==d.PONG){if(this._logger.debug("Received:",t),t.transactionId&&(this._pendingMessages=this._pendingMessages.filter(e=>(e.rumorMessage.transactionId===t.transactionId&&(this._logger.debug("Marking",t.transactionId," as received"),e.completion(void 0,t)),e.rumorMessage.transactionId!==t.transactionId))),t.transactionId&&t.type!==d.STATUS){if(this._sendAck(t),this._receivedTransactionIDs.indexOf(t.transactionId)>=0)return;this._receivedTransactionIDs.push(t.transactionId)}this.emit("message",t)}},n.publish=function(e,t,n,r,i){void 0===i&&(i=()=>{});const o=u.default.Publish(e,t,n);if("dropped"===this._socket.send(o.serialize(),!1)&&!r){const e=new Error("Not connected.");return e.code=500,void i(e)}this._pendingMessages.push({rumorMessage:o,retryAfterReconnect:r,completion:i})},n.subscribe=function(e){this._socket.send(u.default.Subscribe(e).serialize())},n.unsubscribe=function(e){this._socket.send(u.default.Unsubscribe(e).serialize())},n.disconnect=function(){if(this.readyState===t.OPEN&&this._socket.send(u.default.Disconnect().serialize()),this._socket.readyState!==r.CLOSED&&this._socket.readyState!==r.CLOSING){const e=f.codes.CLOSE_NORMAL;this._socket.close(e,f.messages[e])}},n.status=function(e,t){this._socket.send(u.default.Status(e,{"TRANSACTION-ID":t,"X-TB-FROM-ADDRESS":this.id}).serialize())},n.reconnectRetriesCount=function(){return this._reconnectAttempts},n.messageQueueSize=function(){return this._pendingMessages.length},(0,i.default)(t,[{key:"readyState",get:function(){return this._socket?this._socket.readyState:r.CONNECTING}},{key:"reconnecting",get:function(){return this._opened&&this._socket&&this._socket.reconnecting}},{key:"socketID",get:function(){return this._socketID}}]),t}(n)).CONNECTING=r.CONNECTING,t.OPEN=r.OPEN,t.CLOSING=r.CLOSING,t.CLOSED=r.CLOSED,t}},function(e,t,n){"use strict";var r=n(1);t.__esModule=!0,t.default=void 0;var i=r(n(16)),o=n(754),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(n(172));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}let c=function(){function e(e,t,n,r){this.type=void 0,this.toAddress=void 0,this.headers=void 0,this.data=void 0,this.type=e,this.toAddress=t,this.headers=n,this.data=r,this.fromAddress=this.headers["X-TB-FROM-ADDRESS"],this.transactionId=this.headers["TRANSACTION-ID"],this.status=this.headers.STATUS,this.isError=this.status&&"2"!==this.status[0]}return e.prototype.serialize=function(){let e,t,n,r,i=8,a=7;const s=[],c=[],u=[];for(a++,n=0;n<this.toAddress.length;n++)s.push(new o.TextEncoder("utf-8").encode(this.toAddress[n])),a+=2,a+=s[n].length;a++,n=0;for(const e in this.headers)this.headers.hasOwnProperty(e)&&(c.push(new o.TextEncoder("utf-8").encode(e)),u.push(new o.TextEncoder("utf-8").encode(this.headers[e])),a+=4,a+=c[n].length,a+=u[n].length,n++);t=new o.TextEncoder("utf-8").encode(this.data),a+=t.length;const d=new ArrayBuffer(a),l=new Uint8Array(d,0,a);for(a-=4,l[0]=(4278190080&a)>>>24,l[1]=(16711680&a)>>>16,l[2]=(65280&a)>>>8,l[3]=(255&a)>>>0,l[4]=0,l[5]=0,l[6]=this.type,l[7]=this.toAddress.length,n=0;n<s.length;n++)for(e=s[n],l[i++]=e.length>>8&255,l[i++]=e.length>>0&255,r=0;r<e.length;r++)l[i++]=e[r];for(l[i++]=c.length,n=0;n<c.length;n++){for(e=c[n],l[i++]=e.length>>8&255,l[i++]=e.length>>0&255,r=0;r<e.length;r++)l[i++]=e[r];for(e=u[n],l[i++]=e.length>>8&255,l[i++]=e.length>>0&255,r=0;r<e.length;r++)l[i++]=e[r]}for(n=0;n<t.length;n++)l[i++]=t[n];return d},e.deserialize=function(t){let n,r,i,a,s,c,u,d;(void 0!==typeof window?window:global).Buffer&&(void 0!==typeof window?window:global).Buffer.isBuffer(t)&&(t=(e=>{const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let t=0;t<e.length;++t)n[t]=e[t];return t})(t));let l=8;const f=new Uint8Array(t);n=f[6];const p=[];for(d=0;d<f[7];d++)u=f[l++]<<8,u+=f[l++],r=new Uint8Array(t,l,u),p[d]=new o.TextDecoder("utf-8").decode(r),l+=u;for(i=f[l++],a={},d=0;d<i;d++)u=f[l++]<<8,u+=f[l++],r=new Uint8Array(t,l,u),s=new o.TextDecoder("utf-8").decode(r),l+=u,u=f[l++]<<8,u+=f[l++],r=new Uint8Array(t,l,u),c=new o.TextDecoder("utf-8").decode(r),a[s]=c,l+=u;const h=new Uint8Array(t,l);return new e(n,p,a,new o.TextDecoder("utf-8").decode(h))},e.Connect=function(t,n){const r={uniqueId:t,"TRANSACTION-ID":(0,i.default)(),notifyDisconnectAddress:n};return new e(a.CONNECT,[],r,"")},e.Disconnect=function(t){return new e(a.DISCONNECT,[],{reconnect:t},"")},e.Subscribe=function(t){return new e(a.SUBSCRIBE,t,{},"")},e.Unsubscribe=function(t){return new e(a.UNSUBSCRIBE,t,{},"")},e.Publish=function(t,n,r){return new e(a.MESSAGE,t,r||{},n||"")},e.Status=function(t,n){return new e(a.STATUS,t,n||{},"")},e.Ping=function(){return new e(a.PING,[],{},"")},e}();t.default=c},function(e,t,n){"use strict";t.__esModule=!0,t.TextEncoder=t.TextDecoder=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}(n(755));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}const o=(void 0!==typeof window?window:global).TextEncoder||r.TextEncoder;t.TextEncoder=o;const a=(void 0!==typeof window?window:global).TextDecoder||r.TextDecoder;t.TextDecoder=a},function(e,t,n){"use strict";function r(e,t,n){return t<=e&&e<=n}function i(e){if(void 0===e)return{};if(e===Object(e))return e;throw TypeError("Could not convert argument to dictionary")}function o(e){this.tokens=[].slice.call(e)}function a(e,t){if(e)throw TypeError("Decoder error");return t||65533}function s(e,t){if(!(this instanceof s))return new s(e,t);if("utf-8"!==(e=void 0!==e?String(e).toLowerCase():"utf-8"))throw new Error("Encoding not supported. Only utf-8 is supported");t=i(t),this._streaming=!1,this._BOMseen=!1,this._decoder=null,this._fatal=Boolean(t.fatal),this._ignoreBOM=Boolean(t.ignoreBOM),Object.defineProperty(this,"encoding",{value:"utf-8"}),Object.defineProperty(this,"fatal",{value:this._fatal}),Object.defineProperty(this,"ignoreBOM",{value:this._ignoreBOM})}function c(e,t){if(!(this instanceof c))return new c(e,t);if("utf-8"!==(e=void 0!==e?String(e).toLowerCase():"utf-8"))throw new Error("Encoding not supported. Only utf-8 is supported");t=i(t),this._streaming=!1,this._encoder=null,this._options={fatal:Boolean(t.fatal)},Object.defineProperty(this,"encoding",{value:"utf-8"})}function u(e){var t=e.fatal,n=0,i=0,o=0,s=128,c=191;this.handler=function(e,u){if(-1===u&&0!==o)return o=0,a(t);if(-1===u)return-1;if(0===o){if(r(u,0,127))return u;if(r(u,194,223))o=1,n=u-192;else if(r(u,224,239))224===u&&(s=160),237===u&&(c=159),o=2,n=u-224;else{if(!r(u,240,244))return a(t);240===u&&(s=144),244===u&&(c=143),o=3,n=u-240}return n<<=6*o,null}if(!r(u,s,c))return n=o=i=0,s=128,c=191,e.prepend(u),a(t);if(s=128,c=191,n+=u-128<<6*(o-(i+=1)),i!==o)return null;var d=n;return n=o=i=0,d}}function d(e){e.fatal,this.handler=function(e,t){if(-1===t)return-1;if(r(t,0,127))return t;var n,i;r(t,128,2047)?(n=1,i=192):r(t,2048,65535)?(n=2,i=224):r(t,65536,1114111)&&(n=3,i=240);for(var o=[(t>>6*n)+i];n>0;){var a=t>>6*(n-1);o.push(128|63&a),n-=1}return o}}n.r(t),n.d(t,"TextEncoder",(function(){return c})),n.d(t,"TextDecoder",(function(){return s})),o.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.shift():-1},prepend:function(e){if(Array.isArray(e))for(var t=e;t.length;)this.tokens.unshift(t.pop());else this.tokens.unshift(e)},push:function(e){if(Array.isArray(e))for(var t=e;t.length;)this.tokens.push(t.shift());else this.tokens.push(e)}},s.prototype={decode:function(e,t){var n;n="object"==typeof e&&e instanceof ArrayBuffer?new Uint8Array(e):"object"==typeof e&&"buffer"in e&&e.buffer instanceof ArrayBuffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(0),t=i(t),this._streaming||(this._decoder=new u({fatal:this._fatal}),this._BOMseen=!1),this._streaming=Boolean(t.stream);for(var r,a=new o(n),s=[];!a.endOfStream()&&-1!==(r=this._decoder.handler(a,a.read()));)null!==r&&(Array.isArray(r)?s.push.apply(s,r):s.push(r));if(!this._streaming){do{if(-1===(r=this._decoder.handler(a,a.read())))break;null!==r&&(Array.isArray(r)?s.push.apply(s,r):s.push(r))}while(!a.endOfStream());this._decoder=null}return s.length&&(-1===["utf-8"].indexOf(this.encoding)||this._ignoreBOM||this._BOMseen||(65279===s[0]?(this._BOMseen=!0,s.shift()):this._BOMseen=!0)),function(e){for(var t="",n=0;n<e.length;++n){var r=e[n];r<=65535?t+=String.fromCharCode(r):(r-=65536,t+=String.fromCharCode(55296+(r>>10),56320+(1023&r)))}return t}(s)}},c.prototype={encode:function(e,t){e=e?String(e):"",t=i(t),this._streaming||(this._encoder=new d(this._options)),this._streaming=Boolean(t.stream);for(var n,r=[],a=new o(function(e){for(var t=String(e),n=t.length,r=0,i=[];r<n;){var o=t.charCodeAt(r);if(o<55296||o>57343)i.push(o);else if(56320<=o&&o<=57343)i.push(65533);else if(55296<=o&&o<=56319)if(r===n-1)i.push(65533);else{var a=e.charCodeAt(r+1);if(56320<=a&&a<=57343){var s=1023&o,c=1023&a;i.push(65536+(s<<10)+c),r+=1}else i.push(65533)}r+=1}return i}(e));!a.endOfStream()&&-1!==(n=this._encoder.handler(a,a.read()));)Array.isArray(n)?r.push.apply(r,n):r.push(n);if(!this._streaming){for(;-1!==(n=this._encoder.handler(a,a.read()));)Array.isArray(n)?r.push.apply(r,n):r.push(n);this._encoder=null}return new Uint8Array(r)}}},function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}(n(77));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}const o=n(7);t.default=function(e){if(this.code=void 0,this.message=void 0,this.name=void 0,this.code=r.codes.CLOSE_FALLBACK_CODE,Object.values(r.codes).includes(e))switch(this.code=e,this.code){case r.codes.CLOSE_GOING_AWAY:case r.codes.CLOSE_PROTOCOL_ERROR:case r.codes.CLOSE_UNSUPPORTED:case r.codes.CLOSE_NO_STATUS:case r.codes.CLOSE_ABNORMAL:case r.codes.CLOSE_INCONSISTENT_DATA:case r.codes.CLOSE_POLICY_VIOLATION:case r.codes.CLOSE_TOO_LARGE:case r.codes.CLOSE_UNEXPECTED_CONDITION:case r.codes.CLOSE_CONNECTIVITY_LOSS:case r.codes.CLOSE_CONNECT_EXCEPTION:case r.codes.CLOSE_TIMEOUT:return this.name=o.DISCONNECTED,void(this.message="Action failed due to session disconnection.")}this.message=r.messages[this.code]||"No message available from code."}},function(e,t,n){"use strict";var r=n(1);t.__esModule=!0,t.default=void 0;var i=r(n(758)),o=(void 0!==typeof window?window:global).WebSocket?(void 0!==typeof window?window:global).WebSocket:i.default;t.default=o},function(e,t,n){"use strict";e.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},function(e,t,n){"use strict";const r=n(760);e.exports=function(e){const t=r(e.data);return t.transactionId=e.transactionId,t.fromAddress=e.headers["X-TB-FROM-ADDRESS"],t}},function(e,t,n){"use strict";e.exports=function(e){if(0===e.length)return{};const t=JSON.parse(e),n=t.uri.substr(1).split("/");n.shift(),""===n[n.length-1]&&n.pop(),t.params={};for(let e=0,r=n.length;e<r-1;e+=2)t.params[n[e]]=n[e+1];return n.length%2==0?"channel"===n[n.length-2]&&n.length>6?t.resource=`${n[n.length-4]}_${n[n.length-2]}`:t.resource=n[n.length-2]:"channel"===n[n.length-1]&&n.length>5?t.resource=`${n[n.length-3]}_${n[n.length-1]}`:t.resource=n[n.length-1],t.signature=`${t.resource}#${t.method}`,t}},function(e,t,n){"use strict";const r=n(3).name,i=n(52).once;e.exports=()=>i()&&["Chrome","Firefox","Safari"].indexOf(r)>-1},function(e,t,n){"use strict";const r=n(3),i=n(52).once;e.exports=()=>i()&&("Chrome"===r.name||"Firefox"===r.name||"Node"===r.name||"Safari"===r.name||"Edge"===r.name)},function(e,t,n){"use strict";const r=n(52).once;e.exports=()=>r()},function(e,t,n){"use strict";e.exports="DTLS_SRTP"},function(e,t,n){"use strict";e.exports=function(e){let t=e.supportsWebRTC;return{supportsWebRTC:"true"===t||!0===t}}},function(e,t,n){"use strict";e.exports=function(e,t){this.code=e,this.message=t,this.reason=t}},function(e,t,n){"use strict";e.exports=function(e){const t=[];this.enqueue=function(){t.push(Array.prototype.slice.call(arguments))},this.triggerAll=function(){let n;for(;n=t.shift();)e.trigger(...n)}}},function(e,t,n){"use strict";const r=n(207),i=n(240),o=n(58),a=n(9),s=n(142),c=n(10),u=n(769),d=n(770),l=n(292).default,f={EMPTY_RESPONSE:"Response body was empty, probably due to connectivity loss",BADLY_FORMED:"Unknown error: JSON response was badly formed",NO_ERROR:"No error message",UNEXPECTED_SERVER_RESPONSE:e=>`Unexpected server response (${e}). Try this operation again later.`},p=[0,600,1200];e.exports=function(e){let t=void 0===e?{}:e,n=t.axios,h=void 0===n?r:n,m=t.retryDelays,g=void 0===m?p:m;return l((function(e){let t=e.anvilUrl,n=e.sessionId,r=e.token,l=e.clientVersion,p=e.connectionId;const m=i.parse(t,!0),g=i.format({protocol:m.protocol,auth:m.auth,host:m.host,pathname:i.resolve((m.pathname||"").replace(/\/?$/,"/"),"session/"+n),query:Object.assign({},m.query,{extended:!0})});return h.get(g,{validateStatus:e=>e>=200&&e<300,headers:{"X-OPENTOK-AUTH":r,"X-TB-VERSION":1,"X-TB-CLIENT-VERSION":l,"X-TB-CONNECTIONID":p,Accept:"application/json"}}).catch(e=>{if(e.response){const t=new Error(f.UNEXPECTED_SERVER_RESPONSE(`${e.response.statusCode}${e.response.status?" "+e.response.status:""}`));throw t.code=c.ANVIL_INVALID_HTTP_STATUS,t.name=u(t.code),t}if(e.request){const e=new Error(f.CONNECT_FAILED);throw e.code=c.ANVIL_CONNECT_FAILED,e.name=u(e.code),e}{const t=c.ANVIL_UNKNOWN_HTTP_ERROR,n=u(e.code);throw a(e,{code:t,name:n}),e}}).then(e=>{let t=e.data;if("string"==typeof t){if(t.length>0)try{JSON.parse(t)}catch(e){throw e.message=f.UNEXPECTED_SERVER_RESPONSE(e.toString()),e.code=c.ANVIL_XDOMAIN_OR_PARSING_ERROR,e.name=u(e.code),e}const e=new Error(0===t.length?f.EMPTY_RESPONSE:f.BADLY_FORMED);throw e.code=0===t.length?c.ANVIL_EMPTY_RESPONSE_BODY:c.ANVIL_BADLY_FORMED_RESPONSE,e.name=u(e.code),e}if(null===t||0===t.length){const e=new Error(f.EMPTY_RESPONSE);throw e.code=c.ANVIL_EMPTY_RESPONSE_BODY,e.name=u(e.code),e}const n=t.filter(e=>null!=e.error)[0];if(n){const e=d(o(n,"error.code","500"));"Invalid token format"===o(n,"error.errorMessage.message")&&(n.error.errorMessage.message+=" Token: "+r);const t=new Error(o(n,"error.errorMessage.message",void 0===e?"Unknown error: "+n.error.code:f.NO_ERROR));throw t.code=e||c.ANVIL_UNEXPECTED_ERROR_CODE,t.name=u(t.code),t}return new s(t[0])})}),(e,t)=>e.code&&e.code>=3e3&&e.code<=3007&&g[t])}},function(e,t,n){"use strict";const r=n(10),i=n(7),o={[r.ANVIL_BADLY_FORMED_RESPONSE]:i.BADLY_FORMED_RESPONSE,[r.ANVIL_INVALID_HTTP_STATUS]:i.INVALID_HTTP_STATUS,[r.ANVIL_XDOMAIN_OR_PARSING_ERROR]:i.XDOMAIN_OR_PARSING_ERROR,[r.ANVIL_UNKNOWN_HTTP_ERROR]:i.UNKNOWN_HTTP_ERROR,[r.ANVIL_UNEXPECTED_ERROR_CODE]:i.UNEXPECTED_ERROR_CODE,[r.ANVIL_EMPTY_RESPONSE_BODY]:i.EMPTY_RESPONSE_BODY,[r.ANVIL_CONNECT_FAILED]:i.CONNECT_FAILED,[r.AUTHENTICATION_ERROR]:i.AUTHENTICATION_ERROR,[r.INVALID_SESSION_ID]:i.INVALID_SESSION_ID,[r.TERMS_OF_SERVICE_FAILURE]:i.TERMS_OF_SERVICE_FAILURE,[r.UNEXPECTED_SERVER_RESPONSE]:i.UNEXPECTED_SERVER_RESPONSE};e.exports=function(e){return o[e]}},function(e,t,n){"use strict";const r=n(10),i={400:r.INVALID_SESSION_ID,403:r.AUTHENTICATION_ERROR,404:r.INVALID_SESSION_ID,409:r.TERMS_OF_SERVICE_FAILURE,500:r.UNEXPECTED_SERVER_RESPONSE};e.exports=function(e){return i[e]}},function(e,t,n){"use strict";var r=n(1),i=r(n(4)),o=r(n(5)),a=r(n(49));const s=n(14),c=n(772);let u=function(e){function t(t){var n;return void 0===t&&(t={}),(n=e.call(this)||this)._generateKey=t.generateKey||c,n}(0,a.default)(t,e);var n=t.prototype;return n.set=function(){var e=(0,o.default)(i.default.mark((function e(t,n){var r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.keyPromise=this._generateKey(t,n),e.next=3,this.keyPromise;case 3:r=e.sent,this.emit("keyChanged",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.get=function(){var e=(0,o.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.keyPromise;case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.clear=function(){this.keyPromise=void 0},t}(s);e.exports=u},function(e,t,n){"use strict";var r=n(1),i=r(n(4)),o=r(n(5));const a=function(){var e=(0,o.default)(i.default.mark((function e(t,n){var r,o,a;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!0,o=new TextEncoder,e.next=5,window.crypto.subtle.importKey("raw",o.encode(n),{name:"PBKDF2"},!1,["deriveBits","deriveKey"]);case 5:return a=e.sent,e.abrupt("return",window.crypto.subtle.deriveKey({name:"PBKDF2",salt:o.encode(t),iterations:1e5,hash:"SHA-256"},a,{name:"AES-CTR",length:256},r,["encrypt","decrypt"]));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();e.exports=a},function(e,t,n){"use strict";var r=n(1),i=r(n(4)),o=r(n(5));let a={SFrame:{}};n(3).isNode||(a=n(774));const s=a.SFrame,c=e=>s.createClient(e,{skipVp8PayloadHeader:!0});let u=function(){function e(){this._clientStore={}}var t=e.prototype;return t.createSender=function(){var e=(0,o.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=0),!this.getSender(t)){e.next=3;break}return e.abrupt("return",this.getSender(t));case 3:return this._clientStore[t]||(this._clientStore[t]={}),e.next=6,c(t);case 6:return this._clientStore[t].sender=e.sent,e.abrupt("return",this.getSender(t));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.createReceiver=function(){var e=(0,o.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.getReceiver(t)){e.next=2;break}return e.abrupt("return",this.getReceiver(t));case 2:return this._clientStore[t]||(this._clientStore[t]={}),e.next=5,c(t);case 5:return this._clientStore[t].receiver=e.sent,e.abrupt("return",this.getReceiver(t));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getSender=function(e){var t;return null==(t=this._clientStore[e])?void 0:t.sender},t.getReceiver=function(e){var t;return null==(t=this._clientStore[e])?void 0:t.receiver},t.deleteReceiver=function(e){this.getReceiver(e)&&(this._clientStore[e].receiver.deleteReceiver(e),delete this._clientStore[e].receiver)},t.deleteSender=function(e){var t;null==(t=this._clientStore[e])||delete t.sender},e}();e.exports=u},function(e,t,n){(function(t){var n;n=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./index.js")}({"./Client.js":
/*!*******************!*\
  !*** ./Client.js ***!
  \*******************/
/*! exports provided: SFrame */function(e,n,r){"use strict";r.r(n),r.d(n,"SFrame",(function(){return o}));var i=r(/*! ./Worker.js */"./Worker.js");const o={createClient:async function(e,t){const n=new s;return await n.init(e,t),n}};async function a(e){return e instanceof CryptoKey&&"private"==e.type?await crypto.subtle.exportKey("pkcs8",e):e instanceof CryptoKey?await crypto.subtle.exportKey("raw",e):e instanceof Uint8Array?e.buffer.slice(0):e.slice(0)}class s extends EventTarget{constructor(){super(),this.worker=new i.default,this.transId=1,this.transactions=new Map,this.worker.addEventListener("message",async e=>{const t=e.data;if(t.transId){const e=this.transactions.get(t.transId);this.transactions.delete(t.transId),t.error?e.reject(new Error(t.error)):e.resolve(t.result)}else if(t.event){const e=new Event(t.event.name);e.id=t.event.data.id,e.senderId=t.event.data.senderId,this.dispatchEvent(e)}}),this.postMessage=(e,n,r)=>new t((t,i)=>{const o=this.transId++;this.worker.postMessage({transId:o,cmd:e,args:n},r),this.transactions.set(o,{resolve:t,reject:i})})}async init(e,t){return this.postMessage("init",{senderId:e,config:t})}async setSenderEncryptionKey(e){const t=await a(e);return this.postMessage("setSenderEncryptionKey",[t],[t])}async ratchetSenderEncryptionKey(){return this.postMessage("ratchetSenderEncryptionKey")}async setSenderSigningKey(e){const t=await a(e);return this.postMessage("setSenderSigningKey",[t])}async addReceiver(e){return this.postMessage("addReceiver",[e])}async setReceiverEncryptionKey(e,t){const n=await a(t);return this.postMessage("setReceiverEncryptionKey",[e,n],[n])}async setReceiverVerifyKey(e,t){const n=await a(t);return this.postMessage("setReceiverVerifyKey",[e,n],[n])}deleteReceiver(e){return this.postMessage("deleteReceiver",[e])}async encrypt(e,t){const n=t.track.kind,{readable:r,writable:i}=t.createEncodedStreams?t.createEncodedStreams():t.createEncodedVideoStreams?t.createEncodedVideoStreams():t.createEncodedAudioStreams();return this.postMessage("encrypt",{id:e,kind:n,readableStream:r,writableStream:i},[r,i])}async decrypt(e,t){const n=t.track.kind,{readable:r,writable:i}=t.createEncodedStreams?t.createEncodedStreams():t.createEncodedVideoStreams?t.createEncodedVideoStreams():t.createEncodedAudioStreams();return this.postMessage("decrypt",{id:e,kind:n,readableStream:r,writableStream:i},[r,i])}close(){this.worker.terminate();for(let e of this.transactions.values())e.reject(new Error("Client closed"));this.transactions.clear()}}},"./Worker.js":
/*!*******************!*\
  !*** ./Worker.js ***!
  \*******************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var r=n(/*! !./node_modules/worker-loader/dist/runtime/inline.js */"./node_modules/worker-loader/dist/runtime/inline.js"),i=n.n(r);function o(){return i()('/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = function(exports) {\n/******/ \t\tif(typeof Symbol !== \'undefined\' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: \'Module\' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, \'__esModule\', { value: true });\n/******/ \t};\n/******/\n/******/ \t// create a fake namespace object\n/******/ \t// mode & 1: value is a module id, require it\n/******/ \t// mode & 2: merge all properties of value into the ns\n/******/ \t// mode & 4: return value when already ns object\n/******/ \t// mode & 8|1: behave like require\n/******/ \t__webpack_require__.t = function(value, mode) {\n/******/ \t\tif(mode & 1) value = __webpack_require__(value);\n/******/ \t\tif(mode & 8) return value;\n/******/ \t\tif((mode & 4) && typeof value === \'object\' && value && value.__esModule) return value;\n/******/ \t\tvar ns = Object.create(null);\n/******/ \t\t__webpack_require__.r(ns);\n/******/ \t\tObject.defineProperty(ns, \'default\', { enumerable: true, value: value });\n/******/ \t\tif(mode & 2 && typeof value != \'string\') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n/******/ \t\treturn ns;\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module[\'default\']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, \'a\', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = "";\n/******/\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = "./Worker.js");\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ "./Worker.js":\n/*!*******************!*\\\n  !*** ./Worker.js ***!\n  \\*******************/\n/*! no exports provided */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n"use strict";\n__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var lodash_debounce__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lodash/debounce */ "./node_modules/lodash/debounce.js");\n/* harmony import */ var lodash_debounce__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(lodash_debounce__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_Context_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./lib/Context.js */ "./lib/Context.js");\n/* harmony import */ var _lib_VP8PayloadHeader_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./lib/VP8PayloadHeader.js */ "./lib/VP8PayloadHeader.js");\n/* harmony import */ var _lib_Utils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./lib/Utils.js */ "./lib/Utils.js");\n/* harmony import */ var _lib_TaskQueue_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./lib/TaskQueue.js */ "./lib/TaskQueue.js");\n\n\n\n\n\n\nconst postDecryptStatusMessage = lodash_debounce__WEBPACK_IMPORTED_MODULE_0___default()((message) => {\n\tpostMessage(message)\n},  1000, { leading: false, trailing: true });\n\nlet context; \n\nonmessage = async (event) => {\n\t//Get data\n\tconst {transId,cmd,args} = event.data;\n\t\n\ttry {\n\t\tlet result = true;\n\t\t\n\t\t//Depending on the cmd\n\t\tswitch(event.data.cmd)\n\t\t{\n\t\t\tcase "init":\n\t\t\t{\n\t\t\t\t//Get info\n\t\t\t\tconst {senderId, config} = args;\n\t\t\t\t//Crate context\n\t\t\t\tcontext = new _lib_Context_js__WEBPACK_IMPORTED_MODULE_1__["Context"](senderId, config);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase "encrypt":\n\t\t\t{\n\t\t\t\t//The recrypt queue\n\t\t\t\tconst tasks = new _lib_TaskQueue_js__WEBPACK_IMPORTED_MODULE_4__["TaskQueue"]();\n\t\t\t\t//Get event data\n\t\t\t\tconst{id, kind, readableStream, writableStream} = args;\n\t\t\t\t//Create transform stream foo encrypting\n\t\t\t\tconst transformStream = new TransformStream({\n\t\t\t\t\ttransform: async (chunk, controller)=>{\n\t\t\t\t\t\t//Nothing in clear\n\t\t\t\t\t\tlet skip = 0;\n\t\t\t\t\t\t//Check if it is video and we are skipping vp8 payload header\n\t\t\t\t\t\tif (kind=="video" && context.isSkippingVp8PayloadHeader())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t//Get VP8 header\n\t\t\t\t\t\t\tconst vp8 = _lib_VP8PayloadHeader_js__WEBPACK_IMPORTED_MODULE_2__["VP8PayloadHeader"].parse(chunk.data);\n\t\t\t\t\t\t\t//Skip it\n\t\t\t\t\t\t\tskip = vp8.byteLength;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//Enqueue task\n\t\t\t\t\t\ttasks.enqueue (\n\t\t\t\t\t\t\tcontext.encrypt(kind, id, chunk.data, skip),\n\t\t\t\t\t\t\t(encrypted) => {\n\t\t\t\t\t\t\t\t//Set back encrypted payload\n\t\t\t\t\t\t\t\tchunk.data = encrypted.buffer;\n\t\t\t\t\t\t\t\t//write back\n\t\t\t\t\t\t\t\tcontroller.enqueue(chunk);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t(error)=>{\n\t\t\t\t\t\t\t\t//TODO: handle errors\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t//Encrypt\n\t\t\t\treadableStream\n\t\t\t\t\t.pipeThrough(transformStream)\n\t\t\t\t\t.pipeTo(writableStream);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase "decrypt":\n\t\t\t{\n\t\t\t\t//The recrypt queue\n\t\t\t\tconst tasks = new _lib_TaskQueue_js__WEBPACK_IMPORTED_MODULE_4__["TaskQueue"]();\n\t\t\t\t//Last reveiced senderId\n\t\t\t\tlet senderId = -1;\n\t\t\t\t//Get event data\n\t\t\t\tconst{id, kind, readableStream, writableStream} = args;\n\t\t\t\t//Create transform stream for encrypting\n\t\t\t\tconst transformStream = new TransformStream({\n\t\t\t\t\ttransform: async (chunk, controller)=>{\n\t\t\t\t\t\t//Nothing in clear\n\t\t\t\t\t\tlet skip = 0;\n\t\t\t\t\t\t//Check if it is video and we are skipping vp8 payload header\n\t\t\t\t\t\tif (kind=="video" && context.isSkippingVp8PayloadHeader())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t//Get VP8 header\n\t\t\t\t\t\t\tconst vp8 = _lib_VP8PayloadHeader_js__WEBPACK_IMPORTED_MODULE_2__["VP8PayloadHeader"].parse(chunk.data);\n\t\t\t\t\t\t\t//Skip it\n\t\t\t\t\t\t\tskip = vp8.byteLength;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t//Enqueue task\n\t\t\t\t\t\ttasks.enqueue(\n\t\t\t\t\t\t\tcontext.decrypt(kind, id, chunk.data, skip),\n\t\t\t\t\t\t\t(decrypted) => {\n\t\t\t\t\t\t\t\t//Set back decrypted payload\n\t\t\t\t\t\t\t\tchunk.data = decrypted.buffer;\n\t\t\t\t\t\t\t\t//write back\n\t\t\t\t\t\t\t\tcontroller.enqueue(chunk);\n\t\t\t\t\t\t\t\t//If it is a sender\n\t\t\t\t\t\t\t\tif (decrypted.senderId!=senderId)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t//Store it\n\t\t\t\t\t\t\t\t\tsenderId = decrypted.senderId;\n\t\t\t\t\t\t\t\t\t//Launch event\n\t\t\t\t\t\t\t\t\tpostMessage ({event: {\n\t\t\t\t\t\t\t\t\t\tname\t: "authenticated",\n\t\t\t\t\t\t\t\t\t\tdata\t: {\n\t\t\t\t\t\t\t\t\t\t\tid\t : id,\n\t\t\t\t\t\t\t\t\t\t\tsenderId : senderId\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (decrypted.decryptionRestored) {\n\t\t\t\t\t\t\t\t\tpostDecryptStatusMessage({\n\t\t\t\t\t\t\t\t\t\tevent: {\n\t\t\t\t\t\t\t\t\t\t\tname: "decryptionRestored",\n\t\t\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\t\t\t\t\t\tsenderId,\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t(error) => {\n\t\t\t\t\t\t\t\tif (error.message === \'decryptFailed\') {\n\t\t\t\t\t\t\t\t\tpostDecryptStatusMessage({\n\t\t\t\t\t\t\t\t\t\tevent: {\n\t\t\t\t\t\t\t\t\t\t\tname: "decryptFailed",\n\t\t\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\t\t\t\t\t\tsenderId,\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t//Decrypt\n\t\t\t\treadableStream\n\t\t\t\t\t.pipeThrough(transformStream)\n\t\t\t\t\t.pipeTo(writableStream);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdefault:\n\t\t\t\t//Excute "cmd" method on context\n\t\t\t\tresult = await context[cmd](...args || []);\n\t\t}\n\t\t//Send result back\n\t\tpostMessage ({transId,result});\n\t} catch (error) {\n\t\tconsole.error(error);\n\t\t//Send error back\n\t\tpostMessage({transId,error});\n\t}\n};\n\n\n/***/ }),\n\n/***/ "./lib/AesCm128HmacSha256EncryptionKey.js":\n/*!************************************************!*\\\n  !*** ./lib/AesCm128HmacSha256EncryptionKey.js ***!\n  \\************************************************/\n/*! exports provided: AesCm128HmacSha256EncryptionKey */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n"use strict";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AesCm128HmacSha256EncryptionKey", function() { return AesCm128HmacSha256EncryptionKey; });\n/* harmony import */ var _Utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Utils.js */ "./lib/Utils.js");\n/* harmony import */ var _Salts_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Salts.js */ "./lib/Salts.js");\n/* harmony import */ var _IV_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./IV.js */ "./lib/IV.js");\n\n\n\n\nconst ratchetKey = (key) => \n\tcrypto.subtle.deriveBits(\n\t\t{\n\t\t\tname : "HKDF",\n\t\t\thash : "SHA-256",\n\t\t\tsalt : _Salts_js__WEBPACK_IMPORTED_MODULE_1__["Salts"].RatchetKey,\n\t\t\tinfo : new ArrayBuffer()\n\t\t},\n\t\tkey,\n\t\t256\n\t);\n\nclass AesCm128HmacSha256EncryptionKey \n{\n\tconstructor(){\n\t\tthis.ratchets = [];\n\t}\n\n\tasync setKey(key)\n\t{\n\t\tif (key instanceof CryptoKey)\n\t\t{\n\t\t\t//Check private key algorithm\n\t\t\tif (key.algorithm.name!="HKDF")\n\t\t\t\t//Error\n\t\t\t\tthrow new Error("Invalid key");\n\t\t} else {\n\t\t\t//Import key\n\t\t\tkey = await crypto.subtle.importKey(\n\t\t\t\t"raw",\n\t\t\t\tkey,\n\t\t\t\t"HKDF",\n\t\t\t\tfalse,\n\t\t\t\t["deriveBits", "deriveKey"]\n\t\t\t);\n\t\t}\n\t\tthis.key = key;\n\t\t\n\t\t//Get salt key\n\t\tthis.saltKey = new Uint8Array(await crypto.subtle.deriveBits(\n\t\t\t{\n\t\t\t\tname : "HKDF",\n\t\t\t\thash : "SHA-256",\n\t\t\t\tsalt : _Salts_js__WEBPACK_IMPORTED_MODULE_1__["Salts"].SaltKey,\n\t\t\t\tinfo : new ArrayBuffer()\n\t\t\t},\n\t\t\tkey,\n\t\t\t128\n\t\t));\n\t\n\t\t//Get encryption key\n\t\tthis.encryptionKey = await crypto.subtle.deriveKey(\n\t\t\t{\n\t\t\t\tname : "HKDF",\n\t\t\t\thash : "SHA-256",\n\t\t\t\tsalt : _Salts_js__WEBPACK_IMPORTED_MODULE_1__["Salts"].EncryptionKey,\n\t\t\t\tinfo : new ArrayBuffer()\n\t\t\t},\n\t\t\tkey,\n\t\t\t{\n\t\t\t\tname : "AES-CTR",\n\t\t\t\tlength : 128\n\t\t\t},\n\t\t\tfalse,\n\t\t\t["encrypt","decrypt"]\n\t\t);\n\t\n\t\t//Get authentication key\n\t\tthis.authKey = await crypto.subtle.deriveKey(\n\t\t\t{\n\t\t\t\tname : "HKDF",\n\t\t\t\thash : "SHA-256",\n\t\t\t\tsalt : _Salts_js__WEBPACK_IMPORTED_MODULE_1__["Salts"].AuthenticationKey,\n\t\t\t\tinfo : new ArrayBuffer()\n\t\t\t},\n\t\t\tkey,\n\t\t\t{\n\t\t\t\tname : "HMAC",\n\t\t\t\thash : "SHA-256",\n\t\t\t\tlength : 256\n\t\t\t},\n\t\t\tfalse,\n\t\t\t["sign","verify"]\n\t\t);\n\t}\n\n\t\n\tasync encrypt(type,header,payload,extraBytes,skip)\n\t{\n\t\t//Encure int\n\t\tskip = skip ? skip : 0;\n\t\t\n\t\t//Create IV\n\t\tconst iv = _IV_js__WEBPACK_IMPORTED_MODULE_2__["IV"].generate(header.keyId, header.counter, this.saltKey);\n\t\t\n\t\t//Encrypt\n\t\tconst encrypted = await crypto.subtle.encrypt(\n\t\t\t{\n\t\t\t\tname\t: "AES-CTR",\n\t\t\t\tcounter : iv,\n\t\t\t\tlength  : 128\n\t\t\t},\n\t\t\tthis.encryptionKey,\n\t\t\tpayload\n\t\t);\n\t\n\t\t//Get auth tag length from media type\n\t\tconst authTagLength = AesCm128HmacSha256EncryptionKey.getAuthTagLen(type);\n\t\t\n\t\t//Create encrypted frame\n\t\tconst encryptedFrame = new Uint8Array(header.byteLength + payload.byteLength + authTagLength + extraBytes + skip);\n\t\t\n\t\t//Set header and encrypted payolad\n\t\tencryptedFrame.set(header, skip);\n\t\tencryptedFrame.set(new Uint8Array(encrypted), skip + header.length);\n\t\t\n\t\t//Authenticate\n\t\tconst signature = new Uint8Array(await crypto.subtle.sign(\n\t\t\t"HMAC",\n\t\t\tthis.authKey, \n\t\t\tencryptedFrame.subarray(skip, skip + header.byteLength + encrypted.byteLength)\n\t\t));\n\t\n\t\t//Truncate\n\t\tconst authTag = signature.subarray(0, authTagLength);\n\t\n\t\t//Append authentication tag\n\t\tencryptedFrame.set(authTag, skip + encrypted.byteLength + header.byteLength );\n\t\t\n\t\t//Done\n\t\treturn [encryptedFrame,authTag];\n\t\t\n\t}\n\t\n\tasync decrypt(type, header, encryptedFrame, extrabytes, skip)\n\t{\n\t\t//Encure int\n\t\tskip = skip ? skip : 0;\n\t\t\n\t\t//Create IV\n\t\tconst iv = _IV_js__WEBPACK_IMPORTED_MODULE_2__["IV"].generate(header.keyId, header.counter, this.saltKey);\n\t\t\n\t\t//Get auth tag length from media type\n\t\tconst authTagLength = AesCm128HmacSha256EncryptionKey.getAuthTagLen(type);\n\t\t\n\t\t//Get encrypted frame length (without extra bytes from signature)\n\t\tconst frameLength = encryptedFrame.byteLength - extrabytes - skip;\n\t\t\n\t\t//Get authentication tag\n\t\tconst authTag = encryptedFrame.subarray(skip + frameLength - authTagLength, skip + frameLength);\n\t\t\n\t\t//Get encrypted payload\n\t\tconst encrypted = encryptedFrame.subarray(skip + header.byteLength, skip + frameLength - authTagLength);\n\t\t\n\t\t//Calculate signature\n\t\tconst signature = new Uint8Array(await crypto.subtle.sign(\n\t\t\t"HMAC",\n\t\t\tthis.authKey, \n\t\t\tencryptedFrame.subarray(skip, skip + header.byteLength + encrypted.byteLength)\n\t\t));\n\t\n\t\t//Authenticate authTag\n\t\tlet authenticated = true;\n\t\t//Avoid timimg attacks by iterating over all bytes\n\t\tfor (let i=0;i<authTagLength;++i)\n\t\t\t//check signature\n\t\t\tauthenticated &= authTag[i]===signature[i];\n\t\t\n\t\t//If not all where equal\n\t\tif (!authenticated)\n\t\t\t//Authentication error\n\t\t\tthrow new Error("Authentication error");\n\t\t\n\t\t//Decrypt\n\t\tconst payload = new Uint8Array (await crypto.subtle.decrypt(\n\t\t\t{\n\t\t\t\tname\t: "AES-CTR",\n\t\t\t\tcounter : iv,\n\t\t\t\tlength  : 128\n\t\t\t},\n\t\t\tthis.encryptionKey,\n\t\t\tencrypted\n\t\t));\n\t\t\n\t\t//Done\n\t\treturn [payload, authTag];\n\t}\n\t\n\tasync ratchet(index)\n\t{\n\t\t// return stored key if exists\n\t\tif (this.ratchets[index]) {\n\t\t\treturn this.ratchets[index];\n\t\t}\n\t\t\n\t\t//Create new key\n\t\tconst key = new AesCm128HmacSha256EncryptionKey();\n\n\t\t// Get previous ratchet\n\t\tconst previousRatchetKey = index === 0 ? this.key : this.ratchets[index - 1].key;\n\t\t\n\t\t//Set ratchet key\n\t\tawait key.setKey(await ratchetKey(previousRatchetKey));\n\t\t\n\t\tthis.ratchets[index] = key;\n\t\t//Done\n\t\treturn key;\n\t}\n\t\n\tstatic getAuthTagLen(type)\n\t{\n\t\treturn type.toLowerCase()==="video" ? 10 : 4;\n\t};\n\t\n\tstatic async create(raw) \n\t{\n\t\t//Create new key\n\t\tconst key = new AesCm128HmacSha256EncryptionKey();\n\t\t//Set raw key\n\t\tawait key.setKey(raw);\n\t\t//Done\n\t\treturn key;\n\t}\n};\n\n\n\n/***/ }),\n\n/***/ "./lib/Context.js":\n/*!************************!*\\\n  !*** ./lib/Context.js ***!\n  \\************************/\n/*! exports provided: Context */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n"use strict";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Context", function() { return Context; });\n/* harmony import */ var _Header_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Header.js */ "./lib/Header.js");\n/* harmony import */ var _Sender_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Sender.js */ "./lib/Sender.js");\n/* harmony import */ var _Receiver_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Receiver.js */ "./lib/Receiver.js");\n\n\n\n\nclass Context\n{\n\t\n\tconstructor(senderId, config)\n\t{\n\t\t//Store config\n\t\tthis.config = Object.assign({}, config);\n\t\t//Only one sender per context\n\t\tthis.sender = new _Sender_js__WEBPACK_IMPORTED_MODULE_1__["Sender"](senderId);\n\t\t\n\t\t//The map of known remote senders\n\t\tthis.receivers = new Map();\n\t}\n\t\n\tisSkippingVp8PayloadHeader()\n\t{\n\t\treturn !!this.config.skipVp8PayloadHeader;\n\t}\n\t\t\n\tasync setSenderEncryptionKey(key)\n\t{\n\t\t//Set it\n\t\treturn this.sender.setEncryptionKey(key);\n\t}\n\t\n\tasync ratchetSenderEncryptionKey()\n\t{\n\t\t//Set it\n\t\treturn this.sender.ratchetEncryptionKey();\n\t}\n\t\n\tasync setSenderSigningKey(key)\n\t{\n\t\t//Set it\n\t\treturn this.sender.setSigningKey(key);\n\t}\n\t\n\taddReceiver(receiverkKeyId)\n\t{\n\t\t//Check we don\'t have a receiver already for that id\n\t\tif(this.receivers.has(receiverkKeyId))\n\t\t\t//Error\n\t\t\tthrow new Error("There was already a receiver for keyId "+receiverkKeyId);\n\t\t//Add new\n\t\tthis.receivers.set(receiverkKeyId, new _Receiver_js__WEBPACK_IMPORTED_MODULE_2__["Receiver"](receiverkKeyId));\n\t}\n\t\n\tasync setReceiverEncryptionKey(receiverkKeyId, key)\n\t{\n\t\t//Get receiver for the sender\n\t\tconst receiver = this.receivers.get(receiverkKeyId);\n\t\t\n\t\t//IF not found\n\t\tif (!receiver)\n\t\t\t//Error\n\t\t\tthrow new Error("No receiver found for keyId "+receiverkKeyId);\n\t\t\n\t\t//Rachet\n\t\treturn receiver.setEncryptionKey(key);\n\t}\n\t\n\tasync setReceiverVerifyKey(receiverkKeyId,key)\n\t{\n\t\t//Get receiver for the sender\n\t\tconst receiver = this.receivers.get(receiverkKeyId);\n\t\t\n\t\t//IF not found\n\t\tif (!receiver)\n\t\t\t//Error\n\t\t\tthrow new Error("No receiver found for keyId "+receiverkKeyId);\n\t\t\n\t\t//Rachet\n\t\treturn receiver.setVerifyKey(key);\n\t}\n\t\n\tdeleteReceiver(receiverkKeyId)\n\t{\n\t\t//Delete receiver\n\t\treturn this.receivers.delete(receiverkKeyId);\n\t}\n\t\n\tasync encrypt(type, ssrcId, frame, skip)\n\t{\n\t\t//Encrypt it\n\t\treturn this.sender.encrypt(type, ssrcId, frame, skip);\n\t}\n\t\n\tasync decrypt(type, ssrcId, encryptedFrame, skip)\n\t{\n\t\t//convert if needed\n\t\tif (!(encryptedFrame instanceof Uint8Array))\n\t\t\tencryptedFrame = new Uint8Array (encryptedFrame);\n\t\t\n\t\t//Parse encrypted payload\n\t\tconst header = _Header_js__WEBPACK_IMPORTED_MODULE_0__["Header"].parse(encryptedFrame.subarray(skip));\n\t\t\n\t\t//Get receiver for the sender\n\t\tconst receiver = this.receivers.get(header.keyId);\n\t\t\n\t\t//IF not found\n\t\tif (!receiver)\n\t\t\t//Error\n\t\t\tthrow new Error("No receiver found for keyId " + header.keyId);\n\t\t\n\t\t//Decrypt it\n\t\treturn receiver.decrypt(type, ssrcId, header, encryptedFrame, skip);\n\t}\n\t\n};\n\n\n/***/ }),\n\n/***/ "./lib/EcdsaSignKey.js":\n/*!*****************************!*\\\n  !*** ./lib/EcdsaSignKey.js ***!\n  \\*****************************/\n/*! exports provided: EcdsaSignKey */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n"use strict";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EcdsaSignKey", function() { return EcdsaSignKey; });\n//TODO: Update to Ed25519 when available\n// https://chromestatus.com/features/4913922408710144\n// https://chromium.googlesource.com/chromium/src/+log/master/components/webcrypto/algorithms/ed25519.cc\n\nclass EcdsaSignKey\n{\n\t\n\tasync setKey(privKey)\n\t{\n\t\t//If it is a crypto key already\n\t\tif (privKey instanceof CryptoKey)\n\t\t{\n\t\t\t//Check private key algorithm\n\t\t\tif (privKey.algorithm.name!="ECDSA" || !privKey.usages.includes("sign"))\n\t\t\t\t//Error\n\t\t\t\tthrow new Error("Invalid key");\n\t\t\t//Set it\n\t\t\tthis.privKey = privKey;\n\t\t} else {\n\t\t\t//Import it\n\t\t\tthis.privKey = await crypto.subtle.importKey(\n\t\t\t\t"pkcs8",\n\t\t\t\tprivKey,\n\t\t\t\t{\n\t\t\t\t\tname\t\t: "ECDSA",\n\t\t\t\t\tnamedCurve\t: "P-521"\n\t\t\t\t},\n\t\t\t\tfalse,\n\t\t\t\t["sign"]\n\t\t\t);\n\t\t}\n\t}\n\t\n\tasync sign(authTags)\n\t{\n\t\t//Verify\n\t\treturn new Uint8Array(await crypto.subtle.sign(\n\t\t\t{\n\t\t\t  name: "ECDSA",\n\t\t\t  hash: "SHA-512"\n\t\t\t},\n\t\t\tthis.privKey,\n\t\t\tauthTags\n\t\t));\n\t}\n\t\n\tstatic getSignatureLen()\n\t{\n\t\treturn 64;\n\t}\n\t\n\tstatic async create(privKey)\n\t{\n\t\t//Craete key\n\t\tconst key = new EcdsaSignKey();\n\t\t//Set key\n\t\tawait key.setKey(privKey);\n\t\t//Done\n\t\treturn key;\n\t\t\n\t}\n};\n\n\n/***/ }),\n\n/***/ "./lib/EcdsaVerifyKey.js":\n/*!*******************************!*\\\n  !*** ./lib/EcdsaVerifyKey.js ***!\n  \\*******************************/\n/*! exports provided: EcdsaVerifyKey */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n"use strict";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EcdsaVerifyKey", function() { return EcdsaVerifyKey; });\n\nclass EcdsaVerifyKey\n{\n\tasync setKey(pubKey)\n\t{\n\t\t//If it is a crypto key already\n\t\tif (pubKey instanceof CryptoKey)\n\t\t{\n\t\t\t//Check \n\t\t\tif (pubKey.algorithm.name!="ECDSA" || !pubKey.usages.includes("verify"))\n\t\t\t\t//Error\n\t\t\t\tthrow new Error("Invalid key");\n\t\t\t//Set it\n\t\t\tthis.pubKey = pubKey;\n\t\t} else {\n\t\t\t//Import it\n\t\t\tthis.pubKey = await crypto.subtle.importKey(\n\t\t\t\t"raw",\n\t\t\t\tpubKey,\n\t\t\t\t{\n\t\t\t\t\tname\t\t: "ECDSA",\n\t\t\t\t\tnamedCurve\t: "P-521"\n\t\t\t\t},\n\t\t\t\tfalse,\n\t\t\t\t["verify"]\n\t\t\t);\n\t\t}\n\t}\n\t\n\tasync verify(signed,signature)\n\t{\n\t\t//Verify\n\t\treturn await window.crypto.subtle.verify(\n\t\t\t{\n\t\t\t\tname: "ECDSA",\n\t\t\t\thash: "SHA-512"\n\t\t\t},\n\t\t\tthis.pubKey,\n\t\t\tsignature,\n\t\t\tsigned\n\t\t);\n\t}\n\t\n\tstatic getSignatureLen()\n\t{\n\t\treturn 64;\n\t}\n\t\n\tstatic async create(pubKey)\n\t{\n\t\t//Craete key\n\t\tconst key = new EcdsaVerifyKey();\n\t\t//Set key\n\t\tawait key.setKey(pubKey);\n\t\t//Done\n\t\treturn key;\n\t\t\n\t}\n};\n\n\n/***/ }),\n\n/***/ "./lib/Header.js":\n/*!***********************!*\\\n  !*** ./lib/Header.js ***!\n  \\***********************/\n/*! exports provided: Header */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n"use strict";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Header", function() { return Header; });\n/*\n\t0 1 2 3 4 5 6 7\n\t+-+-+-+-+-+-+-+-+\n\t|S|LEN  |X|  K  |\n\t+-+-+-+-+-+-+-+-+\n\tSFrame header metadata\n\n\tSignature flag (S): 1 bit This field indicates the payload contains a signature of set. Counter Length (LEN): 3 bits This field indicates the length of the CTR fields in bytes. Extended Key Id Flag (X): 1 bit\n\tIndicates if the key field contains the key id or the key length. Key or Key Length: 3 bits This field contains the key id (KID) if the X flag is set to 0, or the key length (KLEN) if set to 1.\n\n\tIf X flag is 0 then the KID is in the range of 0-7 and the frame counter (CTR) is found in the next LEN bytes:\n\n\t 0 1 2 3 4 5 6 7\n\t+-+-+-+-+-+-+-+-+---------------------------------+\n\t|S|LEN  |0| KID |    CTR... (length=LEN)          |\n\t+-+-+-+-+-+-+-+-+---------------------------------+\n\tKey id (KID): 3 bits The key id (0-7). Frame counter (CTR): (Variable length) Frame counter value up to 8 bytes long.\n\n\tif X flag is 1 then KLEN is the length of the key (KID), that is found after the SFrame header metadata byte. After the key id (KID), the frame counter (CTR) will be found in the next LEN bytes:\n\n\t 0 1 2 3 4 5 6 7\n\t+-+-+-+-+-+-+-+-+---------------------------+---------------------------+\n\t|S|LEN  |1|KLEN |   KID... (length=KLEN)    |    CTR... (length=LEN)    |\n\t+-+-+-+-+-+-+-+-+---------------------------+---------------------------+\n*/\nconst Header = {\n\t\n\tparse : function(buffer) \n\t{\n\t\t//Create uint view\n\t\tconst view = new Uint8Array(buffer);\n\t\t\n\t\t//Get metadata\n\t\tconst metadata = view[0];\n\t\t\n\t\t//Get values\n\t\tconst s\t\t= !!(metadata & 0x80);\n\t\tconst len\t= (metadata >> 4) & 0x07;\n\t\tconst x\t\t= !!(metadata & 0x08);\n\t\tconst k\t\t= metadata & 0x07;\n\t\t\n\t\t//Get key id\n\t\tlet keyId = 0;\n\t\t//Check if it is the extented key format\n\t\tif (x)\n\t\t{\n\t\t\t//Read length\n\t\t\tfor (let i=0;i<k;i++)\n\t\t\t\tkeyId = (keyId * 256) + view[i+1];\n\t\t} else {\n\t\t\t//Short version\n\t\t\tkeyId = k;\n\t\t}\n\t\t\n\t\t//Get ctr\n\t\tconst ini = x ? k + 1 : 1;\n\t\tlet counter = 0;\n\t\t//Read length\n\t\tfor (let i=0;i<len;i++)\n\t\t\tcounter = (counter * 256) + view[ini+i];\n\t\t\n\t\t//Get header buffer view\n\t\tconst header = view.subarray(0, x ? k + len + 1 : len + 1);\n\t\t\n\t\t//Add parsed atributes\n\t\theader.signature   = s;\n\t\theader.keyId\t   = keyId;\n\t\theader.counter\t   = counter;\n\t\t\n\t\t//Done\n\t\treturn header; \n\t},\n\tgenerate: function(signature,keyId,counter)\n\t{\n\t\t//Check keyId\n\t\tHeader.checkKeyId(keyId);\n\t\t\n\t\t//Calcultate variavle length\n\t\tconst varlen = (x) => x ? parseInt(Math.log(x) / Math.log(256))+1 : 1;\n\t\t\n\t\t//Get key extension and length\n\t\tconst x = keyId > 7;\n\t\tconst k = x ? varlen(keyId) : keyId;\n\t\t\n\t\t//Get counter length\n\t\tconst len = varlen(counter);\n\t\t\n\t\t//Ensure counter is not huge\n\t\tif (len>7)\n\t\t\t//Error\n\t\t\tthrow new Error("Counter is too big");\n\t\t\n\t\t//Generate header\n\t\tconst header = new Uint8Array( x ? 1 + k + len : 1 + len);\n\t\t\n\t\t//Set metadata header\n\t\theader[0] = !!signature;\n\t\theader[0] = header[0] << 3  | ( len & 0x07);\n\t\theader[0] = header[0] << 1  | x;\n\t\theader[0] = header[0] << 3  | ( k & 0x07);\n\t\t\n\t\t//Add parsed atributes\n\t\theader.signature   = !!signature;\n\t\theader.keyId\t   = keyId;\n\t\theader.counter\t   = counter;\n\t\t\n\t\t//If extended key\n\t\tif (x)\n\t\t\t//Add key id\n\t\t\tfor (let i=0; i<k; ++i)\n\t\t\t\theader[i+1] = (keyId >> (k-1-i)*8) & 0xff;\n\t\t//The coutner init\n\t\tconst ini = x ? k + 1 : 1;\n\t\t//Add counter\n\t\tfor (let i=0; i<len; ++i)\n\t\t\theader[ini+i] = (counter >> (len-1-i)*8) & 0xff;\n\t\t\t\n\t\t\n\t\t//Done\n\t\treturn header;\n\t}\n};\n\nHeader.MaxKeyId = 0xFFFFFFFFFF;\n\nHeader.checkKeyId = function(keyId)\n{\n\t//Check it is possitive\n\tif (keyId<0)\n\t\t//Error\n\t\tthrow new Error("keyId must be possitive");\n\t//Check it is possitive\n\tif (keyId>Header.MaxKeyId)\n\t\t//Error\n\t\tthrow new Error("keyId must be 5 bytes long at most");\n};\n\n\n/***/ }),\n\n/***/ "./lib/IV.js":\n/*!*******************!*\\\n  !*** ./lib/IV.js ***!\n  \\*******************/\n/*! exports provided: IV */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n"use strict";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IV", function() { return IV; });\nconst IV = \n{\n\tgenerate : function(keyId,counter,salt)\n\t{\n\t\t//128 bits\n\t\tconst iv = new Uint8Array (16);\n\t\t//Get view\n\t\tconst view = new DataView(iv.buffer);\n\t\t//Set keyId\n\t\tview.setBigUint64(0, BigInt(counter));\n\t\t//Set coutner\n\t\tview.setBigUint64(8, BigInt(keyId));\n\t\t//Xor with salt key\n\t\tfor (let i=0; i<iv.byteLength; ++i)\n\t\t\t//xor\n\t\t\tview.setUint8(i,iv[i]^salt[i]); \n\t\t//return buffer\n\t\treturn iv;\n\t}\n};\n\n\n/***/ }),\n\n/***/ "./lib/Receiver.js":\n/*!*************************!*\\\n  !*** ./lib/Receiver.js ***!\n  \\*************************/\n/*! exports provided: Receiver */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n"use strict";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Receiver", function() { return Receiver; });\n/* harmony import */ var _Utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Utils.js */ "./lib/Utils.js");\n/* harmony import */ var _Header_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Header.js */ "./lib/Header.js");\n/* harmony import */ var _EcdsaVerifyKey_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./EcdsaVerifyKey.js */ "./lib/EcdsaVerifyKey.js");\n/* harmony import */ var _AesCm128HmacSha256EncryptionKey_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./AesCm128HmacSha256EncryptionKey.js */ "./lib/AesCm128HmacSha256EncryptionKey.js");\n\n\n\n\n\nconst MaxRatchetAttempts = 5;\nconst ReplayWindow = 128;\nconst KeyTimeout = 1000;\n\nclass Receiver\n{\n\tconstructor(senderId)\n\t{\n\t\t//Check keyId\n\t\t_Header_js__WEBPACK_IMPORTED_MODULE_1__["Header"].checkKeyId(senderId);\n\t\t\n\t\t//Store sender id\n\t\tthis.senderId = senderId;\n\t\t//Last received counter\n\t\tthis.maxReceivedCounter = -1;\n\t\t//Number or ratchets of current key\n\t\tthis.numKeyRatchets = 0;\n\t\t//Create keyring\n\t\tthis.keyring = [];\n\t\t//Pending verified tags\n\t\tthis.pending = new Map();\n\t\t// has failed decryption\n\t\tthis.keyFailing = false;\n\n\t\t//Scheduled keys\n\t\tthis.scheduledKeys = new WeakSet ();\n\n\t\t//Function to clear up keys up to given one\n\t\tthis.schedulePreviousKeysTimeout = (key) =>{\n\t\t\t//If this is the only key\n\t\t\tif (this.keyring.length==1 && this.keyring[0]===key)\n\t\t\t\t//Do nothing\n\t\t\t\treturn;\n\t\t\t//If has been already scheduled\n\t\t\tif (this.scheduledKeys.has(key))\n\t\t\t\t//Not do it twice\n\t\t\t\treturn;\n\t\t\t//Add it\n\t\t\tthis.scheduledKeys.add(key);\n\t\t\t//Schedule key timeout of previous keys\n\t\t\tsetTimeout(()=>{\n\t\t\t\t//Find key index\n\t\t\t\tconst i = this.keyring.findIndex(k=>k===key);\n\t\t\t\t//Remove previous keys\n\t\t\t\tthis.keyring = this.keyring.splice(i);\n\t\t\t}, KeyTimeout);\n\t\t};\n\t}\n\t\n\tasync decrypt(type, ssrcId, header, encryptedFrame, skip)\n\t{\n\t\tlet authTag, payload, extrabytes = 0, signature, signed;\n\t\tconst prevAuthTags = [];\n\t\t\n\t\t//convert if needed\n\t\tif (!(encryptedFrame instanceof Uint8Array))\n\t\t\tencryptedFrame = new Uint8Array (encryptedFrame);\n\n\t\t// Replay attack protection\n\t\tif (header.counter < this.maxReceivedCounter && (this.maxReceivedCounter - header.counter) > ReplayWindow) {\n\t\t\t//Error\n\t\t\tthrow new Error("Replay check failed, frame counter too old");\n\t\t}\n\t\t\n\t\t//Check if frame contains signature\n\t\tif (header.signature)\n\t\t{\n\t\t\t//Start from the end\n\t\t\tlet end = encryptedFrame.byteLength;\n\t\t\t\n\t\t\t//Get lengths\n\t\t\tconst singatureLength = ECDSAVerifyKey.getSignatureLen();\n\t\t\tconst authTagLength   = _AesCm128HmacSha256EncryptionKey_js__WEBPACK_IMPORTED_MODULE_3__["AesCm128HmacSha256EncryptionKey"].getAuthTagLen(type);\n\t\t\t\n\t\t\t//Get signature\n\t\t\tsignature = encryptedFrame.subarray(end - singatureLength, end);\n\t\t\t//Move backward\n\t\t\tend -= singatureLength;\n\t\t\t\n\t\t\t//Get number of tags\n\t\t\tconst num = encryptedFrame[end--];\n\t\t\t\n\t\t\t//Read all tags\n\t\t\tfor (let i=0; i<num; ++i)\n\t\t\t{\n\t\t\t\t//Get previous tag\n\t\t\t\tconst prevTag = encryptedFrame.subarray(end - authTagLength, end);\n\t\t\t\t//Move backward\n\t\t\t\tend -= authTagLength;\n\t\t\t\t//Add tag to previous tags in hex\n\t\t\t\tprevAuthTags.push(_Utils_js__WEBPACK_IMPORTED_MODULE_0__["Utils"].toHex(prevTag))\n\t\t\t}\n\t\t\t//Get the extra bytes\n\t\t\textrabytes = encryptedFrame.byteLength - end;\n\t\t\t\n\t\t\t//Move backward to start oth current frame auth tag\n\t\t\tend -= authTagLength;\n\t\t\t\n\t\t\t//Get singed part\n\t\t\tsigned = encryptedFrame.subarray(end, encryptedFrame.byteLength - singatureLength)\n\t\t}\n\n\t\t//For each key in key ring\n\t\tfor (let i=0;i<this.keyring.length;++i)\n\t\t{\n\t\t\t//Get key from ring\n\t\t\tconst key = this.keyring[i];\n\t\t\ttry {\n\t\t\t\t//Try to decrypt payload\n\t\t\t\t[payload, authTag] = await key.decrypt(type, header, encryptedFrame, extrabytes, skip);\n\t\t\t\t//Done\n\t\t\t\tbreak;\n\t\t\t} catch(e) {\n\t\t\t\t\n\t\t\t}\n\t\t}\n\n\t\t//If not found yet\n\t\tif (!payload)\n\t\t{\n\t\t\t//Get last key\n\t\t\tconst key = this.keyring[this.keyring.length-1];\n\t\t\t//Try ratchet last key\n\t\t\tfor (let i = 0; i < MaxRatchetAttempts; ++i)\n\t\t\t{\n\t\t\t\t//Ratchet key\n\t\t\t\tconst ratchetKey = await key.ratchet(i);\n\t\t\t\ttry {\n\t\t\t\t\t//Try to decrypt payload\n\t\t\t\t\t[payload, authTag] = await ratchetKey.decrypt(type, header, encryptedFrame, extrabytes, skip);\n\t\t\t\t\t// Set working ratchet as new key\n\t\t\t\t\tthis.keyring.push(ratchetKey);\n\t\t\t\t\tthis.schedulePreviousKeysTimeout(ratchetKey);\n\t\t\t\t\t//Done\n\t\t\t\t\tbreak;\n\t\t\t\t} catch(e) {\n\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//Last check\n\t\tif (!payload) {\n\t\t\t//Decryption failed\n\t\t\tif (this.keyFailing)  {\n\t\t\t\tthrow new Error(\'decryptStillFailing\')\n\t\t\t} else {\n\t\t\t\tthis.keyFailing = true;\n\t\t\t\tthrow new Error("decryptFailed");\n\t\t\t}\n\t\t}\n\n\t\t//If we are sending part of the frame in clear\n\t\tif (skip)\n\t\t\t//Copy skiped payload\n\t\t\tpayload.set(encryptedFrame.subarray(0,skip),0);\n\n\t\t//Check if have received anything from this ssrc before\n\t\tif (!this.pending.has(ssrcId))\n\t\t\t//Add it\n\t\t\tthis.pending.set(ssrcId,new Set());\n\n\t\t//Get pending list\n\t\tconst pending = this.pending.get(ssrcId);\n\n\t\t//Check if it constains signatures\n\t\tif (header.signed)\n\t\t{\n\t\t\t//try to verify list\n\t\t\tif (!await this.verifyKey.verify(signed,signature))\n\t\t\t\t//Error\n\t\t\t\tthrow new Error("Could not verify signature");\n\t\t\t//For each signed tag\n\t\t\tfor (const tag in prevAuthTags)\n\t\t\t\t//Delete from pending to be verified tags\n\t\t\t\tpending.delete(tag);\n\t\t} else {\n\t\t\t//Push this tag to\n\t\t\tpending.add(_Utils_js__WEBPACK_IMPORTED_MODULE_0__["Utils"].toHex(authTag));\n\t\t}\n\n\t\t//Set authenticated sender id and frame Id\n\t\tpayload.senderId = header.keyId;\n\t\tpayload.frameId  = header.counter;\n\n\t\t// inform that decryption is working after previously failing\n\t\tif (this.keyFailing) {\n\t\t\tpayload.decryptionRestored = true;\n\t\t\tthis.keyFailing = false;\n\t\t}\n\n\t\t//Store last received counter\n\t\tthis.maxReceivedCounter = Math.max(header.counter, this.maxReceivedCounter);\n\n\t\t//Return decrypted payload\n\t\treturn payload;\n\t}\n\n\tasync setVerifyKey(key)\n\t{\n\t\t//Create new singing key\n\t\tthis.verifyKey = _EcdsaVerifyKey_js__WEBPACK_IMPORTED_MODULE_2__["EcdsaVerifyKey"].create(key);\n\t}\n\n\tasync setEncryptionKey(raw)\n\t{\n\t\t//Create new encryption key\n\t\tconst key = await _AesCm128HmacSha256EncryptionKey_js__WEBPACK_IMPORTED_MODULE_3__["AesCm128HmacSha256EncryptionKey"].create(raw);\n\t\t//Append to the keyring\n\t\tthis.keyring.push(key);\n\t\t//Restart ratchet count number\n\t\tthis.numKeyRatchets = 0;\n\t\t//Activate\n\t\tthis.schedulePreviousKeysTimeout(key);\n\t}\n};\n\n\n/***/ }),\n\n/***/ "./lib/Salts.js":\n/*!**********************!*\\\n  !*** ./lib/Salts.js ***!\n  \\**********************/\n/*! exports provided: Salts */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n"use strict";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Salts", function() { return Salts; });\nconst textEncoder = new TextEncoder()\n\nconst Salts =  {\n\t"SaltKey"\t\t: textEncoder.encode("SFrameSaltKey"),\n\t"EncryptionKey"\t\t: textEncoder.encode("SFrameEncryptionKey"),\n\t"AuthenticationKey"\t: textEncoder.encode("SFrameAuthenticationKey"),\n\t"RatchetKey"\t\t: textEncoder.encode("SFrameRatchetKey")\n};\n\n\n/***/ }),\n\n/***/ "./lib/Sender.js":\n/*!***********************!*\\\n  !*** ./lib/Sender.js ***!\n  \\***********************/\n/*! exports provided: Sender */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n"use strict";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Sender", function() { return Sender; });\n/* harmony import */ var _Header_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Header.js */ "./lib/Header.js");\n/* harmony import */ var _EcdsaSignKey_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./EcdsaSignKey.js */ "./lib/EcdsaSignKey.js");\n/* harmony import */ var _AesCm128HmacSha256EncryptionKey_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./AesCm128HmacSha256EncryptionKey.js */ "./lib/AesCm128HmacSha256EncryptionKey.js");\n\n\n\n\n\nconst SigningFrameInterval = 10;\n\nclass Sender\n{\n\tconstructor(senderId)\n\t{\n\t\t//Check keyId\n\t\t_Header_js__WEBPACK_IMPORTED_MODULE_0__["Header"].checkKeyId(senderId);\n\t\t\n\t\t//The global frame counter\n\t\tthis.counter = 0;\n\t\t\n\t\t//Store senderId/keyId\n\t\tthis.senderId = senderId;\n\t\t\n\t\t//Pending frames for signing\n\t\tthis.pending = new Map();\n\t}\n\t\n\tasync encrypt(type, ssrcId, payload, skip)\n\t{\n\t\t//Check we have a valid key\n\t\tif (!this.key)\n\t\t\tthrow Error("Encryption key not set");\n\t\t\n\t\t//convert if needed\n\t\tif (!(payload instanceof Uint8Array))\n\t\t\tpayload = new Uint8Array (payload);\n\t\t\n\t\t//Encure int\n\t\tskip = skip ? skip : 0;\n\t\t\n\t\t//Get counter for frame\n\t\tconst counter = this.counter++;\n\t\t\n\t\t//If we don\'t have the ssrc\n\t\t// TODO FIX https://github.com/medooze/sframe/issues/15 and uncomment line below\n\t\t// if (!this.pending.has(ssrcId))\n\t\t//Create new pending frames array\n\t\t\tthis.pending.set(ssrcId,[]);\n\t\t\n\t\t//Get pending frames for signature\n\t\tconst pending = this.pending.get(ssrcId);\t\t\n\t\t\n\t\t//Do we need to sign the frames?\n\t\tconst signing = this.signingKey && pending.length > SigningFrameInterval;\n\t\t\n\t\t//Get auth tag len for type\n\t\tconst authTagLen = _AesCm128HmacSha256EncryptionKey_js__WEBPACK_IMPORTED_MODULE_2__["AesCm128HmacSha256EncryptionKey"].getAuthTagLen(type);\n\t\t\n\t\t//Calculae extra bytes\n\t\tconst extraBytes = signing ? pending.length * _AesCm128HmacSha256EncryptionKey_js__WEBPACK_IMPORTED_MODULE_2__["AesCm128HmacSha256EncryptionKey"].getAuthTagLen(type) + 1 + _EcdsaSignKey_js__WEBPACK_IMPORTED_MODULE_1__["EcdsaSignKey"].getSignatureLen() : 0;\n\t\t\n\t\t//Generate header\n\t\tconst header = _Header_js__WEBPACK_IMPORTED_MODULE_0__["Header"].generate(signing,this.senderId,counter);\n\t\t\n\t\t//Encrypt frame\n\t\tconst [encryptedFrame,authTag] = await this.key.encrypt(type, header, payload, extraBytes, skip);\n\t\t\n\t\t//If we are sending part of the frame in clear\n\t\tif (skip)\n\t\t\t//Copy skiped payload\n\t\t\tencryptedFrame.set(payload.subarray(0,skip),0);\n\t\t\n\t\t//If we need to sign the frame\n\t\tif (signing)\n\t\t{\n\t\t\t//Append after auth tag\n\t\t\tlet ini = skip + encryptedFrame.byteLength - extraBytes;\n\t\t\t\n\t\t\t//Get tag list view\n\t\t\tconst authTags = encryptedFrame.subarray(ini - authTagLen, (pending.length + 1) * authTagLen);\n\t\t\t\n\t\t\t//Add all previous tags \n\t\t\tfor (const previousTag of pending)\n\t\t\t{\n\t\t\t\t//Append to frame\n\t\t\t\tencryptedFrame.set(previousTag, ini);\n\t\t\t\t//Move\n\t\t\t\tini += authTagLen;\n\t\t\t}\n\t\t\t\n\t\t\t//Add number of bytes\n\t\t\tencryptedFrame[ini++] = pending.length;\n\t\t\t\n\t\t\t//Create signature with all auth tags (including this frame\'s one)\n\t\t\tconst signature = await this.signingKey.sign(authTags);\n\t\t\t\n\t\t\t//Add signature\n\t\t\tencryptedFrame.set(signature, ini);\n\t\t\t\n\t\t\t//Empty pending list \n\t\t\tthis.pending.set(ssrcId,[]);\n\t\t\t\n\t\t//If we can sign\n\t\t} else if (this.signingKey) {\n\t\t\t//Append a copy of current tag at the begining\n\t\t\tpending.unshift(authTag.slice());\n\t\t}\n\t\t\n\t\t//Set authenticated sender id and frame Id\n\t\tencryptedFrame.senderId = header.keyId;\n\t\tencryptedFrame.frameId  = header.counter;\n\t\t\n\t\t//Done\n\t\treturn encryptedFrame;\n\t}\n\t\n\tasync setSigningKey(key)\n\t{\n\t\t//Create new singing key\n\t\tthis.signingKey = await _EcdsaSignKey_js__WEBPACK_IMPORTED_MODULE_1__["EcdsaSignKey"].create(key);\n\t}\n\t\n\tasync setEncryptionKey(key)\n\t{\n\t\t//Create new encryption key\n\t\tthis.key = await _AesCm128HmacSha256EncryptionKey_js__WEBPACK_IMPORTED_MODULE_2__["AesCm128HmacSha256EncryptionKey"].create(key);\n\t}\n\t\n\tasync ratchetEncryptionKey()\n\t{\n\t\t//Check we have a valid key\n\t\tif (!this.key)\n\t\t\tthrow Error("Encryption key not set");\n\t\t\n\t\t//Rachet the key and store it\n\t\tthis.key = await this.key.ratchet();\n\t}\n};\n\n\n/***/ }),\n\n/***/ "./lib/TaskQueue.js":\n/*!**************************!*\\\n  !*** ./lib/TaskQueue.js ***!\n  \\**************************/\n/*! exports provided: TaskQueue */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n"use strict";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TaskQueue", function() { return TaskQueue; });\nclass TaskQueue\n{\n\tconstructor()\n\t{\n\t\tthis.tasks = [];\n\t\tthis.running = false;\n\t}\n\t\n\tenqueue(promise,callback,error)\n\t{\n\t\t//enqueue task\n\t\tthis.tasks.push({promise,callback,error});\n\t\t//Try run \n\t\tthis.run();\n\t}\n\t\n\tasync run()\n\t{\n\t\t//If already running \n\t\tif (this.running)\n\t\t\t//Nothing\n\t\t\treturn;\n\t\t//Running\n\t\tthis.running = true;\n\t\t//Run all pending tasks\n\t\twhile(this.tasks.length)\n\t\t{\n\t\t\ttry {\n\t\t\t\t//Wait for first promise to finish\n\t\t\t\tconst result = await this.tasks[0].promise;\n\t\t\t\t//Run callback\n\t\t\t\tthis.tasks[0].callback(result); \n\t\t\t} catch(e) {\n\t\t\t\t//Run error callback\n\t\t\t\tthis.tasks[0].error(e); \n\t\t\t}\n\t\t\t//Remove task from queue\n\t\t\tthis.tasks.shift();\n\t\t}\n\t\t//Ended\n\t\tthis.running = false;\n\t}\n}\n\n\n/***/ }),\n\n/***/ "./lib/Utils.js":\n/*!**********************!*\\\n  !*** ./lib/Utils.js ***!\n  \\**********************/\n/*! exports provided: Utils */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n"use strict";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Utils", function() { return Utils; });\nconst Utils = \n{\n\ttoHex : function(buffer)\n\t{\n\t\treturn Array.prototype.map.call(buffer instanceof Uint8Array ? buffer : new Uint8Array (buffer), x =>x.toString(16).padStart(2,"0")).join("");\n\t},\n\tfromHex: function(str)\n\t{\n\t\tconst bytes = [];\n\t\tfor (let i=0;i<str.length/2;++i)\n\t\t\tbytes.push(parseInt(str.substring(i*2, (i+1)*2), 16));\n\n\t\treturn new Uint8Array(bytes);\n\t},\n\tequals : function(a,b)\n\t{\n\t\tif (a.byteLength != b.byteLength) return false;\n\t\tfor (let i = 0 ; i != a.byteLength ; i++)\n\t\t\tif (a[i] != b[i]) return false;\n\t\treturn true;\n\t}\n};\n\n\n/***/ }),\n\n/***/ "./lib/VP8PayloadHeader.js":\n/*!*********************************!*\\\n  !*** ./lib/VP8PayloadHeader.js ***!\n  \\*********************************/\n/*! exports provided: VP8PayloadHeader */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n"use strict";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "VP8PayloadHeader", function() { return VP8PayloadHeader; });\n\nconst VP8PayloadHeader = {\n\t\n\tparse : function(buffer) \n\t{\n\t\t//Check size\n\t\tif (buffer.byteLength<3)\n\t\t\t//Invalid\n\t\t\treturn null;\n\t\t\n\t\t//Create uint view\n\t\tconst view = new Uint8Array(buffer);\n\t\t\n\t\t//Read comon 3 bytes\n\t\t//   0 1 2 3 4 5 6 7\n                //  +-+-+-+-+-+-+-+-+\n                //  |Size0|H| VER |P|\n                //  +-+-+-+-+-+-+-+-+\n                //  |     Size1     |\n                //  +-+-+-+-+-+-+-+-+\n                //  |     Size2     |\n                //  +-+-+-+-+-+-+-+-+\n\t\tconst firstPartitionSize\t= view[0] >> 5;\n\t\tconst showFrame\t\t\t= view[0] >> 4 & 0x01;\n\t\tconst version\t\t\t= view[0] >> 1 & 0x07;\n\t\tconst isKeyFrame\t\t= (view[0] & 0x01) == 0;\n\n\t\t//check if more\n\t\tif (isKeyFrame)\n\t\t{\n\t\t\t//Check size\n\t\t\tif (buffer.byteLength<10)\n\t\t\t\t//Invalid\n\t\t\t\treturn null;\n\t\t\t//Get size in le\n\t\t\tconst hor = view[7]<<8 | view[6];\n\t\t\tconst ver = view[9]<<8 | view[8];\n\t\t\t//Get dimensions and scale\n\t\t\tconst width\t\t= hor & 0x3fff;\n\t\t\tconst horizontalScale   = hor >> 14;\n\t\t\tconst height\t\t= ver & 0x3fff;\n\t\t\tconst verticalScale\t= ver >> 14;\n\t\t\t//Key frame\n\t\t\treturn view.subarray (0,10);\n\t\t}\n\t\t\n\t\t//No key frame\n\t\treturn view.subarray (0,3);\n\t}\n};\n\n\t\t\n\n\n/***/ }),\n\n/***/ "./node_modules/lodash/_Symbol.js":\n/*!****************************************!*\\\n  !*** ./node_modules/lodash/_Symbol.js ***!\n  \\****************************************/\n/*! no static exports found */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar root = __webpack_require__(/*! ./_root */ "./node_modules/lodash/_root.js");\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n\n\n/***/ }),\n\n/***/ "./node_modules/lodash/_baseGetTag.js":\n/*!********************************************!*\\\n  !*** ./node_modules/lodash/_baseGetTag.js ***!\n  \\********************************************/\n/*! no static exports found */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar Symbol = __webpack_require__(/*! ./_Symbol */ "./node_modules/lodash/_Symbol.js"),\n    getRawTag = __webpack_require__(/*! ./_getRawTag */ "./node_modules/lodash/_getRawTag.js"),\n    objectToString = __webpack_require__(/*! ./_objectToString */ "./node_modules/lodash/_objectToString.js");\n\n/** `Object#toString` result references. */\nvar nullTag = \'[object Null]\',\n    undefinedTag = \'[object Undefined]\';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n\n\n/***/ }),\n\n/***/ "./node_modules/lodash/_baseTrim.js":\n/*!******************************************!*\\\n  !*** ./node_modules/lodash/_baseTrim.js ***!\n  \\******************************************/\n/*! no static exports found */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar trimmedEndIndex = __webpack_require__(/*! ./_trimmedEndIndex */ "./node_modules/lodash/_trimmedEndIndex.js");\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * The base implementation of `_.trim`.\n *\n * @private\n * @param {string} string The string to trim.\n * @returns {string} Returns the trimmed string.\n */\nfunction baseTrim(string) {\n  return string\n    ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, \'\')\n    : string;\n}\n\nmodule.exports = baseTrim;\n\n\n/***/ }),\n\n/***/ "./node_modules/lodash/_freeGlobal.js":\n/*!********************************************!*\\\n  !*** ./node_modules/lodash/_freeGlobal.js ***!\n  \\********************************************/\n/*! no static exports found */\n/***/ (function(module, exports, __webpack_require__) {\n\n/* WEBPACK VAR INJECTION */(function(global) {/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == \'object\' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js")))\n\n/***/ }),\n\n/***/ "./node_modules/lodash/_getRawTag.js":\n/*!*******************************************!*\\\n  !*** ./node_modules/lodash/_getRawTag.js ***!\n  \\*******************************************/\n/*! no static exports found */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar Symbol = __webpack_require__(/*! ./_Symbol */ "./node_modules/lodash/_Symbol.js");\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n\n\n/***/ }),\n\n/***/ "./node_modules/lodash/_objectToString.js":\n/*!************************************************!*\\\n  !*** ./node_modules/lodash/_objectToString.js ***!\n  \\************************************************/\n/*! no static exports found */\n/***/ (function(module, exports) {\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n\n\n/***/ }),\n\n/***/ "./node_modules/lodash/_root.js":\n/*!**************************************!*\\\n  !*** ./node_modules/lodash/_root.js ***!\n  \\**************************************/\n/*! no static exports found */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar freeGlobal = __webpack_require__(/*! ./_freeGlobal */ "./node_modules/lodash/_freeGlobal.js");\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == \'object\' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function(\'return this\')();\n\nmodule.exports = root;\n\n\n/***/ }),\n\n/***/ "./node_modules/lodash/_trimmedEndIndex.js":\n/*!*************************************************!*\\\n  !*** ./node_modules/lodash/_trimmedEndIndex.js ***!\n  \\*************************************************/\n/*! no static exports found */\n/***/ (function(module, exports) {\n\n/** Used to match a single whitespace character. */\nvar reWhitespace = /\\s/;\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n * character of `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the index of the last non-whitespace character.\n */\nfunction trimmedEndIndex(string) {\n  var index = string.length;\n\n  while (index-- && reWhitespace.test(string.charAt(index))) {}\n  return index;\n}\n\nmodule.exports = trimmedEndIndex;\n\n\n/***/ }),\n\n/***/ "./node_modules/lodash/debounce.js":\n/*!*****************************************!*\\\n  !*** ./node_modules/lodash/debounce.js ***!\n  \\*****************************************/\n/*! no static exports found */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar isObject = __webpack_require__(/*! ./isObject */ "./node_modules/lodash/isObject.js"),\n    now = __webpack_require__(/*! ./now */ "./node_modules/lodash/now.js"),\n    toNumber = __webpack_require__(/*! ./toNumber */ "./node_modules/lodash/toNumber.js");\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = \'Expected a function\';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho\'s article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it\'s invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on(\'resize\', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on(\'click\', _.debounce(sendMail, 300, {\n *   \'leading\': true,\n *   \'trailing\': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { \'maxWait\': 1000 });\n * var source = new EventSource(\'/stream\');\n * jQuery(source).on(\'message\', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on(\'popstate\', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != \'function\') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = \'maxWait\' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = \'trailing\' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we\'re at the\n    // trailing edge, the system time has gone backwards and we\'re treating\n    // it as the trailing edge, or we\'ve hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nmodule.exports = debounce;\n\n\n/***/ }),\n\n/***/ "./node_modules/lodash/isObject.js":\n/*!*****************************************!*\\\n  !*** ./node_modules/lodash/isObject.js ***!\n  \\*****************************************/\n/*! no static exports found */\n/***/ (function(module, exports) {\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String(\'\')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == \'object\' || type == \'function\');\n}\n\nmodule.exports = isObject;\n\n\n/***/ }),\n\n/***/ "./node_modules/lodash/isObjectLike.js":\n/*!*********************************************!*\\\n  !*** ./node_modules/lodash/isObjectLike.js ***!\n  \\*********************************************/\n/*! no static exports found */\n/***/ (function(module, exports) {\n\n/**\n * Checks if `value` is object-like. A value is object-like if it\'s not `null`\n * and has a `typeof` result of "object".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == \'object\';\n}\n\nmodule.exports = isObjectLike;\n\n\n/***/ }),\n\n/***/ "./node_modules/lodash/isSymbol.js":\n/*!*****************************************!*\\\n  !*** ./node_modules/lodash/isSymbol.js ***!\n  \\*****************************************/\n/*! no static exports found */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar baseGetTag = __webpack_require__(/*! ./_baseGetTag */ "./node_modules/lodash/_baseGetTag.js"),\n    isObjectLike = __webpack_require__(/*! ./isObjectLike */ "./node_modules/lodash/isObjectLike.js");\n\n/** `Object#toString` result references. */\nvar symbolTag = \'[object Symbol]\';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol(\'abc\');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == \'symbol\' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nmodule.exports = isSymbol;\n\n\n/***/ }),\n\n/***/ "./node_modules/lodash/now.js":\n/*!************************************!*\\\n  !*** ./node_modules/lodash/now.js ***!\n  \\************************************/\n/*! no static exports found */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar root = __webpack_require__(/*! ./_root */ "./node_modules/lodash/_root.js");\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nmodule.exports = now;\n\n\n/***/ }),\n\n/***/ "./node_modules/lodash/toNumber.js":\n/*!*****************************************!*\\\n  !*** ./node_modules/lodash/toNumber.js ***!\n  \\*****************************************/\n/*! no static exports found */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar baseTrim = __webpack_require__(/*! ./_baseTrim */ "./node_modules/lodash/_baseTrim.js"),\n    isObject = __webpack_require__(/*! ./isObject */ "./node_modules/lodash/isObject.js"),\n    isSymbol = __webpack_require__(/*! ./isSymbol */ "./node_modules/lodash/isSymbol.js");\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber(\'3.2\');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == \'number\') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == \'function\' ? value.valueOf() : value;\n    value = isObject(other) ? (other + \'\') : other;\n  }\n  if (typeof value != \'string\') {\n    return value === 0 ? value : +value;\n  }\n  value = baseTrim(value);\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = toNumber;\n\n\n/***/ }),\n\n/***/ "./node_modules/webpack/buildin/global.js":\n/*!***********************************!*\\\n  !*** (webpack)/buildin/global.js ***!\n  \\***********************************/\n/*! no static exports found */\n/***/ (function(module, exports) {\n\nvar g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function("return this")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === "object") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it\'s\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n\n\n/***/ })\n\n/******/ });\n',"Worker",void 0,void 0)}},"./index.js":
/*!******************!*\
  !*** ./index.js ***!
  \******************/
/*! exports provided: SFrame, Utils */function(e,t,n){"use strict";n.r(t);var r=n(/*! ../sframe/lib/Utils */"./lib/Utils.js");n.d(t,"Utils",(function(){return r.Utils}));var i=n(/*! ./Client */"./Client.js");n.d(t,"SFrame",(function(){return i.SFrame}))},"./lib/Utils.js":
/*!**********************!*\
  !*** ./lib/Utils.js ***!
  \**********************/
/*! exports provided: Utils */function(e,t,n){"use strict";n.r(t),n.d(t,"Utils",(function(){return r}));const r={toHex:function(e){return Array.prototype.map.call(e instanceof Uint8Array?e:new Uint8Array(e),e=>e.toString(16).padStart(2,"0")).join("")},fromHex:function(e){const t=[];for(let n=0;n<e.length/2;++n)t.push(parseInt(e.substring(2*n,2*(n+1)),16));return new Uint8Array(t)},equals:function(e,t){if(e.byteLength!=t.byteLength)return!1;for(let n=0;n!=e.byteLength;n++)if(e[n]!=t[n])return!1;return!0}}},"./node_modules/worker-loader/dist/runtime/inline.js":
/*!***********************************************************!*\
  !*** ./node_modules/worker-loader/dist/runtime/inline.js ***!
  \***********************************************************/
/*! no static exports found */function(e,t,n){"use strict";e.exports=function(e,t,n,r){var i=self||window;try{try{var o;try{o=new i.Blob([e])}catch(t){(o=new(i.BlobBuilder||i.WebKitBlobBuilder||i.MozBlobBuilder||i.MSBlobBuilder)).append(e),o=o.getBlob()}var a=i.URL||i.webkitURL,s=a.createObjectURL(o),c=new i[t](s,n);return a.revokeObjectURL(s),c}catch(r){return new i[t]("data:application/javascript,".concat(encodeURIComponent(e)),n)}}catch(e){if(!r)throw Error("Inline worker is not supported");return new i[t](r,n)}}}})},e.exports=n()}).call(this,n(2))},function(e,t,n){"use strict";const r=n(6),i=n(306),o=n(72)(),a=n(776),s=n(28);let c=function(){function e(e,t){void 0===t&&(t={}),this._session=e,this.PeerConnection=t.PeerConnection||o,this._subscriberCreateQueue=new a,this._originalSendMessages={},this._tracks=[],this._subscriberPcs={},this._sendMessage=()=>{},r(this)}var t=e.prototype;return t.parseOptions=function(e){return Object.assign({},e,{removeUnusedCodecs:!0,sendMessage:(e,t)=>this.trigger("sendMessage",e,t)})},t.addTrackAddedListener=function(){this._peerConnection&&this._peerConnection.on("trackAdded",e=>{const t=e.track;this._tracks.includes(t.id)||(this._subscriberPcs[this._subscriberPcToAdd._id].push(t.id),this._tracks.push(t.id),this._subscriberPcToAdd._onTrackAdded(e))})},t.getPeerConnection=function(e,t){if(this._subscriberPcToAdd=t,this._sendMessage=e.sendMessage,this._originalSendMessages[t._id]=this._sendMessage,this._peerConnection)this._peerConnection.addOptions(e);else{this._firstSubscriberPc=t._id,this.on("sendMessage",(e,t)=>{this._sendMessage(e,t)});const n=this.parseOptions(e);this._peerConnection=new this.PeerConnection(n),this.addTrackAddedListener()}return this._subscriberPcs[t._id]=[],this._peerConnection},t.removeMessageSender=function(e){delete this._originalSendMessages[e];const t=Object.values(this._originalSendMessages);this._sendMessage=t[t.length-1]||function(){}},t.removeSubscriber=function(e,t){this.removeMessageSender(e),this._peerConnection.stopTransceivers(t)},t.removeFromSinglePeerConnection=function(e){if(delete this._subscriberPcs[e],Object.keys(this._subscriberPcs).length)if(this._firstSubscriberPc===e)this._peerConnection.iceRestart(),this._peerConnection.generateOfferAndSend();else{const e=e=>{this.cachedSdp=s.updateSDPWithNewOffer(this.cachedSdp,e.sdp);const t=s.createSDP(this.cachedSdp.headers,this.cachedSdp.trackSections);this._peerConnection.processMessage("answer",{content:{sdp:t,mocked:!0}})};this._peerConnection.generateOfferAndAnswer(e)}else this.reset()},t.removeTrack=function(e,t){const n=null==e?void 0:e.id;n&&(i(this._tracks,n),i(this._subscriberPcs[t]||[],n))},t.reset=function(){this._originalSendMessages={},this._tracks=[],this._subscriberPcs={},this._peerConnection&&(this._peerConnection.disconnect(),this._peerConnection=null)},t.destroy=function(){this.reset(),this._session=null},t.addSubscriber=function(e){this._subscriberCreateQueue.add(e)},t.subscriberComplete=function(){this._subscriberCreateQueue.next()},t.cacheOfferAnswer=function(e){e.mocked||(this.cachedSdp=s.parseMantisSDP(e.sdp))},e}();e.exports=c},function(e,t,n){"use strict";let r=function(){function e(){this.queue=[],this.isAddingSubscriber=!1}var t=e.prototype;return t.add=function(e){this.isAddingSubscriber?this.queue.push(e):(this.isAddingSubscriber=!0,e())},t.next=function(){const e=this.queue.shift();e?e():this.isAddingSubscriber=!1},e}();e.exports=r},function(e,t,n){"use strict";e.exports=function(e){void 0===e&&(e={});const t=e.Session||n(324)(),r=e.sessionObjects||n(22);return function(e,n,i){null==n&&(n=e,e=null),Array.isArray(n)&&1===n.length&&(n=n[0]);let o=r.sessions.get(n);return o||(o=new t(e,n,i),r.sessions.add(o)),o}}},function(e,t,n){"use strict";var r=n(1),i=r(n(4)),o=r(n(5));const a=n(779),s=n(274),c=n(3),u=n(7),d=n(10),l=n(13)(),f=n(28),p=n(73),h=n(143)(void 0!==typeof window?window:global);function m(e){return s(a(e,["AV1X","AV1","VP9","rtx","red","ulpfec","H265","X-H264UC","x-ulpfecuc"]))}const g=function(){var e=(0,o.default)(i.default.mark((function e(){var t,n,r,o,a,s,g;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!=typeof window){e.next=2;break}return e.abrupt("return",{videoEncoders:[],videoDecoders:[]});case 2:if(t=h.RTCPeerConnection,!window.RTCRtpSender||!("getCapabilities"in window.RTCRtpSender)){e.next=7;break}return n=m(n=window.RTCRtpSender.getCapabilities("video").codecs.map(e=>e.mimeType||e.name).map(e=>e.replace("video/",""))),e.abrupt("return",{videoEncoders:n,videoDecoders:n});case 7:if("Chrome"!==c.name||"captureStream"in window.HTMLCanvasElement.prototype){e.next=9;break}return e.abrupt("return",{videoEncoders:["VP8"],videoDecoders:["VP8"]});case 9:if(!c.isLegacyEdge){e.next=11;break}return e.abrupt("return",{videoEncoders:["H264","VP8"],videoDecoders:["H264","VP8"]});case 11:return(r=window.document.createElement("canvas")).getContext("2d"),o=r.captureStream(),e.prev=14,s={iceServers:[]},p()&&(s.sdpSemantics="plan-b"),(a=new t(s)).addTrack?a.addTrack(o.getVideoTracks()[0],o):a.addStream&&a.addStream(o),e.next=21,a.createOffer();case 21:return g=e.sent,n=m(n=f.getCodecs(g.sdp,"video")||[]),e.abrupt("return",{videoEncoders:n,videoDecoders:n});case 27:throw e.prev=27,e.t0=e.catch(14),l(u.UNABLE_TO_ACCESS_MEDIA_ENGINE,new Error("OT.getSupportedCodecs was not able to get the list of supported codecs"),d.UNABLE_TO_ACCESS_MEDIA_ENGINE);case 30:return e.prev=30,a.close(),e.finish(30);case 33:case"end":return e.stop()}}),e,null,[[14,27,30,33]])})));return function(){return e.apply(this,arguments)}}();e.exports=g},function(e,t,n){var r=n(780),i=n(238),o=n(88),a=n(131),s=o((function(e,t){return a(e)?r(e,i(t,1,a,!0)):[]}));e.exports=s},function(e,t,n){var r=n(93),i=n(94),o=n(130),a=n(34),s=n(67),c=n(95);e.exports=function(e,t,n,u){var d=-1,l=i,f=!0,p=e.length,h=[],m=t.length;if(!p)return h;n&&(t=a(t,s(n))),u?(l=o,f=!1):t.length>=200&&(l=c,f=!1,t=new r(t));e:for(;++d<p;){var g=e[d],v=null==n?g:n(g);if(g=u||0!==g?g:0,f&&v==v){for(var y=m;y--;)if(t[y]===v)continue e;h.push(g)}else l(t,v,u)||h.push(g)}return h}},function(e,t,n){"use strict";const r=n(320).isSupported;e.exports=r},function(e,t,n){"use strict";const r=n(110);e.exports=r},function(e,t,n){"use strict";const r=n(20)().getInputMediaDevices;e.exports=function(e){r().then(t=>e(void 0,t),e)}},function(e,t,n){"use strict";var r=n(1),i=r(n(4)),o=r(n(5));e.exports=function(e){void 0===e&&(e={});const t=e.deviceHelpers||n(20)(),r=t.hasAudioOutputApiSupport,a=t.hasDevice,s=e.getAudioOutputDevices||n(336),c=e.updateSubscribersSinkId||n(338),u=n(13)(),d=n(7);return function(){var e=(0,o.default)(i.default.mark((function e(t){var n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r()){e.next=2;break}throw u(d.UNSUPPORTED_BROWSER,new Error("setAudioOutputDevice is not supported in your browser."));case 2:return e.next=4,s();case 4:if(n=e.sent,a(n,t)){e.next=8;break}throw u(d.INVALID_AUDIO_OUTPUT_SOURCE,new Error("The requested device is not valid."));case 8:return e.prev=8,e.next=11,c(t);case 11:e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(8),u(d.REQUESTED_DEVICE_PERMISSION_DENIED,new Error("No permission to use the requested device."));case 16:case"end":return e.stop()}}),e,null,[[8,13]])})));return function(t){return e.apply(this,arguments)}}()}},function(e,t,n){"use strict";var r=n(1),i=r(n(4)),o=r(n(5));const a=n(786)(),s=n(20)(),c=s.hasAudioOutputApiSupport,u=s.getNativeMediaDevices;e.exports=()=>{if(c()){const e=u();let t=!1;e.addEventListener("devicechange",(0,o.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return");case 2:return t=!0,e.next=5,a();case 5:t=!1;case 6:case"end":return e.stop()}}),e)}))))}}},function(e,t,n){"use strict";var r=n(1),i=r(n(4)),o=r(n(5));e.exports=function(e){void 0===e&&(e={});const t=e.deviceHelpers||n(20)(),r=t.getAudioOutputMediaDevices,a=t.getDefaultAudioOutputDeviceId,s=t.hasDevice,c=e.currentAudioOutputDevice||n(107),u=c.getCurrentAudioOutputDeviceId,d=c.setCurrentAudioOutputDeviceId,l=e.updateSubscribersSinkId||n(338),f=e.logging||n(0)("currentAudioOutputDevice");return function(){var e=(0,o.default)(i.default.mark((function e(){var t,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r();case 2:if(0!==(t=e.sent).length){e.next=6;break}return d(""),e.abrupt("return");case 6:if(!s(t,u())){e.next=9;break}return e.abrupt("return");case 9:return n=a(t),d(n),e.prev=11,e.next=14,l(n);case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(11),f.debug("Failed to set the default audio output device.",e.t0);case 19:case"end":return e.stop()}}),e,null,[[11,16]])})));return function(){return e.apply(this,arguments)}}()}}])},module.exports=factory()}).call(this,__webpack_require__(12))},function(e,t,n){},,,function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},,,,function(e,t,n){}]]);